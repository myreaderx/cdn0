{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-11-15 02:31:53","updatedTime":"2020-11-15 02:31:53","title":"AWS Toolkit for Eclipse: Improved Support for Serverless Applications (Part 2 of 3)","link":"https://aws.amazon.com/blogs/developer/aws-toolkit-for-eclipse-improved-support-for-serverless-applications-part-2-3/","description":"<p>In the <a href=\"https://aws.amazon.com/blogs/developer/aws-toolkit-for-eclipse-improved-support-for-serverless-applications-part-1-3/\">first part</a>&nbsp;of this blog post, we talked about how to create a new AWS SAM application&nbsp;from the&nbsp;<strong>rekognition</strong>&nbsp;serverless blueprint. In this second part, we&nbsp;describe how to deploy the application to <a href=\"https://aws.amazon.com/cloudformation/\">AWS CloudFormation</a>.</p> \n<h2>Deploy the rekognition-service application to a new CloudFormation stack</h2> \n<p>This .gif animation shows the steps to deploy an <a href=\"https://aws.amazon.com/about-aws/whats-new/2016/11/introducing-the-aws-serverless-application-model/\">AWS SAM</a> application to <a href=\"https://aws.amazon.com/cloudformation/\">AWS CloudFormation</a>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-1.gif\"><img class=\"alignnone size-full wp-image-2610\" src=\"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-1.gif\" alt=\"\" width=\"864\" height=\"540\" /></a></p> \n<p><strong>What does the AWS Toolkit for Eclipse do for you during deployment</strong></p> \n<ul> \n <li>Creates a .zip file that&nbsp;contains the project and all its dependencies. Then uploads the file to the specified Amazon&nbsp;S3 bucket.</li> \n <li>Updates the <strong>serverless.template</strong>&nbsp;(as shown in the following snippet) to fill in the complete properties for the&nbsp;<strong>AWS::Serverless::Function</strong> resource type: \n  <ul> \n   <li>Replaces the <strong>Handler</strong> with the FQCN of the <a href=\"https://aws.amazon.com/lambda/\">AWS Lambda</a> function handler.</li> \n   <li>Generates the actual code URI for&nbsp;<strong>CodeUri</strong>&nbsp;so that AWS CloudFormation can&nbsp;reference the Lambda function artifact in the S3 bucket.</li> \n   <li>Adds the missing configurations (<strong>Runtime, Description, MemorySize, Timeout, Role</strong>) and use&nbsp;the default values.</li> \n  </ul> </li> \n <li>Creates a new AWS CloudFormation stack using the updated&nbsp;<strong>serverless.template</strong> file.</li> \n</ul> \n<p>Here is the updated snippet for <strong>TagImage</strong> in the CloudFormation template.</p> \n<pre><code class=\"lang-json\">&quot;TagImage&quot; : {\n      &quot;Type&quot; : &quot;AWS::Serverless::Function&quot;,\n      &quot;Properties&quot; : {\n        &quot;Handler&quot; : &quot;<strong><span style=\"color: #008000\">com.serverless.demo.function.</span></strong>TagImage&quot;,\n        <strong><span style=\"color: #008000\">&quot;Runtime&quot; : &quot;java8&quot;, &quot;CodeUri&quot; : &quot;s3://zhaoxiz-us-west-1/rekognition-service-stack-1497642692569-1497643074359.zip&quot;, &quot;Description&quot; : null, &quot;MemorySize&quot; : 512, &quot;Timeout&quot; : 300, &quot;Role&quot; : null,</span></strong>\n        &quot;Policies&quot; : [ &quot;AmazonS3FullAccess&quot;, &quot;AmazonRekognitionFullAccess&quot; ],\n        &quot;Events&quot; : {\n          &quot;ProcessNewImage&quot; : {\n            &quot;Type&quot; : &quot;S3&quot;,\n            &quot;Properties&quot; : {\n              &quot;Bucket&quot; : {&quot;Ref&quot; : &quot;ImageBucket&quot;},\n              &quot;Events&quot; : &quot;s3:ObjectCreated:*&quot;,\n              &quot;Filter&quot; : {\n                &quot;S3Key&quot; : {\n                  &quot;Rules&quot; : [{&quot;Name&quot;: &quot;suffix&quot;, &quot;Value&quot;: &quot;.jpg&quot;}]\n                }\n              }\n            }\n          }\n        }\n      }\n    }</code></pre> \n<h2>Deploy the rekognition-service application to an existing CloudFormation stack</h2> \n<p>We want to update the recognition confidence value to 80 in the Lambda function code and redeploy it to the CloudFormation stack. The following .gif animation shows how you can achieve that. When doing a second deployment for the same project, the AWS toolkit for Eclipse remembers the parameters used in&nbsp;the last deployment, so if you want to keep them the same, you don’t have to retype them.</p> \n<p><strong>Notice</strong> that we need to change the parameter value of&nbsp;<strong>ImageBucketExists</strong> to <em>true</em> in the parameter&nbsp;page (<strong>Fill in stack template parameters</strong>)<strong>&nbsp;</strong>because&nbsp;the bucket was already created during the first deployment. The underlying CloudFormation stack is&nbsp;updated with the new version of the Lambda function whether or not you update the parameters.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-2.gif\"><img class=\"alignnone size-full wp-image-2611\" src=\"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-2.gif\" alt=\"\" width=\"864\" height=\"540\" /></a></p> \n<h2>Update the Lambda event source by using the parameters page</h2> \n<p>Now,&nbsp;we want to configure the trigger event for the Lambda function to another new S3 bucket. This removes the bucket we created in the first deployment and creates a new bucket for this deployment. We&nbsp;only need to redeploy the application and update the&nbsp;<strong>ImageBucketExists</strong>&nbsp;parameter to <em>false</em>, and the&nbsp;<strong>ImageBucketName</strong>&nbsp;parameter to the new bucket name. After&nbsp;deployment, you see that the name of the&nbsp;<strong>ImageStack</strong>&nbsp;in the stack&nbsp;<strong>outputs</strong>&nbsp;is&nbsp;updated to the new name.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-3.gif\"><img class=\"alignnone size-full wp-image-2612\" src=\"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-3.gif\" alt=\"\" width=\"864\" height=\"540\" /></a></p> \n<p>In the <a href=\"https://aws.amazon.com/blogs/developer/aws-toolkit-for-eclipse-improved-support-for-serverless-applications-part-3-3/\">third part</a> of this blog post, we’ll talk about how to use the AWS Toolkit for Eclipse to check the result of the rekognition-service application.</p>","descriptionType":"html","publishedDate":"Tue, 20 Jun 2017 17:15:05 +0000","feedId":31315,"bgimg":"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-1.gif","linkMd5":"285855ab58c9794b6618c20b4e436510","author":"Zhaoxi Zhang","articleImgCdnMap":{"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-1.gif":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn4@2020_1/2020/11/14/18-36-20-319_ae79c69c29e369c5.webp","https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-2.gif":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn100@2020_2/2020/11/14/18-34-51-059_a42b0f7b0b59c778.webp","https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-3.gif":null},"publishedOrCreatedDate":1605378713565}],"record":{"createdTime":"2020-11-15 02:31:53","updatedTime":"2020-11-15 02:31:53","feedId":31315,"fetchDate":"Sat, 14 Nov 2020 18:31:53 +0000","fetchMs":523,"handleMs":16,"totalMs":273753,"newArticles":0,"totalArticles":20,"status":1,"type":0,"ip":"2147158baf8c40bd1b9393b0e552abc1","hostName":"us-006*","requestId":"1b3cde147c1a441f9ff41e3802194cc8_31315","contentType":"application/rss+xml;charset=UTF-8","totalBytes":2754010,"bgimgsTotal":1,"bgimgsGithubTotal":0,"articlesImgsTotal":3,"articlesImgsGithubTotal":2,"successGithubMap":{"myreaderx25":1,"myreaderx31":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 02:52:18","updatedTime":"2020-09-07 04:59:38","id":31315,"name":"Java – AWS Developer Blog","url":"http://java.awsblog.com/blog/feed/recentPosts.rss","subscriber":103,"website":null,"icon":"https://aws.amazon.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx64/cdn34@2020_4/2020/09/06/20-59-38-142_27a4e5d487919ba8.ico","description":"","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2020-11-15 02:36:26","updatedTime":"2020-11-15 02:36:26","id":null,"feedId":31315,"linkMd5":"285855ab58c9794b6618c20b4e436510"}],"tmpCommonImgCdnBytes":0,"tmpBodyImgCdnBytes":2754010,"tmpBgImgCdnBytes":0,"extra4":{"start":1605378713008,"total":0,"statList":[{"spend":541,"msg":"获取xml内容"},{"spend":16,"msg":"解释文章"},{"spend":120247,"msg":"正文链接上传到cdn"},{"spend":121585,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"}]},"extra5":3,"extra6":2,"extra7ImgCdnFailResultVector":[null,null,null,null,null,null,null],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-2.gif","sourceStatusCode":200,"destWidth":864,"destHeight":540,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn100@2020_2/2020/11/14/18-34-51-059_a42b0f7b0b59c778.webp","sourceBytes":2344024,"destBytes":1072638,"targetWebpQuality":75,"feedId":31315,"totalSpendMs":27376,"convertSpendMs":25555,"createdTime":"2020-11-15 02:34:25","host":"us-027*","referer":"https://aws.amazon.com/blogs/developer/aws-toolkit-for-eclipse-improved-support-for-serverless-applications-part-2-3/","linkMd5ListStr":"285855ab58c9794b6618c20b4e436510","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"2.2 MB","destSize":"1 MB","compressRate":"45.8%"},{"code":1,"isDone":false,"source":"https://d2908q01vomqb2.cloudfront.net/0716d9708d321ffb6a00818614779e779925365c/2017/06/19/deploy-rekognition-slow-1.gif","sourceStatusCode":200,"destWidth":864,"destHeight":540,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn4@2020_1/2020/11/14/18-36-20-319_ae79c69c29e369c5.webp","sourceBytes":3972410,"destBytes":1681372,"targetWebpQuality":75,"feedId":31315,"totalSpendMs":56518,"convertSpendMs":54841,"createdTime":"2020-11-15 02:35:25","host":"us-027*","referer":"https://aws.amazon.com/blogs/developer/aws-toolkit-for-eclipse-improved-support-for-serverless-applications-part-2-3/","linkMd5ListStr":"285855ab58c9794b6618c20b4e436510,285855ab58c9794b6618c20b4e436510","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.8 MB","destSize":"1.6 MB","compressRate":"42.3%"}],"successGithubMap":{"myreaderx25":1,"myreaderx31":1},"failGithubMap":{}}