{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2021-10-01 01:00:56","updatedTime":"2021-10-01 01:00:56","title":"Mirai_ptea Botnet利用KGUARD DVR未公开漏洞报告","link":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","description":"<h1 id=\"\">版权</h1> \n<p>版权声明：本文为Netlab原创，依据 <a href=\"https://creativecommons.org/licenses/by-sa/4.0/\">CC BY-SA 4.0</a> 许可证进行授权，转载请附上出处链接及本声明。</p> \n<h1 id=\"\">概述</h1> \n<p>2021-06-22我们检测到一个我们命名为<code>mirai_ptea</code>的mirai变种样本通过未知漏洞传播。经过分析，该漏洞为<a href=\"https://www.kguard.com.tw/\">KGUARD DVR</a>未公开的漏洞。从我们的分析看该漏洞存在于2016年的固件版本中。我们能找到的2017年之后的固件厂家均已经修复该漏洞。有意思的是，一天以后，6月23日，我们收到安全社区的询问，咨询我们是否看到一种新的DDoS攻击botnet。交叉对比线索，居然就是我们刚发现的这个botnet，目前看。这个僵尸网络处于活跃的攻击状态(见最后)。</p> \n<h2 id=\"\">时间线</h2> \n<ul> \n <li>2021-03-22 我们历史数据首次观察到针对该漏洞的探测扫描</li> \n <li>2021-06-22 我们观察到mirai_ptea样本利用该漏洞传播</li> \n <li>2021-06-23 我们收到安全社区的询问是否看到一种新的DDoS攻击botnet</li> \n <li>2021-06-25 我们观察到mirai_aurora样本利用该漏洞传播</li> \n</ul> \n<h1 id=\"\">漏洞分析</h1> \n<p>鉴于我们并未发现该漏洞的公开资料，为防止该漏洞被滥用，此处我们将隐藏部分关键信息。</p> \n<p>KGUARD DVR 2016年的固件上的<code>***</code>程序监听在<code>0.0.0.0</code>的<code>*****</code>端口无需认证即可远程执行系统命令。 最新的固件中厂家通过修改监听地址为<code>127.0.0.1</code>修复了该漏洞。部分利用payload如下：<br> <img src=\"https://blog.netlab.360.com/content/images/2021/07/mirai_ptea_xx_exp_p.png\" alt=\"mirai_ptea_xx_exp_p\" /></br></p> \n<h2 id=\"\">受影响设备分析</h2> \n<p>通过探测我们发现至少3千左右的在线设备依然存在该漏洞。已知仍然受影响设备如下:</p> \n<table> \n <thead> \n  <tr> \n   <th>DeviceType</th> \n   <th>ProductType</th> \n   <th>HardVersion</th> \n   <th>DefDeviceName</th> \n  </tr> \n </thead> \n <tbody> \n  <tr> \n   <td>D1004NR</td> \n   <td>DVR4-1600</td> \n   <td>DM-268A</td> \n   <td>DVR4-1600</td> \n  </tr> \n  <tr> \n   <td>D1004NR</td> \n   <td>HY-DVR</td> \n   <td>DM-268</td> \n   <td>720P-HY04N</td> \n  </tr> \n  <tr> \n   <td>D1004NR</td> \n   <td>HY-DVR</td> \n   <td>DM-268A</td> \n   <td>720P-HY04N</td> \n  </tr> \n  <tr> \n   <td>D1004NR</td> \n   <td>HY-DVR</td> \n   <td>DM-274</td> \n   <td>720P-HY04N</td> \n  </tr> \n  <tr> \n   <td>D1004NR</td> \n   <td>HY-DVR</td> \n   <td>DM-274B</td> \n   <td>720P-HY04N</td> \n  </tr> \n  <tr> \n   <td>D1004NR</td> \n   <td>NHDR</td> \n   <td>DM-274</td> \n   <td>NHDR-3204AHD</td> \n  </tr> \n  <tr> \n   <td>D1004NR</td> \n   <td>RL-AHD4n</td> \n   <td>DM-268</td> \n   <td>720P-HY04N</td> \n  </tr> \n  <tr> \n   <td>D1008NR</td> \n   <td>1093/508N-DVRBM08H</td> \n   <td>DM-292</td> \n   <td>720P-HY08N</td> \n  </tr> \n  <tr> \n   <td>D1008NR</td> \n   <td>DVR8-1600</td> \n   <td>DM-298</td> \n   <td>DVR8-1600</td> \n  </tr> \n  <tr> \n   <td>D1008NR</td> \n   <td>DVR8-HDA10L</td> \n   <td>DM-292</td> \n   <td>DVR8-HDA10L</td> \n  </tr> \n  <tr> \n   <td>D1008NR</td> \n   <td>HD881</td> \n   <td>DM-292</td> \n   <td>HD881</td> \n  </tr> \n  <tr> \n   <td>D1008NR</td> \n   <td>HY-DVR</td> \n   <td>DM-292</td> \n   <td>720P-HY08N</td> \n  </tr> \n  <tr> \n   <td>D1008NR</td> \n   <td>HY-DVR</td> \n   <td>DM-298</td> \n   <td>720P-HY08N</td> \n  </tr> \n  <tr> \n   <td>D1008NR</td> \n   <td>NHDR</td> \n   <td>DM-298</td> \n   <td>NHDR-3208AHD</td> \n  </tr> \n  <tr> \n   <td>D1008NR</td> \n   <td>RL-AHD8n</td> \n   <td>DM-292</td> \n   <td>720P-HY08N</td> \n  </tr> \n  <tr> \n   <td>D1016NR</td> \n   <td>DVR16-HDA10L</td> \n   <td>DM-303</td> \n   <td>DVR16-HDA10L</td> \n  </tr> \n  <tr> \n   <td>D1016NR</td> \n   <td>HD1681</td> \n   <td>DM-303</td> \n   <td>HD1681</td> \n  </tr> \n  <tr> \n   <td>D1016NR</td> \n   <td>HY-DVR</td> \n   <td>DM-303A</td> \n   <td>720P-HY16N</td> \n  </tr> \n  <tr> \n   <td>D1016NR</td> \n   <td>HY-DVR</td> \n   <td>DM-310</td> \n   <td>720P-HY16N</td> \n  </tr> \n  <tr> \n   <td>D1016NR</td> \n   <td>HY-DVR</td> \n   <td>DM-310A</td> \n   <td>720P-HY16N</td> \n  </tr> \n  <tr> \n   <td>D1016NR</td> \n   <td>NHDR</td> \n   <td>DM-310</td> \n   <td>NHDR-3216AHD</td> \n  </tr> \n  <tr> \n   <td>D1016NR</td> \n   <td>RL-MHD16n(21A)</td> \n   <td>DM-310A</td> \n   <td>720P-HY16N</td> \n  </tr> \n  <tr> \n   <td>D1104</td> \n   <td>HY-DVR</td> \n   <td>DM-290A</td> \n   <td>1080P-HY04</td> \n  </tr> \n  <tr> \n   <td>D1104</td> \n   <td>NHDR</td> \n   <td>DM-307</td> \n   <td>NHDR-5304AHD</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>HD1T4</td> \n   <td>DM-291A</td> \n   <td>1080P-04</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>HD481</td> \n   <td>DM-291</td> \n   <td>HD481</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>HRD-E430L</td> \n   <td>DM-291A</td> \n   <td>HRD-E430L</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>HY-DVR</td> \n   <td>DM-284</td> \n   <td>1080P-HY04N</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>HY-DVR</td> \n   <td>DM-291</td> \n   <td>\"Panda</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>HY-DVR</td> \n   <td>DM-291</td> \n   <td>1080P-HY04N</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>HY-DVR</td> \n   <td>DM-291A</td> \n   <td>1080P-HY04N</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>HY-DVR</td> \n   <td>DM-291C</td> \n   <td>LRA3040N</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>NHDR</td> \n   <td>DM-307</td> \n   <td>NHDR-5104AHD</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>SDR-B73303</td> \n   <td>DM-291A</td> \n   <td>SDR-B73303</td> \n  </tr> \n  <tr> \n   <td>D1104NR</td> \n   <td>SVR9204H</td> \n   <td>DM-291A</td> \n   <td>1080P-HY04N</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>1093/538P</td> \n   <td>DM-290</td> \n   <td>1080P-HY08N</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>DVR8-4575</td> \n   <td>DM-290</td> \n   <td>DVR8-4575</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>DVR8-HDA10P</td> \n   <td>DM-290</td> \n   <td>DVR8-HDA10P</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>HRD-E830L</td> \n   <td>DM-290A</td> \n   <td>HRD-E830L</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>HY-DVR</td> \n   <td>DM-290</td> \n   <td>1080P-HY08N</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>HY-DVR</td> \n   <td>DM-290A</td> \n   <td>1080P-HY08N</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>HY-DVR</td> \n   <td>DM-290A</td> \n   <td>LRA3080N</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>NHDR</td> \n   <td>DM-307</td> \n   <td>NHDR-5108AHD</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>RL-AHD8p</td> \n   <td>DM-290</td> \n   <td>1080P-HY08N</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>SDR-B74301</td> \n   <td>DM-290A</td> \n   <td>SDR-B74301</td> \n  </tr> \n  <tr> \n   <td>D1108NR</td> \n   <td>SDR-B74303</td> \n   <td>DM-290A</td> \n   <td>SDR-B74303</td> \n  </tr> \n  <tr> \n   <td>D1116</td> \n   <td>HY-DVR</td> \n   <td>DM-300</td> \n   <td>EHR-5164</td> \n  </tr> \n  <tr> \n   <td>D1116NR</td> \n   <td>HRD-E1630L</td> \n   <td>DM-295</td> \n   <td>HRD-E1630L</td> \n  </tr> \n  <tr> \n   <td>D1116NR</td> \n   <td>HY-DVR</td> \n   <td>DM-295</td> \n   <td>1080P-HY16N</td> \n  </tr> \n  <tr> \n   <td>D1116NR</td> \n   <td>HY-DVR</td> \n   <td>DM-295</td> \n   <td>LRA3160N</td> \n  </tr> \n  <tr> \n   <td>D1116NR</td> \n   <td>HY-DVR</td> \n   <td>DM-299</td> \n   <td>1080P-HY16N</td> \n  </tr> \n  <tr> \n   <td>D1116NR</td> \n   <td>SDR-B75303</td> \n   <td>DM-295</td> \n   <td>SDR-B75303</td> \n  </tr> \n  <tr> \n   <td>D1132NR</td> \n   <td>HY-DVR</td> \n   <td>DM-300</td> \n   <td>1080P-HY32</td> \n  </tr> \n  <tr> \n   <td>D2116NR</td> \n   <td>SDR-B85300</td> \n   <td>DM-300</td> \n   <td>SDR-B85300</td> \n  </tr> \n  <tr> \n   <td>D973215U</td> \n   <td>F9-DVR32</td> \n   <td>DM-195</td> \n   <td>F9-DVR32</td> \n  </tr> \n  <tr> \n   <td>D9804AHD</td> \n   <td>DVR</td> \n   <td>DM-210</td> \n   <td>391115</td> \n  </tr> \n  <tr> \n   <td>D9804NAHD</td> \n   <td>AHD7-DVR4</td> \n   <td>DM-239</td> \n   <td>AHD7-DVR4</td> \n  </tr> \n  <tr> \n   <td>D9804NAHD</td> \n   <td>DVR</td> \n   <td>DM-239</td> \n   <td>720P-DVR04ND</td> \n  </tr> \n  <tr> \n   <td>D9804NAHD</td> \n   <td>NHDR</td> \n   <td>DM-239</td> \n   <td>NHDR-3104AHD-II</td> \n  </tr> \n  <tr> \n   <td>D9808NRAHD</td> \n   <td>AHD7-DVR8</td> \n   <td>DM-228</td> \n   <td>AHD7-DVR8</td> \n  </tr> \n  <tr> \n   <td>D9808NRAHD</td> \n   <td>DVR</td> \n   <td>DM-228</td> \n   <td></td> \n  </tr> \n  <tr> \n   <td>D9808NRAHD</td> \n   <td>DVR</td> \n   <td>DM-228</td> \n   <td>391116</td> \n  </tr> \n  <tr> \n   <td>D9808NRAHD</td> \n   <td>NHDR</td> \n   <td>DM-228</td> \n   <td>NHDR-3108AHD-II</td> \n  </tr> \n  <tr> \n   <td>D9808NRAHD</td> \n   <td>NHDR</td> \n   <td>DM-228</td> \n   <td>NHDR3108AHDII</td> \n  </tr> \n  <tr> \n   <td>D9816NAHD</td> \n   <td>DVR</td> \n   <td>DM-233</td> \n   <td>720P-DVR016N</td> \n  </tr> \n  <tr> \n   <td>D9816NAHD</td> \n   <td>NHDR</td> \n   <td>DM-233</td> \n   <td>NHDR3116AHDII</td> \n  </tr> \n  <tr> \n   <td>D9816NRAHD</td> \n   <td>AHD7-DVR16</td> \n   <td>DM-229</td> \n   <td>AHD7-DVR16</td> \n  </tr> \n  <tr> \n   <td>D9816NRAHD</td> \n   <td>DVR</td> \n   <td>DM-229</td> \n   <td>720P-DVR016NB</td> \n  </tr> \n  <tr> \n   <td>D9904</td> \n   <td>D9904</td> \n   <td>DM-237</td> \n   <td>1080P-DVR04</td> \n  </tr> \n  <tr> \n   <td>D9904</td> \n   <td>DVR</td> \n   <td>DM-237</td> \n   <td>1080P-DVR04</td> \n  </tr> \n  <tr> \n   <td>D9904</td> \n   <td>NHDR</td> \n   <td>DM-237</td> \n   <td>NHDR-5204AHD</td> \n  </tr> \n  <tr> \n   <td>D9904NR</td> \n   <td>DVR</td> \n   <td>DM-244</td> \n   <td>1080P-DVR04N</td> \n  </tr> \n  <tr> \n   <td>D9904NR</td> \n   <td>DVR</td> \n   <td>DM-244</td> \n   <td>BCS-VAVR0401M</td> \n  </tr> \n  <tr> \n   <td>D9904NR</td> \n   <td>HY-DVR</td> \n   <td>DM-244</td> \n   <td>CVD-AF04S</td> \n  </tr> \n  <tr> \n   <td>D9904NR</td> \n   <td>N420</td> \n   <td>DM-244</td> \n   <td>1080P-DVR04N</td> \n  </tr> \n  <tr> \n   <td>D9904NR</td> \n   <td>NHDR</td> \n   <td>DM-244</td> \n   <td>NHDR-5004AHD-II</td> \n  </tr> \n  <tr> \n   <td>D9904NR</td> \n   <td>NHDR</td> \n   <td>DM-244</td> \n   <td>NHDR5004AHDII</td> \n  </tr> \n  <tr> \n   <td>D9908</td> \n   <td>DVR</td> \n   <td>DM-245</td> \n   <td>BCS-VAVR0802Q</td> \n  </tr> \n  <tr> \n   <td>D9908</td> \n   <td>NHDR</td> \n   <td>DM-245</td> \n   <td>NHDR-5208AHD</td> \n  </tr> \n  <tr> \n   <td>D9908AHD</td> \n   <td>DVR</td> \n   <td>DM-246</td> \n   <td>1080P-DVR08A</td> \n  </tr> \n  <tr> \n   <td>D9908NR</td> \n   <td>AHD10-DVR8</td> \n   <td>DM-237</td> \n   <td>AHD10-DVR8</td> \n  </tr> \n  <tr> \n   <td>D9908NR</td> \n   <td>DVR</td> \n   <td>DM-237</td> \n   <td>1080P-DVR08N</td> \n  </tr> \n  <tr> \n   <td>D9908NR</td> \n   <td>DVR</td> \n   <td>DM-237</td> \n   <td>SVR9008ATHD/C</td> \n  </tr> \n  <tr> \n   <td>D9908NR</td> \n   <td>HY-DVR</td> \n   <td>DM-237</td> \n   <td>CVD-AF08S</td> \n  </tr> \n  <tr> \n   <td>D9908NR</td> \n   <td>N820</td> \n   <td>DM-237</td> \n   <td>1080P-DVR08N</td> \n  </tr> \n  <tr> \n   <td>D9908NR</td> \n   <td>NHDR</td> \n   <td>DM-237</td> \n   <td>NHDR-5008AHD-II</td> \n  </tr> \n  <tr> \n   <td>D9916NR</td> \n   <td>DVR</td> \n   <td>DM-245</td> \n   <td>1080P-DVR016NAT;UI</td> \n  </tr> \n  <tr> \n   <td>D9916NR</td> \n   <td>DVR</td> \n   <td>DM-245</td> \n   <td>HR-31-211620;UI</td> \n  </tr> \n  <tr> \n   <td>D9916NR</td> \n   <td>HY-DVR</td> \n   <td>DM-245</td> \n   <td>CVD-AF16S</td> \n  </tr> \n  <tr> \n   <td>D9916NR</td> \n   <td>NHDR</td> \n   <td>DM-245</td> \n   <td>NHDR-5016AHD-II</td> \n  </tr> \n  <tr> \n   <td>D9916NRAHD</td> \n   <td>DVR</td> \n   <td>DM-246</td> \n   <td>1080P-DVR016NA</td> \n  </tr> \n  <tr> \n   <td>D9916NRAHD</td> \n   <td>N1620</td> \n   <td>DM-246</td> \n   <td>1080P-DVR016NA</td> \n  </tr> \n  <tr> \n   <td>H1104W</td> \n   <td>SNR-73200W</td> \n   <td>DM-339</td> \n   <td>SNR-73200W</td> \n  </tr> \n  <tr> \n   <td>H1106W</td> \n   <td>LHB806</td> \n   <td>DM-291B</td> \n   <td>LHB806</td> \n  </tr> \n  <tr> \n   <td>H1106W</td> \n   <td>LHB906</td> \n   <td>DM-291B</td> \n   <td>LHB906</td> \n  </tr> \n </tbody> \n</table> \n<h1 id=\"bot\">Bot规模分析</h1> \n<p>从我们的数据视野看，该botnet的活跃Bot源IP趋势如下：<br> <img src=\"https://blog.netlab.360.com/content/images/2021/06/Snip202110630_10.png\" alt=\"Snip202110630_10\" /></br></p> \n<p>Bot源IP地理位置分布如下，主要集中在美国、韩国和巴西：<br> <img src=\"https://blog.netlab.360.com/content/images/2021/06/Snip20210629_1.png\" alt=\"Snip20210629_1\" /></br></p> \n<h1 id=\"\">样本分析</h1> \n<p>本文选取以下样本为主要分析对象</p> \n<pre><code>Verdict:mirai_ptea\nMD5:c6ef442bc804fc5290d3617056492d4b\nELF 32-bit LSB executable, ARM, version 1, statically linked, stripped \nPacker:No\nLib:uclibc\n</code></pre> \n<p><code>c6ef442bc804fc5290d3617056492d4b</code>是一个Mirai的变种，基于其使用Tor Proxy和C2通信，以及TEA算法（Tiny Encryption Algorithm）隐藏敏感的资源信息，我们称之为<code>Mirai_ptea</code>。Mirai_ptea运行时在会Console输出字串<code>come at me krebs rimasuta go BRRT</code>，这就是有的研究人员将它称之为<code>Rimasuta</code>的原因，它在主机行为层面和Mirai很相似，并无亮点，因此这方面不再细述；在网络流量层面采用Tor Proxy，样本内嵌了大量的代理节点，而且Tor-C2被加密，下文将着重讨论加密方法和通信协议。</p> \n<h1 id=\"\">加密算法</h1> \n<p>Mirai_ptea将所有的敏感资源信息加密并按一定的顺序存储，在IDA打开样本看到的字串信息如下所示，几乎没有可读的信息。</p> \n<p><img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_strtab.png\" alt=\"ptea_strtab\" /></p> \n<p>下面的代码片段来自样本中解密相关函数，通过<code>红框中的常量</code>可以判定它使用的是TEA算法，</p> \n<img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_tea.png\" width=\"860px\"> <p>密钥为：</p> <pre><code>0xC26F6A52 0x24AA0006 0x8E1BF2C5 0x4BA51F8C\n</code></pre> <p>基于逆向分析，我们实现了<a href=\"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/#decrypt_str\"><strong>附录</strong></a>的解密脚本，通过它可以获得所有的解密后的敏感资源以及它们的表项信息，部分资源信息如下所示：</p> <img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_decinfo.png\" width=\"860px\"> <p>Mirai_ptea在使用加密资源时有2种操作方式</p> \n  <ul> \n   <li><strong>传统的Mirai方式</strong>，解密一个加密项，取值，加密一个解密后的项，即<code>var_unlock--&gt;var_get--&gt;var_lock</code>。例如在获取输出在Console上的信息时，就是通过这种方式。<br> <img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_var.png\" alt=\"ptea_strtab\" /></br></li> \n  </ul> <p>表项0x11的值正是<code>come at me krebs rimasuta go BRRT</code>。</p> \n  <ul> \n   <li><strong>Mirai_ptea的方式</strong>，解密多个加密项，取值，重新加密已解密的项，即<code>rangeVar_unlock--&gt;var_get--&gt;rangeVar_lock</code>。例如在获取伪装进程名时，就是通过这种方式。</li> \n  </ul> <p><img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_rangevar.png\" alt=\"ptea_strtab\"><br> 表项0x2c到0x2c+10的值如下所示，正是11个供选择的伪装进程名：</br></img></p> <pre><code>index 0x2c, value = /bin/sh\nindex 0x2d, value = telnetd\nindex 0x2e, value = upnpc-static\nindex 0x2f, value = wsdd\nindex 0x30, value = proftpd\nindex 0x31, value = mini_httpd\nindex 0x32, value = udevd\nindex 0x33, value = /sbin/udhcpc\nindex 0x34, value = boa\nindex 0x35, value = /usr/sbin/inetd\nindex 0x36, value = dnsmasq\n</code></pre> <h1 id=\"\">通信协议</h1> <p>Mirai_ptea的网络流量概览如下图所示：</p> <img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_network.png\" width=\"860px\"> <p>整个过程可以分成以下3个步骤：</p> <p>1：和代理节点建立连接</p> <p>2：和Tor C2建立连接</p> <p>3：通过ptea自定义的协议和C2通信，接收C2下发的攻击指令。</p> <h3 id=\"0x1\">0x1. 和代理建立连接</h3> <p>Mirai_ptea样本中内置了2组代理，它们在加密资源中的表项分别为0x2a,0x2b。Bot样本运行时，会在2组代理中随机选一组，然后在选中的组中随机选一个通过下面代码片段建立连接。</p> <img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_proxy.png\" width=\"860px\"> <p>其中<code>0x2a</code>中一共有38个代理节点，格式为<code>ip:port</code></p> <img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_0x2a.png\" width=\"860px\"> <p>而<code>0x2b</code>中一共有个334个代理节点，格式为<code>ip</code>，这组代理的端口为固定的9050。</p> <img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_0x2b.png\" width=\"860px\"> <p>详细的代理列表见附录。</p> <h3 id=\"0x2torproxyc2\">0x2. 通过Tor-Proxy协议和C2建立连接</h3> <p><img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_c2.png\" alt=\"ptea_strtab\" /></p> <p>可以看出C2在加密资源中的表项为<code>0xD</code>，解密后得到下面字串：</p> <pre><code>rkz2f5u57cvs3kdt6amdku2uhly2esj7m2336dttvcygloivcgsmxjjnuickasbuatxajrovi4lvd2zjuejivzrb3vobuoezbc6z3gtu6b3r5tce.onion\n</code></pre> <p>将上面字串排除尾部的“.onion”后以长度16分割，然后和尾部的<code>.onion</code>字串进行拼接，就得到了以下7个C2。</p> <pre><code>rkz2f5u57cvs3kdt.onion\n6amdku2uhly2esj7.onion\nm2336dttvcygloiv.onion\ncgsmxjjnuickasbu.onion\natxajrovi4lvd2zj.onion\nuejivzrb3vobuoez.onion\nbc6z3gtu6b3r5tce.onion\n</code></pre> <h3 id=\"0x3c2\">0x3. 通过自定义的协议和C2进行通信，具体的上线，心跳，攻击如下所示</h3> \n      <ul> \n       <li>上线<br> <img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_reg.png\" width=\"860px\" /></br></li> \n      </ul> <pre><code>msg parsing\n----------------------------------------------------------------\n3e c7 e3 1e 37 47 61 20\t\t\t\t\t\t-----&gt;hardcoded msg from Bot\nb1 2f de ce cb 89 e1 a0\t\t\t\t\t\t-----&gt;cmd from C2,ask Bot to upload info\n3a 31 34 b5 02 00\t\t\t\t\t\t\t-----&gt;hardcoded 6 bytes msg from Bot\nb4 a3 e1 16\t\t\t\t\t\t\t\t\t-----&gt;ip of infected device\n04\t\t\t\t\t\t\t\t\t\t\t-----&gt;group string length\n74 65 73 74\t\t\t\t\t\t\t\t    -----&gt;group string\n79\t\t\t                                -----&gt;padding\n</code></pre> \n      <ul> \n       <li>心跳<br> <img src=\"https://blog.netlab.360.com/content/images/2021/06/ptea_heart.png\" width=\"860px\" /></br></li> \n      </ul> <pre><code>msg parsing\n----------------------------------------------------------------\n2a 23\t\t\t\t\t\t-----&gt; random 2 bytes msg from Bot\n2a 23\t\t\t\t\t\t-----&gt; random 2 bytes msg from C2\n</code></pre> \n      <ul> \n       <li>攻击指令，前4字节<code>AD AF FE 7F</code>为固定的幻数，剩余部分与mirai的攻击指令格式类似</li> \n      </ul> <pre><code>00000000: AD AF FE 7F 1E 00 00 00  00 01 B9 98 42 65 20 00  ............Be .\n00000010: 42 65 20 00     \n</code></pre> <h1 id=\"ddos\">DDoS攻击活动</h1> <p>从我们的DDoS跟踪系统看，该僵尸网络已经发起实际的DDoS攻击，下图为我们观察到的该僵尸网络的一些DDoS攻击指令：<br> <a href=\"https://blog.netlab.360.com/content/images/2021/06/mirai_ptea_atk_cmd_4c.png\"><img src=\"https://blog.netlab.360.com/content/images/2021/06/mirai_ptea_atk_cmd_4.png\" class=\"kg-image\" /></a></br></p> <h1 id=\"\">联系我们</h1> <p>感兴趣的读者，可以在 <a href=\"https://twitter.com/360Netlab\"><strong>twitter</strong></a> 或者通过邮件<strong>netlab[at]360.cn</strong>联系我们。</p> <h1 id=\"ioc\">IoC</h1> <h2 id=\"torc2\">Tor-C2</h2> <pre><code>bc6z3gtu6b3r5tce.onion:3742\ncgsmxjjnuickasbu.onion:992\nuejivzrb3vobuoez.onion:5353\nrkz2f5u57cvs3kdt.onion:280\natxajrovi4lvd2zj.onion:110\n6amdku2uhly2esj7.onion:513\nm2336dttvcygloiv.onion:666\n</code></pre> <h2 id=\"samplemd5\">Sample MD5</h2> <pre><code>c6ef442bc804fc5290d3617056492d4b\nf849fdd79d433e2828473f258ffddaab\n</code></pre> <h2 id=\"downloaderurl\">Downloader URL</h2> <pre><code>http://193[.177.182.221/boot\n</code></pre> <h2 id=\"scannerip\">Scanner IP</h2> <pre><code>205.185.117.21\tAS53667|FranTech_Solutions\tUnited_States|Nevada|Las_Vegas\n205.185.114.55\tAS53667|FranTech_Solutions\tUnited_States|Nevada|Las_Vegas\n68.183.109.6\tAS14061|DigitalOcean,_LLC\tUnited_States|New_York|New_York_City\n67.205.163.141\tAS14061|DigitalOcean,_LLC\tUnited_States|New_York|New_York_City\n165.227.88.215\tAS14061|DigitalOcean,_LLC\tUnited_States|New_York|New_York_City\n</code></pre> <h2 id=\"proxys\">Proxys</h2> <pre><code>---------proxys at index 0x2a，count=38---------\n149.202.9.7:9898\n91.134.216.103:16358\n84.32.188.34:1157\n51.178.185.237:32\n65.21.16.80:23560\n149.202.9.14:19765\n146.59.11.109:5089\n195.189.96.61:29582\n84.32.188.37:1454\n51.195.209.80:26848\n5.199.174.242:27931\n95.179.158.147:22413\n146.59.11.103:1701\n185.150.117.10:29086\n149.56.154.210:24709\n135.148.11.151:3563\n51.195.152.255:25107\n45.79.193.124:7158\n135.148.11.150:5560\n185.150.117.41:20790\n135.125.250.120:14498\n172.106.70.135:692\n195.189.96.60:9700\n172.106.70.134:25054\n149.56.154.211:21299\n108.61.218.205:29240\n51.178.185.236:21685\n51.81.139.251:6255\n51.255.237.164:963\n51.81.139.249:32380\n139.162.45.218:5165\n65.21.16.94:28056\n207.148.74.163:32389\n172.104.100.78:1039\n45.32.8.100:19759\n141.164.46.133:2205\n172.105.36.167:10843\n172.105.180.239:19531\n\n---------proxys at index 0x2b，count=334，port=9050---------\nToo many, not list here, you can get them via the IDA script\n</code></pre> <h1 id=\"aiddecrypt_stridaa\"><a id=\"decrypt_str\">附录（IDA解密脚本）</a></h1> <pre><code># IDAPYTHON SCRIPT for md5 c6ef442bc804fc5290d3617056492d4b only.\n# Tested at ida 7.0\nfrom ctypes import *\nimport struct\nprint \"-------------------decryption start------------------------\"\n\nkey=[0xC26F6A52,0x24AA0006,0x8E1BF2C5,0x4BA51F8C]\ndef tea_dec(buf,key):\n    rbuf=\"\"\n    fmt = '&gt;' + str(len(buf)/4) + 'I'\n    tbuf= struct.unpack_from(fmt,buf)\n    j=0\n    for i in range(0,len(tbuf)/2):\n        \n        v1=c_uint32(tbuf[i+j])\n        v2=c_uint32(tbuf[i+1+j])\n\n        sum=c_uint32(0xC6EF3720)\n        while(sum.value):\n            v2.value -= ((v1.value&gt;&gt;5)+key[3])    ^(v1.value+sum.value)^  ((v1.value&lt;&lt;4)+key[2])\n            v1.value -= ((v2.value&gt;&gt;5)+key[1])   ^(v2.value+sum.value)^ ((v2.value&lt;&lt;4)+key[0])\n            sum.value+=0x61C88647\n        rbuf +=struct.pack(\"&gt;I\",v1.value)+struct.pack(\"&gt;I\",v2.value)\n        j+=1\n    return rbuf\ndef getbuff(addr):\n    buf = \"\"\n    while idc.get_bytes(addr, 2) != \"\\x00\\x00\":\n        buf += idc.get_bytes(addr, 1)\n        addr += 1\n\n    return buf\n\n\n\n# pay attention to function at 0x0000D074\na=getbuff(idc.get_wide_dword(0x00019C9C))\n\n    \n\nbuf=[]\n#0x19c9c-0x199f0 --&gt; 684\nfor i in range(0,684,12):\n    offset=idc.get_wide_word(0x000199F4+i)\n    length=idc.get_wide_word(0x000199F4+i+2)\n\n    buf.append(a[offset:offset+length])\n    \nc2=[]\n#684/12 --&gt; 57\nfor i in range(57):\n    decbuf=tea_dec(buf[i],key)\n\n    if(\".onion\" in decbuf):\n        c2.append(decbuf)\n    print \"index %x, value = %s\" %(i,decbuf)    \nprint \"-------------------decryption end---------------\"\n\nproxya=tea_dec(buf[0x2a],key)\npacnt=struct.unpack(\"&lt;H\",proxya[2:4])\n\n\nproxy=[]\nport=[]\ntmp=proxya[4:4+6*(pacnt[0])]\nprint \"------------proxys at index 0x2A, count= %d------------\" %(pacnt[0])\nfor i in range(0,len(tmp),6):\n    proxy.append(struct.unpack(\"&gt;I\",tmp[i:i+4])[0])\n    port.append(struct.unpack(\"&lt;H\",tmp[i+4:i+6])[0])\nfor i in range(pacnt[0]):\n    a=struct.pack(\"&gt;I\",proxy[i])\n    ip=\"\"\n    for j in range(4):\n        ip+=str(ord(a[j]))\n        if j!=3:\n            ip+=\".\"\n    \n    print\"%s:%d\" %(ip,port[i])\n\n\n\nproxyb=tea_dec(buf[0x2b],key)\npbcnt=struct.unpack(\"&lt;H\",proxyb[2:4])\nfmt = '&gt;' + str(pbcnt[0]) + 'I'\ntmp=proxyb[4:4*(pbcnt[0]+1)]\nprint \"------------proxys at index 0x2B, count= %d------------\" %(pbcnt[0])\nxxxxx=struct.unpack(fmt,tmp)\nfor i in xxxxx:\n    a=struct.pack(\"&gt;I\",i)\n    ip=\"\"\n    for i in range(4):\n        ip+=str(ord(a[i]))\n        if i!=3:\n            ip+=\".\"\n    print ip\n\n\nprint \"-------------------------onion info--------------\"    \nif len(c2)!=0:\n    for i in c2:\n        \n        pos=i.find(\".onion\")\n\n        for j in range(0,pos,16):\n            print i[j:16+j]+\".onion\"\nelse:\n    print \"Don't find the onion c2\"\n</code></pre> </img></img></img></img></img></img>","descriptionType":"html","publishedDate":"Thu, 01 Jul 2021 03:37:10 +0000","feedId":45157,"bgimg":"https://blog.netlab.360.com/content/images/2021/07/mirai_ptea_xx_exp_p.png","linkMd5":"be69d101160f1aa623419b5a4cbcd9e2","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn79@2020_2/2021/09/30/17-00-59-379_cdc02701f692a675.webp","destWidth":860,"destHeight":188,"sourceBytes":68491,"destBytes":29392,"author":"Hui Wang","articleImgCdnMap":{"https://blog.netlab.360.com/content/images/2021/07/mirai_ptea_xx_exp_p.png":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn79@2020_2/2021/09/30/17-00-59-379_cdc02701f692a675.webp","https://blog.netlab.360.com/content/images/2021/06/Snip202110630_10.png":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn83@2020_5/2021/09/30/17-01-01-727_19a3c67c780d5af1.webp","https://blog.netlab.360.com/content/images/2021/06/Snip20210629_1.png":null,"https://blog.netlab.360.com/content/images/2021/06/ptea_strtab.png":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn95@2020_5/2021/09/30/17-01-01-646_f1f0fc538c58a098.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_tea.png":null,"https://blog.netlab.360.com/content/images/2021/06/ptea_decinfo.png":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn86@2020_2/2021/09/30/17-01-03-657_822f5585b38c8d40.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_var.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn98@2020_4/2021/09/30/17-01-01-649_56f72b6e4ef4d730.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_rangevar.png":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn27@2020_3/2021/09/30/17-01-01-520_dc993c38be46329e.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_network.png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn36@2020_2/2021/09/30/17-01-01-506_840eb0ac9d283ad1.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_proxy.png":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn20@2020_6/2021/09/30/17-01-01-470_ee53428abe843070.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_0x2a.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn29@2020_2/2021/09/30/17-01-01-715_e72918b18335b86d.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_0x2b.png":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn21@2020_3/2021/09/30/17-01-01-809_f0c62d81dbbbe53c.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_c2.png":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn100@2020_1/2021/09/30/17-02-05-196_310c4d6107023a08.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_reg.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn11@2020_5/2021/09/30/17-01-04-002_54b10e1bc23422c2.webp","https://blog.netlab.360.com/content/images/2021/06/ptea_heart.png":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn7@2020_2/2021/09/30/17-01-01-774_515e4d736bde6557.webp","https://blog.netlab.360.com/content/images/2021/06/mirai_ptea_atk_cmd_4.png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn15@2020_6/2021/09/30/17-01-04-981_cf78b55f80f4ab51.webp"},"publishedOrCreatedDate":1633021256474}],"record":{"createdTime":"2021-10-01 01:00:56","updatedTime":"2021-10-01 01:00:56","feedId":45157,"fetchDate":"Thu, 30 Sep 2021 17:00:56 +0000","fetchMs":1956,"handleMs":10,"totalMs":71890,"newArticles":0,"totalArticles":15,"status":1,"type":0,"ip":"af0629e1ae74a27744b4cbd27b40a78e","hostName":"us-005*","requestId":"e936729c6f5b44f0adbf67d14a19003d_45157","contentType":"text/xml; charset=utf-8","totalBytes":703648,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":16,"articlesImgsGithubTotal":14,"successGithubMap":{"myreaderx25":1,"myreaderx8":1,"myreaderx6":1,"myreaderx16":1,"myreaderx21":1,"myreaderx32":1,"myreaderx22":1,"myreaderx11":1,"myreaderx3":1,"myreaderx12":1,"myreaderx1":1,"myreaderx30":1,"myreaderx5oss":1,"myreaderx29":1},"failGithubMap":{"myreaderx14":1,"myreaderx31":1}},"feed":{"createdTime":"2020-09-07 03:37:14","updatedTime":"2020-09-07 05:55:16","id":45157,"name":"360 Netlab Blog - Network Security Research Lab at 360","url":"https://blog.netlab.360.com/rss/","subscriber":71,"website":null,"icon":"https://blog.netlab.360.com/favicon.png","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx61/cdn59@2020_2/2020/09/06/21-55-13-480_11aad37390d7d139.png","description":"Network Security Research Lab at 360","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2021-10-01 01:02:05","updatedTime":"2021-10-01 01:02:05","id":null,"feedId":45157,"linkMd5":"be69d101160f1aa623419b5a4cbcd9e2"}],"tmpCommonImgCdnBytes":29392,"tmpBodyImgCdnBytes":674256,"tmpBgImgCdnBytes":0,"extra4":{"start":1633021253844,"total":0,"statList":[{"spend":2621,"msg":"获取xml内容"},{"spend":10,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":65901,"msg":"正文链接上传到cdn"}]},"extra5":16,"extra6":16,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_tea.png","sourceStatusCode":200,"destWidth":1242,"destHeight":523,"sourceBytes":45682,"destBytes":52666,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":1918,"convertSpendMs":22,"createdTime":"2021-10-01 01:00:59","host":"us-025*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx31/cdn89/contents/2021/09/30/17-01-01-722_4dda39887b2d4bdb.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69855631.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Thu, 30 Sep 2021 17:01:01 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["D1B0:1D0B:B54473:1918371:6155ED4D"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1633023678"],"x-ratelimit-resource":["core"],"x-ratelimit-used":["60"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx31/cdn89/contents/2021/09/30/17-01-01-722_4dda39887b2d4bdb.webp","historyStatusCode":[],"spendMs":41},"base64UserPassword":null,"token":"da243******************************d9e47"},"githubUser":"myreaderx31","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"44.6 KB","destSize":"51.4 KB","compressRate":"115.3%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/Snip20210629_1.png","sourceStatusCode":200,"destWidth":860,"destHeight":596,"sourceBytes":220814,"destBytes":27676,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":3756,"convertSpendMs":18,"createdTime":"2021-10-01 01:00:59","host":"us-009*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx14/cdn38/contents/2021/09/30/17-01-03-560_048aabbc0dd7c786.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 68584859.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Thu, 30 Sep 2021 17:01:03 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["88FC:16BA:BED8AF:230AA43:6155ED4F"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1633023633"],"x-ratelimit-resource":["core"],"x-ratelimit-used":["60"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx14/cdn38/contents/2021/09/30/17-01-03-560_048aabbc0dd7c786.webp","historyStatusCode":[],"spendMs":43},"base64UserPassword":null,"token":"6b67d******************************91b08"},"githubUser":"myreaderx14","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"215.6 KB","destSize":"27 KB","compressRate":"12.5%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_tea.png","sourceStatusCode":200,"destWidth":1242,"destHeight":523,"sourceBytes":45682,"destBytes":52666,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":1916,"convertSpendMs":28,"createdTime":"2021-10-01 01:01:01","host":"us-025*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx31/cdn89/contents/2021/09/30/17-01-03-588_4dda39887b2d4bdb.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69855631.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Thu, 30 Sep 2021 17:01:03 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["D13C:1BE2:17B136:3072DC:6155ED4F"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1633023678"],"x-ratelimit-resource":["core"],"x-ratelimit-used":["60"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx31/cdn89/contents/2021/09/30/17-01-03-588_4dda39887b2d4bdb.webp","historyStatusCode":[],"spendMs":95},"base64UserPassword":null,"token":"da243******************************d9e47"},"githubUser":"myreaderx31","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"44.6 KB","destSize":"51.4 KB","compressRate":"115.3%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/Snip20210629_1.png","sourceStatusCode":200,"destWidth":860,"destHeight":596,"sourceBytes":220814,"destBytes":27676,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":4047,"convertSpendMs":18,"createdTime":"2021-10-01 01:01:03","host":"us-036*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx14/cdn38/contents/2021/09/30/17-01-07-605_048aabbc0dd7c786.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 68584859.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Thu, 30 Sep 2021 17:01:07 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["AA14:0B65:E9868:220B2E:6155ED53"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1633023633"],"x-ratelimit-resource":["core"],"x-ratelimit-used":["60"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx14/cdn38/contents/2021/09/30/17-01-07-605_048aabbc0dd7c786.webp","historyStatusCode":[],"spendMs":51},"base64UserPassword":null,"token":"6b67d******************************91b08"},"githubUser":"myreaderx14","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"215.6 KB","destSize":"27 KB","compressRate":"12.5%"},null],"extra10_invalidATagHrefValue":{"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/_#decrypt_str":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/#decrypt_str"},"extra111_proxyServerAndStatMap":{"http://us-032.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe63.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://europe61.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://europe66.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-009.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-024.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-025.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-017.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-036.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://europe62.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-033.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-51.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe67.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-008.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-029.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/07/mirai_ptea_xx_exp_p.png","sourceStatusCode":200,"destWidth":860,"destHeight":188,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn79@2020_2/2021/09/30/17-00-59-379_cdc02701f692a675.webp","sourceBytes":68491,"destBytes":29392,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":3215,"convertSpendMs":20,"createdTime":"2021-10-01 01:00:56","host":"europe21*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2,be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"66.9 KB","destSize":"28.7 KB","compressRate":"42.9%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_network.png","sourceStatusCode":200,"destWidth":1247,"destHeight":477,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn36@2020_2/2021/09/30/17-01-01-506_840eb0ac9d283ad1.webp","sourceBytes":33159,"destBytes":64042,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":1999,"convertSpendMs":23,"createdTime":"2021-10-01 01:00:59","host":"us-008*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"32.4 KB","destSize":"62.5 KB","compressRate":"193.1%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_rangevar.png","sourceStatusCode":200,"destWidth":625,"destHeight":284,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn27@2020_3/2021/09/30/17-01-01-520_dc993c38be46329e.webp","sourceBytes":25521,"destBytes":35574,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":2021,"convertSpendMs":28,"createdTime":"2021-10-01 01:00:59","host":"us-032*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"24.9 KB","destSize":"34.7 KB","compressRate":"139.4%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_proxy.png","sourceStatusCode":200,"destWidth":1121,"destHeight":281,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn20@2020_6/2021/09/30/17-01-01-470_ee53428abe843070.webp","sourceBytes":23866,"destBytes":36636,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":2003,"convertSpendMs":14,"createdTime":"2021-10-01 01:00:59","host":"europe66*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"23.3 KB","destSize":"35.8 KB","compressRate":"153.5%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/Snip202110630_10.png","sourceStatusCode":200,"destWidth":860,"destHeight":330,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn83@2020_5/2021/09/30/17-01-01-727_19a3c67c780d5af1.webp","sourceBytes":36473,"destBytes":10886,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":2168,"convertSpendMs":12,"createdTime":"2021-10-01 01:00:59","host":"us-036*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"35.6 KB","destSize":"10.6 KB","compressRate":"29.8%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_heart.png","sourceStatusCode":200,"destWidth":860,"destHeight":104,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn7@2020_2/2021/09/30/17-01-01-774_515e4d736bde6557.webp","sourceBytes":5168,"destBytes":9684,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":2240,"convertSpendMs":22,"createdTime":"2021-10-01 01:00:59","host":"us-51*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5 KB","destSize":"9.5 KB","compressRate":"187.4%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_0x2a.png","sourceStatusCode":200,"destWidth":1099,"destHeight":313,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn29@2020_2/2021/09/30/17-01-01-715_e72918b18335b86d.webp","sourceBytes":35340,"destBytes":51400,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":2260,"convertSpendMs":18,"createdTime":"2021-10-01 01:00:59","host":"us-033*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"34.5 KB","destSize":"50.2 KB","compressRate":"145.4%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_strtab.png","sourceStatusCode":200,"destWidth":452,"destHeight":405,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn95@2020_5/2021/09/30/17-01-01-646_f1f0fc538c58a098.webp","sourceBytes":38139,"destBytes":41038,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":2202,"convertSpendMs":12,"createdTime":"2021-10-01 01:00:59","host":"europe61*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"37.2 KB","destSize":"40.1 KB","compressRate":"107.6%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_var.png","sourceStatusCode":200,"destWidth":625,"destHeight":141,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn98@2020_4/2021/09/30/17-01-01-649_56f72b6e4ef4d730.webp","sourceBytes":10961,"destBytes":16154,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":2207,"convertSpendMs":6,"createdTime":"2021-10-01 01:00:59","host":"europe62*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"10.7 KB","destSize":"15.8 KB","compressRate":"147.4%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_0x2b.png","sourceStatusCode":200,"destWidth":1102,"destHeight":168,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn21@2020_3/2021/09/30/17-01-01-809_f0c62d81dbbbe53c.webp","sourceBytes":17427,"destBytes":24262,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":2591,"convertSpendMs":341,"createdTime":"2021-10-01 01:00:59","host":"europe67*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"17 KB","destSize":"23.7 KB","compressRate":"139.2%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_decinfo.png","sourceStatusCode":200,"destWidth":1504,"destHeight":1078,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn86@2020_2/2021/09/30/17-01-03-657_822f5585b38c8d40.webp","sourceBytes":76888,"destBytes":139422,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":4109,"convertSpendMs":120,"createdTime":"2021-10-01 01:00:59","host":"us-024*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx21","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"75.1 KB","destSize":"136.2 KB","compressRate":"181.3%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_reg.png","sourceStatusCode":200,"destWidth":984,"destHeight":81,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn11@2020_5/2021/09/30/17-01-04-002_54b10e1bc23422c2.webp","sourceBytes":6777,"destBytes":15688,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":4433,"convertSpendMs":8,"createdTime":"2021-10-01 01:00:59","host":"us-029*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.6 KB","destSize":"15.3 KB","compressRate":"231.5%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/mirai_ptea_atk_cmd_4.png","sourceStatusCode":200,"destWidth":860,"destHeight":660,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn15@2020_6/2021/09/30/17-01-04-981_cf78b55f80f4ab51.webp","sourceBytes":353643,"destBytes":172924,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":5472,"convertSpendMs":88,"createdTime":"2021-10-01 01:00:59","host":"us-017*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"345.4 KB","destSize":"168.9 KB","compressRate":"48.9%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2021/06/ptea_c2.png","sourceStatusCode":200,"destWidth":861,"destHeight":504,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn100@2020_1/2021/09/30/17-02-05-196_310c4d6107023a08.webp","sourceBytes":39950,"destBytes":56546,"targetWebpQuality":75,"feedId":45157,"totalSpendMs":4141,"convertSpendMs":26,"createdTime":"2021-10-01 01:02:01","host":"europe61*","referer":"https://blog.netlab.360.com/mirai_ptea-botnet-is-exploiting-undisclosed-kguard-dvr-vulnerability/","linkMd5ListStr":"be69d101160f1aa623419b5a4cbcd9e2","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"39 KB","destSize":"55.2 KB","compressRate":"141.5%"}],"successGithubMap":{"myreaderx25":1,"myreaderx8":1,"myreaderx6":1,"myreaderx16":1,"myreaderx21":1,"myreaderx32":1,"myreaderx22":1,"myreaderx11":1,"myreaderx3":1,"myreaderx12":1,"myreaderx1":1,"myreaderx30":1,"myreaderx5oss":1,"myreaderx29":1},"failGithubMap":{"myreaderx14":1,"myreaderx31":1}}