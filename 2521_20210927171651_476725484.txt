{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2021-09-28 01:14:39","updatedTime":"2021-09-28 01:14:39","title":"Redis分布式锁，你用对了吗？","link":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","description":"<div><div><div id=\"media\" class=\"rich_media_thumb_wrp\">\n\n            <img class=\"rich_media_thumb\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_jpg/eZzl4LXykQwA5aibdbgBjgIFIeuicFf4Br1PvcMC4DSfpKsZrDFVLw0UFMJzy2WHDyF1j9KDuhZHdYdxJRFazlRw/0?wx_fmt=jpeg?imageView2/1/w/600\">\n        </div>\n    \n\n    \n\n    <div class=\"rich_media_content\" id=\"js_content\">\n                    \n\n                    \n                    \n                    \n                    <p style=\"text-align: left;\" data-mpa-powered-by=\"yiban.io\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>今天我们聊聊分布式锁。</span></p><p style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></p><p style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><strong style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif left normal rgb><span style=\"font-size: 15px;\">1. 分布式锁是什么？</span></strong></span></p><section><br></section><section data-role=\"title\" data-tools=\"135编辑器\" data-id=\"102866\" style=\"text-align: left;\"><section style=\"text-align: left;\"><section style=\"text-align: left;\"><section data-brushtype=\"text\" style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>我们的手机有锁、车有锁、家门有锁、贵重物品会锁进保险箱。可以说，锁在我们生活中无处不在，时刻保护着我们的人身财产安全。</span><br></section></section></section></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>在计算机领域也一样，锁可以理解为针对某项资源使用权限的管理，它通常用来控制共享资源，比如一个进程内有多个线程竞争一个数据的使用权限，解决方式之一就是加锁。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>那分布式锁是什么呢？</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>顾名思义，分布式锁就是分布式场景下的锁，比如多台不同机器上的进程，去竞争同一项资源，就是分布式锁。</span></section><section style=\"text-align: left;\"><br></section><section data-role=\"title\" data-tools=\"135编辑器\" data-id=\"102866\" style=\"text-align: left;\"><section style=\"text-align: left;\"><section style=\"text-align: left;\"><section data-brushtype=\"text\" style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><span style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><strong style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><strong style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><strong style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><strong style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif left normal rgb><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>2. 分布式锁有哪些特性？</span></strong></span></strong></section></strong></section></strong></section></span></section></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>具备哪些特性的分布式锁才是一个优秀的分布式锁？</span><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>我认为要从如下几方面来看：</span></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></section></section></section></section><ul class=\"list-paddingleft-2\" style=\"list-style-type: disc;\"><li style=\"font-size: 15px;\"><p><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>互斥性</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>：锁的目的是获取资源的使用权，所以只让一个竞争者持有锁，这一点要尽可能保证；</span></p></li><li style=\"font-size: 15px;\"><p><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>安全性</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>：避免死锁情况发生。当一个竞争者在持有锁期间内，由于意外崩溃而导致未能主动解锁，其持有的锁也能够被正常释放，并保证后续其它竞争者也能加锁；</span></p></li><li style=\"font-size: 15px;\"><p><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>对称性</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>：同一个锁，加锁和解锁必须是同一个竞争者。不能把其他竞争者持有的锁给释放了，这又称为锁的可重入性；</span></p></li><li style=\"font-size: 15px;\"><p><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>可靠性</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>：需要有一定程度的异常处理能力、容灾能力。</span></p></li></ul><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><strong style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><span style=\"text-align: left;\"><strong style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif left normal rgb><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>3. 分布式锁的常用实现方式</span></strong></span></section></section></section></section></strong></section></section><section data-role=\"title\" data-tools=\"135编辑器\" data-id=\"102866\" style=\"text-align: left;\"><section style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><br></section></section></section></section><h3 style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>分布式锁，一般会依托第三方组件来实现，而利用 <strong>Redis</strong> 实现则是工作中应用最多的一种。</span></h3><p><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></p><h3 style=\"text-align: left;\"></h3><h3 style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>今天，就让我们从最基础的步骤开始，依照分布式锁的特性，层层递进，步步完善，将它优化到最优，让大家完整地了解如何用 Redis 来实现一个分布式锁。</span></h3><p><br></p><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><span style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><strong style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify rgb>3.1 最简化版本</span></strong></section></section></section></section></section></span></section></section></section></section></section><p><br></p><h3 style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>首先，当然是搭建一个最简单的实现方式，直接用 Redis 的 setnx 命令，这个命令的语法是：</span></h3><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></section><section class=\"code-snippet__fix code-snippet__js\"><ul class=\"code-snippet__line-index code-snippet__js\"><li></ul><pre class=\"code-snippet__js\" data-lang=\"cs\"><code><span class=\"code-snippet_outer\">setnx key <span class=\"code-snippet__keyword\">value</span></span></code></pre></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify></span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>如果 key 不存在，则会将 key 设置为 value，并返回 1；如果 key 存在，不会有任务影响，返回 0。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>基于这个特性，我们就可以用 setnx 实现加锁的目的：通过 setnx 加锁，加锁之后其他服务无法加锁，用完之后，再通过 delete 解锁，深藏功与名。</span></section><section style=\"white-space: normal;line-height: 1.5em;\"><br></section><section style=\"text-align: center;\"><img data-height=\"1176\" data-ratio=\"0.9607843137254902\" data-type=\"png\" data-w=\"1224\" data-width=\"1224\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4lWPlTRTicIxfXcBBPneuK2rqhgKdwkXkt45ciaIFzbjsvZTiaQosKbzeQ/640?wx_fmt=png\" style=\"max-width: 600px\"></section><h4 style=\"text-align: left;\"><br></h4><h4 style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><strong style=\"text-align: left;\"><span style=\"color: rgb(171, 25, 66);font-size: 15px;text-align: left;\">3.2 支持过期时间</span></strong></section></h4><p><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></p><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>最简化版本有一个问题：如果获取锁的服务挂掉了，那么锁就一直得不到释放，就像石沉大海，杳无音信。所以，我们需要一个超时来兜底。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>Redis 中有 <strong>expire</strong> 命令，用来设置一个 key 的超时时间。但是 setnx 和 expire 不具备原子性，如果 setnx 获取锁之后，服务挂掉，依旧是泥牛入海。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>很自然，我们会想到，set 和 expire，有没有<strong>原子操作</strong>？</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>当然有，Redis早就考虑到了这种场景，推出了如下执行语句：</span></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></section><section class=\"code-snippet__fix code-snippet__js\"><ul class=\"code-snippet__line-index code-snippet__js\"><li></ul><pre class=\"code-snippet__js\" data-lang=\"sql\"><code><span class=\"code-snippet_outer\"><span class=\"code-snippet__keyword\">set</span> <span class=\"code-snippet__keyword\">key</span> <span class=\"code-snippet__keyword\">value</span> nx ex <span class=\"code-snippet__keyword\">seconds</span></span></code></pre></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify></span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>nx 表示具备 setnx 特定，ex 表示增加了过期时间，最后一个参数就是过期时间的值。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: center;\"><img data-height=\"1162\" data-ratio=\"0.9683333333333334\" data-type=\"png\" data-w=\"1200\" data-width=\"1200\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4zvGVlqUjwcQAvCB8AqlgShZUCyrAduB5dEuxwKm2alIjzOwQl1eUmw/640?wx_fmt=png\" style=\"max-width: 600px\"></section><h4 style=\"text-align: left;\"><br></h4><h4 style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>能够支持过期时间，目前这个锁基本上是能用了。<br></span></h4><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>但是存在一个问题：会存在服务 A 释放掉服务B的锁的可能。</span></section><section style=\"text-align: left;\"><br></section><h4 style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><span style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><span style=\"text-align: left;\"><strong><span style=\"color: rgb(171, 25, 66);font-size: 15px;text-align: left;\">3.3 加上owner</span></strong></span></section></span></section></h4><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>我们来试想一下如下场景：服务 A 获取了锁，由于业务流程比较长，或者网络延迟、 GC 卡顿等原因，导致锁过期，而业务还会继续进行。这时候，业务 B 已经拿到了锁，准备去执行，这个时候服务 A 恢复过来并做完了业务，就会释放锁，而 B 却还在继续执行。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>在真实的分布式场景中，可能存在几十个竞争者，那么上述情况发生概率就很高，导致同一份资源频繁被不同竞争者同时访问，分布式锁也就失去了意义。</span></section><h4 style=\"text-align: left;\"><br></h4><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>基于这个场景，我们可以发现，问题关键在于，<strong>竞争者可以释放其他人的锁</strong>。那么在异常情况下，就会出现问题，所以我们可以进一步给出解决方案：分布式锁需要满足谁申请谁释放原则，不能释放别人的锁，也就是说，分布式锁，是要有归属的。</span></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: center;\"><img data-height=\"1372\" data-ratio=\"1.0993589743589745\" data-type=\"png\" data-w=\"1248\" data-width=\"1248\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a46cJp8wO8L6HwZwpm4zN34lseuXXdp01X8G6hPngF6cdRNPgyA3TJLw/640?wx_fmt=png\" style=\"max-width: 600px\"></section><h4 style=\"text-align: left;\"><br></h4><h4 style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><strong style=\"text-align: left;\"><span style=\"color: rgb(171, 25, 66);font-size: 15px;text-align: left;\">3.4 引入 Lua</span></strong></section></section></h4><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>加入 owner 后的版本可以称得上是完善了吗？还有没有什么隐患呢？</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>我也不卖关子了，到这一步其实还存在一个小问题，我们完整的流程是竞争者获取锁执行任务，执行完毕后检查锁是不是自己的，最后进行释放。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>流程一梳理，你们肯定明白了，执行完毕后，检查锁，再释放，这些操作不是原子化的。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>可能锁获取时还是自己的，删除时却已经是别人的了。这可怎么办呢？</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>Redis 可没有直接提供这种场景原子化的操作啊。遇事不要慌，仔细想一想，Redis 是不是还有个特性，专门整合原子操作，对，就是它——Lua。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: center;\"><img data-croporisrc=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4j0xSyEpqo00K8XNqaFvkicyCticNH9zo3Xu8vG935Q6GcbsmDtwcDianA/0?wx_fmt=png\" data-cropx1=\"0\" data-cropx2=\"1178\" data-cropy1=\"67.52866242038216\" data-cropy2=\"634.0191082802547\" data-height=\"230\" data-ratio=\"0.48132427843803055\" data-type=\"jpeg\" data-w=\"1178\" data-width=\"423\" style=\"height: 151px; width: 314px; max-width: 600px\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_jpg/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4BpRgQN2e4u6mItwXEFticnclqvbAPj2Vmyia229CuMgH8GWliakEEPtsw/640?wx_fmt=jpeg\"></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>Redis+Lua</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>，可以说是专门为解决原子问题而生。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>有了 Lua 的特性，Redis 才真正在分布式锁、秒杀等场景，有了用武之地，下面便是改造之后的流程：</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: center;\"><img data-height=\"1342\" data-ratio=\"1.2732447817836812\" data-type=\"png\" data-w=\"1054\" data-width=\"1054\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4vPjM4Ff2gf7F7ia2DNo90GUywX2035UVictSLhuzibElkeXKsCxVaibZDA/640?wx_fmt=png\" style=\"max-width: 600px\"></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>其实到了这一步，分布式锁的前三个特性：对称性、安全性、可靠性，就满足了。可以说是一个可用的分布式锁了，能满足大多数场景的需要。</span></section><section style=\"text-align: left;\"><br></section><section data-role=\"title\" data-tools=\"135编辑器\" data-id=\"102866\" style=\"text-align: left;\"><section style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section data-brushtype=\"text\" style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><strong style=\"text-align: left;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify rgb>4. 可靠性如何保证</span></section></section></strong></section></section></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><br></section></section></section></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>分布式锁的四大特性还剩下可靠性没有解决。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>针对一些异常场景，包括Redis挂掉了、业务执行时间过长、网络波动等情况，我们来一起分析如何处理。</span></section><section style=\"text-align: left;\"><br></section><h3 style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify rgb><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><strong>4.1 容灾考虑</strong></section></section></section></section></section></h3><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>前面我们谈及的内容，基本是基于单机考虑的，如果 Redis 挂掉了，那锁就不能获取了。这个问题该如何解决呢？</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>一般来说，有两种方法：主从容灾和多级部署。</span></section><section style=\"text-align: left;\"><br></section><h4 style=\"text-align: left;\"><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>主从容灾</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify></span></h4><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>最简单的一种方式，就是为 Redis 配置从节点，当主节点挂了，用从节点顶包。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: center;\"><img data-height=\"480\" data-ratio=\"0.4444444444444444\" data-type=\"png\" data-w=\"1080\" data-width=\"1080\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4m4AHY6DJJ0ne66K13aTxib3ibl94pQffxoPxW1dsZLpzlJK4aIbBRyYA/640?wx_fmt=png\" style=\"max-width: 600px\"></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>但是主从切换，需要人工参与，会提高人力成本。不过 Redis 已经有成熟的解决方案，也就是哨兵模式，可以灵活自动切换，不再需要人工介入。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: center;\"><img data-height=\"753\" data-ratio=\"0.6972222222222222\" data-type=\"png\" data-w=\"1080\" data-width=\"1080\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4KFxtnB1RKyK9ElXsuhuMibvaI7jjGasRiahvk9TDrCSsVl2xzhzocncw/640?wx_fmt=png\" style=\"max-width: 600px\"></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>通过增加从节点的方式，虽然一定程度解决了单点的容灾问题，但并不是尽善尽美的，由于同步有时延，Slave 可能会损失掉部分数据，分布式锁可能失效，这就会发生短暂的多机获取到执行权限。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>有没有更可靠的办法呢？</span></section><section style=\"text-align: left;\"><br></section><h4 style=\"text-align: left;\"><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>多机部署</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify></span></h4><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>如果对一致性的要求高一些，可以尝试多机部署，比如 Redis 的 RedLock，大概的思路就是多个机器，通常是奇数个，达到一半以上同意加锁才算加锁成功，这样，可靠性会向 ETCD 靠近。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>现在假设有 5 个 Redis 主节点，基本保证它们不会同时宕掉，获取锁和释放锁的过程中，客户端会执行以下操作：</span></section><section style=\"text-align: left;\"><br></section><ol class=\"list-paddingleft-2\" style=\"list-style-type: decimal;\"><li style=\"font-size: 15px;text-align: left;\"><p><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>向 5 个 Redis 申请加锁；</span></p></li><li style=\"font-size: 15px;text-align: left;\"><p><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>只要超过一半，也就是 3 个 Redis 返回成功，那么就是获取到了锁。如果超过一半失败，需要向每个 Redis 发送解锁命令；</span></p></li><li style=\"font-size: 15px;text-align: left;\"><p><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>由于向 5 个 Redis 发送请求，会有一定时耗，所以锁剩余持有时间，需要减去请求时间。这个可以作为判断依据，如果剩余时间已经为 0，那么也是获取锁失败；<br></span></p></li><li style=\"font-size: 15px;text-align: left;\"><p><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>使用完成之后，向 5 个 Redis 发送解锁请求。</span></p></li></ol><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: center;\"><img data-height=\"584\" data-ratio=\"0.38985313751668893\" data-type=\"png\" data-w=\"1498\" data-width=\"1498\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4LH5X5knpzibLenPgXCgZNI44ywD3B59Sx8kcygCcUyggJtxhxNiabPAA/640?wx_fmt=png\" style=\"max-width: 600px\"></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>这种模式的好处在于，如果挂了 2 台 Redis，整个集群还是可用的，给了运维更多时间来修复。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>另外，多说一句，单点 Redis 的所有手段，这种多机模式都可以使用。比如为每个节点配置哨兵模式，由于加锁是一半以上同意就成功，那么如果单个节点进行了主从切换，单个节点数据的丢失，就不会让锁失效了。这样增强了可靠性。</span></section><section style=\"text-align: left;\"><br></section><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><span style=\"font-size: 15px;\"><strong><span style=\"text-align: left;color: rgb(171, 25, 66);\">4.2 可靠性深究</span></strong></span></section></section></section></section></section><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><section style=\"display: flex;justify-content: flex-start;align-items: center;\"><br></section></section></section></section></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>是不是有 RedLock，就一定能保证可靠的分布式锁？</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>这里我先说结论：<strong>由于分布式系统中的三大困境（简称 NPC），所以没有完全可靠的分布式锁！</strong></span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>让我们来看看 RedLock 在 NPC 下的表现。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>N：Network Delay（网络延迟）</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify></span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>当分布式锁获得返回包的时间过长，此时可能虽然加锁成功，但是已经时过境迁，锁可能很快过期。RedLock 算了做了些考量，也就是前面所说的锁剩余持有时间，需要减去请求时间，如此一来，就可以一定程度解决网络延迟的问题。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>P：Process Pause（进程暂停）</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify></span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>比如发生 GC，获取锁之后 GC 了，处于 GC 执行中，然后锁超时。</span></section><section style=\"text-align: left;\"><br></section><p style=\"text-align: center;\"><img class=\"rich_pages wxw-img\" data-galleryid=\"\" data-ratio=\"0.9602510460251046\" data-s=\"300,640\" data-type=\"png\" data-w=\"956\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdsYPHZNicaJ4RtcYlhldBz0vGWibBbiaWlQugIOAXicQsxrZnxsmqyItRn4w4dWrMDzdmGlMicJibtibrVKQ/640?wx_fmt=png\" style=\"max-width: 600px\"></p><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>其他锁获取，这种情况几乎无解。这时候 GC 回来了，那么两个进程就获取到了同一个分布式锁。</span></section><section style=\"text-align: left;\"><br></section><p style=\"text-align: center;\"><img class=\"rich_pages wxw-img\" data-galleryid=\"\" data-ratio=\"0.9787234042553191\" data-s=\"300,640\" data-type=\"png\" data-w=\"940\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdsYPHZNicaJ4RtcYlhldBz0vopwhgndTo3jUWkp2fOtDcyqcP3Kj2Xib6ICNdicY2a8pNicQaNEUFSb4Q/640?wx_fmt=png\" style=\"max-width: 600px\"></p><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>也许你会说，在 GC 回来之后，可以再去查一次啊？</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>这里有两个问题，首先你怎么知道 GC 回来了？这个可以在做业务之前，通过时间，进行一个粗略判断，但也是很吃场景经验的；第二，如果你判断的时候是 OK 的，但是判断完 GC 了呢？这点 RedLoc k是无法解决的。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>C：Clock Drift（时钟漂移）</span></strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>如果竞争者 A，获得了 RedLock，在 5 台分布式机器上都加上锁。</span><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>为了方便分析，我们直接假设 </span><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>5 台机器都发生了时钟漂移，锁瞬间过期了。</span><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>这时候竞争者 </span><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>B 拿到了锁，此时 </span><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>A 和 </span><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>B </span><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>拿到了相同的执行权限。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>根据上述的分析，可以看出，<strong>RedLock 也不能扛住 NPC 的挑战</strong>。因此，单单从分布式锁本身出发，完全可靠是不可能的。要实现一个相对可靠的分布式锁机制，还是需要和业务的配合，业务本身要幂等可重入，这样的设计可以省却很多麻烦。</span></section><section style=\"text-align: left;\"><br></section><section style=\"text-align: left;\"><strong><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify rgb>5. 复盘</span></strong></section><section style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></section><section data-role=\"paragraph\" style=\"text-align: left;\"><p style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>我们围绕互斥性、安全性、对称性层层递进，实现了一个 Redis 分布式锁，这样的架构在大多数业务场景都是完全够用的。</span></p><p style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify><br></span></p><p style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>同时，我们也针对可靠性，探讨了主从容灾、Red Lock 等解决方案，并分析了 NPC 异常场景，了解到分布式锁在什么情况会失去作用，这些知识在实际的业务中都非常实用，能够在实际开发中做出正确的决策。</span></p><p style=\"text-align: left;\"><br></p><p style=\"text-align: left;\"><span style=\"font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, \" helvetica neue sc sans gb yahei ui arial sans-serif justify>建议对分布式锁不要强依赖，没有绝对可靠的分布式锁，分布式锁需要与业务的联动配合更加切实可行，脱离了业务，就是空中楼阁，不着实地。</span></p></section><p style=\"white-space: normal;\"><span style=\"font-size: 15px;\"></span></p><p style=\"white-space: normal;text-align: center;\"><br></p><p style=\"white-space: normal;text-align: center;\"><span style=\"font-size: 15px;color: rgb(136, 136, 136);\">- EOF -</span></p><section donone=\"shifuMouseDownCard('shifu_c_030')\" label=\"Copyright Reserved by PLAYHUDONG.\" style=\"margin-top: 1em;margin-bottom: 1em;white-space: normal;text-align: start;max-width: 100%;caret-color: rgb(0, 0, 0);color: rgb(0, 0, 0);border-width: 0px;border-style: initial;border-color: initial;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><section style=\"margin-left: 1em;max-width: 100%;line-height: 1.4;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><span style=\"padding: 3px 8px;max-width: 100%;border-radius: 4px;color: rgb(255, 255, 255);background-color: rgb(255, 105, 31);font-family: inherit;text-align: inherit;text-decoration: inherit;font-size: 16px;box-sizing: border-box !important;overflow-wrap: break-word !important;\">推荐阅读</span>  <span style=\"margin-left: 4px;padding: 3px 8px;max-width: 100%;border-radius: 1.2em;color: rgb(255, 255, 255);line-height: 1.2;background-color: rgb(204, 204, 204);font-family: inherit;text-align: inherit;text-decoration: inherit;border-color: rgb(249, 110, 87);font-size: 12px;box-sizing: border-box !important;overflow-wrap: break-word !important;\">点击标题可跳转</span></section><section style=\"margin-top: -11px;padding: 22px 16px 16px;max-width: 100%;border-width: 1px;border-style: solid;border-color: rgb(255, 105, 31);color: rgb(51, 51, 51);font-size: 1em;font-family: inherit;text-align: inherit;text-decoration: inherit;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><p style=\"max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><span style=\"text-decoration: underline;font-size: 13px;\">1、<a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;mid=2651483441&amp;idx=1&amp;sn=da6af4ac2492d8c820fc871ea6da48b9&amp;chksm=bd25014e8a528858bcafb05192005168f049dba0de7f757a81b2499f69a94fb5bab945b05542&amp;scene=21#wechat_redirect\" data-itemshowtype=\"0\" tab=\"innerlink\" data-linktype=\"2\"></a><a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;mid=2651495822&amp;idx=1&amp;sn=7b0f425fae0ea2938ea78fe7faa8493c&amp;chksm=bd25f1f18a5278e7b393cfbf3a7ca60f88a2baebc074294f1cd8a78dde3c9a555be1338c5ceb&amp;scene=21#wechat_redirect\" data-itemshowtype=\"11\" tab=\"innerlink\" style=\"font-size: 13px;text-align: start;white-space: normal;caret-color: rgb(0, 0, 0);\" data-linktype=\"2\">分布式锁中的王者方案：Redisson</a></span></p><p style=\"max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><span style=\"text-decoration: underline;font-size: 13px;\">2、<a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;mid=2651483441&amp;idx=1&amp;sn=da6af4ac2492d8c820fc871ea6da48b9&amp;chksm=bd25014e8a528858bcafb05192005168f049dba0de7f757a81b2499f69a94fb5bab945b05542&amp;scene=21#wechat_redirect\" data-itemshowtype=\"0\" tab=\"innerlink\" style=\"font-size: 13px;text-align: start;white-space: normal;caret-color: rgb(0, 0, 0);\" data-linktype=\"2\">Redis 分布式锁的正确实现方式（ Java 版 ）</a></span></p><p style=\"max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><span style=\"text-decoration: underline;font-size: 13px;\">3、<a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;mid=2651496000&amp;idx=2&amp;sn=fddc2664e9a435bc973ebee0f3d2798a&amp;chksm=bd25f23f8a527b29418646047c5da6d3b7df84c8d1e4086b91671444091a05b9b8f35cf4914b&amp;scene=21#wechat_redirect\" data-itemshowtype=\"11\" tab=\"innerlink\" data-linktype=\"2\">深度剖析：Redis分布式锁到底安全吗？看完这篇文章彻底懂了！</a></span></p></section></section><p style=\"white-space: normal;caret-color: rgb(0, 0, 0);color: rgb(0, 0, 0);text-align: start;max-width: 100%;min-height: 1em;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><br></p><p style=\"white-space: normal;text-align: center;\"><span style=\"max-width: 100%;font-size: 14px;color: rgb(255, 169, 0);box-sizing: border-box !important;overflow-wrap: break-word !important;\">看完本文有收获？请转发分享给更多人</span><br></p><p style=\"white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><strong style=\"max-width: 100%;color: rgb(255, 169, 0);box-sizing: border-box !important;overflow-wrap: break-word !important;\">关注「ImportNew」，提升Java技能</strong></p><p style=\"white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><img data-ratio=\"0.9166666666666666\" data-s=\"300,640\" data-type=\"jpeg\" data-w=\"600\" style=\"box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 600px !important; max-width: 600px\" width=\"auto\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/2A8tXicCG8ylbWIGfdoDED35IRRySQZTXUkJ1eop9MHApzFibKnOo0diboXpl0rmS5mH78YJhsWQv0dhv718A6kUA/640?wx_fmt=jpeg\"></p><p style=\"white-space: normal;text-align: right;\"><span style=\"font-size: 14px;\"></span><span style=\"max-width: 100%;font-family: -apple-system-font, system-ui, \" helvetica neue sc sans gb yahei ui arial sans-serif center break-word border-box>点赞和在看就是最大的支持</span><span style=\"max-width: 100%;font-family: -apple-system-font, system-ui, \" helvetica neue sc sans gb yahei ui arial sans-serif center break-word border-box>❤️</span><span style=\"color: rgb(255, 76, 65);font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;font-weight: bold;letter-spacing: 0.544px;white-space: pre-line;font-size: 16px;widows: 1;word-spacing: 2px;caret-color: rgb(51, 51, 51);background-color: rgb(255, 255, 255);\"></span></p>\n                </div>\n\n    \n    <br>\n\n    \n        <a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;mid=2651501333&amp;idx=1&amp;sn=1ed7939267015727f991ec459cd581a0&amp;chksm=bd25df6a8a52567c47f7b72b0e0ebe76f1e509709c997a8f0f91469fa368c7fc78b6315e7602#rd\" style=\"color: blue\" class=\"media_tool_meta meta_primary\">原文</a>\n        <br>\n    \n\n    \n\n    <img alt=\"\" width=\"1px\" height=\"1px\" class=\"\" style=\"width:1px;height:1px;display:none\" src=\"http://www.jintiankansha.me/rss_static/54540/NTJxu7ekJV\"></div></div>","descriptionType":"html","publishedDate":"Sun, 26 Sep 2021 03:30:00 +0000","feedId":2521,"bgimg":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_jpg/eZzl4LXykQwA5aibdbgBjgIFIeuicFf4Br1PvcMC4DSfpKsZrDFVLw0UFMJzy2WHDyF1j9KDuhZHdYdxJRFazlRw/0?wx_fmt=jpeg?imageView2/1/w/600","linkMd5":"74e3268d1e69c023d4822ded21698ad2","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn12@2020_6/2021/09/27/17-14-48-535_1672b83111334155.webp","destWidth":650,"destHeight":276,"sourceBytes":15670,"destBytes":11878,"author":"","articleImgCdnMap":{"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_jpg/eZzl4LXykQwA5aibdbgBjgIFIeuicFf4Br1PvcMC4DSfpKsZrDFVLw0UFMJzy2WHDyF1j9KDuhZHdYdxJRFazlRw/0?wx_fmt=jpeg?imageView2/1/w/600":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn12@2020_6/2021/09/27/17-14-48-535_1672b83111334155.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4lWPlTRTicIxfXcBBPneuK2rqhgKdwkXkt45ciaIFzbjsvZTiaQosKbzeQ/640?wx_fmt=png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn51@2020_3/2021/09/27/17-15-17-261_08fdbc8d14d88aba.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4zvGVlqUjwcQAvCB8AqlgShZUCyrAduB5dEuxwKm2alIjzOwQl1eUmw/640?wx_fmt=png":null,"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a46cJp8wO8L6HwZwpm4zN34lseuXXdp01X8G6hPngF6cdRNPgyA3TJLw/640?wx_fmt=png":null,"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_jpg/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4BpRgQN2e4u6mItwXEFticnclqvbAPj2Vmyia229CuMgH8GWliakEEPtsw/640?wx_fmt=jpeg":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn28@2020_6/2021/09/27/17-15-00-292_a2baf171d2d6cef6.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4vPjM4Ff2gf7F7ia2DNo90GUywX2035UVictSLhuzibElkeXKsCxVaibZDA/640?wx_fmt=png":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn43@2020_6/2021/09/27/17-15-46-183_141652fc7a0bb97d.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4m4AHY6DJJ0ne66K13aTxib3ibl94pQffxoPxW1dsZLpzlJK4aIbBRyYA/640?wx_fmt=png":null,"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4KFxtnB1RKyK9ElXsuhuMibvaI7jjGasRiahvk9TDrCSsVl2xzhzocncw/640?wx_fmt=png":null,"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4LH5X5knpzibLenPgXCgZNI44ywD3B59Sx8kcygCcUyggJtxhxNiabPAA/640?wx_fmt=png":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn15@2020_5/2021/09/27/17-15-43-944_8568c533bcb53797.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdsYPHZNicaJ4RtcYlhldBz0vGWibBbiaWlQugIOAXicQsxrZnxsmqyItRn4w4dWrMDzdmGlMicJibtibrVKQ/640?wx_fmt=png":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn36@2020_4/2021/09/27/17-15-03-650_a1802e9d20098008.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdsYPHZNicaJ4RtcYlhldBz0vopwhgndTo3jUWkp2fOtDcyqcP3Kj2Xib6ICNdicY2a8pNicQaNEUFSb4Q/640?wx_fmt=png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn56@2020_6/2021/09/27/17-15-16-675_4bc50f19adf32ef3.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/2A8tXicCG8ylbWIGfdoDED35IRRySQZTXUkJ1eop9MHApzFibKnOo0diboXpl0rmS5mH78YJhsWQv0dhv718A6kUA/640?wx_fmt=jpeg":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn40@2020_1/2021/09/27/17-14-55-912_f93d0239d4369c75.webp","http://www.jintiankansha.me/rss_static/54540/NTJxu7ekJV":null},"publishedOrCreatedDate":1632762879864}],"record":{"createdTime":"2021-09-28 01:14:39","updatedTime":"2021-09-28 01:14:39","feedId":2521,"fetchDate":"Mon, 27 Sep 2021 17:14:39 +0000","fetchMs":544,"handleMs":17,"totalMs":132919,"newArticles":0,"totalArticles":5,"status":1,"type":0,"ip":"4cf9ab886509ef3fd2ece0a16b714d9c","hostName":"europe-57*","requestId":"1438007693e74e96a4f3dd2260f96bff_2521","contentType":"application/rss+xml","totalBytes":241630,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":13,"articlesImgsGithubTotal":8,"successGithubMap":{"myreaderx15":1,"myreaderx7":1,"myreaderx6":1,"myreaderx33":1,"myreaderx22":1,"myreaderx30":1,"myreaderx5oss":1,"myreaderx19":1},"failGithubMap":{}},"feed":{"createdTime":"2020-08-24 21:31:41","updatedTime":"2020-09-01 10:09:47","id":2521,"name":"ImportNew","url":"http://feedmaker.kindle4rss.com/feeds/importnew.weixin.xml","subscriber":null,"website":null,"icon":"http://www.sogou.com/images/logo/new/favicon.ico?v=4","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx63/cdn9@2020_3/2020/09/01/02-08-31-388_d24121c9beed1de6.ico","description":"伯乐在线旗下账号，专注Java技术分享，包括Java基础技术、进阶技能、架构设计和Java技术领域动态等。","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2021-09-28 01:16:51","updatedTime":"2021-09-28 01:16:51","id":null,"feedId":2521,"linkMd5":"74e3268d1e69c023d4822ded21698ad2"}],"tmpCommonImgCdnBytes":11878,"tmpBodyImgCdnBytes":229752,"tmpBgImgCdnBytes":0,"extra4":{"start":1632762878984,"total":0,"statList":[{"spend":863,"msg":"获取xml内容"},{"spend":17,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":122942,"msg":"正文链接上传到cdn"}]},"extra5":13,"extra6":9,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"http://www.jintiankansha.me/rss_static/54540/NTJxu7ekJV","sourceStatusCode":405,"sourceBytes":0,"destBytes":0,"feedId":2521,"totalSpendMs":1387,"convertSpendMs":0,"createdTime":"2021-09-28 01:14:48","host":"europe-56*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[405],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://www.jintiankansha.me/rss_static/54540/NTJxu7ekJV","sourceStatusCode":405,"sourceBytes":0,"destBytes":0,"feedId":2521,"totalSpendMs":696,"convertSpendMs":0,"createdTime":"2021-09-28 01:14:50","host":"us-028*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[405],"sourceSize":"0","destSize":"0"},null,null,null,null,null,null,null,null],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe-56.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[405]},"http://us-018.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-037.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://europe65.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-002.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-028.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[405]},"http://us-52.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]},"http://us-026.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]},"http://us-006.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]},"http://us-025.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-001.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]},"http://europe69.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-017.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_jpg/eZzl4LXykQwA5aibdbgBjgIFIeuicFf4Br1PvcMC4DSfpKsZrDFVLw0UFMJzy2WHDyF1j9KDuhZHdYdxJRFazlRw/0?wx_fmt=jpeg?imageView2/1/w/600","sourceStatusCode":200,"destWidth":650,"destHeight":276,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn12@2020_6/2021/09/27/17-14-48-535_1672b83111334155.webp","sourceBytes":15670,"destBytes":11878,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":9070,"convertSpendMs":6,"createdTime":"2021-09-28 01:14:39","host":"europe-23*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2,74e3268d1e69c023d4822ded21698ad2","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"15.3 KB","destSize":"11.6 KB","compressRate":"75.8%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/2A8tXicCG8ylbWIGfdoDED35IRRySQZTXUkJ1eop9MHApzFibKnOo0diboXpl0rmS5mH78YJhsWQv0dhv718A6kUA/640?wx_fmt=jpeg","sourceStatusCode":200,"destWidth":600,"destHeight":550,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn40@2020_1/2021/09/27/17-14-55-912_f93d0239d4369c75.webp","sourceBytes":37143,"destBytes":31608,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":7171,"convertSpendMs":13,"createdTime":"2021-09-28 01:14:49","host":"us-52*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"36.3 KB","destSize":"30.9 KB","compressRate":"85.1%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_jpg/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4BpRgQN2e4u6mItwXEFticnclqvbAPj2Vmyia229CuMgH8GWliakEEPtsw/640?wx_fmt=jpeg","sourceStatusCode":200,"destWidth":1080,"destHeight":520,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn28@2020_6/2021/09/27/17-15-00-292_a2baf171d2d6cef6.webp","sourceBytes":32120,"destBytes":20240,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":11454,"convertSpendMs":22,"createdTime":"2021-09-28 01:14:49","host":"us-001*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"31.4 KB","destSize":"19.8 KB","compressRate":"63%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdsYPHZNicaJ4RtcYlhldBz0vGWibBbiaWlQugIOAXicQsxrZnxsmqyItRn4w4dWrMDzdmGlMicJibtibrVKQ/640?wx_fmt=png","sourceStatusCode":200,"destWidth":956,"destHeight":918,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn36@2020_4/2021/09/27/17-15-03-650_a1802e9d20098008.webp","sourceBytes":56756,"destBytes":33140,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":15184,"convertSpendMs":32,"createdTime":"2021-09-28 01:14:48","host":"europe65*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"55.4 KB","destSize":"32.4 KB","compressRate":"58.4%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdsYPHZNicaJ4RtcYlhldBz0vopwhgndTo3jUWkp2fOtDcyqcP3Kj2Xib6ICNdicY2a8pNicQaNEUFSb4Q/640?wx_fmt=png","sourceStatusCode":200,"destWidth":940,"destHeight":920,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn56@2020_6/2021/09/27/17-15-16-675_4bc50f19adf32ef3.webp","sourceBytes":57279,"destBytes":33558,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":28179,"convertSpendMs":35,"createdTime":"2021-09-28 01:14:48","host":"europe69*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"55.9 KB","destSize":"32.8 KB","compressRate":"58.6%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4lWPlTRTicIxfXcBBPneuK2rqhgKdwkXkt45ciaIFzbjsvZTiaQosKbzeQ/640?wx_fmt=png","sourceStatusCode":200,"destWidth":1080,"destHeight":1038,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn51@2020_3/2021/09/27/17-15-17-261_08fdbc8d14d88aba.webp","sourceBytes":143835,"destBytes":31098,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":28490,"convertSpendMs":56,"createdTime":"2021-09-28 01:14:49","host":"us-006*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"140.5 KB","destSize":"30.4 KB","compressRate":"21.6%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4LH5X5knpzibLenPgXCgZNI44ywD3B59Sx8kcygCcUyggJtxhxNiabPAA/640?wx_fmt=png","sourceStatusCode":200,"destWidth":1080,"destHeight":421,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn15@2020_5/2021/09/27/17-15-43-944_8568c533bcb53797.webp","sourceBytes":170242,"destBytes":29938,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":55208,"convertSpendMs":26,"createdTime":"2021-09-28 01:14:49","host":"us-026*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"166.3 KB","destSize":"29.2 KB","compressRate":"17.6%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/HQKXnkPzzdtC8FiaIngFxzgzkAx7R37a4vPjM4Ff2gf7F7ia2DNo90GUywX2035UVictSLhuzibElkeXKsCxVaibZDA/640?wx_fmt=png","sourceStatusCode":200,"destWidth":1054,"destHeight":1342,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn43@2020_6/2021/09/27/17-15-46-183_141652fc7a0bb97d.webp","sourceBytes":158801,"destBytes":50170,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":57385,"convertSpendMs":69,"createdTime":"2021-09-28 01:14:49","host":"us-017*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%8C%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F","linkMd5ListStr":"74e3268d1e69c023d4822ded21698ad2","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"155.1 KB","destSize":"49 KB","compressRate":"31.6%"}],"successGithubMap":{"myreaderx15":1,"myreaderx7":1,"myreaderx6":1,"myreaderx33":1,"myreaderx22":1,"myreaderx30":1,"myreaderx5oss":1,"myreaderx19":1},"failGithubMap":{}}