{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-13 03:22:54","updatedTime":"2020-10-13 03:22:54","title":"HELO Winnti: Attack or Scan?","link":"https://www.lastline.com/?p=10884","description":"<p>Since its first attack was discovered nearly a decade ago, Winnti has evolved into an advanced and sophisticated toolkit leveraged by several actors such as APT17, Axiom, Barium, and PassCV, just to name a few. All these actors have been sharing core tactics, techniques, and procedures (TTPs), leading to highly persistent implants targeting organizations from the online gaming industry to high-tech companies around the globe. It comes as no surprise that both security vendors and researchers are still scrutinizing and tracking this specific threat.</p>\n<p>While no new campaign has been publicly reported after the one targeting German Pharmaceutical companies in April 2019 [1], since July 2019 we have been seeing a dramatic increase of network activity related to Winnti. Figure 1 displays all daily alerts from more than two months of telemetry data since mid-June 2019.</p>\n<div id=\"attachment_10900\" style=\"width: 810px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10900\" class=\"wp-image-10900 size-medium\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-daily-alerts-timeline-800x256.jpg\" alt=\"Displays all Winnti: daily alerts from more than two months of telemetry data since mid-June 2019.\" width=\"800\" height=\"256\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-daily-alerts-timeline-800x256.jpg 800w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-daily-alerts-timeline-768x246.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-daily-alerts-timeline-1024x328.jpg 1024w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-daily-alerts-timeline-700x224.jpg 700w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-daily-alerts-timeline.jpg 1160w\" sizes=\"(max-width: 800px) 100vw, 800px\" /><p id=\"caption-attachment-10900\" class=\"wp-caption-text\">Figure 1: Winnti daily alerts timeline.</p></div>\n<p>As it turned out, this telemetered traffic was due to external Winnti check-ins or “Winnti HELO” messages sent out by non-malicious Winnti scanners looking for hosts infected by the Winnti implant. Thanks to the massive increase of investigation-oriented traffic, the actual signal from real attacks is buried in the noise generated by scan traffic. Such extremely low signal-to-noise ratio poses huge challenges for both investigators and customers looking to identify real attacks.</p>\n<p>In this report, we investigate the magnitude of this phenomenon, attempt to mitigate these challenges, and propose an effective triage process benefiting the whole security community. We start by providing a brief overview of the Winnti toolkit implants lifecycle. Then, we discuss the last two months of internal telemetry data showing the dramatic increase of Winnti traffic from various sources, and explain why this is a challenging problem for both researchers and network administrators. Finally, we provide a deep dive on the issue, share our findings, and propose an effective triage process tailored to both researchers and security professionals.</p>\n<h3>What is Winnti?</h3>\n<p>Winnti represents a malware family with Remote Access Trojan (RAT) functionalities. The memory-resident malware is highly persistent: once it is successfully installed on a victim’s host, it gives the criminals the capability to control the infected computer without the victim’s knowledge. Historically, the targets attacked vary from online gaming companies to pharmaceutical industry (more details are discussed in a later section).</p>\n<p>The actors behind Winnti have been active at least since 2009, and, throughout the decade since its initial attack, Winnit has been evolving into a more advanced and sophisticated toolkit. The toolkit comprises four main components, all taking part in the execution cycle (as thoroughly explained by Novetta in their Winnti Analysis [3]):</p>\n<ul>\n<li><em>Dropper</em>: a module responsible for dropping the Winnti malware on a victim’s machine</li>\n<li><em>Worker</em>: a module responsible for communication (such as parsing HELO messages) and plugin management</li>\n<li><em>Service</em>: a module whose primary function is to activate the engine component</li>\n<li><em>Engine</em>: a module that only exists in memory once activated by the <em>Service</em> component; its main function is to fulfill the malware installation process after the <em>Service</em> component passes control to the Install function in the engine component</li>\n</ul>\n<p>Extensive investigations on the malware have been published by Kaspersky [2], Novetta [3], and Thyssenkrupp&#8217;s CERT [4], with a more recent case study by Chronicle [5] about a Linux variant. Once the highly persistent memory-resident implant is successfully installed on a victim’s host, the malware operators can initiate a check-in connection directly to an infected host without relying on a C2 server (though it does call out to a C2 server to receive commands in some cases). Figure 2 shows the main timeline of the malware development since the first reported attack and the possible threat groups behind the attacks according to various reports [2-3, 6].</p>\n<div id=\"attachment_10911\" style=\"width: 802px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10911\" class=\"wp-image-10911 size-full\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-evolution-timeline.jpg\" alt=\"Shows the main Winnti timeline of the malware development since the first reported attack and the possible threat groups behind the attacks according to various reports.\" width=\"792\" height=\"310\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-evolution-timeline.jpg 792w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-evolution-timeline-768x301.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-evolution-timeline-700x274.jpg 700w\" sizes=\"(max-width: 792px) 100vw, 792px\" /><p id=\"caption-attachment-10911\" class=\"wp-caption-text\">Figure 2: Winnti evolution timeline.</p></div>\n<h3>Winnti 1.0/2.0</h3>\n<p>Kasperksy initially reported on attacks relying on Winnti 1.0 and 2.0 in 2013, including evidence of activity dating back to 2009 [2]. Winnti 1.0 was capable of stealing certificates from its targets, and is believed to be the very first identified malware with a valid (stolen) certificate targeting the Windows 64-bit operating systems. Certificates have been becoming increasingly important as recent operating systems have been starting to limit execution to digitally signed executables. As a consequence, the abuse of digitally signed malware became a very effective and sustainable approach in Winnti-related attacks. The APT17, Barium, Lead, and PassCV groups are thought to have strong connections with these attacks [6].</p>\n<h3>Winnti 3.0</h3>\n<p>Winnti 3.0 was first made public in the article published by Novetta in 2015 [3]. The report notes that the malware was actually compiled in mid-to-late 2014. According to the Novetta’s findings, Winnti 3.0 is very similar to its predecessors, but the dropper component evolved to incorporate some anti-analysis mechanisms, making the malware investigation more difficult. The criminal activity exploiting Winnti 3.0 exhibits TTPs that are very similar to attacks operated by the Axiom group, which is known to carry out cyber-espionage attacks against a whole range of industries.</p>\n<h3>Targeted Industries: From Games to Pills</h3>\n<p>Winnti-based attacks initially targeted online gaming companies. The motivation for these attacks was twofold. Once gained control of the game servers, criminals could monetize the attack by converting virtual funds into real money and/or deploying stolen source code from the compromised servers into their own pirate servers. The second objective was to steal code-signing certificates, which could then be used to sign malicious applications when attacking higher-value organizations.</p>\n<p>Such exclusive targeting (only game organizations) changed by the end of 2014, marking the expansion of the target focus to other industries, German chemical and pharmaceutical conglomerates in particular [2-3]. The latest victims of this wave were reported in April 2019 [1]. Note that the list of targets does not stop here, as political activists and news portals had also been targeted [2,6]. Figure 3 summarizes which entities have been targeted over time, based on the information we collected at the time of the investigation.</p>\n<div id=\"attachment_10910\" style=\"width: 802px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10910\" class=\"wp-image-10910 size-full\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-targeted-entities-over-time.jpg\" alt=\"Summarizes which Winnti entities have been targeted over time, based on the information we collected at the time of the investigation.\" width=\"792\" height=\"310\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-targeted-entities-over-time.jpg 792w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-targeted-entities-over-time-768x301.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-targeted-entities-over-time-700x274.jpg 700w\" sizes=\"(max-width: 792px) 100vw, 792px\" /><p id=\"caption-attachment-10910\" class=\"wp-caption-text\">Figure 3: Winnti targeted entities over time.</p></div>\n<h3>Tracking Winnti</h3>\n<p>As we mentioned before, once the implant is installed on an infected host, the attack operators can directly communicate with the host [5]. To be more specific, a rootkit deployed together with the <em>worker</em> component allows Winnti to intercept and redirect specifically crafted TCP connections from ports already used by legitimate applications: if the first part of the payload of the TCP flow is 16 bytes long, and follows a specific format, the rootkit redirects the rest of the connection towards its <em>worker</em> module (see [3,5] for more details).</p>\n<p>This specific communication approach between the threat actor and the infected host provides a great way for investigators to track Winnti activity and subsequently detect the malware. This was successfully demonstrated by ThyssenKrupp’s CERT, as they recently released a set of open-source tools able to detect and mimic “Winnti HELO” messages [4]. The underlying logic is quite straightforward: the tool starts by sending a 16-byte long message to a candidate host (any destination port already open would work), and checks the replied message to determine whether the implant is installed. This allowed security companies and professionals to develop and deploy mass-scan agents scouting the Internet, hoping to find hosts infected by the Winnti implant.</p>\n<p>Therefore, determining whether a host is infected is equivalent to finding out how the host responds to a “Winnit HELO” message (first packet of the Winnti check-in). This leads to two different scenarios (see Figure 4):</p>\n<ul>\n<li>If a host is <strong>not</strong> infected by Winnti, it will just reply with an error message depending on the particular application listening on the port receiving the “Winnti HELO” packet.</li>\n<li>If instead the host <strong>is infected</strong>, the Winnti rootkit will hijack the “Winnti HELO” message, and redirect it to the <em>worker</em> module of the malware. Once the HELO message is validated, the <em>worker</em> component checks if the 3rd DWORD value in the operation request message (second packet of the Winnti check-in) is <strong>\\0xABC18CBA</strong>, the magic number [5]. If verified successfully, it will execute the request and provide the host’s system information.</li>\n</ul>\n<p>It is worth noting that the “Winnti HELO” message (the first packet of a Winnti check-in as shown in Figure 4) comprises 4 DWORDs generated by a pseudo-random integer number generator [4-5]. We will detail how the HELO messages are generated in a later section.</p>\n<div id=\"attachment_10904\" style=\"width: 810px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10904\" class=\"size-medium wp-image-10904\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-check-ins-and-responses-800x498.jpg\" alt=\"If a host is not infected by Winnti, it will just reply with an error message depending on the particular application listening on the port receiving the &#34;Winnti HELO&#34; packet. If instead the host is infected, the Winnti rootkit will hijack the &#34;Winnti HELO&#34; message, and redirect it to the worker module of the malware.\" width=\"800\" height=\"498\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-check-ins-and-responses-800x498.jpg 800w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-check-ins-and-responses-768x479.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-check-ins-and-responses-1024x638.jpg 1024w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-check-ins-and-responses-700x436.jpg 700w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-check-ins-and-responses.jpg 1048w\" sizes=\"(max-width: 800px) 100vw, 800px\" /><p id=\"caption-attachment-10904\" class=\"wp-caption-text\">Figure 4: Winnti check-ins and responses from hosts with/out infection.</p></div>\n<h3>New challenges</h3>\n<p>The idea of using mimicked “Winnti HELO” messages does indeed ease the challenge of finding infected hosts, but it also introduces a new problem: noise. Since all publicly available signatures (like the Suricata IDS rule released as part of the aforementioned open-source tools) flag a possible Winnti attack whenever a “Winnti HELO” message is detected, each external scan now automatically translates to a new alert.</p>\n<p>As a result, the superimposed network traffic with dominant noisy scan signals poses huge challenges for both researchers and SOC analysts. In particular:</p>\n<ul>\n<li>It greatly impairs the threat hunters’ ability to monitor the threat actors’ activity. Although emulating the “Winnti HELO” message does help to disclose the number of implants that are present in a network, the process of differentiating real attacks from benign scans becomes much more complicated. Before researchers started scanning the whole Internet, every rogue HELO message would have been correlated to an actual attack. Now, it is no longer the case.</li>\n<li>It also significantly slows down the triage of a network event in a SOC, which is already challenged by a non-negligible number of cyber alerts and attacks from other vectors. The dramatic increase of alerts caused by non-malicious Winnti scanners requires more resources and effort for investigation, making the analysts’ work even more challenging and less efficient.</li>\n</ul>\n<p>As it is often the case, the situation can be eased by deploying more complex but expensive solutions, able to deep-inspect the Winnti protocol. This approach might not however be practical for many organizations, small companies in particular, which are left with several challenges to effectively triage Winnti alerts. In the following sections, we will briefly review the most common examples, and we will conclude with an effective and easy-to-implement method that can considerably mitigate all these challenges.</p>\n<h3>Rely on source IP addresses? No</h3>\n<p>One might suggest to use the source IP address to determine whether the check-in is a scan or an attack. Figure 5 illustrates what a Winnti check-in traffic looks like, where the host <em>192.168.2.6</em>, part of the protected network, receives check-in messages from both the <em>218.211.168.178</em> and <em>155.94.254.143</em> IP addresses. Is there an attack within the traffic?</p>\n<div id=\"attachment_10908\" style=\"width: 810px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10908\" class=\"size-medium wp-image-10908\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/attack-or-a-scan-800x256.jpg\" alt=\"Illustrates what a Winnti check-in traffic looks like.\" width=\"800\" height=\"256\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/attack-or-a-scan-800x256.jpg 800w, https://www.lastline.com/wp-content/uploads/2019/09/attack-or-a-scan-768x246.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/attack-or-a-scan-1024x328.jpg 1024w, https://www.lastline.com/wp-content/uploads/2019/09/attack-or-a-scan-700x224.jpg 700w, https://www.lastline.com/wp-content/uploads/2019/09/attack-or-a-scan.jpg 1160w\" sizes=\"(max-width: 800px) 100vw, 800px\" /><p id=\"caption-attachment-10908\" class=\"wp-caption-text\">Figure 5: Is it an attack or a scan?</p></div>\n<p>There is no easy answer to this question, because the scans are generated from several source IP addresses, many changing every week, making whitelisting a non-scalable work-around. Figure 6 shows the source IP address distribution based on two months of internal telemetry data since June 2019.</p>\n<div id=\"attachment_10909\" style=\"width: 810px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10909\" class=\"size-medium wp-image-10909\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/Check-in-source-IP-address-800x296.jpg\" alt=\"Shows the source IP address distribution based on two months of internal telemetry data since June 2019. \" width=\"800\" height=\"296\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/Check-in-source-IP-address-800x296.jpg 800w, https://www.lastline.com/wp-content/uploads/2019/09/Check-in-source-IP-address-768x284.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/Check-in-source-IP-address-1024x379.jpg 1024w, https://www.lastline.com/wp-content/uploads/2019/09/Check-in-source-IP-address-700x259.jpg 700w, https://www.lastline.com/wp-content/uploads/2019/09/Check-in-source-IP-address.jpg 1160w\" sizes=\"(max-width: 800px) 100vw, 800px\" /><p id=\"caption-attachment-10909\" class=\"wp-caption-text\">Figure 6: Check-in source IP address distribution between June &#8211; August 2019.</p></div>\n<p>As we can see, the IP addresses are from a wide range of sources. Interestingly, some are well-known scanners (which can be easily whitelisted), but many IP addresses are unknown, or belong to random cloud VMs (possibly provisioned/deployed by researchers inspired by recent news). Examples of well-known scanners are:</p>\n<p>● 155.94.254.143: scanner03.project25499.com<br />\n● 172.104.242.173: winnti-scanner-victims-will-be-notified.threatsinkhole.com<br />\n● 176.58.124.134: tequilaboomboom.club<br />\n● 98.143.148.135: scanner05.project25499.com</p>\n<p>The two IP addresses dominating the chart above are from this last set. For instance, one has a single self-explanatory page with the following message:</p>\n<div id=\"attachment_10903\" style=\"width: 750px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10903\" class=\"wp-image-10903 size-full\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/cloud-VM-based-scanner.jpg\" alt=\"Single self-explanatory landing page from a cloud VM-based scanner.\" width=\"740\" height=\"204\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/cloud-VM-based-scanner.jpg 740w, https://www.lastline.com/wp-content/uploads/2019/09/cloud-VM-based-scanner-700x193.jpg 700w\" sizes=\"(max-width: 740px) 100vw, 740px\" /><p id=\"caption-attachment-10903\" class=\"wp-caption-text\">Figure 7: A landing page from a cloud VM-based scanner.</p></div>\n<p>It is worth noting that we also found some evidence of scans originating from private IP addresses, indicating that some of the check-ins were coming from within the local network. While we acknowledge that proactive security teams might be actively looking for infected endpoints, the most probable explanation is that such internal hosts might also be acting as a router, SNATing connections originating from outside (this normally happens when the traffic is not monitored from the perimeter but from inside the network), as depicted in Figure 8.</p>\n<div id=\"attachment_10912\" style=\"width: 810px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10912\" class=\"wp-image-10912 size-medium\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-scans-800x256.jpg\" alt=\"Traffic is not monitored from the perimeter but from inside the network, is depicted. \" width=\"800\" height=\"256\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-scans-800x256.jpg 800w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-scans-768x246.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-scans-1024x328.jpg 1024w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-scans-700x224.jpg 700w, https://www.lastline.com/wp-content/uploads/2019/09/Winnti-scans.jpg 1160w\" sizes=\"(max-width: 800px) 100vw, 800px\" /><p id=\"caption-attachment-10912\" class=\"wp-caption-text\">Figure 8: A Winnti scans appearing to originate from a private IP address; the most likely explanation being an external host contacting a service hosted on 10.2.138.7, whose port was forwarded to the DMZ by the router running on 172.31.2.6.</p></div>\n<p>Admittedly, this can be very confusing for SOC analysts: the mere presence of a check-in originating from inside the perimeter is an obvious cause of concern. It is clear how the investigation into the causes can take a significant amount of time and effort. This demonstrates that simply whitelisting private IP addresses without proper investigation may lead to security risks.</p>\n<h3>Rely on destination ports? No</h3>\n<p>Also destination ports are not reliable, simply because they are meaningless for Winnti, as it can basically use any open port. The chart below shows the distribution of scan destination ports in our internal telemetry data.</p>\n<div id=\"attachment_10899\" style=\"width: 810px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10899\" class=\"wp-image-10899 size-medium\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/scan-port-distribution-800x386.jpg\" alt=\"Scan destination port distribution (percentage) between June - August 2019.\" width=\"800\" height=\"386\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/scan-port-distribution-800x386.jpg 800w, https://www.lastline.com/wp-content/uploads/2019/09/scan-port-distribution-768x371.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/scan-port-distribution-1024x495.jpg 1024w, https://www.lastline.com/wp-content/uploads/2019/09/scan-port-distribution-700x338.jpg 700w, https://www.lastline.com/wp-content/uploads/2019/09/scan-port-distribution.jpg 1213w\" sizes=\"(max-width: 800px) 100vw, 800px\" /><p id=\"caption-attachment-10899\" class=\"wp-caption-text\">Figure 9: Scan destination port distribution (percentage) between June &#8211; August 2019.</p></div>\n<p>As Figure 9 shows, the scans are distributed over a number of ports. The reason why we see more check-ins on 80 and 443 (HTTP/HTTPs) ports is because those are normally available to all connections, internal and external alike (unlike, say, SSH).</p>\n<h3>Mitigation</h3>\n<p>A successful three-way handshake is the first requirement for a check-in to be successful (regardless of the fact that it was a scan or a real attack). If the connection is not successful then we know there is no infection. The only case where further analysis is required is when there is an established connection, and in such case we need to inspect the response by taking into account the specific application-layer protocol used by the server to reply.</p>\n<p>As pointed out earlier, if the first message of the TCP flow is 16 bytes long (and it follows a specific format), the rootkit will redirect the rest of the connection towards its <em>worker</em> module. This connection hijacking capability allows us to effectively identify whether a host is infected or not. In other words, if the application-layer protocol returns a standard message upon a “Winnti HELO” check-in, it implies that the host is not infected (the check-in did not result in a hijacked connection). More details are discussed in the following typical cases.</p>\n<h3>HTTP</h3>\n<p>When the attackers send the Winnti HELO message using a connection established on port 80, the most likely service listening, if any, is a web server. This means that if the request can not be parsed by the userspace process (the web server), the most likely answer is a web page detailing that the parsing failed. As the screenshot below shows, the HTTP server returns a 400 status page upon the incoming “Winnti HELO” check-in. This indicates that the server is not infected by Winnti.</p>\n<div id=\"attachment_10954\" style=\"width: 810px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10954\" class=\"size-medium wp-image-10954\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/parsing-error-response-Winnti-HELO2-800x427.jpg\" alt=\"HTTP server returns a parsing error in response to a “Winnti HELO” check-in.\" width=\"800\" height=\"427\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/parsing-error-response-Winnti-HELO2-800x427.jpg 800w, https://www.lastline.com/wp-content/uploads/2019/09/parsing-error-response-Winnti-HELO2-768x410.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/parsing-error-response-Winnti-HELO2-1024x546.jpg 1024w, https://www.lastline.com/wp-content/uploads/2019/09/parsing-error-response-Winnti-HELO2-700x374.jpg 700w, https://www.lastline.com/wp-content/uploads/2019/09/parsing-error-response-Winnti-HELO2.jpg 1173w\" sizes=\"(max-width: 800px) 100vw, 800px\" /><p id=\"caption-attachment-10954\" class=\"wp-caption-text\">Figure 10: An HTTP server returns a parsing error in response to a “Winnti HELO” check-in.</p></div>\n<h3>SMTP</h3>\n<p>Similarly, if an SMTP server being scanned returns an error message after receiving a Winnti check-in on port 25 (most likely), it is clear that the connection reached the user space application. This implies that there was no Winnti implant on the host. The figure below illustrates the inbound and outbound messages on an SMTP server. The server received two incoming packets from a Winnti connection. The first one is a 16-byte long “Winnti HELO” message, followed by an encrypted message. As the SMTP server is not infected, it responded with an error message, indicating that it was not able to parse the request from the first packet.</p>\n<div id=\"attachment_10950\" style=\"width: 810px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10950\" class=\"wp-image-10950 size-medium\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-1-800x235.jpg\" alt=\"SMTP server replies with a server message upon “Winnti HELO” check-in.\" width=\"800\" height=\"235\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-1-800x235.jpg 800w, https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-1-768x226.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-1-1024x301.jpg 1024w, https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-1-700x206.jpg 700w, https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-1.jpg 1164w\" sizes=\"(max-width: 800px) 100vw, 800px\" /><p id=\"caption-attachment-10950\" class=\"wp-caption-text\">Figure 11: An SMTP server replies with a server message upon “Winnti HELO” check-in.</p></div>\n<p>It is worth noting that all communications using other protocols such as Telnet or FTP (clear-text protocols) can be triaged by inspecting the protocols. Most of the time it is easy to understand whether the response is legitimate, albeit the process can be time-consuming</p>\n<h3>HTTPS</h3>\n<p>Checking TLS-encrypted connections is much more challenging, because the data received from an endpoint does not clearly show whether the response is generated by a Winnti implant or just by the associated server.</p>\n<div id=\"attachment_10906\" style=\"width: 810px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10906\" class=\"size-medium wp-image-10906\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-800x216.jpg\" alt=\"HTTPS server replies a short message upon “Winnti HELO” check-in.\" width=\"800\" height=\"216\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-800x216.jpg 800w, https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-768x208.jpg 768w, https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-1024x277.jpg 1024w, https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-700x189.jpg 700w, https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in.jpg 1180w\" sizes=\"(max-width: 800px) 100vw, 800px\" /><p id=\"caption-attachment-10906\" class=\"wp-caption-text\">Figure 12: An HTTPS server replies a short message upon “Winnti HELO” check-in.</p></div>\n<p>In these cases, we need to rely on other clues, for example the intrinsic characteristics of a valid response to a Winnti check-in. The Winnti underlying protocol relies on responses that are 16 bytes long. This is because the initial handshake needs at least 16 bytes to encode details of the key exchange mechanism. This means that if the encrypted response to a Winnti HELO packet is shorter than that amount, then we can infer that the host is not infected. Coincidentally, the TLS record sent when the request can not be parsed is smaller (as shown in Figure 12, more details on TLS handshake protocol can be found in [8]). Our statistics show that over 50% of all check-ins are on port 443 (HTTPs). All of them are less than 16 bytes. Hence more than half of all the received check-ins can be ruled out deterministically without requiring manual inspection.</p>\n<h3>HELO values distribution</h3>\n<p>While analyzing the traffic, we also turned our attention to the DWORDs (HELO values from now on) used to assemble the first packet of the Winnti check-in and found some anomalies about the value distribution. Interestingly, we identified some artifacts in a popular scanner [4] that would often lead to the generation of identical HELO values, devoid of any randomization required to keep the generated traffic indistinguishable from malicious HELO messages. Case in point, we found the following HELO message to be one of the most prevalent:</p>\n<p><code><span style=\"font-size: 80%;\">9\\xcd\\xc3V\\x8c&#38;\\x12Dz/\\xb7\\xc0t\\x96C\\xe2</span></code></p>\n<p>Based on our telemetry data, these specific HELO values had been used 6,429 times out of all 14,962 check-ins we collected, which is about 43% of all the records.</p>\n<p>Another interesting anomaly is related to the message detailing the operation requested (the byte sequence immediately following the HELO values): 32.4% of the time, for unknown reasons (but we speculate that this might be caused by some errors in the scanner logic), it lacked encryption (you can in fact notice the magic values <strong>\\0xABC18CBA</strong> highlighted below should be encrypted in the operation request, as often documented in other articles [4-5]).</p>\n<p><code><span style=\"font-size: 80%;\">\\x00F\\x00\\x00\\x00\\x00\\x00<span style=\"color: #ffffff; background-color: maroon;\">\\xba\\x8c\\xc1\\xab</span>\\x00\\x00\\x00\\x00\\x01\\x04F\\x00\\x00\\x00\\x03<br />\n\\x08\\xbb=)\\xb2\\x17\\xc4$\\xed\\xaa\\x00\\x00\\x00\\x00\\x00++\\x00\\x00\\x00\\x00(\\x00\\x00\\x00</span></code></p>\n<p>We also identified an additional very frequent HELO message:</p>\n<p><code><span style=\"font-size: 80%;\">\\xae\\xd0\\xab,&#62;\\xf9JB2.r\\xc2\\xd9\\xee\\x9c\\xfe</span></code></p>\n<p>This specific instance appeared 3,591 times (or 24% of 14,962), and 99.999% of the time was followed by the same encrypted operation request sequence.</p>\n<p>Based on our research the underlying reason why we see so many anomalies generated by the Nmap-based scanner for Winnti, is because the core of the Nmap Scripting Engine is an embeddable Lua interpreter (a lightweight language designed for extensibility). There is a known issue with Lua’s internal pseudo-random integer number generator, i.e., <code>math.random()</code>, in MacOS and FreeBSD [7]: the difference of the seeds generated when executing the engine on those operating systems is very small, and it gets lost during the random number generation [7]. This explains why the seed remains the same each time <code>math.random()</code> is called, resulting in the generated numbers to follow the same exact distribution. More interestingly, this behavior is even more pronounced after the last code commit [4] (see Figure 13).</p>\n<div id=\"attachment_10907\" style=\"width: 733px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10907\" class=\"size-full wp-image-10907\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/Last-code-change-GitHub.jpg\" alt=\"GitHub repository depicting code change.\" width=\"723\" height=\"271\" srcset=\"https://www.lastline.com/wp-content/uploads/2019/09/Last-code-change-GitHub.jpg 723w, https://www.lastline.com/wp-content/uploads/2019/09/Last-code-change-GitHub-700x262.jpg 700w\" sizes=\"(max-width: 723px) 100vw, 723px\" /><p id=\"caption-attachment-10907\" class=\"wp-caption-text\">Figure 13: Last code change from the GitHub repository [4].</p></div>As we can see, <code>os.time()</code> was replaced by <code>math.random(1, 0xffffffff)</code>. While, before the merge, one of the HELO DWORDs, albeit not random, was still following a monotonic distribution (<code>os.time()</code> returns the system time in seconds), after the commit all generated numbers were susceptible to the seed issue we just described, leading to a portion of the HELO message being often constant. This is exactly what we noticed while analyzing Winnti check-ins, confirming our suspicion that such HELO messages were after all generated by benign scanners, not real attacks. It is important to notice that this flaw can also be abused by Winnti actors to selectively discard scan HELO messages. To eliminate this concern, the fix is to add <code>math.randomseed(os.time()</code>) (to have a real random seed each time) before calling <code>math.random()</code> to get better pseudo-random numbers (see Figure 14).</p>\n<div id=\"attachment_10901\" style=\"width: 489px\" class=\"wp-caption alignnone\"><img aria-describedby=\"caption-attachment-10901\" class=\"size-full wp-image-10901\" src=\"https://www.lastline.com/wp-content/uploads/2019/09/generate-pseudo-random-numbers.jpg\" alt=\"Add math.randomseed(os.time()) to generate pseudo-random numbers.\" width=\"479\" height=\"153\" /><p id=\"caption-attachment-10901\" class=\"wp-caption-text\">Figure 14: Add <em>math.randomseed(os.time())</em> to generate pseudo-random numbers.</p></div>\n<p>Note that once the generation of random numbers is fixed as outlined, it is not possible anymore to whitelist specific Winnti check-in packets known to originate from benign scanners.</p>\n<h3>Conclusions</h3>\n<p>Over the last decade Winnti has evolved into an advanced and sophisticated toolkit. Nowadays, many organizations of different size still suffer from such attacks. In the meantime, emulated “Winnti HELO” check-ins hoping to identify infected hosts have led to a dramatic increase in network activity, posing new challenges to security professionals whose job is the triaging of network-based attacks. In this report, we carried out a comprehensive investigation of all Winnti alerts collected over two months of internal telemetry data, including:</p>\n<ul>\n<li>Overview of the Winnti toolkit implants life cycle</li>\n<li>The cause behind the dramatic increase of Winnti activity</li>\n<li>New challenges tracking Winnti activity and how they affect SOC’s triage processes</li>\n</ul>\n<p>Then, we demonstrated how we can considerably mitigate the challenges in differentiating real attacks from benign scans. More specifically,</p>\n<ul>\n<li>If a host is not infected by Winnti, it is not able to parse an incoming &#8220;Winnti HELO&#8221; message; if there is an application listening on that specific port it will also respond with an application-layer error message.</li>\n<li>If a host is infected by Winnti, the Winnti rootkit hijacks the check-in message and redirects the rest of the connection towards its <em>worker</em> module.</li>\n</ul>\n<p>In addition, we also investigated the distribution of HELO values and identified a few flaws (e.g., constant values), leading us to believe that such HELO messages were probably generated by benign scanners, not real attacks. Note that a motivated attacker can always modify the current Winnti implant to selectively ignore such &#8220;anomalous&#8221; check-ins, as a covert attempt to fly under the radar. The fix we propose in this article generates pseudo-random numbers even across different scanner&#8217;s executions, thus removing this glitch which leads to semi-predictable behavior.</p>\n<h3>References</h3>\n<p>1. “Bayer contains cyber attack it says bore Chinese hallmarks”, <a href=\"https://in.reuters.com/article/bayer-cyber/bayer-says-has-detected-contained-cyber-attack-idINKCN1RG0NF\">https://in.reuters.com/article/bayer-cyber/bayer-says-has-detected-contained-cyber-attack-idINKCN1RG0NF</a>, accessed: 09/2019<br />\n2. “ ‘Winnti’ More than just a game”, <a href=\"https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/20134508/winnti-more-than-just-a-game-130410.pdf\">https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/20134508/winnti-more-than-just-a-game-130410.pdf</a>, accessed: 09/2019<br />\n3. “WINNTI ANALYSIS”, <a href=\"https://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf\">https://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf</a>, accessed: 09/2019<br />\n4. “Nmap Script to scan for Winnti infections”, <a href=\"https://github.com/TKCERT/winnti-nmap-script\">https://github.com/TKCERT/winnti-nmap-script</a>, accessed: 09/2019<br />\n5. “Winnti: More than just Windows and Gates”, <a href=\"https://medium.com/chronicle-blog/winnti-more-than-just-windows-and-gates-e4f03436031a\">https://medium.com/chronicle-blog/winnti-more-than-just-windows-and-gates-e4f03436031a</a>, accessed: 09/2019<br />\n6. “Burning Umbrella: An Intelligence Report on the Winnti Umbrella and Associated State-Sponsored Attackers”, <a href=\"https://401trg.com/burning-umbrella/\">https://401trg.com/burning-umbrella/</a>, accessed: 09/2019<br />\n7. “Math Library Tutorial”, <a href=\"http://lua-users.org/wiki/MathLibraryTutorial\">http://lua-users.org/wiki/MathLibraryTutorial</a>, accessed: 09/2019<br />\n8. “The Transport Layer Security (TLS) Protocol Version 1.3”, <a href=\"https://www.rfc-editor.org/rfc/pdfrfc/rfc8446.txt.pdf\">https://www.rfc-editor.org/rfc/pdfrfc/rfc8446.txt.pdf</a>, accessed: 09/2019</p>\n<p>The post <a rel=\"nofollow\" href=\"https://www.lastline.com/labsblog/helo-winnti-attack-scan/\">HELO Winnti: Attack or Scan?</a> appeared first on <a rel=\"nofollow\" href=\"https://www.lastline.com\">Lastline</a>.</p>\n","descriptionType":"html","publishedDate":"Mon, 30 Sep 2019 13:00:41 +0000","feedId":18556,"bgimg":"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-daily-alerts-timeline-800x256.jpg","linkMd5":"cb8b9775d261e38d00e251d23b5240f7","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn43@2020_6/2020/10/12/19-22-55-366_5e61640db7e5d21f.webp","destWidth":800,"destHeight":256,"sourceBytes":22889,"destBytes":15570,"author":"Jason Zhang","articleImgCdnMap":{"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-daily-alerts-timeline-800x256.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn43@2020_6/2020/10/12/19-22-55-366_5e61640db7e5d21f.webp","https://www.lastline.com/wp-content/uploads/2019/09/Winnti-evolution-timeline.jpg":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn79@2020_1/2020/10/12/19-22-57-200_1124d52b4c811132.webp","https://www.lastline.com/wp-content/uploads/2019/09/Winnti-targeted-entities-over-time.jpg":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn71@2020_5/2020/10/12/19-22-57-579_2b416034ca2615dd.webp","https://www.lastline.com/wp-content/uploads/2019/09/Winnti-check-ins-and-responses-800x498.jpg":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn76@2020_3/2020/10/12/19-22-57-006_a4a958d178b97aba.webp","https://www.lastline.com/wp-content/uploads/2019/09/attack-or-a-scan-800x256.jpg":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn88@2020_2/2020/10/12/19-22-57-109_4a48dee649efbad7.webp","https://www.lastline.com/wp-content/uploads/2019/09/Check-in-source-IP-address-800x296.jpg":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn50@2020_4/2020/10/12/19-22-57-574_a7cd9f456f9a8be5.webp","https://www.lastline.com/wp-content/uploads/2019/09/cloud-VM-based-scanner.jpg":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn68@2020_4/2020/10/12/19-22-57-688_d1fa42c8b5f3482c.webp","https://www.lastline.com/wp-content/uploads/2019/09/Winnti-scans-800x256.jpg":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn47@2020_5/2020/10/12/19-22-57-313_fb4732bfb4cfee15.webp","https://www.lastline.com/wp-content/uploads/2019/09/scan-port-distribution-800x386.jpg":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn91@2020_6/2020/10/12/19-22-57-200_cd74d300182744e1.webp","https://www.lastline.com/wp-content/uploads/2019/09/parsing-error-response-Winnti-HELO2-800x427.jpg":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn59@2020_6/2020/10/12/19-22-57-121_92fd609e48567204.webp","https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-1-800x235.jpg":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn56@2020_2/2020/10/12/19-22-57-188_87d2cf694357a17f.webp","https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-800x216.jpg":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn83@2020_1/2020/10/12/19-22-57-034_72c8fd69baa98ff5.webp","https://www.lastline.com/wp-content/uploads/2019/09/Last-code-change-GitHub.jpg":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn95@2020_1/2020/10/12/19-22-56-922_6f4bc0cbc50bd513.webp","https://www.lastline.com/wp-content/uploads/2019/09/generate-pseudo-random-numbers.jpg":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn63@2020_5/2020/10/12/19-22-56-929_41db2f8dd1caf9de.webp"},"publishedOrCreatedDate":1602530574656}],"record":{"createdTime":"2020-10-13 03:22:54","updatedTime":"2020-10-13 03:22:54","feedId":18556,"fetchDate":"Mon, 12 Oct 2020 19:22:54 +0000","fetchMs":44803,"handleMs":18,"totalMs":50193,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"c95099efafc17f9e0beaf843cecd5c56","hostName":"us-005*","requestId":"e6287884e7794092b3d5dd711b136430_18556","contentType":"application/rss+xml; charset=UTF-8","totalBytes":261516,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":14,"articlesImgsGithubTotal":14,"successGithubMap":{"myreaderx25":1,"myreaderx7":1,"myreaderx16":1,"myreaderx27":1,"myreaderx32":1,"myreaderx11":1,"myreaderx12":1,"myreaderx24":1,"myreaderx1":1,"myreaderx13":1,"myreaderx31":1,"myreaderx18":1,"myreaderx19":1,"myreaderx":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 02:17:48","updatedTime":"2020-09-07 02:51:31","id":18556,"name":"Labs Blog – Lastline","url":"http://labs.lastline.com/rss.xml","subscriber":179,"website":null,"icon":"https://www.lastline.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx62/cdn21@2020_6/2020/09/06/18-51-24-101_b5dd7f7bd6f4ba28.jpg","description":"Advanced Malware Protection","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":15570,"tmpBodyImgCdnBytes":245946,"tmpBgImgCdnBytes":0,"extra4":{"start":1602530529606,"total":0,"statList":[{"spend":45032,"msg":"获取xml内容"},{"spend":18,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":3528,"msg":"正文链接上传到cdn"}]},"extra5":14,"extra6":14,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe-56.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-53.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-039.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe65.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-002.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-035.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe61.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-015.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-011.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-23.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-57.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-023.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-027.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-daily-alerts-timeline-800x256.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":256,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn43@2020_6/2020/10/12/19-22-55-366_5e61640db7e5d21f.webp","sourceBytes":22889,"destBytes":15570,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1590,"convertSpendMs":10,"createdTime":"2020-10-13 03:22:54","host":"us-007*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7,cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"22.4 KB","destSize":"15.2 KB","compressRate":"68%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/generate-pseudo-random-numbers.jpg","sourceStatusCode":200,"destWidth":479,"destHeight":153,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn63@2020_5/2020/10/12/19-22-56-929_41db2f8dd1caf9de.webp","sourceBytes":16903,"destBytes":11104,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1413,"convertSpendMs":7,"createdTime":"2020-10-13 03:22:56","host":"us-011*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16.5 KB","destSize":"10.8 KB","compressRate":"65.7%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/attack-or-a-scan-800x256.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":256,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn88@2020_2/2020/10/12/19-22-57-109_4a48dee649efbad7.webp","sourceBytes":6757,"destBytes":5780,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1556,"convertSpendMs":10,"createdTime":"2020-10-13 03:22:56","host":"us-002*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.6 KB","destSize":"5.6 KB","compressRate":"85.5%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-800x216.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":216,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn83@2020_1/2020/10/12/19-22-57-034_72c8fd69baa98ff5.webp","sourceBytes":25771,"destBytes":18118,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1585,"convertSpendMs":23,"createdTime":"2020-10-13 03:22:56","host":"us-015*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"25.2 KB","destSize":"17.7 KB","compressRate":"70.3%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-check-ins-and-responses-800x498.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":498,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn76@2020_3/2020/10/12/19-22-57-006_a4a958d178b97aba.webp","sourceBytes":47481,"destBytes":42940,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1654,"convertSpendMs":69,"createdTime":"2020-10-13 03:22:56","host":"us-039*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"46.4 KB","destSize":"41.9 KB","compressRate":"90.4%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/parsing-error-response-Winnti-HELO2-800x427.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":427,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn59@2020_6/2020/10/12/19-22-57-121_92fd609e48567204.webp","sourceBytes":38804,"destBytes":30448,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1678,"convertSpendMs":14,"createdTime":"2020-10-13 03:22:56","host":"us-023*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"37.9 KB","destSize":"29.7 KB","compressRate":"78.5%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-evolution-timeline.jpg","sourceStatusCode":200,"destWidth":792,"destHeight":310,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn79@2020_1/2020/10/12/19-22-57-200_1124d52b4c811132.webp","sourceBytes":31516,"destBytes":16592,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1697,"convertSpendMs":16,"createdTime":"2020-10-13 03:22:56","host":"us-027*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"30.8 KB","destSize":"16.2 KB","compressRate":"52.6%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/HTTPS-server-reply-upon-Winnti-HELO-check-in-1-800x235.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":235,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn56@2020_2/2020/10/12/19-22-57-188_87d2cf694357a17f.webp","sourceBytes":28819,"destBytes":20816,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1744,"convertSpendMs":10,"createdTime":"2020-10-13 03:22:56","host":"us-035*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"28.1 KB","destSize":"20.3 KB","compressRate":"72.2%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/Last-code-change-GitHub.jpg","sourceStatusCode":200,"destWidth":723,"destHeight":271,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn95@2020_1/2020/10/12/19-22-56-922_6f4bc0cbc50bd513.webp","sourceBytes":35544,"destBytes":19090,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1869,"convertSpendMs":12,"createdTime":"2020-10-13 03:22:56","host":"us-53*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"34.7 KB","destSize":"18.6 KB","compressRate":"53.7%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-scans-800x256.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":256,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn47@2020_5/2020/10/12/19-22-57-313_fb4732bfb4cfee15.webp","sourceBytes":7168,"destBytes":6804,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1797,"convertSpendMs":9,"createdTime":"2020-10-13 03:22:56","host":"europe-56*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7 KB","destSize":"6.6 KB","compressRate":"94.9%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/scan-port-distribution-800x386.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":386,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn91@2020_6/2020/10/12/19-22-57-200_cd74d300182744e1.webp","sourceBytes":16594,"destBytes":12002,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":1874,"convertSpendMs":12,"createdTime":"2020-10-13 03:22:56","host":"europe65*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16.2 KB","destSize":"11.7 KB","compressRate":"72.3%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/cloud-VM-based-scanner.jpg","sourceStatusCode":200,"destWidth":740,"destHeight":204,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn68@2020_4/2020/10/12/19-22-57-688_d1fa42c8b5f3482c.webp","sourceBytes":36260,"destBytes":24838,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":2328,"convertSpendMs":9,"createdTime":"2020-10-13 03:22:56","host":"europe-23*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"35.4 KB","destSize":"24.3 KB","compressRate":"68.5%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/Winnti-targeted-entities-over-time.jpg","sourceStatusCode":200,"destWidth":792,"destHeight":310,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn71@2020_5/2020/10/12/19-22-57-579_2b416034ca2615dd.webp","sourceBytes":35991,"destBytes":19750,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":2419,"convertSpendMs":11,"createdTime":"2020-10-13 03:22:56","host":"europe61*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"35.1 KB","destSize":"19.3 KB","compressRate":"54.9%"},{"code":1,"isDone":false,"source":"https://www.lastline.com/wp-content/uploads/2019/09/Check-in-source-IP-address-800x296.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":296,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn50@2020_4/2020/10/12/19-22-57-574_a7cd9f456f9a8be5.webp","sourceBytes":21526,"destBytes":17664,"targetWebpQuality":75,"feedId":18556,"totalSpendMs":3364,"convertSpendMs":11,"createdTime":"2020-10-13 03:22:56","host":"europe-57*","referer":"https://www.lastline.com/?p=10884","linkMd5ListStr":"cb8b9775d261e38d00e251d23b5240f7","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"21 KB","destSize":"17.2 KB","compressRate":"82.1%"}],"successGithubMap":{"myreaderx25":1,"myreaderx7":1,"myreaderx16":1,"myreaderx27":1,"myreaderx32":1,"myreaderx11":1,"myreaderx12":1,"myreaderx24":1,"myreaderx1":1,"myreaderx13":1,"myreaderx31":1,"myreaderx18":1,"myreaderx19":1,"myreaderx":1},"failGithubMap":{}}