{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2021-04-03 13:59:08","updatedTime":"2021-04-03 13:59:08","title":"Front End Race Conditions","link":"https://www.simplethread.com/?p=3639","description":"<p>Race conditions are the bogeyman of concurrent programming. When they happen, they are hard to spot and even harder to reproduce.</p>\n<aside class=\"st-aside\"><p>A race condition is the condition of an electronics, software, or other system where the system&#8217;s substantive behavior is dependent on the sequence or timing of other uncontrollable events. It becomes a bug when one or more of the possible behaviors is undesirable. -Wikipedia </p>\n</aside>\n<p>Races can happen any time you have concurrent processes operating on the same data – especially without going through an explicit synchronization mechanism.</p>\n<p>Having worked with threads, coroutines, semaphores, mutexes, locks and other abstractions across a handful of different programming languages, I&#8217;ve caused my fair share of race conditions. So typically, I&#8217;m extra vigilant when working with concurrent code.</p>\n<p>As a result, a recent situation caught me by surprise when working in React. I don&#8217;t always think explicitly about concurrency in Javascript, but as soon as you introduce a callback or an event, there it is.</p>\n<p>In this particular case I was building a cancellable delete animation.</p>\n<figure class=\"wp-block-image is-style-default aligncenter\"><img src=\"https://www.simplethread.com/wp-content/uploads/2021/04/cancel.gif\" /></figure>\n<p>To cause the race you have to start deleting a second element before the first has completed. This could be very easily overlooked and it is easier to spot if we slow the animation down.</p>\n<figure class=\"wp-block-image is-style-default aligncenter\"><img src=\"https://www.simplethread.com/wp-content/uploads/2021/04/race.gif\" /></figure>\n<aside class=\"st-aside\"><p>A callback is any executable code that is passed as an argument to other code, that other code is expected to call back (execute) the argument at a given time. This execution may be immediate as in a synchronous callback, or it might happen at a later point in time as in an asynchronous callback. -Wikipedia</p>\n</aside>\n<p>The array index of the element you intended to remove will change any time an item before it is removed. If the index changes during the animation the wrong element is removed.</p>\n<p>The solution in this case was to add a unique identifier rather than an index to control the removal of elements.</p>\n<p>Front end code is asynchronous due to callbacks and events. Front end component state is shared memory. These two features together are a recipe for race conditions, so keep an eye out, and be careful out there.</p>\n<p>If you&#8217;d like to see a live example of this code, you can find it here:<br /><a href=\"https://codepen.io/simplethread-sam/pen/mdrVgWo\">https://codepen.io/simplethread-sam/pen/mdrVgWo</a></p>\n<p>The post <a rel=\"nofollow\" href=\"https://www.simplethread.com/front-end-race-conditions/\">Front End Race Conditions</a> appeared first on <a rel=\"nofollow\" href=\"https://www.simplethread.com\">Simple Thread</a>.</p>\n<div class=\"feedflare\">\n<a href=\"http://feeds.feedburner.com/~ff/Codethinked?a=TKUTpdsn7R4:CkG-w1NUkUg:yIl2AUoC8zA\"><img src=\"http://feeds.feedburner.com/~ff/Codethinked?d=yIl2AUoC8zA\" border=\"0\"></img></a> <a href=\"http://feeds.feedburner.com/~ff/Codethinked?a=TKUTpdsn7R4:CkG-w1NUkUg:dnMXMwOfBR0\"><img src=\"http://feeds.feedburner.com/~ff/Codethinked?d=dnMXMwOfBR0\" border=\"0\"></img></a> <a href=\"http://feeds.feedburner.com/~ff/Codethinked?a=TKUTpdsn7R4:CkG-w1NUkUg:D7DqB2pKExk\"><img src=\"http://feeds.feedburner.com/~ff/Codethinked?i=TKUTpdsn7R4:CkG-w1NUkUg:D7DqB2pKExk\" border=\"0\"></img></a>\n</div><img src=\"http://feeds.feedburner.com/~r/Codethinked/~4/TKUTpdsn7R4\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Fri, 02 Apr 2021 18:00:07 +0000","feedId":23659,"bgimg":"https://www.simplethread.com/wp-content/uploads/2021/04/cancel.gif","linkMd5":"a728081c4321affd17b0fdc5b39903fc","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn90@2020_4/2021/04/03/05-59-29-894_338f80534cfdd7ba.webp","destWidth":364,"destHeight":722,"sourceBytes":1560627,"destBytes":9258766,"author":"Sam Ehlers","articleImgCdnMap":{"https://www.simplethread.com/wp-content/uploads/2021/04/cancel.gif":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn90@2020_4/2021/04/03/05-59-29-894_338f80534cfdd7ba.webp","https://www.simplethread.com/wp-content/uploads/2021/04/race.gif":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn3@2020_1/2021/04/03/06-00-01-118_5059c77e62d931a9.webp","http://feeds.feedburner.com/~ff/Codethinked?d=yIl2AUoC8zA":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn10@2020_4/2021/04/03/05-59-33-965_1867223e71fc32e2.webp","http://feeds.feedburner.com/~ff/Codethinked?d=dnMXMwOfBR0":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn14@2020_2/2021/04/03/05-59-34-029_319478408ce7bbb5.webp","http://feeds.feedburner.com/~ff/Codethinked?i=TKUTpdsn7R4:CkG-w1NUkUg:D7DqB2pKExk":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn1@2020_4/2021/04/03/05-59-34-160_4eb3aecbff9c9ad7.webp","http://feeds.feedburner.com/~r/Codethinked/~4/TKUTpdsn7R4":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn18@2020_1/2021/04/03/05-59-34-014_06cdb4b82f74999d.webp"},"publishedOrCreatedDate":1617429548963}],"record":{"createdTime":"2021-04-03 13:59:08","updatedTime":"2021-04-03 13:59:08","feedId":23659,"fetchDate":"Sat, 03 Apr 2021 05:59:08 +0000","fetchMs":51,"handleMs":8,"totalMs":53984,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"aa586f1aba25f36f126cf35beda66034","hostName":"europe65*","requestId":"c678a4ad7498476b9f88b931fcb1ec1d_23659","contentType":"text/xml; charset=UTF-8","totalBytes":17412814,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":6,"articlesImgsGithubTotal":6,"successGithubMap":{"myreaderx7":1,"myreaderx32":1,"myreaderx10":1,"myreaderx22":1,"myreaderx1":1,"myreaderx18":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 02:31:01","updatedTime":"2020-09-07 04:24:01","id":23659,"name":"Simple Thread","url":"http://feeds.feedburner.com/Codethinked","subscriber":139,"website":null,"icon":"https://www.simplethread.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx65/cdn35@2020_5/2020/09/06/20-23-57-578_1c7448815eb10c25.jpg","description":"Better software, together.","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":9258766,"tmpBodyImgCdnBytes":8154048,"tmpBgImgCdnBytes":0,"extra4":{"start":1617429548892,"total":0,"statList":[{"spend":63,"msg":"获取xml内容"},{"spend":8,"msg":"解释文章"},{"spend":1,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":29037,"msg":"正文链接上传到cdn"}]},"extra5":6,"extra6":6,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe-25.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-001.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe63.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-51.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-029.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://www.simplethread.com/wp-content/uploads/2021/04/cancel.gif","sourceStatusCode":200,"destWidth":364,"destHeight":722,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn90@2020_4/2021/04/03/05-59-29-894_338f80534cfdd7ba.webp","sourceBytes":1560627,"destBytes":9258766,"targetWebpQuality":75,"feedId":23659,"totalSpendMs":24844,"convertSpendMs":19595,"createdTime":"2021-04-03 13:59:08","host":"europe-59*","referer":"https://www.simplethread.com/?p=3639","linkMd5ListStr":"a728081c4321affd17b0fdc5b39903fc,a728081c4321affd17b0fdc5b39903fc","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.5 MB","destSize":"8.8 MB","compressRate":"593.3%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/Codethinked/~4/TKUTpdsn7R4","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn18@2020_1/2021/04/03/05-59-34-014_06cdb4b82f74999d.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":23659,"totalSpendMs":291,"convertSpendMs":10,"createdTime":"2021-04-03 13:59:33","host":"us-029*","referer":"https://www.simplethread.com/?p=3639","linkMd5ListStr":"a728081c4321affd17b0fdc5b39903fc","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~ff/Codethinked?d=dnMXMwOfBR0","sourceStatusCode":200,"destWidth":98,"destHeight":24,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn14@2020_2/2021/04/03/05-59-34-029_319478408ce7bbb5.webp","sourceBytes":1051,"destBytes":404,"targetWebpQuality":75,"feedId":23659,"totalSpendMs":334,"convertSpendMs":14,"createdTime":"2021-04-03 13:59:33","host":"us-51*","referer":"https://www.simplethread.com/?p=3639","linkMd5ListStr":"a728081c4321affd17b0fdc5b39903fc","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1 KB","destSize":"404 B","compressRate":"38.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~ff/Codethinked?d=yIl2AUoC8zA","sourceStatusCode":200,"destWidth":62,"destHeight":24,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn10@2020_4/2021/04/03/05-59-33-965_1867223e71fc32e2.webp","sourceBytes":997,"destBytes":310,"targetWebpQuality":75,"feedId":23659,"totalSpendMs":472,"convertSpendMs":5,"createdTime":"2021-04-03 13:59:33","host":"europe63*","referer":"https://www.simplethread.com/?p=3639","linkMd5ListStr":"a728081c4321affd17b0fdc5b39903fc","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"997 B","destSize":"310 B","compressRate":"31.1%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~ff/Codethinked?i=TKUTpdsn7R4:CkG-w1NUkUg:D7DqB2pKExk","sourceStatusCode":200,"destWidth":92,"destHeight":24,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn1@2020_4/2021/04/03/05-59-34-160_4eb3aecbff9c9ad7.webp","sourceBytes":1043,"destBytes":374,"targetWebpQuality":75,"feedId":23659,"totalSpendMs":667,"convertSpendMs":4,"createdTime":"2021-04-03 13:59:33","host":"europe-25*","referer":"https://www.simplethread.com/?p=3639","linkMd5ListStr":"a728081c4321affd17b0fdc5b39903fc","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1 KB","destSize":"374 B","compressRate":"35.9%"},{"code":1,"isDone":false,"source":"https://www.simplethread.com/wp-content/uploads/2021/04/race.gif","sourceStatusCode":200,"destWidth":364,"destHeight":722,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn3@2020_1/2021/04/03/06-00-01-118_5059c77e62d931a9.webp","sourceBytes":1532727,"destBytes":8152888,"targetWebpQuality":75,"feedId":23659,"totalSpendMs":28881,"convertSpendMs":26716,"createdTime":"2021-04-03 13:59:33","host":"us-001*","referer":"https://www.simplethread.com/?p=3639","linkMd5ListStr":"a728081c4321affd17b0fdc5b39903fc","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.5 MB","destSize":"7.8 MB","compressRate":"531.9%"}],"successGithubMap":{"myreaderx7":1,"myreaderx32":1,"myreaderx10":1,"myreaderx22":1,"myreaderx1":1,"myreaderx18":1},"failGithubMap":{}}