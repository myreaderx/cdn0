{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-09 23:30:32","updatedTime":"2020-10-09 23:30:32","title":"ECharts v3.8 发布：树图、SVG 渲染（beta）、ES Module","link":"http://efe.baidu.com/blog/echarts-3-8-0/","description":"<p>在 ECharts 新发布的 <a href=\"https://github.com/ecomfe/echarts/releases/tag/3.8.0\" target=\"_blank\" rel=\"noopener\">3.8 版本</a> 中，新加入了 <a href=\"http://echarts.baidu.com/option.html#series-tree\" target=\"_blank\" rel=\"noopener\">树图</a>，支持 <a href=\"http://echarts.baidu.com/demo.html#tree-basic\" target=\"_blank\" rel=\"noopener\">横向布局</a>、<a href=\"http://echarts.baidu.com/demo.html#tree-vertical\" target=\"_blank\" rel=\"noopener\">纵向布局</a>、<a href=\"http://echarts.baidu.com/demo.html#tree-radial\" target=\"_blank\" rel=\"noopener\">径向布局</a>；新加入了 <a href=\"http://echarts.baidu.com/tutorial.html#%E4%BD%BF%E7%94%A8%20Canvas%20%E6%88%96%E8%80%85%20SVG%20%E6%B8%B2%E6%9F%93\" target=\"_blank\" rel=\"noopener\">SVG 渲染支持（beta 版）</a> 的支持，从而可以根据自己的需要，选择 SVG 或者 Canvas 作为渲染引擎；代码的模块系统改用 ES Module，从而能够受益于 tree shaking 减小 bundle 的体积；同时开放了构建脚本协助用户进行 <a href=\"http://echarts.baidu.com/tutorial.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9E%84%E5%BB%BA%20ECharts\" target=\"_blank\" rel=\"noopener\">自定义模块、语言地构建</a>。</p>\n<a id=\"more\"></a>\n<hr>\n <h2 id=\"树图\">树图</h2>\n <p><a href=\"http://echarts.baidu.com/option.html#series-tree\" target=\"_blank\" rel=\"noopener\">树图</a> 主要用来可视化树形数据结构，是一种特殊的层次类型，具有唯一的根节点，左子树，和右子树。点击树的节点，可以展开收缩子树。</p>\n <div class=\"ec-lazy\" data-thumb=\"http://echarts.baidu.com/gallery/data/thumb/tree-basic.png\" data-src=\"http://echarts.baidu.com/gallery/view.html?c=tree-basic&amp;edit=1&amp;reset=1\" style=\"width: 90%; height: 400px\"></div>\n <div class=\"ec-lazy\" data-thumb=\"http://echarts.baidu.com/gallery/data/thumb/tree-radial.png\" data-src=\"http://echarts.baidu.com/gallery/view.html?c=tree-radial&amp;edit=1&amp;reset=1\" style=\"width: 90%; height: 400px\"></div>\n <hr>\n  <h2 id=\"svg-支持\">SVG 支持</h2>\n  <p>浏览器端图表库大多会选择 SVG 或者 Canvas 进行渲染。对于绘制图表来说，这两种技术往往是可替换的，效果相近。但是在一些场景中，他们的表现和能力又有一定差异。于是，对它们的选择取舍，就成为了一个一直存在的不易有标准答案的话题。</p>\n  <p>ECharts 从初始一直使用 Canvas 绘制图表（除了对 IE8- 使用 VML）。而 <a href=\"https://github.com/ecomfe/echarts/releases\" target=\"_blank\" rel=\"noopener\">ECharts v3.8</a> 发布了 SVG 渲染器（beta 版），从而提供了一种新的选择。只须在初始化一个图表实例时，设置 <a href=\"http://echarts.baidu.com/api.html#echarts.init\" target=\"_blank\" rel=\"noopener\">renderer 参数</a> 为 <code>'canvas'</code> 或 <code>'svg'</code> 即可指定渲染器，比较方便。</p>\n  <blockquote>\n   <p>SVG 和 Canvas 这两种使用方式差异很大的技术，能够做到同时被透明支持，主要归功于 ECharts 底层库 <a href=\"https://github.com/ecomfe/zrender\" target=\"_blank\" rel=\"noopener\">ZRender</a> 的抽象和实现，形成可互换的 SVG 渲染器和 Canvas 渲染器。</p>\n  </blockquote>\n  <p><br /></p>\n  <p>一般来说，Canvas 更适合绘制图形元素数量非常大（这一般是由数据量大导致）的图表（如热力图、地理坐标系或平行坐标系上的大规模线图或散点图等），也利于实现某些视觉 <a href=\"http://echarts.baidu.com/demo.html#lines-bmap-effect\" target=\"_blank\" rel=\"noopener\">特效</a>。但是，在不少场景中，SVG 具有重要的优势：它的内存占用更低（这对移动端尤其重要）、渲染性能略高、并且用户使用浏览器内置的缩放功能时不会模糊。例如，我们在一些硬件环境中分别使用 Canvas 渲染器和 SVG 渲染器绘制中等数据量的折、柱、饼，统计初始动画阶段的帧率，得到了一个性能对比图：</p>\n  <p><img src=\"http://efe.baidu.com/blog/echarts-3-8-0/2017-11-07-canvas-vs-svg.png\" width=\"90%\" /></p>\n  <p>上图显示出，在这些场景中，SVG 渲染器相比 Canvas 渲染器在移动端的总体表现更好。当然，这个实验并非是全面的评测，在另一些数据量较大或者有图表交互动画的场景中，目前的 SVG 渲染器的性能还比不过 Canvas 渲染器。但是同时有这两个选项，为开发者们根据自己的情况优化性能提供了更广阔的空间。</p>\n  <p>选择哪种渲染器，我们可以根据软硬件环境、数据量、功能需求综合考虑。 + 在软硬件环境较好，数据量不大的场景下（例如 PC 端做商务报表），两种渲染器都可以适用，并不需要太多纠结。 + 在环境较差，出现性能问题需要优化的场景下，可以通过试验来确定使用哪种渲染器。比如有这些经验： + 在须要创建很多 ECharts 实例且浏览器易崩溃的情况下（可能是因为 Canvas 数量多导致内存占用超出手机承受能力），可以使用 SVG 渲染器来进行改善。大略得说，如果图表运行在低端安卓机，或者我们在使用一些特定图表如 <a href=\"https://ecomfe.github.io/echarts-liquidfill/example/\" target=\"_blank\" rel=\"noopener\">水球图</a> 等，SVG 渲染器可能效果更好。 + 数据量很大、较多交互时，可以选用 Canvas 渲染器。</p>\n  <p>我们强烈欢迎开发者们 <a href=\"https://github.com/ecomfe/echarts/issues/new\" target=\"_blank\" rel=\"noopener\">反馈</a> 给我们使用的体验和场景，帮助我们更好的做优化。</p>\n  <p>SVG 渲染的使用 <a href=\"http://echarts.baidu.com/tutorial.html#%E4%BD%BF%E7%94%A8%20Canvas%20%E6%88%96%E8%80%85%20SVG%20%E6%B8%B2%E6%9F%93\" target=\"_blank\" rel=\"noopener\">参见教程</a>。</p>\n  <hr>\n   <h2 id=\"es-module\">ES Module</h2>\n   <p>从 v3.8 开始，ECharts 源代码的模块系统改用 ES Module，从而可以受益于 tree shaking，减小构建所得 bundle 的体积。并且 ECharts 提供了构建脚本（<code>echarts/build/build.js</code>），方便开发者使用命令行定制 bundle，可以选择模块、选择默认的语言。参见教程 <a href=\"http://echarts.baidu.com/tutorial.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9E%84%E5%BB%BA%20ECharts\" target=\"_blank\" rel=\"noopener\">自定义构建</a>。</p>\n   <p><br /></p>\n   <p>更多的升级信息，参见 <a href=\"http://echarts.baidu.com/changelog.html\" target=\"_blank\" rel=\"noopener\">changelog</a>。</p>\n   <script src=\"https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js\"></script>\n   <script>(function () { if (typeof jQuery === 'undefined') { return; } var $ = jQuery; var env = window['MD_ENV']; var $ = jQuery; var useThumb = env &amp;&amp; (env.os.phone || env.os.tablet); var blockList = $('.ec-lazy'); var $win = $(window); blockList.each(function (index, block) { block = $(block); var src = block.attr('data-src'); block.attr('data-src', src); }); // Lazy load. $win.on('scroll', showBlock); $(showBlock); function initThumb(block, $block, blockThumb, blockSrc) { $block.css('lineHeight', $block.height() + 'px'); block.innerHTML = [ '<img style=\"width:100%;height:auto;margin:0;padding:0;vertical-align:middle;\" src=\"http://efe.baidu.com/blog/echarts-3-8-0/', blockThumb, '\" />', // for vertial middle '\n    <div style=\"vertical-align: middle; height: 100%; width: 0\"></div>', '\n    <div style=\"cursor:pointer;thumb-btn;position:absolute;bottom:10px;width:100%;height:22px;line-height:22px;text-align:center;\">\n     ', '\n     <em style=\"font-style:normal;border-radius:3px;padding:3px 5px;margin:3px 5px;color:white;background:#337ab7;font-size:12px;line-height:1.5;\">点击图片加载真实图表</em>', '\n    </div>', '\n    <div class=\"ec-lazy-block-mask\" style=\"cursor:pointer;position:absolute;left:0;top:0;width:100%;height:100%;margin:0;\"></div>' ].join(''); $block.find('.ec-lazy-block-mask').on('click', function () { initIFrame(block, $block, blockThumb, blockSrc); }); } function initIFrame(block, $block, blockThumb, blockSrc) { block.innerHTML = [ '<iframe style=\"overflow:hidden;width:100%;height:100%;margin:0;padding:0;\" src=\"' , blockSrc, '\">', 'frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\"', 'scrolling=\"no\" hspace=\"0\" vspace=\"0\"&gt;</iframe>' ].join(''); } function showBlock() { blockList.each(function (idx, block) { var $block = $(block); var blockSrc = $block.attr('data-src'); var blockThumb = $block.attr('data-thumb'); if (!blockSrc) { return; } $block.css({ position: 'relative', overflow: 'hidden', textAlign: 'center', padding: 0 }); var winScrollTop = $win.scrollTop(); var blockTop = block.offsetTop; var winHeight = $win.height(); var winBottom = winScrollTop + winHeight; var blockBottom = blockTop + $block.height(); if (winBottom &gt;= blockTop &amp;&amp; winBottom &lt;= (blockBottom + winHeight)) { $block.attr('data-src', ''); (useThumb &amp;&amp; blockThumb) ? initThumb(block, $block, blockThumb, blockSrc) : initIFrame(block, $block, blockThumb, blockSrc); } }); }})();</script>\n  </hr>\n </hr>\n</hr>","descriptionType":"html","publishedDate":"Mon, 06 Nov 2017 16:00:00 +0000","feedId":19099,"bgimg":"","linkMd5":"6fb6e0eaa0ea0a89dba4e07adab85903","bgimgJsdelivr":"","metaImg":"","author":"","articleImgCdnMap":{"http://efe.baidu.com/blog/echarts-3-8-0/2017-11-07-canvas-vs-svg.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn20@2020_3/2020/10/09/15-30-47-391_265bc4b2492f13a7.webp","http://efe.baidu.com/blog/echarts-3-8-0/', blockThumb, '":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg"},"publishedOrCreatedDate":1602257432082}],"record":{"createdTime":"2020-10-09 23:30:32","updatedTime":"2020-10-09 23:30:32","feedId":19099,"fetchDate":"Fri, 09 Oct 2020 15:30:32 +0000","fetchMs":4768,"handleMs":23,"totalMs":27894,"newArticles":0,"totalArticles":20,"status":1,"type":0,"ip":"a7d54052e8673d13da536025ef9c200b","hostName":"europe-60*","requestId":"2df0d258be49463facd3b22e3b1e13b3_19099","contentType":"text/xml","totalBytes":36552,"bgimgsTotal":0,"bgimgsGithubTotal":0,"articlesImgsTotal":2,"articlesImgsGithubTotal":2,"successGithubMap":{"myreaderx11":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 02:19:05","updatedTime":"2020-09-07 02:54:26","id":19099,"name":"EFE Tech","url":"http://efe.baidu.com/atom.xml","subscriber":174,"website":null,"icon":"http://efe.baidu.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx63/cdn9@2020_1/2020/09/06/18-53-41-373_a3d529b4bdc3dc48.ico","description":"百度EFE（Excellent FrontEnd）技术体系","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":0,"tmpBodyImgCdnBytes":36552,"tmpBgImgCdnBytes":0,"extra4":{"start":1602257420655,"total":0,"statList":[{"spend":11404,"msg":"获取xml内容"},{"spend":23,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":8638,"msg":"正文链接上传到cdn"}]},"extra5":2,"extra6":2,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"http://efe.baidu.com/blog/echarts-3-8-0/', blockThumb, '","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":19099,"totalSpendMs":3226,"convertSpendMs":0,"createdTime":"2020-10-09 23:30:39","host":"europe-23*","referer":"http://efe.baidu.com/blog/echarts-3-8-0/","linkMd5ListStr":"6fb6e0eaa0ea0a89dba4e07adab85903","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://efe.baidu.com/blog/echarts-3-8-0/', blockThumb, '","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":19099,"totalSpendMs":3511,"convertSpendMs":0,"createdTime":"2020-10-09 23:30:43","host":"us-002*","referer":"http://efe.baidu.com/blog/echarts-3-8-0/","linkMd5ListStr":"6fb6e0eaa0ea0a89dba4e07adab85903","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"}],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe-23.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[404]},"http://us-002.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[404]},"http://europe-22.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"http://efe.baidu.com/blog/echarts-3-8-0/', blockThumb, '","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":19099,"totalSpendMs":3511,"convertSpendMs":0,"createdTime":"2020-10-09 23:30:43","host":"us-002*","referer":"http://efe.baidu.com/blog/echarts-3-8-0/","linkMd5ListStr":"6fb6e0eaa0ea0a89dba4e07adab85903","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://efe.baidu.com/blog/echarts-3-8-0/2017-11-07-canvas-vs-svg.png","sourceStatusCode":200,"destWidth":2512,"destHeight":1420,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn20@2020_3/2020/10/09/15-30-47-391_265bc4b2492f13a7.webp","sourceBytes":163981,"destBytes":36552,"targetWebpQuality":75,"feedId":19099,"totalSpendMs":8608,"convertSpendMs":149,"createdTime":"2020-10-09 23:30:39","host":"europe-22*","referer":"http://efe.baidu.com/blog/echarts-3-8-0/","linkMd5ListStr":"6fb6e0eaa0ea0a89dba4e07adab85903","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"160.1 KB","destSize":"35.7 KB","compressRate":"22.3%"}],"successGithubMap":{"myreaderx11":1},"failGithubMap":{}}