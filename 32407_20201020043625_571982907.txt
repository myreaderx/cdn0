{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-20 12:36:00","updatedTime":"2020-10-20 12:36:00","title":"Creación de payloads cifrados en Powershell con Xeca","link":"https://www.hackplayers.com/2020/08/payloads-cifrados-ps-con-xeca.html","description":"<div dir=\"ltr\" style=\"text-align: left;\" trbidi=\"on\">Xeca es un proyecto que crea payloads cifrados de PowerShell con fines ofensivos. También es posible crear shellcodes independientes a partir de archivos DLL. Para instalarlo, tenemos que tener previamente <a href=\"https://www.rust-lang.org/tools/install\" target=\"_blank\">Rust</a> y luego construir el proyecto simplemente con el comando: <span style=\"font-family: &quot;courier&quot;;\">cargo build</span>.<br /><br />Su funcionamiento es el siguiente:<br />1. Identifica y cifra el payload. Carga el payload cifrado en un script de PowerShell y lo guarda en un archivo llamado \"launch.txt\"<br />2. La clave para descifrar el payload se guarda en un archivo llamado \"safe.txt\"<br />3. Ejecuta \"launch.txt\" en un host remoto<br /><ul style=\"text-align: left;\"><li>El script volverá a llamar al servidor web definido por el atacante para recuperar la clave de descifrado \"safe.txt\"</li><li>Descifra el payload en la memoria</li><li>Ejecuta el payload en la memoria</li></ul>Algunos ejemplos de uso:<br /><br /><a href=\"https://github.com/bc-security/empire\">Empire</a> <br /><br /><div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://1.bp.blogspot.com/-4ttkb6_HLmg/Xy-lKrSegeI/AAAAAAABdX0/9ZeCnXdYjck_2HgsgR6ewULZLbEWeIR1QCLcBGAsYHQ/s1600/empire2.gif\" imageanchor=\"1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"768\" data-original-width=\"1524\" src=\"https://1.bp.blogspot.com/-4ttkb6_HLmg/Xy-lKrSegeI/AAAAAAABdX0/9ZeCnXdYjck_2HgsgR6ewULZLbEWeIR1QCLcBGAsYHQ/s640/empire2.gif\" width=\"530\" /></a></div><br /><a href=\"https://github.com/Ne0nd0g/merlin\">Merlin</a><br /><br /><div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://1.bp.blogspot.com/-oTp3Bd_e7Kw/Xy-kXAm6sNI/AAAAAAABdXk/dwdJl58pEX0pyGEfZJgpbtlFIAN_L6XJwCLcBGAsYHQ/s1600/merlin2.gif\" imageanchor=\"1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"768\" data-original-width=\"1524\" src=\"https://1.bp.blogspot.com/-oTp3Bd_e7Kw/Xy-kXAm6sNI/AAAAAAABdXk/dwdJl58pEX0pyGEfZJgpbtlFIAN_L6XJwCLcBGAsYHQ/s640/merlin2.gif\" width=\"530\" /></a></div><br /><a href=\"https://github.com/BishopFox/sliver\">Sliver</a><br /><br /><div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://1.bp.blogspot.com/-mmYJUnw9i5Y/Xy-kvYZxSEI/AAAAAAABdXs/_mNmvxbj0705aPB5ikCLBByyKjdcnvTAACLcBGAsYHQ/s1600/sliver2.gif\" imageanchor=\"1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"768\" data-original-width=\"1524\" src=\"https://1.bp.blogspot.com/-mmYJUnw9i5Y/Xy-kvYZxSEI/AAAAAAABdXs/_mNmvxbj0705aPB5ikCLBByyKjdcnvTAACLcBGAsYHQ/s640/sliver2.gif\" width=\"530\" /></a></div><br /><b>Mitigaciones</b><br /><br />Si los usuarios tienen que tener acceso a programas como powershell.exe, para mitigar el uso de estas herramientas hay que considerar minimizar los riesgos de seguridad con <a href=\"https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/jea/overview?view=powershell-7\" rel=\"nofollow\">Just Enough Administration</a> y <a href=\"https://docs.microsoft.com/en-us/powershell/scripting/windows-powershell/wmf/whats-new/script-logging?view=powershell-7\" rel=\"nofollow\">PowerShell Logging</a>. Las políticas de control de aplicaciones se pueden implementar a través de whitelisting con herramientas como <a href=\"https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/applocker-overview\" rel=\"nofollow\">AppLocker</a>.<br /><br /><b>Proyecto</b>: <a href=\"https://github.com/postrequest/xeca\">https://github.com/postrequest/xeca</a> </div>","descriptionType":"text/html","publishedDate":"Sun, 09 Aug 2020 07:27:00 +0000","feedId":32407,"bgimg":"https://1.bp.blogspot.com/-4ttkb6_HLmg/Xy-lKrSegeI/AAAAAAABdX0/9ZeCnXdYjck_2HgsgR6ewULZLbEWeIR1QCLcBGAsYHQ/s72-c/empire2.gif","linkMd5":"661de10007909e3ca00d2f2ffb765d0c","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn77@2020_1/2020/10/20/04-36-02-861_581acda80d328e98.webp","destWidth":72,"destHeight":72,"sourceBytes":185741,"destBytes":112660,"author":"noreply@blogger.com (Vicente Motos)","articleImgCdnMap":{"https://1.bp.blogspot.com/-4ttkb6_HLmg/Xy-lKrSegeI/AAAAAAABdX0/9ZeCnXdYjck_2HgsgR6ewULZLbEWeIR1QCLcBGAsYHQ/s640/empire2.gif":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn72@2020_1/2020/10/20/04-36-17-447_4157103449d7de43.webp","https://1.bp.blogspot.com/-oTp3Bd_e7Kw/Xy-kXAm6sNI/AAAAAAABdXk/dwdJl58pEX0pyGEfZJgpbtlFIAN_L6XJwCLcBGAsYHQ/s640/merlin2.gif":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn67@2020_6/2020/10/20/04-36-22-928_9f0d84ac75cd1764.webp","https://1.bp.blogspot.com/-mmYJUnw9i5Y/Xy-kvYZxSEI/AAAAAAABdXs/_mNmvxbj0705aPB5ikCLBByyKjdcnvTAACLcBGAsYHQ/s640/sliver2.gif":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn63@2020_4/2020/10/20/04-36-13-043_55ffa22345fabe87.webp"},"publishedOrCreatedDate":1603168560633}],"record":{"createdTime":"2020-10-20 12:36:00","updatedTime":"2020-10-20 12:36:00","feedId":32407,"fetchDate":"Tue, 20 Oct 2020 04:36:00 +0000","fetchMs":383,"handleMs":58,"totalMs":25656,"newArticles":0,"totalArticles":25,"status":1,"type":0,"ip":"d30ce248a5f8ef1e93fb032827363e30","hostName":"us-025*","requestId":"6d72b10de0254154bf4482c56e302e24_32407","contentType":"application/rss+xml; charset=UTF-8","totalBytes":12339406,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":3,"articlesImgsGithubTotal":3,"successGithubMap":{"myreaderx10":1,"myreaderx13":1,"myreaderx24":1,"myreaderx5oss":1},"failGithubMap":{"myreaderx23":1}},"feed":{"createdTime":"2020-09-07 02:55:30","updatedTime":"2020-09-07 05:03:54","id":32407,"name":"hackplayers","url":"http://www.hackplayers.com/feeds/posts/default?alt=rss","subscriber":99,"website":null,"icon":"https://www.hackplayers.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx62/cdn48@2020_6/2020/09/06/21-03-51-830_c328ebeff5b0665a.ico","description":"Computer security, ethical hacking and more!","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":0,"tmpBodyImgCdnBytes":12226746,"tmpBgImgCdnBytes":112660,"extra4":{"start":1603168560163,"total":0,"statList":[{"spend":413,"msg":"获取xml内容"},{"spend":58,"msg":"解释文章"},{"spend":1806,"msg":"上传封面图到cdn"},{"spend":1527,"msg":"修正封面图上传失败重新上传"},{"spend":25177,"msg":"正文链接上传到cdn"}]},"extra5":3,"extra6":3,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"https://1.bp.blogspot.com/-4ttkb6_HLmg/Xy-lKrSegeI/AAAAAAABdX0/9ZeCnXdYjck_2HgsgR6ewULZLbEWeIR1QCLcBGAsYHQ/s72-c/empire2.gif","sourceStatusCode":200,"destWidth":72,"destHeight":72,"sourceBytes":185741,"destBytes":112660,"targetWebpQuality":75,"feedId":32407,"totalSpendMs":887,"convertSpendMs":622,"createdTime":"2020-10-20 12:36:00","host":"us-020*","referer":"https://www.hackplayers.com/2020/08/payloads-cifrados-ps-con-xeca.html","linkMd5ListStr":"661de10007909e3ca00d2f2ffb765d0c","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx23/cdn60/contents/2020/10/20/04-36-01-465_581acda80d328e98.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69189253.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Tue, 20 Oct 2020 04:36:01 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["D81E:6CDE:4488D54:729EFD7:5F8E6922"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, read:packages, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1603170288"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx23/cdn60/contents/2020/10/20/04-36-01-465_581acda80d328e98.webp","historyStatusCode":[],"spendMs":73},"base64UserPassword":null,"token":"df0b9******************************93a6e"},"githubUser":"myreaderx23","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"181.4 KB","destSize":"110 KB","compressRate":"60.7%"},{"code":1,"isDone":false,"source":"https://1.bp.blogspot.com/-4ttkb6_HLmg/Xy-lKrSegeI/AAAAAAABdX0/9ZeCnXdYjck_2HgsgR6ewULZLbEWeIR1QCLcBGAsYHQ/s72-c/empire2.gif","sourceStatusCode":200,"destWidth":72,"destHeight":72,"sourceBytes":185741,"destBytes":112660,"targetWebpQuality":75,"feedId":32407,"totalSpendMs":886,"convertSpendMs":793,"createdTime":"2020-10-20 12:36:01","host":"us-020*","referer":"https://www.hackplayers.com/2020/08/payloads-cifrados-ps-con-xeca.html","linkMd5ListStr":"661de10007909e3ca00d2f2ffb765d0c","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx23/cdn60/contents/2020/10/20/04-36-02-376_581acda80d328e98.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69189253.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Tue, 20 Oct 2020 04:36:02 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["D81E:6CDE:4488E63:729FC4F:5F8E6931"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, read:packages, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1603170288"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx23/cdn60/contents/2020/10/20/04-36-02-376_581acda80d328e98.webp","historyStatusCode":[],"spendMs":66},"base64UserPassword":null,"token":"df0b9******************************93a6e"},"githubUser":"myreaderx23","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"181.4 KB","destSize":"110 KB","compressRate":"60.7%"}],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe21.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-59.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-008.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://1.bp.blogspot.com/-4ttkb6_HLmg/Xy-lKrSegeI/AAAAAAABdX0/9ZeCnXdYjck_2HgsgR6ewULZLbEWeIR1QCLcBGAsYHQ/s72-c/empire2.gif","sourceStatusCode":200,"destWidth":72,"destHeight":72,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn77@2020_1/2020/10/20/04-36-02-861_581acda80d328e98.webp","sourceBytes":185741,"destBytes":112660,"targetWebpQuality":75,"feedId":32407,"totalSpendMs":1486,"convertSpendMs":348,"createdTime":"2020-10-20 12:36:02","host":"us-038*","referer":"https://www.hackplayers.com/2020/08/payloads-cifrados-ps-con-xeca.html","linkMd5ListStr":"661de10007909e3ca00d2f2ffb765d0c","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"181.4 KB","destSize":"110 KB","compressRate":"60.7%"},{"code":1,"isDone":false,"source":"https://1.bp.blogspot.com/-mmYJUnw9i5Y/Xy-kvYZxSEI/AAAAAAABdXs/_mNmvxbj0705aPB5ikCLBByyKjdcnvTAACLcBGAsYHQ/s640/sliver2.gif","sourceStatusCode":200,"destWidth":640,"destHeight":323,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn63@2020_4/2020/10/20/04-36-13-043_55ffa22345fabe87.webp","sourceBytes":2558900,"destBytes":3046884,"targetWebpQuality":75,"feedId":32407,"totalSpendMs":13922,"convertSpendMs":12199,"createdTime":"2020-10-20 12:36:00","host":"us-008*","referer":"https://www.hackplayers.com/2020/08/payloads-cifrados-ps-con-xeca.html","linkMd5ListStr":"661de10007909e3ca00d2f2ffb765d0c","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"2.4 MB","destSize":"2.9 MB","compressRate":"119.1%"},{"code":1,"isDone":false,"source":"https://1.bp.blogspot.com/-4ttkb6_HLmg/Xy-lKrSegeI/AAAAAAABdX0/9ZeCnXdYjck_2HgsgR6ewULZLbEWeIR1QCLcBGAsYHQ/s640/empire2.gif","sourceStatusCode":200,"destWidth":640,"destHeight":323,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn72@2020_1/2020/10/20/04-36-17-447_4157103449d7de43.webp","sourceBytes":3975411,"destBytes":4201082,"targetWebpQuality":75,"feedId":32407,"totalSpendMs":19770,"convertSpendMs":7821,"createdTime":"2020-10-20 12:36:00","host":"europe-59*","referer":"https://www.hackplayers.com/2020/08/payloads-cifrados-ps-con-xeca.html","linkMd5ListStr":"661de10007909e3ca00d2f2ffb765d0c","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.8 MB","destSize":"4 MB","compressRate":"105.7%"},{"code":1,"isDone":false,"source":"https://1.bp.blogspot.com/-oTp3Bd_e7Kw/Xy-kXAm6sNI/AAAAAAABdXk/dwdJl58pEX0pyGEfZJgpbtlFIAN_L6XJwCLcBGAsYHQ/s640/merlin2.gif","sourceStatusCode":200,"destWidth":640,"destHeight":323,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn67@2020_6/2020/10/20/04-36-22-928_9f0d84ac75cd1764.webp","sourceBytes":3126003,"destBytes":4978780,"targetWebpQuality":75,"feedId":32407,"totalSpendMs":25031,"convertSpendMs":11145,"createdTime":"2020-10-20 12:36:00","host":"europe21*","referer":"https://www.hackplayers.com/2020/08/payloads-cifrados-ps-con-xeca.html","linkMd5ListStr":"661de10007909e3ca00d2f2ffb765d0c","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3 MB","destSize":"4.7 MB","compressRate":"159.3%"}],"successGithubMap":{"myreaderx10":1,"myreaderx13":1,"myreaderx24":1,"myreaderx5oss":1},"failGithubMap":{"myreaderx23":1}}