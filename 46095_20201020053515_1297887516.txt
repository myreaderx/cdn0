{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-20 13:35:15","updatedTime":"2020-10-20 13:35:15","title":"UTF-8以外のエンコーディングの際のチェックポイント","link":"http://cakephp.seesaa.net/article/263592101.html","description":"\n１年ぶりの投稿だー。<br />いつの間にか時間が過ぎていました。<br /><br />で、今はたいていUTF-8で統一してサイトを作るのですが、今回、昔のシステムの中にCakeアプリをさっと入れようと思ったのですが、思わぬところではまったので書いておきます。<br /><br />・MySQL 4.0で、テーブルが EUC-JP(ujis)<br />・なので、database.php の中で、エンコーディングを ujis に設定した。<br />・CakePHP 1.3.14 で現在の最新版<br />・/app/views/layouts/default.ctpの中で、charset=euc-jpも設定した。<br /><br />なのに、<br />【問題】edit.php で日本語が消えてしまう！<br />という現象が発生しました。英語だときちんと表示、編集できます。なんだこりゃ。<br />最新版で入った問題点かな、とか疑ってしまいました。<br /><br />viewの中の $this->Form->inputから順番にたどっていったところ、内部で h()をかけていました。そして、<br />結局のところ、 core.php の中の App.encoding の値を見て、 htmlspecialchars() を実行していることが分かりました。あった、あったよ～（涙<br /><br />というわけで、\"UTF-8以外のcharsetを使ってCakePHPを使う場合\"には、<br /><br />・MySQLなら、テーブルのエンコードを確認<br />・database.php の中の encoding の値を確認<br />・/views/layouts/default.ctp の中の charset の値を確認<br />・core.php の中の、App.encoding の値を確認<br /><br />という４点セットが必要です。今の時代に UTF-8じゃないコーディングで使っている人がどれぐらいいるか分かりませんが、備忘録として書いておきます。<br /><br />ふぅ・・・。<br /><a name=\"more\"></a>\n\n\n","descriptionType":"html","publishedDate":"Tue, 10 Apr 2012 07:38:36 +0000","feedId":46095,"bgimg":"","linkMd5":"b2ab967a36acb145d2906a8df1b1c00a","bgimgJsdelivr":"","metaImg":"","author":"SDozono","publishedOrCreatedDate":1603172115057}],"record":{"createdTime":"2020-10-20 13:35:15","updatedTime":"2020-10-20 13:35:15","feedId":46095,"fetchDate":"Tue, 20 Oct 2020 05:35:15 +0000","fetchMs":361,"handleMs":26791,"totalMs":27174,"newArticles":0,"totalArticles":15,"status":1,"type":0,"ip":"fa10cf689958fca83c3f2c65b7f12392","hostName":"us-029*","requestId":"268a4348f7f946b0bcab9c07257cf1b1_46095","contentType":"application/xml","totalBytes":0,"bgimgsTotal":0,"bgimgsGithubTotal":0,"articlesImgsTotal":0,"articlesImgsGithubTotal":0,"successGithubMap":{},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 03:40:34","updatedTime":"2020-09-07 05:59:20","id":46095,"name":"CakePHP のおいしい食べ方","url":"http://cakephp.seesaa.net/index.rdf","subscriber":69,"website":null,"icon":"http://cakephp.seesaa.net/favicon.ico","icon_jsdelivr":null,"description":"CakePHPは、PHP言語の高速開発用フレームワークです。日々、発展を遂げる各種フレームワークの動向を見極めつつ、日本発のCakePHP応援ブログとして、最新情報をお届けします。","weekly":null,"link":"http://cakephp.seesaa.net"},"noPictureArticleList":[],"tmpCommonImgCdnBytes":0,"tmpBodyImgCdnBytes":0,"tmpBgImgCdnBytes":0,"extra4":{"start":1603172087904,"total":0,"statList":[{"spend":362,"msg":"获取xml内容"},{"spend":26791,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":0,"msg":"正文链接上传到cdn"}]},"extra5":0,"extra6":0,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{},"extra12ImgCdnSuccessResultVector":[],"successGithubMap":{},"failGithubMap":{}}