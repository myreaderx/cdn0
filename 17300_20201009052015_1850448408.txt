{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-09 13:18:57","updatedTime":"2020-10-09 13:18:57","title":"玩了一下 Github 个人首页的 Profile （使用 Action 自动更新）","link":"https://www.kawabangga.com/?p=4117","description":"<p>Github 最近推出了一个 <a href=\"https://docs.github.com/en/free-pro-team@latest/github/setting-up-and-managing-your-github-profile/about-your-profile\">Profile</a> 功能，大体上就是用户层面的 Readme。如果你新建一个和你的用户名一样名字的仓库，这个仓库的 Readme 就会展示在你的个人主页上。</p>\n<p>虽然仅仅是一 Markdown 形式的 Readme，但是可玩性也很多了。</p>\n<p>比如有一个服务，将这个服务 URL 的参数改成用户名，就可以用一个图片显示个人的开源贡献信息等，原理和项目上的 badge 差不多。</p>\n<p><a href=\"https://github.com/gaocegege\"><img class=\"aligncenter wp-image-4127 size-large\" src=\"https://www.kawabangga.com/wp-content/uploads/2020/10/gaocegege-readme-1024x452.png\" alt=\"\" width=\"615\" height=\"271\" srcset=\"https://www.kawabangga.com/wp-content/uploads/2020/10/gaocegege-readme-1024x452.png 1024w, https://www.kawabangga.com/wp-content/uploads/2020/10/gaocegege-readme-300x132.png 300w, https://www.kawabangga.com/wp-content/uploads/2020/10/gaocegege-readme-768x339.png 768w\" sizes=\"(max-width: 615px) 100vw, 615px\" /></a></p>\n<p>还有展示自己的睡眠数据的：</p>\n<p><a href=\"https://github.com/mscoutermarsh\"><img class=\"aligncenter wp-image-4128 size-large\" src=\"https://www.kawabangga.com/wp-content/uploads/2020/10/sleep-readme-1024x612.png\" alt=\"\" width=\"615\" height=\"368\" srcset=\"https://www.kawabangga.com/wp-content/uploads/2020/10/sleep-readme-1024x612.png 1024w, https://www.kawabangga.com/wp-content/uploads/2020/10/sleep-readme-300x179.png 300w, https://www.kawabangga.com/wp-content/uploads/2020/10/sleep-readme-768x459.png 768w\" sizes=\"(max-width: 615px) 100vw, 615px\" /></a></p>\n<p>还有展示年度进度的：</p>\n<p><a href=\"https://github.com/liununu\"><img class=\"aligncenter wp-image-4129 size-large\" src=\"https://www.kawabangga.com/wp-content/uploads/2020/10/year-progress-readme-1024x285.png\" alt=\"\" width=\"615\" height=\"171\" srcset=\"https://www.kawabangga.com/wp-content/uploads/2020/10/year-progress-readme-1024x285.png 1024w, https://www.kawabangga.com/wp-content/uploads/2020/10/year-progress-readme-300x83.png 300w, https://www.kawabangga.com/wp-content/uploads/2020/10/year-progress-readme-768x214.png 768w\" sizes=\"(max-width: 615px) 100vw, 615px\" /></a></p>\n<p>还有在主页交换链接的，并且把这些链接做成了很漂亮的卡片：</p>\n<p><a href=\"https://github.com/muan\"><img class=\"aligncenter wp-image-4130 size-large\" src=\"https://www.kawabangga.com/wp-content/uploads/2020/10/muan-readme-1024x442.png\" alt=\"\" width=\"615\" height=\"265\" srcset=\"https://www.kawabangga.com/wp-content/uploads/2020/10/muan-readme-1024x442.png 1024w, https://www.kawabangga.com/wp-content/uploads/2020/10/muan-readme-300x129.png 300w, https://www.kawabangga.com/wp-content/uploads/2020/10/muan-readme-768x331.png 768w\" sizes=\"(max-width: 615px) 100vw, 615px\" /></a></p>\n<p>&#160;</p>\n<p>我一直很喜欢看维基百科的 Picture of the Day，甚至有一段时间写周报的时候，每周都会贴一张 Picture of the Day 的图片在周报的末尾。一个原因是这些图片都非常精美，是由<a href=\"https://en.wikipedia.org/wiki/Wikipedia:Picture_of_the_day\">一个小组</a>挑选出来的，普通用户也可以贡献，你可以发现这个世界上还有这么漂亮的地方。另一个原因是阅读维基百科可以学到知识。</p>\n<p>&#160;</p>\n<div id=\"attachment_4131\" style=\"width: 625px\" class=\"wp-caption aligncenter\"><a href=\"https://www.kawabangga.com/wp-content/uploads/2020/10/1920px-Vaxholmsleden_February_2013_02_crop.jpg\"><img class=\"size-large wp-image-4131\" src=\"https://www.kawabangga.com/wp-content/uploads/2020/10/1920px-Vaxholmsleden_February_2013_02_crop-1024x683.jpg\" alt=\"\" width=\"615\" height=\"410\" srcset=\"https://www.kawabangga.com/wp-content/uploads/2020/10/1920px-Vaxholmsleden_February_2013_02_crop-1024x683.jpg 1024w, https://www.kawabangga.com/wp-content/uploads/2020/10/1920px-Vaxholmsleden_February_2013_02_crop-300x200.jpg 300w, https://www.kawabangga.com/wp-content/uploads/2020/10/1920px-Vaxholmsleden_February_2013_02_crop-768x512.jpg 768w\" sizes=\"(max-width: 615px) 100vw, 615px\" /></a><p class=\"wp-caption-text\">2020-01-02 的 POTD</p></div>\n<p>所以我就做了一个每天更新 Picture of the Day 的 Github Profile。基本的原理就是使用 Github 的 Action 功能，每天跑一个脚本，去维基百科查到今天的 Picture 地址，然后更新 Readme 中 Picture  的 URL，这个 Readme 就会展示在我的首页上。</p>\n<p><a href=\"https://www.kawabangga.com/wp-content/uploads/2020/10/EjIYo_PUcAABC48.jpeg\"><img class=\"aligncenter size-large wp-image-4132\" src=\"https://www.kawabangga.com/wp-content/uploads/2020/10/EjIYo_PUcAABC48-845x1024.jpeg\" alt=\"\" width=\"615\" height=\"745\" srcset=\"https://www.kawabangga.com/wp-content/uploads/2020/10/EjIYo_PUcAABC48-845x1024.jpeg 845w, https://www.kawabangga.com/wp-content/uploads/2020/10/EjIYo_PUcAABC48-248x300.jpeg 248w, https://www.kawabangga.com/wp-content/uploads/2020/10/EjIYo_PUcAABC48-768x931.jpeg 768w\" sizes=\"(max-width: 615px) 100vw, 615px\" /></a></p>\n<p>实现非常简单，所有的东西都在这个仓库里面。如果你想制作定时更新的 Profile, 可以参考一下这些脚本：<a href=\"https://github.com/laixintao/laixintao\">https://github.com/laixintao/laixintao</a></p>\n<p>有几个可以少走的弯路，分享一下：</p>\n<ol>\n<li>让 Action 的机器人 push commit 是一个比较 tricky 的事情，好在可以直接用别人写好的 Action，这就是 Github Action 的设计精妙之处吧。像 checkout, setup-python 这种东西，都有现成的 Action 了，不同的用户之间可以组合 Action 实现自己的 CI。git push 使用的 Action 是这个：<a href=\"https://github.com/ad-m/github-push-action\">https://github.com/ad-m/github-push-action</a> 使用方法可以参考<a href=\"https://github.com/laixintao/laixintao/blob/master/.github/workflows/update_picture_of_the_day.yaml#L28\">这里</a>，可以说非常简单，甚至 Github 的 Action 运行的时候默认就会设置环境变量 secrets.GITHUB_TOKEN，连你手动给机器人设置 Write 权限的 Token 都省去了。</li>\n<li>使用 Action 更新 commit 是一种方法，应该也是简单的方法。一开始我是想用 <a href=\"https://clock.sh/\">clock.sh</a> ，不需要 clone 下来仓库，直接使用 Github 的 API 去创建 block，然后创建 tree 和 commit，但是这样操作太复杂了，就放弃了。有想法的用户可以研究一下 <a href=\"https://docs.github.com/en/free-pro-team@latest/rest/reference/git#commits\">Github 的这套 API</a>。</li>\n<li>放弃了 <a href=\"https://clock.sh/\">clock.sh</a> 的代价就是…… Github Action 的 <code>schedule</code> 功能感觉有 bug. 如果 workflow.yml 写的有问题，Github 不会告诉你哪里有问题，直接就不会运行，对于调试来说还是挺不方便的；使用 <code>schedule</code> 会有一些坑。比如一你开始写了一个 crontab <code>15 * * * *</code> ，调来调去最后发现无论如何改都生效不了了。而且 Github 这边就是不运行，没有调试方法。比较直接的方法就是直接将 workflow 换一个名字，push 过去，这样相当于在 Github 那边新建了一个 workflow，重新 schedule. 所以遇到此类问题不要怀疑是不是你的 crontab 写错了，直接换一个 filename 吧。</li>\n<li><code>schedule</code> 功能最短的运行时间是 5min 1次，所以写 <code>* * * * *</code> 是没有意义的；</li>\n</ol>\n<p>最后，我发现维基百科有时候会更新出来很恶心的图片，比如今天的…… （恶心，慎点 <a href=\"https://en.wikipedia.org/wiki/Template:POTD/2020-10-08\">https://en.wikipedia.org/wiki/Template:POTD/2020-10-08</a> ）</p>\n<div class=\"crp_related \"><h3>相关文章:</h3><ul><li><a href=\"https://www.kawabangga.com/posts/4012\"    ><span class=\"crp_title\">Zoom 直播分享 Awesome Commandline 录像和资料下载</span></a></li><li><a href=\"https://www.kawabangga.com/posts/4090\"    ><span class=\"crp_title\">Reaper 使用 ReaFir 插件对音频降噪教程</span></a></li><li><a href=\"https://www.kawabangga.com/posts/2864\"    ><span class=\"crp_title\">搭建自己的静态 Wiki 站点（Vimwiki+Pages）</span></a></li><li><a href=\"https://www.kawabangga.com/posts/2557\"    ><span class=\"crp_title\">Tmux内部分享slides</span></a></li><li><a href=\"https://www.kawabangga.com/posts/3718\"    ><span class=\"crp_title\">PyCon China 2019演讲Slide: Django Migration Under the Hood</span></a></li></ul><div class=\"crp_clear\"></div></div>","descriptionType":"html","publishedDate":"Thu, 08 Oct 2020 16:57:28 +0000","feedId":17300,"bgimg":"https://www.kawabangga.com/wp-content/uploads/2020/10/gaocegege-readme-1024x452.png","linkMd5":"7eac73171ef557882384e389c0b64204","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn85@2020_5/2020/10/09/05-19-05-365_62c5e9fd41a4fb19.webp","destWidth":1024,"destHeight":452,"sourceBytes":227743,"destBytes":33512,"author":"laixintao","articleImgCdnMap":{"https://www.kawabangga.com/wp-content/uploads/2020/10/gaocegege-readme-1024x452.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn85@2020_5/2020/10/09/05-19-05-365_62c5e9fd41a4fb19.webp","https://www.kawabangga.com/wp-content/uploads/2020/10/sleep-readme-1024x612.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn3@2020_6/2020/10/09/05-19-10-950_dc28bc3641f85de7.webp","https://www.kawabangga.com/wp-content/uploads/2020/10/year-progress-readme-1024x285.png":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn94@2020_4/2020/10/09/05-19-14-533_d19278ef0f91a39e.webp","https://www.kawabangga.com/wp-content/uploads/2020/10/muan-readme-1024x442.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn100@2020_5/2020/10/09/05-19-12-211_c4672f4df1d7916d.webp","https://www.kawabangga.com/wp-content/uploads/2020/10/1920px-Vaxholmsleden_February_2013_02_crop-1024x683.jpg":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn1@2020_6/2020/10/09/05-20-14-492_8d6852dca0826d21.webp","https://www.kawabangga.com/wp-content/uploads/2020/10/EjIYo_PUcAABC48-845x1024.jpeg":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn98@2020_4/2020/10/09/05-19-10-425_f76944d002396b41.webp"},"publishedOrCreatedDate":1602220737851}],"record":{"createdTime":"2020-10-09 13:18:57","updatedTime":"2020-10-09 13:18:57","feedId":17300,"fetchDate":"Fri, 09 Oct 2020 05:18:57 +0000","fetchMs":4256,"handleMs":49,"totalMs":82641,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"135b586132fb35cbb1669fe09384b6b7","hostName":"us-002*","requestId":"cb5e1144791f4ac79e8f5a8310d87741_17300","contentType":"application/rss+xml; charset=UTF-8","totalBytes":409788,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":6,"articlesImgsGithubTotal":6,"successGithubMap":{"myreaderx4":1,"myreaderx10":1,"myreaderx2":1,"myreaderx13":1,"myreaderx30":1,"myreaderx29":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 02:14:47","updatedTime":"2020-09-07 02:46:12","id":17300,"name":"卡瓦邦噶！","url":"https://www.kawabangga.com/feed","subscriber":192,"website":null,"icon":"https://www.kawabangga.com/wp-content/uploads/2017/04/favicon.png","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx62/cdn86@2020_1/2020/09/06/18-46-11-558_c87f5c2fb1ed9d4e.png","description":"无法自制的人得不到自由。","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":33512,"tmpBodyImgCdnBytes":376276,"tmpBgImgCdnBytes":0,"extra4":{"start":1602220733019,"total":0,"statList":[{"spend":4784,"msg":"获取xml内容"},{"spend":49,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":69384,"msg":"正文链接上传到cdn"}]},"extra5":6,"extra6":6,"extra7ImgCdnFailResultVector":[null],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-010.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-009.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe70.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-012.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-011.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://www.kawabangga.com/wp-content/uploads/2020/10/gaocegege-readme-1024x452.png","sourceStatusCode":200,"destWidth":1024,"destHeight":452,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn85@2020_5/2020/10/09/05-19-05-365_62c5e9fd41a4fb19.webp","sourceBytes":227743,"destBytes":33512,"targetWebpQuality":75,"feedId":17300,"totalSpendMs":8390,"convertSpendMs":28,"createdTime":"2020-10-09 13:18:57","host":"us-020*","referer":"https://www.kawabangga.com/?p=4117","linkMd5ListStr":"7eac73171ef557882384e389c0b64204,7eac73171ef557882384e389c0b64204","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"222.4 KB","destSize":"32.7 KB","compressRate":"14.7%"},{"code":1,"isDone":false,"source":"https://www.kawabangga.com/wp-content/uploads/2020/10/EjIYo_PUcAABC48-845x1024.jpeg","sourceStatusCode":200,"destWidth":845,"destHeight":1024,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn98@2020_4/2020/10/09/05-19-10-425_f76944d002396b41.webp","sourceBytes":96316,"destBytes":55784,"targetWebpQuality":75,"feedId":17300,"totalSpendMs":5065,"convertSpendMs":54,"createdTime":"2020-10-09 13:19:06","host":"us-009*","referer":"https://www.kawabangga.com/?p=4117","linkMd5ListStr":"7eac73171ef557882384e389c0b64204","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"94.1 KB","destSize":"54.5 KB","compressRate":"57.9%"},{"code":1,"isDone":false,"source":"https://www.kawabangga.com/wp-content/uploads/2020/10/sleep-readme-1024x612.png","sourceStatusCode":200,"destWidth":1024,"destHeight":612,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn3@2020_6/2020/10/09/05-19-10-950_dc28bc3641f85de7.webp","sourceBytes":313543,"destBytes":41066,"targetWebpQuality":75,"feedId":17300,"totalSpendMs":5573,"convertSpendMs":47,"createdTime":"2020-10-09 13:19:06","host":"us-012*","referer":"https://www.kawabangga.com/?p=4117","linkMd5ListStr":"7eac73171ef557882384e389c0b64204","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"306.2 KB","destSize":"40.1 KB","compressRate":"13.1%"},{"code":1,"isDone":false,"source":"https://www.kawabangga.com/wp-content/uploads/2020/10/muan-readme-1024x442.png","sourceStatusCode":200,"destWidth":1024,"destHeight":442,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn100@2020_5/2020/10/09/05-19-12-211_c4672f4df1d7916d.webp","sourceBytes":219802,"destBytes":26842,"targetWebpQuality":75,"feedId":17300,"totalSpendMs":6746,"convertSpendMs":29,"createdTime":"2020-10-09 13:19:06","host":"us-010*","referer":"https://www.kawabangga.com/?p=4117","linkMd5ListStr":"7eac73171ef557882384e389c0b64204","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"214.7 KB","destSize":"26.2 KB","compressRate":"12.2%"},{"code":1,"isDone":false,"source":"https://www.kawabangga.com/wp-content/uploads/2020/10/year-progress-readme-1024x285.png","sourceStatusCode":200,"destWidth":1024,"destHeight":285,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn94@2020_4/2020/10/09/05-19-14-533_d19278ef0f91a39e.webp","sourceBytes":122096,"destBytes":20828,"targetWebpQuality":75,"feedId":17300,"totalSpendMs":9556,"convertSpendMs":17,"createdTime":"2020-10-09 13:19:06","host":"europe70*","referer":"https://www.kawabangga.com/?p=4117","linkMd5ListStr":"7eac73171ef557882384e389c0b64204","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"119.2 KB","destSize":"20.3 KB","compressRate":"17.1%"},{"code":1,"isDone":false,"source":"https://www.kawabangga.com/wp-content/uploads/2020/10/1920px-Vaxholmsleden_February_2013_02_crop-1024x683.jpg","sourceStatusCode":200,"destWidth":1024,"destHeight":683,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn1@2020_6/2020/10/09/05-20-14-492_8d6852dca0826d21.webp","sourceBytes":273860,"destBytes":231756,"targetWebpQuality":75,"feedId":17300,"totalSpendMs":9216,"convertSpendMs":50,"createdTime":"2020-10-09 13:20:06","host":"us-010*","referer":"https://www.kawabangga.com/?p=4117","linkMd5ListStr":"7eac73171ef557882384e389c0b64204","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"267.4 KB","destSize":"226.3 KB","compressRate":"84.6%"}],"successGithubMap":{"myreaderx4":1,"myreaderx10":1,"myreaderx2":1,"myreaderx13":1,"myreaderx30":1,"myreaderx29":1},"failGithubMap":{}}