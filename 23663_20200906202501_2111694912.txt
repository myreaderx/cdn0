{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-09-07 04:24:28","updatedTime":"2020-09-07 04:24:28","title":"“Fancybox for WordPress Has Expired” Infection","link":"http://blog.unmaskparasites.com/?p=950","description":"<p>Today I began to notice quite a massive and <strong>very unusual</strong> attack that leverages <a href=\"http://blog.sucuri.net/2015/02/zero-day-in-the-fancybox-for-wordpress-plugin.html\">vulnerabilities in older versions of the FancyBox for WordPress</a> plugin.</p>\n<p><span id=\"more-950\"></span></p>\n<p>As you might know, versions <strong>3.0.2</strong> and older of this plugin <a href=\"http://blog.sucuri.net/2015/02/analysis-of-the-fancybox-for-wordpress-vulnerability.html\">allowed anyone to craft special POST requests</a> to <strong>/wp-admin/admin-post.php </strong>or <strong>/wp-admin/admin-ajax.php</strong> and change values of specific plugin options in WordPress database. The plugin uses the modified options to build its own JavaScript code. As a result, the malicious content gets injected into generated WordPress pages.</p>\n<p>A typical malicious injection looks like this:</p>\n<p><img class=\"aligncenter size-full wp-image-942\" alt=\"Fancybox infection\" src=\"http://blog.unmaskparasites.com/wp-content/uploads/2015/04/fancybox-infection.gif\" width=\"560\" height=\"321\" /></p>\n<p>Such attacks use the <a href=\"http://www.exploit-db.com/exploits/36087/\">documented exploit code</a> to inject malicious code into the &#8220;<strong>padding</strong>&#8221; value.</p>\n<p>The exploited vulnerability had been fixed on February 4th. Nonetheless, many blogs failed to update the plugin and hackers routinely find such blogs and infect them.</p>\n<p>The today&#8217;s attack also uses this exploit and modifies the &#8220;<strong>padding</strong>&#8221; value, but the code it injects cannot be called <em>malicious</em>:</p>\n<p><img class=\"aligncenter size-full wp-image-942\" alt=\"Fancybox expired warning\" src=\"http://blog.unmaskparasites.com/wp-content/uploads/2015/04/fancybox-expired-injection.gif\" width=\"560\" height=\"319\" /></p>\n<p>When visitors load such &#8220;<em>infected</em>&#8221; pages, they see this warning:</p>\n<blockquote><p><strong>WARNING: This version of the Fancybox for WordPress plugin has expired!</strong><br />\n<strong> Please upgrade to the latest version!</strong></p></blockquote>\n<p>And when they click on the &#8220;OK&#8221; button, they automatically get redirected to the <a href=\"https://wordpress.org/plugins/fancybox-for-wordpress/changelog/\">Fancybox for WordPress changelog page</a> in the official WordPress plugin repository.</p>\n<p>On one hand, this infection makes blogs unusable since it redirects visitors to WordPress plugin repository before they can read anything. On the other hand, it is very hard to ignore such a warning &#8212; if site owners want people to visit their sites they have to upgrade (or remove) the vulnerable version of the plugin ASAP.</p>\n<p>Now is the time to check if your blog shows such warnings. If you don&#8217;t see them, it&#8217;s not a reason to relax and wait for such a hard push to upgrade. Make sure all your themes and plugins are up-to-date now.</p>\n<p>&#160;</p>\n","descriptionType":"html","publishedDate":"Wed, 01 Apr 2015 12:24:11 +0000","feedId":23663,"bgimg":"http://blog.unmaskparasites.com/wp-content/uploads/2015/04/fancybox-infection.gif","linkMd5":"ebe5f85b3a7e8fe4b12ace1d16ba6179","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn64@2020_4/2020/09/06/20-24-44-034_06ec8e50866da3e6.webp","destWidth":560,"destHeight":321,"sourceBytes":32428,"destBytes":42218,"author":"Denis","articleImgCdnMap":{"http://blog.unmaskparasites.com/wp-content/uploads/2015/04/fancybox-infection.gif":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn64@2020_4/2020/09/06/20-24-44-034_06ec8e50866da3e6.webp","http://blog.unmaskparasites.com/wp-content/uploads/2015/04/fancybox-expired-injection.gif":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn75@2020_3/2020/09/06/20-25-00-438_32cdd67d382258fe.webp"},"publishedOrCreatedDate":1599423868824}],"record":{"createdTime":"2020-09-07 04:24:28","updatedTime":"2020-09-07 04:24:28","feedId":23663,"fetchDate":"Sun, 06 Sep 2020 20:24:28 +0000","fetchMs":65,"handleMs":30890,"totalMs":63728,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"6da9f5c5105826521b693cdf674daebe","hostName":"us-031*","requestId":"9a12bb152f634310b8557057727a8ea6_23663","contentType":"text/xml; charset=UTF-8","totalBytes":64692,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":2,"articlesImgsGithubTotal":2,"successGithubMap":{"myreaderx25":1,"myreaderx21":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 02:31:02","updatedTime":"2020-09-07 02:31:02","id":23663,"name":"Unmask Parasites. Blog.","url":"http://blog.unmaskparasites.com/feed/","subscriber":139,"website":null,"icon":"http://blog.unmaskparasites.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx65/cdn41@2020_6/2020/09/06/20-24-28-090_a253b3d9b5086240.ico","description":"Website insecurity by example","weekly":null,"link":"http://blog.unmaskparasites.com"},"noPictureArticleList":[],"tmpCommonImgCdnBytes":42218,"tmpBodyImgCdnBytes":22474,"tmpBgImgCdnBytes":0,"extra4":{"start":1599423837842,"total":0,"statList":[{"spend":92,"msg":"获取xml内容"},{"spend":30890,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":16611,"msg":"正文链接上传到cdn"}]},"extra5":2,"extra6":2,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe65.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"http://blog.unmaskparasites.com/wp-content/uploads/2015/04/fancybox-infection.gif","sourceStatusCode":200,"destWidth":560,"destHeight":321,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn64@2020_4/2020/09/06/20-24-44-034_06ec8e50866da3e6.webp","sourceBytes":32428,"destBytes":42218,"targetWebpQuality":75,"feedId":23663,"totalSpendMs":16108,"convertSpendMs":26,"createdTime":"2020-09-07 04:24:28","host":"us-026*","referer":"http://blog.unmaskparasites.com/?p=950","linkMd5ListStr":"ebe5f85b3a7e8fe4b12ace1d16ba6179,ebe5f85b3a7e8fe4b12ace1d16ba6179","githubUser":"myreaderx21","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"31.7 KB","destSize":"41.2 KB","compressRate":"130.2%"},{"code":1,"isDone":false,"source":"http://blog.unmaskparasites.com/wp-content/uploads/2015/04/fancybox-expired-injection.gif","sourceStatusCode":200,"destWidth":560,"destHeight":319,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn75@2020_3/2020/09/06/20-25-00-438_32cdd67d382258fe.webp","sourceBytes":19133,"destBytes":22474,"targetWebpQuality":75,"feedId":23663,"totalSpendMs":16455,"convertSpendMs":19,"createdTime":"2020-09-07 04:24:45","host":"europe65*","referer":"http://blog.unmaskparasites.com/?p=950","linkMd5ListStr":"ebe5f85b3a7e8fe4b12ace1d16ba6179","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"18.7 KB","destSize":"21.9 KB","compressRate":"117.5%"}],"successGithubMap":{"myreaderx25":1,"myreaderx21":1},"failGithubMap":{}}