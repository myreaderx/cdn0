{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-12-01 23:29:49","updatedTime":"2020-12-01 23:29:49","title":"用Python爬取英雄联盟（lol）全部皮肤","link":"https://segmentfault.com/a/1190000038333555","description":"<p>小三：“怎么了小二？一副无精打采的样子！”</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0sS\" alt=\"image\" title=\"image\" /></p>\n<p>小二：“唉！别提了，还不是最近又接触了一个叫英雄联盟的游戏，游戏中很多皮肤都需要花钱买，但是我钱不够呀...”</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0sV\" alt=\"image\" title=\"image\" /></p>\n<p>小三：“咋得，钱攒够了你还要买呀？还吃不吃饭了？！要我说，你干脆将英雄的炫彩皮肤都爬下来欣赏一下得了，饭钱还给你省下了。”</p>\n<p>小二：“你说的也对，毕竟吃饭更重要，那我还是爬取皮肤欣赏一下算了。”</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0sW\" alt=\"image\" title=\"image\" /></p>\n<p>首先，我们打开英雄联盟官网主页，网址为：<code>https://lol.qq.com/main.shtml</code>，然后向下拉，可以看到英雄列表，如图所示：</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0s1\" alt=\"image\" title=\"image\" /></p>\n<p>接着随意选一个英雄点击进入看一下，如图所示：</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0s2\" alt=\"image\" title=\"image\" /></p>\n<p>再点击鼠标右键，接着选择<code>检查</code>，看一下皮肤的 URL，如图所示：</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0s5\" alt=\"image\" title=\"image\" /></p>\n<p>通过观察，可以发现英雄皮肤 URL 组成方式为：<code>https://game.gtimg.cn/images/lol/act/img/skin/big + 英雄id + 皮肤id.jpg</code>。</p>\n<p>我们先看<code>皮肤id</code>，也就是看皮肤的个数，选择开发者工具的<code>Network</code>项，之后刷新一下页面，可以发现有一个<code>17.js</code>的请求，<code>17</code>实际就是<code>英雄id</code>，如图所示：</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0s6\" alt=\"image\" title=\"image\" /></p>\n<p>再选择<code>Response</code>项看一下相应数据，如图所示：</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0s7\" alt=\"image\" title=\"image\" /></p>\n<p>我们可以看到数据都显示在了一行，看着不太方便，我们将其格式化看一下，如图所示：</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0s8\" alt=\"image\" title=\"image\" /></p>\n<p>通过观察，可以发现获取指定英雄<code>皮肤id</code>的 URL 就是：<code>https://game.gtimg.cn/images/lol/act/img/js/hero/ + 英雄id.js</code>，获取<code>皮肤id</code>及下载皮肤图片的代码实现如下：</p>\n<pre><code class=\"python\">hero_skin_url = 'https://game.gtimg.cn/images/lol/act/img/js/hero/' + hero_id + '.js'\n# 通过 url 获取英雄的皮肤数量\nskin_text = requests.get(hero_skin_url).text\nskin_json = json.loads(skin_text)\nskin_list = skin_json['skins']\n# 获取皮肤名\nhero_skins.clear()\nfor skin in skin_list:\n    hero_skins.append(skin['name'].replace('/', '').replace('\\\\', '').replace(' ', ''))\n# 皮肤数量\nskins_num = len(hero_skins)\ns = ''\nfor i in tqdm(range(skins_num), desc='【' + hero_name + '】皮肤下载'):\n    if len(str(i)) == 1:\n        s = '00' + str(i)\n    elif len(str(i)) == 2:\n        s = '0' + str(i)\n    elif len(str(i)) == 3:\n        pass\n    try:\n        # 拼接指定皮肤的 url\n        skin_url = 'https://game.gtimg.cn/images/lol/act/img/skin/big' + hero_id + '' + s + '.jpg'\n        img = requests.get(skin_url)\n    except:\n        # 没有炫彩皮肤 url 则跳过\n        continue\n    # 保存皮肤图片\n    if img.status_code == 200:\n        with open(hero_skins[i] + '.jpg', 'wb') as f:\n            f.write(img.content)</code></pre>\n<p>现在就差<code>英雄id</code>参数的获取了，我们接着看如何获取全部的<code>英雄id</code>，返回到 <code>https://lol.qq.com/main.shtml</code>页面，打开开发者工具并选择<code>Network</code>，然后刷新页面，我们可以观察到有一个<code>hero_list.js</code>的请求，如图所示：</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0tb\" alt=\"image\" title=\"image\" /></p>\n<p>与<code>皮肤id</code>的获取基本类似，通过这个请求就可以获取到英雄的全部<code>英雄id</code>，代码实现如下：</p>\n<pre><code class=\"python\">url = 'https://game.gtimg.cn/images/lol/act/img/js/heroList/hero_list.js'\nhero_text = requests.get(url).text\n# 转为 json 格式\nhero_json = json.loads(hero_text)['hero']\npath = os.getcwd()\n# 获取当前文件夹路径\nworkspace = os.getcwd()\n# 皮肤路径\nskin_path = \"{}\\\\{}\".format(workspace, 'skins')\n# 遍历列表\nfor hero in hero_json:\n    # 将每一个英雄的 id、name 放入一个字典中\n    hero_dict = {'id': hero['heroId'], 'name': hero['name']}\n    # 放入列表\n    heros.append(hero_dict)</code></pre>\n<p>我们可以看出：代码中除了<code>英雄id</code>，还获取了<code>英雄name</code>，并将每一个英雄的<code>id</code>、<code>name</code>放在了一个字典中，又将所有英雄对应的字典放在了列表中。</p>\n<p>最后，我们看一下下载效果：</p>\n<p><img src=\"https://segmentfault.com/img/bVcK0tf\" alt=\"image\" title=\"image\" /></p>\n<p>源码在公众号 <strong>Python小二</strong> 后台回复 <strong>201130</strong> 获取。</p>","descriptionType":"html","publishedDate":"Mon, 30 Nov 2020 12:14:06 +0000","feedId":23280,"bgimg":"https://segmentfault.com/img/bVcK0sS","linkMd5":"18e76ed73e500c6311c12b669266966a","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn55@2020_1/2020/12/01/15-30-06-281_30869d4828df0707.webp","destWidth":308,"destHeight":396,"sourceBytes":20410,"destBytes":20410,"author":"Python小二","articleImgCdnMap":{"https://segmentfault.com/img/bVcK0sS":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn55@2020_1/2020/12/01/15-30-06-281_30869d4828df0707.webp","https://segmentfault.com/img/bVcK0sV":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn87@2020_3/2020/12/01/15-30-13-813_f946a6fdb049516e.webp","https://segmentfault.com/img/bVcK0sW":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn83@2020_2/2020/12/01/15-30-10-323_15891c78ac45731c.webp","https://segmentfault.com/img/bVcK0s1":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn60@2020_2/2020/12/01/15-30-13-777_c951ae73078c4023.webp","https://segmentfault.com/img/bVcK0s2":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn61@2020_1/2020/12/01/15-30-11-694_849c8e06c9a414eb.webp","https://segmentfault.com/img/bVcK0s5":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn76@2020_4/2020/12/01/15-30-10-655_f8e63ce64c83f6a2.webp","https://segmentfault.com/img/bVcK0s6":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn79@2020_4/2020/12/01/15-30-13-719_fe9be63cacd1f7e0.webp","https://segmentfault.com/img/bVcK0s7":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn68@2020_2/2020/12/01/15-30-10-660_22a94c554d4fe13e.webp","https://segmentfault.com/img/bVcK0s8":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn71@2020_4/2020/12/01/15-30-17-352_929d81a49cd2de44.webp","https://segmentfault.com/img/bVcK0tb":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn91@2020_2/2020/12/01/15-30-12-037_587b27764c32850b.webp","https://segmentfault.com/img/bVcK0tf":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn95@2020_5/2020/12/01/15-30-13-108_5a3960b552b11bd2.webp"},"publishedOrCreatedDate":1606836589548}],"record":{"createdTime":"2020-12-01 23:29:49","updatedTime":"2020-12-01 23:29:49","feedId":23280,"fetchDate":"Tue, 01 Dec 2020 15:29:49 +0000","fetchMs":7920,"handleMs":12798,"totalMs":53133,"newArticles":0,"totalArticles":50,"status":1,"type":0,"ip":"4497ab9f7697a675d17e3a005b702b9e","hostName":"europe-25*","requestId":"9f620348ea104f5ca03c92cf6a8cdc54_23280","contentType":"application/atom+xml; charset=UTF-8","totalBytes":734582,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":11,"articlesImgsGithubTotal":11,"successGithubMap":{"myreaderx14":1,"myreaderx7":1,"myreaderx6":1,"myreaderx10":1,"myreaderx32":1,"myreaderx33":1,"myreaderx13":1,"myreaderx24":1,"myreaderx1":1,"myreaderx31":1,"myreaderx18":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 02:29:58","updatedTime":"2020-11-12 13:51:25","id":23280,"name":"SegmentFault 最新的文章","url":"https://segmentfault.com/feeds/blogs","subscriber":142,"website":null,"icon":"https://segmentfault.com/favicon.ico","icon_jsdelivr":null,"description":"","weekly":null,"link":"https://segmentfault.com"},"noPictureArticleList":[],"tmpCommonImgCdnBytes":20410,"tmpBodyImgCdnBytes":714172,"tmpBgImgCdnBytes":0,"extra4":{"start":1606836565404,"total":0,"statList":[{"spend":11346,"msg":"获取xml内容"},{"spend":12798,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":11249,"msg":"正文链接上传到cdn"}]},"extra5":11,"extra6":11,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-53.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe69.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-031.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe65.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-007.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-019.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-003.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-015.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-026.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-027.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0sS","sourceStatusCode":200,"destWidth":308,"destHeight":396,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn55@2020_1/2020/12/01/15-30-06-281_30869d4828df0707.webp","sourceBytes":20410,"destBytes":20410,"feedId":23280,"totalSpendMs":5401,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:01","host":"europe61*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a,18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"19.9 KB","destSize":"19.9 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0sW","sourceStatusCode":200,"destWidth":247,"destHeight":212,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn83@2020_2/2020/12/01/15-30-10-323_15891c78ac45731c.webp","sourceBytes":10336,"destBytes":10336,"feedId":23280,"totalSpendMs":3686,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"us-031*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"10.1 KB","destSize":"10.1 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0s7","sourceStatusCode":200,"destWidth":800,"destHeight":212,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn68@2020_2/2020/12/01/15-30-10-660_22a94c554d4fe13e.webp","sourceBytes":20658,"destBytes":20658,"feedId":23280,"totalSpendMs":4172,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"us-015*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"20.2 KB","destSize":"20.2 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0s5","sourceStatusCode":200,"destWidth":800,"destHeight":499,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn76@2020_4/2020/12/01/15-30-10-655_f8e63ce64c83f6a2.webp","sourceBytes":73422,"destBytes":73422,"feedId":23280,"totalSpendMs":4595,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"europe65*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"71.7 KB","destSize":"71.7 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0s2","sourceStatusCode":200,"destWidth":800,"destHeight":408,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn61@2020_1/2020/12/01/15-30-11-694_849c8e06c9a414eb.webp","sourceBytes":86862,"destBytes":86862,"feedId":23280,"totalSpendMs":5306,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"us-027*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"84.8 KB","destSize":"84.8 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0tb","sourceStatusCode":200,"destWidth":800,"destHeight":467,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn91@2020_2/2020/12/01/15-30-12-037_587b27764c32850b.webp","sourceBytes":69414,"destBytes":69414,"feedId":23280,"totalSpendMs":5547,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"us-007*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"67.8 KB","destSize":"67.8 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0sV","sourceStatusCode":200,"destWidth":277,"destHeight":281,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn87@2020_3/2020/12/01/15-30-13-813_f946a6fdb049516e.webp","sourceBytes":22450,"destBytes":22450,"feedId":23280,"totalSpendMs":7210,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"us-019*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"21.9 KB","destSize":"21.9 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0s6","sourceStatusCode":200,"destWidth":800,"destHeight":546,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn79@2020_4/2020/12/01/15-30-13-719_fe9be63cacd1f7e0.webp","sourceBytes":73400,"destBytes":73400,"feedId":23280,"totalSpendMs":7272,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"us-53*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"71.7 KB","destSize":"71.7 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0s1","sourceStatusCode":200,"destWidth":800,"destHeight":283,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn60@2020_2/2020/12/01/15-30-13-777_c951ae73078c4023.webp","sourceBytes":66096,"destBytes":66096,"feedId":23280,"totalSpendMs":7269,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"us-026*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"64.5 KB","destSize":"64.5 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0tf","sourceStatusCode":200,"destWidth":800,"destHeight":264,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn95@2020_5/2020/12/01/15-30-13-108_5a3960b552b11bd2.webp","sourceBytes":195006,"destBytes":195006,"feedId":23280,"totalSpendMs":7893,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"europe69*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"190.4 KB","destSize":"190.4 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/bVcK0s8","sourceStatusCode":200,"destWidth":800,"destHeight":534,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn71@2020_4/2020/12/01/15-30-17-352_929d81a49cd2de44.webp","sourceBytes":96528,"destBytes":96528,"feedId":23280,"totalSpendMs":11072,"convertSpendMs":0,"createdTime":"2020-12-01 23:30:07","host":"us-003*","referer":"https://segmentfault.com/a/1190000038333555","linkMd5ListStr":"18e76ed73e500c6311c12b669266966a","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"94.3 KB","destSize":"94.3 KB","compressRate":"100%"}],"successGithubMap":{"myreaderx14":1,"myreaderx7":1,"myreaderx6":1,"myreaderx10":1,"myreaderx32":1,"myreaderx33":1,"myreaderx13":1,"myreaderx24":1,"myreaderx1":1,"myreaderx31":1,"myreaderx18":1},"failGithubMap":{}}