{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2022-03-14 19:29:39","updatedTime":"2022-03-14 19:29:39","title":"\n        Wayfire 迁移进展（四）：不那么 high 的 DPI\n      ","link":"https://blog.lilydjwg.me/posts/216078","description":"\n        <p style=\"text-indent: 2em; font-style: italic;\">本文来自<a href=\"https://blog.lilydjwg.me/\">依云's Blog</a>，转载请注明。</p><p>\n\t使用24寸4k屏幕作为主屏的时候很简单，设置 scale 为 2 就好了。但是，当 2 嫌太大、1 嫌太小的时候，问题就来了。比如我希望使用 120dpi，把 scale 设置为 1.25 可好？</p>\n<p style=\"text-align: center;\">\n\t<a href=\"https://store.lilydjwg.me/img/blog/wayland-1.25scale/1.25scale.png\"><img alt=\"scale=1.25 text\" src=\"https://store.lilydjwg.me/img/blog/wayland-1.25scale/1.25scale.png\" /></a></p>\n<p>\n\t而这才是理想的效果：</p>\n<p style=\"text-align: center;\">\n\t<a href=\"https://store.lilydjwg.me/img/blog/wayland-1.25scale/1.25text.png\"><img alt=\"120dpi text\" src=\"https://store.lilydjwg.me/img/blog/wayland-1.25scale/1.25text.png\" /></a></p>\n<p>\n\t看不出来差别？放大八倍，你看差别多明显：</p>\n<p style=\"text-align: center;\">\n\t<a href=\"https://store.lilydjwg.me/img/blog/wayland-1.25scale/compare.png\"><img alt=\"8x compare\" src=\"https://store.lilydjwg.me/img/blog/wayland-1.25scale/compare.png\" /></a></p>\n<p>\n\t正常 120dpi 渲染出来的文字边缘清晰犀利，次像素平滑左红右蓝。再看看 scale=1.25 的文字，线条经常糊掉，次像素平滑效果几乎完全被抹掉。实际看上去的效果就是跟透明麿沙玻璃看屏幕似的，线条边缘总是有点糊糊的感觉，1080p 的屏幕被降级成了 720p 似的。</p>\n<p>\n\t之所以出现这样的情况，是因为 <a href=\"https://wayland.freedesktop.org/docs/html/apa.html#protocol-spec-wl_output-event-scale\">Wayland 只支持整数倍缩放</a>。因为，Wayland 混成器不能告诉客户端你得把窗口给画成 1.25 倍的，而客户端也<a href=\"https://wayland.freedesktop.org/docs/html/apa.html#protocol-spec-wl_surface-request-set_buffer_scale\">无法告诉混成器我这个图像画的是 1.25 倍</a>。所以，混成器只好告诉客户端你给我画个 2 倍的图像吧。混成器拿到图像之后再缩小 0.625 倍，自然有些逻辑像素就不能对应到单个的物理像素上去了。</p>\n<p>\n\t所以，我还是设置 scale=1，不要混成器帮我去缩放。我自己通过另外的办法告诉客户端把字写大点儿。图标之类的就顾不上啦，反而大点小点都还能看。比如我要 1.25 倍大小的文字，就这样做：</p>\n<ul>\n\t<li>\n\t\tGTK 3：在 dconf 里设置<code>org.gnome.desktop.interface.text-scaling-factor=1.25</code>就好了。最开始的截图就是 dconf-editor 里这一项配置。</li>\n\t<li>\n\t\tQt：设置环境变量 <code>QT_WAYLAND_FORCE_DPI=120</code>。</li>\n\t<li>\n\t\tTelegram：除了上边这个环境变量外，额外地在它自己的设置里设置 150% 的缩放（Telegram 的字偏小所以要设置得大一些）。设置环境变量是为了 fcitx5。</li>\n\t<li>\n\t\twaybar：<code>config</code> 文件中设置 <code>height</code>，<code>style.css</code> 中设置 <code>font-size</code>。</li>\n\t<li>\n\t\tXwayland：和 <a href=\"https://blog.lilydjwg.me/2020/11/21/hidpi-configuration.215594.html\">X11 下的 HiDPI 设置</a>差不多的。比如 GTK 2 设置 Xresources <code>Xft.dpi: 120</code> 就好了。</li>\n</ul>\n<p>\n\t我遇到的差不多就这些了。没办法，Linux 就是这么乱 QAQ。不过虽然 Wayland 协议不支持，好歹还有绕过的办法。</p>\n\n      ","descriptionType":"text/html","publishedDate":"Wed, 02 Feb 2022 09:23:30 +0000","feedId":9917,"bgimg":"https://store.lilydjwg.me/img/blog/wayland-1.25scale/1.25scale.png","linkMd5":"50164b09718d76f9745fa3f10729a2b8","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn4@2020_5/2022/03/14/11-29-39-156_f0f8395272441aa7.webp","destWidth":606,"destHeight":527,"sourceBytes":56417,"destBytes":18450,"author":"依云","articleImgCdnMap":{"https://store.lilydjwg.me/img/blog/wayland-1.25scale/1.25scale.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn4@2020_5/2022/03/14/11-29-39-156_f0f8395272441aa7.webp","https://store.lilydjwg.me/img/blog/wayland-1.25scale/1.25text.png":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn7@2020_4/2022/03/14/11-29-39-551_59141ba19333710f.webp","https://store.lilydjwg.me/img/blog/wayland-1.25scale/compare.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn11@2020_2/2022/03/14/11-29-39-680_3c427aba3b67163b.webp"},"publishedOrCreatedDate":1647257379061}],"record":{"createdTime":"2022-03-14 19:29:39","updatedTime":"2022-03-14 19:29:39","feedId":9917,"fetchDate":"Mon, 14 Mar 2022 11:29:39 +0000","fetchMs":22942,"handleMs":21386,"totalMs":45380,"newArticles":0,"totalArticles":12,"status":1,"type":0,"ip":"245d88d7b2d8f26704713c23b090d029","hostName":"us-54*","requestId":"e63abe00f5fd48908ef8e53fd2f9ad9e_9917","contentType":"application/rss+xml; charset=utf-8","totalBytes":65080,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":3,"articlesImgsGithubTotal":3,"successGithubMap":{"myreaderx16":1,"myreaderx11":1,"myreaderx1":1},"failGithubMap":{}},"feed":{"createdTime":"2020-08-25 04:35:30","updatedTime":"2020-08-25 04:35:30","id":9917,"name":"\n      依云's Blog\n    ","url":"https://blog.lilydjwg.me/posts.rss","subscriber":null,"website":null,"icon":"https://blog.lilydjwg.me/favicon.ico","icon_jsdelivr":null,"description":"\n      \n    ","weekly":null,"link":"https://blog.lilydjwg.me"},"noPictureArticleList":[],"tmpCommonImgCdnBytes":18450,"tmpBodyImgCdnBytes":46630,"tmpBgImgCdnBytes":0,"extra4":{"start":1647257334688,"total":0,"statList":[{"spend":22987,"msg":"获取xml内容"},{"spend":21386,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":640,"msg":"正文链接上传到cdn"}]},"extra5":3,"extra6":3,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe65.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-002.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://store.lilydjwg.me/img/blog/wayland-1.25scale/1.25scale.png","sourceStatusCode":200,"destWidth":606,"destHeight":527,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn4@2020_5/2022/03/14/11-29-39-156_f0f8395272441aa7.webp","sourceBytes":56417,"destBytes":18450,"targetWebpQuality":75,"feedId":9917,"totalSpendMs":346,"convertSpendMs":41,"createdTime":"2022-03-14 19:29:39","host":"us-014*","referer":"https://blog.lilydjwg.me/posts/216078","linkMd5ListStr":"50164b09718d76f9745fa3f10729a2b8,50164b09718d76f9745fa3f10729a2b8","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"55.1 KB","destSize":"18 KB","compressRate":"32.7%"},{"code":1,"isDone":false,"source":"https://store.lilydjwg.me/img/blog/wayland-1.25scale/1.25text.png","sourceStatusCode":200,"destWidth":620,"destHeight":512,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn7@2020_4/2022/03/14/11-29-39-551_59141ba19333710f.webp","sourceBytes":47223,"destBytes":21102,"targetWebpQuality":75,"feedId":9917,"totalSpendMs":375,"convertSpendMs":46,"createdTime":"2022-03-14 19:29:39","host":"us-002*","referer":"https://blog.lilydjwg.me/posts/216078","linkMd5ListStr":"50164b09718d76f9745fa3f10729a2b8","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"46.1 KB","destSize":"20.6 KB","compressRate":"44.7%"},{"code":1,"isDone":false,"source":"https://store.lilydjwg.me/img/blog/wayland-1.25scale/compare.png","sourceStatusCode":200,"destWidth":905,"destHeight":470,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn11@2020_2/2022/03/14/11-29-39-680_3c427aba3b67163b.webp","sourceBytes":10920,"destBytes":25528,"targetWebpQuality":75,"feedId":9917,"totalSpendMs":497,"convertSpendMs":18,"createdTime":"2022-03-14 19:29:39","host":"europe65*","referer":"https://blog.lilydjwg.me/posts/216078","linkMd5ListStr":"50164b09718d76f9745fa3f10729a2b8","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"10.7 KB","destSize":"24.9 KB","compressRate":"233.8%"}],"successGithubMap":{"myreaderx16":1,"myreaderx11":1,"myreaderx1":1},"failGithubMap":{}}