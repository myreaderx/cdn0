{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2021-06-06 12:36:41","updatedTime":"2021-06-06 12:36:41","title":"Redis 实战篇：巧用 Bitmap 实现亿级海量数据统计","link":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%C2%A0%E5%AE%9E%E6%88%98%E7%AF%87%EF%BC%9A%E5%B7%A7%E7%94%A8%C2%A0Bitmap%C2%A0%E5%AE%9E%E7%8E%B0%E4%BA%BF%E7%BA%A7%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1","description":"<div><div><div id=\"media\" class=\"rich_media_thumb_wrp\">\n\n            <img class=\"rich_media_thumb\" src=\"http://content.sov5.cn/mmbiz_jpg/eZzl4LXykQy49TgrEhtXz4eMd8tEQeckicg0Q0cq4tHibasSnaSwbJgcjiagWCXgj5qJI5rTn3v4P66KnU3capYnw?imageView2/1/w/600\">\n        </div>\n    \n\n    \n\n    <div class=\"rich_media_content\" id=\"js_content\">\n                    \n\n                    \n                    \n                    \n                    <section data-tool=\"mdnice编辑器\" data-website=\"https://www.mdnice.com\" style=\"color: black;line-height: 1.6;letter-spacing: 0px;word-break: break-word;text-align: left;font-family: PingFangSC-Light;font-size: 16px;padding: 10px;\" data-mpa-powered-by=\"yiban.io\"><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">在移动应用的业务场景中，我们需要保存这样的信息：一个 key 关联了一个数据集合。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">常见的场景如下：</p><ul data-tool=\"mdnice编辑器\" style=\"font-size: 15px;margin-top: 8px;margin-bottom: 8px;padding-left: 20px;color: rgb(255, 191, 82);\" class=\"list-paddingleft-2\"><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\">给一个 userId ，判断用户登陆状态；</section></li><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\">显示用户某个月的签到次数和首次签到时间；</section></li><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\">两亿用户最近 7 天的签到情况，统计 7 天内连续签到的用户总数；</section></li></ul><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">通常情况下，我们面临的用户数量以及访问量都是巨大的，比如百万、千万级别的用户数量，或者千万级别、甚至亿级别的访问信息。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">所以，我们必须要选择能够非常高效地统计大量数据（例如亿级）的集合类型。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\"><strong>如何选择合适的数据集合，我们首先要了解常用的统计模式，并运用合理的数据类型来解决实际问题。</strong></p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">四种统计类型：</p><ol data-tool=\"mdnice编辑器\" style=\"font-size: 15px;margin-top: 8px;margin-bottom: 8px;padding-left: 20px;color: rgb(255, 191, 82);\" class=\"list-paddingleft-2\"><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\">二值状态统计；</section></li><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\">聚合统计；</section></li><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\">排序统计；</section></li><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\">基数统计。</section></li></ol><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">本文将由<strong>二值状态统计类型</strong>作为实战篇系列的开篇，文中将用到 String、Set、Zset、List、hash 以外的拓展数据类型 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">Bitmap</code> 来实现。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">文章涉及到的指令可以通过在线 Redis 客户端运行调试，地址：https://try.redis.io/，超方便的说。</p><h1 data-tool=\"mdnice编辑器\" style=\"font-weight: bold;font-size: 24px;text-align: center;line-height: 95px;margin-top: 10px;margin-bottom: 10px;\"><span style=\"display: none;\"></span><span style=\"font-size: 22px;color: #f48a00;border-bottom: 2px solid #ffbf52;\">二值状态统计</span></h1><blockquote data-tool=\"mdnice编辑器\" style=\"font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;text-size-adjust: 100%;line-height: 1.75em;border-radius: 5px;box-sizing: inherit;border-width: 1px;border-top-style: solid;border-right-style: solid;border-bottom-style: solid;border-color: rgb(255, 191, 82);background: rgb(255, 248, 230);\"><span style=\"color: #f48a00;font-size: 32px;line-height: 0.6;margin-left: -15px;\">❝</span><p style=\"padding-top: 8px;padding-bottom: 8px;letter-spacing: 0.1em;font-size: 16px;word-spacing: 0.1em;text-align: justify;line-height: 26px;margin-top: -15px;color: rgba(0, 0, 0, 0.85);\">码哥，什么是二值状态统计呀？</p></blockquote><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">也就是集合中的元素的值只有 0 和 1 两种，在签到打卡和用户是否登陆的场景中，只需记录<code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">签到(1)</code>或 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">未签到(0)</code>，<code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">已登录(1)</code>或<code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">未登陆(0)</code>。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">假如我们在判断用户是否登陆的场景中使用 Redis 的 String 类型实现（<strong>key -&gt; userId，value -&gt; 0 表示下线，1 - 登陆</strong>），假如存储 100 万个用户的登陆状态，如果以字符串的形式存储，就需要存储 100 万个字符串了，内存开销太大。</p><blockquote data-tool=\"mdnice编辑器\" style=\"font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;text-size-adjust: 100%;line-height: 1.75em;border-radius: 5px;box-sizing: inherit;border-width: 1px;border-top-style: solid;border-right-style: solid;border-bottom-style: solid;border-color: rgb(255, 191, 82);background: rgb(255, 248, 230);\"><span style=\"color: #f48a00;font-size: 32px;line-height: 0.6;margin-left: -15px;\">❝</span><p style=\"padding-top: 8px;padding-bottom: 8px;letter-spacing: 0.1em;font-size: 16px;word-spacing: 0.1em;text-align: justify;line-height: 26px;margin-top: -15px;color: rgba(0, 0, 0, 0.85);\">码哥，为什么 String 类型内存开销大？</p></blockquote><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">String 类型除了记录实际数据以外，还需要额外的内存记录数据长度、空间使用等信息。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">当保存的数据包含字符串，String 类型就使用简单动态字符串（SDS）结构体来保存，如下图所示：</p><figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;\"><img data-ratio=\"1.057591623036649\" data-type=\"png\" data-w=\"764\" style=\"border-radius: 5px; display: block; margin-right: 10px; margin-bottom: auto; margin-left: 10px; width: 290px; height: 307px; object-fit: contain; max-width: 600px\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpARbk5g72S74Lb3d9FVTqZUwEPA14lLx9W2FZ8IEJOnLu3HerVsaHDQ/640?wx_fmt=png\"><figcaption style=\"margin-top: 5px;font-size: 13px;color: rgba(0, 0, 0, 0.55);text-align: right;\">SDS</figcaption></figure><ul data-tool=\"mdnice编辑器\" style=\"font-size: 15px;margin-top: 8px;margin-bottom: 8px;padding-left: 20px;color: rgb(255, 191, 82);\" class=\"list-paddingleft-2\"><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\"><strong style=\"color: rgba(0, 0, 0, 0.85);\">len</strong>：占 4 个字节，表示 buf 的已用长度。</section></li><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\"><strong style=\"color: rgba(0, 0, 0, 0.85);\">alloc</strong>：占 4 个字节，表示 buf 实际分配的长度，通常 &gt; len。</section></li><li><section style=\"margin-top: 5px;margin-bottom: 5px;line-height: 26px;letter-spacing: 0.1em;word-spacing: 0.1em;color: rgba(0, 0, 0, 0.55);\"><strong style=\"color: rgba(0, 0, 0, 0.85);\">buf</strong>：字节数组，保存实际的数据，Redis 自动在数组最后加上一个 “\\0”，额外占用一个字节的开销。</section></li></ul><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">所以，在 SDS 中除了 buf 保存实际的数据， len 与 alloc 就是额外的开销。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">另外，还有一个 <strong>RedisObject 结构的开销</strong>，因为 Redis 的数据类型有很多，而且，不同数据类型都有些相同的元数据要记录（比如最后一次访问的时间、被引用的次数等）。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">所以，Redis 会用一个 RedisObject 结构体来统一记录这些元数据，同时指向实际数据。</p><figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;\"><img data-ratio=\"0.7096774193548387\" data-type=\"png\" data-w=\"403\" style=\"border-radius: 5px; display: block; margin-right: 10px; margin-bottom: auto; margin-left: 10px; width: 389px; height: 276px; object-fit: contain; max-width: 600px\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpWKkLVZLkC7O1we74qB3ZwXDHiblPSoyU2Lg4DSCTRoiahAtppnoPy1ew/640?wx_fmt=png\"></figure><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">对于二值状态场景，我们就可以利用 Bitmap 来实现。比如登陆状态我们用一个 bit 位表示，一亿个用户也只占用 一亿 个 bit 位内存 ≈ （100000000 / 8/ 1024/1024）12 MB。</p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">大概的空间占用计算公式是：(<span style=\"color: #a6e22e;line-height: 26px;\">$offset</span>/8/1024/1024) MB<br></code></pre><blockquote data-tool=\"mdnice编辑器\" style=\"font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;text-size-adjust: 100%;line-height: 1.75em;border-radius: 5px;box-sizing: inherit;border-width: 1px;border-top-style: solid;border-right-style: solid;border-bottom-style: solid;border-color: rgb(255, 191, 82);background: rgb(255, 248, 230);\"><span style=\"color: #f48a00;font-size: 32px;line-height: 0.6;margin-left: -15px;\">❝</span><p style=\"padding-top: 8px;padding-bottom: 8px;letter-spacing: 0.1em;font-size: 16px;word-spacing: 0.1em;text-align: justify;line-height: 26px;margin-top: -15px;color: rgba(0, 0, 0, 0.85);\">什么是 Bitmap 呢？</p></blockquote><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">Bitmap 的底层数据结构用的是 String 类型的 SDS 数据结构来保存位数组，Redis 把每个字节数组的 8 个 bit 位利用起来，每个 bit 位 表示一个元素的二值状态（不是 0 就是 1）。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">可以将 Bitmap 看成是一个 bit 为单位的数组，数组的每个单元只能存储 0 或者 1，数组的下标在 Bitmap 中叫做 offset 偏移量。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">为了直观展示，我们可以理解成 buf 数组的每个字节用一行表示，每一行有 8 个 bit 位，8 个格子分别表示这个字节中的 8 个 bit 位，如下图所示：</p><figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;\"><img data-ratio=\"0.45850451930977815\" data-type=\"png\" data-w=\"1217\" style=\"border-radius: 5px; display: block; margin-right: 10px; margin-bottom: auto; margin-left: 10px; width: 100%; height: 100%; object-fit: contain; max-width: 600px\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpQ7Xxqefic1InjoZWeyibbseXAuI3KQUP30pBUHAcha2DEgib57pS7DZrg/640?wx_fmt=png\"><figcaption style=\"margin-top: 5px;font-size: 13px;color: rgba(0, 0, 0, 0.55);text-align: right;\">Bitmap</figcaption></figure><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\"><strong>8 个 bit 组成一个 Byte，所以 Bitmap 会极大地节省存储空间。</strong> 这就是 Bitmap 的优势。</p><h2 data-tool=\"mdnice编辑器\" style=\"font-weight: bold;font-size: 22px;margin-top: 20px;\"><span style=\"display: none;\"></span><span style=\"font-size: 20px;color: #f48a00;display: inline-block;padding-left: 10px;border-left: 8px solid #ffbf52;\">判断用户登陆态</span></h2><blockquote data-tool=\"mdnice编辑器\" style=\"font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;text-size-adjust: 100%;line-height: 1.75em;border-radius: 5px;box-sizing: inherit;border-width: 1px;border-top-style: solid;border-right-style: solid;border-bottom-style: solid;border-color: rgb(255, 191, 82);background: rgb(255, 248, 230);\"><span style=\"color: #f48a00;font-size: 32px;line-height: 0.6;margin-left: -15px;\">❝</span><p style=\"padding-top: 8px;padding-bottom: 8px;letter-spacing: 0.1em;font-size: 16px;word-spacing: 0.1em;text-align: justify;line-height: 26px;margin-top: -15px;color: rgba(0, 0, 0, 0.85);\">怎么用 Bitmap 来判断海量用户中某个用户是否在线呢？</p></blockquote><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">Bitmap 提供了 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">GETBIT、SETBIT</code> 操作，通过一个偏移值 offset 对 bit 数组的 offset 位置的 bit 位进行读写操作，需要注意的是 offset 从 0 开始。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">只需要一个 key = login_status 表示存储用户登陆状态集合数据， 将用户 ID 作为 offset，在线就设置为 1，下线设置 0。通过 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">GETBIT</code>判断对应的用户是否在线。50000 万 用户只需要 6 MB 的空间。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\"><strong>SETBIT 命令</strong></p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">SETBIT <key> <offset> <value><br></value></offset></key></code></pre><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">设置或者清空 key 的 value 在 offset 处的 bit 值（只能是 0 或者 1）。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\"><strong>GETBIT 命令</strong></p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">GETBIT <key> <offset><br></offset></key></code></pre><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">获取 key 的 value 在 offset 处的 bit 位的值，当 key 不存在时，返回 0。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">假如我们要判断 ID = 10086 的用户的登陆情况：</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">第一步，执行以下指令，表示用户已登录。</p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">SETBIT login_status 10086 1<br></code></pre><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">第二步，检查该用户是否登陆，返回值 1 表示已登录。</p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">GETBIT login_status 10086<br></code></pre><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">第三步，登出，将 offset 对应的 value 设置成 0。</p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">SETBIT login_status 10086 0<br></code></pre><h2 data-tool=\"mdnice编辑器\" style=\"font-weight: bold;font-size: 22px;margin-top: 20px;\"><span style=\"display: none;\"></span><span style=\"font-size: 20px;color: #f48a00;display: inline-block;padding-left: 10px;border-left: 8px solid #ffbf52;\">用户每个月的签到情况</span></h2><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">在签到统计中，每个用户每天的签到用 1 个 bit 位表示，一年的签到只需要 365 个 bit 位。一个月最多只有 31 天，只需要 31 个 bit 位即可。</p><blockquote data-tool=\"mdnice编辑器\" style=\"font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;text-size-adjust: 100%;line-height: 1.75em;border-radius: 5px;box-sizing: inherit;border-width: 1px;border-top-style: solid;border-right-style: solid;border-bottom-style: solid;border-color: rgb(255, 191, 82);background: rgb(255, 248, 230);\"><span style=\"color: #f48a00;font-size: 32px;line-height: 0.6;margin-left: -15px;\">❝</span><p style=\"padding-top: 8px;padding-bottom: 8px;letter-spacing: 0.1em;font-size: 16px;word-spacing: 0.1em;text-align: justify;line-height: 26px;margin-top: -15px;color: rgba(0, 0, 0, 0.85);\">比如统计编号 89757 的用户在 2021 年 5 月份的打卡情况要如何进行？</p></blockquote><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">key 可以设计成 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">uid:sign:{userId}:{yyyyMM}</code>，月份的每一天的值 - 1 可以作为 offset（因为 offset 从 0 开始，所以 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">offset = 日期 - 1</code>）。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">第一步，执行下面指令表示记录用户在 2021 年 5 月 16 号打卡。</p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">SETBIT uid:sign:89757:202105 15 1<br></code></pre><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">第二步，判断编号 89757 用户在 2021 年 5 月 16 号是否打卡。</p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">GETBIT uid:sign:89757:202105 15<br></code></pre><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">第三步，统计该用户在 5 月份的打卡次数，使用 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">BITCOUNT</code> 指令。该指令用于统计给定的 bit 数组中，值 = 1 的 bit 位的数量。</p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">BITCOUNT uid:sign:89757:202105<br></code></pre><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">这样我们就可以实现用户每个月的打卡情况了，是不是很赞。</p><blockquote data-tool=\"mdnice编辑器\" style=\"font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;text-size-adjust: 100%;line-height: 1.75em;border-radius: 5px;box-sizing: inherit;border-width: 1px;border-top-style: solid;border-right-style: solid;border-bottom-style: solid;border-color: rgb(255, 191, 82);background: rgb(255, 248, 230);\"><span style=\"color: #f48a00;font-size: 32px;line-height: 0.6;margin-left: -15px;\">❝</span><p style=\"padding-top: 8px;padding-bottom: 8px;letter-spacing: 0.1em;font-size: 16px;word-spacing: 0.1em;text-align: justify;line-height: 26px;margin-top: -15px;color: rgba(0, 0, 0, 0.85);\">如何统计这个月首次打卡时间呢？</p></blockquote><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">Redis 提供了 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">BITPOS key bitValue [start] [end]</code>指令，返回数据表示 Bitmap 中第一个值为 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">bitValue</code> 的 offset 位置。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">在默认情况下， 命令将检测整个位图， 用户可以通过可选的 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">start</code> 参数和 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">end</code> 参数指定要检测的范围。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">所以我们可以通过执行以下指令来获取 userID = 89757 在 2021 年 5 月份<strong>首次打卡</strong>日期：</p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">BITPOS uid:sign:89757:202105 1<br></code></pre><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">需要注意的是，我们需要将返回的 value + 1 ，因为 offset 从 0 开始。</p><h2 data-tool=\"mdnice编辑器\" style=\"font-weight: bold;font-size: 22px;margin-top: 20px;\"><span style=\"display: none;\"></span><span style=\"font-size: 20px;color: #f48a00;display: inline-block;padding-left: 10px;border-left: 8px solid #ffbf52;\">连续签到用户总数</span></h2><blockquote data-tool=\"mdnice编辑器\" style=\"font-size: 0.9em;overflow: auto;color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;margin-bottom: 20px;margin-top: 20px;text-size-adjust: 100%;line-height: 1.75em;border-radius: 5px;box-sizing: inherit;border-width: 1px;border-top-style: solid;border-right-style: solid;border-bottom-style: solid;border-color: rgb(255, 191, 82);background: rgb(255, 248, 230);\"><span style=\"color: #f48a00;font-size: 32px;line-height: 0.6;margin-left: -15px;\">❝</span><p style=\"padding-top: 8px;padding-bottom: 8px;letter-spacing: 0.1em;font-size: 16px;word-spacing: 0.1em;text-align: justify;line-height: 26px;margin-top: -15px;color: rgba(0, 0, 0, 0.85);\">在记录了一个亿的用户连续 7 天的打卡数据，如何统计出这连续 7 天连续打卡用户总数呢？</p></blockquote><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">我们把每天的日期作为 Bitmap 的 key，userId 作为 offset，若是打卡则将 offset 位置的 bit 设置成 1。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">key 对应的集合的每个 bit 位的数据则是一个用户在该日期的打卡记录。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">一共有 7 个这样的 Bitmap，如果我们能对这 7 个 Bitmap 的对应的 bit 位做 『与』运算。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">同样的 UserID  offset 都是一样的，当一个 userID 在 7 个 Bitmap 对应对应的 offset 位置的 bit = 1 就说明该用户 7 天连续打卡。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">结果保存到一个新 Bitmap 中，我们再通过 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">BITCOUNT</code> 统计 bit = 1 的个数便得到了连续打卡 7 天的用户总数了。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">Redis 提供了 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">BITOP operation destkey key [key ...]</code>这个指令用于对一个或者多个 键 = key 的 Bitmap 进行位元操作。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\"><code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">opration</code> 可以是 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">and</code>、<code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">OR</code>、<code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">NOT</code>、<code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">XOR</code>。当 BITOP 处理不同长度的字符串时，较短的那个字符串所缺少的部分会被看作 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">0</code> 。空的 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">key</code> 也被看作是包含 <code style=\"font-size: 14px;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);font-family: 'Operator Mono', Consolas, Monaco, Menlo, monospace;word-break: break-all;color: rgb(244, 138, 0);\">0</code> 的字符串序列。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">便于理解，如下图所示：</p><figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;display: flex;flex-direction: column;justify-content: center;align-items: center;\"><img data-ratio=\"0.40154015401540155\" data-type=\"png\" data-w=\"909\" style=\"border-radius: 5px; display: block; margin-right: 10px; margin-bottom: auto; margin-left: 10px; width: 100%; height: 100%; object-fit: contain; max-width: 600px\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpUQ9zjGicXx1Zw97aAckMrUCePUDSx9afAv7Q6g6lPjUgFEeq7IBT22g/640?wx_fmt=png\"><figcaption style=\"margin-top: 5px;font-size: 13px;color: rgba(0, 0, 0, 0.55);text-align: right;\">BITOP</figcaption></figure><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">3 个 Bitmap，对应的 bit 位做「与」操作，结果保存到新的 Bitmap 中。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">操作指令表示将 三个 bitmap 进行 AND 操作，并将结果保存到 destmap 中。接着对 destmap 执行 BITCOUNT 统计。</p><pre data-tool=\"mdnice编辑器\" style=\"margin-top: 10px;margin-bottom: 10px;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block;background: url(\" https: no-repeat rgb></span><code style=\"overflow-x: auto;padding: 16px;color: #ddd;display: -webkit-box;font-family: Operator Mono, Consolas, Monaco, Menlo, monospace;font-size: 12px;-webkit-overflow-scrolling: touch;padding-top: 15px;background: #272822;border-radius: 5px;\">// 与操作<br>BITOP AND destmap bitmap:01 bitmap:02 bitmap:03<br>// 统计 bit 位 =  1 的个数<br>BITCOUNT destmap<br></code></pre><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">简单计算下 一个一亿个位的 Bitmap占用的内存开销，大约占 12 MB 的内存（10^8/8/1024/1024），7 天的 Bitmap 的内存开销约为 84 MB。同时我们最好给 Bitmap 设置过期时间，让 Redis 删除过期的打卡数据，节省内存。</p><h2 data-tool=\"mdnice编辑器\" style=\"font-weight: bold;font-size: 22px;margin-top: 20px;\"><span style=\"display: none;\"></span><span style=\"font-size: 20px;color: #f48a00;display: inline-block;padding-left: 10px;border-left: 8px solid #ffbf52;\">小结</span></h2><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">思路才是最重要，当我们遇到的统计场景只需要统计数据的二值状态，比如用户是否存在、 ip 是否是黑名单、以及签到打卡统计等场景就可以考虑使用 Bitmap。</p><p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px;padding-bottom: 8px;margin-top: 5px;margin-bottom: 5px;line-height: 1.75;letter-spacing: 0.1em;word-spacing: 0.1em;text-align: justify;color: rgba(0, 0, 0, 0.85);\">只需要一个 bit 位就能表示 0 和 1。在统计海量数据的时候将大大减少内存占用。</p><p style=\"white-space: normal;caret-color: rgb(0, 0, 0);text-size-adjust: auto;\"><span style=\"font-size: 15px;letter-spacing: 0px;\"></span><span style=\"font-size: 15px;\"></span></p><p style=\"white-space: normal;\"><br></p><p style=\"white-space: normal;text-align: center;\"><span style=\"font-size: 15px;color: rgb(136, 136, 136);\">- EOF -</span></p><section donone=\"shifuMouseDownCard('shifu_c_030')\" label=\"Copyright Reserved by PLAYHUDONG.\" style=\"margin-top: 1em;margin-bottom: 1em;white-space: normal;text-align: start;max-width: 100%;caret-color: rgb(0, 0, 0);color: rgb(0, 0, 0);border-width: 0px;border-style: initial;border-color: initial;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><section style=\"margin-left: 1em;max-width: 100%;line-height: 1.4;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><span style=\"padding: 3px 8px;max-width: 100%;border-radius: 4px;color: rgb(255, 255, 255);background-color: rgb(255, 105, 31);font-family: inherit;text-align: inherit;text-decoration: inherit;font-size: 16px;box-sizing: border-box !important;overflow-wrap: break-word !important;\">推荐阅读</span>  <span style=\"margin-left: 4px;padding: 3px 8px;max-width: 100%;border-radius: 1.2em;color: rgb(255, 255, 255);line-height: 1.2;background-color: rgb(204, 204, 204);font-family: inherit;text-align: inherit;text-decoration: inherit;border-color: rgb(249, 110, 87);font-size: 12px;box-sizing: border-box !important;overflow-wrap: break-word !important;\">点击标题可跳转</span></section><section style=\"margin-top: -11px;padding: 22px 16px 16px;max-width: 100%;border-width: 1px;border-style: solid;border-color: rgb(255, 105, 31);color: rgb(51, 51, 51);font-size: 1em;font-family: inherit;text-align: inherit;text-decoration: inherit;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><p style=\"max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><span style=\"text-decoration: underline;font-size: 13px;\">1、<a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;mid=2651495806&amp;idx=2&amp;sn=177a686da7c00f50edf3e343931f7300&amp;chksm=bd25f1018a5278176c4e658b6e4f236371333ee5a0913a37326233f61b40a342156adf513562&amp;scene=21#wechat_redirect\" data-itemshowtype=\"11\" tab=\"innerlink\" data-linktype=\"2\">美团二面：Redis与MySQL双写一致性如何保证？</a></span></p><p style=\"max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><span style=\"text-decoration: underline;font-size: 13px;\">2、<a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;mid=2651495723&amp;idx=2&amp;sn=de02d11aa6b125611574027303e4e410&amp;chksm=bd25f1548a52784257eaa65988c268d30192b3b9ed30029fee98eeea349604c8c8e32374f603&amp;scene=21#wechat_redirect\" data-itemshowtype=\"0\" tab=\"innerlink\" data-linktype=\"2\">面试官：请你谈谈用Redis实现一个轻量级的搜索引擎！</a></span></p><p style=\"max-width: 100%;min-height: 1em;line-height: 2em;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><span style=\"text-decoration: underline;font-size: 13px;\">3、<a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;mid=2651494186&amp;idx=1&amp;sn=b26ac1e28556114aebb778084c1c3cf6&amp;chksm=bd25fb558a527243afc7835dae511a0621e4d282c8e715b982ec36cb97abe6df9cdc43bb6eb7&amp;scene=21#wechat_redirect\" data-itemshowtype=\"11\" tab=\"innerlink\" data-linktype=\"2\">颠覆认知——Redis会遇到的15个「坑」，你踩过几个？</a></span></p></section></section><p style=\"white-space: normal;caret-color: rgb(0, 0, 0);color: rgb(0, 0, 0);text-align: start;max-width: 100%;min-height: 1em;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><br></p><p style=\"white-space: normal;max-width: 100%;min-height: 1em;font-family: -apple-system-font, system-ui, \" helvetica neue sc sans gb yahei ui arial sans-serif rgb center border-box break-word><span style=\"font-size: 15px;\"><span style=\"max-width: 100%;color: rgb(255, 169, 0);box-sizing: border-box !important;overflow-wrap: break-word !important;\"></span></span></p><p style=\"white-space: normal;text-align: center;\"><span style=\"max-width: 100%;font-size: 14px;color: rgb(255, 169, 0);box-sizing: border-box !important;overflow-wrap: break-word !important;\">看完本文有收获？请转发分享给更多人</span><br></p><p style=\"white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><strong style=\"max-width: 100%;color: rgb(255, 169, 0);box-sizing: border-box !important;overflow-wrap: break-word !important;\">关注「ImportNew」，提升Java技能</strong></p><p style=\"white-space: normal;max-width: 100%;min-height: 1em;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;\"><img data-ratio=\"0.9166666666666666\" data-s=\"300,640\" data-type=\"jpeg\" data-w=\"600\" width=\"auto\" style=\"box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 600px !important; max-width: 600px\" src=\"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/2A8tXicCG8ylbWIGfdoDED35IRRySQZTXUkJ1eop9MHApzFibKnOo0diboXpl0rmS5mH78YJhsWQv0dhv718A6kUA/640?wx_fmt=jpeg\"></p><p style=\"white-space: normal;text-align: right;\"><span style=\"font-size: 14px;\"></span><span style=\"max-width: 100%;font-family: -apple-system-font, system-ui, \" helvetica neue sc sans gb yahei ui arial sans-serif center break-word border-box>点赞和在看就是最大的支持</span><span style=\"max-width: 100%;font-family: -apple-system-font, system-ui, \" helvetica neue sc sans gb yahei ui arial sans-serif center break-word border-box>❤️</span></p></section>\n                </div>\n\n    \n    <br>\n\n    \n        <a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;mid=2651495821&amp;idx=2&amp;sn=1e20581fdce1e5656c24d3a7e53d34fa&amp;chksm=bd25f1f28a5278e4e6f6196e70481aa763b7867372c6c693fb8ff6968dfc49df8673f42b34bc&amp;scene=0#rd\" style=\"color: blue\" class=\"media_tool_meta meta_primary\">原文</a>\n        <br>\n    \n\n    \n\n    <img alt=\"\" width=\"1px\" height=\"1px\" class=\"\" style=\"width:1px;height:1px;display:none\" src=\"http://www.jintiankansha.me/rss_static/54540/E4l24lGRjy\"></div></div>","descriptionType":"html","publishedDate":"Fri, 04 Jun 2021 03:30:00 +0000","feedId":2521,"bgimg":"http://content.sov5.cn/mmbiz_jpg/eZzl4LXykQy49TgrEhtXz4eMd8tEQeckicg0Q0cq4tHibasSnaSwbJgcjiagWCXgj5qJI5rTn3v4P66KnU3capYnw?imageView2/1/w/600","linkMd5":"a0b5d93257d592a2771fb18af4e34f29","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn2@2020_6/2021/06/06/04-36-45-050_52d899077a459984.webp","destWidth":600,"destHeight":276,"sourceBytes":14399,"destBytes":11948,"author":"","articleImgCdnMap":{"http://content.sov5.cn/mmbiz_jpg/eZzl4LXykQy49TgrEhtXz4eMd8tEQeckicg0Q0cq4tHibasSnaSwbJgcjiagWCXgj5qJI5rTn3v4P66KnU3capYnw?imageView2/1/w/600":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn2@2020_6/2021/06/06/04-36-45-050_52d899077a459984.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpARbk5g72S74Lb3d9FVTqZUwEPA14lLx9W2FZ8IEJOnLu3HerVsaHDQ/640?wx_fmt=png":null,"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpWKkLVZLkC7O1we74qB3ZwXDHiblPSoyU2Lg4DSCTRoiahAtppnoPy1ew/640?wx_fmt=png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn5@2020_6/2021/06/06/04-36-59-967_a0657cea131c615b.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpQ7Xxqefic1InjoZWeyibbseXAuI3KQUP30pBUHAcha2DEgib57pS7DZrg/640?wx_fmt=png":null,"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpUQ9zjGicXx1Zw97aAckMrUCePUDSx9afAv7Q6g6lPjUgFEeq7IBT22g/640?wx_fmt=png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn21@2020_5/2021/06/06/04-37-10-647_1d296c13187843e8.webp","http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/2A8tXicCG8ylbWIGfdoDED35IRRySQZTXUkJ1eop9MHApzFibKnOo0diboXpl0rmS5mH78YJhsWQv0dhv718A6kUA/640?wx_fmt=jpeg":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn14@2020_4/2021/06/06/04-36-53-129_f93d0239d4369c75.webp","http://www.jintiankansha.me/rss_static/54540/E4l24lGRjy":null},"publishedOrCreatedDate":1622954201459}],"record":{"createdTime":"2021-06-06 12:36:41","updatedTime":"2021-06-06 12:36:41","feedId":2521,"fetchDate":"Sun, 06 Jun 2021 04:36:41 +0000","fetchMs":395,"handleMs":18,"totalMs":127335,"newArticles":0,"totalArticles":5,"status":1,"type":0,"ip":"af6ca12eefe249e94a3f077d15d7c168","hostName":"europe69*","requestId":"84b1a37bd06846d4aff3b09d72089499_2521","contentType":"application/rss+xml","totalBytes":77848,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":7,"articlesImgsGithubTotal":4,"successGithubMap":{"myreaderx10":1,"myreaderx2":1,"myreaderx13":1,"myreaderx29":1},"failGithubMap":{}},"feed":{"createdTime":"2020-08-24 21:31:41","updatedTime":"2020-09-01 10:09:47","id":2521,"name":"ImportNew","url":"http://feedmaker.kindle4rss.com/feeds/importnew.weixin.xml","subscriber":null,"website":null,"icon":"http://www.sogou.com/images/logo/new/favicon.ico?v=4","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx63/cdn9@2020_3/2020/09/01/02-08-31-388_d24121c9beed1de6.ico","description":"伯乐在线旗下账号，专注Java技术分享，包括Java基础技术、进阶技能、架构设计和Java技术领域动态等。","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2021-06-06 12:38:48","updatedTime":"2021-06-06 12:38:48","id":null,"feedId":2521,"linkMd5":"a0b5d93257d592a2771fb18af4e34f29"}],"tmpCommonImgCdnBytes":11948,"tmpBodyImgCdnBytes":65900,"tmpBgImgCdnBytes":0,"extra4":{"start":1622954200725,"total":0,"statList":[{"spend":716,"msg":"获取xml内容"},{"spend":18,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":122739,"msg":"正文链接上传到cdn"}]},"extra5":7,"extra6":5,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"http://www.jintiankansha.me/rss_static/54540/E4l24lGRjy","sourceStatusCode":405,"sourceBytes":0,"destBytes":0,"feedId":2521,"totalSpendMs":953,"convertSpendMs":0,"createdTime":"2021-06-06 12:36:45","host":"us-53*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%C2%A0%E5%AE%9E%E6%88%98%E7%AF%87%EF%BC%9A%E5%B7%A7%E7%94%A8%C2%A0Bitmap%C2%A0%E5%AE%9E%E7%8E%B0%E4%BA%BF%E7%BA%A7%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1","linkMd5ListStr":"a0b5d93257d592a2771fb18af4e34f29","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[405],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://www.jintiankansha.me/rss_static/54540/E4l24lGRjy","sourceStatusCode":405,"sourceBytes":0,"destBytes":0,"feedId":2521,"totalSpendMs":1746,"convertSpendMs":0,"createdTime":"2021-06-06 12:36:46","host":"us-017*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%C2%A0%E5%AE%9E%E6%88%98%E7%AF%87%EF%BC%9A%E5%B7%A7%E7%94%A8%C2%A0Bitmap%C2%A0%E5%AE%9E%E7%8E%B0%E4%BA%BF%E7%BA%A7%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1","linkMd5ListStr":"a0b5d93257d592a2771fb18af4e34f29","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[405],"sourceSize":"0","destSize":"0"},null,null,null,null],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-018.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]},"http://us-53.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[405]},"http://us-017.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[405]},"http://europe65.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-019.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-003.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-015.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"http://content.sov5.cn/mmbiz_jpg/eZzl4LXykQy49TgrEhtXz4eMd8tEQeckicg0Q0cq4tHibasSnaSwbJgcjiagWCXgj5qJI5rTn3v4P66KnU3capYnw?imageView2/1/w/600","sourceStatusCode":200,"destWidth":600,"destHeight":276,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn2@2020_6/2021/06/06/04-36-45-050_52d899077a459984.webp","sourceBytes":14399,"destBytes":11948,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":3688,"convertSpendMs":6,"createdTime":"2021-06-06 12:36:41","host":"us-027*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%C2%A0%E5%AE%9E%E6%88%98%E7%AF%87%EF%BC%9A%E5%B7%A7%E7%94%A8%C2%A0Bitmap%C2%A0%E5%AE%9E%E7%8E%B0%E4%BA%BF%E7%BA%A7%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1","linkMd5ListStr":"a0b5d93257d592a2771fb18af4e34f29,a0b5d93257d592a2771fb18af4e34f29","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"14.1 KB","destSize":"11.7 KB","compressRate":"83%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/2A8tXicCG8ylbWIGfdoDED35IRRySQZTXUkJ1eop9MHApzFibKnOo0diboXpl0rmS5mH78YJhsWQv0dhv718A6kUA/640?wx_fmt=jpeg","sourceStatusCode":200,"destWidth":600,"destHeight":550,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn14@2020_4/2021/06/06/04-36-53-129_f93d0239d4369c75.webp","sourceBytes":37143,"destBytes":31608,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":8214,"convertSpendMs":12,"createdTime":"2021-06-06 12:36:45","host":"europe65*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%C2%A0%E5%AE%9E%E6%88%98%E7%AF%87%EF%BC%9A%E5%B7%A7%E7%94%A8%C2%A0Bitmap%C2%A0%E5%AE%9E%E7%8E%B0%E4%BA%BF%E7%BA%A7%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1","linkMd5ListStr":"a0b5d93257d592a2771fb18af4e34f29","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"36.3 KB","destSize":"30.9 KB","compressRate":"85.1%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpWKkLVZLkC7O1we74qB3ZwXDHiblPSoyU2Lg4DSCTRoiahAtppnoPy1ew/640?wx_fmt=png","sourceStatusCode":200,"destWidth":403,"destHeight":286,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn5@2020_6/2021/06/06/04-36-59-967_a0657cea131c615b.webp","sourceBytes":62635,"destBytes":11560,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":12772,"convertSpendMs":7,"createdTime":"2021-06-06 12:36:47","host":"us-015*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%C2%A0%E5%AE%9E%E6%88%98%E7%AF%87%EF%BC%9A%E5%B7%A7%E7%94%A8%C2%A0Bitmap%C2%A0%E5%AE%9E%E7%8E%B0%E4%BA%BF%E7%BA%A7%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1","linkMd5ListStr":"a0b5d93257d592a2771fb18af4e34f29","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"61.2 KB","destSize":"11.3 KB","compressRate":"18.5%"},{"code":1,"isDone":false,"source":"http://img2.jintiankansha.me/get?src=http://mmbiz.qpic.cn/mmbiz_png/FbXJ7UCc6O3Gvkib1TDTc5TaYWHqO1gcpUQ9zjGicXx1Zw97aAckMrUCePUDSx9afAv7Q6g6lPjUgFEeq7IBT22g/640?wx_fmt=png","sourceStatusCode":200,"destWidth":909,"destHeight":365,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn21@2020_5/2021/06/06/04-37-10-647_1d296c13187843e8.webp","sourceBytes":78678,"destBytes":22732,"targetWebpQuality":75,"feedId":2521,"totalSpendMs":25434,"convertSpendMs":14,"createdTime":"2021-06-06 12:36:45","host":"us-018*","referer":"http://weixin.sogou.com/weixin?type=2&query=ImportNew+Redis%C2%A0%E5%AE%9E%E6%88%98%E7%AF%87%EF%BC%9A%E5%B7%A7%E7%94%A8%C2%A0Bitmap%C2%A0%E5%AE%9E%E7%8E%B0%E4%BA%BF%E7%BA%A7%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1","linkMd5ListStr":"a0b5d93257d592a2771fb18af4e34f29","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"76.8 KB","destSize":"22.2 KB","compressRate":"28.9%"}],"successGithubMap":{"myreaderx10":1,"myreaderx2":1,"myreaderx13":1,"myreaderx29":1},"failGithubMap":{}}