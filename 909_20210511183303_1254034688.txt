{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2021-05-12 02:32:26","updatedTime":"2021-05-12 02:32:26","title":"用 OpenSSL 替代 Telnet","link":"https://linux.cn/article-13381-1.html?utm_source=rss&utm_medium=rss","description":"<blockquote>\n<p>Telnet 缺乏加密，这使得 OpenSSL 成为连接远程系统的更安全的选择。</p>\n</blockquote>\n<p><img title=\"Lock\" src=\"https://img.linux.net.cn/data/attachment/album/202105/11/115934cggzmq8rm8suaqlq.png\" width=\"1920\" height=\"1080\" /></p>\n<p><a href=\"https://www.redhat.com/sysadmin/telnet-netcat-troubleshooting\">telnet</a>&#160;命令是最受欢迎的网络故障排除工具之一，从系统管理员到网络爱好者都可以使用。在网络计算的早期，<code>telnet</code>&#160;被用来连接到一个远程系统。你可以用&#160;<code>telnet</code>&#160;访问一个远程系统的端口，登录并在该主机上运行命令。</p>\n<p>由于&#160;<code>telnet</code>&#160;缺乏加密功能，它在很大程度上已经被 OpenSSL 取代了这项工作。然而，作为一种智能的&#160;<code>ping</code>，<code>telnet</code>&#160;的作用仍然存在（甚至在某些情况下至今仍然存在）。虽然&#160;<code>ping</code>&#160;命令是一个探测主机响应的好方法，但这是它能做的&#160;<em>全部</em>。另一方面，<code>telnet</code>&#160;不仅可以确认一个活动端口，而且还可以与该端口的服务进行交互。即便如此，由于大多数现代网络服务都是加密的，<code>telnet</code>&#160;的作用可能要小得多，这取决于你想实现什么。</p>\n<h3 id=\"openssl-s_client\" class=\"mume-header\">OpenSSL s_client</h3>\n<p>对于大多数曾经需要&#160;<code>telnet</code>&#160;的任务，我现在使用 OpenSSL 的&#160;<code>s_client</code>&#160;命令。（我在一些任务中使用&#160;<a href=\"https://opensource.com/downloads/curl-command-cheat-sheet\">curl</a>，但那些情况下我可能无论如何也不会使用&#160;<code>telnet</code>）。大多数人都知道&#160;<a href=\"https://www.openssl.org/\">OpenSSL</a>&#160;是一个加密的库和框架，但不是所有人都意识到它也是一个命令。<code>openssl</code>&#160;命令的&#160;<code>s_client</code>&#160;组件实现了一个通用的 SSL 或 TLS 客户端，帮助你使用 SSL 或 TLS 连接到远程主机。它是用来测试的，至少在内部使用与该库相同的功能。</p>\n<h3 id=\"%E5%AE%89%E8%A3%85-openssl\" class=\"mume-header\">安装 OpenSSL</h3>\n<p>OpenSSL 可能已经安装在你的 Linux 系统上了。如果没有，你可以用你的发行版的软件包管理器安装它：</p>\n<pre class=\"prettyprint linenums\"><code>$ sudo dnf install openssl\n</code></pre>\n<p>在 Debian 或类似的系统上：</p>\n<pre class=\"prettyprint linenums\"><code>$ sudo apt install openssl\n</code></pre>\n<p>安装后，验证它的响应是否符合预期：</p>\n<pre class=\"prettyprint linenums\"><code>$ openssl version\nOpenSSL x.y.z FIPS\n</code></pre>\n<h3 id=\"%E9%AA%8C%E8%AF%81%E7%AB%AF%E5%8F%A3%E8%AE%BF%E9%97%AE\" class=\"mume-header\">验证端口访问</h3>\n<p>最基本的&#160;<code>telnet</code>&#160;用法是一个看起来像这样的任务：</p>\n<pre class=\"prettyprint linenums\"><code>$ telnet mail.example.com 25\nTrying 98.76.54.32...\nConnected to example.com.\nEscape character is '^]'.\n</code></pre>\n<p>在此示例中，这将与正在端口 25（可能是邮件服务器）监听的任意服务打开一个交互式会话。只要你获得访问权限，就可以与该服务进行通信。</p>\n<p>如果端口 25 无法访问，连接就会被拒绝。</p>\n<p>OpenSSL 也是类似的，尽管通常较少互动。要验证对一个端口的访问：</p>\n<pre class=\"prettyprint linenums\"><code>$ openssl s_client -connect example.com:80\nCONNECTED(00000003)\n140306897352512:error:1408F10B:SSL [...]\n\nno peer certificate available\n\nNo client certificate CA names sent\n\nSSL handshake has read 5 bytes and written 309 bytes\nVerification: OK\n\nNew, (NONE), Cipher is (NONE)\nSecure Renegotiation IS NOT supported\nCompression: NONE\nExpansion: NONE\nNo ALPN negotiated\nEarly data was not sent\nVerify return code: 0 (ok)\n</code></pre>\n<p>但是，这仅是目标性&#160;<code>ping</code>。从输出中可以看出，没有交换 SSL 证书，所以连接立即终止。为了充分利用&#160;<code>openssl s_client</code>，你必须连接加密的端口。</p>\n<h3 id=\"%E4%BA%A4%E4%BA%92%E5%BC%8F-openssl\" class=\"mume-header\">交互式 OpenSSL</h3>\n<p>Web 浏览器和 Web 服务器进行交互，可以使指向 80 端口的流量实际上被转发到 443，这是保留给加密 HTTP 流量的端口。知道了这一点，你就可以用&#160;<code>openssl</code>&#160;命令连接到加密的端口，并与在其上运行的任何网络服务进行交互。</p>\n<p>首先，使用 SSL 连接到一个端口。使用&#160;<code>-showcerts</code>&#160;选项会使 SSL 证书打印到你的终端上，一开始的输出要比 telnet 要冗长得多：</p>\n<pre class=\"prettyprint linenums\"><code>$ openssl s_client -connect example.com:443 -showcerts\n[...]\n&#160; &#160; 0080 - 52 cd bd 95 3d 8a 1e 2d-3f 84 a0 e3 7a c0 8d 87 &#160; R...=..-?...z...\n&#160; &#160; 0090 - 62 d0 ae d5 95 8d 82 11-01 bc 97 97 cd 8a 30 c1 &#160; b.............0.\n&#160; &#160; 00a0 - 54 78 5c ad 62 5b 77 b9-a6 35 97 67 65 f5 9b 22 &#160; Tx\\\\.b[w..5.ge..\"\n&#160; &#160; 00b0 - 18 8a 6a 94 a4 d9 7e 2f-f5 33 e8 8a b7 82 bd 94 &#160; ..j...~/.3......\n\n&#160; &#160; Start Time: 1619661100\n&#160; &#160; Timeout &#160; : 7200 (sec)\n&#160; &#160; Verify return code: 0 (ok)\n&#160; &#160; Extended master secret: no\n&#160; &#160; Max Early Data: 0\n-\nread R BLOCK\n</code></pre>\n<p>你被留在一个交互式会话中。最终，这个会话将关闭，但如果你及时行动，你可以向服务器发送 HTTP 信号：</p>\n<pre class=\"prettyprint linenums\"><code>[...]\nGET / HTTP/1.1\nHOST: example.com\n</code></pre>\n<p>按<strong>回车键</strong>两次，你会收到&#160;<code>example.com/index.html</code>&#160;的数据：</p>\n<pre class=\"prettyprint linenums\"><code>[...]\n&#60;body&#62;\n&#60;div&#62;\n    &#60;h1&#62;Example Domain&#60;/h1&#62;\n    &#60;p&#62;This domain is for use in illustrative examples in documents. You may use this\n    domain in literature without prior coordination or asking for permission.&#60;/p&#62;\n    &#60;p&#62;&#60;a href=\"https://www.iana.org/domains/example\"&#62;More information...&#60;/a&#62;&#60;/p&#62;\n&#60;/div&#62;\n&#60;/body&#62;\n&#60;/html&#62;\n</code></pre>\n<h4 id=\"email-%E6%9C%8D%E5%8A%A1%E5%99%A8\" class=\"mume-header\">Email 服务器</h4>\n<p>你也可以使用 OpenSSL 的&#160;<code>s_client</code>&#160;来测试一个加密的 Email 服务器。要做到这点，你必须把你的测试用户的用户名和密码用 Base64 编码。</p>\n<p>这里有一个简单的方法来做到：</p>\n<pre class=\"prettyprint linenums\"><code>$ perl -MMIME::Base64 -e 'print encode_base64(\"username\");'\n$ perl -MMIME::Base64 -e 'print encode_base64(\"password\");'\n</code></pre>\n<p>当你记录了这些值，你就可以通过 SSL 连接到邮件服务器，它通常在 587 端口：</p>\n<pre class=\"prettyprint linenums\"><code>$ openssl s_client -starttls smtp \\\n-connect email.example.com:587\n&#62; ehlo example.com\n&#62; auth login\n##paste your user base64 string here##\n##paste your password base64 string here##\n\n&#62; mail from: noreply@example.com\n&#62; rcpt to: admin@example.com\n&#62; data\n&#62; Subject: Test 001\nThis is a test email.\n.\n&#62; quit\n</code></pre>\n<p>检查你的邮件（在这个示例代码中，是&#160;<code>admin@example.com</code>），查看来自&#160;<code>noreply@example.com</code>&#160;的测试邮件。</p>\n<h3 id=\"openssl-%E8%BF%98%E6%98%AF-telnet\" class=\"mume-header\">OpenSSL 还是 Telnet？</h3>\n<p><code>telnet</code>&#160;仍然有用途，但它已经不是以前那种不可缺少的工具了。该命令在许多发行版上被归入 &#8220;遗留&#8221; 网络软件包，而且还没有&#160;<code>telnet-ng</code>&#160;之类的明显的继任者，管理员有时会对它被排除在默认安装之外感到疑惑。答案是，它不再是必不可少的，它的作用越来越小，这&#160;<em>很好</em>。网络安全很重要，所以要适应与加密接口互动的工具，这样你就不必在排除故障时禁用你的保护措施。</p>\n<hr />\n<p>via:&#160;<a href=\"https://opensource.com/article/21/5/drop-telnet-openssl\">https://opensource.com/article/21/5/drop-telnet-openssl</a></p>\n<p>作者：<a href=\"https://opensource.com/users/seth\">Seth Kenlon</a>&#160;选题：<a href=\"https://github.com/lujun9972\">lujun9972</a>&#160;译者：<a href=\"https://github.com/geekpi\">geekpi</a>&#160;校对：<a href=\"https://github.com/wxy\">wxy</a></p>\n<p>本文由&#160;<a href=\"https://github.com/LCTT/TranslateProject\">LCTT</a>&#160;原创编译，<a href=\"https://linux.cn/\">Linux中国</a>&#160;荣誉推出</p>","descriptionType":"text/html","publishedDate":"Tue, 11 May 2021 04:00:22 +0000","feedId":909,"bgimg":"https://img.linux.net.cn/data/attachment/album/202105/11/115934cggzmq8rm8suaqlq.png","linkMd5":"281469eab745b31a44f752a30e229ce1","destWidth":1920,"destHeight":1080,"sourceBytes":29964,"destBytes":33046,"author":"linux@linux.cn (linux)","articleImgCdnMap":{"https://img.linux.net.cn/data/attachment/album/202105/11/115934cggzmq8rm8suaqlq.png":null},"publishedOrCreatedDate":1620757946991}],"record":{"createdTime":"2021-05-12 02:32:26","updatedTime":"2021-05-12 02:32:26","feedId":909,"fetchDate":"Tue, 11 May 2021 18:32:26 +0000","fetchMs":1359,"handleMs":16,"totalMs":38504,"newArticles":0,"totalArticles":9,"status":1,"type":0,"ip":"79b59b7ab14b8d981e3d8a220e20848a","hostName":"us-026*","requestId":"27ef4afb953346e5a455247ede1bef1e_909","contentType":"application/xml","totalBytes":0,"bgimgsTotal":1,"bgimgsGithubTotal":0,"articlesImgsTotal":1,"articlesImgsGithubTotal":0,"successGithubMap":{},"failGithubMap":{"myreaderx23":1}},"feed":{"createdTime":"2020-08-16 17:44:30","updatedTime":"2020-09-01 09:39:05","id":909,"name":"Linux 中国◆开源社区","url":"https://linux.cn/rss.xml","subscriber":null,"website":null,"icon":"https://img.linux.net.cn/static/image/common/linuxcn_logo_64.gif","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx62/cdn29@2020_6/2020/09/01/01-39-05-377_65d5a34039131f77.gif","description":"Linux 中国◆开源社区","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2021-05-12 02:33:03","updatedTime":"2021-05-12 02:33:03","id":null,"feedId":909,"linkMd5":"281469eab745b31a44f752a30e229ce1"}],"tmpCommonImgCdnBytes":0,"tmpBodyImgCdnBytes":0,"tmpBgImgCdnBytes":0,"extra4":{"start":1620757945402,"total":0,"statList":[{"spend":1572,"msg":"获取xml内容"},{"spend":17,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":0,"msg":"正文链接上传到cdn"}]},"extra5":1,"extra6":1,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"https://img.linux.net.cn/data/attachment/album/202105/11/115934cggzmq8rm8suaqlq.png","sourceStatusCode":200,"destWidth":1920,"destHeight":1080,"sourceBytes":29964,"destBytes":33046,"targetWebpQuality":75,"feedId":909,"totalSpendMs":2362,"convertSpendMs":38,"createdTime":"2021-05-12 02:32:27","host":"europe-59*","referer":"https://linux.cn/article-13381-1.html?utm_source=rss&utm_medium=rss","linkMd5ListStr":"281469eab745b31a44f752a30e229ce1,281469eab745b31a44f752a30e229ce1","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx23/cdn59/contents/2021/05/11/18-32-29-292_ce10b384b6a74a2a.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69189253.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Tue, 11 May 2021 18:32:29 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["B04A:DC99:8D9F743:9078C93:609ACDBD"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1620761355"],"x-ratelimit-resource":["core"],"x-ratelimit-used":["61"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx23/cdn59/contents/2021/05/11/18-32-29-292_ce10b384b6a74a2a.webp","historyStatusCode":[],"spendMs":170},"base64UserPassword":null,"token":"df0b9******************************93a6e"},"githubUser":"myreaderx23","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"29.3 KB","destSize":"32.3 KB","compressRate":"110.3%"},{"code":1,"isDone":false,"source":"https://img.linux.net.cn/data/attachment/album/202105/11/115934cggzmq8rm8suaqlq.png","sourceStatusCode":200,"destWidth":1920,"destHeight":1080,"sourceBytes":29964,"destBytes":33046,"targetWebpQuality":75,"feedId":909,"totalSpendMs":4189,"convertSpendMs":39,"createdTime":"2021-05-12 02:32:59","host":"europe-59*","referer":"https://linux.cn/article-13381-1.html?utm_source=rss&utm_medium=rss","linkMd5ListStr":"281469eab745b31a44f752a30e229ce1,281469eab745b31a44f752a30e229ce1","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx23/cdn59/contents/2021/05/11/18-33-03-486_ce10b384b6a74a2a.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69189253.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Tue, 11 May 2021 18:33:03 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["B9E8:A027:29D5268:2BE372B:609ACDDF"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1620761355"],"x-ratelimit-resource":["core"],"x-ratelimit-used":["61"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx23/cdn59/contents/2021/05/11/18-33-03-486_ce10b384b6a74a2a.webp","historyStatusCode":[],"spendMs":383},"base64UserPassword":null,"token":"df0b9******************************93a6e"},"githubUser":"myreaderx23","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"29.3 KB","destSize":"32.3 KB","compressRate":"110.3%"}],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{},"extra12ImgCdnSuccessResultVector":[],"successGithubMap":{},"failGithubMap":{"myreaderx23":1}}