{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-11-16 17:20:28","updatedTime":"2020-11-16 17:20:28","title":"The Future of Visual Studio Extensions","link":"https://devblogs.microsoft.com/visualstudio/?p=230937","description":"<p>With <a href=\"https://devblogs.microsoft.com/visualstudio/visual-studio-2019-v16-8-preview-3-1/\">new improvements and additions</a> such as GitHub Codespaces, Git Integrations, and IntelliCode Team Completions, Visual Studio has expanded to make development easier, more customizable, and accessible from any machine.  As we continue evolving Visual Studio, what about extensions?!  While still early in the design phase, we are creating a new extensibility model. This will make extensions more reliable, easier to write, and supported locally and in the cloud.</p>\n<p>&#160;</p>\n<h3 id=\"crash-less-code-more\"><strong>Crash Less, Code More!</strong></h3>\n<p>Tired of seeing a feature or Visual Studio crash because of an extension?  Today&#8217;s in-proc extensions have minimal restrictions over how they can influence the IDE and other extensions. Thus, they are free to corrupt Visual Studio if the extension experiences an error or crash.  One of our biggest changes to the Visual Studio extension model is that we are making extensions out-of-proc. This will help ensure increased isolation between internal and external extension APIs, where a buggy extension can crash without causing other extensions or the entire IDE to crash, hang, or slow down along with it.</p>\n<p>&#160;</p>\n<h3 id=\"easy-to-write\"><strong>Easy to Write</strong></h3>\n<p>Extensions are cool to use but can be difficult to write.  Inconsistent APIs, overwhelming architecture, and having to ask your teammates how to implement what should be a basic command are common feedback items from extension writers.  Discovering all these APIs can be challenging and once you do find them, it can be hard to know where or when to use them.  Luckily, designing the new out-of-proc extension model gives us the opportunity to completely redesign the Visual Studio extension APIs.  So, our goal is making writing extensions easier with more uniform, discoverable APIs and continually updated documentation.  Most importantly, the new model will preserve the power and extensive UI customizability options that today&#8217;s model provides.</p>\n<p>&#160;</p>\n<p>Figure 1 shows the code required to initialize a command for Mads Kristensen’s Image Optimizer extension.  Figure 2 shows an example of what initializing the same command could look like using the new model.  Here, lines 31 and 32 in Figure 2 condenses and represents Figure 1&#8217;s AddCommand method calls. Figure 1&#8217;s DesignTimeEnvironment code (DTE) representing the IDE and its controlling methods is passed in via the VisualStudioExtensibility class in Figure 2.  Ideally, this simplifies the code and knowledge required to properly initialize the class.</p>\n<p><figure id=\"attachment_230942\" aria-describedby=\"caption-attachment-230942\" style=\"width: 1647px\" class=\"wp-caption alignnone\"><a href=\"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1.png\"><img class=\"wp-image-230942 size-full\" src=\"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1.png\" alt=\"Figure 1: Initialization code for Image Optimization extension using existing extension model\" width=\"1647\" height=\"502\" srcset=\"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1.png 1647w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1-300x91.png 300w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1-1024x312.png 1024w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1-768x234.png 768w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1-1536x468.png 1536w\" sizes=\"(max-width: 1647px) 100vw, 1647px\" /></a><figcaption id=\"caption-attachment-230942\" class=\"wp-caption-text\">Figure 1: Initialization code for Image Optimization command using existing extension model</figcaption></figure></p>\n<p>&#160;</p>\n<p><figure id=\"attachment_230957\" aria-describedby=\"caption-attachment-230957\" style=\"width: 802px\" class=\"wp-caption alignnone\"><a href=\"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Gladstone-2.png\"><img class=\"wp-image-230957 size-full\" src=\"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Gladstone-2.png\" alt=\"&#34;&#60;yoastmark\" width=\"802\" height=\"238\" srcset=\"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Gladstone-2.png 802w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Gladstone-2-300x89.png 300w, https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Gladstone-2-768x228.png 768w\" sizes=\"(max-width: 802px) 100vw, 802px\" /></a><figcaption id=\"caption-attachment-230957\" class=\"wp-caption-text\">Figure 2: Example of possible Image Optimizer command initialization using new extension model</figcaption></figure></p>\n<p>&#160;</p>\n<h3 id=\"extensions-in-the-cloud\"><strong>Extensions in the Cloud</strong></h3>\n<p>Part of GitHub Codespaces&#8217; appeal is the ability to have a customized dev environment accessible via the cloud across machines.  For many developers, a customized environment is incomplete without extensions.  The current model&#8217;s unrestricted access to the IDE and lack of asynchronous APIs don&#8217;t make it ideal for a seamless, crash-less, and responsive client/server experience for Codespaces. To round out our new extensibility model goals, we will make your essential extensions available both locally and remotely.</p>\n<p><figure id=\"attachment_230939\" aria-describedby=\"caption-attachment-230939\" style=\"width: 1920px\" class=\"wp-caption alignnone\"><a href=\"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/GladstoneImgOpt_Example.gif\"><img class=\"size-full wp-image-230939\" src=\"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/GladstoneImgOpt_Example.gif\" alt=\"Figure 3: Image Optimizer extension running in a GitHub Codespace\" width=\"1920\" height=\"1032\" /></a><figcaption id=\"caption-attachment-230939\" class=\"wp-caption-text\">Figure 3: Image Optimizer extension running in a GitHub Codespace</figcaption></figure></p>\n<p>&#160;</p>\n<h3 id=\"the-future\"><strong>The Future</strong></h3>\n<p>The road to completing the new extension model is a long one and today&#8217;s model will not be replaced overnight.  We are still in the conceptual phases of this new model, so sharing your experiences as either an extension user or an extension writer is very important.  To help us improve the extension experience, please share in the comments what extensions you can&#8217;t live without or complete <a href=\"https://www.research.net/r/C986F2V\">this survey</a>.</p>\n<p>&#160;</p>\n<p>Stay tuned for future extension developments!</p>\n<p>The post <a rel=\"nofollow\" href=\"https://devblogs.microsoft.com/visualstudio/the-future-of-visual-studio-extensions/\">The Future of Visual Studio Extensions</a> appeared first on <a rel=\"nofollow\" href=\"https://devblogs.microsoft.com/visualstudio\">Visual Studio Blog</a>.</p>\n","descriptionType":"html","publishedDate":"Wed, 28 Oct 2020 17:00:51 +0000","feedId":11388,"bgimg":"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1.png","linkMd5":"616959630bac888a0fbcf793ce194b39","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn47@2020_2/2020/11/16/09-20-28-686_9b46b2b51334437a.webp","destWidth":1647,"destHeight":502,"sourceBytes":43296,"destBytes":47314,"author":"Leslie Richardson","articleImgCdnMap":{"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn47@2020_2/2020/11/16/09-20-28-686_9b46b2b51334437a.webp","https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Gladstone-2.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn52@2020_1/2020/11/16/09-20-29-955_328ce550b0b4045e.webp","https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/GladstoneImgOpt_Example.gif":null},"publishedOrCreatedDate":1605518428432}],"record":{"createdTime":"2020-11-16 17:20:28","updatedTime":"2020-11-16 17:20:28","feedId":11388,"fetchDate":"Mon, 16 Nov 2020 09:20:28 +0000","fetchMs":325,"handleMs":12,"totalMs":38497,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"aa5b771909b552db8ae765322bbc0947","hostName":"europe70*","requestId":"2d9fc4dbc4df4866961cd36fd108fffa_11388","contentType":"application/rss+xml; charset=UTF-8","totalBytes":76178,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":3,"articlesImgsGithubTotal":2,"successGithubMap":{"myreaderx2":1,"myreaderx29":1},"failGithubMap":{"myreaderx14":1}},"feed":{"createdTime":"2020-08-25 04:36:42","updatedTime":"2020-09-05 01:32:56","id":11388,"name":"Visual Studio Blog","url":"https://blogs.msdn.microsoft.com/visualstudio/feed/","subscriber":271,"website":null,"icon":"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2018/10/Microsoft-Favicon.png","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx65/cdn6@2020_1/2020/09/04/17-32-49-602_2ca911797d0baf90.png","description":"The official source of product insight from the Visual Studio Engineering Team","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2020-11-16 17:21:06","updatedTime":"2020-11-16 17:21:06","id":null,"feedId":11388,"linkMd5":"616959630bac888a0fbcf793ce194b39"}],"tmpCommonImgCdnBytes":47314,"tmpBodyImgCdnBytes":28864,"tmpBgImgCdnBytes":0,"extra4":{"start":1605518428079,"total":0,"statList":[{"spend":342,"msg":"获取xml内容"},{"spend":12,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":36945,"msg":"正文链接上传到cdn"}]},"extra5":3,"extra6":3,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/GladstoneImgOpt_Example.gif","sourceStatusCode":200,"destWidth":1920,"destHeight":1032,"sourceBytes":1956885,"destBytes":430780,"targetWebpQuality":75,"feedId":11388,"totalSpendMs":7495,"convertSpendMs":6757,"createdTime":"2020-11-16 17:20:29","host":"europe-58*","referer":"https://devblogs.microsoft.com/visualstudio/?p=230937","linkMd5ListStr":"616959630bac888a0fbcf793ce194b39","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx14/cdn53/contents/2020/11/16/09-20-36-628_472073803d7db16a.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 68584859.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Mon, 16 Nov 2020 09:20:37 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["93C2:BAD1:1AC1E85:1E90A66:5FB24458"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1605521404"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx14/cdn53/contents/2020/11/16/09-20-36-628_472073803d7db16a.webp","historyStatusCode":[],"spendMs":516},"base64UserPassword":null,"token":"6b67d******************************91b08"},"githubUser":"myreaderx14","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.9 MB","destSize":"420.7 KB","compressRate":"22%"},{"code":1,"isDone":false,"source":"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/GladstoneImgOpt_Example.gif","sourceStatusCode":200,"destWidth":1920,"destHeight":1032,"sourceBytes":1956885,"destBytes":430780,"targetWebpQuality":75,"feedId":11388,"totalSpendMs":29242,"convertSpendMs":28392,"createdTime":"2020-11-16 17:20:37","host":"europe-57*","referer":"https://devblogs.microsoft.com/visualstudio/?p=230937","linkMd5ListStr":"616959630bac888a0fbcf793ce194b39","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx14/cdn53/contents/2020/11/16/09-21-05-899_472073803d7db16a.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 68584859.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Mon, 16 Nov 2020 09:21:06 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["9E88:7086:38CAE4D:4125DD0:5FB2447E"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1605521404"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx14/cdn53/contents/2020/11/16/09-21-05-899_472073803d7db16a.webp","historyStatusCode":[],"spendMs":672},"base64UserPassword":null,"token":"6b67d******************************91b08"},"githubUser":"myreaderx14","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.9 MB","destSize":"420.7 KB","compressRate":"22%"}],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe-57.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://europe-58.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Before-1.png","sourceStatusCode":200,"destWidth":1647,"destHeight":502,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn47@2020_2/2020/11/16/09-20-28-686_9b46b2b51334437a.webp","sourceBytes":43296,"destBytes":47314,"targetWebpQuality":75,"feedId":11388,"totalSpendMs":1028,"convertSpendMs":67,"createdTime":"2020-11-16 17:20:28","host":"us-008*","referer":"https://devblogs.microsoft.com/visualstudio/?p=230937","linkMd5ListStr":"616959630bac888a0fbcf793ce194b39,616959630bac888a0fbcf793ce194b39","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"42.3 KB","destSize":"46.2 KB","compressRate":"109.3%"},{"code":1,"isDone":false,"source":"https://devblogs.microsoft.com/visualstudio/wp-content/uploads/sites/4/2020/10/Optimize_Gladstone-2.png","sourceStatusCode":200,"destWidth":802,"destHeight":238,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn52@2020_1/2020/11/16/09-20-29-955_328ce550b0b4045e.webp","sourceBytes":18048,"destBytes":28864,"targetWebpQuality":75,"feedId":11388,"totalSpendMs":1144,"convertSpendMs":10,"createdTime":"2020-11-16 17:20:29","host":"europe-57*","referer":"https://devblogs.microsoft.com/visualstudio/?p=230937","linkMd5ListStr":"616959630bac888a0fbcf793ce194b39","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"17.6 KB","destSize":"28.2 KB","compressRate":"159.9%"}],"successGithubMap":{"myreaderx2":1,"myreaderx29":1},"failGithubMap":{"myreaderx14":1}}