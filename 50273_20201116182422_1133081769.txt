{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-11-17 02:23:19","updatedTime":"2020-11-17 02:23:19","title":" ボカロ(作るところから)はじめました","link":"https://yaneurao.hatenadiary.com/entry/20140420/p1","description":"<p><br /> 今日からボカロを始めることにした。もちろん、ボカロを作るところからだ。ボカロを含めて音源も自作する。楽器(ハード)も自作する。<br /> <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B2%BB%B3%DA%CD%FD%CF%C0\">音楽理論</a>も自分で構築しなおす。自動作曲のためのプログラムも作る。そうして、やっと自分だけの音楽が完成する。とりあえず、目標はそこだ。</p>\n<br /> \n<p>■　ボカロを作るとは？</p>\n<br /> \n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BD%E9%B2%BB%A5%DF%A5%AF\">初音ミク</a>に代表されるような<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%DC%A1%BC%A5%AB%A5%ED%A5%A4%A5%C9\">ボーカロイド</a>は、「あ」「い」「う」など、人間がそれぞれの文字を発声したものを録音しておき再生しているだけである。つながりが不自然なところは二文字、ときとして三文字つなげたファイルも持っている。ただそれだけである。私はそういうことをしたいわけではない。声を一から作るところからだ。</p>\n<br /> \n<p>■　<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D1%A1%BC%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">スーパーファミコン</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a></p>\n<br /> \n<p>順序立てて話そう。</p>\n<br /> \n<p>私は高校生のときにアーケードの麻雀の移植のために<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B2%BB%C0%BC%B9%E7%C0%AE\">音声合成</a>の処理を書いたことがある。<a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-632eec27\" name=\"fn-632eec27\" title=\"http://d.hatena.ne.jp/yaneurao/20120226#p1\">*1</a><br /> このプログラムは実際には世に出なかったわけであるが、私はそれ以前から、音をプログラムすることに関して強い関心があった。</p>\n<br /> \n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Falcom\">Falcom</a>の『<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A1%BC%A5%B9\">イース</a>』の音源ドライバーを中学のときに夏休みを丸ごと潰して解析したのも音に対してすこぶる興味があったからだし<a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-6bb52aee\" name=\"fn-6bb52aee\" title=\"http://www.4gamer.net/games/001/G000183/20131222001/index_2.html\">*2</a>、BM98を作ったことにしてもその延長線上にある。私はプログラム以上に音に対しての興味があった。</p>\n<br /> \n<p>2004年ごろに<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BD%A5%CB%A1%BC\">ソニー</a>が<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/PS3\">PS3</a>の開発に際し、PS1/2のエミュレーションレイヤーの実装のための人員募集をしていた。そういう仕事は大好きなので、応募しようかと思ったのだが、その給料があまりにも安く、当時の自分の給料の何分の一かになってしまうので、ずいぶん悩んだのだが、ついに応募はしなかった。ただ、そのときは応募も本気で考えていたので、小手調べに<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D1%A1%BC%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">スーパーファミコン</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>をソフトウェア実装してみた。</p>\n<br /> \n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D1%A1%BC%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">スーパーファミコン</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>を一度でも聴いたことがある人は、耳が腐ってでもいない限り、あれがとても特殊な<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>であることがわかるだろう。<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">ファミコン</a>のそれとは一線を画する、そしてそのあとブームとなる<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/FM%B2%BB%B8%BB\">FM音源</a>とも異なる、骨太の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>である。実際、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/FM%B2%BB%B8%BB\">FM音源</a>全盛期に<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D1%A1%BC%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">スーパーファミコン</a>のゲームを移植しようとした会社が、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/FM%B2%BB%B8%BB\">FM音源</a>のパラメーターをどう調整しても<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D1%A1%BC%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">スーパーファミコン</a>っぽい音が出せなくてとても苦労したという話は枚挙にいとまがない。</p>\n<br /> \n<p>要するに、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D1%A1%BC%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">スーパーファミコン</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>(<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>チップ)とは当時の歴史のなかに本来、技術的に存在してはおかしいような<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%AA%A1%BC%A5%D1%A1%BC%A5%C4\">オーパーツ</a>そのものなのである。</p>\n<br /> \n<p>何故こんな<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%AA%A1%BC%A5%D1%A1%BC%A5%C4\">オーパーツ</a>がこの世に存在したのか。実は、この<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>はのちに<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BD%A5%CB%A1%BC\">ソニー</a>(<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SCEI\">SCEI</a>)の社長にもなる<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B5%D7%D4%EC%CE%C9%CC%DA\">久夛良木</a>さんが手がけたものなのだ。<a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-249f194f\" name=\"fn-249f194f\" title=\"http://ja.wikipedia.org/wiki/SPU\">*3</a></p>\n<br /> \n<p><span itemscope=\"\" itemtype=\"http://schema.org/Photograph\"><a href=\"http://f.hatena.ne.jp/yaneurao/20140420051801\" class=\"hatena-fotolife\" itemprop=\"url\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/y/yaneurao/20140420/20140420051801.png\" alt=\"f:id:yaneurao:20140420051801p:image\" title=\"f:id:yaneurao:20140420051801p:image\" class=\"hatena-fotolife\" itemprop=\"image\" /></a></span></p>\n<br /> \n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B5%D7%D4%EC%CE%C9%CC%DA\">久夛良木</a>さんレベルの超天才エンジニアの手がけたハードは自分の手でエミュレーションレイヤーを実装してみて初めてその設計思想、素晴らしさが実感できるわけである。私はもちろん、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B5%D7%D4%EC%CE%C9%CC%DA\">久夛良木</a>さんレベルのエンジニアではないが、しかし、プログラムを書く能力は人並み以上にあるから、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B5%D7%D4%EC%CE%C9%CC%DA\">久夛良木</a>さんの<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>を自分の手でソフトウェアで再実装することが出来た。誰しも感動する小説に出会えたときには自分に文字を読む能力があり、そして小説の内容を理解できる能力が備わっていたことに感謝するだろう。それと同じ感動がそこにはあった。あのときだけは、自分がプログラムを書く能力が備わっていたこと、そして、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B5%D7%D4%EC%CE%C9%CC%DA\">久夛良木</a>さんの天才性の一部であれ、理解できたことに対して神様に感謝してやまなかった。</p>\n<br /> \n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D1%A1%BC%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">スーパーファミコン</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>のどこがそんなに優れているのかについてざっと書いておく。本当は、この部分は本記事にはあまり関係がないのだが、ここを書いておかないと「<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A4%E4%A4%CD%A4%A6%A4%E9%A4%AA\">やねうらお</a>め、また内容のない薄っぺらい記事を書きやがって！本当は<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D5%A5%A1%A5%DF\">スーファミ</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>のことなんか何も理解していないくせに！」などと勘ぐる輩が出てくるので、あえて書いておく。<br /> ※　技術的な内容なので、興味のない人は読みとばしてください。</p>\n<br /> \n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D1%A1%BC%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">スーパーファミコン</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>の公称性能はこうなっている。<a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-6a09ca8d\" name=\"fn-6a09ca8d\" title=\"http://ja.wikipedia.org/wiki/SPU\">*4</a></p>\n<br /> \n<p><span itemscope=\"\" itemtype=\"http://schema.org/Photograph\"><a href=\"http://f.hatena.ne.jp/yaneurao/20140420051802\" class=\"hatena-fotolife\" itemprop=\"url\"><img src=\"https://cdn-ak.f.st-hatena.com/images/fotolife/y/yaneurao/20140420/20140420051802.png\" alt=\"f:id:yaneurao:20140420051802p:image\" title=\"f:id:yaneurao:20140420051802p:image\" class=\"hatena-fotolife\" itemprop=\"image\" /></a></span></p>\n<br /> \n<p>上の説明は今ひとつわかりにくいが、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>とは別に制御用のチップが載っている。6502を拡張した命令セットを持ち、音源ドライバーなどはここに配置する。この音源ドライバーで結構いろいろなことが出来てしまうので、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D5%A5%A1%A5%DF\">スーファミ</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>はゲームメーカーによって音色がずいぶん違うと言われるゆえんである。</p>\n<br /> \n<p>・BRR圧縮された波形データの復元</p>\n<br /> \n<p>事前にサンプリングした波形データを復元する機能。<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/PlayStation\">PlayStation</a>で使われている圧縮<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>と同一である。<a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-edeb7aa0\" name=\"fn-edeb7aa0\" title=\"http://en.wikipedia.org/wiki/Bit_Rate_Reduction\">*5</a></p>\n<br /> \n<p>・ADSR</p>\n<br /> \n<p>ADSRは、Attack、Decay、Sustain、Releaseの頭文字で、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/FM%B2%BB%B8%BB\">FM音源</a>に見られるような<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%F3%A5%D9%A5%ED%A1%BC%A5%D7\">エンベロープ</a>ジェネレーターであるが、A,D,S,Rの値はそれぞれ4bit、3bit、5bit、3bitで指定する。(そのあと表引きして実際のA,D,S,Rの値が設定される)　併せて15bitだから16bitに収まっている。いまどきなら、それぞれの値を直接設定できるようにするところだろうが、当時はメモリがもったいないのでこういう設計が好まれた。</p>\n<br /> \n<p>ところが、このADSR機能を使わずに直接gain(≒ボリューム)を変更するモードもある。実のことを言うと大手メーカーの<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D5%A5%A1%A5%DF\">スーファミ</a>用の音源ドライバーはADSRモードではなく、こちらのモードを使ってあるものが多い(と思う)。自前の音源ドライバーでADSRよりもっと細かな制御をしたほうが、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>に広がりが出てくるからである。なのでADSRはこの<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>の代表的機能ではあるが、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D5%A5%A1%A5%DF\">スーファミ</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>の特徴ではないと私は考えている。</p>\n<br /> \n<p>・<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%AC%A5%A6%A5%B9%CA%AC%C9%DB\">ガウス分布</a>補間</p>\n<br /> \n<p>指定した4点を曲線で補間する機能。実装的には<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%AC%A5%A6%A5%B9%CA%AC%C9%DB\">ガウス分布</a>テーブルを用いている(表引きしている)ので正確な補間ではないし、さらに計算資源があるならスプライン補間したほうが歪みのない<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>になるし、いまのPC用にソフトウェアで実装するならそうすべきところではあるのだが、良くも悪くもこの“歪み”自体が<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D5%A5%A1%A5%DF\">スーファミ</a>らしい<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>を形成していると思う。</p>\n<br /> \n<p>・ディレイ</p>\n<br /> \n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">ファミコン</a>にはディレイがなかったのでこれは大きな進歩。<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B5%D7%D4%EC%CE%C9%CC%DA\">久夛良木</a>さんの発言によると『<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%A1%A5%DF%A5%B3%A5%F3\">ファミコン</a>については<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>トラック4本や音のディレイがないことから「そんなもんで音楽なんてやれませんよね」「普通の人はそれで感動するかというと、ぼくは感動しないと思う」「クリエイターがやりたいと思ってることがやれるかどうかというのがキー」』<a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-b825de22\" name=\"fn-b825de22\" title=\"http://ja.wikipedia.org/wiki/%E4%B9%85%E5%A4%9B%E8%89%AF%E6%9C%A8%E5%81%A5\">*6</a></p>\n<br /> \n<p>・リ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A1%BC%A5%D6\">バーブ</a>（次数8のFIRフィルタ付）</p>\n<br /> \n<p>リ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A1%BC%A5%D6\">バーブ</a>にFIR(有限インパルス応答)フィルタ<a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-f92c98f9\" name=\"fn-f92c98f9\" title=\"http://ja.wikipedia.org/wiki/%E6%9C%89%E9%99%90%E3%82%A4%E3%83%B3%E3%83%91%E3%83%AB%E3%82%B9%E5%BF%9C%E7%AD%94\">*7</a>までつけてしまうのが恐ろしい。ここの「次数8」というのは、パラメーター(係数)が8個指定できるという意味。FIRフィルタ自体はデジタルフィルタとしては基本的なものなので説明は割愛。</p>\n<br /> \n<p>・<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D5%A5%A1%A5%DF\">スーファミ</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>まとめ</p>\n<br /> \n<p>結局のところ、上記のような当時としてはかなり高機能な処理能力を備えた<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>と、この<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>の制御用チップ(ここに各ゲームメーカーが独自の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>ドライバーを載せた)との組み合わせにより<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D5%A5%A1%A5%DF\">スーファミ</a>らしい<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>がもたらされたわけである。</p>\n<br /> \n<p>■　オリジナルのボカロを作るとは？</p>\n<br /> \n<p>もうここまで説明すれば話は見えただろう。今回、ボカロを自作するわけであるが、まずそのために<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D5%A5%A1%A5%DF\">スーファミ</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>のようなソフトウェア実装の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>レイヤーを用意する。まあ、人間の肉声に近い<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A6%A5%F3%A5%C9\">サウンド</a>が欲しいわけで、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A1%BC%A5%D5%A5%A1%A5%DF\">スーファミ</a>の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>よりは少し高機能なものにならざるを得ないが。また、ここは将来的にハードウェア化するかも知れないので、この部分はそのへんも見越しておく。</p>\n<br /> \n<p>次に、この<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>に対してプログラムできる必要があるのだが、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>制御用の命令セットを用意して、その命令によってプログラムすることにする。(将来的なハードウェア化を視野に入れているため)</p>\n<br /> \n<p>あと、この自作ボカロをライブで使うような用途を考えているため、この自作ボカロをリアルタイムに歌わせることが出来るような楽器自体を作らなければならない。そのへんもすでに考えてある。</p>\n<br /> \n<p>かなり早口な歌でも訓練次第ではリアルタイム演奏が可能である、画期的な楽器(音楽的なデ<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A5%A4%A5%B9\">バイス</a>？)となる予定だ。</p>\n<br /> \n<p>■　音楽の自動作曲とは？</p>\n<br /> \n<p>ついでだからもう少し話を進めよう。コンピューターによる<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>作曲(自動作曲)についてである。この分野の近年の技術的進歩はめざましく、論文もたくさん出ているし、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>作曲は実用的になりつつあると思うのだが、私はそういう方向性でやりたいわけではないのだ。</p>\n<br /> \n<p>作曲をやっている人にはわかると思うけど、どこかの段階で対位法とか勉強するわけだ。二声対位法、三声〜八声、厳格対位法、模倣、二重対位法、フーガetc…。そうするとその手の教科書には「禁則」(こういう進行は良くない)が延々と書いてある。和声に関しても、ある程度基礎が出来たのちに、いわゆる芸大和声(<a href=\"http://d.hatena.ne.jp/asin/4276102057/aaaaab0c-22\">asin:4276102057</a>)あたりから勉強するわけだが、「禁則」のオンパレードである。そして、興味深いことに本によって何が「禁則」であるかは定義が異なる。</p>\n<br /> \n<p>じゃあ、そもそも「禁則」とは何なのか。<br /> このように「禁則」とすることによって何が得られるのか。</p>\n<br /> \n<p>結論的に言うと、その本を書いた人が想定している音楽(それは18世紀のものであったり、それ以前のものであったり、特定の作曲家のものであったりするのだが)が得られるということである。この部分を理解していないと、やみくもに「禁則」だけ覚えることに終始してしまい、自分の作る曲の音楽的な可能性を狭めてしまう。</p>\n<br /> \n<p>要するに「禁則」とは、曲の生成<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>が何かしらあるとしてそのためのルール集合の一部だと考えるとわかりやすいだろう。</p>\n<br /> \n<p>例えば、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%E2%A1%BC%A5%C4%A5%A1%A5%EB%A5%C8\">モーツァルト</a>の曲を分析し、そのルール集合が得られれば、そのルール集合からは<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%E2%A1%BC%A5%C4%A5%A1%A5%EB%A5%C8\">モーツァルト</a>の曲っぽい曲が自動生成できるということだ。</p>\n<br /> \n<p>しかし、自動生成と言っても、単にルール集合に書かれているルールを順番に適用していけばいいという単純なものではない。例えば、前の音符との次の音符との接続される形に良さの点数がつけられるとしたら、その点数を最大化したい。そして一曲通してその点数の合計が最大になるような曲にしたい。そうならないときは前の音符を消して、また別の音符に置き換えて…という作業を繰り返す必要がある。</p>\n<br /> \n<p>実はこの部分はコンピューター将棋の探索と全く同じなのである。音符一つ(音符の高さ・音符の長さ)が将棋の指し手に相当し、音符を一つ置くことが将棋ではその指し手で局面を進めることを意味する。将棋で読みのなかで局面をいったりきたりするが、音符を足したり、消したりするのはそういう理由からである。そして、将棋であれば最終的な点数(将棋であれば最善応手列≒読み筋)の末端局面の評価値が最大になるような現局面での指し手を探すが、曲作りのときも、最終的な点数が最大となるような音符の並びを探し出せば良いのである。</p>\n<br /> \n<p>つまり、自動作曲は実はルール集合さえ与えれば、コンピューター将棋の探索部によって解決できるのである。</p>\n<br /> \n<p>これは何も偶然の一致ではない。人間の知的作業のほとんどは、何らかの点数を最大化するという、探索を伴う最大化問題に帰着されるので、作曲行為自体がコンピューター将棋の探索の問題に還元されるのは何も不思議なことではないのだ。</p>\n<br /> \n<p>■　作曲のためのルール集合</p>\n<br /> \n<p>では人間は何もしなくても曲が出来上がるのかと言うとそれは違う。作曲のためのルール集合自体は人間が考えてやる必要がある。<br /> ルール集合が同じであると似たような曲しか出来ないし、そこがまさに人間にしか出来ない知的作業と言えるわけである。</p>\n<br /> \n<p>例えば、<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%E4%CB%DC%CE%B6%B0%EC\">坂本龍一</a>(<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BF%A5%C5%C4%BF%AE%C4%B9\">織田信長</a>に「さん」をつけないの同様、歴史レベルの偉人なので敬称をあえて略す)の作曲のための方法論として、自分が考えた作曲<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>に基づき、自分を作曲機械だとみなしてその<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>により曲を生成し、その曲の良し悪しを音<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B3%DA%B2%C8\">楽家</a><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%E4%CB%DC%CE%B6%B0%EC\">坂本龍一</a>が評価し、そして作曲<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>の修正を行なうという<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%A3%A1%BC%A5%C9%A5%D0%A5%C3%A5%AF%A5%EB%A1%BC%A5%D7\">フィードバックループ</a>により作曲するという主旨のことが『<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%E4%CB%DC%CE%B6%B0%EC\">坂本龍一</a>の音楽』(<a href=\"http://d.hatena.ne.jp/asin/4487801036/aaaaab0c-22\">asin:4487801036</a>)に書いてあったと思う。(うろ覚え)</p>\n<br /> \n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%E4%CB%DC%CE%B6%B0%EC\">坂本龍一</a>が本当にそうやって作曲しているのかどうかは私は知らないが、そういう視点というのが面白いと思っていたし、この「自分を作曲機械だとみなしてその<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>により曲を生成する」という部分は、私のプログラミング能力であればコンピューターに完全に肩代わりさせることが可能だ。</p>\n<br /> \n<p>そうなってくると、「自分が考えた作曲<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>」が問題となる。従来の<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>作曲の論文では、この部分が固定に近い形であったので、同じような曲しか作れなかった。自動生成される曲の完成度はともかく、私にはその部分が大いに不満であった。</p>\n<br /> \n<p>私は特定のジャンル、特定の種類の曲を大量に生成したいわけではないので、上記のような<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%A3%A1%BC%A5%C9%A5%D0%A5%C3%A5%AF%A5%EB%A1%BC%A5%D7\">フィードバックループ</a>をなるべく短い時間で回したいのである。そうすることにより短い時間で自分の作曲<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>が磨かれるわけである。</p>\n<br /> \n<p>そして、最終的にはこのループ自体を少しプログラムと音楽に対して理解のある人であれば誰もが体験できるよう、自動作曲のためのプログラミング<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%EC%A1%BC%A5%E0%A5%EF%A1%BC%A5%AF\">フレームワーク</a>として公開したいわけである。</p>\n<br /> \n<p>■　まとめ</p>\n<br /> \n<p>ということで、私の当面の目標は以下のような感じである。(何年かかるかは知らん)</p>\n<br /> \n<p>・ボカロを自作(そのために自分で設計した<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>をソフトウェア実装するところから)<br /> ・音源を自作(自分で設計した<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/DSP\">DSP</a>に対する制御プログラミングにより)<br /> ・ボカロをライブ演奏できるような楽器を自作<br /> ・<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A5%EB%A5%B4%A5%EA%A5%BA%A5%E0\">アルゴリズム</a>作曲とその<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%EC%A1%BC%A5%E0%A5%EF%A1%BC%A5%AF\">フレームワーク</a>の作成</p>\n<br /> \n<p>■　あとがき</p>\n<br /> \n<p>何故突然こんなことを思ったのかと言うと、電王戦が終わったので友達に借りてる漫画を読んでいたわけである。その友達とは電王トーナメントのエントリーのときにやねうら王の開発者としてもう一人名前が挙がっていたと思うが、彼である。彼は、いつも私をその気にさせる。やねうら王も彼がいたから作ろうという気になったわけである。だから、やねうら王のエントリーのときに共同開発者として彼の名前を入れておいた。</p>\n<br /> \n<p>今回、彼が持ってきた漫画は『ナッちゃん東京編 1―下町鉄工所奮闘記』 (<a href=\"http://d.hatena.ne.jp/asin/4088597001/aaaaab0c-22\">asin:4088597001</a>)という漫画で、下町の鉄工所で働く女の子(?)の物語である。この女の子がちょっとした天才で、創意工夫によって無理難題を解決していくわけであるが、これを見ていたら昔のことを思い出したわけだ。</p>\n<br /> \n<p>私は小学生の段階ですでに仕事としてやっていける程度にはプログラミング能力があったわけであるが、大学を卒業するころにはプログラミング自体に少し嫌気が刺しており、これを職業にするとプログラミングのことが嫌いになってしまうと考えて、プログラミングとは全く違う分野(製図設計)の仕事に就いたわけである。正直に言えば当時は自分がプログラミングが出来ること自体が、本当に忌々しいと思っていたし、「こんな神がかったプログラミング能力とか要らねえんだよ！俺は、刺身にたんぽぽを乗せるような頭の使わない仕事がしたいんだよ！」と考えていた。</p>\n<br /> \n<p>ところが、モノづくりの現場で働くうちに、創意工夫して製品を作る(さらに、それをお客様に届け、喜んでもらう)ということの素晴らしさを知ったわけである。『ナッちゃん東京編 1―下町鉄工所奮闘記』を読んでいると、そんな当時の自分を思い出してしまった。そうだ、何でも工夫すれば作れるんだ。俺には、神がかったプログラミング能力があるんだしな！と思ったわけだ。</p>\n<br /> \n<p>※　このブログの愛読者ならば、「神がかった」とか書いてあっても「また今日も<a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A4%E4%A4%CD%A4%A6%A4%E9%A4%AA\">やねうらお</a>節、全開だな」ぐらいに理解してもらえるはずなのであるが、そうでない人に言っておくと、「神がかった」というのは、ある種の冗談であり誇張表現の一種である。本気で自分のプログラムを「神がかった」などと思っている人がいたら、それは相当な大馬鹿野郎である。</p>\n<br /> \n<p>そして、そのとき、音楽とコンピューター将棋との関係に気づき、点と点が一本の線でつながったわけだ。これは、もうボカロを(作るところから)やるしかないなと。</p>\n<br /> \n<p>ちなみに、私の作曲経験だが、自分の作った曲が商用ゲームに使われたことがある。まあ、自分がプロデューサーだったんだから、自分の曲使おうが何を使おうが自由なんだけども。商用ゲームに使われたらプロだという定義だとしたら、私はプロの作曲家である。おお、これはなんか凄くずるい感じがするな！</p>\n<br /> \n<p>「プロの作曲家になりたい人は、自分で商用ゲームでもプロデュースすればいいんだよ！」などとテキトーなことを言ってこの記事を終りにしたい。</p> \n<div class=\"footnote\"> \n <p class=\"footnote\"><a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-632eec27\" name=\"f-632eec27\" class=\"footnote-number\">*1</a><span class=\"footnote-delimiter\">:</span><span class=\"footnote-text\"><a href=\"http://d.hatena.ne.jp/yaneurao/20120226#p1\">http://d.hatena.ne.jp/yaneurao/20120226#p1</a></span></p> \n <p class=\"footnote\"><a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-6bb52aee\" name=\"f-6bb52aee\" class=\"footnote-number\">*2</a><span class=\"footnote-delimiter\">:</span><span class=\"footnote-text\"><a href=\"http://www.4gamer.net/games/001/G000183/20131222001/index_2.html\">http://www.4gamer.net/games/001/G000183/20131222001/index_2.html</a></span></p> \n <p class=\"footnote\"><a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-249f194f\" name=\"f-249f194f\" class=\"footnote-number\">*3</a><span class=\"footnote-delimiter\">:</span><span class=\"footnote-text\"><a href=\"http://ja.wikipedia.org/wiki/SPU\">http://ja.wikipedia.org/wiki/SPU</a></span></p> \n <p class=\"footnote\"><a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-6a09ca8d\" name=\"f-6a09ca8d\" class=\"footnote-number\">*4</a><span class=\"footnote-delimiter\">:</span><span class=\"footnote-text\"><a href=\"http://ja.wikipedia.org/wiki/SPU\">http://ja.wikipedia.org/wiki/SPU</a></span></p> \n <p class=\"footnote\"><a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-edeb7aa0\" name=\"f-edeb7aa0\" class=\"footnote-number\">*5</a><span class=\"footnote-delimiter\">:</span><span class=\"footnote-text\"><a href=\"http://en.wikipedia.org/wiki/Bit_Rate_Reduction\">http://en.wikipedia.org/wiki/Bit_Rate_Reduction</a></span></p> \n <p class=\"footnote\"><a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-b825de22\" name=\"f-b825de22\" class=\"footnote-number\">*6</a><span class=\"footnote-delimiter\">:</span><span class=\"footnote-text\"><a href=\"http://ja.wikipedia.org/wiki/%E4%B9%85%E5%A4%9B%E8%89%AF%E6%9C%A8%E5%81%A5\">http://ja.wikipedia.org/wiki/%E4%B9%85%E5%A4%9B%E8%89%AF%E6%9C%A8%E5%81%A5</a></span></p> \n <p class=\"footnote\"><a href=\"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-f92c98f9\" name=\"f-f92c98f9\" class=\"footnote-number\">*7</a><span class=\"footnote-delimiter\">:</span><span class=\"footnote-text\"><a href=\"http://ja.wikipedia.org/wiki/%E6%9C%89%E9%99%90%E3%82%A4%E3%83%B3%E3%83%91%E3%83%AB%E3%82%B9%E5%BF%9C%E7%AD%94\">http://ja.wikipedia.org/wiki/%E6%9C%89%E9%99%90%E3%82%A4%E3%83%B3%E3%83%91%E3%83%AB%E3%82%B9%E5%BF%9C%E7%AD%94</a></span></p> \n</div>","descriptionType":"html","publishedDate":"Sat, 19 Apr 2014 15:00:00 +0000","feedId":50273,"bgimg":"https://cdn-ak.f.st-hatena.com/images/fotolife/y/yaneurao/20140420/20140420051801.png","linkMd5":"a9d9acbccce4b220ab833676f8453a9d","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn43@2020_5/2020/11/16/18-23-19-882_9bdf4a3161bdafae.webp","destWidth":815,"destHeight":86,"sourceBytes":31400,"destBytes":17730,"author":"yaneurao","enclosureType":"image/png","enclosureUrl":"https://cdn-ak.f.st-hatena.com/images/fotolife/y/yaneurao/20140420/20140420051801.png","articleImgCdnMap":{"https://cdn-ak.f.st-hatena.com/images/fotolife/y/yaneurao/20140420/20140420051801.png":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn43@2020_5/2020/11/16/18-23-19-882_9bdf4a3161bdafae.webp","https://cdn-ak.f.st-hatena.com/images/fotolife/y/yaneurao/20140420/20140420051802.png":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn47@2020_3/2020/11/16/18-24-21-872_c352c4ec4341adb1.webp"},"publishedOrCreatedDate":1605550999071}],"record":{"createdTime":"2020-11-17 02:23:19","updatedTime":"2020-11-17 02:23:19","feedId":50273,"fetchDate":"Mon, 16 Nov 2020 18:23:19 +0000","fetchMs":2755,"handleMs":5478,"totalMs":72249,"newArticles":0,"totalArticles":30,"status":1,"type":0,"ip":"b2be3c55cb19b5d073c0077eda58a224","hostName":"us-002*","requestId":"22666d9d55034e309fd003fbba98d81c_50273","contentType":"application/atom+xml; charset=utf-8","totalBytes":45772,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":2,"articlesImgsGithubTotal":2,"successGithubMap":{"myreaderx32":1,"myreaderx22":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 03:56:00","updatedTime":"2020-09-07 03:56:00","id":50273,"name":"やねうらおブログ(移転しました)","url":"http://d.hatena.ne.jp/yaneurao/rss2","subscriber":63,"website":null,"icon":"https://yaneurao.hatenadiary.com/favicon.ico","icon_jsdelivr":null,"description":"","weekly":null,"link":"https://yaneurao.hatenadiary.com"},"noPictureArticleList":[],"tmpCommonImgCdnBytes":17730,"tmpBodyImgCdnBytes":28042,"tmpBgImgCdnBytes":0,"extra4":{"start":1605550990491,"total":0,"statList":[{"spend":3102,"msg":"获取xml内容"},{"spend":5478,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":62012,"msg":"正文链接上传到cdn"}]},"extra5":2,"extra6":2,"extra7ImgCdnFailResultVector":[null],"extra10_invalidATagHrefValue":{"https://yaneurao.hatenadiary.com/entry/20140420/p1_#f-6a09ca8d":"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-6a09ca8d","https://yaneurao.hatenadiary.com/entry/20140420/p1_#fn-6bb52aee":"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-6bb52aee","https://yaneurao.hatenadiary.com/entry/20140420/p1_#fn-249f194f":"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-249f194f","https://yaneurao.hatenadiary.com/entry/20140420/p1_#f-632eec27":"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-632eec27","https://yaneurao.hatenadiary.com/entry/20140420/p1_#f-6bb52aee":"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-6bb52aee","https://yaneurao.hatenadiary.com/entry/20140420/p1_#f-edeb7aa0":"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-edeb7aa0","https://yaneurao.hatenadiary.com/entry/20140420/p1_#fn-632eec27":"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-632eec27","https://yaneurao.hatenadiary.com/entry/20140420/p1_#fn-f92c98f9":"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-f92c98f9","https://yaneurao.hatenadiary.com/entry/20140420/p1_#f-249f194f":"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-249f194f","https://yaneurao.hatenadiary.com/entry/20140420/p1_#f-f92c98f9":"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-f92c98f9","https://yaneurao.hatenadiary.com/entry/20140420/p1_#f-b825de22":"https://yaneurao.hatenadiary.com/entry/20140420/p1#f-b825de22","https://yaneurao.hatenadiary.com/entry/20140420/p1_#fn-6a09ca8d":"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-6a09ca8d","https://yaneurao.hatenadiary.com/entry/20140420/p1_#fn-edeb7aa0":"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-edeb7aa0","https://yaneurao.hatenadiary.com/entry/20140420/p1_#fn-b825de22":"https://yaneurao.hatenadiary.com/entry/20140420/p1#fn-b825de22"},"extra111_proxyServerAndStatMap":{"http://us-025.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-019.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://cdn-ak.f.st-hatena.com/images/fotolife/y/yaneurao/20140420/20140420051801.png","sourceStatusCode":200,"destWidth":815,"destHeight":86,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn43@2020_5/2020/11/16/18-23-19-882_9bdf4a3161bdafae.webp","sourceBytes":31400,"destBytes":17730,"targetWebpQuality":75,"feedId":50273,"totalSpendMs":1633,"convertSpendMs":11,"createdTime":"2020-11-17 02:23:19","host":"us-031*","referer":"https://yaneurao.hatenadiary.com/entry/20140420/p1","linkMd5ListStr":"a9d9acbccce4b220ab833676f8453a9d,a9d9acbccce4b220ab833676f8453a9d","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"30.7 KB","destSize":"17.3 KB","compressRate":"56.5%"},{"code":1,"isDone":false,"source":"https://cdn-ak.f.st-hatena.com/images/fotolife/y/yaneurao/20140420/20140420051802.png","sourceStatusCode":200,"destWidth":412,"destHeight":415,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn47@2020_3/2020/11/16/18-24-21-872_c352c4ec4341adb1.webp","sourceBytes":56374,"destBytes":28042,"targetWebpQuality":75,"feedId":50273,"totalSpendMs":1819,"convertSpendMs":69,"createdTime":"2020-11-17 02:24:20","host":"us-025*","referer":"https://yaneurao.hatenadiary.com/entry/20140420/p1","linkMd5ListStr":"a9d9acbccce4b220ab833676f8453a9d","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"55.1 KB","destSize":"27.4 KB","compressRate":"49.7%"}],"successGithubMap":{"myreaderx32":1,"myreaderx22":1},"failGithubMap":{}}