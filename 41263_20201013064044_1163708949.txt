{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-13 14:40:44","updatedTime":"2020-10-13 14:40:44","title":"Controller Inheritance","link":"http://www.therailsway.com/2009/4/6/controller-inheritance","description":"\n            <p>Just a brief interlude from the File Management series while I sort out some time to do some benchmarking.</p>\n\n\n\t<p>A common pattern I see in submissions and client-applications is repetitive declarations in controllers.  There’s a neat and simple solution for this, but given how often  Things like this:</p>\n\n\n<pre class=\"sh_ruby\">\n  class TodoController &lt; ApplicationController\n    before_filter :login_required\n    before_filter :handle_iphone_support\n    before_filter :fetch_todo\n    around_filter :performance_logging\n\n    def index\n    ...\n    end\n  end\n</pre>\nFor a single controller this set of declarations wouldn’t be a problem, but the problem is when all those declarations end up duplicated in several different controllers.  Thankfully every controller inherits from ApplicationController so we can do something like this:\n\n<pre class=\"sh_ruby\">\n  class ApplicationController &lt; ActionController::Base\n    before_filter :login_required\n    before_filter :handle_iphone_support\n    around_filter :performance_logging\n\n  end\n\n  class TodoController &lt; ApplicationController\n    before_filter :fetch_todo\n\n    def index\n    ...\n    end\n  end\n</pre>\n\n\t<p>This is easy, and obvious and most people do that.  However what do you do when you have several controllers which don’t need the login_required call?  One option is to give up on inheritance and go back to copying-and-pasting the filter declarations.  Another option is to selectively opt-out of the parent controller’s filters.</p>\n\n\n<pre class=\"sh_ruby\">\n  class ApplicationController &lt; ActionController::Base\n    before_filter :login_required\n    before_filter :handle_iphone_support\n    around_filter :performance_logging\n  end\n\n  class SignupController &lt; ApplicationController\n    skip_before_filter :login_required\n  end\n</pre>\n\n\t<p>However if you have several controllers which don’t require logins, you’ll find yourself duplicating the skip_before_filter declarations around.  Otherwise filters and declarations which aren’t completely universal still.  An approach which solves this nicely is to introduce an abstract parent controller for all your authenticated controllers.</p>\n\n\n<pre class=\"sh_ruby\">\n  class ApplicationController &lt; ActionController::Base\n    before_filter :handle_iphone_support\n    around_filter :performance_logging\n  end\n\n  class AuthenticatedController &lt; ApplicationController\n    before_filter :login_required\n  end \n\n  class TodoController &lt; AuthenticatedController\n    before_filter :fetch_todo\n\n    def index\n    ...\n    end\n  end\n</pre>\n\n\t<p>This technique doesn’t just work with filter declarations most other declarations such as caching, session and csrf options work as expected too.  In addition you can introduce several parent classes as needed such as a PublicController with page caching declarations, an AdminController for your admin panels etc.  Inheritance isn’t the solution to every case of duplicate declarations, yet it’s a simple technique that can simplify most uses.</p>\n          ","descriptionType":"html","publishedDate":"Mon, 06 Apr 2009 23:20:00 +0000","feedId":41263,"bgimg":"","linkMd5":"e20b13d891ddda9aff8c0ddc08e05b67","bgimgJsdelivr":"","metaImg":"","author":"Koz","publishedOrCreatedDate":1602571244686}],"record":{"createdTime":"2020-10-13 14:40:44","updatedTime":"2020-10-13 14:40:44","feedId":41263,"fetchDate":"Tue, 13 Oct 2020 06:40:44 +0000","fetchMs":98,"handleMs":180220,"totalMs":180338,"newArticles":0,"totalArticles":15,"status":1,"type":0,"ip":"8c6c16c7600d6b411627dac06cbaa89a","hostName":"us-019*","requestId":"71255022bc484fcc945f9543029cdb6e_41263","contentType":"text/xml; charset=UTF-8","totalBytes":0,"bgimgsTotal":0,"bgimgsGithubTotal":0,"articlesImgsTotal":0,"articlesImgsGithubTotal":0,"successGithubMap":{},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 03:23:30","updatedTime":"2020-09-07 05:43:13","id":41263,"name":"The Rails Way - Home","url":"http://feeds.feedburner.com/TheRailsWay","subscriber":78,"website":null,"icon":"http://www.therailsway.com/favicon.ico","icon_jsdelivr":null,"description":"","weekly":null,"link":"http://www.therailsway.com"},"noPictureArticleList":[],"tmpCommonImgCdnBytes":0,"tmpBodyImgCdnBytes":0,"tmpBgImgCdnBytes":0,"extra4":{"start":1602571064359,"total":0,"statList":[{"spend":107,"msg":"获取xml内容"},{"spend":180220,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":0,"msg":"正文链接上传到cdn"}]},"extra5":0,"extra6":0,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{},"extra12ImgCdnSuccessResultVector":[],"successGithubMap":{},"failGithubMap":{}}