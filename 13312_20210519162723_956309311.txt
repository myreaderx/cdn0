{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2021-05-20 00:26:51","updatedTime":"2021-05-20 00:26:51","title":"【MovableType】include_blogsを使わないテンプレート運用","link":"http://bashalog.c-brains.jp/21/05/17-203000.php","description":"<p>どうもfujiharaです。今年は全国的に梅雨が入り早いそうです。人は話題が無い場合天気の話をすることが多いらしいです。<br>\n本日はMovableTypeの<a href='https://www.movabletype.jp/documentation/mt6/design/multiblog/tags.html#blogids' target='_blank'>マルチブログ機能</a>\nのinclude_blogsを使わないで、ターゲットとなるブログ情報を取得する方法をご紹介します。</p>\n\n<h2>背景</h2>\n<p>ブログ（サイト）で別のブログを出力する場合以下のようにするのが一般的かと思います。</p>\n\n<pre>\n<code>\n&lt;mt:Entries include_blogs='x'&gt;\n...\n...\n...\n&lt;/mt:Entries&gt;\n</code>\n</pre>\n\n<p>ただ、サイトをバックアップ、復元するとブログ、サイトのIDがずれるのでそのたびに直さないといけません。\nなのでブログ名で判定し以下のようにしていました。(今回の場合ブログ名はtarget_blog_name）</p>\n\n<pre>\n<code>\n&lt;mt:Blogs&gt;\n&lt;mt:If tag=\"BlogName\" eq=\"target_blog_name\"&gt;\n...\n...\n&lt;/mt:If&gt;\n&lt;/mt:Blogs&gt;\n</code>\n</pre>\n\n<h2>新しい方法</h2>\n<p>ここ何年かで弊社ではMovableType.netで構築するほうが圧倒的に多く、その時に.netの機能でブログ（サイト）に識別子を付けられ、\nそこから対象のデータを表示できます。そこからヒントを得てMovableTypeにそれを実装します。<a href='https://movabletype.net/tags/multiblog.html#blogids' target='_blank'>参考URL</a>\n</p>\n\n<p>まず、システムで子サイト用のカスタムフィールドをblog_identifier(任意）:テキストで作成します。</p>\n\n<p><img alt=\"fujihara_20210517\" src=\"http://bashalog.c-brains.jp/images/Screen%20Shot%202021-05-17%20at%2020.19.02.png\" width=\"499\" height=\"904\" class=\"mt-image-center\" style=\"text-align: center; display: block; margin: 0 auto 20px;\" /></p>\n\n<p>その後、ターゲットとなるブログの設定画面からblog_identifierを入力します。</p>\n\n<p><img alt=\"fujihara_20210517_2.png\" src=\"http://bashalog.c-brains.jp/images/Screen%20Shot%202021-05-17%20at%2020.21.02.png\" width=\"508\" height=\"423\" class=\"mt-image-center\" style=\"text-align: center; display: block; margin: 0 auto 20px;\" /></p>\n\n<p>最後にテンプレートで以下のようにします。今回の場合identifierはsample</p>\n\n<pre>\n<code>\n&lt;mt:Blogs&gt;\n&lt;mt:If tag=\"blog_identifier\" eq=\"sample\"&gt;\n&lt;mt:Entries&gt;\n...\n...\n&lt;/mt:Entries&gt;\n&lt;/mt:If&gt;\n&lt;/mt:Blogs&gt;\n</code>\n</pre>\n\n<h2>まとめ</h2>\n<p>これで、include_blogsのIDズレに惑わされることなく、テンプレートの運用ができます。\ninclude_blogsで疲れた方は是非お試しください。\n</p><img src=\"http://feeds.feedburner.com/~r/bashalog/~4/hgpQ6kQDocE\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"text/html","publishedDate":"Mon, 17 May 2021 11:30:00 +0000","feedId":13312,"bgimg":"http://bashalog.c-brains.jp/images/Screen%20Shot%202021-05-17%20at%2020.19.02.png","linkMd5":"479dceed7e38fe5f06df912930bd96dd","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn31@2020_2/2021/05/19/16-26-52-349_e711a7aca93fd779.webp","destWidth":499,"destHeight":904,"sourceBytes":74384,"destBytes":22188,"author":"fujihara","articleImgCdnMap":{"http://bashalog.c-brains.jp/images/Screen%20Shot%202021-05-17%20at%2020.19.02.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn31@2020_2/2021/05/19/16-26-52-349_e711a7aca93fd779.webp","http://bashalog.c-brains.jp/images/Screen%20Shot%202021-05-17%20at%2020.21.02.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn36@2020_5/2021/05/19/16-26-53-515_bb12aa473b9c54a1.webp","http://feeds.feedburner.com/~r/bashalog/~4/hgpQ6kQDocE":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn40@2020_1/2021/05/19/16-27-22-759_e52818b43846f903.webp"},"publishedOrCreatedDate":1621441611062}],"record":{"createdTime":"2021-05-20 00:26:51","updatedTime":"2021-05-20 00:26:51","feedId":13312,"fetchDate":"Wed, 19 May 2021 16:26:51 +0000","fetchMs":20,"handleMs":15,"totalMs":32014,"newArticles":0,"totalArticles":30,"status":1,"type":0,"ip":"f306b40366a93aa712f78b685bea0f01","hostName":"us-53*","requestId":"0e6f57371d9a4ee997d88e87bb417200_13312","contentType":"text/xml; charset=UTF-8","totalBytes":31008,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":3,"articlesImgsGithubTotal":3,"successGithubMap":{"myreaderx10":1,"myreaderx1":1,"myreaderx5oss":1},"failGithubMap":{}},"feed":{"createdTime":"2020-08-25 04:38:26","updatedTime":"2020-09-05 16:49:26","id":13312,"name":"バシャログ。","url":"http://feeds.feedburner.com/bashalog","subscriber":233,"website":null,"icon":"http://bashalog.c-brains.jp/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx61/cdn54@2020_1/2020/09/05/08-49-23-771_d818c23c759f7b14.ico","description":"横浜のシーブレイン Web制作スタッフによる技術情報ブログ。WebデザインやFireworks、WordPress、EC-CUBE、CakePHPなどの情報が満載！","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":22188,"tmpBodyImgCdnBytes":8820,"tmpBgImgCdnBytes":0,"extra4":{"start":1621441611024,"total":0,"statList":[{"spend":23,"msg":"获取xml内容"},{"spend":15,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":1,"msg":"修正封面图上传失败重新上传"},{"spend":30399,"msg":"正文链接上传到cdn"}]},"extra5":3,"extra6":3,"extra7ImgCdnFailResultVector":[null],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-004.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-016.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"http://bashalog.c-brains.jp/images/Screen%20Shot%202021-05-17%20at%2020.19.02.png","sourceStatusCode":200,"destWidth":499,"destHeight":904,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn31@2020_2/2021/05/19/16-26-52-349_e711a7aca93fd779.webp","sourceBytes":74384,"destBytes":22188,"targetWebpQuality":75,"feedId":13312,"totalSpendMs":1560,"convertSpendMs":16,"createdTime":"2021-05-20 00:26:51","host":"us-028*","referer":"http://bashalog.c-brains.jp/21/05/17-203000.php","linkMd5ListStr":"479dceed7e38fe5f06df912930bd96dd,479dceed7e38fe5f06df912930bd96dd","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"72.6 KB","destSize":"21.7 KB","compressRate":"29.8%"},{"code":1,"isDone":false,"source":"http://bashalog.c-brains.jp/images/Screen%20Shot%202021-05-17%20at%2020.21.02.png","sourceStatusCode":200,"destWidth":508,"destHeight":423,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn36@2020_5/2021/05/19/16-26-53-515_bb12aa473b9c54a1.webp","sourceBytes":29887,"destBytes":8748,"targetWebpQuality":75,"feedId":13312,"totalSpendMs":1110,"convertSpendMs":8,"createdTime":"2021-05-20 00:26:52","host":"us-016*","referer":"http://bashalog.c-brains.jp/21/05/17-203000.php","linkMd5ListStr":"479dceed7e38fe5f06df912930bd96dd","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"29.2 KB","destSize":"8.5 KB","compressRate":"29.3%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/bashalog/~4/hgpQ6kQDocE","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn40@2020_1/2021/05/19/16-27-22-759_e52818b43846f903.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":13312,"totalSpendMs":300,"convertSpendMs":2,"createdTime":"2021-05-20 00:27:22","host":"us-016*","referer":"http://bashalog.c-brains.jp/21/05/17-203000.php","linkMd5ListStr":"479dceed7e38fe5f06df912930bd96dd","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"}],"successGithubMap":{"myreaderx10":1,"myreaderx1":1,"myreaderx5oss":1},"failGithubMap":{}}