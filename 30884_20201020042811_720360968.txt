{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-20 12:27:42","updatedTime":"2020-10-20 12:27:42","title":"Destoon 20180827版本 前台getshell","link":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/","description":"<p><a href=\"https://xz.aliyun.com/t/2797\" target=\"_blank\" rel=\"external\">Destoon 20180827版本 前台getshell</a><br><a id=\"more\"></a></br></p> \n<h1 id=\"前言\"><a href=\"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1>\n<p>2018年9月21日，Destoon官方发布安全更新，修复了由用户“索马里的海贼”反馈的一个漏洞。</p> \n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20180924092323-6e1898c6-bf98-1.jpeg\" alt=\"1.jpg\" /></p> \n<h1 id=\"漏洞分析\"><a href=\"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#漏洞分析\" class=\"headerlink\" title=\"漏洞分析\"></a>漏洞分析</h1>\n<p>根据更新消息可知漏洞发生在头像上传处。Destoon中处理头像上传的是 module/member/avatar.inc.php 文件。在会员中心处上传头像时抓包，部分内容如下：</p> \n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20180924092327-70161496-bf98-1.jpeg\" alt=\"2.jpg\" /></p> \n<p>对应着avatar.inc.php代码如下：<br>\n  <figure class=\"highlight php\">\n   <table>\n    <tr>\n     <td class=\"gutter\"><pre>\n       <div class=\"line\">\n        1\n       </div>\n       <div class=\"line\">\n        2\n       </div>\n       <div class=\"line\">\n        3\n       </div>\n       <div class=\"line\">\n        4\n       </div>\n       <div class=\"line\">\n        5\n       </div>\n       <div class=\"line\">\n        6\n       </div>\n       <div class=\"line\">\n        7\n       </div>\n       <div class=\"line\">\n        8\n       </div>\n       <div class=\"line\">\n        9\n       </div>\n       <div class=\"line\">\n        10\n       </div>\n       <div class=\"line\">\n        11\n       </div>\n       <div class=\"line\">\n        12\n       </div>\n       <div class=\"line\">\n        13\n       </div>\n       <div class=\"line\">\n        14\n       </div>\n       <div class=\"line\">\n        15\n       </div>\n       <div class=\"line\">\n        16\n       </div>\n       <div class=\"line\">\n        17\n       </div>\n       <div class=\"line\">\n        18\n       </div>\n       <div class=\"line\">\n        19\n       </div>\n       <div class=\"line\">\n        20\n       </div>\n       <div class=\"line\">\n        21\n       </div>\n       <div class=\"line\">\n        22\n       </div>\n       <div class=\"line\">\n        23\n       </div>\n       <div class=\"line\">\n        24\n       </div>\n       <div class=\"line\">\n        25\n       </div>\n       <div class=\"line\">\n        26\n       </div>\n       <div class=\"line\">\n        27\n       </div>\n       <div class=\"line\">\n        28\n       </div>\n       <div class=\"line\">\n        29\n       </div></pre></td>\n     <td class=\"code\"><pre>\n       <div class=\"line\">\n        <span class=\"meta\">&lt;?php</span> \n       </div>\n       <div class=\"line\">\n        defined(\n        <span class=\"string\">'IN_DESTOON'</span>) \n        <span class=\"keyword\">or</span> \n        <span class=\"keyword\">exit</span>(\n        <span class=\"string\">'Access Denied'</span>);\n       </div>\n       <div class=\"line\">\n        login();\n       </div>\n       <div class=\"line\">\n        <span class=\"keyword\">require</span> DT_ROOT.\n        <span class=\"string\">'/module/'</span>.$module.\n        <span class=\"string\">'/common.inc.php'</span>;\n       </div>\n       <div class=\"line\">\n        <span class=\"keyword\">require</span> DT_ROOT.\n        <span class=\"string\">'/include/post.func.php'</span>;\n       </div>\n       <div class=\"line\">\n        $avatar = useravatar($_userid, \n        <span class=\"string\">'large'</span>, \n        <span class=\"number\">0</span>, \n        <span class=\"number\">2</span>);\n       </div>\n       <div class=\"line\">\n        <span class=\"keyword\">switch</span>($action) {\n       </div>\n       <div class=\"line\">\t\n        <span class=\"keyword\">case</span> \n        <span class=\"string\">'upload'</span>:\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>(!$_FILES[\n        <span class=\"string\">'file'</span>][\n        <span class=\"string\">'size'</span>]) {\n       </div>\n       <div class=\"line\">\t\t\t\n        <span class=\"keyword\">if</span>($DT_PC) dheader(\n        <span class=\"string\">'?action=html&amp;reload='</span>.$DT_TIME);\n       </div>\n       <div class=\"line\">\t\t\t\n        <span class=\"keyword\">exit</span>(\n        <span class=\"string\">'{\"error\":1,\"message\":\"Error FILE\"}'</span>);\n       </div>\n       <div class=\"line\">\n        \t\t}\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">require</span> DT_ROOT.\n        <span class=\"string\">'/include/upload.class.php'</span>;\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">\n        \t\t$ext = file_ext($_FILES[\n        <span class=\"string\">'file'</span>][\n        <span class=\"string\">'name'</span>]);\n       </div>\n       <div class=\"line\">\n                $name = \n        <span class=\"string\">'avatar'</span>.$_userid.\n        <span class=\"string\">'.'</span>.$ext;\n       </div>\n       <div class=\"line\">\n        \t\t$file = DT_ROOT.\n        <span class=\"string\">'/file/temp/'</span>.$name;\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>(is_file($file)) file_del($file);\n       </div>\n       <div class=\"line\">\n                $upload = \n        <span class=\"keyword\">new</span> upload($_FILES, \n        <span class=\"string\">'file/temp/'</span>, $name, \n        <span class=\"string\">'jpg|jpeg|gif|png'</span>);\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">\n        \t\t$upload-&gt;adduserid = \n        <span class=\"keyword\">false</span>;\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>($upload-&gt;save()) {\n       </div>\n       <div class=\"line\">\n                    ...\n       </div>\n       <div class=\"line\">\n        \t\t} \n        <span class=\"keyword\">else</span> {\n       </div>\n       <div class=\"line\">\n                    ...\n       </div>\n       <div class=\"line\">\n        \t\t}\n       </div>\n       <div class=\"line\">\t\n        <span class=\"keyword\">break</span>;\n       </div></pre></td>\n    </tr>\n   </table>\n  </figure></br></p> \n<p>这里通过<code>$_FILES['file']</code>依次获取了上传文件扩展名<code>$ext</code>、保存临时文件名<code>$name</code>、保存临时文件完整路径<code>$file</code>变量。之后通过<code>new upload();</code>创立一个upload对象，等到<code>$upload-&gt;save()</code>时再将文件真正写入。</p> \n<p><code>upload</code>对象构造函数如下，include/upload.class.php:25：<br>\n  <figure class=\"highlight php\">\n   <table>\n    <tr>\n     <td class=\"gutter\"><pre>\n       <div class=\"line\">\n        1\n       </div>\n       <div class=\"line\">\n        2\n       </div>\n       <div class=\"line\">\n        3\n       </div>\n       <div class=\"line\">\n        4\n       </div>\n       <div class=\"line\">\n        5\n       </div>\n       <div class=\"line\">\n        6\n       </div>\n       <div class=\"line\">\n        7\n       </div>\n       <div class=\"line\">\n        8\n       </div>\n       <div class=\"line\">\n        9\n       </div>\n       <div class=\"line\">\n        10\n       </div>\n       <div class=\"line\">\n        11\n       </div>\n       <div class=\"line\">\n        12\n       </div>\n       <div class=\"line\">\n        13\n       </div>\n       <div class=\"line\">\n        14\n       </div>\n       <div class=\"line\">\n        15\n       </div>\n       <div class=\"line\">\n        16\n       </div>\n       <div class=\"line\">\n        17\n       </div>\n       <div class=\"line\">\n        18\n       </div>\n       <div class=\"line\">\n        19\n       </div>\n       <div class=\"line\">\n        20\n       </div></pre></td>\n     <td class=\"code\"><pre>\n       <div class=\"line\">\n        <span class=\"meta\">&lt;?php</span>\n       </div>\n       <div class=\"line\">\n        <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">upload</span> </span>{\n       </div>\n       <div class=\"line\">    \n        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">($_file, $savepath, $savename = <span class=\"string\">''</span>, $fileformat = <span class=\"string\">''</span>)</span> </span>{\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">global</span> $DT, $_userid;\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">foreach</span>($_file \n        <span class=\"keyword\">as</span> $file) {\n       </div>\n       <div class=\"line\">            \n        <span class=\"keyword\">$this</span>-&gt;file = $file[\n        <span class=\"string\">'tmp_name'</span>];\n       </div>\n       <div class=\"line\">            \n        <span class=\"keyword\">$this</span>-&gt;file_name = $file[\n        <span class=\"string\">'name'</span>];\n       </div>\n       <div class=\"line\">            \n        <span class=\"keyword\">$this</span>-&gt;file_size = $file[\n        <span class=\"string\">'size'</span>];\n       </div>\n       <div class=\"line\">            \n        <span class=\"keyword\">$this</span>-&gt;file_type = $file[\n        <span class=\"string\">'type'</span>];\n       </div>\n       <div class=\"line\">            \n        <span class=\"keyword\">$this</span>-&gt;file_error = $file[\n        <span class=\"string\">'error'</span>];\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">\n                }\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">$this</span>-&gt;userid = $_userid;\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">$this</span>-&gt;ext = file_ext(\n        <span class=\"keyword\">$this</span>-&gt;file_name);\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">$this</span>-&gt;fileformat = $fileformat ? $fileformat : $DT[\n        <span class=\"string\">'uploadtype'</span>];\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">$this</span>-&gt;maxsize = $DT[\n        <span class=\"string\">'uploadsize'</span>] ? $DT[\n        <span class=\"string\">'uploadsize'</span>]*\n        <span class=\"number\">1024</span> : \n        <span class=\"number\">2048</span>*\n        <span class=\"number\">1024</span>;\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">$this</span>-&gt;savepath = $savepath;\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">$this</span>-&gt;savename = $savename;\n       </div>\n       <div class=\"line\">\n            }\n       </div>\n       <div class=\"line\">\n        }\n       </div></pre></td>\n    </tr>\n   </table>\n  </figure></br></p> \n<p>这里通过<code>foreach($_file as $file)</code>来遍历初始化各项参数。而<code>savepath</code>、<code>savename</code>则是通过<code>__construct($_file, $savepath, $savename = '', $fileformat = '')</code>直接传入参数指定。</p> \n<p>因此考虑上传了两个文件，第一个文件名是<code>1.php</code>，第二个文件是<code>1.jpg</code>，只要构造合理的表单上传（参考：<a href=\"https://www.cnblogs.com/DeanChopper/p/4673577.html），则在avatar.inc.php中\" target=\"_blank\" rel=\"external\">https://www.cnblogs.com/DeanChopper/p/4673577.html），则在avatar.inc.php中</a><br>\n  <figure class=\"highlight php\">\n   <table>\n    <tr>\n     <td class=\"gutter\"><pre>\n       <div class=\"line\">\n        1\n       </div>\n       <div class=\"line\">\n        2\n       </div>\n       <div class=\"line\">\n        3\n       </div></pre></td>\n     <td class=\"code\"><pre>\n       <div class=\"line\">\n        $ext = file_ext($_FILES[\n        <span class=\"string\">'file'</span>][\n        <span class=\"string\">'name'</span>]); \n        <span class=\"comment\">// `$ext`即为`php` </span>\n       </div>\n       <div class=\"line\">\n        $name = \n        <span class=\"string\">'avatar'</span>.$_userid.\n        <span class=\"string\">'.'</span>.$ext; \n        <span class=\"comment\">// $name 为 'avatar'.$_userid.'.'php'</span>\n       </div>\n       <div class=\"line\">\n        $file = DT_ROOT.\n        <span class=\"string\">'/file/temp/'</span>.$name; \n        <span class=\"comment\">// $file 即为 xx/xx/xx/xx.php</span>\n       </div></pre></td>\n    </tr>\n   </table>\n  </figure></br></p> \n<p>而在<code>upload</code>类中，由于多个文件上传，<code>$this-&gt;file</code>、<code>$this-&gt;file_name</code>、<code>$this-&gt;file_type</code>将foreach在第二次循环中被置为jpg文件。测试如下：</p> \n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20180924092333-73ddb2be-bf98-1.jpeg\" alt=\"3.jpg\" /></p> \n<p>回到<code>avatar.inc.php</code>，当进行文件保存时调用<code>$upload-&gt;save()</code>，include/upload.class.php:50:<br>\n  <figure class=\"highlight php\">\n   <table>\n    <tr>\n     <td class=\"gutter\"><pre>\n       <div class=\"line\">\n        1\n       </div>\n       <div class=\"line\">\n        2\n       </div>\n       <div class=\"line\">\n        3\n       </div>\n       <div class=\"line\">\n        4\n       </div>\n       <div class=\"line\">\n        5\n       </div>\n       <div class=\"line\">\n        6\n       </div>\n       <div class=\"line\">\n        7\n       </div>\n       <div class=\"line\">\n        8\n       </div>\n       <div class=\"line\">\n        9\n       </div>\n       <div class=\"line\">\n        10\n       </div>\n       <div class=\"line\">\n        11\n       </div>\n       <div class=\"line\">\n        12\n       </div>\n       <div class=\"line\">\n        13\n       </div>\n       <div class=\"line\">\n        14\n       </div>\n       <div class=\"line\">\n        15\n       </div>\n       <div class=\"line\">\n        16\n       </div>\n       <div class=\"line\">\n        17\n       </div>\n       <div class=\"line\">\n        18\n       </div>\n       <div class=\"line\">\n        19\n       </div>\n       <div class=\"line\">\n        20\n       </div>\n       <div class=\"line\">\n        21\n       </div>\n       <div class=\"line\">\n        22\n       </div></pre></td>\n     <td class=\"code\"><pre>\n       <div class=\"line\">\n        <span class=\"meta\">&lt;?php</span>\n       </div>\n       <div class=\"line\">\n        <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">upload</span> </span>{\n       </div>\n       <div class=\"line\">\t\n        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">save</span><span class=\"params\">()</span> </span>{\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">include</span> load(\n        <span class=\"string\">'include.lang'</span>);\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">if</span>(\n        <span class=\"keyword\">$this</span>-&gt;file_error) \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">$this</span>-&gt;_(\n        <span class=\"string\">'Error(21)'</span>.$L[\n        <span class=\"string\">'upload_failed'</span>].\n        <span class=\"string\">' ('</span>.$L[\n        <span class=\"string\">'upload_error_'</span>.\n        <span class=\"keyword\">$this</span>-&gt;file_error].\n        <span class=\"string\">')'</span>);\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>(\n        <span class=\"keyword\">$this</span>-&gt;maxsize &gt; \n        <span class=\"number\">0</span> &amp;&amp; \n        <span class=\"keyword\">$this</span>-&gt;file_size &gt; \n        <span class=\"keyword\">$this</span>-&gt;maxsize) \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">$this</span>-&gt;_(\n        <span class=\"string\">'Error(22)'</span>.$L[\n        <span class=\"string\">'upload_size_limit'</span>].\n        <span class=\"string\">' ('</span>.intval(\n        <span class=\"keyword\">$this</span>-&gt;maxsize/\n        <span class=\"number\">1024</span>).\n        <span class=\"string\">'Kb)'</span>);\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">        \n        <span class=\"keyword\">if</span>(!\n        <span class=\"keyword\">$this</span>-&gt;is_allow()) \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">$this</span>-&gt;_(\n        <span class=\"string\">'Error(23)'</span>.$L[\n        <span class=\"string\">'upload_not_allow'</span>]);\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">        \n        <span class=\"keyword\">$this</span>-&gt;set_savepath(\n        <span class=\"keyword\">$this</span>-&gt;savepath);\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">$this</span>-&gt;set_savename(\n        <span class=\"keyword\">$this</span>-&gt;savename);\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">        \n        <span class=\"keyword\">if</span>(!is_writable(DT_ROOT.\n        <span class=\"string\">'/'</span>.\n        <span class=\"keyword\">$this</span>-&gt;savepath)) \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">$this</span>-&gt;_(\n        <span class=\"string\">'Error(24)'</span>.$L[\n        <span class=\"string\">'upload_unwritable'</span>]);\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>(!is_uploaded_file(\n        <span class=\"keyword\">$this</span>-&gt;file)) \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">$this</span>-&gt;_(\n        <span class=\"string\">'Error(25)'</span>.$L[\n        <span class=\"string\">'upload_failed'</span>]);\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>(!move_uploaded_file(\n        <span class=\"keyword\">$this</span>-&gt;file, DT_ROOT.\n        <span class=\"string\">'/'</span>.\n        <span class=\"keyword\">$this</span>-&gt;saveto)) \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">$this</span>-&gt;_(\n        <span class=\"string\">'Error(26)'</span>.$L[\n        <span class=\"string\">'upload_failed'</span>]);\n       </div>\n       <div class=\"line\"></div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">$this</span>-&gt;image = \n        <span class=\"keyword\">$this</span>-&gt;is_image();\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>(DT_CHMOD) @chmod(DT_ROOT.\n        <span class=\"string\">'/'</span>.\n        <span class=\"keyword\">$this</span>-&gt;saveto, DT_CHMOD);\n       </div>\n       <div class=\"line\">        \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">true</span>;\n       </div>\n       <div class=\"line\">\n            }\n       </div>\n       <div class=\"line\">\n        }\n       </div></pre></td>\n    </tr>\n   </table>\n  </figure></br></p> \n<p>先经过几个基本参数的检查，然后调用<code>$this-&gt;is_allow()</code>来进行安全检查 include/upload.class.php:72：<br>\n  <figure class=\"highlight php\">\n   <table>\n    <tr>\n     <td class=\"gutter\"><pre>\n       <div class=\"line\">\n        1\n       </div>\n       <div class=\"line\">\n        2\n       </div>\n       <div class=\"line\">\n        3\n       </div>\n       <div class=\"line\">\n        4\n       </div>\n       <div class=\"line\">\n        5\n       </div>\n       <div class=\"line\">\n        6\n       </div>\n       <div class=\"line\">\n        7\n       </div></pre></td>\n     <td class=\"code\"><pre>\n       <div class=\"line\">\n        <span class=\"meta\">&lt;?php</span>\n       </div>\n       <div class=\"line\">    \n        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">is_allow</span><span class=\"params\">()</span> </span>{\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>(!\n        <span class=\"keyword\">$this</span>-&gt;fileformat) \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">false</span>;\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>(!preg_match(\n        <span class=\"string\">\"/^(\"</span>.\n        <span class=\"keyword\">$this</span>-&gt;fileformat.\n        <span class=\"string\">\")$/i\"</span>, \n        <span class=\"keyword\">$this</span>-&gt;ext)) \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">false</span>;\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">if</span>(preg_match(\n        <span class=\"string\">\"/^(php|phtml|php3|php4|jsp|exe|dll|cer|shtml|shtm|asp|asa|aspx|asax|ashx|cgi|fcgi|pl)$/i\"</span>, \n        <span class=\"keyword\">$this</span>-&gt;ext)) \n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">false</span>;\n       </div>\n       <div class=\"line\">\t\t\n        <span class=\"keyword\">return</span> \n        <span class=\"keyword\">true</span>;\n       </div>\n       <div class=\"line\">\n            }\n       </div></pre></td>\n    </tr>\n   </table>\n  </figure></br></p> \n<p>可以看到这里仅仅对<code>$this-&gt;ext</code>进行了检查，如前此时<code>$this-&gt;ext</code>为<code>jpg</code>，检查通过。</p> \n<p>接着会进行真正的保存。通过<code>$this-&gt;set_savepath($this-&gt;savepath); $this-&gt;set_savename($this-&gt;savename);</code>设置了<code>$this-&gt;saveto</code>，然后通过<code>move_uploaded_file($this-&gt;file, DT_ROOT.'/'.$this-&gt;saveto)</code>将<code>file</code>保存到<code>$this-&gt;saveto</code> ，注意此时的<code>savepath</code>、<code>savename</code>、<code>saveto</code>均以php为后缀，而<code>$this-&gt;file</code>实际指的是第二个jpg文件。</p> \n<h1 id=\"漏洞利用\"><a href=\"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#漏洞利用\" class=\"headerlink\" title=\"漏洞利用\"></a>漏洞利用</h1>\n<p>综上，上传两个文件，其中第一个文件以php为结尾如<code>1.php</code>，用于设置后缀名为<code>php</code>；第二个文件为<code>1.jpg</code>，jpg用于绕过检测，其内容为php一句话木马(图片马)。</p> \n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20180924092339-77516058-bf98-1.gif\" alt=\"4.gif\" /></p> \n<p>然后访问<a href=\"http://127.0.0.1/file/temp/avatar1.php\" target=\"_blank\" rel=\"external\">http://127.0.0.1/file/temp/avatar1.php</a> 即可。其中<code>1</code>是自己的<code>_userid</code></p> \n<p>不过实际利用上会有一定的限制。</p> \n<p>第一点是destoon使用了伪静态规则，限制了file目录下php文件的执行。</p> \n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20180924092418-8e9ce5f2-bf98-1.jpeg\" alt=\"5.jpg\" /></p> \n<p>第二点是avatar.inc.php中在<code>$upload-&gt;save()</code>后，会再次对文件进行检查，然后重命名为<code>xx.jpg</code>：<br>\n  <figure class=\"highlight php\">\n   <table>\n    <tr>\n     <td class=\"gutter\"><pre>\n       <div class=\"line\">\n        1\n       </div>\n       <div class=\"line\">\n        2\n       </div>\n       <div class=\"line\">\n        3\n       </div>\n       <div class=\"line\">\n        4\n       </div>\n       <div class=\"line\">\n        5\n       </div>\n       <div class=\"line\">\n        6\n       </div>\n       <div class=\"line\">\n        7\n       </div>\n       <div class=\"line\">\n        8\n       </div>\n       <div class=\"line\">\n        9\n       </div>\n       <div class=\"line\">\n        10\n       </div>\n       <div class=\"line\">\n        11\n       </div>\n       <div class=\"line\">\n        12\n       </div>\n       <div class=\"line\">\n        13\n       </div></pre></td>\n     <td class=\"code\"><pre>\n       <div class=\"line\">\n        省略...\n       </div>\n       <div class=\"line\">\n        $img = \n        <span class=\"keyword\">array</span>();\n       </div>\n       <div class=\"line\">\n        $img[\n        <span class=\"number\">1</span>] = $dir.\n        <span class=\"string\">'.jpg'</span>;\n       </div>\n       <div class=\"line\">\n        $img[\n        <span class=\"number\">2</span>] = $dir.\n        <span class=\"string\">'x48.jpg'</span>;\n       </div>\n       <div class=\"line\">\n        $img[\n        <span class=\"number\">3</span>] = $dir.\n        <span class=\"string\">'x20.jpg'</span>;\n       </div>\n       <div class=\"line\">\n        $md5 = md5($_username);\n       </div>\n       <div class=\"line\">\n        $dir = DT_ROOT.\n        <span class=\"string\">'/file/avatar/'</span>.substr($md5, \n        <span class=\"number\">0</span>, \n        <span class=\"number\">2</span>).\n        <span class=\"string\">'/'</span>.substr($md5, \n        <span class=\"number\">2</span>, \n        <span class=\"number\">2</span>).\n        <span class=\"string\">'/_'</span>.$_username;\n       </div>\n       <div class=\"line\">\n        $img[\n        <span class=\"number\">4</span>] = $dir.\n        <span class=\"string\">'.jpg'</span>;\n       </div>\n       <div class=\"line\">\n        $img[\n        <span class=\"number\">5</span>] = $dir.\n        <span class=\"string\">'x48.jpg'</span>;\n       </div>\n       <div class=\"line\">\n        $img[\n        <span class=\"number\">6</span>] = $dir.\n        <span class=\"string\">'x20.jpg'</span>;\n       </div>\n       <div class=\"line\">\n        file_copy($file, $img[\n        <span class=\"number\">1</span>]);\n       </div>\n       <div class=\"line\">\n        file_copy($file, $img[\n        <span class=\"number\">4</span>]);\n       </div>\n       <div class=\"line\">\n        省略...\n       </div></pre></td>\n    </tr>\n   </table>\n  </figure></br></p> \n<p>因此要利用成功就需要条件竞争了。</p> \n<h1 id=\"补丁分析\"><a href=\"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#补丁分析\" class=\"headerlink\" title=\"补丁分析\"></a>补丁分析</h1>\n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20180924092426-939b4a4e-bf98-1.jpeg\" alt=\"7.jpg\" /></p> \n<p>在upload的一开始，就进行一次后缀名的检查。其中is_image如下：<br>\n  <figure class=\"highlight php\">\n   <table>\n    <tr>\n     <td class=\"gutter\"><pre>\n       <div class=\"line\">\n        1\n       </div>\n       <div class=\"line\">\n        2\n       </div>\n       <div class=\"line\">\n        3\n       </div></pre></td>\n     <td class=\"code\"><pre>\n       <div class=\"line\">\n        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">is_image</span><span class=\"params\">($file)</span> </span>{\n       </div>\n       <div class=\"line\">\t\n        <span class=\"keyword\">return</span> preg_match(\n        <span class=\"string\">\"/^(jpg|jpeg|gif|png|bmp)$/i\"</span>, file_ext($file));\n       </div>\n       <div class=\"line\">\n        }\n       </div></pre></td>\n    </tr>\n   </table>\n  </figure></br></p> \n<p><img src=\"https://xzfile.aliyuncs.com/media/upload/picture/20180924092431-96846556-bf98-1.jpeg\" alt=\"6.jpg\" /></p> \n<p>在<code>__construct()</code>的foreach中使用了break，获取了第一个文件后就跳出循环。</p> \n<p>在<code>is_allow()</code>中增加对<code>$this-&gt;savename</code>的二次检查。</p> \n<h1 id=\"最后\"><a href=\"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1>\n<p>嘛，祝各位大师傅中秋快乐！</p>","descriptionType":"html","publishedDate":"Mon, 24 Sep 2018 05:29:01 +0000","feedId":30884,"bgimg":"https://xzfile.aliyuncs.com/media/upload/picture/20180924092323-6e1898c6-bf98-1.jpeg","linkMd5":"d81f591ff275cb69808c84fbfa003ae4","destWidth":1025,"destHeight":662,"sourceBytes":355860,"destBytes":66978,"author":"","articleImgCdnMap":{"https://xzfile.aliyuncs.com/media/upload/picture/20180924092323-6e1898c6-bf98-1.jpeg":null,"https://xzfile.aliyuncs.com/media/upload/picture/20180924092327-70161496-bf98-1.jpeg":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn68@2020_6/2020/10/20/04-27-58-831_c50986d60a3c7fee.webp","https://xzfile.aliyuncs.com/media/upload/picture/20180924092333-73ddb2be-bf98-1.jpeg":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn56@2020_3/2020/10/20/04-28-03-472_5ec877894285680a.webp","https://xzfile.aliyuncs.com/media/upload/picture/20180924092339-77516058-bf98-1.gif":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn50@2020_6/2020/10/20/04-28-10-014_798bfbd97bb196c5.webp","https://xzfile.aliyuncs.com/media/upload/picture/20180924092418-8e9ce5f2-bf98-1.jpeg":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn59@2020_5/2020/10/20/04-28-00-434_dbe4998ac42ccef5.webp","https://xzfile.aliyuncs.com/media/upload/picture/20180924092426-939b4a4e-bf98-1.jpeg":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn47@2020_1/2020/10/20/04-27-59-952_46075493ca571982.webp","https://xzfile.aliyuncs.com/media/upload/picture/20180924092431-96846556-bf98-1.jpeg":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn64@2020_1/2020/10/20/04-28-02-527_91e2c6bbf9ba478f.webp"},"publishedOrCreatedDate":1603168062726}],"record":{"createdTime":"2020-10-20 12:27:42","updatedTime":"2020-10-20 12:27:42","feedId":30884,"fetchDate":"Tue, 20 Oct 2020 04:27:42 +0000","fetchMs":149,"handleMs":33,"totalMs":29146,"newArticles":0,"totalArticles":20,"status":1,"type":0,"ip":"6adc9ee180e15d93daf6364a5c318f90","hostName":"us-53*","requestId":"8b3a95fca82545bbbd43182f52e62cac_30884","contentType":"application/xml","totalBytes":637350,"bgimgsTotal":1,"bgimgsGithubTotal":0,"articlesImgsTotal":7,"articlesImgsGithubTotal":6,"successGithubMap":{"myreaderx8":1,"myreaderx32":1,"myreaderx33":1,"myreaderx2":1,"myreaderx24":1,"myreaderx5oss":1},"failGithubMap":{"myreaderx14":1}},"feed":{"createdTime":"2020-09-07 02:51:03","updatedTime":"2020-09-07 04:58:07","id":30884,"name":"Chybeta","url":"https://chybeta.github.io/atom.xml","subscriber":104,"website":null,"icon":"http://chybeta.github.io/favicon.ico?v=5.1.0","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx62/cdn36@2020_5/2020/09/06/20-58-06-242_68b9b22daa1d74c5.ico","description":"","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2020-10-20 12:28:11","updatedTime":"2020-10-20 12:28:11","id":null,"feedId":30884,"linkMd5":"d81f591ff275cb69808c84fbfa003ae4"}],"tmpCommonImgCdnBytes":0,"tmpBodyImgCdnBytes":637350,"tmpBgImgCdnBytes":0,"extra4":{"start":1603168062534,"total":0,"statList":[{"spend":159,"msg":"获取xml内容"},{"spend":33,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":16667,"msg":"正文链接上传到cdn"}]},"extra5":7,"extra6":7,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"https://xzfile.aliyuncs.com/media/upload/picture/20180924092323-6e1898c6-bf98-1.jpeg","sourceStatusCode":200,"destWidth":1025,"destHeight":662,"sourceBytes":355860,"destBytes":66978,"targetWebpQuality":75,"feedId":30884,"totalSpendMs":6228,"convertSpendMs":79,"createdTime":"2020-10-20 12:27:42","host":"us-033*","referer":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/","linkMd5ListStr":"d81f591ff275cb69808c84fbfa003ae4,d81f591ff275cb69808c84fbfa003ae4","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx14/cdn37/contents/2020/10/20/04-27-48-914_04127edad1ac9135.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 68584859.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Tue, 20 Oct 2020 04:27:48 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["B82A:798B:179AF7:34C40E:5F8E6740"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, read:packages, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1603170270"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx14/cdn37/contents/2020/10/20/04-27-48-914_04127edad1ac9135.webp","historyStatusCode":[],"spendMs":53},"base64UserPassword":null,"token":"6b67d******************************91b08"},"githubUser":"myreaderx14","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"347.5 KB","destSize":"65.4 KB","compressRate":"18.8%"},{"code":1,"isDone":false,"source":"https://xzfile.aliyuncs.com/media/upload/picture/20180924092323-6e1898c6-bf98-1.jpeg","sourceStatusCode":200,"destWidth":1025,"destHeight":662,"sourceBytes":355860,"destBytes":66978,"targetWebpQuality":75,"feedId":30884,"totalSpendMs":6025,"convertSpendMs":60,"createdTime":"2020-10-20 12:27:48","host":"us-033*","referer":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/","linkMd5ListStr":"d81f591ff275cb69808c84fbfa003ae4,d81f591ff275cb69808c84fbfa003ae4","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx14/cdn37/contents/2020/10/20/04-27-54-960_04127edad1ac9135.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 68584859.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Tue, 20 Oct 2020 04:27:54 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["B82A:798B:179C6D:34C80A:5F8E6747"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, read:packages, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1603170270"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx14/cdn37/contents/2020/10/20/04-27-54-960_04127edad1ac9135.webp","historyStatusCode":[],"spendMs":40},"base64UserPassword":null,"token":"6b67d******************************91b08"},"githubUser":"myreaderx14","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"347.5 KB","destSize":"65.4 KB","compressRate":"18.8%"}],"extra10_invalidATagHrefValue":{"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/_#漏洞利用":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#漏洞利用","http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/_#最后":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#最后","http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/_#漏洞分析":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#漏洞分析","http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/_#前言":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#前言","http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/_#补丁分析":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/#补丁分析"},"extra111_proxyServerAndStatMap":{"http://us-038.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-23.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe61.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-22.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-014.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-026.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://xzfile.aliyuncs.com/media/upload/picture/20180924092327-70161496-bf98-1.jpeg","sourceStatusCode":200,"destWidth":812,"destHeight":330,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn68@2020_6/2020/10/20/04-27-58-831_c50986d60a3c7fee.webp","sourceBytes":127568,"destBytes":58636,"targetWebpQuality":75,"feedId":30884,"totalSpendMs":4663,"convertSpendMs":26,"createdTime":"2020-10-20 12:27:55","host":"us-014*","referer":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/","linkMd5ListStr":"d81f591ff275cb69808c84fbfa003ae4","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"124.6 KB","destSize":"57.3 KB","compressRate":"46%"},{"code":1,"isDone":false,"source":"https://xzfile.aliyuncs.com/media/upload/picture/20180924092426-939b4a4e-bf98-1.jpeg","sourceStatusCode":200,"destWidth":1475,"destHeight":414,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn47@2020_1/2020/10/20/04-27-59-952_46075493ca571982.webp","sourceBytes":202030,"destBytes":75208,"targetWebpQuality":75,"feedId":30884,"totalSpendMs":6237,"convertSpendMs":56,"createdTime":"2020-10-20 12:27:55","host":"europe-23*","referer":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/","linkMd5ListStr":"d81f591ff275cb69808c84fbfa003ae4","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"197.3 KB","destSize":"73.4 KB","compressRate":"37.2%"},{"code":1,"isDone":false,"source":"https://xzfile.aliyuncs.com/media/upload/picture/20180924092418-8e9ce5f2-bf98-1.jpeg","sourceStatusCode":200,"destWidth":837,"destHeight":363,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn59@2020_5/2020/10/20/04-28-00-434_dbe4998ac42ccef5.webp","sourceBytes":280397,"destBytes":74490,"targetWebpQuality":75,"feedId":30884,"totalSpendMs":6379,"convertSpendMs":38,"createdTime":"2020-10-20 12:27:55","host":"us-038*","referer":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/","linkMd5ListStr":"d81f591ff275cb69808c84fbfa003ae4","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"273.8 KB","destSize":"72.7 KB","compressRate":"26.6%"},{"code":1,"isDone":false,"source":"https://xzfile.aliyuncs.com/media/upload/picture/20180924092431-96846556-bf98-1.jpeg","sourceStatusCode":200,"destWidth":1475,"destHeight":781,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn64@2020_1/2020/10/20/04-28-02-527_91e2c6bbf9ba478f.webp","sourceBytes":441049,"destBytes":91366,"targetWebpQuality":75,"feedId":30884,"totalSpendMs":8576,"convertSpendMs":365,"createdTime":"2020-10-20 12:27:55","host":"us-026*","referer":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/","linkMd5ListStr":"d81f591ff275cb69808c84fbfa003ae4","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"430.7 KB","destSize":"89.2 KB","compressRate":"20.7%"},{"code":1,"isDone":false,"source":"https://xzfile.aliyuncs.com/media/upload/picture/20180924092333-73ddb2be-bf98-1.jpeg","sourceStatusCode":200,"destWidth":1153,"destHeight":640,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn56@2020_3/2020/10/20/04-28-03-472_5ec877894285680a.webp","sourceBytes":586692,"destBytes":96726,"targetWebpQuality":75,"feedId":30884,"totalSpendMs":9898,"convertSpendMs":72,"createdTime":"2020-10-20 12:27:55","host":"europe61*","referer":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/","linkMd5ListStr":"d81f591ff275cb69808c84fbfa003ae4","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"572.9 KB","destSize":"94.5 KB","compressRate":"16.5%"},{"code":1,"isDone":false,"source":"https://xzfile.aliyuncs.com/media/upload/picture/20180924092339-77516058-bf98-1.gif","sourceStatusCode":200,"destWidth":1542,"destHeight":932,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn50@2020_6/2020/10/20/04-28-10-014_798bfbd97bb196c5.webp","sourceBytes":273901,"destBytes":240924,"targetWebpQuality":75,"feedId":30884,"totalSpendMs":16516,"convertSpendMs":8310,"createdTime":"2020-10-20 12:27:55","host":"europe-22*","referer":"http://chybeta.github.io/2018/09/24/Destoon-20180827版本-前台getshell/","linkMd5ListStr":"d81f591ff275cb69808c84fbfa003ae4","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"267.5 KB","destSize":"235.3 KB","compressRate":"88%"}],"successGithubMap":{"myreaderx8":1,"myreaderx32":1,"myreaderx33":1,"myreaderx2":1,"myreaderx24":1,"myreaderx5oss":1},"failGithubMap":{"myreaderx14":1}}