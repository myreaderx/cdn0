{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2021-04-03 13:28:06","updatedTime":"2021-04-03 13:28:06","title":"Web 应用高并发的思考与实践","link":"http://cdc.tencent.com/?p=11450","description":"<img src='http://cdc.tencent.com/wp-content/uploads/2021/03/banner@2x1.jpg' alt='Web 应用高并发的思考与实践' />\n<br />\n<h2>一、前言</h2>\n<p>2020 年初，突如其来的疫情使各行各业都进入紧张状态，互联网产品也各尽其能投入到战“疫”中。健康信息收集是抗疫过程中最基础的工作之一，腾讯问卷平台结合其信息采集、统计分析的特性，快速迭代出“健康打卡”“复学码”等功能。</p>\n<p>然而，健康码关系着用户能否正常进出社区、公司或校园，计算的时效性和准确性必须有保证。加之用户量大、打卡时间点集中，在开发时间和资源都紧张的情况下，我们是如何应对访问高并发、数据量陡增，从而保障系统的稳定？</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/2-197/\" rel=\"attachment wp-att-11452\"><img loading=\"lazy\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/2.png\" alt=\"图 1\" width=\"1268\" height=\"418\" /></a></p>\n<p style=\"text-align: center;\">图 1</p>\n<p>本文结合腾讯问卷后台的优化和改造工作，记录过程中的思考，整理提升 Web 应用负载能力的关注点。作为一个刚接触海量用户场景的小白，希望借此跟大家交流探讨。</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/1-212/\" rel=\"attachment wp-att-11451\"><img loading=\"lazy\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/1.png\" alt=\"图 2\" width=\"1269\" height=\"509\" /></a></p>\n<p style=\"text-align: center;\">图 2</p>\n<p>实践围绕图2的四个点，从被动到主动，从发现到治理。这几个方法远远谈不上全面，但可能是短时间内性价比最高的实践。</p>\n<p>&#160;</p>\n<h2>二、思考</h2>\n<h3>1. 理解和关注高并发</h3>\n<h4>1.1 What &#38; Why</h4>\n<p>“高并发（High Concurrency）通常是指，通过设计保证系统能够同时并行处理很多请求”&#8230;&#8230;Web 应用需求变更快，需要持续改进、持续运营以应对潜在的用户量突增。</p>\n<p>Web 应用负载能力不足会有怎样的表现？</p>\n<ul>\n<li>速度慢</li>\n</ul>\n<p>比如打开页面持续 loading/白屏，需要等待或者重新进入，给用户带来很差的使用体验。</p>\n<ul>\n<li>系统奔溃</li>\n</ul>\n<p>系统崩溃可能表现在服务无响应、组件不可用、用户数据丢失等。在问卷系统中假设用户提交的数据丢失，健康码会因为中断打卡由绿变红，给用户带来困扰，同时也给开发运维带来修复的工作量。</p>\n<p>所幸通过项目组的合力改造，系统的抗压能力提升了一个数量级。但也引发了新的思考，假如我们的系统要支持更高的并发，如何复盘当前的工作，以及准备下一步的工作？</p>\n<p>图3借用《海量运维、运营规划之道》一书中的负载与架构演进图：</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/3-182/\" rel=\"attachment wp-att-11453\"><img loading=\"lazy\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/3.png\" alt=\"图 3\" width=\"1270\" height=\"486\" /></a></p>\n<p style=\"text-align: center;\">图 3</p>\n<p>作者认为，Web 架构的生命周期要求我们要杜绝过度设计，又要保证前瞻性。而在实践中我也形成了一种认知，高并发是相对而不是绝对的，在业务每个阶段都需要有敏捷支持相对于前一阶段更高负载的能力，做性价比最高的事情。</p>\n<h4>1.2 Who</h4>\n<p>作为应用开发我也曾陷入这样的误区，认为高并发是架构设计师、运维工程师才需要考虑的事情，实践中发现项目组的各个角色都可以为高并发能力做点什么。</p>\n<ul>\n<li>产品策划和交互设计</li>\n</ul>\n<p>当一个功能被设计出来时，就可以预见是否存在高并发瓶颈，通过一些产品策略或者交互方式的转变，往往能缓解问题。</p>\n<p style=\"text-align: center;\"><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/4-166/\" rel=\"attachment wp-att-11454\"><img loading=\"lazy\" class=\"aligncenter\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/4.png\" alt=\"图 4\" width=\"994\" height=\"158\" /></a></p>\n<p style=\"text-align: center;\">图 4</p>\n<p>比如在“健康打卡”这个功能点，以往设计了在每天早上七点推送提醒，无形中给系统制造了高并发的场景，实际上推送的时间点可以交给客户设置、并且分散到不同时间段，从而合理利用机器资源。</p>\n<ul>\n<li>开发人员</li>\n</ul>\n<p>即使架构师设计了良好的分布式方案、运维工程师保障了系统能稳定扩容，负载的瓶颈还会是被开发人员“制造”出来（更别提在我们的业务每个人都身兼数职）。后续的案例也可以体现开发在支持高并发过程中的职责。</p>\n<h3>2. 理解和关注业务</h3>\n<h4>2.1 When</h4>\n<p>什么时候需要重点关注业务的并发能力？最好的时间点当然是在设计之初，但往往我们是中途加入项目，下表中这几个时机可以作为参考：<a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/17-50/\" rel=\"attachment wp-att-11467\"><img loading=\"lazy\" class=\"aligncenter size-full wp-image-11467\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/17.png\" alt=\"\" width=\"1394\" height=\"392\" srcset=\"https://cdc.tencent.com/wp-content/uploads/2021/03/17.png 1394w, https://cdc.tencent.com/wp-content/uploads/2021/03/17-768x216.png 768w\" sizes=\"(max-width: 1394px) 100vw, 1394px\" /></a></p>\n<p>软件熵这里可以做一个简单的科普，熵是一个来自物理学的概念，指的是某个系统中的 “无序” 的总量，当软件中的无序增长时，我们称之为“软件腐烂”。</p>\n<p>图5中举了个例子，问卷中有个打卡统计功能，在开发的初期只需要展示谁没有打卡，重实现轻设计。在逐渐新增交叉分析、筛选等功能，以及在修过几次统计不准确的 Bug 后，打卡统计越来越耗性能，以致于在并发量高时耗尽计算资源而挂掉。</p>\n<p style=\"text-align: center;\"><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/5-155/\" rel=\"attachment wp-att-11455\"><img loading=\"lazy\" class=\"aligncenter\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/5.png\" alt=\"图 5\" width=\"1266\" height=\"556\" /></a></p>\n<p style=\"text-align: center;\">图 5</p>\n<p>所有的问题都是建立在历史问题的基础上，往往这个时候对问题的处理就没有第一个版本那么完美。实践的经验是代码开始腐烂的位置往往也是存在高并发风险的位置。这时候就需要尽早关注。</p>\n<h4>2.2 Where</h4>\n<p>“设计一个大型高并发网站的架构，首先必须以了解业务特点作为出发点，架构的目的是支撑业务”&#8230;&#8230;</p>\n<p>Web 应用的架构往往并不复杂，在项目中我们主要关注两个方面：</p>\n<p>1)流量链路</p>\n<ul>\n<li>负载均衡</li>\n<li>网络连通</li>\n</ul>\n<p style=\"text-align: center;\"><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/6-136/\" rel=\"attachment wp-att-11456\"><img loading=\"lazy\" class=\"aligncenter\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/6.png\" alt=\"图 6\" width=\"1268\" height=\"624\" /></a></p>\n<p style=\"text-align: center;\">图 6</p>\n<p>2)业务架构</p>\n<ul>\n<li>组件的选型是否合理</li>\n<li>依赖的服务是否稳定</li>\n</ul>\n<p style=\"text-align: center;\"><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/7-122/\" rel=\"attachment wp-att-11457\"><img loading=\"lazy\" class=\"aligncenter\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/7.png\" alt=\"图 7\" width=\"776\" height=\"526\" /></a></p>\n<p style=\"text-align: center;\">图 7</p>\n<p>图7粗略展示了腾讯问卷的技术栈，实践中其中某一个环节出问题都可能导致负载提升不上去，后文也将围绕各个环节来做分析。</p>\n<h2></h2>\n<h2>三、实践</h2>\n<h3>1. 洞察</h3>\n<h4>1.1 监控</h4>\n<p>监控是为了第一时间发现、定位并记录异常。当前腾讯问卷系统虽谈不上立体化，但也在不断完善，保证了从业务层、系统层、网络层都有迹可循。</p>\n<p style=\"text-align: center;\"><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/8-117/\" rel=\"attachment wp-att-11458\"><img loading=\"lazy\" class=\"aligncenter\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/8.png\" alt=\"图 8\" width=\"1266\" height=\"469\" /></a></p>\n<p style=\"text-align: center;\">图 8</p>\n<p>1.1.1 监控的指标选择</p>\n<p>监控时我们往往最关注两个内容：时间和行为(路径)，例如在应用层，左图记录了任务执行的耗时，右图记录了在任务执行过程中经历了哪些事件，二者结合便于判断性能的瓶颈、或者 bug 潜在的位置。同理对前端、对接入层也用了类似的指标。</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/9-108/\" rel=\"attachment wp-att-11459\"><img loading=\"lazy\" class=\"aligncenter size-full wp-image-11459\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/9.png\" alt=\"图 9\" width=\"2766\" height=\"948\" srcset=\"https://cdc.tencent.com/wp-content/uploads/2021/03/9.png 2766w, https://cdc.tencent.com/wp-content/uploads/2021/03/9-768x263.png 768w, https://cdc.tencent.com/wp-content/uploads/2021/03/9-1536x526.png 1536w, https://cdc.tencent.com/wp-content/uploads/2021/03/9-2048x702.png 2048w\" sizes=\"(max-width: 2766px) 100vw, 2766px\" /></a></p>\n<p style=\"text-align: center;\">图 9</p>\n<p>1.1.2 监控的呈现</p>\n<p>接下来是把指标可视化，将关键日志进行聚合，利用 Dashboard 呈现。</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/10-121/\" rel=\"attachment wp-att-11460\"><img loading=\"lazy\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/10.png\" alt=\"图 10\" width=\"1269\" height=\"328\" /></a></p>\n<p style=\"text-align: center;\">图 10</p>\n<p>1.1.3 监控的监控</p>\n<p>在异常爆发时，自建的监控系统在也会接收大量的上报，如果监控系统自己都挂掉了，对业务的监控也就失去意义，因此对监控系统也需要做保护，例如对错误上报做限流、对监控做额外的健康探测等。</p>\n<h4>1.2 压测</h4>\n<p>1.2.1 预测</p>\n<ul>\n<li>预估可能存在的瓶颈位</li>\n</ul>\n<p>各个位置的带宽是否跑满?</p>\n<p>组件的 CPU 或者内存使用率是过高?</p>\n<p>业务机的 CPU 或者是磁盘 IO 是否跑满?</p>\n<p>&#160;</p>\n<ul>\n<li>预设目标</li>\n</ul>\n<p>需求角度出发：实际总用户量可能是多少？同时会有多少人使用(打卡)功能？</p>\n<p>现状角度出发：想达到的目标是当前负载能力的 5 倍？10 倍？</p>\n<p>1.2.2 实施</p>\n<p>我们常会使用 apache bench(简称ab) 测试接口，但到业务场景中，单接口的压测有局限性。在测试同学的带领下我们尝试了 Locust。</p>\n<ul>\n<li>如何模拟用户并发</li>\n</ul>\n<p>&#160;</p>\n<p>首先要理解一个用户同时发起一万次请求，跟一万个用户同时发起一次请求，对系统造成的压力是不一样的。实测过程中我们预留了一千万个 ID 用于模拟真实用户，同时避免测试数据难以清理。</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/11-109/\" rel=\"attachment wp-att-11461\"><img loading=\"lazy\" class=\"aligncenter\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/11.png\" alt=\"图 11\" width=\"1454\" height=\"622\" /></a></p>\n<p style=\"text-align: center;\">图 11</p>\n<ul>\n<li>如何模拟行为并发</li>\n</ul>\n<p>这里先介绍一个用户使用问卷进行打卡的流程：打开问卷链接-&#62;登录-&#62;答题-&#62;提交答案。也就是说一个打卡场景实际涉及多个请求，在做压测的时候我们尽可能还原。在写完每个接口的测试方法后，Locust 可以使用 TaskSet 进行任务组合，并且支持权重配比。这个比例正好可以从我们的流量监控获得。</p>\n<p>&#160;</p>\n<p>&#160;</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/12-97/\" rel=\"attachment wp-att-11462\"><img loading=\"lazy\" class=\"aligncenter\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/12.png\" alt=\"图 12\" width=\"2832\" height=\"1157\" /></a></p>\n<p style=\"text-align: center;\">图 12</p>\n<p>1.2.3 定位瓶颈</p>\n<p>压测的目的是在于找到系统的瓶颈，一定是要确定系统某个方面达到瓶颈了，压力测试才算是基本完成&#8230;</p>\n<ul>\n<li>纵向：按流量链路逐层“断点” 回顾系统的链路，流量从前端到接入层、再到应用层、缓存层、存储层，每个环节都有被“撑爆”风险。只有逐层排查和改造，才能了解到链路中潜在的瓶颈位。</li>\n</ul>\n<p>案例 1. 流量被前端拦住，并没有到后台</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/14-72/\" rel=\"attachment wp-att-11464\"><img loading=\"lazy\" class=\"aligncenter size-full wp-image-11464\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/14.png\" alt=\"图 13\" width=\"2659\" height=\"734\" srcset=\"https://cdc.tencent.com/wp-content/uploads/2021/03/14.png 2659w, https://cdc.tencent.com/wp-content/uploads/2021/03/14-768x212.png 768w, https://cdc.tencent.com/wp-content/uploads/2021/03/14-1536x424.png 1536w, https://cdc.tencent.com/wp-content/uploads/2021/03/14-2048x565.png 2048w\" sizes=\"(max-width: 2659px) 100vw, 2659px\" /></a></p>\n<p style=\"text-align: center;\">图 13</p>\n<p>案例 2. 缓存层带宽不足</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/15-70/\" rel=\"attachment wp-att-11465\"><img loading=\"lazy\" class=\"aligncenter size-full wp-image-11465\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/15.png\" alt=\"图 14\" width=\"2302\" height=\"790\" srcset=\"https://cdc.tencent.com/wp-content/uploads/2021/03/15.png 2302w, https://cdc.tencent.com/wp-content/uploads/2021/03/15-768x264.png 768w, https://cdc.tencent.com/wp-content/uploads/2021/03/15-1536x527.png 1536w, https://cdc.tencent.com/wp-content/uploads/2021/03/15-2048x703.png 2048w\" sizes=\"(max-width: 2302px) 100vw, 2302px\" /></a></p>\n<p style=\"text-align: center;\">图 14</p>\n<ul>\n<li>横向：对照实验 经过逐层压测，系统的性能瓶颈定位到 MySQL 上，这也符合我们对业务的认知，因为系统重度依赖数据库并且缺乏针对性的优化。但是数据库的读写来源有接口服务和任务队列，我们采用了对照实验，调整 fpm worker 与 queue worker 数量比例，表格记录每一轮测试的效果，进而判断是哪个影响更大</li>\n</ul>\n<p>1.2.4 压测小结</p>\n<p>压力测试不仅是孤立测试各个软硬件的性能指标，而是要尽可能模拟真实的业务场景，从而充分评估系统上线后可能发生的情况，同时也为我们后续制定问题应对措施、制定改造计划提供了依据。</p>\n<h3>2. 响应</h3>\n<h4>2.1 扩容</h4>\n<p>当用户量开始增多，现有系统无法处理那么大访问流量，最快速的响应方案是扩容。但是你的系统真的能快速扩容吗?</p>\n<p>2.1.1 扩容的方式</p>\n<ul>\n<li>垂直扩展</li>\n</ul>\n<p>软件上，通过调参能否充分利用硬件资源</p>\n<p>硬件上，是否有升配的能力</p>\n<ul>\n<li>水平扩展</li>\n</ul>\n<p>业务服务器加机器</p>\n<p>组件集群加节点/分片</p>\n<p>2.1.2 怎样支持扩容</p>\n<p>对于老业务，我们往往要先解决怎样支持扩容的问题。</p>\n<ul>\n<li>解耦 业务中依赖了大量的公司内部服务，但由于网络策略或安全因素，它们影响了业务的扩容能力。实践中我们把这些依赖剥离出来，通过代理等形式，形成了局部单体、整体可扩容的架构。</li>\n<li>上云 以往的单体应用架构制约了扩容能力：比如需要在应用层加一台物理机，需要从装系统开始做起；给 MongoDB 加一个节点，需要大量的运维操作。借助云服务的灵活性可以大大提高系统的扩容能力。</li>\n</ul>\n<p>腾讯问卷上云主要包括以下三个方面：</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/18-39/\" rel=\"attachment wp-att-11468\"><img loading=\"lazy\" class=\"aligncenter size-full wp-image-11468\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/18.png\" alt=\"\" width=\"1380\" height=\"326\" srcset=\"https://cdc.tencent.com/wp-content/uploads/2021/03/18.png 1380w, https://cdc.tencent.com/wp-content/uploads/2021/03/18-768x181.png 768w\" sizes=\"(max-width: 1380px) 100vw, 1380px\" /></a></p>\n<p>在上云过程中多多少少会踩坑，这里暂不展开讨论，后续再开新篇深度记录。</p>\n<p>2.1.3 扩容还需要注意什么</p>\n<ul>\n<li>依赖的组件是否会扛不住</li>\n<li>依赖的远程服务是否会因为扩容被拖垮</li>\n</ul>\n<p>在压测过程中可能会在测试环境 Mock 掉一些远程请求，导致在线上扩容业务服务后，问题才暴露出来，需要引以为戒。</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/15-70/\" rel=\"attachment wp-att-11465\"><img loading=\"lazy\" class=\"aligncenter\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/15.png\" alt=\"图 15\" width=\"2302\" height=\"790\" /></a></p>\n<p style=\"text-align: center;\">图 15</p>\n<p>显示了在并发量逐步上升的过程中，QPS 出现下降再上升的情况，排查发现是依赖的远程服务容量不足导致的性能下降，所以在压测过程中不能仅关注系统本身。</p>\n<h4>2.2 优化</h4>\n<p>扩容往往只是一种缓解措施，从运维的角度提升了系统的负载能力，但随之而来的是服务器成本的上升，我们需要通过改造和优化使资源的利用更合理。</p>\n<p>2.2.1 关注代码逻辑</p>\n<ul>\n<li>慢执行</li>\n</ul>\n<p>为了功能快速上线，我们往往忽略了代码里耗时的方法和逻辑，当大量请求涌入，慢执行就会阻塞后续的请求，拖慢系统的其他接口，甚至造成雪崩。</p>\n<p>CPU 密集型的比如 web 应用常会防止 xss 攻击，一般会用正则过滤标签，在面对大文本、高并发、或者是循环的时候，都会大量占用 CPU，使业务服务器的压力上升。</p>\n<p>IO 密集型的比如上传下载文件时过度扫描目录，任务的大部分时间都在等待 IO 操作完成，响应时间变长，这时候业务服务器的 CPU 使用率不高，而磁盘读写压力大。</p>\n<p>对于PHP接口通过记录和查询 fpm_slow_log 可以分析耗时的方法。同时我们把慢执行数量进行监控，在新功能上线时需要密切关注。</p>\n<ul>\n<li>慢查询</li>\n</ul>\n<p>无论是在生产环境还是压测过程，造成 MySQL 压力的很多情况是大量的慢查询，通过查 slow_log 或者从腾讯云管理后台可以进行慢查询分析。</p>\n<p>很多资料都会提到使用索引来提升查询速度（先抛开I/O、锁这些不讲），然而即使有索引也可能踩坑。比如 “隐式类型转换” 的问题在腾讯问卷系统中就存在。</p>\n<p><a href=\"http://cdc.tencent.com/2021/03/15/web-%e5%ba%94%e7%94%a8%e9%ab%98%e5%b9%b6%e5%8f%91%e7%9a%84%e6%80%9d%e8%80%83%e4%b8%8e%e5%ae%9e%e8%b7%b5/16-59/\" rel=\"attachment wp-att-11466\"><img loading=\"lazy\" class=\"aligncenter\" src=\"http://cdc.tencent.com/wp-content/uploads/2021/03/16.png\" alt=\"图 16\" width=\"1267\" height=\"224\" /></a></p>\n<p style=\"text-align: center;\">图 16</p>\n<p>MySQL 会根据需要自动将数字转换为字符串，比如 openid 为 varchar 类型，当使用 where openid=123456 的查找时，实际进行了全表扫描，解决方案是查询前在代码中做转换，或者使用 CAST 方法转换。</p>\n<p>2.2.2 合理使用组件</p>\n<ul>\n<li>是否有性能更高的替代</li>\n</ul>\n<p>专业的事情交给专业的人干，在组件选型同样适用。在改造过程中，Elasticsearch 组件的引入，减少了在 MySQL 做搜索或聚合，提高了前面案例提到的打卡统计的计算能力。</p>\n<ul>\n<li>是否有更低成本的替代</li>\n</ul>\n<p>Web 应用在使用缓存时，往往不注意容量和带宽的成本，回顾前面的压力测试，我们发现将大量的问卷静态数据存在 Redis 后，Redis 很快成为负载瓶颈，实际上只需要稍加改造，就可以找到合适的存储替代。</p>\n<h2></h2>\n<h2>四、小结与展望</h2>\n<p>本文整理了 Web 应用高并发改造过程中的一些关注点，实际上每个加粗的小点都应该展开来更深入地探讨，提供对比方案和详细效果。但作为开发的我往往感觉到，自己不缺乏解决单个问题的能力，而缺乏系统性思维和全局观，本文也算是为高并发实践记录一些思路和方向，后续应继续补充完善。</p>\n<p>回顾这段时间的改造效果，在使用资源不到两倍的情况下实现了5-10倍的负载能力，并且使继续扩容成为可能。虽然我们用效率最高的手段，让系统顺利支持了疫情期间的并发量，但如果要实现十倍甚至百倍的负载能力，当前的工作必定是不够的，或许更完善的分布式架构、或者当前火热的微服务架构，是我们系统下一步的考虑方向。</p>\n<p>&#160;</p>\n<p>&#160;</p>\n<p data-darkmode-bgcolor-16153827266038=\"rgb(25, 25, 25)\" data-darkmode-original-bgcolor-16153827266038=\"#fff|rgb(255, 255, 255)\" data-style=\"white-space: normal; max-width: 100%; font-family: -apple-system-font, BlinkMacSystemFont, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;\">\n","descriptionType":"html","publishedDate":"Mon, 15 Mar 2021 10:56:22 +0000","feedId":6150,"bgimg":"http://cdc.tencent.com/wp-content/uploads/2021/03/banner@2x1.jpg","linkMd5":"c4dba7e42e6121f0edcbd1dabe89867f","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn27@2020_6/2021/04/03/05-28-13-579_0063058b9d87adae.webp","destWidth":1440,"destHeight":510,"sourceBytes":225958,"destBytes":69380,"author":"Jeter","articleImgCdnMap":{"http://cdc.tencent.com/wp-content/uploads/2021/03/banner@2x1.jpg":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn27@2020_6/2021/04/03/05-28-13-579_0063058b9d87adae.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/2.png":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn62@2020_6/2021/04/03/05-28-21-192_075faad327fdeda5.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/1.png":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn51@2020_4/2021/04/03/05-28-17-651_61a94d0bb339e29f.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/3.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn39@2020_6/2021/04/03/05-28-24-292_b1a0781bbb22dbcc.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/4.png":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn64@2020_2/2021/04/03/05-28-18-236_86422ad5d170af98.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/17.png":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn98@2020_4/2021/04/03/05-28-18-766_130199d3a7719e3d.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/5.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn58@2020_5/2021/04/03/05-28-19-808_92fae661bc82fd3b.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/6.png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn47@2020_4/2021/04/03/05-28-17-833_110929ed2604f7fa.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/7.png":null,"http://cdc.tencent.com/wp-content/uploads/2021/03/8.png":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn79@2020_2/2021/04/03/05-29-19-725_3a5fb75275153a2a.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/9.png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn75@2020_3/2021/04/03/05-28-21-151_f7cdcaec0cfc2690.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/10.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn55@2020_1/2021/04/03/05-28-19-176_c070a5483fdc46d3.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/11.png":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn73@2020_6/2021/04/03/05-28-17-397_859e988a996e611e.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/12.png":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn77@2020_5/2021/04/03/05-28-22-535_ddadcfc5ab1324ea.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/14.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn70@2020_2/2021/04/03/05-28-19-023_7ebf96b1a8023f08.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/15.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn89@2020_5/2021/04/03/05-28-17-749_891e5f0368d065e9.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/18.png":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn93@2020_6/2021/04/03/05-28-20-739_bedb0b74ca6e008e.webp","http://cdc.tencent.com/wp-content/uploads/2021/03/16.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn86@2020_6/2021/04/03/05-28-18-712_59bd4a86e1c3e413.webp"},"publishedOrCreatedDate":1617427686990}],"record":{"createdTime":"2021-04-03 13:28:06","updatedTime":"2021-04-03 13:28:06","feedId":6150,"fetchDate":"Sat, 03 Apr 2021 05:28:06 +0000","fetchMs":5269,"handleMs":174,"totalMs":80659,"newArticles":0,"totalArticles":16,"status":1,"type":0,"ip":"11ba7afd62496d78a715fbed802c0b13","hostName":"us-030*","requestId":"bbed132749c84e66b9e89593b28433f5_6150","contentType":"application/rss+xml; charset=UTF-8","totalBytes":759336,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":18,"articlesImgsGithubTotal":17,"successGithubMap":{"myreaderx8":1,"myreaderx15":1,"myreaderx16":1,"myreaderx6":1,"myreaderx4":1,"myreaderx10":1,"myreaderx3":1,"myreaderx2":1,"myreaderx12":1,"myreaderx1":1,"myreaderx24":1,"myreaderx13":1,"myreaderx5oss":1,"myreaderx31":1,"myreaderx18":1,"myreaderx29":1,"myreaderx19":1},"failGithubMap":{"myreaderx14":1}},"feed":{"createdTime":"2020-08-25 04:32:50","updatedTime":"2020-09-05 15:20:28","id":6150,"name":"腾讯CDC","url":"http://cdc.tencent.com/feed/","subscriber":null,"website":null,"icon":"https://cdc.tencent.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx62/cdn46@2020_5/2020/09/05/07-20-28-121_6a3b74a664fa412c.ico","description":"","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2021-04-03 13:29:20","updatedTime":"2021-04-03 13:29:20","id":null,"feedId":6150,"linkMd5":"c4dba7e42e6121f0edcbd1dabe89867f"}],"tmpCommonImgCdnBytes":69380,"tmpBodyImgCdnBytes":689956,"tmpBgImgCdnBytes":0,"extra4":{"start":1617427679389,"total":0,"statList":[{"spend":7428,"msg":"获取xml内容"},{"spend":174,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":66164,"msg":"正文链接上传到cdn"}]},"extra5":18,"extra6":18,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/7.png","sourceStatusCode":200,"destWidth":776,"destHeight":526,"sourceBytes":161673,"destBytes":28272,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":4316,"convertSpendMs":29,"createdTime":"2021-04-03 13:28:14","host":"europe67*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx14/cdn43/contents/2021/04/03/05-28-18-369_de1604bbec8db509.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 68584859.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Sat, 03 Apr 2021 05:28:18 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["94FE:697C:11B013C:1222BBF:6067FCF2"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1617428942"],"x-ratelimit-used":["67"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx14/cdn43/contents/2021/04/03/05-28-18-369_de1604bbec8db509.webp","historyStatusCode":[],"spendMs":320},"base64UserPassword":null,"token":"6b67d******************************91b08"},"githubUser":"myreaderx14","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"157.9 KB","destSize":"27.6 KB","compressRate":"17.5%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/7.png","sourceStatusCode":200,"destWidth":776,"destHeight":526,"sourceBytes":161673,"destBytes":28272,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":5245,"convertSpendMs":25,"createdTime":"2021-04-03 13:28:18","host":"us-003*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx14/cdn43/contents/2021/04/03/05-28-23-931_de1604bbec8db509.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 68584859.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Sat, 03 Apr 2021 05:28:23 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["D19A:18FD:F63F25:1B44245:6067FCF7"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1617428942"],"x-ratelimit-used":["67"],"x-xss-protection":["0"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx14/cdn43/contents/2021/04/03/05-28-23-931_de1604bbec8db509.webp","historyStatusCode":[],"spendMs":31},"base64UserPassword":null,"token":"6b67d******************************91b08"},"githubUser":"myreaderx14","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"157.9 KB","destSize":"27.6 KB","compressRate":"17.5%"},null],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-013.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-55.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-007.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-002.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-58.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-60.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-038.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-025.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-001.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-036.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-033.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-004.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://europe-57.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-59.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-003.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://europe67.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/banner@2x1.jpg","sourceStatusCode":200,"destWidth":1440,"destHeight":510,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn27@2020_6/2021/04/03/05-28-13-579_0063058b9d87adae.webp","sourceBytes":225958,"destBytes":69380,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":6790,"convertSpendMs":93,"createdTime":"2021-04-03 13:28:07","host":"us-51*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f,c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"220.7 KB","destSize":"67.8 KB","compressRate":"30.7%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/11.png","sourceStatusCode":200,"destWidth":1454,"destHeight":622,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn73@2020_6/2021/04/03/05-28-17-397_859e988a996e611e.webp","sourceBytes":148183,"destBytes":18936,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":3481,"convertSpendMs":48,"createdTime":"2021-04-03 13:28:14","host":"us-003*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"144.7 KB","destSize":"18.5 KB","compressRate":"12.8%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/1.png","sourceStatusCode":200,"destWidth":1269,"destHeight":509,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn51@2020_4/2021/04/03/05-28-17-651_61a94d0bb339e29f.webp","sourceBytes":44628,"destBytes":10642,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":3723,"convertSpendMs":54,"createdTime":"2021-04-03 13:28:14","host":"us-033*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43.6 KB","destSize":"10.4 KB","compressRate":"23.8%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/15.png","sourceStatusCode":200,"destWidth":2302,"destHeight":790,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn89@2020_5/2021/04/03/05-28-17-749_891e5f0368d065e9.webp","sourceBytes":346058,"destBytes":69684,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":3857,"convertSpendMs":77,"createdTime":"2021-04-03 13:28:14","host":"us-025*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f,c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"337.9 KB","destSize":"68.1 KB","compressRate":"20.1%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/6.png","sourceStatusCode":200,"destWidth":1268,"destHeight":624,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn47@2020_4/2021/04/03/05-28-17-833_110929ed2604f7fa.webp","sourceBytes":132093,"destBytes":31392,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":3976,"convertSpendMs":34,"createdTime":"2021-04-03 13:28:14","host":"us-55*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"129 KB","destSize":"30.7 KB","compressRate":"23.8%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/4.png","sourceStatusCode":200,"destWidth":994,"destHeight":158,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn64@2020_2/2021/04/03/05-28-18-236_86422ad5d170af98.webp","sourceBytes":24839,"destBytes":3940,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":4448,"convertSpendMs":7,"createdTime":"2021-04-03 13:28:14","host":"europe-58*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"24.3 KB","destSize":"3.8 KB","compressRate":"15.9%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/16.png","sourceStatusCode":200,"destWidth":1267,"destHeight":224,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn86@2020_6/2021/04/03/05-28-18-712_59bd4a86e1c3e413.webp","sourceBytes":55471,"destBytes":19948,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":3756,"convertSpendMs":43,"createdTime":"2021-04-03 13:28:15","host":"us-038*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"54.2 KB","destSize":"19.5 KB","compressRate":"36%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/17.png","sourceStatusCode":200,"destWidth":1394,"destHeight":392,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn98@2020_4/2021/04/03/05-28-18-766_130199d3a7719e3d.webp","sourceBytes":70977,"destBytes":34764,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":4846,"convertSpendMs":29,"createdTime":"2021-04-03 13:28:14","host":"us-001*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"69.3 KB","destSize":"33.9 KB","compressRate":"49%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/14.png","sourceStatusCode":200,"destWidth":2659,"destHeight":734,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn70@2020_2/2021/04/03/05-28-19-023_7ebf96b1a8023f08.webp","sourceBytes":2115418,"destBytes":90442,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":5118,"convertSpendMs":342,"createdTime":"2021-04-03 13:28:14","host":"us-036*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"2 MB","destSize":"88.3 KB","compressRate":"4.3%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/10.png","sourceStatusCode":200,"destWidth":1269,"destHeight":328,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn55@2020_1/2021/04/03/05-28-19-176_c070a5483fdc46d3.webp","sourceBytes":276377,"destBytes":22970,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":5235,"convertSpendMs":68,"createdTime":"2021-04-03 13:28:14","host":"us-004*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"269.9 KB","destSize":"22.4 KB","compressRate":"8.3%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/5.png","sourceStatusCode":200,"destWidth":1266,"destHeight":556,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn58@2020_5/2021/04/03/05-28-19-808_92fae661bc82fd3b.webp","sourceBytes":337860,"destBytes":28318,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":5816,"convertSpendMs":38,"createdTime":"2021-04-03 13:28:14","host":"us-007*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"329.9 KB","destSize":"27.7 KB","compressRate":"8.4%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/18.png","sourceStatusCode":200,"destWidth":1380,"destHeight":326,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn93@2020_6/2021/04/03/05-28-20-739_bedb0b74ca6e008e.webp","sourceBytes":60874,"destBytes":31074,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":6887,"convertSpendMs":95,"createdTime":"2021-04-03 13:28:14","host":"us-013*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"59.4 KB","destSize":"30.3 KB","compressRate":"51%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/9.png","sourceStatusCode":200,"destWidth":2766,"destHeight":948,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn75@2020_3/2021/04/03/05-28-21-151_f7cdcaec0cfc2690.webp","sourceBytes":1390053,"destBytes":94170,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":7187,"convertSpendMs":343,"createdTime":"2021-04-03 13:28:14","host":"us-002*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.3 MB","destSize":"92 KB","compressRate":"6.8%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/2.png","sourceStatusCode":200,"destWidth":1268,"destHeight":418,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn62@2020_6/2021/04/03/05-28-21-192_075faad327fdeda5.webp","sourceBytes":259968,"destBytes":21538,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":7352,"convertSpendMs":71,"createdTime":"2021-04-03 13:28:14","host":"europe-57*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"253.9 KB","destSize":"21 KB","compressRate":"8.3%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/12.png","sourceStatusCode":200,"destWidth":2832,"destHeight":1157,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn77@2020_5/2021/04/03/05-28-22-535_ddadcfc5ab1324ea.webp","sourceBytes":3498899,"destBytes":167158,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":7635,"convertSpendMs":243,"createdTime":"2021-04-03 13:28:16","host":"europe-60*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.3 MB","destSize":"163.2 KB","compressRate":"4.8%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/3.png","sourceStatusCode":200,"destWidth":1270,"destHeight":486,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn39@2020_6/2021/04/03/05-28-24-292_b1a0781bbb22dbcc.webp","sourceBytes":407124,"destBytes":14858,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":10353,"convertSpendMs":96,"createdTime":"2021-04-03 13:28:14","host":"us-004*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"397.6 KB","destSize":"14.5 KB","compressRate":"3.6%"},{"code":1,"isDone":false,"source":"http://cdc.tencent.com/wp-content/uploads/2021/03/8.png","sourceStatusCode":200,"destWidth":1266,"destHeight":469,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn79@2020_2/2021/04/03/05-29-19-725_3a5fb75275153a2a.webp","sourceBytes":147743,"destBytes":30122,"targetWebpQuality":75,"feedId":6150,"totalSpendMs":4180,"convertSpendMs":59,"createdTime":"2021-04-03 13:29:15","host":"us-033*","referer":"http://cdc.tencent.com/?p=11450","linkMd5ListStr":"c4dba7e42e6121f0edcbd1dabe89867f","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"144.3 KB","destSize":"29.4 KB","compressRate":"20.4%"}],"successGithubMap":{"myreaderx8":1,"myreaderx15":1,"myreaderx16":1,"myreaderx6":1,"myreaderx4":1,"myreaderx10":1,"myreaderx3":1,"myreaderx2":1,"myreaderx12":1,"myreaderx1":1,"myreaderx24":1,"myreaderx13":1,"myreaderx5oss":1,"myreaderx31":1,"myreaderx18":1,"myreaderx29":1,"myreaderx19":1},"failGithubMap":{"myreaderx14":1}}