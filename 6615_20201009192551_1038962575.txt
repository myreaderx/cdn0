{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-10 03:25:34","updatedTime":"2020-10-10 03:25:34","title":"「React」如何在React中优雅的实现动画","link":"https://segmentfault.com/a/1190000030696292","description":"<h2>最简单的动画组件实现</h2>\n<p>动画的本质，无非就是一个状态样式到另一个状态样式的过渡。最简单的动画组件，我们只需要指定两个状态的样式（进入的样式，离开的样式），以及一个开关（控制状态），即可完成。</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696295\" alt=\"animate.png\" title=\"animate.png\" /></p>\n<p><a href=\"https://codepen.io/peoplesing1832/pen/BaKERLX\" rel=\"nofollow noreferrer\">codepen地址</a></p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696297\" alt=\"animate.gif\" title=\"animate.gif\" /></p>\n<h2>实现一组动画的过渡</h2>\n<p>实现一组动画的过渡。我们只需要在多个最简单的动画组件的基础之上，设置一个统一的开关，统一控制，多个动画组件动画的状态即可。如果想实现有交错的过渡（有时间间隔的过渡），我们只需要根据动画组件在一组元素中的索引位置，设置合适的延迟即可。</p>\n<p>为了引入统一的开关的控制，我们为动画组件添加一个父级组件，父级组件的开关控制所有子组件的开关状态。父组件使用React.Context将自己开关的状态，下发给子组件。</p>\n<p>为了实现交错效果，我们需要为列表中子组件设置不同长度的延迟。延迟时长和子组件在列表索引，以及开关的状态有关。</p>\n<p>比如:</p>\n<p>在开关设置为true, 需要显示入场的动画。延迟自上而下，依次增大（0ms, 100ms, 200ms, 300ms）</p>\n<p>在开关设置为false, 需要显示出场的动画。延迟自上而下，依次减小（300ms, 200ms, 100ms, 0ms）</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696296\" alt=\"animates1.png\" title=\"animates1.png\" /></p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696298\" alt=\"animates2.png\" title=\"animates2.png\" /></p>\n<p><a href=\"https://codepen.io/peoplesing1832/pen/rNebRxv\" rel=\"nofollow noreferrer\">codepen地址</a></p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696300\" alt=\"animates.gif\" title=\"animates.gif\" /></p>\n<h2>上述组件目前存在的问题</h2>\n<ol>\n <li>节点必须事先已经渲染好，对于动态插入的节点，这些动画组件无能为力。(在下方我们参考了<code>`react-transition-group</code>实现解决这个问题)</li>\n <li>如果元素起始样式有<code>display: none</code>动画将不会起效果（这个问题其实和动态插入节点属于一类问题）。</li>\n <li>对于一组列表节点。新的节点的插入，和删除时。其他节点的过渡很生硬，没有动画效果(我们可以使用flip动画解决这个问题)。</li>\n</ol>\n<h2>FLIP动画</h2>\n<p>FLIP动画实现原理是: <strong>缓存元素起点的位置, 然后将元素置于终点的位置，计算终点与起点的差值，根据差值应用动画。</strong></p>\n<p>我们先看看flip动画强大的效果</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696299\" alt=\"效果1.gif\" title=\"效果1.gif\" /></p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696301\" alt=\"效果2.gif\" title=\"效果2.gif\" /></p>\n<p>接下来，我们来一步一步实现一个简易的flip动画，然后再尝试在react中实现。</p>\n<h3>闪烁</h3>\n<p>请问下面的代码，会造成闪烁的问题吗？</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696302\" alt=\"flip1.png\" title=\"flip1.png\" /></p>\n<p><a href=\"https://codepen.io/peoplesing1832/pen/mdPaGKY\" rel=\"nofollow noreferrer\">codepen演示</a></p>\n<p><strong>答案: 是不会。</strong>具体原因和浏览器的事件队列有关。点击事件的代码，我们必须执行完成当前的任务（当前代码段的执行）才会进行浏览器渲染。</p>\n<p>这一点对我们很重要。再重申一遍flip动画的原理，<strong>缓存元素起点的位置, 然后将元素置于终点的位置，计算终点与起点的差值，根据差值应用动画。</strong></p>\n<h3>雏形</h3>\n<p>然后基于上面的代码，我们目前可以实现一个简易的flip动画</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696304\" alt=\"flip2.png\" title=\"flip2.png\" /></p>\n<p><a href=\"https://codepen.io/peoplesing1832/pen/mdPaoBq\" rel=\"nofollow noreferrer\">codepen演示</a></p>\n<p>我们可以看到，动画已经实现，但是目前动画的计算还是固定的，我们接下来尝试让它自动化。</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696303\" alt=\"fli3.gif\" title=\"fli3.gif\" /></p>\n<h3>完善</h3>\n<p>我们尝试对, 之前状态和当前状态的属性,做自动的差值计算。</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696306\" alt=\"flip3.png\" title=\"flip3.png\" /></p>\n<p><a href=\"https://codepen.io/peoplesing1832/pen/PoNXgbL\" rel=\"nofollow noreferrer\">codepen演示</a></p>\n<p>我们目前已经实现了，宽度和x轴的flip动画。</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696305\" alt=\"flip4.gif\" title=\"flip4.gif\" /></p>\n<h4>🤔️为什么要这样计算（之前的位置 - 现在的位置）?</h4>\n<blockquote>\n 我们为什么要使用之前的样式值减去当前的样式值？\n</blockquote>\n<p>FLIP动画的原理是基于当前位置和起始位置的动画，我们在做动画的时候，元素其实已经到达了结束的位置。</p>\n<p>比如当前的位置是100px, 开始位置是0px。flip动画需要模拟从0px到100px的过程，但是当前位置已经是100px了，所以我们必须使用 <code>translateX(0 - 100px)</code>, 模拟动画开始时的0px的位置。</p>\n<h3>100ms</h3>\n<blockquote>\n There is a window of 100ms after someone interacts with your site where you’re able to do work without them noticing.\n</blockquote>\n<p>使用flip动画时，切记计算不能超过100ms，如果超过100ms用户会感到卡顿。</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696313\" alt=\"100ms.jpg\" title=\"100ms.jpg\" /></p>\n<h3>FLIP 与 Web Animations API</h3>\n<p>目前距离实现一个真正的flip动画库还有不少的距离。继续使用 requestAnimationFrame 会很困难，太复杂了。</p>\n<p>既然flip动画，是基于结束位置和开始位置的动画，那么有没有什么好办法，不需要我们手动的去调整。只需要提供初始位置和结束位置完成动画呢？我们可以使用Web Animations API。</p>\n<p>对于 Web Animations API本身，我在这里不想做过多的介绍。大家只需要知道，使用Web Animations API后，我们只需要设置开始的样式，和结束的样式，动画就会自动完成。</p>\n<p>我们将上面的demo，改造成使用Web Animations API的形式。</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696307\" alt=\"flip5.png\" title=\"flip5.png\" /></p>\n<p><a href=\"https://codepen.io/peoplesing1832/pen/gOrqRPR\" rel=\"nofollow noreferrer\">codepen演示</a></p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696308\" alt=\"flip6.gif\" title=\"flip6.gif\" /></p>\n<p>可以看到，我们在代码里只需要设置开始和结束的样式，动画就会自动过渡完成。</p>\n<h3>React 与 FLIP</h3>\n<p>如何在react中完成flip动画呢？我们首先回忆下在js中flip动画的逻辑</p>\n<ol>\n <li>缓存元素起始位置</li>\n <li>将元素移动到结束的位置</li>\n <li>获取当前的位置，并计算当前的位置与缓存的起始位置的差值。</li>\n <li>下一帧开始时，开始做动画</li>\n</ol>\n<p>我们可以发现，第1，2，3步都是发生在渲染到屏幕之前(或者说渲染到屏幕的那一刻)。那么在react中，有什么hook发生在渲染到页面的那一刻呢？答案是: 函数组件中是<code>useLayoutEffect</code>。class组件中是<code>componentDidUpdate</code></p>\n<p>我们整理下在react中flip动画的实现逻辑</p>\n<ol>\n <li>在页面第一次useEffect, 元素渲染完成。这时同时缓存元素的位置。</li>\n <li>state发生变化，组件需要重新渲染</li>\n <li>在组件重新渲染到屏幕那一刻，在<code>useLayoutEffect</code>中，我们获取最新的位置。并计算当前的位置与缓存的起始位置的差值。</li>\n <li>动画开始执行</li>\n</ol>\n<p>那么接下来我们来实现一个react中flip的雏形</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696309\" alt=\"flip7.png\" title=\"flip7.png\" /></p>\n<p><a href=\"https://codepen.io/peoplesing1832/pen/gOrqVjE\" rel=\"nofollow noreferrer\">codepen演示</a></p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696310\" alt=\"flip8.gif\" title=\"flip8.gif\" /></p>\n<p>bigo!我们成功在react中实现了flip动画</p>\n<h4>❓ 目前存在的问题</h4>\n<p>如果我们在flip动画运行过程中，切换动画。动画会出现闪烁，我们现在来着手解决这个问题。</p>\n<p>我们先来思考一下这个问题产生的原因。动画在运行过程中，还没有到达终点，这时切换动画，动画元素会被强行移动到终点的位置，然后进行下一次动画，这就是动画闪烁的原因。</p>\n<p>如何解决呢？</p>\n<ol>\n <li>在切换动画的时候，如果上一次动画没有结束，我们手动将其结束</li>\n <li>在切换动画的时候，更新位置的缓存。</li>\n</ol>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696311\" alt=\"flip8.png\" title=\"flip8.png\" /></p>\n<p><a href=\"https://codepen.io/peoplesing1832/pen/VwaRZXo\" rel=\"nofollow noreferrer\">codepen演示</a></p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696312\" alt=\"flip9.gif\" title=\"flip9.gif\" /></p>\n<p>虽然目前已经实现flip动画的效果，但是距离封装成可用的库还有些距离，如果大家想要了解的更多，可以查看我封装好的源码（原理和上面的文章是一模一样的）。仓库地址: <a href=\"https://github.com/peoplesing1832/react-flip-transition\" rel=\"nofollow noreferrer\">https://github.com/peoplesing...</a></p>\n<h4>🚧 Flip动画需要注意的点</h4>\n<ol>\n <li>flip计算动画位置时，元素上最好不要有transition的css属性，会影响到位置的计算。</li>\n <li>之前的计算缓存位置时，都是相对于body的位置。但是如果存在有滚动条时，缓存的位置会有问题。解决办法是，基于动画元素的父级元素计算位置，而不是body的位置。</li>\n</ol>\n<h3>Flip如何实现交错效果？</h3>\n<p>好吧。目前我的库中，交错效果的完善解决方案还没有实现。但是主体思路是有了，并有了简易的实现版本 见下方👇</p>\n<p><img src=\"https://segmentfault.com/img/remote/1460000030696314\" alt=\"效果3.gif\" title=\"效果3.gif\" /></p>\n<h2>🔍🔍🔍 动态插入节点的动画处理</h2>\n<p>这个问题解决的思路，我参考了 <code>react-transition-group</code>库 的源码。在这里我说一下，<code>react-transition-group</code>库 实现的思路。</p>\n<pre><code class=\"jsx\">\n&lt;react-transition-group&gt;\n  {\n    list &amp;&amp; list.map((item) =&gt; (\n      &lt;react-transition&gt;\n        { item }\n      &lt;/react-transition&gt;\n    ))\n  }\n&lt;react-transition-group&gt;</code></pre>\n<p>最外层的 <code>&lt;react-transition-group&gt;</code> 组件 并不会直接对嵌入的children进行直接渲染。而是将props.children保存为，组件的内部状态state。这样我们可以在children渲染之前，对state做一些额外的操作。</p>\n<p><code>&lt;react-transition-group&gt;</code>会对于动态插入的节点，不会直接渲染。而是先将，新插入节点外层的<code>&lt;react-transition&gt;</code>组件的动画状态设置为'Leave'态（这里处理的目的是，即使dom渲染完成后，元素也是隐藏的状态）。然后在<code>&lt;react-transition&gt;</code>中，会先等待dom渲染完成，然后再将动画的状态设置为'Entering'，完成'Leave'态到'Entering'态的动画过渡。</p>\n<p><code>&lt;react-transition-group&gt;</code>会对于动态删除的节点，不会直接删除。而是先将需要删除节点外层的<code>&lt;react-transition&gt;</code>组件的动画开关设置为false，动画开始向'Leave'态过渡。动画过渡完成后，然后会触发<code>&lt;react-transition&gt;</code>组件的 <code>onLeave</code> 事件。在 <code>onLeave</code> 事件中会删除dom节点。</p>\n<p>总结一下 <code>react-transition-group</code> 库的处理方式：</p>\n<ol>\n <li>插入的节点，先渲染dom，然后再做动画</li>\n <li>删除的节点，先做动画，然后再删除dom</li>\n</ol>\n<h2>写在最后</h2>\n<p>如果您对我的文章感到满意，还请麻烦您给我的文章点一个赞。如果您喜欢我的小项目，还请帮我的小项目点一个star。谢谢🙏</p>\n<p>项目地址：<a href=\"https://github.com/peoplesing1832/react-flip-transition\" rel=\"nofollow noreferrer\">https://github.com/peoplesing...</a></p>\n<h2>参考</h2>\n<ul>\n <li><a href=\"https://github.com/reactjs/react-transition-group\" rel=\"nofollow noreferrer\">react-transition-group源码</a></li>\n <li><a href=\"https://aerotwist.com/blog/flip-your-animations/\" rel=\"nofollow noreferrer\">FLIP Your Animations</a></li>\n</ul>","descriptionType":"html","publishedDate":"Fri, 09 Oct 2020 07:17:23 +0000","feedId":6615,"bgimg":"https://segmentfault.com/img/remote/1460000030696295","linkMd5":"24b89d8c02574abc1e8ee49ea010a4ff","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn19@2020_1/2020/10/09/19-25-45-524_5f95eb535d42159c.webp","destWidth":800,"destHeight":419,"sourceBytes":37502,"destBytes":37502,"author":"张越","articleImgCdnMap":{"https://segmentfault.com/img/remote/1460000030696295":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn19@2020_1/2020/10/09/19-25-45-524_5f95eb535d42159c.webp","https://segmentfault.com/img/remote/1460000030696297":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn91@2020_6/2020/10/09/19-25-49-543_5a4cf42f1b971737.webp","https://segmentfault.com/img/remote/1460000030696296":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn83@2020_1/2020/10/09/19-25-50-035_939b79d1239ef22c.webp","https://segmentfault.com/img/remote/1460000030696298":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn88@2020_6/2020/10/09/19-25-49-398_4b9dae1bdbd7550f.webp","https://segmentfault.com/img/remote/1460000030696300":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn33@2020_4/2020/10/09/19-25-49-194_a0adbade89df6900.webp","https://segmentfault.com/img/remote/1460000030696299":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn80@2020_6/2020/10/09/19-25-49-864_667d9949b3fdb3ed.webp","https://segmentfault.com/img/remote/1460000030696301":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn37@2020_3/2020/10/09/19-25-49-435_6fb3d0646863cebf.webp","https://segmentfault.com/img/remote/1460000030696302":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn35@2020_2/2020/10/09/19-25-49-071_12c660edc11b7531.webp","https://segmentfault.com/img/remote/1460000030696304":null,"https://segmentfault.com/img/remote/1460000030696303":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn27@2020_2/2020/10/09/19-25-49-540_2b1d5e9ae42b15a2.webp","https://segmentfault.com/img/remote/1460000030696306":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn30@2020_6/2020/10/09/19-25-49-850_b20e418fa57fc9ec.webp","https://segmentfault.com/img/remote/1460000030696305":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn32@2020_1/2020/10/09/19-25-49-521_174957a22e271d44.webp","https://segmentfault.com/img/remote/1460000030696313":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn59@2020_1/2020/10/09/19-25-49-978_86f1ba9ece2c1f36.webp","https://segmentfault.com/img/remote/1460000030696307":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn71@2020_2/2020/10/09/19-25-48-993_132b82355e99d370.webp","https://segmentfault.com/img/remote/1460000030696308":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn67@2020_5/2020/10/09/19-25-49-200_5747571b1d1c4306.webp","https://segmentfault.com/img/remote/1460000030696309":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn76@2020_3/2020/10/09/19-25-49-367_622d2fa813c2449c.webp","https://segmentfault.com/img/remote/1460000030696310":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn55@2020_3/2020/10/09/19-25-49-301_190bc97328d9fcb8.webp","https://segmentfault.com/img/remote/1460000030696311":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn45@2020_6/2020/10/09/19-25-49-359_c6267bdd349c3b24.webp","https://segmentfault.com/img/remote/1460000030696312":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn63@2020_3/2020/10/09/19-25-49-547_15284d0efd1de352.webp","https://segmentfault.com/img/remote/1460000030696314":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn40@2020_3/2020/10/09/19-25-49-086_b1aea25e99178234.webp"},"publishedOrCreatedDate":1602271534261}],"record":{"createdTime":"2020-10-10 03:25:34","updatedTime":"2020-10-10 03:25:34","feedId":6615,"fetchDate":"Fri, 09 Oct 2020 19:25:34 +0000","fetchMs":2954,"handleMs":5340,"totalMs":26037,"newArticles":0,"totalArticles":50,"status":1,"type":0,"ip":"2fbc598270685d2ad3e3de972b0b4ef6","hostName":"us-018*","requestId":"079b5a1eb7c14f7890fd9fd952d9ff64_6615","contentType":"application/atom+xml; charset=UTF-8","totalBytes":706848,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":20,"articlesImgsGithubTotal":19,"successGithubMap":{"myreaderx8":1,"myreaderx25":1,"myreaderx7":1,"myreaderx15":1,"myreaderx27":1,"myreaderx16":1,"myreaderx6":1,"myreaderx10":1,"myreaderx33":1,"myreaderx22":1,"myreaderx2":1,"myreaderx24":1,"myreaderx1":1,"myreaderx13":1,"myreaderx30":1,"myreaderx5oss":1,"myreaderx29":1,"myreaderx18":1,"myreaderx19":1},"failGithubMap":{"myreaderx23":1}},"feed":{"createdTime":"2020-08-25 04:33:08","updatedTime":"2020-08-25 07:11:24","id":6615,"name":"SegmentFault 最新的文章","url":"http://segmentfault.com/feeds/blogs","subscriber":null,"website":null,"icon":"https://segmentfault.com/favicon.ico","icon_jsdelivr":null,"description":"","weekly":null,"link":"https://segmentfault.com"},"noPictureArticleList":[{"createdTime":"2020-10-10 03:25:51","updatedTime":"2020-10-10 03:25:51","id":null,"feedId":6615,"linkMd5":"24b89d8c02574abc1e8ee49ea010a4ff"}],"tmpCommonImgCdnBytes":37502,"tmpBodyImgCdnBytes":669346,"tmpBgImgCdnBytes":0,"extra4":{"start":1602271525072,"total":0,"statList":[{"spend":3850,"msg":"获取xml内容"},{"spend":5340,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":4698,"msg":"正文链接上传到cdn"}]},"extra5":20,"extra6":20,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696304","sourceStatusCode":200,"destWidth":800,"destHeight":353,"sourceBytes":29092,"destBytes":29092,"feedId":6615,"totalSpendMs":3256,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-012*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx23/cdn23/contents/2020/10/09/19-25-49-646_350d748b2d8b8e8e.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69189253.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Fri, 09 Oct 2020 19:25:49 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["C03C:5D07:29AF16:44CF34:5F80B92F"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, read:packages, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1602274288"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx23/cdn23/contents/2020/10/09/19-25-49-646_350d748b2d8b8e8e.webp","historyStatusCode":[],"spendMs":43},"base64UserPassword":null,"token":"df0b9******************************93a6e"},"githubUser":"myreaderx23","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"28.4 KB","destSize":"28.4 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696304","sourceStatusCode":200,"destWidth":800,"destHeight":353,"sourceBytes":29092,"destBytes":29092,"feedId":6615,"totalSpendMs":1399,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:49","host":"us-012*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx23/cdn23/contents/2020/10/09/19-25-51-059_350d748b2d8b8e8e.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69189253.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Fri, 09 Oct 2020 19:25:51 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["C03C:5D07:29AFA9:44DA38:5F80B93D"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, read:packages, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1602274288"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx23/cdn23/contents/2020/10/09/19-25-51-059_350d748b2d8b8e8e.webp","historyStatusCode":[],"spendMs":40},"base64UserPassword":null,"token":"df0b9******************************93a6e"},"githubUser":"myreaderx23","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"28.4 KB","destSize":"28.4 KB","compressRate":"100%"}],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-53.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe63.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-035.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe61.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-52.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-006.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe69.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-23.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-031.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe62.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-019.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-57.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-010.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-51.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-023.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-040.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-012.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696295","sourceStatusCode":200,"destWidth":800,"destHeight":419,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn19@2020_1/2020/10/09/19-25-45-524_5f95eb535d42159c.webp","sourceBytes":37502,"destBytes":37502,"feedId":6615,"totalSpendMs":3738,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:42","host":"us-025*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff,24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"36.6 KB","destSize":"36.6 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696300","sourceStatusCode":200,"destWidth":600,"destHeight":299,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn33@2020_4/2020/10/09/19-25-49-194_a0adbade89df6900.webp","sourceBytes":17254,"destBytes":17254,"feedId":6615,"totalSpendMs":3574,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-53*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16.8 KB","destSize":"16.8 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696310","sourceStatusCode":200,"destWidth":600,"destHeight":309,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn55@2020_3/2020/10/09/19-25-49-301_190bc97328d9fcb8.webp","sourceBytes":12416,"destBytes":12416,"feedId":6615,"totalSpendMs":3625,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-031*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.1 KB","destSize":"12.1 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696302","sourceStatusCode":200,"destWidth":800,"destHeight":278,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn35@2020_2/2020/10/09/19-25-49-071_12c660edc11b7531.webp","sourceBytes":23954,"destBytes":23954,"feedId":6615,"totalSpendMs":3577,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"europe62*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"23.4 KB","destSize":"23.4 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696308","sourceStatusCode":200,"destWidth":600,"destHeight":391,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn67@2020_5/2020/10/09/19-25-49-200_5747571b1d1c4306.webp","sourceBytes":7296,"destBytes":7296,"feedId":6615,"totalSpendMs":3574,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"europe69*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.1 KB","destSize":"7.1 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696309","sourceStatusCode":200,"destWidth":800,"destHeight":395,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn76@2020_3/2020/10/09/19-25-49-367_622d2fa813c2449c.webp","sourceBytes":44894,"destBytes":44894,"feedId":6615,"totalSpendMs":3829,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-035*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43.8 KB","destSize":"43.8 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696311","sourceStatusCode":200,"destWidth":800,"destHeight":394,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn45@2020_6/2020/10/09/19-25-49-359_c6267bdd349c3b24.webp","sourceBytes":45574,"destBytes":45574,"feedId":6615,"totalSpendMs":3836,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-040*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"44.5 KB","destSize":"44.5 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696305","sourceStatusCode":200,"destWidth":599,"destHeight":350,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn32@2020_1/2020/10/09/19-25-49-521_174957a22e271d44.webp","sourceBytes":12384,"destBytes":12384,"feedId":6615,"totalSpendMs":3846,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-52*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.1 KB","destSize":"12.1 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696314","sourceStatusCode":200,"destWidth":599,"destHeight":397,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn40@2020_3/2020/10/09/19-25-49-086_b1aea25e99178234.webp","sourceBytes":36818,"destBytes":36818,"feedId":6615,"totalSpendMs":3823,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"europe62*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"36 KB","destSize":"36 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696312","sourceStatusCode":200,"destWidth":600,"destHeight":316,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn63@2020_3/2020/10/09/19-25-49-547_15284d0efd1de352.webp","sourceBytes":16140,"destBytes":16140,"feedId":6615,"totalSpendMs":3960,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-006*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"15.8 KB","destSize":"15.8 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696303","sourceStatusCode":200,"destWidth":599,"destHeight":308,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn27@2020_2/2020/10/09/19-25-49-540_2b1d5e9ae42b15a2.webp","sourceBytes":8956,"destBytes":8956,"feedId":6615,"totalSpendMs":3894,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"europe61*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.7 KB","destSize":"8.7 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696298","sourceStatusCode":200,"destWidth":800,"destHeight":637,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn88@2020_6/2020/10/09/19-25-49-398_4b9dae1bdbd7550f.webp","sourceBytes":75392,"destBytes":75392,"feedId":6615,"totalSpendMs":4077,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"europe-23*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"73.6 KB","destSize":"73.6 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696297","sourceStatusCode":200,"destWidth":600,"destHeight":321,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn91@2020_6/2020/10/09/19-25-49-543_5a4cf42f1b971737.webp","sourceBytes":24742,"destBytes":24742,"feedId":6615,"totalSpendMs":4056,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"europe61*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"24.2 KB","destSize":"24.2 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696301","sourceStatusCode":200,"destWidth":600,"destHeight":335,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn37@2020_3/2020/10/09/19-25-49-435_6fb3d0646863cebf.webp","sourceBytes":49838,"destBytes":49838,"feedId":6615,"totalSpendMs":4111,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"europe63*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"48.7 KB","destSize":"48.7 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696313","sourceStatusCode":200,"destWidth":600,"destHeight":338,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn59@2020_1/2020/10/09/19-25-49-978_86f1ba9ece2c1f36.webp","sourceBytes":11524,"destBytes":11524,"feedId":6615,"totalSpendMs":4285,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-019*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"11.3 KB","destSize":"11.3 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696306","sourceStatusCode":200,"destWidth":800,"destHeight":409,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn30@2020_6/2020/10/09/19-25-49-850_b20e418fa57fc9ec.webp","sourceBytes":41228,"destBytes":41228,"feedId":6615,"totalSpendMs":4294,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-51*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"40.3 KB","destSize":"40.3 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696307","sourceStatusCode":200,"destWidth":800,"destHeight":371,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn71@2020_2/2020/10/09/19-25-48-993_132b82355e99d370.webp","sourceBytes":35736,"destBytes":35736,"feedId":6615,"totalSpendMs":4182,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"europe-57*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"34.9 KB","destSize":"34.9 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696296","sourceStatusCode":200,"destWidth":800,"destHeight":384,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn83@2020_1/2020/10/09/19-25-50-035_939b79d1239ef22c.webp","sourceBytes":36712,"destBytes":36712,"feedId":6615,"totalSpendMs":4493,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-010*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"35.9 KB","destSize":"35.9 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://segmentfault.com/img/remote/1460000030696299","sourceStatusCode":200,"destWidth":599,"destHeight":492,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn80@2020_6/2020/10/09/19-25-49-864_667d9949b3fdb3ed.webp","sourceBytes":168488,"destBytes":168488,"feedId":6615,"totalSpendMs":4502,"convertSpendMs":0,"createdTime":"2020-10-10 03:25:46","host":"us-023*","referer":"https://segmentfault.com/a/1190000030696292","linkMd5ListStr":"24b89d8c02574abc1e8ee49ea010a4ff","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"164.5 KB","destSize":"164.5 KB","compressRate":"100%"}],"successGithubMap":{"myreaderx8":1,"myreaderx25":1,"myreaderx7":1,"myreaderx15":1,"myreaderx27":1,"myreaderx16":1,"myreaderx6":1,"myreaderx10":1,"myreaderx33":1,"myreaderx22":1,"myreaderx2":1,"myreaderx24":1,"myreaderx1":1,"myreaderx13":1,"myreaderx30":1,"myreaderx5oss":1,"myreaderx29":1,"myreaderx18":1,"myreaderx19":1},"failGithubMap":{"myreaderx23":1}}