{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-12-02 21:54:12","updatedTime":"2020-12-02 21:54:12","title":"3 Ways to Hunt for the ZeroLogon Vulnerability on Your Windows Servers","link":"https://www.carbonblack.com/?p=78221","description":"<p>Vulnerability assessment and patch management can be painful time-consuming processes. From the Security team looking at vulnerability reports and prioritizing the riskiest ones for their environment to the IT or Infrastructure team determining exactly which machines need to be patched and successfully deploying the patches, it&#8217;s a tireless cross-team effort.</p>\n<p>Over the past year, Carbon Black’s <a href=\"https://www.carbonblack.com/threat-analysis-unit/\">Threat Analysis Unit (TAU)</a> has been working to simplify and expedite this process by building and deploying live queries for our users. These live queries, which are sent directly to the devices themselves to pull back artifacts about the current state of each device, show up on the Carbon Black Cloud console as pre-built, recommended queries that can be run against one device or your entire fleet with the click of a button. The query catalog now features more than 90 recommended queries to help administrators track down rogue USB devices, unwanted browser extensions, misconfigured device firewall and RDP settings, and more.</p>\n<p>Previously, the TAU team published a live query that helped users uncover the <a href=\"https://community.carbonblack.com/t5/Documentation-Downloads/CB-Protection-8-1-6-User-Guide/ta-p/81018\">Windows CryptoAPI Spoofing vulnerability</a> that was originally announced in January. Now, as part of the Carbon Black Cloud’s most recent update, we have added three queries that help users hunt for indicators of the Windows ZeroLogon vulnerability (CVE 2020-1472).</p>\n<h2>About ZeroLogon (CVE 2020-1472)</h2>\n<p><img class=\"wp-image-78233 size-large aligncenter\" src=\"https://cdn.www.carbonblack.com/wp-content/uploads/ZeroLogon-Queries.gif\" alt=\"\" width=\"1024\" height=\"576\" /></p>\n<p>This vulnerability, which was originally announced by Microsoft in August with a “critical” severity rating, could allow an unauthenticated attacker to gain admin access to a Windows domain controller. The vulnerability impacts the Netlogon Remote Protocol in the majority of supported Windows server versions ranging from Server 2008 to Server 2019.</p>\n<p>In September, as reported by <a href=\"https://krebsonsecurity.com/2020/09/microsoft-attackers-exploiting-zerologon-windows-flaw/#:~:text=Microsoft%20warned%20on%20Wednesday%20that,inside%20a%20vulnerable%20corporate%20network.\">Krebs on Security</a>, the U.S. Department of Homeland Security released <a href=\"https://us-cert.cisa.gov/ncas/current-activity/2020/09/18/cisa-releases-emergency-directive-microsoft-windows-netlogon\">an emergency directive</a> stating that they were believed there were active exploits in the wild and instructing all federal agencies (and strongly recommending state and local governments) to patch the vulnerability within a matter of days.</p>\n<p>Even with a vulnerability this severe, the reality is that many organizations still will not have found the time to prioritize assessing where this vulnerability could exist in their networks and deploying the patch. This is why our TAU team took the time to develop three separate ways for users to query their Windows servers to audit their systems for configurations and indicators associated with this vulnerability. And while the queries described below are only available in the Carbon Black Cloud console, your team could also follow the same discovery techniques manually or through a separate query tool deployed in your environment.</p>\n<p><strong>Registry Setting </strong><br />\nThe first of these queries reach out directly to your organization’s Windows servers to determine if the Microsoft-recommended registry setting has been enabled on the target system. This registry key is used as an indicator to help you confirm whether the necessary update has been applied to enable enforcement mode. The results from this query will clearly show whether each server has it “Enabled” or “Not Enabled.”</p>\n<p><strong>System Event Logs </strong><br />\nThis query takes us a little bit away from vulnerability management and more toward threat hunting for indicators of compromise (IOCs) associated with the vulnerability by searching the system event log for entries related to ZeroLogon. The specific event IDs that the query searches for are listed in this Microsoft support document. If any event log entries match those event IDs, the query results will provide you with the necessary context related to the entry.</p>\n<p><strong>Yara Scan</strong><br />\nThis final query, which is also hunting for IOCs, automatically performs a Yara scan of the servers to look for variants related to a public ZeroLogon exploit. This query specifically scans the C:\\Windows\\Temp directory, but it is recommended that users modify the query to scan other directories based on their own threat hunting needs.</p>\n<p>Running these three queries in your environment provides both Security and IT teams with information about which machines may currently be vulnerable, as well as a look back to uncover any indicators that your organization has already been attacked using this vulnerability. This means that, with only a few minutes of work, you could confidently report to the leadership within your organization about the status of this critical Microsoft vulnerability across your entire environment.</p>\n<p>See also:<br />\n<a href=\"https://www.carbonblack.com/blog/querying-windows-event-logs-for-faster-investigation-and-response/\">Querying Windows Event Logs for Faster Investigation and Response</a><br />\n<a href=\"https://www.carbonblack.com/blog/using-live-query-to-audit-your-environment-for-the-windows-cryptoapi-spoofing-vulnerability/\">Using Live Query to Audit Your Environment for the Windows CryptoAPI Spoofing Vulnerability</a><br />\n<a href=\"https://www.carbonblack.com/blog/how-cb-liveops-helps-with-vulnerability-assessment/\">How Live Query Helps with Vulnerability Assessment</a></p>\n<p>The post <a rel=\"nofollow\" href=\"https://www.carbonblack.com/blog/3-ways-to-hunt-for-the-zerologon-vulnerability-on-your-windows-servers/\">3 Ways to Hunt for the ZeroLogon Vulnerability on Your Windows Servers</a> appeared first on <a rel=\"nofollow\" href=\"https://www.carbonblack.com\">VMware Carbon Black</a>.</p>\n","descriptionType":"html","publishedDate":"Tue, 24 Nov 2020 16:00:25 +0000","feedId":23954,"bgimg":"https://cdn.www.carbonblack.com/wp-content/uploads/ZeroLogon-Queries.gif","linkMd5":"f12c8f27257d8aa00cd7eb98190bd8a2","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn10@2020_1/2020/12/02/13-54-36-799_7829982ddab13623.webp","destWidth":1920,"destHeight":1080,"sourceBytes":1517518,"destBytes":426904,"author":"Sheida Azimi","articleImgCdnMap":{"https://cdn.www.carbonblack.com/wp-content/uploads/ZeroLogon-Queries.gif":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn10@2020_1/2020/12/02/13-54-36-799_7829982ddab13623.webp"},"publishedOrCreatedDate":1606917252587}],"record":{"createdTime":"2020-12-02 21:54:12","updatedTime":"2020-12-02 21:54:12","feedId":23954,"fetchDate":"Wed, 02 Dec 2020 13:54:12 +0000","fetchMs":70,"handleMs":20,"totalMs":25515,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"60cc8024e6448a76a05235c57d14d095","hostName":"us-011*","requestId":"7022f6b15a114963b6a5ea8f748e8676_23954","contentType":"application/rss+xml; charset=UTF-8","totalBytes":426904,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":1,"articlesImgsGithubTotal":1,"successGithubMap":{"myreaderx7":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 02:31:50","updatedTime":"2020-09-07 04:26:24","id":23954,"name":"VMware Carbon Black","url":"https://www.carbonblack.com/feed/","subscriber":137,"website":null,"icon":"https://www.carbonblack.com/wp-content/uploads/favicon-32x32-1.png","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx65/cdn2@2020_6/2020/09/06/20-26-23-618_815ccce11fb49fc8.png","description":"Cloud Native Endpoint Protection","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":426904,"tmpBodyImgCdnBytes":0,"tmpBgImgCdnBytes":0,"extra4":{"start":1606917252492,"total":0,"statList":[{"spend":75,"msg":"获取xml内容"},{"spend":20,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":0,"msg":"正文链接上传到cdn"}]},"extra5":1,"extra6":1,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://cdn.www.carbonblack.com/wp-content/uploads/ZeroLogon-Queries.gif","sourceStatusCode":200,"destWidth":1920,"destHeight":1080,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn10@2020_1/2020/12/02/13-54-36-799_7829982ddab13623.webp","sourceBytes":1517518,"destBytes":426904,"targetWebpQuality":75,"feedId":23954,"totalSpendMs":25387,"convertSpendMs":24060,"createdTime":"2020-12-02 21:54:12","host":"us-032*","referer":"https://www.carbonblack.com/?p=78221","linkMd5ListStr":"f12c8f27257d8aa00cd7eb98190bd8a2,f12c8f27257d8aa00cd7eb98190bd8a2","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.4 MB","destSize":"416.9 KB","compressRate":"28.1%"}],"successGithubMap":{"myreaderx7":1},"failGithubMap":{}}