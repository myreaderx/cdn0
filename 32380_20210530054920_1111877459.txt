{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2021-05-30 13:48:13","updatedTime":"2021-05-30 13:48:13","title":"S-A-A-2 (NanoVNA V2) V2.2 から V2.3 への変更","link":"https://lowreal.net/2020/10/28/1","description":"<p> <span data-key=\"undefined\" itemscope=\"\" itemtype=\"http://schema.org/Photograph\"> <a href=\"https://lowreal.net/images/entry/20201028041152-v2plus.png\" class=\"picasa\" itemprop=\"url\"><img alt=\"photo\" itemprop=\"image\" src=\"https://lowreal.net/images/entry/20201028041152-v2plus.png\" /></a> </span> <p>現行の最新は V2 Plus (V2.3) または V2 Plus4 だけど、 これらが出る直前に V2.2 を買ってしまったのでちょっと残念な感じ。とはいえ V2.2 と V2.3 はハードウェア的には非常に差分が少ないようなので、改造してみた。<a href=\"https://github.com/eried/Research/tree/master/NanoVNA/v2/upgrade_v2.2_to_plus\">Upgrade your NanoVNA v2 to v2 Plus</a> を参考にしてやれば良い。</p> \n <section class=\"level-1\"> \n  <h3>変更を加える箇所</h3> \n  <ul> \n   <li>R311 10 -&gt; 68</li> \n   <li>C318 220nF -&gt; 10nF</li> \n   <li>C321 10μ -&gt; 100nF</li> \n   <li>L302 22μH (変更なし参考)</li> \n  </ul> \n  <p> <span data-key=\"undefined\" itemscope=\"\" itemtype=\"http://schema.org/Photograph\"> <a href=\"https://lowreal.net/images/entry/20201028041255-DSC09333-16MP-2.jpg\" class=\"picasa\" itemprop=\"url\"><img alt=\"photo\" itemprop=\"image\" src=\"https://lowreal.net/images/entry/20201028041255-DSC09333-16MP-2.jpg\" /></a> </span> <br> <span data-key=\"undefined\" itemscope=\"\" itemtype=\"http://schema.org/Photograph\"> <a href=\"https://lowreal.net/images/entry/20201028041304-DSC09333-16MP.jpg\" class=\"picasa\" itemprop=\"url\"><img alt=\"photo\" itemprop=\"image\" src=\"https://lowreal.net/images/entry/20201028041304-DSC09333-16MP.jpg\" /></a> </span> <br> <span data-key=\"undefined\" itemscope=\"\" itemtype=\"http://schema.org/Photograph\"> <a href=\"https://lowreal.net/images/entry/20201028041311-DSC09334-16MP.jpg\" class=\"picasa\" itemprop=\"url\"><img alt=\"photo\" itemprop=\"image\" src=\"https://lowreal.net/images/entry/20201028041311-DSC09334-16MP.jpg\" /></a> </span> <br> <span data-key=\"undefined\" itemscope=\"\" itemtype=\"http://schema.org/Photograph\"> <a href=\"https://lowreal.net/images/entry/20201028041319-DSC09336-16MP.jpg\" class=\"picasa\" itemprop=\"url\"><img alt=\"photo\" itemprop=\"image\" src=\"https://lowreal.net/images/entry/20201028041319-DSC09336-16MP.jpg\" /></a> </span> <p></p> </br></br></br></p> \n </section> \n <section class=\"level-1\"> \n  <h3>ファームウェアのバックアップ</h3> \n  <p>bootloader も含めてファームウェアのすべてをバックアップしておく。</p> \n  <section class=\"level-2\"> \n   <h4>接続</h4> \n   <p> <span data-key=\"undefined\" itemscope=\"\" itemtype=\"http://schema.org/Photograph\"> <a href=\"https://lowreal.net/images/entry/20201028041529-PXL_20201026_161420026.jpg\" class=\"picasa\" itemprop=\"url\"><img alt=\"photo\" itemprop=\"image\" src=\"https://lowreal.net/images/entry/20201028041529-PXL_20201026_161420026.jpg\" /></a> </span> <p>よく売ってるやすい ST-Link V2 というやつを使う <a href=\"https://lowreal.net/2019/09/14/1\">参考</a><p>メインボード上にスルーホールがありシルクも印刷されているので普通に繋ぐだけ。<p><a href=\"https://akizukidenshi.com/catalog/g/gC-09830/\">スルホール用テストワイヤ</a>を使うと楽</p> </p></p></p> \n  </section> \n  <section class=\"level-2\"> \n   <h4>backup and restore 手順</h4> \n   <p>まず一応書きこまれている内容をバックアップしておく</p> \n  </section> \n  <section class=\"level-2\"> \n   <h4>openocd を使う場合</h4> \n   <p>読みこみ (ダウンロード)</p> \n   <pre class=\"code\">openocd -f interface/stlink.cfg -f target/stm32f3x.cfg -c init -c \"reset init\"  -c \"flash read_bank 0 backup.bin 0x0000000 0x40000\" -c exit</pre> \n   <p>書きこみ (アップロード)</p> \n   <pre class=\"code\">openocd -f interface/stlink.cfg -f target/stm32f3x.cfg  -c \"program backup.bin 0x08000000 verify reset exit\"</pre> \n   <section class=\"level-3\"> \n    <h5>st-flash を使う場合 (書けない)</h5> \n    <pre class=\"code\">$ st-flash read backup.bin 0x08000000 0x8040000\nst-flash 1.4.0\n2020-10-27T01:00:56 INFO common.c: Loading device parameters....\n2020-10-27T01:00:56 INFO common.c: Device connected is: F1 High-density device, id 0x17010414\n2020-10-27T01:00:56 INFO common.c: SRAM size: 0x10000 bytes (64 KiB), Flash: 0x40000 bytes (256 KiB) in pages of 2048 bytes</pre> \n    <p>ただ、これを st-flash で書こうとすると失敗してしまう……</p> \n    <pre class=\"code\">$ st-flash write backup.bin 0x08000000\nst-flash 1.4.0\n2020-10-27T01:02:39 INFO common.c: Loading device parameters....\n2020-10-27T01:02:39 INFO common.c: Device connected is: F1 High-density device, id 0x17010414\n2020-10-27T01:02:39 INFO common.c: SRAM size: 0x10000 bytes (64 KiB), Flash: 0x40000 bytes (256 KiB) in pages of 2048 bytes\n2020-10-27T01:02:39 INFO common.c: Ignoring 864 bytes of 0xff at end of file\n2020-10-27T01:02:39 INFO common.c: Attempting to write 261280 (0x3fca0) bytes to stm32 address: 134217728 (0x8000000)\nFlash page at addr: 0x0803f800 erased\n2020-10-27T01:02:41 INFO common.c: Finished erasing 128 pages of 2048 (0x800) bytes\n2020-10-27T01:02:41 INFO common.c: Starting Flash write for VL/F0/F3/F1_XL core id\n2020-10-27T01:02:41 ERROR flash_loader.c: unknown coreid, not sure what flash loader to use, aborting! coreid: 2ba01477, chipid: 414\n2020-10-27T01:02:41 WARN flash_loader.c: Failed to write flash loader to sram!\n2020-10-27T01:02:41 ERROR common.c: stlink_flash_loader_init() == -1\nstlink_fwrite_flash() == -1\nexit 255</pre> \n   </section> \n  </section> \n </section> \n <section class=\"level-1\"> \n  <h3>bootloader</h3> \n  <p>bootloader は Serial Number によって何かが異なるらしく、実際間違った bootloader を書きこむと BBGAIN の値がおかしくなったり、起動しなくなったりする。とにかく現状をバックアップしておけば元には戻せるので、バックアップは大事。<p>レポジトリにある bootloader は V2_2 用で、最新版は事情があって今のところ公開されていないらしい。現時点では Discord で開発者にコンタクトをとってビルドしてもらう必要がある。が、そのうち SN を指定してビルド・ダウンロードできるページを作るらしいので急ぎじゃないのなら待ってればいいかも。<p></p> </p></p> \n </section> \n <section class=\"level-1\"> \n  <h3>どういう変更点なのか</h3> \n  <p> <span data-key=\"undefined\" itemscope=\"\" itemtype=\"http://schema.org/Photograph\"> <a href=\"https://lowreal.net/images/entry/20201028041754-_2020-10-28_4.17.31.png\" class=\"picasa\" itemprop=\"url\"><img alt=\"photo\" itemprop=\"image\" src=\"https://lowreal.net/images/entry/20201028041754-_2020-10-28_4.17.31.png\" /></a> </span> <p>該当箇所の回路図</p> \n   <ul> \n    <li>前段の AD8342 はミキサ</li> \n    <li>GS8722C は2回路入りオペアンプ (11MHz)</li> \n    <li>MXD8641 は SP4T スイッチ。オペアンプの増幅率を決めている</li> \n   </ul><p>なのでここの一連の回路はミキサ出力を ADC 前にフィルタ・増幅する回路になる。</p><br> <p>R311, C318, L302 はローパスフィルタで、カットオフは変更前は約72kHz、変更後は34kHz。noise improvement はここのカットオフ変更によるものだと思う。<p>C321 は交流増幅のための直流カットキャパシタだと思うが、小さくすることで反応性を上げてスキャン速度を上げられるようにしたのだと思う。違うかも</p> \n     <section class=\"level-2\"> \n      <h4>メモ: ADCのサンプルレート</h4> \n      <p>S-A-A-2 の場合 ADC は MCU のものを直接使っている。</p> \n      <ul> \n       <li>V2.2 では 300kHz board_v2_1/board.cpp (v2_1 と v2_2 は同じ) \n        <ul> \n         <li>ADC のクロックは 6MHz</li> \n        </ul></li> \n       <li>V2.3 では 1500kHz board_v2_plus/board.cpp \n        <ul> \n         <li>ADC のクロックは 30MHz</li> \n        </ul></li> \n      </ul> \n     </section> </p></br></p> \n </section> \n <hr /> <p><a href=\"https://lowreal.net/2020/10/28/\">2020年10月28日</a></p> </p>","descriptionType":"html","feedId":32380,"bgimg":"https://lowreal.net/images/entry/20201028041152-v2plus.png","linkMd5":"1d202b365acbb7cbd0a08fab4f05600b","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn38@2020_3/2021/05/30/05-48-17-014_e2504f6231c31f96.webp","destWidth":320,"destHeight":240,"sourceBytes":4489,"destBytes":14000,"author":"cho45","enclosureType":"image/jpeg","enclosureUrl":"/images/entry/20201028041152-v2plus.png","articleImgCdnMap":{"https://lowreal.net/images/entry/20201028041152-v2plus.png":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn38@2020_3/2021/05/30/05-48-17-014_e2504f6231c31f96.webp","https://lowreal.net/images/entry/20201028041255-DSC09333-16MP-2.jpg":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn64@2020_2/2021/05/30/05-48-21-382_fe3b586fafe58f1f.webp","https://lowreal.net/images/entry/20201028041304-DSC09333-16MP.jpg":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn51@2020_6/2021/05/30/05-48-21-921_895adae771e7533f.webp","https://lowreal.net/images/entry/20201028041311-DSC09334-16MP.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn66@2020_6/2021/05/30/05-48-20-137_2d53a868bf798ac1.webp","https://lowreal.net/images/entry/20201028041319-DSC09336-16MP.jpg":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn57@2020_3/2021/05/30/05-48-20-048_7e47258a7d782083.webp","https://lowreal.net/images/entry/20201028041529-PXL_20201026_161420026.jpg":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn47@2020_5/2021/05/30/05-48-19-754_081fa98a1c4f4e31.webp","https://lowreal.net/images/entry/20201028041754-_2020-10-28_4.17.31.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn56@2020_4/2021/05/30/05-49-20-217_96156995760fae2c.webp"},"publishedOrCreatedDate":1622353693144}],"record":{"createdTime":"2021-05-30 13:48:13","updatedTime":"2021-05-30 13:48:13","feedId":32380,"fetchDate":"Sun, 30 May 2021 05:48:13 +0000","fetchMs":1721,"handleMs":12,"totalMs":69574,"newArticles":0,"totalArticles":50,"status":1,"type":0,"ip":"bc1eecef1292254c09de6c1e66b750f3","hostName":"europe66*","requestId":"e36cb63d162e43e1b6f134fb3d9fe97b_32380","contentType":"application/atom+xml; charset=utf-8","totalBytes":5287824,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":7,"articlesImgsGithubTotal":7,"successGithubMap":{"myreaderx6":1,"myreaderx27":1,"myreaderx11":1,"myreaderx13":1,"myreaderx18":1,"myreaderx29":1,"myreaderx":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 02:55:25","updatedTime":"2020-09-07 05:03:49","id":32380,"name":"氾濫原","url":"http://lowreal.net/feed","subscriber":99,"website":null,"icon":"https://lowreal.net/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx61/cdn76@2020_1/2020/09/06/21-03-49-014_df64d76953b67755.ico","description":"","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":14000,"tmpBodyImgCdnBytes":5273824,"tmpBgImgCdnBytes":0,"extra4":{"start":1622353690938,"total":0,"statList":[{"spend":2194,"msg":"获取xml内容"},{"spend":12,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":63113,"msg":"正文链接上传到cdn"}]},"extra5":7,"extra6":7,"extra7ImgCdnFailResultVector":[null],"extra10_invalidATagHrefValue":{"https://lowreal.net/2020/10/28/1_/images/entry/20201028041152-v2plus.png":"https://lowreal.net/images/entry/20201028041152-v2plus.png","https://lowreal.net/2020/10/28/1_/images/entry/20201028041304-DSC09333-16MP.jpg":"https://lowreal.net/images/entry/20201028041304-DSC09333-16MP.jpg","https://lowreal.net/2020/10/28/1_/images/entry/20201028041311-DSC09334-16MP.jpg":"https://lowreal.net/images/entry/20201028041311-DSC09334-16MP.jpg","https://lowreal.net/2020/10/28/1_/images/entry/20201028041754-_2020-10-28_4.17.31.png":"https://lowreal.net/images/entry/20201028041754-_2020-10-28_4.17.31.png","https://lowreal.net/2020/10/28/1_/images/entry/20201028041319-DSC09336-16MP.jpg":"https://lowreal.net/images/entry/20201028041319-DSC09336-16MP.jpg","https://lowreal.net/2020/10/28/1_/images/entry/20201028041529-PXL_20201026_161420026.jpg":"https://lowreal.net/images/entry/20201028041529-PXL_20201026_161420026.jpg","https://lowreal.net/2020/10/28/1_/images/entry/20201028041255-DSC09333-16MP-2.jpg":"https://lowreal.net/images/entry/20201028041255-DSC09333-16MP-2.jpg"},"extra111_proxyServerAndStatMap":{"http://us-020.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-54.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-53.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-019.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-004.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-016.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://lowreal.net/images/entry/20201028041152-v2plus.png","sourceStatusCode":200,"destWidth":320,"destHeight":240,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn38@2020_3/2021/05/30/05-48-17-014_e2504f6231c31f96.webp","sourceBytes":4489,"destBytes":14000,"targetWebpQuality":75,"feedId":32380,"totalSpendMs":1306,"convertSpendMs":5,"createdTime":"2021-05-30 13:48:16","host":"us-039*","referer":"https://lowreal.net/2020/10/28/1","linkMd5ListStr":"1d202b365acbb7cbd0a08fab4f05600b,1d202b365acbb7cbd0a08fab4f05600b","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"4.4 KB","destSize":"13.7 KB","compressRate":"311.9%"},{"code":1,"isDone":false,"source":"https://lowreal.net/images/entry/20201028041529-PXL_20201026_161420026.jpg","sourceStatusCode":200,"destWidth":3024,"destHeight":1994,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn47@2020_5/2021/05/30/05-48-19-754_081fa98a1c4f4e31.webp","sourceBytes":1721454,"destBytes":1024400,"targetWebpQuality":75,"feedId":32380,"totalSpendMs":2596,"convertSpendMs":227,"createdTime":"2021-05-30 13:48:17","host":"us-016*","referer":"https://lowreal.net/2020/10/28/1","linkMd5ListStr":"1d202b365acbb7cbd0a08fab4f05600b","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.6 MB","destSize":"1,000.4 KB","compressRate":"59.5%"},{"code":1,"isDone":false,"source":"https://lowreal.net/images/entry/20201028041319-DSC09336-16MP.jpg","sourceStatusCode":200,"destWidth":2864,"destHeight":1911,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn57@2020_3/2021/05/30/05-48-20-048_7e47258a7d782083.webp","sourceBytes":5132845,"destBytes":1197376,"targetWebpQuality":75,"feedId":32380,"totalSpendMs":2892,"convertSpendMs":289,"createdTime":"2021-05-30 13:48:17","host":"us-54*","referer":"https://lowreal.net/2020/10/28/1","linkMd5ListStr":"1d202b365acbb7cbd0a08fab4f05600b","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"4.9 MB","destSize":"1.1 MB","compressRate":"23.3%"},{"code":1,"isDone":false,"source":"https://lowreal.net/images/entry/20201028041311-DSC09334-16MP.jpg","sourceStatusCode":200,"destWidth":3026,"destHeight":2019,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn66@2020_6/2021/05/30/05-48-20-137_2d53a868bf798ac1.webp","sourceBytes":5521055,"destBytes":1056712,"targetWebpQuality":67,"feedId":32380,"totalSpendMs":3035,"convertSpendMs":381,"createdTime":"2021-05-30 13:48:17","host":"us-020*","referer":"https://lowreal.net/2020/10/28/1","linkMd5ListStr":"1d202b365acbb7cbd0a08fab4f05600b","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.3 MB","destSize":"1 MB","compressRate":"19.1%"},{"code":1,"isDone":false,"source":"https://lowreal.net/images/entry/20201028041255-DSC09333-16MP-2.jpg","sourceStatusCode":200,"destWidth":4897,"destHeight":3266,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn64@2020_2/2021/05/30/05-48-21-382_fe3b586fafe58f1f.webp","sourceBytes":12059933,"destBytes":801858,"targetWebpQuality":22,"feedId":32380,"totalSpendMs":4220,"convertSpendMs":704,"createdTime":"2021-05-30 13:48:17","host":"us-019*","referer":"https://lowreal.net/2020/10/28/1","linkMd5ListStr":"1d202b365acbb7cbd0a08fab4f05600b","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"11.5 MB","destSize":"783.1 KB","compressRate":"6.6%"},{"code":1,"isDone":false,"source":"https://lowreal.net/images/entry/20201028041304-DSC09333-16MP.jpg","sourceStatusCode":200,"destWidth":2842,"destHeight":1894,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn51@2020_6/2021/05/30/05-48-21-921_895adae771e7533f.webp","sourceBytes":5161473,"destBytes":1153900,"targetWebpQuality":75,"feedId":32380,"totalSpendMs":4777,"convertSpendMs":361,"createdTime":"2021-05-30 13:48:17","host":"us-004*","referer":"https://lowreal.net/2020/10/28/1","linkMd5ListStr":"1d202b365acbb7cbd0a08fab4f05600b","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"4.9 MB","destSize":"1.1 MB","compressRate":"22.4%"},{"code":1,"isDone":false,"source":"https://lowreal.net/images/entry/20201028041754-_2020-10-28_4.17.31.png","sourceStatusCode":200,"destWidth":1312,"destHeight":702,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn56@2020_4/2021/05/30/05-49-20-217_96156995760fae2c.webp","sourceBytes":131500,"destBytes":39578,"targetWebpQuality":75,"feedId":32380,"totalSpendMs":1736,"convertSpendMs":36,"createdTime":"2021-05-30 13:49:18","host":"us-019*","referer":"https://lowreal.net/2020/10/28/1","linkMd5ListStr":"1d202b365acbb7cbd0a08fab4f05600b","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"128.4 KB","destSize":"38.7 KB","compressRate":"30.1%"}],"successGithubMap":{"myreaderx6":1,"myreaderx27":1,"myreaderx11":1,"myreaderx13":1,"myreaderx18":1,"myreaderx29":1,"myreaderx":1},"failGithubMap":{}}