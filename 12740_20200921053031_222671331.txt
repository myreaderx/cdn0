{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-09-21 13:28:30","updatedTime":"2020-09-21 13:28:30","title":"ä½ è¿˜åœ¨reduxä¸­å†™é‡å¤å•°å—¦çš„æ ·æ¿ä»£ç å—","link":"https://juejin.im/post/6874751458508537864","description":"<div class=\"markdown-body\"><h2 data-id=\"heading-0\">å‰è¨€</h2>\n<blockquote>\n<p>ğŸ“¢ åšå®¢é¦–å‘ : <a href=\"https://github.com/PDKSophia/blog.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é˜¿å®½çš„åšå®¢</a></p>\n</blockquote>\n<blockquote>\n<p>ğŸ“¢ å›¢é˜Ÿåšå®¢: <a href=\"https://github.com/SugarTurboS/Blogs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SugarTurboS</a></p>\n</blockquote>\n<blockquote>\n<p>ğŸŒˆ ä»“åº“æºç  : <a href=\"https://github.com/SugarTurboS/rc-redux-model\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">rc-redux-model</a> ï¼Œæ±‚ä¸ª âœ¨ star</p>\n</blockquote>\n<p>æœ€è¿‘å— JPL åŒå­¦çš„å¯å‘ï¼Œå†™äº†ä¸€ä¸ªä¸­é—´ä»¶ <code>rc-redux-model</code>ï¼Œä¸‹è¾¹è®°å½•ä¸€ä¸‹æˆ‘çš„ä» 0 åˆ° 1</p>\n<p>å¤§å®¶åº”è¯¥çŸ¥é“ï¼Œ<strong>react æ˜¯å•å‘æ•°æ®æµçš„å½¢å¼</strong>ï¼Œå®ƒä¸å­˜åœ¨æ•°æ®å‘ä¸Šå›æº¯çš„æŠ€èƒ½ï¼Œä½ è¦ä¹ˆå°±æ˜¯å‘ä¸‹åˆ†å‘ï¼Œè¦ä¹ˆå°±æ˜¯è‡ªå·±å†…éƒ¨ç®¡ç†ã€‚</p>\n<img width=\"650\" class=\"lazyload\" src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67cf879c34bd4ecfafdc1443e4b8b8ab~tplv-k3u1fbpfcp-zoom-1.image\" data-width=\"800\" data-height=\"600\" referrerpolicy=\"no-referrer\">\n<p>react ä¸­ï¼Œæœ‰ props å’Œ stateï¼Œå½“æˆ‘æƒ³ä»çˆ¶ç»„ä»¶ç»™å­ç»„ä»¶ä¼ é€’æ•°æ®çš„æ—¶å€™ï¼Œå¯é€šè¿‡ props è¿›è¡Œæ•°æ®ä¼ é€’ï¼Œå¦‚æœæˆ‘æƒ³åœ¨ç»„ä»¶å†…éƒ¨è‡ªè¡Œç®¡ç†çŠ¶æ€ï¼Œé‚£å¯ä»¥é€‰æ‹©ä½¿ç”¨ stateã€‚</p>\n<p>å¾ˆå¿«ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯å…„å¼Ÿç»„ä»¶ä¹‹é—´å¦‚ä½•è¿›è¡Œé€šä¿¡ï¼Ÿç­”æ¡ˆå°±æ˜¯åœ¨çˆ¶ç»„ä»¶ä¸­ç®¡ç† stateï¼Œé€šè¿‡ props ä¸‹å‘ç»™å„å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡å›è°ƒæ–¹å¼ï¼Œè¿›è¡Œé€šä¿¡</p>\n<img width=\"450\" class=\"lazyload\" src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0c1e195cc4294dfdbb82bd3faeaefd0a~tplv-k3u1fbpfcp-zoom-1.image\" data-width=\"800\" data-height=\"600\" referrerpolicy=\"no-referrer\">\n<p>è¿™ä¼šå­˜åœ¨ä»€ä¹ˆé—®é¢˜ï¼Ÿä½ ä¼šå‘ç°å¦‚æœä½ æƒ³å…±äº«æ•°æ®ï¼Œä½ å¾—æŠŠæ‰€æœ‰éœ€è¦å…±äº«çš„ state é›†ä¸­æ”¾åˆ°æ‰€æœ‰ç»„ä»¶é¡¶å±‚ï¼Œç„¶ååˆ†å‘ç»™æ‰€æœ‰ç»„ä»¶ã€‚</p>\n<p>ä¸ºæ­¤ï¼Œéœ€è¦ä¸€ä¸ªåº“ï¼Œæ¥ä½œä¸ºæ›´åŠ ç‰›é€¼ã€ä¸“ä¸šçš„é¡¶å±‚ state å‘ç»™å„ç»„ä»¶ï¼Œäºæ˜¯ï¼Œæˆ‘å¼•å…¥äº† reduxã€‚</p>\n<h2 data-id=\"heading-1\">redux ä½“éªŒ</h2>\n<p>redux å¯ä»¥è¯´æ˜¯è¾ƒæˆç†Ÿï¼Œç”Ÿæ€åœˆè¾ƒå®Œå–„çš„ä¸€ä¸ªåº“äº†ï¼Œæ­é… <a href=\"https://github.com/zalmoxisus/redux-devtools-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">redux-devtools-extension</a> è¿™ä¸ª chrome æ’ä»¶ï¼Œè®©ä½ å¼€å‘æ›´åŠ å¿«ä¹ã€‚ç„¶ï¼Œä¸–é—´ä¸‡ç‰©ï¼Œçš†æœ‰åˆ©å¼Šã€‚</p>\n<p>æœ¬èº«æˆ‘ä½¿ç”¨ redux å¹¶ä¸ä¼šæœ‰ä»€ä¹ˆæ‰€è°“çš„â€œç—›ç‚¹â€ï¼Œ<strong>å› ä¸º redux é»˜è®¤åªæ”¯æŒåŒæ­¥æ“ä½œï¼Œè®©ä½¿ç”¨è€…è‡ªè¡Œé€‰æ‹©å¤„ç†å¼‚æ­¥</strong>ï¼Œå¯¹äºå¼‚æ­¥è¯·æ±‚ redux æ˜¯æ— èƒ½ä¸ºåŠ›çš„ã€‚å¯ä»¥è¿™ä¹ˆè¯´ï¼Œå®ƒä¿è¯è‡ªå·±æ˜¯çº¯ç²¹çš„ï¼Œè„æ´»ç´¯æ´»éƒ½ä¸¢ç»™åˆ«äººå»å¹²ã€‚</p>\n<p>äºæ˜¯æˆ‘çš„ç—›ç‚¹åœ¨äº : å¦‚ä½•å¤„ç†å¼‚æ­¥è¯·æ±‚ï¼Œä¸ºæ­¤æˆ‘ä½¿ç”¨äº† redux-saga å»è§£å†³å¼‚æ­¥çš„é—®é¢˜</p>\n<p>ä½†æ˜¯åœ¨ä½¿ç”¨ <code>redux + redux-saga</code> ä¸­ï¼Œæˆ‘å‘ç°ï¼Œè¿™ä¼šè®©æˆ‘çš„ <strong>[é‡å¤æ€§]</strong> å·¥ä½œå˜å¤š(é€æ­¥æ™‹å‡ CV å·¥ç¨‹å¸ˆ)ï¼Œå› ä¸ºå®ƒåœ¨æˆ‘ä»¬é¡¹ç›®ä¸­ï¼Œä¼šå­˜åœ¨å•°å—¦çš„æ ·æ¿ä»£ç ã€‚</p>\n<p>ä¸¾ä¸ª ğŸŒ° : å¼‚æ­¥è¯·æ±‚ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯ï¼Œæˆ‘éœ€è¦åˆ›å»º <code>sagas/user.js</code>ã€<code>reducers/user.js</code>ã€<code>actions/user.js</code>ï¼Œä¸ºäº†ç»Ÿä¸€ç®¡ç† constï¼Œæˆ‘è¿˜ä¼šæœ‰ä¸€ä¸ª <code>const/user.js</code>ï¼Œç„¶ååœ¨è¿™äº›æ–‡ä»¶ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚</p>\n<blockquote>\n<p>åˆ†æ–‡ä»¶åº”è¯¥æ˜¯ä¸€ç§é»˜è®¤çš„è§„èŒƒå§ï¼Ÿ</p>\n</blockquote>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-comment\">// const/user.js</span>\n<span class=\"hljs-keyword\">const</span> FETCH_USER_INFO = <span class=\"hljs-string\">'FETCH_USER_INFO'</span>\n<span class=\"hljs-keyword\">const</span> FETCH_USER_INFO_SUCCESS = <span class=\"hljs-string\">'FETCH_USER_INFO_SUCCESS'</span>\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-comment\">// actions/user.js</span>\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">fetchUserInfo</span>(<span class=\"hljs-params\">params, callback</span>) </span>{\n  <span class=\"hljs-keyword\">return</span> {\n    <span class=\"hljs-attr\">type</span>: FETCH_USER_INFO,\n    params,\n    callback,\n  }\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-comment\">// sagas/user.js</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>* <span class=\"hljs-title\">fetchUserInfoSaga</span>(<span class=\"hljs-params\">{ params, callback }</span>) </span>{\n  <span class=\"hljs-keyword\">const</span> res = <span class=\"hljs-keyword\">yield</span> call(fetch.callAPI, {\n    <span class=\"hljs-attr\">actionName</span>: FETCH_USER_INFO,\n    params,\n  })\n  <span class=\"hljs-keyword\">if</span> (res.code === <span class=\"hljs-number\">0</span>) {\n    <span class=\"hljs-keyword\">yield</span> put({\n      <span class=\"hljs-attr\">type</span>: FETCH_USER_INFO_SUCCESS,\n      <span class=\"hljs-attr\">data</span>: res.data,\n    })\n    callback && callback()\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-keyword\">throw</span> res.msg\n  }\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-comment\">// reducers/user.js</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">userReducer</span>(<span class=\"hljs-params\">state, action</span>) </span>{\n  <span class=\"hljs-keyword\">switch</span> (action.type) {\n    <span class=\"hljs-keyword\">case</span> FETCH_USER_INFO_SUCCESS:\n      <span class=\"hljs-keyword\">return</span> Immutable.set(state, <span class=\"hljs-string\">'userInfo'</span>, action.data)\n  }\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>æ²¡é”™ï¼Œ è¿™ç§æ ·æ¿ä»£ç ï¼Œç®€ç›´å°±æ˜¯ CV æ“ä½œï¼Œåªéœ€è¦ copy ä¸€ä»½ï¼Œä¿®æ”¹ä¸€ä¸‹åç§°ï¼Œå¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œè¿™ä¼šè®©æˆ‘ä¸å¤Ÿä¸“æ³¨ï¼Œåˆ†æ•£ç®¡ç† constã€actionã€sagaã€reducer ä¸€å¥—æµç¨‹ï¼Œéœ€è¦ä¸æ–­çš„è·³è·ƒæ€è·¯ã€‚</p>\n<p>è€Œä¸”æ–‡ä»¶æ•°é‡ä¼šå˜å¤šï¼Œæˆ‘æ˜¯çœŸçš„ä¸å–œæ¬¢å¦‚æ­¤<code>ç¹ç</code>çš„æµç¨‹ï¼Œæœ‰æ²¡æœ‰å¥½çš„æ¡†æ¶èƒ½å¸®æˆ‘æŠŠè¿™äº›äº‹éƒ½åšå®Œå‘¢ï¼Ÿ</p>\n<h2 data-id=\"heading-2\">dva</h2>\n<p><strong>dvaï¼ŒåŸºäº redux å’Œ redux-saga çš„æ•°æ®æµæ–¹æ¡ˆï¼Œè®©ä½ åœ¨ä¸€ä¸ª model æ–‡ä»¶ä¸­å†™æ‰€æœ‰çš„ <code>actionã€stateã€effectã€reducers</code>ç­‰ï¼Œç„¶åä¸ºäº†ç®€åŒ–å¼€å‘ä½“éªŒï¼Œå†…ç½®äº† react-router å’Œ fetch</strong>.</p>\n<p>èŠèŠæˆ‘å¯¹ dva çš„çœ‹æ³•ï¼Œå®˜æ–¹è¯´äº†ï¼ŒåŸºäº <code>redux</code> + <code>redux-saga</code> çš„æ–¹æ¡ˆï¼Œåªæ˜¯åœ¨ä½ å†™çš„æ—¶å€™ï¼Œéƒ½å†™åœ¨ä¸€ä¸ª model æ–‡ä»¶ï¼Œç„¶åå®ƒå¸®ä½ åšä¸€äº›å¤„ç†ï¼›å…¶æ¬¡å®ƒæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåº“ï¼Œæ˜¯å¦æ„å‘³ç€: æˆ‘åœ¨é¡¹ç›®å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å°±éœ€è¦ç¡®å®šé¡¹ç›®çš„æ¶æ„æ˜¯ä¸æ˜¯ç”¨ dvaï¼Œå¦‚æœå¼€å‘ä¸€åŠï¼Œæˆ‘æƒ³æ¢æˆ dva è¿™ç§çŠ¶æ€ç®¡ç†çš„å†™æ³•ï¼Œè€Œå»å¼•å…¥ dva ï¼Œæ˜¯å¦ä¸åˆç†ï¼Ÿ</p>\n<p>å†æˆ–è€…ï¼Œæˆ‘åªæ˜¯åšä¸€äº› demoã€å†™ç‚¹å°å‹çš„ä¸ªäººé¡¹ç›®ï¼Œä½†æˆ‘åˆæƒ³åƒå†™ dva çš„æ•°æ®çŠ¶æ€ç®¡ç† model é‚£ç§æ–¹å¼ï¼Œå¼•å…¥ dva æ˜¯ä¸æ˜¯åè€Œå˜å¾—ç¬¨é‡å‘¢ï¼Ÿ</p>\n<p>å›è¿‡å¤´æ¥çœ‹ï¼Œæˆ‘çš„å‡ºå‘ç‚¹æ˜¯ : åœ¨äºè§£å†³ç¹çé‡å¤çš„å·¥ä½œï¼Œstore æ–‡ä»¶åˆ†æ•£ï¼Œstate ç±»å‹å’Œèµ‹å€¼é”™è¯¯çš„é—®é¢˜ï¼Œä¸ºæ­¤ï¼Œå¯¹äºè·Ÿæˆ‘ä¸€æ ·çš„ç”¨æˆ·ï¼Œæä¾›äº†ä¸€ä¸ªå†™çŠ¶æ€ç®¡ç†è¾ƒä¸º[èˆ’æœ]çš„ä¹¦å†™æ–¹å¼ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å…¼å®¹åŸå…ˆé¡¹ç›®ï¼Œåªéœ€è¦å®‰è£…è¿™ä¸ªåŒ…ï¼Œå°±èƒ½å¼•å…¥ä¸€å¥—æ•°æ®ç®¡ç†æ–¹æ¡ˆï¼Œå†™èµ·æ¥åˆèˆ’æœç®€æ´ï¼Œå¼€å¿ƒå¼€å¿ƒçš„æ’¸ä»£ç ï¼Œä¸é¦™å—ï¼Ÿ</p>\n<h2 data-id=\"heading-3\">å†æ¬¡æ˜ç¡®</h2>\n<p><strong>rc-redux-model å‡ºå‘ç‚¹åœ¨äºè§£å†³ç¹çé‡å¤çš„å·¥ä½œï¼Œstore æ–‡ä»¶åˆ†æ•£ï¼Œstate ç±»å‹å’Œèµ‹å€¼é”™è¯¯çš„é—®é¢˜ï¼Œä¸ºæ­¤ï¼Œå¯¹äºè·Ÿæˆ‘ä¸€æ ·çš„ç”¨æˆ·ï¼Œæä¾›äº†ä¸€ä¸ªå†™çŠ¶æ€ç®¡ç†è¾ƒä¸º[èˆ’æœ]çš„ä¹¦å†™æ–¹å¼ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹å…¼å®¹åŸå…ˆé¡¹ç›®</strong>~</p>\n<ul>\n<li>ä¸ºäº†è§£å†³[store æ–‡ä»¶åˆ†æ•£]ï¼Œå‚è€ƒå€Ÿé‰´äº† dva å†™çŠ¶æ€ç®¡ç†çš„æ–¹å¼ï¼Œä¸€ä¸ª model ä¸­å†™æ‰€æœ‰çš„ <code>actionã€stateã€reducers</code></li>\n<li>ä¸ºäº†è§£å†³[ç¹çé‡å¤çš„å·¥ä½œ]ï¼Œæä¾›é»˜è®¤çš„ actionï¼Œç”¨æˆ·ä¸éœ€è¦è‡ªå·±å†™ä¿®æ”¹ state çš„ actionï¼Œåªéœ€è¦è°ƒç”¨é»˜è®¤æä¾›çš„ <code>[model.namespace/setStore]</code> å³å¯ï¼Œä»è€Œå°†ä¸€äº›é‡å¤çš„ä»£ç ä» model æ–‡ä»¶ä¸­å‰”é™¤</li>\n<li>ä¸ºäº†è§£å†³[state ç±»å‹å’Œèµ‹å€¼é”™è¯¯]ï¼Œåœ¨æ¯æ¬¡ä¿®æ”¹ state å€¼æ—¶å€™ï¼Œéƒ½ä¼šè¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœä¸é€šè¿‡åˆ™æŠ¥é”™æç¤º</li>\n</ul>\n<h2 data-id=\"heading-4\">åˆå»ºé›å½¢</h2>\n<p>ç”±äºä¹‹å‰çœ‹è¿‡ redux æºç ï¼ŒåŒæ—¶ä¹Ÿçœ‹äº†ä¸€ä¸‹ redux-thunk çš„æºç ï¼Œå¹¶ä¸”æŸ¥é˜…äº†ä¸€äº›ç›¸å…³æ–‡ç« ï¼Œæœ‰äº†ä¸€äº›çŸ¥è¯†å‚¨å¤‡ï¼Œè¯´å¹²å°±å¹²ï½</p>\n<p>å‚è€ƒäº† dva ä¸­å¯¹ model çš„å‚æ•°è¯´æ˜ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰äº† redux-saga ï¼Œæ‰€ä»¥æ˜¯æ²¡æœ‰ <code>effect</code> è¿™ä¸ªå±æ€§çš„ï¼Œäºæ˜¯åˆæ­¥å¾—åˆ°æˆ‘çš„ model å‚æ•°</p>\n<img width=\"300\" class=\"lazyload\" src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f31616f946e4f6197bffb9dfcf880c5~tplv-k3u1fbpfcp-zoom-1.image\" data-width=\"800\" data-height=\"600\" referrerpolicy=\"no-referrer\">\n<p>æŒ‰ç…§æˆ‘çš„è®¾æƒ³ï¼Œæˆ‘ä¼šå­˜åœ¨å¤šä¸ª model æ–‡ä»¶ï¼Œèšé›†åœ¨ä¸€èµ·ä¹‹åï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªæ•°ç»„ :</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-keyword\">import</span> aModel <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'./aModel'</span>\n<span class=\"hljs-keyword\">import</span> bModel <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'./bModel'</span>\n<span class=\"hljs-keyword\">import</span> cModel <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'./cModel'</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> [aModel, bModel, cModel]\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>æˆ‘æ‰€å¸Œæœ›çš„æ˜¯ : ä¼ å…¥ä¸€ä¸ª <code>Array<IModelProps></code>ï¼Œå¾—åˆ°ä¸€ä¸ª <code>RcReduxModel</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ‹¥æœ‰å¾—ç»™æˆ‘å¯¼å‡º :</p>\n<ul>\n<li>reducers: æ‰€æœ‰ model.reducers é›†åˆï¼Œè¿™æ ·æˆ‘å¯ä»¥æ— éšœç¢çš„ç”¨åœ¨ <code>store.combineReducers</code>ä¸­äº†ï¼ŒåŒæ—¶å¯ä»¥å…¼å®¹ä½ ç°æœ‰çš„é¡¹ç›®ï¼Œå› ä¸ºåªè¦ä½ ç”¨äº† reduxï¼Œ é‚£ä¹ˆä½ è‚¯å®šå¾—é€šè¿‡ <code>combineReducers API</code> å»é›†åˆæ‰€æœ‰çš„ reducers</li>\n</ul>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-comment\">// createStore.js</span>\n<span class=\"hljs-keyword\">import</span> models <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'./models'</span>\n<span class=\"hljs-keyword\">import</span> RcReduxModel <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'rc-redux-model'</span>\n\n<span class=\"hljs-keyword\">const</span> reduxModel = <span class=\"hljs-keyword\">new</span> RcReduxModel(models)\n\n<span class=\"hljs-keyword\">const</span> reducerList = combineReducers(reduxModel.reducers)\n<span class=\"hljs-keyword\">return</span> createStore(reducerList)\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<h2 data-id=\"heading-5\">å¼‚æ­¥å¤„ç†</h2>\n<p>å…¶å®æˆ‘æ›´åŠ å¸Œæœ›çš„æ˜¯ï¼Œç”±ç”¨æˆ·è‡ªè¡Œå¤„ç†å¼‚æ­¥ï¼Œç„¶åå†å‘èµ·åŒæ­¥Actionï¼Œå°†æ•°æ®å¡åˆ° redux ä¸­ï¼Œä½†æ˜¯å¼‚æ­¥å¤„ç†è¿˜æ˜¯å¾—æä¾›çš„ï¼Œæ‰€ä»¥å°±å¾—æƒ³ï¼Œè¯¥å¦‚ä½•å¤„ç†å¼‚æ­¥é—®é¢˜ï¼Ÿ</p>\n<p>ç›¸å¯¹æ¯” <code>redux-thunk</code> ä¸ <code>redux-saga</code> ï¼Œåœ¨çœ‹äº† thunk çš„æºç ä¹‹åï¼Œè§‰å¾—å…¶æç®€å•ï¼Œå¹¶ä¸”æ›´å€¾å‘äºæˆ‘çš„å‡ºå‘ç‚¹ï¼Œå‡ºäºå­¦ä¹ ï¼Œä»¥åŠåœ¨ä½¿ç”¨ä¸Šå¸¦ç»™æˆ‘çš„[ä½“éªŒ]ï¼Œæˆ‘åœ¨æƒ³ï¼Œèƒ½å¦å‚è€ƒä¸€æ³¢æºç ï¼Œç„¶åå®ç°ä¸€ä¸ªï¼Ÿ</p>\n<blockquote>\n<p>issuesåŒºæœ‰äººæé—®<a href=\"https://github.com/SugarTurboS/rc-redux-model/issues/6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ä¸ºä»€ä¹ˆä½¿ç”¨redux-thunkä¸ä½¿ç”¨redux-sagaåšä¸ºä¸­é—´ä»¶ï¼Ÿ</a>ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹</p>\n</blockquote>\n<p>äºæ˜¯ï¼Œæˆ‘å»å°† <code>redux-thunk</code> çš„æºç çœ‹äº†ä¸€éï¼Œæœ€åå¾—å‡ºäº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ : å¯¹æ¯” redux-thunk ï¼Œå…¶å†…éƒ¨åœ¨äºåˆ¤æ–­ä½ çš„ action æ˜¯ function è¿˜æ˜¯ objectï¼Œä»è€Œåˆ¤æ–­ä½ çš„ action æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼›è€Œåœ¨ <code>rc-redux-model</code> ä¸­ï¼Œç”­ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œæˆ‘è§„å®šçš„æ¯ä¸€ä¸ª action éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå°±æ˜¯ä½ å‘èµ·çš„æ¯ä¸€ä¸ª actionï¼Œéƒ½æ˜¯å‡½æ•° :</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\">aModel = {\n  <span class=\"hljs-attr\">action</span>: {\n    <span class=\"hljs-comment\">// è¿™ä¸¤ä¸ª action éƒ½æ˜¯ function</span>\n    firstAction: <span class=\"hljs-function\">(<span class=\"hljs-params\">{ getState, dispatch }</span>) =></span> {},\n    <span class=\"hljs-attr\">secondAction</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">{ getState, dispatch }</span>) =></span> {},\n  },\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>å³ä½¿ä½ æƒ³è¦å‘èµ·ä¸€ä¸ªåŒæ­¥ actionï¼Œå»ä¿®æ”¹ state çš„å€¼ï¼Œæˆ‘ä¹Ÿä¼šå°†å…¶ä½œä¸ºå¼‚æ­¥è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯ä½ ä¿®æ”¹ state å€¼ï¼Œä½ éœ€è¦è¿™ä¹ˆå†™ :</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-comment\">// ç»„ä»¶</span>\n<span class=\"hljs-keyword\">this</span>.props.dispatch({\n  <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">'aModel/setStateA'</span>,\n  <span class=\"hljs-attr\">payload</span>: <span class=\"hljs-string\">'666'</span>,\n})\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\">aModel = {\n  <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">'aModel'</span>,\n  <span class=\"hljs-attr\">state</span>: {\n    <span class=\"hljs-attr\">a</span>: <span class=\"hljs-string\">'111'</span>,\n  },\n  <span class=\"hljs-attr\">action</span>: {\n    <span class=\"hljs-comment\">// è¿™é‡Œæ˜¯å¼‚æ­¥actionï¼Œè¿™é‡Œéœ€è¦ç”¨æˆ·è‡ªå·±æ‰‹åŠ¨ dispatch å»ä¿®æ”¹ state å€¼</span>\n    setStateA: <span class=\"hljs-function\">(<span class=\"hljs-params\">{ currentAction, dispatch, commit }</span>) =></span> {\n      dispatch({\n        <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">'aModel/CHANGE_STATE_A'</span>,\n        <span class=\"hljs-attr\">payload</span>: currentAction.payload,\n      })\n      <span class=\"hljs-comment\">// æˆ–è€…æ˜¯ä½¿ç”¨ commit</span>\n      <span class=\"hljs-comment\">//   commit({</span>\n      <span class=\"hljs-comment\">//     type: 'CHANGE_STATE_A',</span>\n      <span class=\"hljs-comment\">//     payload: currentAction.payload,</span>\n      <span class=\"hljs-comment\">//   })</span>\n    },\n  },\n  <span class=\"hljs-attr\">reducers</span>: {\n    [<span class=\"hljs-string\">'CHANGE_STATE_A'</span>](state, payload) {\n      <span class=\"hljs-keyword\">return</span> {\n        ...state,\n        <span class=\"hljs-attr\">a</span>: payload,\n      }\n    },\n  },\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>æ˜ç¡®äº†è¿™ä¸¤ç‚¹ï¼Œæ¥ä¸‹æ¥å°±åªéœ€è¦å¼€å‘å³å¯ã€‚å¦‚æœå‰è¾¹çœ‹è¿‡æˆ‘å†™ redux æºç åˆ†æåˆ°è¯ï¼Œå¯ä»¥çŸ¥é“ reducer æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘æ³¨å†Œ reducer ä¸­æ—¶ï¼Œä¸€å®šè¦æ˜ç¡®è¿™ç‚¹: (ä»¥ä¸‹ä»£ç æ‘˜æŠ„ rc-redux-model æºç )</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\">public registerReducers(model: IModelProps) {\n    <span class=\"hljs-keyword\">const</span> { namespace, state, reducers } = model\n    <span class=\"hljs-comment\">// 1æ£€æŸ¥ reducers</span>\n    invariant(reducers, <span class=\"hljs-string\">`model's reducers must be defined, but got undefined`</span>)\n\n    <span class=\"hljs-comment\">// 1.1 å¾—åˆ°æ‰€æœ‰ reducers ä¸­çš„ action</span>\n    <span class=\"hljs-keyword\">const</span> reducersActionTypes = <span class=\"hljs-built_in\">Object</span>.keys(reducers)\n\n    <span class=\"hljs-comment\">// 1.2 reducers æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œfunction(state, action) {}</span>\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-function\">(<span class=\"hljs-params\">storeState: any, storeAction: any</span>) =></span> {\n      <span class=\"hljs-keyword\">const</span> newState = storeState || state\n      <span class=\"hljs-comment\">// 1.3 å¯¹ action è¿›è¡Œå¤„ç†ï¼Œè§„å®š action.type éƒ½æ˜¯ namespace/actionName çš„æ ¼å¼</span>\n      <span class=\"hljs-keyword\">const</span> reducersActionKeys = storeAction.type.split(<span class=\"hljs-string\">'/'</span>)\n\n      <span class=\"hljs-keyword\">const</span> reducersActionModelName = reducersActionKeys[<span class=\"hljs-number\">0</span>]\n      <span class=\"hljs-keyword\">const</span> reducersActionSelfName = reducersActionKeys[<span class=\"hljs-number\">1</span>]\n\n      <span class=\"hljs-comment\">// 1.3.1 å¦‚æœä¸æ˜¯å½“å‰çš„ model</span>\n      <span class=\"hljs-keyword\">if</span> (reducersActionModelName !== namespace) <span class=\"hljs-keyword\">return</span> newState\n      <span class=\"hljs-comment\">// 1.3.2 å¦‚æœåœ¨ reducers ä¸­å­˜åœ¨è¿™ä¸ª action</span>\n      <span class=\"hljs-keyword\">if</span> (reducersActionTypes.includes(reducersActionSelfName)) {\n        <span class=\"hljs-keyword\">return</span> reducers[reducersActionSelfName](newState, storeAction.payload)\n      }\n      <span class=\"hljs-keyword\">return</span> newState\n    }\n  }\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>å…¶æ¬¡æ˜¯å¯¹äºä¸­é—´ä»¶çš„å¼€å‘ï¼Œæ¯ä¸€ä¸ªä¸­é—´ä»¶éƒ½æ˜¯ <code>store => next => action</code> çš„å½¢å¼(ä¸å¤ªäº†è§£ä¸­é—´ä»¶çš„å¯ä»¥è‡ªè¡Œå»äº†è§£ä¸€æ³¢)ï¼Œæ‰€ä»¥æˆ‘å¾ˆç®€å•å°±å¯ä»¥å†™å‡ºè¿™æ®µä»£ç  ï¼š</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-keyword\">const</span> registerMiddleWare = <span class=\"hljs-function\">(<span class=\"hljs-params\">models: any</span>) =></span> {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-function\">(<span class=\"hljs-params\">{ dispatch, getState }</span>) =></span> (next: any) => <span class=\"hljs-function\">(<span class=\"hljs-params\">action: any</span>) =></span> {\n    <span class=\"hljs-comment\">// è¿™ä¸ª action æ˜¯æˆ‘ this.props.dispatch å‘èµ·çš„action</span>\n    <span class=\"hljs-comment\">// æ‰€ä»¥æˆ‘éœ€è¦æ‰¾åˆ°å®ƒå…·ä½“å¯¹åº”çš„æ˜¯å“ªä¸ª model.namespace çš„</span>\n    <span class=\"hljs-comment\">// å‰è¾¹å·²ç»å¯¹ model.namespace åšäº†åˆ¤æ–­ï¼Œç¡®ä¿æ¯ä¸ª model.namespace å¿…é¡»å”¯ä¸€ï¼Œä¸èƒ½é‡å¤</span>\n    <span class=\"hljs-comment\">// æ‰¾åˆ°è¯¥ modelï¼Œç„¶åå†æ‰¾åˆ°è¿™ä¸ª model.action ä¸­å¯¹åº”æˆ‘å‘èµ·çš„ action</span>\n    <span class=\"hljs-comment\">// å› ä¸ºæ¯ä¸€ä¸ª action éƒ½æ˜¯ä»¥ [model.namespace/actionName] çš„å½¢å¼ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥ split ä¹‹åå¾—åˆ° namespace</span>\n    <span class=\"hljs-keyword\">const</span> actionKeyTypes = action.type.split(<span class=\"hljs-string\">'/'</span>)\n    <span class=\"hljs-keyword\">const</span> actionModelName = actionKeyTypes[<span class=\"hljs-number\">0</span>]\n    <span class=\"hljs-keyword\">const</span> actionSelfName = actionKeyTypes[<span class=\"hljs-number\">1</span>]\n\n    <span class=\"hljs-keyword\">const</span> currentModel = getCurrentModel(actionModelName, models)\n\n    <span class=\"hljs-keyword\">if</span> (currentModel) {\n      <span class=\"hljs-keyword\">const</span> currentModelAction = currentModel.action\n        ? currentModel.action[actionSelfName]\n        : <span class=\"hljs-literal\">null</span>\n      <span class=\"hljs-comment\">// å‚è€ƒredux-thunkçš„å†™æ³•ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯functionï¼Œå¦‚æœæ˜¯ï¼Œè¯´æ˜æ˜¯ä¸ªthunk</span>\n      <span class=\"hljs-keyword\">if</span> (currentModelAction && <span class=\"hljs-keyword\">typeof</span> currentModelAction === <span class=\"hljs-string\">'function'</span>) {\n        <span class=\"hljs-keyword\">return</span> currentModelAction({\n          dispatch,\n          getState,\n          <span class=\"hljs-attr\">currentAction</span>: action,\n        })\n      }\n      <span class=\"hljs-comment\">// å› ä¸ºè¿™é‡Œçš„actionï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå‘åˆ°reducerï¼Œä¿®æ”¹stateçš„å€¼</span>\n      <span class=\"hljs-comment\">// ä½†æ˜¯åœ¨ model.action ä¸­æ˜¯ç›´æ¥å†™çš„æ˜¯ commit reducerAction</span>\n      <span class=\"hljs-comment\">// è€Œæˆ‘çš„æ¯ä¸€ä¸ªactionéƒ½è¦[model.namespace/actionName]æ ¼å¼</span>\n      <span class=\"hljs-comment\">// æ‰€ä»¥è¿™é‡Œéœ€è¦å¤„ç†ï¼Œå¹¶ä¸”åˆ¤æ–­è¿™ä¸ªactionæ˜¯ä¸æ˜¯åœ¨reducersä¸­å­˜åœ¨</span>\n      <span class=\"hljs-comment\">// è¿™é‡Œå°±ä¸è´´ä»£ç äº†ï¼Œæ„Ÿå…´è¶£çš„ç›´æ¥å»çœ‹æºç ï½</span>\n    }\n  }\n  <span class=\"hljs-keyword\">return</span> next(action)\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>ä¸Šè¾¹æ˜¯æ‘˜æŠ„äº†éƒ¨åˆ†æºç ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å»çœ‹çœ‹æºç ï¼Œå¹¶ä¸å¤šï¼Œå¹¶ä¸”æºç ä¸­æˆ‘éƒ½å†™äº†æ³¨é‡Šã€‚ç»è¿‡ä¸æ–­è°ƒè¯•ï¼Œå¹¶ä¸”é€šè¿‡ jest å†™äº†å•å…ƒæµ‹è¯•ï¼Œå¹¶æ²¡æœ‰å•¥æ¯›ç—…ï¼Œäºæ˜¯æˆ‘å…´è‡´å‹ƒå‹ƒå¾—ç»™èº«è¾¹çš„åŒäº‹å®‰åˆ©äº†ä¸€æ³¢ï¼Œæ²¡æƒ³åˆ°è¢« ğŸ‘Š æ‰“å‡»äº†</p>\n<h2 data-id=\"heading-6\">æä¾›é»˜è®¤è¡Œä¸ºï¼Œè‡ªåŠ¨æ³¨å†Œ action åŠ reducers</h2>\n<p>â€œåªæœ‰è¢«æ€¼è¿‡ï¼Œæ‰èƒ½çŸ¥é“ä½ åšçš„æ˜¯ä»€ä¹ˆç ´ç©æ„â€ï¼Œåœ¨æˆ‘ç»™å°ä¼™ä¼´å®‰åˆ©çš„æ—¶å€™ï¼Œä»–é—® : â€œé‚£ä½ è¿™ä¸œè¥¿ï¼Œæœ‰ä»€ä¹ˆç”¨ï¼Ÿâ€ï¼Œæˆ‘è¯´å†™çŠ¶æ€æ•°æ®åƒå†™ dva ä¸€æ ·èˆ’æœï¼Œäºæ˜¯ä»–åˆè¯´ï¼Œé‚£æˆ‘ä¸ºä»€ä¹ˆä¸ç”¨ dva å‘¢ï¼Ÿ</p>\n<p>è§£é‡Šä¸€æ³¢åï¼Œä»–æ¥ç€è¯´: â€œä¸å¯å¦è®¤çš„æ˜¯ï¼Œä½ è¿™ä¸ªåº“ï¼Œå†™çŠ¶æ€æ•°æ®èµ·æ¥ç¡®å®èˆ’æœï¼Œä½†æˆ‘ä½œä¸ºä¸€ä¸ªä½¿ç”¨è€…ï¼Œè¦åœ¨ç»„é‡Œæ¨å¹¿ä½¿ç”¨ï¼Œä»…é æ­¤åŠŸèƒ½ï¼Œæ˜¯æ— æ³•è¯´æœæˆ‘ç»„é‡Œçš„äººéƒ½ç”¨ä½ è¿™ä¸ªä¸œè¥¿ï¼Œé™¤éä½ è¿˜èƒ½æä¾›ä¸€äº›åŠŸèƒ½ã€‚æ¯”å¦‚è¯´ï¼Œä½ çš„ action éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œç­‰ä»·äºä¿®æ”¹ state çš„ actionï¼Œéƒ½éœ€è¦æˆ‘è‡ªå·±å»å†™ï¼Œå‡è®¾æˆ‘æœ‰ 20 ä¸ª stateï¼Œæ„å‘³ç€æˆ‘å¾—åœ¨ model.action ä¸­ï¼Œå†™å¯¹åº”çš„ 20 ä¸ªä¿®æ”¹ state çš„ actionï¼Œç„¶ååœ¨ model.reducers ä¸­åŒæ ·å†™ 20 ä¸ªç›¸å¯¹åº”çš„ reducerï¼Œä½œä¸ºä½¿ç”¨è€…ï¼Œæˆ‘çš„å·¥ä½œé‡æ˜¯ä¸æ˜¯å¾ˆå¤§ï¼Œå¦‚æœä½ èƒ½æä¾›ä¸€ä¸ªé»˜è®¤çš„ action è¡Œä¸ºç»™æˆ‘ï¼Œé‚£ä¹ˆæˆ‘è¿˜å¯èƒ½ä¼šç”¨â€</p>\n<p>ä»”ç»†ä¸€æƒ³ï¼Œç¡®å®å¦‚æ­¤ï¼Œé‚£æˆ‘å°±æä¾›ä¸€ä¸ªé»˜è®¤çš„ actionï¼Œç”¨äºç”¨æˆ·ä¿®æ”¹ state çš„å€¼å§ï¼Œå½“æˆ‘æä¾›äº†æ­¤ action ä¹‹åï¼Œæˆ‘åˆå‘ç°ï¼Œæ‰€æœ‰ä¿®æ”¹ state çš„ actionï¼Œéƒ½èµ°åŒä¸€ä¸ª <code>action.type</code>ï¼Œé‚£ä¹ˆåœ¨ <a href=\"https://github.com/zalmoxisus/redux-devtools-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">redux-devtools-extension</a> ä¸­ï¼Œæ˜¯å¾ˆéš¾å‘ç°è¿™ä¸ª action è§¦å‘ï¼Œå…·ä½“æ˜¯ä¸ºäº†ä¿®æ”¹å“ªä¸ª state å€¼ã€‚</p>\n<p>ä½†æ˜¯æ­£å¦‚ä½¿ç”¨è€…è¯´çš„ï¼Œå¦‚æœæœ‰ 20 ä¸ª state å€¼ï¼Œé‚£ä¹ˆæˆ‘ä¸ºç”¨æˆ·è‡ªåŠ¨æ³¨å†Œ 20 ä¸ª actionï¼Œç”¨æˆ·åœ¨ä½¿ç”¨ä¸Šæ˜¯å¦éœ€è¦è®°ä½æ¯ä¸€ä¸ª state å¯¹åº”çš„ action å‘¢ï¼Ÿè¿™è‚¯å®šæ˜¯æå…¶ä¸åˆç†çš„ï¼Œæ‰€ä»¥æœ€ç»ˆè§£å†³æ–¹æ¡ˆä¸º : ä¸ºæ¯ä¸€ä¸ª state ï¼Œè‡ªåŠ¨æ³¨å†Œå¯¹åº”çš„ action å’Œ reducerï¼Œ åŒæ—¶å†æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„ action(setStore)</p>\n<blockquote>\n<p>âœ¨ ä¾‹ : state æœ‰ n ä¸ªå€¼ï¼Œé‚£ä¹ˆæœ€ç»ˆä¼šè‡ªåŠ¨æ³¨å†Œ n+1 ä¸ª actionï¼Œç”¨æˆ·åªéœ€è¦è®°ä½å¹¶è°ƒç”¨é»˜è®¤çš„è¿™ä¸ª action å³å¯</p>\n</blockquote>\n<img width=\"700\" class=\"lazyload\" src=\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e8413cfa4f5049cc8b6eface77808736~tplv-k3u1fbpfcp-zoom-1.image\" data-width=\"800\" data-height=\"600\" referrerpolicy=\"no-referrer\">\n<p>ç”¨æˆ·åªéœ€è¦è°ƒç”¨é»˜è®¤æä¾›çš„ <code>setStore</code> å³å¯ï¼Œç„¶åæ ¹æ® key è¿›è¡Œåˆ¤æ–­ï¼Œä»è€Œè½¬å‘åˆ°å¯¹åº”åˆ° action ä¸Š ï½ ä½¿ç”¨èµ·æ¥æå…¶ç®€å•</p>\n<blockquote>\n<p><strong>å¯¹å¤–æä¾›ç»Ÿä¸€é»˜è®¤ actionï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼›å¯¹å†…æ ¹æ® keyï¼Œè¿›è¡ŒçœŸå® action çš„è½¬å‘</strong></p>\n</blockquote>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-keyword\">this</span>.props.dispatch({\n  <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">'[model.namespace]/setStore'</span>,\n  <span class=\"hljs-attr\">payload</span>: {\n    <span class=\"hljs-attr\">key</span>: [model.state.key]\n    values: [your values]\n  }\n})\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<h2 data-id=\"heading-7\">æ•°æ®ä¸å¯å˜</h2>\n<p>åœ¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæ•°æ®æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€æœ‰çš„æ•°æ®ä¸€æ—¦äº§ç”Ÿï¼Œå°±ä¸èƒ½æ”¹å˜å…¶ä¸­çš„å€¼ï¼Œå¦‚æœè¦æ”¹å˜ï¼Œé‚£å°±åªèƒ½ç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°æ®ã€‚åœ¨æˆ‘çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä½¿ç”¨äº† <code>seamless-immutable</code>ï¼Œé‚£ä¹ˆåœ¨ model.state ä¸­ï¼Œæˆ‘ä½¿ç”¨äº† Immutable åŒ…è£¹äº† stateï¼Œç„¶åè°ƒç”¨é»˜è®¤æä¾›çš„ actionï¼Œæœ€åä¼šæŠ¥é”™ï¼Œæ‡‚çš„éƒ½æ‡‚ !</p>\n<p>é‚£ä¹ˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿäºæ˜¯...æˆ‘åˆåœ¨å†…éƒ¨æ”¯æŒäº† Immutable ï¼Œæä¾›ä¸€ä¸ªé…ç½®å‚æ•° openSeamlessImmutableï¼Œé»˜è®¤ä¸º falseï¼Œè¯·æ³¨æ„ï¼Œå¦‚æœä½ çš„ state æ˜¯ Immutableï¼Œè€Œåœ¨ model ä¸­ä¸è®¾ç½®æ­¤é…ç½®ï¼Œé‚£ä¹ˆä¼šæŠ¥é”™ !!!</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-comment\">// ä½¿ç”¨ seamless-immutable</span>\n\n<span class=\"hljs-keyword\">import</span> Immutable <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">'seamless-immutable'</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">'appModel'</span>,\n  <span class=\"hljs-attr\">state</span>: Immutable({}),\n  <span class=\"hljs-attr\">openSeamlessImmutable</span>: <span class=\"hljs-literal\">true</span>, <span class=\"hljs-comment\">// å¿…é¡»å¼€å¯æ­¤é…ç½®!!!!!</span>\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<h2 data-id=\"heading-8\">è¿›ä¸€æ­¥å¤„ç†ç±»å‹ä¸ä¸€è‡´</h2>\n<p>ä¸å¯é¿å…ï¼Œå¼€å‘äººå‘˜ä¼šå­˜åœ¨ä¸€å®šçš„ç–å¿½ï¼Œæœ‰æ—¶åœ¨ <code>model.state</code> ä¸­å®šä¹‰å¥½æŸä¸ªå€¼çš„ç±»å‹ï¼Œä½†åœ¨æ”¹çš„æ—¶å€™å´å°†å…¶æ”¹ä¸ºå¦ä¸€ä¸ªç±»å‹ï¼Œä¾‹å¦‚ :</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">'userModel'</span>,\n  <span class=\"hljs-attr\">state</span>: {\n    <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">''</span>, <span class=\"hljs-comment\">// è¿™é‡Œå®šä¹‰ name ä¸º string ç±»å‹</span>\n  },\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>ä½†åœ¨ä¿®æ”¹æ­¤ state value æ—¶ï¼Œä¼ é€’çš„ç¡®æ˜¯ä¸€ä¸ªé string ç±»å‹çš„å€¼</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-keyword\">this</span>.props.dispatch({\n  <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">'userModel/setStore'</span>,\n  <span class=\"hljs-attr\">payload</span>: {\n    <span class=\"hljs-attr\">key</span>: <span class=\"hljs-string\">'name'</span>,\n    <span class=\"hljs-attr\">values</span>: {}, <span class=\"hljs-comment\">// è¿™é‡Œ name å˜æˆäº†object</span>\n  },\n})\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>è¿™å…¶å®æ˜¯ä¸åˆç†çš„ï¼Œåœ¨ rc-redux-model ä¸­ï¼Œä¼šé’ˆå¯¹éœ€è¦ä¿®æ”¹çš„ <code>state[key]</code> åšä¸€äº›ç±»å‹æ£€æµ‹å¤„ç†ï¼Œå¦‚ ğŸ‘</p>\n<img width=\"600\" class=\"lazyload\" src=\"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/630cc474b5e14dcab8d98fabda8709de~tplv-k3u1fbpfcp-zoom-1.image\" data-width=\"800\" data-height=\"600\" referrerpolicy=\"no-referrer\">\n<p>æ‰€æœ‰ä¿®æ”¹ state çš„å€¼ï¼Œå‰ææ˜¯ : è¯¥å€¼å·²ç»åœ¨ state ä¸­å®šä¹‰ï¼Œä»¥ä¸‹æƒ…å†µä¹Ÿä¼šæŠ¥é”™æç¤º</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">'userModel'</span>,\n  <span class=\"hljs-attr\">state</span>: {\n    <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">''</span>, <span class=\"hljs-comment\">// è¿™é‡Œåªå®šä¹‰ state ä¸­å­˜åœ¨ name</span>\n  },\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>æ­¤æ—¶æƒ³ä¿®æ”¹ state ä¸­çš„å¦ä¸€å±æ€§å€¼</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-keyword\">this</span>.props.dispatch({\n  <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">'userModel/setStore'</span>,\n  <span class=\"hljs-attr\">payload</span>: {\n    <span class=\"hljs-attr\">key</span>: <span class=\"hljs-string\">'testName'</span>,\n    <span class=\"hljs-attr\">values</span>: <span class=\"hljs-string\">'1'</span>, <span class=\"hljs-comment\">// è¿™é‡Œæƒ³ä¿®æ”¹ testName å±æ€§çš„å€¼</span>\n  },\n})\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>æåº¦ä¸åˆç†ï¼Œå› ä¸ºä½ åœ¨ state ä¸­å¹¶æ²¡æœ‰å£°æ˜æ­¤å±æ€§ï¼Œ rc-redux-model ä¼šé»˜è®¤å¸®ä½ åšæ£€æµ‹</p>\n<img width=\"600\" class=\"lazyload\" src=\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6263f40d5a1449cd999b32f07d0981f1~tplv-k3u1fbpfcp-zoom-1.image\" data-width=\"800\" data-height=\"600\" referrerpolicy=\"no-referrer\">\n<h2 data-id=\"heading-9\">å®‰åˆ©ä¸€æ³¢</h2>\n<p>æ›´å¤šç›¸å…³ä¿¡æ¯å¯å‰å¾€ : ğŸŒˆ <a href=\"https://github.com/SugarTurboS/rc-redux-model\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">rc-redux-model</a> ä¸­æŸ¥çœ‹ï¼ŒåŒæ—¶æœ‰é—®é¢˜å¯ä»¥åœ¨ <a href=\"https://github.com/SugarTurboS/rc-redux-model/issues\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">issues</a> ä¸­äº¤æµ</p>\n<blockquote>\n<p>rc-redux-model : å‚è€ƒäº† dva çš„æ•°æ®æµæ–¹æ¡ˆï¼Œåœ¨ä¸€ä¸ª model æ–‡ä»¶ä¸­å†™æ‰€æœ‰çš„ <code>action</code>ã€<code>reducer</code>ã€<code>state</code>ï¼Œè§£è¯»äº† <code>redux-thunk</code> çš„æºç ï¼Œå†…éƒ¨å®ç°äº†ä¸€ä¸ªä¸­é—´ä»¶ï¼ŒåŒæ—¶æä¾›é»˜è®¤è¡Œä¸º actionï¼Œè°ƒç”¨æ­¤ action å¯ä»¥ç›´æ¥ä¿®æ”¹ä»»æ„å€¼çš„ stateï¼Œæ–¹ä¾¿ç®€æ´ï¼Œè®©ä½ å¿ä¸ä½è¯´ <code>WC</code></p>\n</blockquote>\n<h3 data-id=\"heading-10\">ç‰¹æ€§</h3>\n<ul>\n<li>è½»å·§ç®€æ´ï¼Œå†™æ•°æ®ç®¡ç†å°±è·Ÿå†™ <code>dva</code> ä¸€æ ·èˆ’æœ</li>\n<li>å¼‚æ­¥è¯·æ±‚ç”±ç”¨æˆ·è‡ªè¡Œå¤„ç†ï¼Œå†…éƒ¨æ”¯æŒ call æ–¹æ³•ï¼Œå¯è°ƒç”¨æä¾›çš„æ–¹æ³•è¿›è¡Œè½¬å‘ï¼Œè¯¥æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª Promise</li>\n<li>å‚è€ƒ <code>redux-thunk</code>ï¼Œå†…éƒ¨å®ç°ç‹¬ç«‹çš„ä¸­é—´ä»¶ï¼Œæ‰€æœ‰çš„ action éƒ½æ˜¯å¼‚æ­¥ action</li>\n<li>æä¾›é»˜è®¤è¡Œä¸º actionï¼Œè°ƒç”¨æ­¤ action ï¼Œå¯ä»¥ä¿®æ”¹ä»»æ„çš„ state å€¼ï¼Œè§£å†³ä½ é‡å¤æ€§å†™ action ã€reducers é—®é¢˜</li>\n<li>å†…ç½® <code>seamless-immutable</code> ï¼Œåªéœ€å¼€å¯é…ç½®ï¼Œè®©ä½ çš„æ•°æ®ä¸å¯å˜</li>\n<li>é»˜è®¤æ£€æµ‹ä¸è§„èŒƒçš„èµ‹å€¼ä¸ç±»å‹é”™è¯¯ï¼Œè®©ä½ çš„æ•°æ®æ›´åŠ å¥å£®</li>\n</ul>\n<h3 data-id=\"heading-11\">ä½¿ç”¨</h3>\n<p>å¦‚æœ‰ç–‘é—®ï¼Œçœ‹ä¸‹è¾¹çš„ç›¸å…³è¯´æ˜~ åŒæ—¶å¯¹äºå¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œ<a href=\"https://github.com/SugarTurboS/rc-redux-model/issues/3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ğŸ‘‰ å¯ä»¥ç‚¹è¿™é‡Œ</a></p>\n<h4 data-id=\"heading-12\">æä¾›é»˜è®¤ actionï¼Œæ— éœ€é¢å¤–å¤šå†™ action/reducers</h4>\n<p>åŸå…ˆï¼Œæˆ‘ä»¬æƒ³è¦ä¿®æ”¹ state å€¼ï¼Œéœ€è¦åœ¨ reducers ä¸­å®šä¹‰å¥½ actionï¼Œä½†ç°åœ¨ï¼Œ <code>rc-redux-model</code> æä¾›é»˜è®¤çš„ action ç”¨äºä¿®æ”¹ï¼Œæ‰€ä»¥åœ¨ model ä¸­ï¼Œåªéœ€è¦å®šä¹‰ state å€¼å³å¯</p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">'appModel'</span>,\n  <span class=\"hljs-attr\">state</span>: {\n    <span class=\"hljs-attr\">value1</span>: <span class=\"hljs-string\">''</span>,\n  },\n}\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<p>åœ¨é¡µé¢ä¸­ï¼Œåªéœ€è¦è°ƒç”¨é»˜è®¤çš„ <code>[model.namespace/setStore]</code> å°±å¯ä»¥ä¿®æ”¹ state é‡Œçš„å€¼äº†ï¼Œç¾æ»‹æ»‹ï¼Œä¸éœ€è¦ä½ è‡ªå·±åœ¨ actionã€reducers å»å†™å¾ˆå¤šé‡å¤çš„ä¿®æ”¹ state ä»£ç </p>\n<pre><code class=\"hljs language-js copyable\" lang=\"js\"><span class=\"hljs-keyword\">this</span>.props.dispatch({\n  <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">'appModel/setStore'</span>,\n  <span class=\"hljs-attr\">payload</span>: {\n    <span class=\"hljs-attr\">key</span>: <span class=\"hljs-string\">'value1'</span>,\n    <span class=\"hljs-attr\">values</span>: <span class=\"hljs-string\">'appModel_state_value1'</span>,\n  },\n})\n<span class=\"copy-code-btn\">å¤åˆ¶ä»£ç </span></code></pre>\n<h2 data-id=\"heading-13\">ç»“å°¾</h2>\n<p>åˆ°æ­¤ï¼Œç»ˆäºå°†ä¸€å¥—æµç¨‹èµ°å®Œï¼ŒåŒæ—¶åœ¨ç»„é‡Œçš„é¡¹ç›®æ‹‰äº†ä¸ªåˆ†æ”¯ï¼Œå®è·µä½¿ç”¨äº†ä¸€æ³¢ï¼Œå®Œç¾å…¼å®¹ï¼Œæœªå‡ºé—®é¢˜ã€‚äºæ˜¯äº¤ä»˜äº†ç¬¬ä¸€ä¸ªå¯ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œè¿™æ¬¡ä¸€ä¸ªä¸­é—´ä»¶çš„å¼€å‘ï¼Œè®©æˆ‘å¯¹ redux çš„äº†è§£æ›´è¿‘å¼‚æ­¥ï¼Œæœ€åï¼ŒğŸ‘ æ¬¢è¿å¤§å®¶ç•™è¨€ä¸€èµ·äº¤æµ</p>\n<h2 data-id=\"heading-14\">ç›¸å…³é“¾æ¥</h2>\n<ul>\n<li><a href=\"https://github.com/SugarTurboS/rc-redux-model\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">rc-redux-model</a></li>\n<li><a href=\"https://github.com/SugarTurboS/rc-redux-model/issues/2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">rc-redux-modelä»0åˆ°1</a></li>\n<li><a href=\"https://github.com/SugarTurboS\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SugarTurboS</a></li>\n<li><a href=\"https://github.com/PDKSophia/blog.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é˜¿å®½çš„åšå®¢</a></li>\n</ul></div> <div class=\"image-viewer-box\" data-v-78c9b824><!----></div>","descriptionType":"text/html","publishedDate":"Sun, 20 Sep 2020 17:48:04 +0000","feedId":12740,"bgimg":"","linkMd5":"c9ea4101c07afbc906bc1fa40f1135ee","bgimgJsdelivr":"","metaImg":"","author":"å½­é“å®½","articleImgCdnMap":{"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67cf879c34bd4ecfafdc1443e4b8b8ab~tplv-k3u1fbpfcp-zoom-1.image":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn85@2020_4/2020/09/21/05-28-30-903_4868cd057145dcf6.webp","https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0c1e195cc4294dfdbb82bd3faeaefd0a~tplv-k3u1fbpfcp-zoom-1.image":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn73@2020_4/2020/09/21/05-28-32-269_014e231f4221a6f0.webp","https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f31616f946e4f6197bffb9dfcf880c5~tplv-k3u1fbpfcp-zoom-1.image":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn90@2020_1/2020/09/21/05-28-31-144_943dac95f8ccad41.webp","https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e8413cfa4f5049cc8b6eface77808736~tplv-k3u1fbpfcp-zoom-1.image":"https://cdn.jsdelivr.net/gh/myreaderx/cdn82@2020_1/2020/09/21/05-28-32-331_5fe81cf9e41bd283.webp","https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/630cc474b5e14dcab8d98fabda8709de~tplv-k3u1fbpfcp-zoom-1.image":null,"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6263f40d5a1449cd999b32f07d0981f1~tplv-k3u1fbpfcp-zoom-1.image":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn70@2020_5/2020/09/21/05-28-31-931_e6cf72afe0bfda27.webp"},"publishedOrCreatedDate":1600666110622}],"record":{"createdTime":"2020-09-21 13:28:30","updatedTime":"2020-09-21 13:28:30","feedId":12740,"fetchDate":"Mon, 21 Sep 2020 05:28:30 +0000","fetchMs":62,"handleMs":57,"totalMs":120630,"newArticles":0,"totalArticles":5,"status":1,"type":0,"ip":"39ec31ae66b3a830abe9c60d89cc45e6","hostName":"us-030*","requestId":"9cfe4aa40dcb4b418f78d18d65cb3024_12740","contentType":"application/xml; charset=utf-8","totalBytes":124048,"bgimgsTotal":0,"bgimgsGithubTotal":0,"articlesImgsTotal":6,"articlesImgsGithubTotal":5,"successGithubMap":{"myreaderx22":1,"myreaderx2":1,"myreaderx12":1,"myreaderx5oss":1,"myreaderx":1},"failGithubMap":{}},"feed":{"createdTime":"2020-08-25 04:37:55","updatedTime":"2020-09-05 16:40:22","id":12740,"name":"æ˜é‡‘å‰ç«¯","url":"https://rsshub.app/juejin/category/frontend","subscriber":243,"website":null,"icon":"https://juejin.im/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx65/cdn53@2020_2/2020/09/05/08-40-02-078_24cb365749d306f2.ico","description":"æ˜é‡‘å‰ç«¯ - Made with love by RSSHub(https://github.com/DIYgod/RSSHub)","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2020-09-21 13:30:31","updatedTime":"2020-09-21 13:30:31","id":null,"feedId":12740,"linkMd5":"c9ea4101c07afbc906bc1fa40f1135ee"}],"tmpCommonImgCdnBytes":0,"tmpBodyImgCdnBytes":124048,"tmpBgImgCdnBytes":0,"extra4":{"start":1600666110471,"total":0,"statList":[{"spend":95,"msg":"è·å–xmlå†…å®¹"},{"spend":57,"msg":"è§£é‡Šæ–‡ç« "},{"spend":0,"msg":"ä¸Šä¼ å°é¢å›¾åˆ°cdn"},{"spend":0,"msg":"ä¿®æ­£å°é¢å›¾ä¸Šä¼ å¤±è´¥é‡æ–°ä¸Šä¼ "},{"spend":120458,"msg":"æ­£æ–‡é“¾æ¥ä¸Šä¼ åˆ°cdn"}]},"extra5":6,"extra6":5,"extra7ImgCdnFailResultVector":[null,null],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-032.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-54.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe66.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-003.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-015.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]},"http://us-027.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67cf879c34bd4ecfafdc1443e4b8b8ab~tplv-k3u1fbpfcp-zoom-1.image","sourceStatusCode":200,"destWidth":1746,"destHeight":190,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn85@2020_4/2020/09/21/05-28-30-903_4868cd057145dcf6.webp","sourceBytes":23043,"destBytes":13124,"targetWebpQuality":75,"feedId":12740,"totalSpendMs":968,"convertSpendMs":15,"createdTime":"2020-09-21 13:28:30","host":"us-54*","referer":"https://juejin.im/post/6874751458508537864","linkMd5ListStr":"c9ea4101c07afbc906bc1fa40f1135ee","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1ã€æ²¡æœ‰Refererå­—æ®µ","extra23historyStatusCode":[200],"sourceSize":"22.5 KB","destSize":"12.8 KB","compressRate":"57%"},{"code":1,"isDone":false,"source":"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f31616f946e4f6197bffb9dfcf880c5~tplv-k3u1fbpfcp-zoom-1.image","sourceStatusCode":200,"destWidth":570,"destHeight":300,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn90@2020_1/2020/09/21/05-28-31-144_943dac95f8ccad41.webp","sourceBytes":27164,"destBytes":13138,"targetWebpQuality":75,"feedId":12740,"totalSpendMs":1253,"convertSpendMs":8,"createdTime":"2020-09-21 13:28:30","host":"us-032*","referer":"https://juejin.im/post/6874751458508537864","linkMd5ListStr":"c9ea4101c07afbc906bc1fa40f1135ee","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1ã€æ²¡æœ‰Refererå­—æ®µ","extra23historyStatusCode":[200],"sourceSize":"26.5 KB","destSize":"12.8 KB","compressRate":"48.4%"},{"code":1,"isDone":false,"source":"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6263f40d5a1449cd999b32f07d0981f1~tplv-k3u1fbpfcp-zoom-1.image","sourceStatusCode":200,"destWidth":663,"destHeight":246,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn70@2020_5/2020/09/21/05-28-31-931_e6cf72afe0bfda27.webp","sourceBytes":71549,"destBytes":47786,"targetWebpQuality":75,"feedId":12740,"totalSpendMs":2244,"convertSpendMs":20,"createdTime":"2020-09-21 13:28:30","host":"us-027*","referer":"https://juejin.im/post/6874751458508537864","linkMd5ListStr":"c9ea4101c07afbc906bc1fa40f1135ee","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1ã€æ²¡æœ‰Refererå­—æ®µ","extra23historyStatusCode":[200],"sourceSize":"69.9 KB","destSize":"46.7 KB","compressRate":"66.8%"},{"code":1,"isDone":false,"source":"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0c1e195cc4294dfdbb82bd3faeaefd0a~tplv-k3u1fbpfcp-zoom-1.image","sourceStatusCode":200,"destWidth":1156,"destHeight":816,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn73@2020_4/2020/09/21/05-28-32-269_014e231f4221a6f0.webp","sourceBytes":49333,"destBytes":30116,"targetWebpQuality":75,"feedId":12740,"totalSpendMs":2476,"convertSpendMs":41,"createdTime":"2020-09-21 13:28:30","host":"us-015*","referer":"https://juejin.im/post/6874751458508537864","linkMd5ListStr":"c9ea4101c07afbc906bc1fa40f1135ee","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1ã€æ²¡æœ‰Refererå­—æ®µ","extra23historyStatusCode":[200],"sourceSize":"48.2 KB","destSize":"29.4 KB","compressRate":"61%"},{"code":1,"isDone":false,"source":"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e8413cfa4f5049cc8b6eface77808736~tplv-k3u1fbpfcp-zoom-1.image","sourceStatusCode":200,"destWidth":1223,"destHeight":445,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn82@2020_1/2020/09/21/05-28-32-331_5fe81cf9e41bd283.webp","sourceBytes":50117,"destBytes":19884,"targetWebpQuality":75,"feedId":12740,"totalSpendMs":2551,"convertSpendMs":22,"createdTime":"2020-09-21 13:28:30","host":"europe66*","referer":"https://juejin.im/post/6874751458508537864","linkMd5ListStr":"c9ea4101c07afbc906bc1fa40f1135ee","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1ã€æ²¡æœ‰Refererå­—æ®µ","extra23historyStatusCode":[200],"sourceSize":"48.9 KB","destSize":"19.4 KB","compressRate":"39.7%"}],"successGithubMap":{"myreaderx22":1,"myreaderx2":1,"myreaderx12":1,"myreaderx5oss":1,"myreaderx":1},"failGithubMap":{}}