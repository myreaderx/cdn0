{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"dean.edwards.name","link":"http://deanedwards.me.uk/weblog/?p=124","description":"<p>Some of you may have noticed that my site is now hosted on a new domain:</p>\n<p><a href=\"http://deanedwards.me.uk/\">http://deanedwards.me.uk/</a></p>\n<p>The old domain got squatted. I whined about it on reddit at the time. </p>\n<p>The squatter is currently hosting my copyrighted material. I wrote to the registrar to complain but haven&#8217;t received a reply (I should probably contact the hosting service too).</p>\n<p>So, if you could update your backlinks/bookmarks etc that would be cool. I know that it&#8217;s my fault though.<img src=\"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_sad.gif\" alt=\":-(\" class=\"wp-smiley\" style=\"height: 1em; max-height: 1em;\" /></p>\n<p>The old domain was actually worth quite a lot to me. It provided my email address which was the way that people contacted me for work. That email address has provided all of my work for the last five years. There&#8217;s no way I can replace it. I&#8217;ll just have to start again.</p>\n<div class=\"section note\">\n<p><b>Update:</b> I&#8217;m now in contact with the new owner of the domain and it looks like it may be returned to me. Fingers crossed!</p>\n</div><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/5pq9uHnexuU\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Thu, 02 Apr 2009 21:30:35 +0000","feedId":10898,"bgimg":"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_sad.gif","linkMd5":"d63ef376d65f168924d792f59b2e421f","author":"-dean","articleImgCdnMap":{"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_sad.gif":null,"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/5pq9uHnexuU":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn23@2020_4/2020/08/25/01-14-42-070_bb1630f024d0b43f.webp"},"publishedOrCreatedDate":1598317960091},{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"Back in the game","link":"http://dean.edwards.name/weblog/?p=138","description":"<p>After some <a href=\"http://dean.edwards.name/weblog/2009/04/deanedwardsname/\">wrangling</a> I&#8217;m back in control of the dean.edwards.name domain.</p><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/F3XZESQuFN4\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Thu, 23 Apr 2009 01:54:27 +0000","feedId":10898,"bgimg":"","linkMd5":"5d4bfa4b5dbc6a456b5cf5146636577b","bgimgJsdelivr":"","metaImg":"","author":"-dean","articleImgCdnMap":{"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/F3XZESQuFN4":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn47@2020_5/2020/08/25/01-14-42-089_e9b4d9743db8ac48.webp"},"publishedOrCreatedDate":1598317960091},{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"Quotes","link":"http://dean.edwards.name/weblog/2008/01/quotes/","description":"<blockquote cite=\"http://blogs.msdn.com/ie/archive/2008/01/21/compatibility-and-ie8.aspx\">\n <p>..we worked together with The Web Standards Project (in the WaSP-Microsoft Task Force) on this problem.\n  I can&#8217;t give them enough credit for this work;</p>\n <address><a href=\"http://blogs.msdn.com/ie/archive/2008/01/21/compatibility-and-ie8.aspx\">Chris Wilson (Microsoft)</a></address>\n</blockquote>\n\n<blockquote cite=\"http://www.webstandards.org/2008/01/22/microsofts-version-targeting-proposal/\">\n <p>Although members of the WaSP Microsoft Task Force were very much involved in this proposal,\n  it is important to re-emphasise that this proposal is not one that every member of the Web Standards Project\n  necessarily backs by default.</p>\n <address><a href=\"http://www.webstandards.org/2008/01/22/microsofts-version-targeting-proposal/\">Drew McLellan (WaSP co-lead)</a></address>\n</blockquote>\n\n<blockquote cite=\"http://alistapart.com/articles/beyonddoctype\">\n <p>I, for one, hope other browser vendors join Microsoft in implementing this functionality.</p>\n <address><a href=\"http://alistapart.com/articles/beyonddoctype\">Aaron Gustafson (WaSP/MSTF)</a></address>\n</blockquote>\n\n<blockquote>\n <p>I won&#8217;t support any more cruft added to HTML without hearing the reasons.\n  &#8220;Don&#8217;t break the Web&#8221; is a way to befuddle us.\n  Tell us what your real concerns are and we will try to help.\n  We are not here to rubber-stamp the first crazy idea that you come up with.</p>\n <address>Dean Edwards on the WaSP/MSTF private mailing list</address>\n</blockquote><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/Rzheyi9WAIQ\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Tue, 22 Jan 2008 23:57:17 +0000","feedId":10898,"bgimg":"","linkMd5":"e81bd4d7b3b63ec662935c0e2265dd47","bgimgJsdelivr":"","metaImg":"","author":"-dean","articleImgCdnMap":{"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/Rzheyi9WAIQ":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn39@2020_6/2020/08/25/01-14-42-082_c0f1e5173d9d5935.webp"},"publishedOrCreatedDate":1598317960092},{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"IE7.js gets an update","link":"http://dean.edwards.name/weblog/?p=181","description":"<p><a href=\"http://code.google.com/p/ie7-js/\">IE7.js</a> is finally updated!</p>\n<p>Here are the changes:</p>\n<ul>\n <li>MSIE5.0 is no longer supported</li>\n <li>Layout fixes are no longer applied in quirks mode (except for MSIE5.5)</li>\n <li>IE9.js provides improvements to MSIE8</li>\n <li>support for <code>opacity</code> is moved to IE9.js</li>\n <li>New selectors (IE9.js):\n  <ul>\n   <li><code>:first-of-type</code></li>\n   <li><code>:last-of-type</code></li>\n   <li><code>:only-of-type</code></li>\n   <li><code>:nth-of-type()</code></li>\n   <li><code>:nth-last-of-type()</code></li>\n  </ul>\n </li>\n <li><code>:contains()</code> has been removed (no other browser supports it)</li>\n <li><a href=\"http://code.google.com/p/ie7-js/#PNG\">Changes to the PNG solution</a></li>\n <li>Lots of <a href=\"http://code.google.com/p/ie7-js/issues/list?can=1&#38;q=status=Fixed\">bugs fixed</a></li>\n <li>New faster and more accurate selector engine (the same as in the upcoming release of base2)</li>\n <li>I think I&#8217;ve fixed the unclickable links problem too<img src=\"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_smile.gif\" alt=\":)\" class=\"wp-smiley\" style=\"height: 1em; max-height: 1em;\" /></li>\n</ul>\n<p>There is a demo page here:</p>\n<p><a href=\"http://ie7-js.googlecode.com/svn/test/index.html\">http://ie7-js.googlecode.com/svn/test/index.html</a></p>\n<p>And you can download it from here:</p>\n<p><a href=\"http://code.google.com/p/ie7-js/downloads/list\">http://code.google.com/p/ie7-js/downloads/list</a></p><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/0KpTrmBqc_4\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Sun, 07 Mar 2010 18:48:26 +0000","feedId":10898,"bgimg":"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_smile.gif","linkMd5":"47526fcb0a400064c86a45995fc0b016","author":"-dean","articleImgCdnMap":{"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_smile.gif":null,"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/0KpTrmBqc_4":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn27@2020_2/2020/08/25/01-14-42-064_825a34e709513f10.webp"},"publishedOrCreatedDate":1598317960091},{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"IE7.js version 2.0 (beta)","link":"http://dean.edwards.name/weblog/2008/01/ie7-2/","description":"<p>I&#8217;ve finally updated my <a href=\"http://dean.edwards.name/IE7/\">IE7 library</a>.<img src=\"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_smile.gif\" alt=\":-)\" class=\"wp-smiley\" style=\"height: 1em; max-height: 1em;\" /></p>\n<p>IE7 was in alpha for a long time. The last version was very stable but I always intended to issue a serious update.\n The release of the real IE7 browser threw me off course a little and then I got bogged down with <a href=\"http://code.google.com/p/base2/\">base2</a>.</p>\n<p>I&#8217;ve made some important changes to the script which I&#8217;ll now outline.</p>\n<ul>\n<li>The IE7 project is now <a href=\"http://code.google.com/p/ie7-js/\">hosted on googlecode</a> (I got fed up with <a href=\"https://sourceforge.net/\">SourceForge</a>).</li>\n<li>IE7 is no longer modular. Instead I&#8217;ve merged the scripts into two: IE7.js and IE8.js</li>\n<li>IE7.js includes <em>only</em> fixes that are included in the real MSIE7 browser.</li>\n<li>All other enhancements are moved to IE8.js.</li>\n<li>IE7 is now much smaller (11KB gzipped).</li>\n<li>IE7 is now much faster (it uses the selector engine from <a href=\"http://dean.edwards.name/weblog/2007/03/yet-another/\">base2.DOM</a>)</li>\n<li>There are no dependencies on other files (except <code>blank.gif</code>)</li>\n<li>You can <a href=\"http://ie7-js.googlecode.com/svn/version/\">hotlink</a> IE7/IE8.js directly from Google&#8217;s servers (usage instructions below)</li>\n</ul>\n<p>Some fixes are removed completely:</p>\n<ul>\n<li>the <code>:root</code> selector</li>\n<li>support for <abbr title=\"eXtensible Markup Language\">XML</abbr> files</li>\n<li>support for CSS namespaces</li>\n<li>the <a href=\"http://dean.edwards.name/weblog/2005/06/base64-ie/\">fix for base64 encoded images</a></li>\n</ul>\n<h4>Usage</h4>\n<p>You can link directly to the files on google:</p>\n<p><a href=\"http://ie7-js.googlecode.com/svn/version/\">http://ie7-js.googlecode.com/svn/version/</a></p>\n<p>To upgrade MSIE5-6 to MSIE7 include the following in the <code>&#60;head&#62;</code> of your page:</p>\n<pre>\n&#60;!--[if lt IE 7]&gt;\n&#60;script src=&#34;http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js&#34; type=&#34;text/javascript&#34;&#62;&#60;/script&#62;\n&#60;![endif]--&#62;\n</pre>\n<p>To upgrade MSIE5-7 with advanced <abbr title=\"Cascading Style Sheets\">CSS</abbr> features missing from MSIE7 use the following:</p>\n<pre>\n&#60;!--[if lt IE 8]&gt;\n&#60;script src=&#34;http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE8.js&#34; type=&#34;text/javascript&#34;&#62;&#60;/script&#62;\n&#60;![endif]--&#62;\n</pre>\n<p><em>You do not need to include IE7.js if you are using IE8.js.</em></p>\n<h4>Demo</h4>\n<p><a href=\"http://ie7-js.googlecode.com/svn/test/index.html\" title=\"IE7 project home\">http://ie7-js.googlecode.com/svn/test/index.html</a></p>\n<h4>Links</h4>\n<p>The new home of the IE7 project is:</p>\n<p><a href=\"http://code.google.com/p/ie7-js/\" title=\"IE7 project home\">http://code.google.com/p/ie7-js/</a></p>\n<p>And I&#8217;ve created a Google Group for discussion and questions:</p>\n<p><a href=\"http://groups.google.com/group/ie7-js\" title=\"IE7 discussion group\">http://groups.google.com/group/ie7-js</a></p><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/c9iies1Breo\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Sun, 06 Jan 2008 21:02:25 +0000","feedId":10898,"bgimg":"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_smile.gif","linkMd5":"a4a08cdf7aa759576f8a0c32c8ca8043","author":"-dean","articleImgCdnMap":{"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_smile.gif":null,"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/c9iies1Breo":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn16@2020_1/2020/08/25/01-14-42-037_452dc0f9844ae8f2.webp"},"publishedOrCreatedDate":1598317960092},{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"MSIE’s document.createStyleSheet() throws an error if there are more than 30 existing style sheets","link":"http://dean.edwards.name/weblog/?p=179","description":"<p>I&#8217;m currently doing a round of bug fixing for <a href=\"http://code.google.com/p/ie7-js/\">IE7.js</a>.</p>\n<p><a href=\"http://code.google.com/p/ie7-js/issues/detail?id=85\">Bug #85</a> highlights a bug in Internet Explorer that I was unaware of:</p>\n\n<pre class=\"html-multi\">\n&#60;!doctype html&#62;\n&#60;title&#62;document.createStyleSheet() test&#60;/title&#62;\n&#60;script&#62;\nfor (var i = 0; i &#60; 32; i++) {\n  document.createStyleSheet(); // throws when i == 31\n}\n&#60;/script&#62;\n</pre>\n\n<p>It doesn&#8217;t matter if the style sheets are created with JavaScript or not. Calling <code>document.createStyleSheet()</code> with 30 existing style sheets will throw the error:</p>\n\n<blockquote>\n<p><code>Error: Invalid argument.</code></p>\n</blockquote><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/ajAcGJgK_yY\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Thu, 11 Feb 2010 23:45:17 +0000","feedId":10898,"bgimg":"","linkMd5":"4d2ff540fa281c559d4e62d9d818bc5c","bgimgJsdelivr":"","metaImg":"","author":"-dean","articleImgCdnMap":{"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/ajAcGJgK_yY":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn12@2020_2/2020/08/25/01-14-42-213_2884537fc4136cdf.webp"},"publishedOrCreatedDate":1598317960091},{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"Convert any colour value to hex in MSIE","link":"http://dean.edwards.name/weblog/?p=146","description":"<p>The following function will convert any colour value (rgb, named colours, etc) to the hex equivalent in MSIE:</p>\n\n<pre class=\"javascript\">\nfunction toHex(color) {\n  var body  = createPopup().document.body,\n      range = body.createTextRange();\n  body.style.color = color;\n  var value = range.queryCommandValue(\"ForeColor\");\n  value = ((value & 0x0000ff) &#60;&#60; 16) | (value & 0x00ff00) | ((value & 0xff0000) &#62;&#62;&#62; 16);\n  value = value.toString(16);\n  return \"#000000\".slice(0, 7 - value.length) + value;\n};\n</pre>\n\n<p>For other browsers you can use <code>getComputedStyle()</code> so that is already a solved problem.</p>\n\n<div class=\"section note\">\n<p><b>Note:</b> <a href=\"http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102297\">this method</a> has been around for a while. I posted this adaptation because it does not suffer some of the drawbacks of the original.</p>\n<p>If you are concerned about performance then you can always re-use the popup and range objects.</p>\n</div><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/SUfLFk7a5eg\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Thu, 22 Oct 2009 14:50:24 +0000","feedId":10898,"bgimg":"","linkMd5":"0c641e7c38e97bdc4bb2950d0ab61e34","bgimgJsdelivr":"","metaImg":"","author":"-dean","articleImgCdnMap":{"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/SUfLFk7a5eg":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn56@2020_3/2020/08/25/01-14-42-151_a5206fd778bae078.webp"},"publishedOrCreatedDate":1598317960091},{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"Callbacks vs Events","link":"http://deanedwards.me.uk/weblog/?p=106","description":"<p>Most of the major JavaScript libraries claim to support custom events in one form or another.\n For example, jQuery, YUI and Dojo all support a custom &#8220;document ready&#8221; event. However, the implementation\n of these custom events is always some form of callback system.</p>\n\n<p>A callback system works by storing event handlers in an array. When the underlying event is detected the dispatch system loops through the array calling the callback functions in turn. So what&#8217;s wrong with that? Before I answer that, let&#8217;s look at some code.</p>\n\n<p>Here is some simple code that uses the <code>DOMContentLoaded</code> event to perform two\nseparate initialisations:</p>\n\n<pre class=\"javascript\">\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  console.log(\"Init: 1\");\n  DOES_NOT_EXIST++; // this will throw an error\n}, false);\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  console.log(\"Init: 2\");\n}, false);\n</pre>\n\n<p>What do you expect to see in the console when the document is loaded?</p>\n<p>Well, you should see this (or something like it):</p>\n\n<pre>\nInit: 1\n\nError: DOES_NOT_EXIST is not defined\n\nInit: 2\n</pre>\n\n<p>The point is, both functions are executed. You get an error in the first function <em>but it does not\nstop the second function from executing</em>.</p>\n\n<h4>The Problem</h4>\n\n<p>Now let&#8217;s look at some code based on a callback system. I&#8217;ll pick on jQuery because it&#8217;s the most popular:</p>\n\n<pre class=\"javascript\">\n$(document).ready(function() {\n  console.log(\"Init: 1\");\n  DOES_NOT_EXIST++; // this will throw an error\n});\n\n$(document).ready(function() {\n  console.log(\"Init: 2\");\n});\n</pre>\n\n<p>What do we see in the console?</p>\n\n<pre>\nInit: 1\n\nError: DOES_NOT_EXIST is not defined\n</pre>\n\n<p>The problem is clear. <em>Callback systems are brittle</em>. If any of the callback functions throw\n an error then the subsequent callbacks are not executed. In reality, this means that a poorly written\n plugin can prevent other plugins from initialising.</p>\n \n<p>Dojo suffers exactly the same problem as jQuery. The YUI library takes a slightly different approach.\n It wraps a try/catch around its dispatch mechanism. The downside is that your errors occur\n silently:</p>\n\n<pre class=\"javascript\">\nYAHOO.util.Event.onDOMReady(function() {\n  console.log(\"Init: 1\");\n  DOES_NOT_EXIST++; // this will throw an error\n});\n\nYAHOO.util.Event.onDOMReady(function() {\n  console.log(\"Init: 2\");\n});\n</pre>\n\n<p>Produces:</p>\n\n<pre>\nInit: 1\n\nInit: 2\n</pre>\n\n<p>Perfect initialisation! Nothing to worry about here! Except for the error that you don&#8217;t see.</p>\n\n<p>So what&#8217;s the solution?</p>\n\n<h4>The Solution</h4>\n\n<p>The solution is to use a hybrid of a callback system and real event dispatch.\n We can trigger a fake event and from within that event, run the callback function.\n Each event handler has its own execution context. If an error occurs in our fake event\n then it won&#8217;t affect our callback system.</p>\n \n<p>That sounds a bit complicated. I&#8217;ll illustrate with some code.</p>\n\n<pre class=\"javascript\">\nvar currentHandler;\n\nif (document.addEventListener) {\n  document.addEventListener(\"fakeEvents\", function() {\n    // execute the callback\n    currentHandler();\n  }, false);\n\n  var dispatchFakeEvent = function() {\n    var fakeEvent = document.createEvent(\"UIEvents\");\n    fakeEvent.initEvent(\"fakeEvents\", false, false);\n    document.dispatchEvent(fakeEvent);\n  };\n} else { // MSIE\n\n  // I'll show this code later\n}\n\nvar onLoadHandlers = [];\nfunction addOnLoad(handler) {\n  onLoadHandlers.push(handler);\n};\n\nonload = function() {\n  for (var i = 0; i &#60; onLoadHandlers.length; i++) {\n    currentHandler = onLoadHandlers[i];\n    dispatchFakeEvent();\n  }\n};\n</pre>\n\n<p>Now we&#8217;ll use the code above to attach our two troublesome event handlers:</p>\n\n<pre class=\"javascript\">\naddOnLoad(function() {\n  console.log(\"Init: 1\");\n  DOES_NOT_EXIST++; // this will throw an error\n});\n\naddOnLoad(function() {\n  console.log(\"Init: 2\");\n});\n</pre>\n\n<p>OK. Let&#8217;s run the code above and see what we get:</p>\n\n<pre>\nInit: 1\n\nError: DOES_NOT_EXIST is not defined\n\nInit: 2\n</pre>\n\n<p>Perfect! Just what we want. Both event handlers are executed and we also get a message\n telling us about the error in the first handler. Great!</p>\n \n<p>But what about Internet Explorer I hear you ask (I have good hearing). MSIE does not support\n the standard event dispatch system. It has its own method; <code>fireEvent</code> but that only\n works with real events (e.g. <code>click</code>).</p>\n \n<p>Rather than explain the solution in words, here is the code:</p>\n\n<pre class=\"javascript\">\nvar currentHandler;\n\nif (document.addEventListener) {\n\n  // We've seen this code already\n\n} else if (document.attachEvent) { // MSIE\n\n  document.documentElement.fakeEvents = 0; // an expando property\n\n  document.documentElement.attachEvent(\"onpropertychange\", function(event) {\n    if (event.propertyName == \"fakeEvents\") {\n      // execute the callback\n      currentHandler();\n    }\n  });\n\n  dispatchFakeEvent = function(handler) {\n    // fire the propertychange event\n    document.documentElement.fakeEvents++;\n  };\n}\n</pre>\n\n<p>A similar approach except that we use the proprietary <code>propertychange</code> event as the trigger.</p>\n \n<h4>Summary</h4>\n\n<p>I&#8217;ve shown a very simple example of how to use the uderlying event system to fire custom\n events. Library authors should be capable of seeing how this can be extended to fully support\n cross-browser custom events.</p>\n \n<h4>Update</h4>\n\n<p>Some commenters have suggested using <code>setTimeout</code>. Here is my response to that:</p>\n\n<blockquote><p>For this particular example, a timer will work fine. This is just an example to illustrate the technique. The real usefulness of this is for other custom events. Most libraries implement custom events using a callback system. As I illustrated, callback systems are brittle. Dispatching events with timers will work to a degree but it is not how a real event system works. In a real system, events are dispatched sequentially. There are other concerns, like cancelling an event and stopping the event from bubbling. This would be impossible with timers.</p></blockquote>\n\n<p>The important thing is that I&#8217;ve demonstrated a technique for wrapping a callback system in a real event dispatch system. That gives you the ability to fire <em>real</em> custom events in MSIE. If you are building an event system based on event delegation then this technique may also be interesting to you.</p>\n\n<h4>Update 2</h4>\n\n<p>It seems that Prototype uses an almost identical trick to fire custom events in MSIE:</p>\n<p><a href=\"http://andrewdupont.net/2009/03/24/link-dean-edwards/\">http://andrewdupont.net/2009/03/24/link-dean-edwards/</a></p><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/AWIxMfjlrN8\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Tue, 24 Mar 2009 18:14:38 +0000","feedId":10898,"bgimg":"","linkMd5":"71bdadd4ce6c8a0d2a1736c9713f0250","bgimgJsdelivr":"","metaImg":"","author":"-dean","articleImgCdnMap":{"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/AWIxMfjlrN8":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn44@2020_5/2020/08/25/01-14-42-080_ba96baae7f1e9065.webp"},"publishedOrCreatedDate":1598317960092},{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"getElementsByTagName()","link":"http://dean.edwards.name/weblog/?p=156","description":"<p>It turns out that <a href=\"http://ejohn.org/blog/dom-documentfragments/\">document fragments</a> do not implement the\n <a href=\"http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1938918D\"><code>getElementsByTagName()</code></a>\n method. But they <em>do</em> implement the <a href=\"http://www.w3.org/TR/selectors-api/\">Selectors\n <abbr>API</abbr></a> methods: <a href=\"http://www.w3.org/TR/selectors-api/#nodeselector\"><code>querySelector/querySelectorAll</code></a>.</p>\n\n<p>Nobody cares about this except for people that write\n <a href=\"http://paulirish.com/2008/javascript-css-selector-engine-timeline/\">JavaScript\n selector engines</a>. If you are one of those people then keep reading.</p>\n\n<p>I can code around the absence of a lot of <abbr>DOM</abbr> methods but\n <code>getElementsByTagName()</code> seemed impossible to do without. So I had to fake it!</p>\n\n<h4>JavaScript performance</h4>\n\n<p>JavaScript is a nice enough scripting language but it is still a scripting language.</p>\n\n<p>For high performance loops you should try to avoid the following:</p>\n\n<ol>\n <li><code>try</code>/<code>catch</code> blocks</li>\n <li>function/method calls (even on native objects)</li>\n <li>accessing <abbr>DOM</abbr> properties (or anything that involves calling a complex getter/setter)</li>\n</ol>\n\n<p><strong>Please note</strong> that this is an <em>ordered list</em>.<img src=\"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_smile.gif\" alt=\":)\" class=\"wp-smiley\" style=\"height: 1em; max-height: 1em;\" /></p>\n\n<h4>The code</h4>\n\n<p>With all that in mind I wrote this simple implementation of <code>getElementsByTagName()</code>\n which I hope is fast enough for those edge cases where users execute DOM queries on document fragments:</p>\n\n<pre class=\"javascript\">\nfunction getElementsByTagName(node, tagName) {\n  var elements = [], i = 0, anyTag = tagName === \"*\", next = node.firstChild;\n  while ((node = next)) {\n    if (anyTag ? node.nodeType === 1 : node.nodeName === tagName) elements[i++] = node;\n    next = node.firstChild || node.nextSibling;\n    while (!next &#38;&#38; (node = node.parentNode)) next = node.nextSibling;\n  }\n  return elements;\n}\n</pre>\n\n<div class=\"section note\">\n <p><b>Update:</b> I&#8217;ve amended the original code based on the comments below.</p>\n <p>Some things to consider:</p>\n <ul>\n  <li>Document fragments cannot have a parent node.</li>\n  <li>This method will only be used to query document fragments, so you can assume that the context node will not be an element.</li>\n </ul>\n</div><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/ypEdfPejo2I\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Thu, 17 Dec 2009 01:56:55 +0000","feedId":10898,"bgimg":"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_smile.gif","linkMd5":"d46a905d774f34c48ddb83852c18f765","author":"-dean","articleImgCdnMap":{"http://dean.edwards.name/weblog/wp-includes/images/smilies/icon_smile.gif":null,"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/ypEdfPejo2I":"https://cdn.jsdelivr.net/gh/myreaderx/cdn51@2020_5/2020/08/25/01-14-42-145_19847732bb0dabf6.webp"},"publishedOrCreatedDate":1598317960092},{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","title":"Two steps forward one step back","link":"http://dean.edwards.name/weblog/2008/03/steps/","description":"<p>Safari 3.1 fails the Acid2 test:</p>\n\n<p><a href=\"http://bugs.webkit.org/show_bug.cgi?id=13693\">http://bugs.webkit.org/show_bug.cgi?id=13693</a></p><img src=\"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/uGE8rJ6uv5c\" height=\"1\" width=\"1\" alt=\"\"/>","descriptionType":"html","publishedDate":"Sat, 22 Mar 2008 20:47:03 +0000","feedId":10898,"bgimg":"","linkMd5":"bc62866932b0a2fbd0aa1dec7796b712","bgimgJsdelivr":"","metaImg":"","author":"-dean","articleImgCdnMap":{"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/uGE8rJ6uv5c":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn32@2020_5/2020/08/25/01-14-42-141_636481e59c607227.webp"},"publishedOrCreatedDate":1598317960092}],"record":{"createdTime":"2020-08-25 09:12:40","updatedTime":"2020-08-25 09:12:40","feedId":10898,"fetchDate":"Tue, 25 Aug 2020 01:12:40 +0000","fetchMs":79,"handleMs":240820,"totalMs":485339,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"34.199.111.102","hostName":"us-005.herokuapp.com","requestId":"20c3ca50f4674014bed2402e33ea6aa7_10898","contentType":"text/xml; charset=UTF-8","totalBytes":720,"bgimgsTotal":4,"bgimgsGithubTotal":0,"articlesImgsTotal":12,"articlesImgsGithubTotal":10,"successGithubMap":{"myreaderx8":1,"myreaderx15":1,"myreaderx7":1,"myreaderx16":1,"myreaderx33":1,"myreaderx24":1,"myreaderx30":1,"myreaderx18":1,"myreaderx19":1,"myreaderx":1},"failGithubMap":{}},"feed":{"createdTime":"2020-08-25 04:36:17","updatedTime":"2020-08-25 04:36:17","id":10898,"name":"dean.edwards.name/weblog","url":"http://feeds.feedburner.com/deanedwards/weblog","subscriber":null,"website":null,"icon":"http://dean.edwards.name/favicon.ico","icon_jsdelivr":null,"description":"JavaScript, DHTML and browser hacking","weekly":null,"link":"http://dean.edwards.name"},"noPictureArticleList":[{"createdTime":"2020-08-25 09:16:44","updatedTime":"2020-08-25 09:16:44","id":null,"feedId":10898,"linkMd5":"d63ef376d65f168924d792f59b2e421f"},{"createdTime":"2020-08-25 09:16:44","updatedTime":"2020-08-25 09:16:44","id":null,"feedId":10898,"linkMd5":"47526fcb0a400064c86a45995fc0b016"},{"createdTime":"2020-08-25 09:16:44","updatedTime":"2020-08-25 09:16:44","id":null,"feedId":10898,"linkMd5":"a4a08cdf7aa759576f8a0c32c8ca8043"},{"createdTime":"2020-08-25 09:16:44","updatedTime":"2020-08-25 09:16:44","id":null,"feedId":10898,"linkMd5":"d46a905d774f34c48ddb83852c18f765"}],"tmpCommonImgCdnBytes":0,"tmpBodyImgCdnBytes":720,"tmpBgImgCdnBytes":0,"extra4":{"start":1598317719188,"total":0,"statList":[{"spend":84,"msg":"获取xml内容"},{"spend":240820,"msg":"解释文章"},{"spend":121291,"msg":"正文链接上传到cdn"},{"spend":122524,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"}]},"extra5":12,"extra6":10,"extra7ImgCdnFailResultVector":[null,null,null,null,null,null,null,null,null,null,null,null],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/c9iies1Breo","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn16@2020_1/2020/08/25/01-14-42-037_452dc0f9844ae8f2.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":749,"convertSpendMs":3,"createdTime":"2020-08-25 09:14:42","host":"us-51*","referer":"http://dean.edwards.name/weblog/2008/01/ie7-2/","linkMd5ListStr":"a4a08cdf7aa759576f8a0c32c8ca8043","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/Rzheyi9WAIQ","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn39@2020_6/2020/08/25/01-14-42-082_c0f1e5173d9d5935.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":779,"convertSpendMs":3,"createdTime":"2020-08-25 09:14:42","host":"us-033*","referer":"http://dean.edwards.name/weblog/2008/01/quotes/","linkMd5ListStr":"e81bd4d7b3b63ec662935c0e2265dd47","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/F3XZESQuFN4","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn47@2020_5/2020/08/25/01-14-42-089_e9b4d9743db8ac48.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":789,"convertSpendMs":7,"createdTime":"2020-08-25 09:14:42","host":"us-009*","referer":"http://dean.edwards.name/weblog/?p=138","linkMd5ListStr":"5d4bfa4b5dbc6a456b5cf5146636577b","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/0KpTrmBqc_4","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn27@2020_2/2020/08/25/01-14-42-064_825a34e709513f10.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":802,"convertSpendMs":3,"createdTime":"2020-08-25 09:14:42","host":"us-004*","referer":"http://dean.edwards.name/weblog/?p=181","linkMd5ListStr":"47526fcb0a400064c86a45995fc0b016","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/AWIxMfjlrN8","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn44@2020_5/2020/08/25/01-14-42-080_ba96baae7f1e9065.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":801,"convertSpendMs":2,"createdTime":"2020-08-25 09:14:42","host":"us-021*","referer":"http://deanedwards.me.uk/weblog/?p=106","linkMd5ListStr":"71bdadd4ce6c8a0d2a1736c9713f0250","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/5pq9uHnexuU","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn23@2020_4/2020/08/25/01-14-42-070_bb1630f024d0b43f.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":905,"convertSpendMs":3,"createdTime":"2020-08-25 09:14:42","host":"us-017*","referer":"http://deanedwards.me.uk/weblog/?p=124","linkMd5ListStr":"d63ef376d65f168924d792f59b2e421f","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/ypEdfPejo2I","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn51@2020_5/2020/08/25/01-14-42-145_19847732bb0dabf6.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":877,"convertSpendMs":2,"createdTime":"2020-08-25 09:14:42","host":"europe21*","referer":"http://dean.edwards.name/weblog/?p=156","linkMd5ListStr":"d46a905d774f34c48ddb83852c18f765","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/SUfLFk7a5eg","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn56@2020_3/2020/08/25/01-14-42-151_a5206fd778bae078.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":885,"convertSpendMs":2,"createdTime":"2020-08-25 09:14:42","host":"europe-59*","referer":"http://dean.edwards.name/weblog/?p=146","linkMd5ListStr":"0c641e7c38e97bdc4bb2950d0ab61e34","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/uGE8rJ6uv5c","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn32@2020_5/2020/08/25/01-14-42-141_636481e59c607227.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":896,"convertSpendMs":2,"createdTime":"2020-08-25 09:14:42","host":"europe67*","referer":"http://dean.edwards.name/weblog/2008/03/steps/","linkMd5ListStr":"bc62866932b0a2fbd0aa1dec7796b712","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"},{"code":1,"isDone":false,"source":"http://feeds.feedburner.com/~r/deanedwards/weblog/~4/ajAcGJgK_yY","sourceStatusCode":200,"destWidth":1,"destHeight":1,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn12@2020_2/2020/08/25/01-14-42-213_2884537fc4136cdf.webp","sourceBytes":43,"destBytes":72,"targetWebpQuality":75,"feedId":10898,"totalSpendMs":961,"convertSpendMs":2,"createdTime":"2020-08-25 09:14:42","host":"europe63*","referer":"http://dean.edwards.name/weblog/?p=179","linkMd5ListStr":"4d2ff540fa281c559d4e62d9d818bc5c","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 B","destSize":"72 B","compressRate":"167.4%"}],"successGithubMap":{"myreaderx8":1,"myreaderx15":1,"myreaderx7":1,"myreaderx16":1,"myreaderx33":1,"myreaderx24":1,"myreaderx30":1,"myreaderx18":1,"myreaderx19":1,"myreaderx":1},"failGithubMap":{}}