{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-08-25 22:55:13","updatedTime":"2020-08-25 22:55:13","title":"攻守道—流量分析的刀光剑影（下）","link":"http://www.secpulse.com/?p=139504","description":"<section style=\"display: none;\"><br/></section>\n<section>\n<section style=\"padding-top: 15px;padding-bottom: 15px;display: flex;justify-content: center;box-sizing: border-box;\">\n<section style=\"background-image: url(&#34;https://mmbiz.qpic.cn/mmbiz_png/WTOrX1w0s56RnQpURB5hlzxttTVZHk8kEImFwElKKTJ8QWUKKOH1HxNHzoy9ttqjQynb1lYGcyKZNNnESeuBNQ/640?wx_fmt=png&#34;);background-position: left top;background-repeat: no-repeat;background-size: 30px;\">\n<section style=\"padding: 8px 12px;background-image: url(&#34;https://mmbiz.qpic.cn/mmbiz_png/WTOrX1w0s56RnQpURB5hlzxttTVZHk8kBgMuN7zeZd8WGxAaPSIC88icL9SN7E3utSPAFwgd4VLON6xyMmQicLBA/640?wx_fmt=png&#34;);background-position: right bottom;background-size: 30px;background-repeat: no-repeat;box-sizing: border-box;\">\n<section style=\"padding-right: 20px;padding-left: 20px;line-height: 30px;background-color: rgb(114, 186, 180);font-size: 16px;color: rgb(255, 255, 255);box-sizing: border-box;\">\n<p style=\"padding-right: 20px;padding-left: 20px;line-height: 30px;color: rgb(32, 88, 103);\"><span style=\"font-size: 14px;color: #000000;font-family: arial, helvetica, sans-serif;\">这是&#160;</span><strong><span style=\"font-size: 14px;color: #000000;font-family: arial, helvetica, sans-serif;\">酒仙桥六</span><span style=\"font-size: 14px;color: #000000;font-family: arial, helvetica, sans-serif;\">号部队&#160;</span></strong><span style=\"font-size: 14px;color: #000000;font-family: arial, helvetica, sans-serif;\">的第&#160;<strong>24</strong><strong>&#160;</strong>篇文章。</span></p>\n<p style=\"padding-right: 20px;padding-left: 20px;line-height: 30px;color: rgb(32, 88, 103);\"><span style=\"font-size: 14px;color: #000000;font-family: arial, helvetica, sans-serif;\">全文共计3449个字，预计阅读时长11分钟</span><span style=\"font-size: 14px;font-family: arial, helvetica, sans-serif;\">。</span></p>\n<p style=\"padding-right: 20px;padding-left: 20px;line-height: 30px;color: rgb(32, 88, 103);\"><span style=\"font-family: arial, helvetica, sans-serif;font-size: 14px;background-color: #FFFFFF;\"></span></p>\n</section>\n</section>\n</section>\n</section>\n</section>\n<p><br style=\"white-space: normal;\"/></p>\n<section label=\"Powered by 135editor.com\">\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">大家好，我又回来了，上一期我们对那一起攻击事件流量的分析只进行了一半，事情还远未结束，这期，我们继续来进行探究。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><br/></span></p>\n<h2 cid=\"n2\" mdtype=\"heading\" style=\"box-sizing: border-box;break-after: avoid-page;break-inside: avoid;font-size: 1.75em;margin: 1rem 5px;font-weight: bold;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\">第五问 数据库</h2>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">攻击者拿到的数据库配置信息是什么。&#160;</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">前面攻击者已经拿下了一个网站，并上传了webshell，通常都会读取网站的配置文件来获取数据库的账号密码，然后连接数据库进行数据脱取等操作，那么，我们就来从流量中找找攻击者读取的数据库文件。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">通常，在php语言的网站中，数据库的配置会写在config.php、database.php等名称的文件中，Java语言的网站中，当使用一些框架时，数据库的配置可能会写在datasource.xml、config.xml、config.properties等名称的文件中，一般情况下，在这些文件中写数据库的连接信息时，都会有hostname、dbname、username、password这类的关键字，在java中还会有jdbc的字段。大多数情况下，这些配置信息在配置文件中都是明文存储的，当存在任意文件读取、下载、获取webshell之后都可以通过读取这些文件直接获取数据库信息。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">现在我们就来看看攻击者的流量，看看他读到的数据库信息是什么。首先我们能想到，攻击者读取到的数据库信息肯定是在返回包中显示，再通过我们之前分析出来的攻击者使用的名称为a.php的webshell来筛选一下。先筛选攻击者IP发出的请求，并且返回包是由a.php请求来的：ip.addr == 192.168.32.189 and http.response_for.uri contains &#34;a.php&#34;</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339370.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">筛选出来90条数据包，再把返回包200的请求筛选出来，就只剩下36条数据包，这样找起来就更容易了。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339372.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">我们直接搜索数据包中的字符串，搜一些跟数据库配置文件相关的关键字，由于是搜的返回包内容，所以我们直接搜host、dbname、password、dbpwd等。搜索了一番，怎么都没找到读取数据库配置文件的数据包，难道没有读数据库配置文件吗？难道筛选逻辑有问题？不禁心生疑问。此时想到之前遇到过的一个情况，流量包里只有返回包，没有记录到请求包时，就无法通过特定的请求路径筛选出对应的返回数据包。难不成读取数据库配置文件的请求包没有被记录下来吗？带着这个疑问，我又来翻查一遍数据包，这次不再筛选数据包的路径，直接将所有攻击者发起的请求的返回包，并且状态是200的数据包筛选出来，再去查找。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339374.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">筛选出的数据包有1万多个，使用wireshark的搜索字符串的功能，搜索host发现有大量的噪声包，就直接搜索dbhost字段，正中目标，发现攻击者只读取了一次配置文件，只有这一个数据包。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339376.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">跟踪了这个数据包之后发现，整个数据流只有返回包的内容，没有请求包，似乎就可以印证之前的猜想了，流量包中并没有记录到这个操作的请求包，只记录到了返回包。</span></p>\n<h2 cid=\"n15\" mdtype=\"heading\" style=\"box-sizing: border-box;break-after: avoid-page;break-inside: avoid;font-size: 1.75em;margin: 1rem 5px;font-weight: bold;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\">第六问 邮箱<span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"></span></h2>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">攻击者获得的邮箱账号密码是什么？</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">前面攻击者已经拿到了数据库的账号密码，我们猜测攻击者可能通过哪些方式去查询的数据库：第一种，通过webshell连接数据库，执行sql语句查询数据库，这种方式的流量为http流量；第二种，通过数据库连接工具或命令行连接数据库，执行SQL语句查询数据库，这种方式就取决于连接工具本身，mysql一般情况下都是tcp流量。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">从上一步获取到的数据库配置信息中看到，数据库的地址是10.3.3.101，我们先来看看被攻击者攻击的网站的网卡信息。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339378.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">可以看到被攻击的web服务器存在两张网卡，一个对外，一个与数据库通信。继续分析寻找攻击者查询数据库获取邮箱账号信息，查找http流量，没有发现任何基于http流量的查询数据库操作，在记录到的数据包流量中，有mysql流量，直接筛选出来mysql的流量来分析。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">筛选之后发现只有web服务器与数据库的通信流量，猜测可能攻击者使用web服务器做流量代理连接数据库或者直接使用web服务器连接数据库。流量包中的mysql流量共有40多万条，整体逐条筛选肯定会很困难，此时，我们可以回到攻击者发起攻击的行为来分析。攻击者发起读取数据库行为，肯定发生在读取数据库配置文件之后，由此而来，我们可以看看数据包中记录到的读取数据库配置文件的时间，然后寻找mysql流量中对应的时间之后的流量。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339380.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">可以看到读取配置文件的时间是8月8日16点18分05秒，再回到mysql流量里，按照时间排序流量包，然后来分析。查看了这个时间之后的mysql流量包，发现并没有预期的结果，难道没有通过连接数据库来读数据库里的信息吗？难道是通过注入拿到的信息？现在我们也无法直接确定，我们就来反推一下这个过程，先来找找攻击者登录的邮箱。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">与之前一样，先来找找与邮箱登录相关的流量：</span></p>\n<section class=\"code-snippet__fix code-snippet__js\">\n<pre class=\"code-snippet__js\">http.request.method&#160;==&#160;POST&#160;and&#160;http&#160;contains&#160;&#34;index.php&#34;</pre>\n</section>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339383.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">存在大量192.168.94.59发出的攻击流量，这个应该就是攻击者的IP了。再来看一下正常的邮箱登录是什么样的返回包，过滤出来与邮箱有关的http数据包后，发现有一个logout退出登录的数据包，在这个数据包中的cookie参数中发现有个login_name参数，那么这个肯定就是正常登录的用户了。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339386.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">继续看看这个用户名的正常登录是什么样的，会返回来什么样的数据。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339387.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">这里登录之后返回了一串json格式的字符串，然后又请求welcome模块跳到正常登录后访问的页面。所以登录成功后会返回{&#34;success&#34;:true}这样的json字符串。根据这个特征，来找找攻击者登录的邮箱账号是什么。</span></p>\n<section class=\"code-snippet__fix code-snippet__js\">\n<pre class=\"code-snippet__js\">(http&#160;contains&#160;&#34;{&#34;success&#34;:true}&#34;&#160;or&#160;http.request.method==&#34;POST&#34;)&#160;and&#160;ip.addr==192.168.94.59</pre>\n</section>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339390.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">在搜寻的过程中发现还存在大量的爆破的痕迹，不排除攻击者根本没有通过之前拿到的数据库获得密码的可能，而是通过爆破获得的账号。在找到攻击者登录邮箱使用的账号密码后，发现密码是一串加密的字符串，我们还需要解密出密码的明文，才有可能判断出攻击者是否是通过数据库获得的密码。再返回来找一下登录页面的数据包，看看返回的页面中有没有加密方法。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339392.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">终于在这里找到了登录的密码加密方法，是AES加密，key是1234567812345678的MD5的hash值，iv偏移量是1234567812345678，后面还说了mode和padding的类型，到这里，我们就可以借助解密工具对密码解密了。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-15983393921.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">到这里我们再回过头从数据库里看看有没有查询admin@test.com密码的操作。</span></p>\n<section class=\"code-snippet__fix code-snippet__js\">\n<pre class=\"code-snippet__js\">mysql&#160;contains&#160;&#34;admin@test.com&#34;</pre>\n</section>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339393.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">查看mysql里包含admin@test.com的流量，发现时间均在攻击者通过webshell读取数据库配置文件之前。并且数据库中记录的最后登录IP就是攻击者的ip。看来攻击者在读取数据库操作之前就已经拿到了账号密码。</span></p>\n<h2 cid=\"n42\" mdtype=\"heading\" style=\"box-sizing: border-box;break-after: avoid-page;break-inside: avoid;font-size: 1.75em;margin: 1rem 5px;font-weight: bold;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\">第七问 VPN<span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"></span></h2>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">攻击者登录vpn后的ip是多少？</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">前面攻击者已经拿到了admin权限的邮箱账号，应该所有用户的邮件都可以看到了，我们来找找攻击者有没有从其中拿到vpn的账号密码。</span></p>\n<section class=\"code-snippet__fix code-snippet__js\">\n<pre class=\"code-snippet__js\">ip.addr&#160;==&#160;192.168.94.59&#160;and&#160;http&#160;contains&#160;vpn</pre>\n</section>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339395.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">过滤之后发现攻击者所有请求的数据包中包含vpn信息的用户名只有luzhihao一个，再到vpn的流量记录里看看。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339398.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">这里使用luzhihao的账号进行登录，但并未登录成功。这里我们可以知道192.168.32.131是vpn服务器。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339399.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">在后面的流量包中发现有使用xingh的账号连接vpn成功的流量包。来使用wireshark自带的流量统计功能看看每个ip之间的流量请求情况。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339403.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">从统计出来的流量上看到vpn服务器返回给攻击者的ip大量数据包，其中有一部分是前期攻击者登录的流量包，其余的就是攻击者连接上vpn之后的操作。再看其他的统计数据，10.3.4.3向10.2.4.96发送了大量数据包，那么这两个ip中应该有一个是攻击者连接vpn之后分配的ip，再来看看哪个是攻击者的ip。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-15983394031.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">筛选10.3.4.3的流量后，按照协议类型排序，在ICMP类型的流量中，发现10.3.4.3主动向10.3.4.55和10.3.4.96发起了ping请求，通常情况下可以判定10.3.4.3是人为控制的机器。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339406.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">继续查看，发现10.3.4.3向10.3.4.96主动发起共享请求，10.3.4.96返回回应，这就可以判断10.3.4.3是攻击者控制的机器，所以攻击者接入vpn后的ip是10.3.4.3。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">至此，我们整个的分析就已完成。攻击者的整个攻击流程大致如下：</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339408.png\"/></span></p>\n<h2 cid=\"n60\" mdtype=\"heading\" style=\"box-sizing: border-box;break-after: avoid-page;break-inside: avoid;font-size: 1.75em;margin: 1rem 5px;font-weight: bold;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\">总结<span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"></span></h2>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">流量分析，防守之道。站在攻击者的角度，思考攻击者的整体流程，他们的最终目的无外乎拿数据、得权限，正向走不通就反向推演，万变不离其宗。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">对整个分析过程做一个回顾，大致可以把整个思路汇总成为下面这一个图：</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339410.png\"/></span></p>\n<h2 cid=\"n64\" mdtype=\"heading\" style=\"box-sizing: border-box;break-after: avoid-page;break-inside: avoid;font-size: 1.75em;margin: 1rem 5px;font-weight: bold;cursor: text;padding-bottom: 0.3em;border-bottom: 1px solid rgb(238, 238, 238);white-space: pre-wrap;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\">拓展<span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"></span></h2>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">我们继续来说说cobalt strike的几种不同类型的beacon模式的远控流量所存在的一些特征。</span></p>\n<h3 cid=\"n66\" mdtype=\"heading\" style=\"box-sizing: border-box;break-after: avoid-page;break-inside: avoid;font-size: 1.5em;margin: 1rem 5px;font-weight: bold;cursor: text;white-space: pre-wrap;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;font-family: 宋体, SimSun;color: #1C7892;\">DNS隧道</span></h3>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">配置好服务器，做好域名解析后，在cobalt strike上创建一个监听器，并使用cs生成一个木马文件（这里使用的是cobalt strike 3.13版本）。将木马放在windows下执行，同时我们使用wireshark来抓取流量包，查看整个执行远控的过程中的通信情况。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339411.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">执行木马主机上线后，这里我执行了ipconfig、net user、dir命令，来看一下cobaltstrike远程控制主机执行这些命令后，teamserver与远控主机之间是如何进行通信的。</span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;min-width: 10px;min-height: 10px;vertical-align: top;display: inline-block;width: 100%;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\"><img style=\"width: 100%;box-sizing: border-box;border-width: 0px 4px 0px 2px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: initial;border-right-color: transparent;border-bottom-color: initial;border-left-color: transparent;vertical-align: middle;cursor: default;display: block;height: auto;\" src=\"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339413.png\"/></span></p>\n<p style=\"box-sizing: border-box;orphans: 4;margin: 0.8em 5px;white-space: pre-wrap;font-size: 16px;line-height: 1.75em;letter-spacing: 2.5px;font-family: Helvetica, Arial, sans-serif;\"><span style=\"box-sizing: border-box;font-size: 15px;color: #585858;font-family: 宋体, SimSun;\">我们使用的是dns隧道实现的远程控制，在流量中会出现大量的dns数据包，从这些dns数据包的解析地址来看，发现异常的域名地址还是相对比较容易。全局搜索执行的命令，无论是搜字符串还是hex值，都没有任何信息。相对从数据包内容上来说，dns隧道还是比较隐蔽，很多攻击者在使用dns隧道来进行远控时，都会使用隐蔽性更强的域名，会使用一些与常用域名非常相似的域名，如a1iyun.com这样的，不容易被认出来，这时候就需要借助一些第三方的威胁情报库去辅助判断。</span></p>\n<section>\n<p style=\"text-align: center;\"><br/></p>\n</section>\n</section>\n","descriptionType":"text/html","publishedDate":"Tue, 25 Aug 2020 09:42:52 +0000","feedId":5124,"bgimg":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339370.png","linkMd5":"ec6e833ca9e24a45b28fffa57a92e1d7","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn41@2020_1/2020/08/25/14-55-20-095_1edccc4e2629cf4c.webp","destWidth":864,"destHeight":504,"sourceBytes":327545,"destBytes":70024,"author":"酒仙桥六号部队","articleImgCdnMap":{"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339370.png":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn41@2020_1/2020/08/25/14-55-20-095_1edccc4e2629cf4c.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339372.png":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn62@2020_1/2020/08/25/14-55-25-772_6d91bb4f159fdc3b.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339374.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn65@2020_4/2020/08/25/14-55-33-205_40e02fb08c3339c3.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339376.png":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn89@2020_2/2020/08/25/14-55-29-060_15bf78cc5f44d88e.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339378.png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn14@2020_1/2020/08/25/14-55-25-284_ddf23d338b4ca41f.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339380.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn30@2020_4/2020/08/25/14-55-25-103_350f11d0325652f4.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339383.png":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn19@2020_5/2020/08/25/14-55-24-924_fb726f04890b0abf.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339386.png":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn88@2020_3/2020/08/25/14-55-24-396_e18f17532be51a12.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339387.png":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn99@2020_6/2020/08/25/14-55-27-034_9012c2a807b9fcea.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339390.png":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn53@2020_5/2020/08/25/14-55-24-747_ca40fb83a0ec7554.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339392.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn5@2020_1/2020/08/25/14-55-24-498_4de92382e27f5672.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-15983393921.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn41@2020_4/2020/08/25/14-55-24-427_5a8da09cc5bdb4b3.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339393.png":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn97@2020_2/2020/08/25/14-55-27-504_5314ee9b9cc80007.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339395.png":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn32@2020_1/2020/08/25/14-55-25-808_77501685f6bee1e6.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339398.png":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn26@2020_6/2020/08/25/14-55-29-623_4f21dcb1c5504405.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339399.png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn45@2020_6/2020/08/25/14-55-24-660_d5abec474f0377c9.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339403.png":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn82@2020_6/2020/08/25/14-55-24-403_1e149a26d6d07b53.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-15983394031.png":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn92@2020_3/2020/08/25/14-55-26-220_7cc6417c99cc7ea9.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339406.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn58@2020_2/2020/08/25/14-55-25-057_ea8a3c04cb0609df.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339408.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn49@2020_1/2020/08/25/14-55-23-782_2043b41259f93076.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339410.png":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn35@2020_5/2020/08/25/14-55-23-824_d824a83e58baa9b6.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339411.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn85@2020_2/2020/08/25/14-55-31-172_909f6980e41ddab9.webp","https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339413.png":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn10@2020_1/2020/08/25/14-55-26-194_e28b42c477ed5b44.webp"},"publishedOrCreatedDate":1598367313598}],"record":{"createdTime":"2020-08-25 22:55:13","updatedTime":"2020-08-25 22:55:13","feedId":5124,"fetchDate":"Tue, 25 Aug 2020 14:55:13 +0000","fetchMs":3252,"handleMs":40,"totalMs":26377,"newArticles":0,"totalArticles":15,"status":1,"type":0,"ip":"b724f4db74bd861dbefaff97f3fb6faf","hostName":"europe21*","requestId":"861ba0ce95ee41638dd65eaca4411847_5124","contentType":"text/xml; charset=UTF-8","totalBytes":1199434,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":23,"articlesImgsGithubTotal":23,"successGithubMap":{"myreaderx14":1,"myreaderx25":1,"myreaderx15":1,"myreaderx7":1,"myreaderx27":2,"myreaderx16":1,"myreaderx6":1,"myreaderx10":1,"myreaderx21":1,"myreaderx4":1,"myreaderx11":1,"myreaderx3":1,"myreaderx12":1,"myreaderx23":1,"myreaderx24":1,"myreaderx1":1,"myreaderx30":1,"myreaderx5oss":1,"myreaderx29":1,"myreaderx18":1,"myreaderx19":1,"myreaderx":1},"failGithubMap":{}},"feed":{"createdTime":"2020-08-25 04:30:02","updatedTime":"2020-08-25 06:20:49","id":5124,"name":"安全脉搏","url":"http://www.secpulse.com/feed","subscriber":null,"website":null,"icon":"https://www.secpulse.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx62/cdn100@2020_6/2020/08/24/22-18-56-260_cb0307dd9f40a311.png","description":"分享技术，悦享品质","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":70024,"tmpBodyImgCdnBytes":1129410,"tmpBgImgCdnBytes":0,"extra4":{"start":1598367308267,"total":0,"statList":[{"spend":5291,"msg":"获取xml内容"},{"spend":40,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":13545,"msg":"正文链接上传到cdn"}]},"extra5":23,"extra6":23,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe-56.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-039.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-24.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe68.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-021.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-002.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-005.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-028.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-60.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-009.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-026.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-038.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-25.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe-23.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-004.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe64.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-010.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe67.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-016.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-014.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-040.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339370.png","sourceStatusCode":200,"destWidth":864,"destHeight":504,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn41@2020_1/2020/08/25/14-55-20-095_1edccc4e2629cf4c.webp","sourceBytes":327545,"destBytes":70024,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":7239,"convertSpendMs":170,"createdTime":"2020-08-25 22:55:13","host":"us-52*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7,ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"319.9 KB","destSize":"68.4 KB","compressRate":"21.4%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339410.png","sourceStatusCode":200,"destWidth":608,"destHeight":1012,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn35@2020_5/2020/08/25/14-55-23-824_d824a83e58baa9b6.webp","sourceBytes":25686,"destBytes":17812,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":3489,"convertSpendMs":70,"createdTime":"2020-08-25 22:55:21","host":"us-010*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"25.1 KB","destSize":"17.4 KB","compressRate":"69.3%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339408.png","sourceStatusCode":200,"destWidth":864,"destHeight":347,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn49@2020_1/2020/08/25/14-55-23-782_2043b41259f93076.webp","sourceBytes":26054,"destBytes":16086,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":3374,"convertSpendMs":14,"createdTime":"2020-08-25 22:55:21","host":"us-038*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"25.4 KB","destSize":"15.7 KB","compressRate":"61.7%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339386.png","sourceStatusCode":200,"destWidth":864,"destHeight":200,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn88@2020_3/2020/08/25/14-55-24-396_e18f17532be51a12.webp","sourceBytes":90844,"destBytes":24268,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":4013,"convertSpendMs":12,"createdTime":"2020-08-25 22:55:21","host":"us-005*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"88.7 KB","destSize":"23.7 KB","compressRate":"26.7%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339392.png","sourceStatusCode":200,"destWidth":864,"destHeight":306,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn5@2020_1/2020/08/25/14-55-24-498_4de92382e27f5672.webp","sourceBytes":111446,"destBytes":30190,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":4030,"convertSpendMs":20,"createdTime":"2020-08-25 22:55:21","host":"us-028*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"108.8 KB","destSize":"29.5 KB","compressRate":"27.1%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-15983393921.png","sourceStatusCode":200,"destWidth":864,"destHeight":322,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn41@2020_4/2020/08/25/14-55-24-427_5a8da09cc5bdb4b3.webp","sourceBytes":34516,"destBytes":10166,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":4338,"convertSpendMs":13,"createdTime":"2020-08-25 22:55:21","host":"europe-23*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"33.7 KB","destSize":"9.9 KB","compressRate":"29.5%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339403.png","sourceStatusCode":200,"destWidth":864,"destHeight":295,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn82@2020_6/2020/08/25/14-55-24-403_1e149a26d6d07b53.webp","sourceBytes":146635,"destBytes":39022,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":4472,"convertSpendMs":19,"createdTime":"2020-08-25 22:55:21","host":"europe-60*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"143.2 KB","destSize":"38.1 KB","compressRate":"26.6%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339390.png","sourceStatusCode":200,"destWidth":864,"destHeight":431,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn53@2020_5/2020/08/25/14-55-24-747_ca40fb83a0ec7554.webp","sourceBytes":205988,"destBytes":49744,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":4314,"convertSpendMs":25,"createdTime":"2020-08-25 22:55:21","host":"us-026*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"201.2 KB","destSize":"48.6 KB","compressRate":"24.1%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339406.png","sourceStatusCode":200,"destWidth":864,"destHeight":229,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn58@2020_2/2020/08/25/14-55-25-057_ea8a3c04cb0609df.webp","sourceBytes":206835,"destBytes":48668,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":4671,"convertSpendMs":23,"createdTime":"2020-08-25 22:55:21","host":"us-014*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"202 KB","destSize":"47.5 KB","compressRate":"23.5%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339383.png","sourceStatusCode":200,"destWidth":864,"destHeight":227,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn19@2020_5/2020/08/25/14-55-24-924_fb726f04890b0abf.webp","sourceBytes":344553,"destBytes":70026,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":4985,"convertSpendMs":28,"createdTime":"2020-08-25 22:55:21","host":"europe67*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx21","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"336.5 KB","destSize":"68.4 KB","compressRate":"20.3%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339380.png","sourceStatusCode":200,"destWidth":864,"destHeight":543,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn30@2020_4/2020/08/25/14-55-25-103_350f11d0325652f4.webp","sourceBytes":253360,"destBytes":58776,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":4802,"convertSpendMs":35,"createdTime":"2020-08-25 22:55:21","host":"us-021*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"247.4 KB","destSize":"57.4 KB","compressRate":"23.2%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339399.png","sourceStatusCode":200,"destWidth":864,"destHeight":237,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn45@2020_6/2020/08/25/14-55-24-660_d5abec474f0377c9.webp","sourceBytes":119388,"destBytes":30662,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":5046,"convertSpendMs":15,"createdTime":"2020-08-25 22:55:21","host":"europe-60*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"116.6 KB","destSize":"29.9 KB","compressRate":"25.7%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339378.png","sourceStatusCode":200,"destWidth":864,"destHeight":424,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn14@2020_1/2020/08/25/14-55-25-284_ddf23d338b4ca41f.webp","sourceBytes":174339,"destBytes":43002,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":5002,"convertSpendMs":49,"createdTime":"2020-08-25 22:55:21","host":"us-004*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"170.3 KB","destSize":"42 KB","compressRate":"24.7%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339372.png","sourceStatusCode":200,"destWidth":864,"destHeight":572,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn62@2020_1/2020/08/25/14-55-25-772_6d91bb4f159fdc3b.webp","sourceBytes":379191,"destBytes":83024,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":5426,"convertSpendMs":37,"createdTime":"2020-08-25 22:55:21","host":"us-002*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"370.3 KB","destSize":"81.1 KB","compressRate":"21.9%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339395.png","sourceStatusCode":200,"destWidth":864,"destHeight":725,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn32@2020_1/2020/08/25/14-55-25-808_77501685f6bee1e6.webp","sourceBytes":460505,"destBytes":115942,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":5663,"convertSpendMs":42,"createdTime":"2020-08-25 22:55:21","host":"us-009*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx23","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"449.7 KB","destSize":"113.2 KB","compressRate":"25.2%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339413.png","sourceStatusCode":200,"destWidth":864,"destHeight":339,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn10@2020_1/2020/08/25/14-55-26-194_e28b42c477ed5b44.webp","sourceBytes":381049,"destBytes":74512,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":5878,"convertSpendMs":38,"createdTime":"2020-08-25 22:55:21","host":"us-016*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"372.1 KB","destSize":"72.8 KB","compressRate":"19.6%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-15983394031.png","sourceStatusCode":200,"destWidth":864,"destHeight":214,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn92@2020_3/2020/08/25/14-55-26-220_7cc6417c99cc7ea9.webp","sourceBytes":225294,"destBytes":50594,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":6237,"convertSpendMs":19,"createdTime":"2020-08-25 22:55:21","host":"europe-25*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"220 KB","destSize":"49.4 KB","compressRate":"22.5%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339387.png","sourceStatusCode":200,"destWidth":864,"destHeight":545,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn99@2020_6/2020/08/25/14-55-27-034_9012c2a807b9fcea.webp","sourceBytes":287835,"destBytes":72048,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":6624,"convertSpendMs":49,"createdTime":"2020-08-25 22:55:21","host":"us-040*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"281.1 KB","destSize":"70.4 KB","compressRate":"25%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339393.png","sourceStatusCode":200,"destWidth":864,"destHeight":706,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn97@2020_2/2020/08/25/14-55-27-504_5314ee9b9cc80007.webp","sourceBytes":374549,"destBytes":86982,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":6439,"convertSpendMs":47,"createdTime":"2020-08-25 22:55:22","host":"us-039*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"365.8 KB","destSize":"84.9 KB","compressRate":"23.2%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339376.png","sourceStatusCode":200,"destWidth":864,"destHeight":543,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn89@2020_2/2020/08/25/14-55-29-060_15bf78cc5f44d88e.webp","sourceBytes":253360,"destBytes":58776,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":9175,"convertSpendMs":28,"createdTime":"2020-08-25 22:55:21","host":"europe68*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"247.4 KB","destSize":"57.4 KB","compressRate":"23.2%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339398.png","sourceStatusCode":200,"destWidth":864,"destHeight":241,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn26@2020_6/2020/08/25/14-55-29-623_4f21dcb1c5504405.webp","sourceBytes":117158,"destBytes":30360,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":9577,"convertSpendMs":28,"createdTime":"2020-08-25 22:55:21","host":"europe-56*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"114.4 KB","destSize":"29.6 KB","compressRate":"25.9%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339411.png","sourceStatusCode":200,"destWidth":864,"destHeight":729,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn85@2020_2/2020/08/25/14-55-31-172_909f6980e41ddab9.webp","sourceBytes":158266,"destBytes":44256,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":11359,"convertSpendMs":44,"createdTime":"2020-08-25 22:55:21","host":"europe-24*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"154.6 KB","destSize":"43.2 KB","compressRate":"28%"},{"code":1,"isDone":false,"source":"https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-139504-1598339374.png","sourceStatusCode":200,"destWidth":864,"destHeight":564,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn65@2020_4/2020/08/25/14-55-33-205_40e02fb08c3339c3.webp","sourceBytes":338234,"destBytes":74494,"targetWebpQuality":75,"feedId":5124,"totalSpendMs":13516,"convertSpendMs":48,"createdTime":"2020-08-25 22:55:21","host":"europe64*","referer":"http://www.secpulse.com/?p=139504","linkMd5ListStr":"ec6e833ca9e24a45b28fffa57a92e1d7","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"330.3 KB","destSize":"72.7 KB","compressRate":"22%"}],"successGithubMap":{"myreaderx14":1,"myreaderx25":1,"myreaderx15":1,"myreaderx7":1,"myreaderx27":2,"myreaderx16":1,"myreaderx6":1,"myreaderx10":1,"myreaderx21":1,"myreaderx4":1,"myreaderx11":1,"myreaderx3":1,"myreaderx12":1,"myreaderx23":1,"myreaderx24":1,"myreaderx1":1,"myreaderx30":1,"myreaderx5oss":1,"myreaderx29":1,"myreaderx18":1,"myreaderx19":1,"myreaderx":1},"failGithubMap":{}}