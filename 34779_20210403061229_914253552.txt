{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2021-04-03 14:11:55","updatedTime":"2021-04-03 14:11:55","title":"Movement data in GIS #35: stop detection & analysis with MovingPandas","link":"http://anitagraser.com/?p=7645","description":"\n<p>In the last few days, there&#8217;s been a sharp rise in interest in vessel movements, and particularly, in understanding where and why vessels stop. Following the grounding of Ever Given in the Suez Canal, satellite images and vessel tracking data (AIS) visualizations are everywhere:</p>\n\n\n\n<figure class=\"wp-block-embed is-type-rich is-provider-twitter wp-block-embed-twitter\"><div class=\"wp-block-embed__wrapper\">\n<div class=\"embed-twitter\"><blockquote class=\"twitter-tweet\" data-width=\"545\" data-dnt=\"true\"><p lang=\"en\" dir=\"ltr\">The 224,000-ton shipping vessel, <a href=\"https://twitter.com/hashtag/EverGiven?src=hash&#38;ref_src=twsrc%5Etfw\">#EverGiven</a>, seen here in this WorldView-2 <a href=\"https://twitter.com/hashtag/satellite?src=hash&#38;ref_src=twsrc%5Etfw\">#satellite</a> image from March 26, 2021, blocking one of the world’s busiest waterways, the <a href=\"https://twitter.com/hashtag/SuezCanal?src=hash&#38;ref_src=twsrc%5Etfw\">#SuezCanal</a>, since Tuesday. <a href=\"https://t.co/KDLoCqX1w8\">pic.twitter.com/KDLoCqX1w8</a></p>&#8212; Maxar Technologies (@Maxar) <a href=\"https://twitter.com/Maxar/status/1375463844462653442?ref_src=twsrc%5Etfw\">March 26, 2021</a></blockquote><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div>\n</div></figure>\n\n\n\n<figure class=\"wp-block-embed is-type-rich is-provider-twitter wp-block-embed-twitter\"><div class=\"wp-block-embed__wrapper\">\n<div class=\"embed-twitter\"><blockquote class=\"twitter-tweet\" data-width=\"545\" data-dnt=\"true\"><p lang=\"en\" dir=\"ltr\">Animation showing how the grounded container ship brought the Suez Canal to a standstill. Huge thanks to <a href=\"https://twitter.com/VesselsValue?ref_src=twsrc%5Etfw\">@VesselsValue</a> for supplying the data.<br><br>Read <a href=\"https://twitter.com/OilSheppard?ref_src=twsrc%5Etfw\">@OilSheppard</a> <a href=\"https://twitter.com/harrydemps?ref_src=twsrc%5Etfw\">@harrydemps</a> &#38; <a href=\"https://twitter.com/hebamks?ref_src=twsrc%5Etfw\">@hebamks</a> story <a href=\"https://t.co/9s1oQXwOlH\">https://t.co/9s1oQXwOlH</a><a href=\"https://twitter.com/hashtag/gistribe?src=hash&#38;ref_src=twsrc%5Etfw\">#gistribe</a> <a href=\"https://twitter.com/hashtag/dataviz?src=hash&#38;ref_src=twsrc%5Etfw\">#dataviz</a> <a href=\"https://t.co/JRkwmhG0KJ\">pic.twitter.com/JRkwmhG0KJ</a></p>&#8212; Steven Bernard (@sdbernard) <a href=\"https://twitter.com/sdbernard/status/1374780461889773569?ref_src=twsrc%5Etfw\">March 24, 2021</a></blockquote><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div>\n</div></figure>\n\n\n\n<p>Using movement data analytics tools, such as <a href=\"https://anitagraser.github.io/movingpandas/\">MovingPandas</a>, we can dig deeper and explore patterns in the data.</p>\n\n\n\n<p>The <a href=\"https://movingpandas.readthedocs.io/en/master/trajectorystopdetector.html\">MovingPandas.TrajectoryStopDetector</a> is particularly useful in this situation. We can provide it with a Trajectory or TrajectoryCollection and let it detect all stops, that is, instances were the moving object stayed within a certain area (with a diameter of 1000m in this example) for a an extended duration (at least 3 hours).</p>\n\n\n<div class=\"wp-block-syntaxhighlighter-code \"><pre class=\"brush: python; title: ; notranslate\">\nstops = mpd.TrajectoryStopDetector(trajs).get_stop_segments(\n    min_duration=timedelta(hours=3), max_diameter=1000)\n</pre></div>\n\n\n<p>The resulting stop segments include spatial and temporal information about the stop location and duration. To make this info more easily accessible, let&#8217;s turn the stop segment TrajectoryCollection into a point GeoDataFrame:</p>\n\n\n<div class=\"wp-block-syntaxhighlighter-code \"><pre class=\"brush: python; title: ; notranslate\">\nstop_pts = gpd.GeoDataFrame(columns=&#91;'geometry']).set_geometry('geometry')\nstop_pts&#91;'stop_id'] = &#91;track.id for track in stops.trajectories]\nstop_pts= stop_pts.set_index('stop_id')\n\nfor stop in stops:\n    stop_pts.at&#91;stop.id, 'ID'] = stop.df&#91;'ID']&#91;0]\n    stop_pts.at&#91;stop.id, 'datetime'] = stop.get_start_time()\n    stop_pts.at&#91;stop.id, 'duration_h'] = stop.get_duration().total_seconds()/3600\n    stop_pts.at&#91;stop.id, 'geometry'] = stop.get_start_location()\n</pre></div>\n\n\n<p>Indeed, I think the next version of MovingPandas should include a function that directly returns stops as points.</p>\n\n\n\n<p>Now we can explore the stop information. For example, the map plot shows that stops are concentrated in three main areas: the northern and southern ends of the Canal, as well as the Great Bitter Lake in the middle. By looking at the timing of stops and their duration in a scatter plot, we can clearly see that the Ever Given stop (red) caused a chain reaction: the numerous points lining up on the diagonal of the scatter plot represent stops that very likely are results of the blockage:</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><a href=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked3.gif\"><img data-attachment-id=\"7656\" data-permalink=\"https://anitagraser.com/2021/03/28/movement-data-in-gis-35-stop-detection-analysis-with-movingpandas/mpd_stops_linked3/\" data-orig-file=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked3.gif\" data-orig-size=\"368,783\" data-comments-opened=\"1\" data-image-meta=\"{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}\" data-image-title=\"mpd_stops_linked3\" data-image-description=\"\" data-medium-file=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked3.gif?w=141\" data-large-file=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked3.gif?w=368\" src=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked3.gif\" alt=\"\" class=\"wp-image-7656\" /></a></figure></div>\n\n\n\n<p>Before the grounding, the stop distribution nicely illustrates the canal schedule. Vessels have to wait until it&#8217;s turn for their direction to go through:</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter\"><a href=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked4.gif\"><img data-attachment-id=\"7659\" data-permalink=\"https://anitagraser.com/2021/03/28/movement-data-in-gis-35-stop-detection-analysis-with-movingpandas/mpd_stops_linked4/\" data-orig-file=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked4.gif\" data-orig-size=\"394,783\" data-comments-opened=\"1\" data-image-meta=\"{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}\" data-image-title=\"mpd_stops_linked4\" data-image-description=\"\" data-medium-file=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked4.gif?w=151\" data-large-file=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked4.gif?w=394\" src=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked4.gif\" alt=\"\" class=\"wp-image-7659\" /></a></figure></div>\n\n\n\n<p>You can see the full analysis workflow in the following video. Please turn on the captions for details.</p>\n\n\n\n<figure class=\"wp-block-embed is-type-rich is-provider-youtube wp-block-embed-youtube wp-embed-aspect-16-9 wp-has-aspect-ratio\"><div class=\"wp-block-embed__wrapper\">\n<iframe class='youtube-player' width='545' height='307' src='https://www.youtube.com/embed/OgJH0xUie8k?version=3&#038;rel=1&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;fs=1&#038;hl=en&#038;autohide=2&#038;wmode=transparent' allowfullscreen='true' style='border:0;' sandbox='allow-scripts allow-same-origin allow-popups allow-presentation'></iframe>\n</div></figure>\n\n\n\n<p>Huge thanks to VesselsValue for supplying the data!</p>\n\n\n\n<p>For another example of <a href=\"https://anitagraser.github.io/movingpandas/\">MovingPandas</a>&#8216; stop dectection in action, have a look at <a style=\"outline-width:0 !important;\" href=\"https://bryanvallejo16.medium.com/stop-detection-in-gps-tracks-movingpandas-keplergl-point-map-with-stops-duration-in-bird-664064b3ccbc\">Bryan R. Vallejo&#8217;s tutorial on detecting stops in bird tracking data</a> which includes some awesome visualizations using KeplerGL:</p>\n\n\n\n<figure class=\"wp-block-image alignnone\"><a href=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_kepler.gif\"><img data-attachment-id=\"7654\" data-permalink=\"https://anitagraser.com/2021/03/28/movement-data-in-gis-35-stop-detection-analysis-with-movingpandas/mpd_stops_kepler/\" data-orig-file=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_kepler.gif\" data-orig-size=\"1192,1335\" data-comments-opened=\"1\" data-image-meta=\"{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}\" data-image-title=\"mpd_stops_kepler\" data-image-description=\"\" data-medium-file=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_kepler.gif?w=268\" data-large-file=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_kepler.gif?w=545\" src=\"https://underdark.files.wordpress.com/2021/03/mpd_stops_kepler.gif\" alt=\"\" class=\"wp-image-7654\" /></a><figcaption>Kepler.GL visualization by <a style=\"outline-width:0 !important;\" href=\"https://bryanvallejo16.medium.com/stop-detection-in-gps-tracks-movingpandas-keplergl-point-map-with-stops-duration-in-bird-664064b3ccbc\">Bryan R. Vallejo</a></figcaption></figure>\n\n\n\n<hr class=\"wp-block-separator\" />\n\n\n\n<p>This post is part of a series. Read more about&#160;<a href=\"https://anitagraser.com/movement-data-in-gis/\">movement data in GIS.</a></p>\n\n\n\n<p></p>\n","descriptionType":"html","publishedDate":"Sun, 28 Mar 2021 16:21:39 +0000","feedId":34779,"bgimg":"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked3.gif","linkMd5":"30415b03c82ecd64822457fd0775192f","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn55@2020_6/2021/04/03/06-11-58-093_8147cf087fe17943.webp","destWidth":368,"destHeight":783,"sourceBytes":1599857,"destBytes":538980,"author":"underdark","articleImgCdnMap":{"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked3.gif":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn55@2020_6/2021/04/03/06-11-58-093_8147cf087fe17943.webp","https://underdark.files.wordpress.com/2021/03/mpd_stops_linked4.gif":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn64@2020_1/2021/04/03/06-12-02-036_4d8e34b5d17ec0fb.webp","https://underdark.files.wordpress.com/2021/03/mpd_stops_kepler.gif":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn60@2020_2/2021/04/03/06-12-28-484_4fe2ca7bb0d001a8.webp"},"publishedOrCreatedDate":1617430315468}],"record":{"createdTime":"2021-04-03 14:11:55","updatedTime":"2021-04-03 14:11:55","feedId":34779,"fetchDate":"Sat, 03 Apr 2021 06:11:55 +0000","fetchMs":87,"handleMs":17,"totalMs":33611,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"0a82842047aef539c495a45c4684e43f","hostName":"us-012*","requestId":"69a1d8608cd7421c942f234595ee4ebe_34779","contentType":"application/rss+xml; charset=UTF-8","totalBytes":1588162,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":3,"articlesImgsGithubTotal":3,"successGithubMap":{"myreaderx7":1,"myreaderx16":1,"myreaderx31":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 03:02:36","updatedTime":"2020-09-07 05:14:46","id":34779,"name":"Free and Open Source GIS Ramblings","url":"http://anitagraser.com/feed/","subscriber":92,"website":null,"icon":"https://s0.wp.com/i/buttonw-com.png","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx61/cdn43@2020_6/2020/09/06/21-14-42-648_89ee7de48d6e4f9c.png","description":"written by Anita Graser aka Underdark","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":538980,"tmpBodyImgCdnBytes":1049182,"tmpBgImgCdnBytes":0,"extra4":{"start":1617430315363,"total":0,"statList":[{"spend":88,"msg":"获取xml内容"},{"spend":17,"msg":"解释文章"},{"spend":0,"msg":"上传封面图到cdn"},{"spend":1,"msg":"修正封面图上传失败重新上传"},{"spend":29999,"msg":"正文链接上传到cdn"}]},"extra5":3,"extra6":3,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://us-51.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-029.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked3.gif","sourceStatusCode":200,"destWidth":368,"destHeight":783,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn55@2020_6/2021/04/03/06-11-58-093_8147cf087fe17943.webp","sourceBytes":1599857,"destBytes":538980,"targetWebpQuality":75,"feedId":34779,"totalSpendMs":3358,"convertSpendMs":2099,"createdTime":"2021-04-03 14:11:55","host":"europe63*","referer":"http://anitagraser.com/?p=7645","linkMd5ListStr":"30415b03c82ecd64822457fd0775192f,30415b03c82ecd64822457fd0775192f","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"destSize":"526.3 KB","compressRate":"33.7%","sourceSize":"1.5 MB"},{"code":1,"isDone":false,"source":"https://underdark.files.wordpress.com/2021/03/mpd_stops_linked4.gif","sourceStatusCode":200,"destWidth":394,"destHeight":783,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn64@2020_1/2021/04/03/06-12-02-036_4d8e34b5d17ec0fb.webp","sourceBytes":333995,"destBytes":171294,"targetWebpQuality":75,"feedId":34779,"totalSpendMs":3356,"convertSpendMs":2957,"createdTime":"2021-04-03 14:11:58","host":"us-029*","referer":"http://anitagraser.com/?p=7645","linkMd5ListStr":"30415b03c82ecd64822457fd0775192f","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"destSize":"167.3 KB","compressRate":"51.3%","sourceSize":"326.2 KB"},{"code":1,"isDone":false,"source":"https://underdark.files.wordpress.com/2021/03/mpd_stops_kepler.gif","sourceStatusCode":200,"destWidth":1192,"destHeight":1335,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn60@2020_2/2021/04/03/06-12-28-484_4fe2ca7bb0d001a8.webp","sourceBytes":893024,"destBytes":877888,"targetWebpQuality":75,"feedId":34779,"totalSpendMs":29954,"convertSpendMs":29359,"createdTime":"2021-04-03 14:11:58","host":"us-51*","referer":"http://anitagraser.com/?p=7645","linkMd5ListStr":"30415b03c82ecd64822457fd0775192f","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"destSize":"857.3 KB","compressRate":"98.3%","sourceSize":"872.1 KB"}],"successGithubMap":{"myreaderx7":1,"myreaderx16":1,"myreaderx31":1},"failGithubMap":{}}