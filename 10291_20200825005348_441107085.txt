{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Let’s Git it On","link":"https://developers.soundcloud.com/blog/lets-git-it-on","description":"<p>Being both a mediocre biz dev guy and a nerd means I get to post on the Developer blog as well as our Company blog, and today I’d like to talk to you about Git.</p> \n<p><strong>What is Git?</strong></p> \n<blockquote> \n <p><a href=\"http://git-scm.com/\">Git</a> is a free &amp; open source, version control system that when used in conjunction with social coding websites such as <a href=\"https://github.com\">GitHub</a> can greatly improve your efficiency for both small and large projects by keeping track of changes, collaborators, and more. You’ll be wondering how you ever lived without it.</p> \n</blockquote> \n<p>I’ve had to teach myself the basics of Git from day one with SoundCloud and I recently graduated from clueless to novice with my first successful Fork &gt; Edit &gt; Pull.</p> \n<p><strong>Fork What?</strong></p> \n<blockquote> \n <p>Projects on Git are stored in repositories and when these are made public, anyone can <a href=\"http://help.github.com/forking/\">Fork it</a> (make a copy of your project), Edit it, and Send a Pull Request (notify you of the changes). Should you choose to Pull it, those changes will be added to your project. This is the definition of social coding. Killer.</p> \n</blockquote> \n<p>I recently did this dance with a great new Ruby gem called OmniAuth from Intridea.</p> \n<p><strong>What’s OmniAuth?</strong></p> \n<blockquote> \n <p>“OmniAuth is a new Rack-based authentication system for multi-provider external authentcation.” – which allows you as a developer to roll out a login system consisting of any number of 3rd party providers, such as Twitter &amp; Facebook, in no time at all.</p> \n</blockquote> \n<p>OmniAuth just had one thing missing: SoundCloud support! So I said, “Fork This,” (laughing all by myself at home) and forked the project. Within an hour or so I had a working implementation and sent a Pull request to Intridea. And then just this morning, SoundCloud support was approved and added to the gem. Victory!</p> \n<p>Here’s a link to the latest gem: <a href=\"https://github.com/intridea/omniauth\">github.com/intridea/omniauth</a>.</p> \n<p>If you haven’t already, I invite you to dig deeper into the world of Git and open-source. While it can be a bit daunting at first for a novice (like myself)–once learned, you’ll never go back. Plus, you’ll have a better understanding of our own open-source offerings available from <a href=\"https://github.com/soundcloud\">github.com/soundcloud</a></p> \n<p>If you have any questions or comments, I’m <a href=\"mailto:lee@soundcloud.com\">lee@soundcloud.com</a>, <a href=\"https://twitter.com/leemartin\">@leemartin</a> on Twitter, and <a href=\"https://github.com/leemartin\">leemartin</a> on Github. Happy Hacking!</p>","descriptionType":"html","publishedDate":"Tue, 26 Oct 2010 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"07c508bb1a8df428b4f4453be0037848","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud in Scalding case study by Concurrent Inc.","link":"https://developers.soundcloud.com/blog/soundcloud-concurrent-scalding-case-study","description":"<p>Recently we teamed up with Concurrent Inc., the backers of the data-processing framework <a href=\"http://www.cascading.org/\">Cascading</a>, to do a <a href=\"http://www.concurrentinc.com/customer/soundcloud/\">case study</a> of how we use <a href=\"https://github.com/twitter/scalding\">Scalding</a> for some of our data-driven products such as Search. Scalding enables us to iterate quickly, test easily, and it allows for loose coupling of some of our data-processing pipelines.</p> \n<p>Check back for future posts about our use of other data-processing tools, and frameworks such as <a href=\"https://spark.apache.org/\">Spark</a>.</p>","descriptionType":"html","publishedDate":"Tue, 02 Dec 2014 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"ca1dc8543fb6a91ec375984673f81c9e","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569979},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Open Sourcing Intervene","link":"https://developers.soundcloud.com/blog/open-sourcing-intervene","description":"<p>A little while back, the web team at SoundCloud got an urgent report that our upload page looked weird in the US. Web engineering is based in Berlin, and it looked fine outside the US. However, we quickly identified that a change we’d made recently was conflicting with some custom visuals that were only being run for US visitors.</p> \n<p>Rolling back the change was the easy part, but we needed to emulate the API response in Berlin in order to replicate and fix the issue properly. We develop against a single HTTPS test instance of our <a href=\"https://www.thoughtworks.com/de/insights/blog/bff-soundcloud\">BFF</a>, and it’s not trivial to add extra mocking directly into that BFF code (it’s the same code that gets deployed to production). We ended up adding a breakpoint in the browser dev tools where the response was received, and we were able to manually inject the US version of the response. It wasn’t pretty and we weren’t proud, but we were able to replicate and fix the issue.</p> \n<p>Although we’d resolved the issue, I still thought: “There has to be an easier way. After all, we just need to override one endpoint and proxy the rest to the real server, so how hard can it be?”</p> \n<h2>Finding a Solution</h2> \n<p>I looked into a few existing solutions, but none were as all-in-one as I’d have liked. I wanted to be able to start a command locally and override specific endpoints and have the HTTPS certificates generated and trusted automatically. I also wanted overriding and editing responses to be possible in languages frontend engineers are familiar with, and I wanted that this configuration could be checked in to the repository to be shared with other engineers.</p> \n<p>And so <a href=\"https://intervene.dev\">intervene</a> was born.</p> \n<h2>Intervene</h2> \n<p><code class=\"language-text\">intervene</code> is a node.js process that works like a man-in-the-middle proxy (except it’s not an HTTP proxy, as it only proxies to a single host and appears to be a single HTTP server). It enables the altering of requests and responses for mocking purposes. The configuration is written in <a href=\"https://www.typescriptlang.org\">TypeScript</a>, so that frontend engineers are using a familiar language (as TypeScript is a superset of JavaScript, using plain JavaScript is fine too).</p> \n<p>It automatically generates and trusts self-signed certificates for HTTPS, so in every scenario, only a single command is necessary to create and start a proxy, with no extra steps to perform manually.</p> \n<p>At SoundCloud, we used it to build the frontend for a major creator feature before the backend was ready. We added full typing support to <code class=\"language-text\">intervene</code> in order to use it to discuss the APIs as they were being built. Our mock became the documentation around which discussions were had on what the API should look like. We were able to slowly turn the mocking off as the backend endpoints started to work, and we were even able to patch up responses when the backend implementation wasn’t finished and was only partially working. It’s now become a key piece of our development tooling, with many mocks checked in to frontend repos so that engineers can quickly turn on mocking for common scenarios.</p> \n<h2>Open Source</h2> \n<p>We’re really excited to be able to open source this tool today. It’s been invaluable not only in development, but also in recreating edge cases and a whole bunch of other scenarios where we just need to alter a header, request, or response to quickly try something out.</p> \n<p>To install globally (so you can run <code class=\"language-text\">intervene</code> from anywhere):</p> \n<p><code class=\"language-text\">npm install -g intervene</code></p> \n<p>You can also install it as a devDependency of your project:</p> \n<p><code class=\"language-text\">npm install --save-dev intervene</code></p> \n<h2>Configuration</h2> \n<p>A configuration can be automatically generated using <code class=\"language-text\">intervene create https://api.mycompany.com</code> (or whatever host you want to create a configuration for). In this example, it generates a file called <code class=\"language-text\">api.mycompany.com.ts</code>.</p> \n<p>So what does a minimal configuration look like?</p> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ProxyConfig <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'intervene'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> config<span class=\"token punctuation\">:</span> ProxyConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  target<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://api.mycompany.com'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> config<span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>Let’s add a static JSON response to an endpoint:</p> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ProxyConfig <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'intervene'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> config<span class=\"token punctuation\">:</span> ProxyConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  target<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://api.mycompany.com'</span><span class=\"token punctuation\">,</span>\n\n  routes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'GET /cats'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      collection<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Charlie'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Whiskers'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> config<span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>Saving the file automatically reloads the configuration, so there’s no need to restart after saving. <code class=\"language-text\">GET</code> in the route name is the default, so it can be excluded for the sake of brevity.</p> \n<p>Now if we make a <code class=\"language-text\">GET</code> request to <a href=\"https://api.mycompany.com/cats\">https://api.mycompany.com/cats</a>, we’ll get some static JSON back:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">$ curl -k https://api.mycompany.com/cats\n{\"collection\":[{\"name\":\"Charlie\"},{\"name\":\"Whiskers\"}]}</code></pre>\n</div> \n<p>The <code class=\"language-text\">-k</code> is needed in the curl request, because otherwise curl will complain that the certificate is self-signed and not trusted. However, if the URL is opened in Chrome, it will Just Work(™), because <code class=\"language-text\">intervene</code> has already added the certificate to the operating system’s list of trusted certificates (this list isn’t used by <code class=\"language-text\">curl</code>).</p> \n<p>Note that it doesn’t matter if there was an existing <code class=\"language-text\">/cats</code> endpoint — either way, the JSON specified in the configuration is what is returned and the real server is not called. CORS is automatically enabled for all endpoints from all origins. This can be configured if more specific CORS rules are required.</p> \n<h3>Altering Responses</h3> \n<p>So <code class=\"language-text\">intervene</code> can easily return static JSON, but what about if we want to modify the response from the server? Let’s imagine there’s a <code class=\"language-text\">GET /dogs</code> endpoint that returns the names of some dogs in the same format as the <code class=\"language-text\">/cats</code> endpoint we mocked earlier:</p> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> config<span class=\"token punctuation\">:</span> ProxyConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  target<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://api.mycompany.com'</span><span class=\"token punctuation\">,</span>\n\n  routes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'/dogs'</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> proxy</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Get the response from the real server.</span>\n      <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">proxy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// Mutate the response (add an `age` property to each dog).</span>\n      response<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>collection<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dog</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        dog<span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// Return the response.</span>\n      <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>If a function is used as a route handler, it gets called with the request details, an instance of the <a href=\"https://hapi.dev/api/?v=18.4.1#response-toolkit\">hapi.js response toolkit</a>, and a function that returns a promise of the response from the server.</p> \n<p>Changing the <code class=\"language-text\">req</code> object before calling the <code class=\"language-text\">proxy()</code> function will change the request that gets made to the server. For instance, changing <code class=\"language-text\">req.url.pathname</code> to <code class=\"language-text\">/cats</code> before calling the function will mean that the <code class=\"language-text\">proxy()</code> function will actually call the <code class=\"language-text\">/cats</code> endpoint on the real server when a request is made to <code class=\"language-text\">/dogs</code>.</p> \n<h3>Custom Responses</h3> \n<p>Using the <a href=\"https://hapi.dev/api/?v=18.4.1#response-toolkit\">hapi.js response toolkit</a>, it’s possible to create custom responses. We have used this extensively at SoundCloud to develop error handling routines by mocking an endpoint to return an error.</p> \n<p>For example:</p> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> config<span class=\"token punctuation\">:</span> ProxyConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  target<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://api.mycompany.com'</span><span class=\"token punctuation\">,</span>\n\n  routes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'/whoops'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">,</span> proxy</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token comment\">// Create a response.</span>\n      <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> h<span class=\"token punctuation\">.</span><span class=\"token function\">response</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> error<span class=\"token punctuation\">:</span> “whoops” <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// Set the status code.</span>\n      response<span class=\"token punctuation\">.</span><span class=\"token function\">code</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// Add a custom header.</span>\n      response<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span>‘x<span class=\"token operator\">-</span>error<span class=\"token operator\">-</span>id’<span class=\"token punctuation\">,</span> ‘<span class=\"token number\">123456</span>’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// Return the response.</span>\n      <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<h2>How Does It Work?</h2> \n<p><code class=\"language-text\">intervene</code> initially writes an entry to <code class=\"language-text\">/etc/hosts</code>, adding the address of the server to mock as 127.0.0.1 (localhost). This means requests to that server now get routed to <code class=\"language-text\">127.0.0.1</code>. If the server is HTTPS, it generates a self-signed certificate and calls operating system commands to add it to the set of trusted certificates. It then starts an HTTP(s) server (based on the fantastic <a href=\"https://hapi.dev\">hapi</a> framework). Routes from the configuration file are added, and then default routes are added to proxy all remaining requests to the real server.</p> \n<p>In order to proxy requests, when a request comes in, <code class=\"language-text\">intervene</code> performs a real DNS lookup to ensure it ignores the entry in <code class=\"language-text\">/etc/hosts</code>. These lookups are cached and use the TTLs returned in the DNS response.</p> \n<h2>Where to Find out More</h2> \n<p>There’s a lot more documentation on the <a href=\"https://intervene.dev\">intervene.dev</a> site. Additionally, feel free to raise an issue or send a PR to the <a href=\"https://github.com/soundcloud/intervene\">GitHub project</a> if you have questions or suggestions.</p>","descriptionType":"html","publishedDate":"Tue, 05 May 2020 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"5212d65ac658d6997b59fc66ce04fbb0","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569969},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Hacker Time – the first 3 months","link":"https://developers.soundcloud.com/blog/hacker-time-the-first-3-months","description":"<p>Over 3 months ago we started the “Hacker Time” initiative (see <a href=\"https://backstage.soundcloud.com/2011/12/stop-hacker-time/\" title=\"here\">here</a>) and now it is time for a recap what’s happened so far. From the outset, people outside of the engineering department were very forthcoming in suggesting ideas for Hacker Time projects. While it was great to see so much interest, the essence of Hacker Time is that engineers create the projects that they’re personally motivated to develop. (It’s absolutely key to keep things separate from the general backlog!). Once that clicked, our engineers started initiating and working on their passion projects. Hacker Time has found momentum; currently around 50% of our engineers (who have been in the company longer than 6 months) have a project they are currently working on. These projects range from doing remote online courses to participating in competitions to cool hacks (which sometimes start at “Hack Days” and are then continued within Hacker Time). Some of the highlights are:</p> \n<ul> \n <li><a href=\"http://wiki.musichackday.org/index.php?title=InstaSound\" title=\"InstaSound\">Instasound</a> lets you record your sounds, apply a range of filters in real time, and instantly share to SoundCloud <a href=\"http://vimeo.com/36169628\" title=\"here\"> – video</a></li> \n <li><a href=\"https://github.com/soundcloud/large-hadron-migrator\" title=\"Large Hadron Migrator\">Large Hadron Migrator</a> – a tool to migrate database tables online without downtime</li> \n <li><a href=\"https://rubygems.org/gems/hyperspec\" title=\"Hyperspec\">HyperSpec</a> – HyperSpec provides a Ruby DSL for testing HTTP APIs from the “outside”</li> \n <li><a href=\"http://storywheel.cc/\" title=\"Storywheel\">Story Wheel</a> lets you record a story around your Instagram pictures and share it on the web as a nostalgic slideshow.</li> \n <li><a href=\"https://github.com/rngtng/massive_sitemap#readme\" title=\"Massive Sitemap\">Massive Site Map</a> – a ruby gem to build painfree google sitemaps for webpages with millions of pages. Differential updates keep generation time short and reduces load on DB.</li> \n <li><a href=\"http://www.kddcup2012.org/\">KDD Cup 2012</a> – a team of 5 SoundCloud engineers is participating</li> \n <li>Some engineers are taking online courses from Stanford, e.g. the <a href=\"http://jan2012.ml-class.org/\" title=\"link\">machine learning online course</a></li> \n</ul> \n<p>We’ve decided not to track the aggregate hours spent on Hacker Time projects, but to leave it to the teams to organize. It’s an approach that’s working well, because it reinforces the spontaneity and informality that this kind of initiative needs in order to be credible.</p> \n<p>So what about the 50% of engineers that haven’t yet worked on their own Hacker Time project? Well, no big surprises here, there are two main reasons: Either they feel they have don’t have enough time or they haven’t found a topic yet.</p> \n<p>Overall we’ve seen the initial concept successfully initiated and it’s begun to get into full swing. We’re really pleased with the output so far and will have more updates soon – some engineers will present their projects in more detail!</p>","descriptionType":"html","publishedDate":"Mon, 19 Mar 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"579e7a5dc9e6318e9a5c82e49e508ae9","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"PageRank in Spark","link":"https://developers.soundcloud.com/blog/pagerank-in-spark","description":"<p>SoundCloud consists of hundreds of millions of tracks, people, albums, and playlists, and navigating this vast collection of music and personalities poses a large challenge, particularly with so many covers, remixes, and original works all in one place.</p> \n<!-- more --> \n<p>For <a href=\"https://soundcloud.com/search\">search on SoundCloud</a>, one of the ways we approach this problem is by using our own version of the <a href=\"https://en.wikipedia.org/wiki/PageRank\">PageRank algorithm</a>, which we affectionately refer to as <a href=\"https://help.soundcloud.com/hc/en-us/articles/115003568168-Search-on-SoundCloud\">DiscoRank</a> (Get it? Disco as in <em>disco</em>very <strong>and</strong> <em>Saturday Night Fever</em>?!).</p> \n<p>The job of PageRank is to help rank search results from a query like finding all Go+ tracks called “<a href=\"https://soundcloud.com/search/go?q=royals\">royals</a>.” At first glance, this task might seem trivial. The first result is, and should indeed be, <a href=\"https://soundcloud.com/lordemusic\">Lorde’s</a> original song, “<a href=\"https://soundcloud.com/lordemusic/royals-1\">Royals</a>.” However, there are plenty of covers and remixes of this track, which leaves us with questions like: Which ones should we show at the top and in which order? What about other tracks in our catalog that have the word “royals” in them? Where should they be in our search results list?</p> \n<p>Our use of PageRank started in the summer of 2012 when we <a href=\"https://blog.soundcloud.com/2012/05/09/next/\">introduced SoundCloud Next</a> (now our current website). In the years since, we have grown exponentially, and our implementation of PageRank has had to scale with that enormous growth in several ways — from an in-memory Java implementation, to being distributed in Hadoop using the vanilla MapReduce API, and more recently, by using <a href=\"https://twitter.github.io/scalding/powered_by.html\">Scalding</a>. In the summer of 2017, we made the switch to our latest version of PageRank, which runs in <a href=\"http://spark.apache.org\">Spark</a>, and now we’re open sourcing our implementation as a reusable <a href=\"https://soundcloud.github.io/spark-pagerank\">library</a>!</p> \n<p>But before implementing yet another version ourselves, we first tried out the <a href=\"https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.lib.PageRank$\">built-in PageRank from Spark</a>. Unfortunately, we quickly realized it didn’t support the graph we were using, as we have nodes with no out-edges, some nodes with no in-edges, and edge weights that are not uniform.</p> \n<p>After this first try, we decided to implement PageRank ourselves and tried a variety of the Spark APIs, including <a href=\"https://spark.apache.org/graphx\">GraphX</a>. Although our GraphX implementation was working in small-scale test cases, when we ran at full-scale, we encountered several <a href=\"https://issues.apache.org/jira/browse/SPARK-5480\">bugs</a> that are currently unresolved. Based on this experience, we decided that a simple approach using the <a href=\"https://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.rdd.RDD\">RDD API</a> would suit us best. We spent about an equal amount of time on implementation and on performance evaluation and tuning, but in the end, Spark was a perfect fit for this job, and we were able to utilize many of the features Spark is known for, such as in-memory data storage, easy parallel computation, and the implementation of iterative learning algorithms.</p> \n<p>As a result of this work, we have made improvements to the performance, scalability, and general flexibility of our PageRank implementation. And because it’s able to perform one iteration of PageRank in approximately three to five minutes on a graph of more than 700 million nodes and 15 billion edges, this new implementation has enabled us to update ranks in search more frequently throughout the day, in addition to preparing us for continued growth over the coming years.</p> \n<p>With open sourcing our implementation of PageRank, we hope you can benefit from the work we’ve put into this for your own use cases, from search to recommendations. Go check out the <a href=\"https://soundcloud.github.io/spark-pagerank\">project</a>, try it out, open issues, and get involved!</p>","descriptionType":"html","publishedDate":"Wed, 24 Jan 2018 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"47038daeb46cb4c7a6cd2299f9b8db64","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569978},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"How to Make a SoundCloud Powered Children's Toy","link":"https://developers.soundcloud.com/blog/how-to-make-a-soundcloud-powered-toy","description":"<p>Just over a week ago we had our first internal hackathon at SoundCloud. You can read (and listen!) about it on our <a href=\"https://blog.soundcloud.com/2012/08/20/we-hack/\">community blog</a> or read some of the <a href=\"http://www.businessinsider.com/check-out-the-awesome-hovercraft-this-startups-engineers-built-in-a-48-hour-hackathon-2012-8\">awesome</a> <a href=\"http://www.rollingstone.com/culture/blogs/gear-up/soundcloud-founder-alex-ljung-encourages-company-wide-sound-hacking-20120824\">press coverage</a> the event received.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/48a11/wehack.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQFAv/EABgBAQADAQAAAAAAAAAAAAAAAAABAgME/9oADAMBAAIQAxAAAAGPWxbl6GUOBLoZdX//xAAaEAEBAAMBAQAAAAAAAAAAAAABAgADESES/9oACAEBAAEFAtT1i0Hfc4U9m/kfWXLtwfP/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8BYiP/xAAVEQEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAgEBPwFj/8QAHBAAAwACAwEAAAAAAAAAAAAAAAERISISIFGB/9oACAEBAAY/Ao6cUiWfDVZ9Nnkb6f/EABwQAQEBAAEFAAAAAAAAAAAAAAERADEhQVFhkf/aAAgBAQABPyFawJ2w5SnFcrS9Eb5QyIt08TNULW5TjJJn8N//2gAMAwEAAgADAAAAEAfQP//EABgRAAMBAQAAAAAAAAAAAAAAAAABEUEx/9oACAEDAQE/EJVNEunQiiP/xAAYEQEBAAMAAAAAAAAAAAAAAAAAARExQf/aAAgBAgEBPxCOsKu3/8QAHhABAQEAAQQDAAAAAAAAAAAAAREAITFBUWFxgZH/2gAIAQEAAT8QJjqLwVvTjCitIKnmvfEngcLM/cpWK+D6yIoUog9rbzgJOR5Set1pMASQ9Zgop5N//9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Hacking\" title=\"Hacking\" src=\"https://developers.soundcloud.com/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/48a11/wehack.jpg\" srcset=\"/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/f544b/wehack.jpg 200w,\n/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/41689/wehack.jpg 400w,\n/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/48a11/wehack.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<p>We had over 60 people attend and over 20 projects were demoed. I joined a team organized by <a href=\"https://soundcloud.com/joshdevins\">Josh Devins</a> to build <a href=\"https://github.com/soundcloud/toybox\">ToyBox</a>, a children’s toy that plays sounds from SoundCloud in response to physical events. The team consisted of myself, <a href=\"https://soundcloud.com/horaci\">Horaci Cuevas</a>, <a href=\"https://soundcloud.com/joshdevins\">Josh Devins</a>, and <a href=\"https://soundcloud.com/oliver-hookins\">Oliver Hookins</a>.</p> \n<p>The first task was to come up with a design for our project. An <a href=\"http://www.arduino.cc/\">Arduino</a> fitted with gyro, accelerometer and motion sensors provided the interface between real world events and the rest of the system. A <a href=\"http://www.raspberrypi.org/\">Raspberry Pi</a> would then run the following pieces of software:</p> \n<ul> \n <li><a href=\"https://github.com/soundcloud/toybox/tree/master/pi/downloader\">toybox:downloader</a> - The downloader polls a webapp for data about what sounds from SoundCloud should be played in response to certain events. In order to make the toy more responsive, toybox:downloader downloads the sounds from SoundCloud and stores them on disk (The Raspberry Pi’s SD card).</li> \n <li><a href=\"https://github.com/soundcloud/toybox/tree/master/pi/playback\">toybox:playback</a> - An asynchronous wrapper around mplayer.</li> \n <li><a href=\"https://github.com/soundcloud/toybox/tree/master/pi/serial\">toybox:serial</a> - An app that listens for data on the Raspberry Pi’s serial port. Event data from the Arduino is printed out on stdout for other processes to consume. toybox:serial also uses <a href=\"http://www.zeromq.org/\">0MQ</a> to push event data to a web interface so you can monitor a toy’s activity from a browser. The 0MQ consumer also responds to events by playing the appropriate sounds using toybox:playback.</li> \n</ul> \n<p>To provide an interface for toy owners to register a toy (id’d by the Raspberry Pi’s MAC address) and associate SoundCloud sounds with events, we built a simple <a href=\"http://www.sinatrarb.com/\">Sinatra</a> application that we hosted on Heroku. <a href=\"https://github.com/soundcloud/toybox-webapp\">toybox:webapp</a> also provides a couple of endpoints that serve JSON describing what sounds should be played when for a particular toy. This provided the service endpoint needed by toybox:downloader.</p> \n<p>Knowing what needed to be built, we each started hacking on a piece. Horaci worked on toybox:serial, Oliver worked on toybox:downloader and toybox:playback and I worked on toybox:webapp. Josh focused on the Arduino soldering and coding and Oliver and Horaci helped get the Pi set up. You can see the <a href=\"https://github.com/soundcloud/toybox/blob/master/arduino/arduino.ino\">Arduino code here</a>.</p> \n<p>There was a bit of frantic integration work at the end, but it did all come together nicely. It was great to see sounds being played from SoundCloud whenever a button was pushed, or the toybox was shaken, tilted or spoken to.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0751508718ebb654039047dfd12bc02c/48a11/toybox.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQCAQP/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAa9ze45cGpLRJBX/xAAcEAACAQUBAAAAAAAAAAAAAAAAAQIDERIhIjH/2gAIAQEAAQUCULS0YXOpkY85pFHaH7//xAAVEQEBAAAAAAAAAAAAAAAAAAARIP/aAAgBAwEBPwFj/8QAFREBAQAAAAAAAAAAAAAAAAAAASD/2gAIAQIBAT8BSP/EABsQAAIDAAMAAAAAAAAAAAAAAAABEBEhMUFh/9oACAEBAAY/Ane+xg2uzeTCi4//xAAdEAACAgIDAQAAAAAAAAAAAAABEQAhMUFhcYGR/9oACAEBAAE/IbOZ5bi2IHsBuQpxnURZlXIYaJ9wyV6hexc4h8n/2gAMAwEAAgADAAAAEBfAAf/EABcRAAMBAAAAAAAAAAAAAAAAAAEQESH/2gAIAQMBAT8QGogv/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/EMDYs//EABwQAQADAAMBAQAAAAAAAAAAAAEAESExQWFRgf/aAAgBAQABPxBDs9sbFcxMwq7BN1rNGWaORNOP2WBUCXzf7KeqV2OYsUHcdj8pXkpbt8T/2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"ToyBox\" title=\"ToyBox\" src=\"https://developers.soundcloud.com/blog/static/0751508718ebb654039047dfd12bc02c/48a11/toybox.jpg\" srcset=\"/blog/static/0751508718ebb654039047dfd12bc02c/f544b/toybox.jpg 200w,\n/blog/static/0751508718ebb654039047dfd12bc02c/41689/toybox.jpg 400w,\n/blog/static/0751508718ebb654039047dfd12bc02c/48a11/toybox.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<p>Making it pretty is a job for another hackathon :-)</p>","descriptionType":"html","publishedDate":"Thu, 30 Aug 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/48a11/wehack.jpg","linkMd5":"df25e408855776f8d3eed1735ada9d86","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn17@2020_5/2020/08/25/00-49-38-612_03e2a8c8cefb6358.webp","destWidth":500,"destHeight":500,"sourceBytes":22541,"destBytes":26640,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/48a11/wehack.jpg":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn17@2020_5/2020/08/25/00-49-38-612_03e2a8c8cefb6358.webp","https://developers.soundcloud.com/blog/static/0751508718ebb654039047dfd12bc02c/48a11/toybox.jpg":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn43@2020_3/2020/08/25/00-51-42-847_459be9c7cdbd0457.webp"},"publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"How SoundCloud Uses HAProxy with Kubernetes for User-Facing Traffic","link":"https://developers.soundcloud.com/blog/how-soundcloud-uses-haproxy-with-kubernetes-for-user-facing-traffic","description":"<p>A little less than two years ago, SoundCloud began the journey of replacing our homegrown deployment platform, <a href=\"http://gotocon.com/zurich-2013/presentation/Building%20an%20in-house%20Heroku\">Bazooka</a>, with <a href=\"https://kubernetes.io/\">Kubernetes</a>. Kubernetes automates deployment, scaling, and management of containerized applications.</p> \n<!-- more --> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/570aa/cdn-haproxy-k8s.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACK0lEQVQ4y4VU247aMBDl//+o6sM+INGCllZUaC9cQggk5EbuxobgnM64GzZhkTqS5bEyczxz5jiDpmnAi413KSXCMMR6vcZ2u4Xv+7BtG8vlEoeDR/4Gq9Wa/APquoZS6pbLa9Ae2j3LMux2OziOA9uy4GwsWJsNFot3WNYWs9k7fbMNKF98Pp/RxRh0wa7Xq9m11tC0X5Ij9EfCP2sQBBqnE8ddTYVtXotxA+TKjscjiqJAWZYo8hySfJsq/TkeY/r8jDiOiBKFPD8RqIAQlYmPouhrhVx6VVUUSMFCQNJZunuUnoskjpGkKYGdaF3guQpRqIg/aTjkvBtgt/+eUdsoC2i6AJSIs0QtFFWpwR1WFVFyAbXdtnvXMlc2HA4xn8/N+dd0ismPEeI0M+f5nxmevn0nagpznkwmGI3GSKny3pRbQCaYORTULlsa+EgWb6ijEJAC4esCi/EbjYUrbLC1M3hewq30p/yo5Ya0SD0BoY8mS9H4LmovQOFLVFkNQSxUZSe+o5SebIwRmPb20Mwfy4aJKnOI4grh5whWMTiyLElaurm1+lDYOVXjzn7TAJRJAskCBArSnO2USBOB1csL4khxyEPrATJ/zn5/++jRcwt3jvEPnkf6y40fBCm9nLWREUuGB8M65sEO7nnoXUABrD90OTat8WBq86Ik6TBJEgPI4F/eMgc9uuDzJ9L0pHoSNb2W3AAqdf6s8D75v/4HolYs9tgsftN/ARuiiYVxa4vwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"HAProxy routing to Kubernetes pods\" title=\"HAProxy routing to Kubernetes pods\" src=\"https://developers.soundcloud.com/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/8ff1e/cdn-haproxy-k8s.png\" srcset=\"/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/9ec3c/cdn-haproxy-k8s.png 200w,\n/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/c7805/cdn-haproxy-k8s.png 400w,\n/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/8ff1e/cdn-haproxy-k8s.png 800w,\n/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/6ff5e/cdn-haproxy-k8s.png 1200w,\n/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/2f950/cdn-haproxy-k8s.png 1600w,\n/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/570aa/cdn-haproxy-k8s.png 2224w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h2>The Problem</h2> \n<p>An ongoing challenge with dynamic platforms like Kubernetes is routing user traffic — more specifically, routing API requests and website visits from our users to the individual pods running in Kubernetes.</p> \n<p>Most of SoundCloud runs in a physical environment, so we can’t leverage the built-in support for cloud load balancers in Kubernetes. At the edge of our infrastructure, a fleet of HAProxy servers terminates SSL connections and, based on simple rules, forwards traffic to various internal services. The configuration for these servers is generated and tested separately before it is deployed to these terminators. But because there are a lot of safeguards built in, this process takes a long time to complete, and it cannot keep up with the rate at which pods in Kubernetes are moving around. The fundamental challenge of getting user traffic to the pods that keep moving around is a mismatch between our static termination layer and the highly dynamic nature of Kubernetes.</p> \n<h2>The Process</h2> \n<p>To address this challenge, we initially configured the terminator layer to forward HTTP requests to a separate HAProxy-based <a href=\"https://kubernetes.io/docs/concepts/services-networking/ingress/#ingress-controllers\">Ingress controller</a>, but this solution did not work well for us, as the Ingress controller was intended for low-volume internal traffic and is not very reliable.</p> \n<p>Our users generate a lot of traffic, and every problem in the traffic stack means that SoundCloud is not working for someone. Between the Kubernetes Ingress and the terminator configuration, we had two layers of <a href=\"https://en.wikipedia.org/wiki/OSI_model#Layer_7:_Application_Layer\">Layer 7</a> routing that needed to match up and often didn’t. This was frustrating for us as developers and resulted in additional work for us. We also knew that the Ingress controller would not be able to handle the long-lived connections used by some of our clients.</p> \n<p>When SoundCloud engineers build applications, we use a custom command-line interface that generates the Namespace, Service, and Deployment. Optionally, it generates the Ingress Kubernetes objects from command-line flags. We added a flag to the tool that generates these objects, which changes the Service to the <a href=\"https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport\">NodePort</a> type.</p> \n<p>Kubernetes allocates a port number that is not yet used in the cluster to this service, and it opens this port on every node in the cluster. Connections to this port on any of the nodes are forwarded to one of the instances for this service. (When we generate the Kubernetes objects, there is a one-to-one correspondence between Service and Deployment objects. For the sake of brevity, we’ll gloss over the details of ReplicaSet, Pod, and Endpoints objects in Kubernetes here.)</p> \n<p>Note that this is irreversible for a given Service — Kubernetes does not allow removing the node port from a service. We are still looking for a solution for this — thus far, this has only happened early enough in the service lifecycle that we could delete and recreate the service, but this could lead to service interruptions later on when the service is used in production.</p> \n<p>To configure their applications to receive traffic from the internet, application developers declare the public hostname and path, as well as the cluster, namespace, service, and port name for the applications. The systems routing public traffic to applications, such as SSL terminators, CDN distributions, and DNS entries, are configured based on this declaration.</p> \n<h2>The Implementation</h2> \n<p>When the terminator configuration is generated, the script queries the Kubernetes cluster to find the assigned node port for each service, along with the list of Kubernetes nodes. Originally, we added all nodes into the terminator configuration, but this turned out to be a problem.</p> \n<p>Each terminator independently checks the health of each port on each node. With several dozen terminators and hundreds of Kubernetes nodes, this amounted to tens of thousands of health checks being generated every second. Because of the indirection through the nodes, this was not affected by the size of the service itself, so even services that would normally get very little traffic needed a lot of resources just to be able to satisfy these health checks.</p> \n<p>We needed to reduce the number of nodes configured for each service, but we also did not want to send all the traffic through only a limited set of nodes to avoid them becoming a scaling bottleneck. One possible solution would be to simply pick a number of nodes out of the list at random, but this would mean that the configuration completely changes every time it is generated, obscuring the real differences.</p> \n<p>Instead, we decided to use rendezvous hashing between the service name and the node address to pick a fixed number of servers per backend. With this method, a different set of nodes are selected for each service, but the selection is always the same as long as the nodes do not change.</p> \n<p>We chose a high enough number of nodes so that we didn’t need to worry about one or two nodes going away or the nodes overlapping between different high-traffic services.</p> \n<p>To replace a node, we simply restart the pipeline that generates and deploys the terminator configuration. This takes several hours, but it is fully automated. Because each service is routed through a limited number of nodes, we have to take care not to take too many nodes out of service at once. This means we can only replace a limited number of Kubernetes nodes per day, but as of yet, it hasn’t been a problem.</p> \n<h2>The Node Agent</h2> \n<p>During short-term maintenance, such as when rebooting nodes for kernel upgrades, we needed the ability to gracefully drain a node. We wrote an agent for the HAProxy agent-check protocol that listens on a fixed port on every node. For the sake of simplicity, we decided to always remove traffic and pods at the same time. Now, when the node is cordoned in Kubernetes, preventing new pods from being scheduled onto it, the agent updates the HAProxy server state to shift traffic away from this node.</p> \n<p>From time to time, we also need to shift traffic between different deployments of a service on the same cluster or between clusters. To support this, we extended the agent. By adding some annotations on the Kubernetes Service object, we can instruct it to open another per-service agent-check port that includes not only the node maintenance status, but also the desired weight of this service.</p> \n<p>The terminator configuration generation picks this up and configures the agent check accordingly. Application developers can now add multiple Kubernetes backends to any public host and path. For each backend, we select a number of nodes using rendezvous hashing as before and combine the results. By changing the Service annotations, the weight for each backend can then be changed within seconds.</p> \n<h2>The Future</h2> \n<p>We are quite happy with the NodePort-based routing, but there are some caveats.</p> \n<p>For one, the load distribution between the instances of an application is not very even, but we compensate by slightly over-provisioning the corresponding apps. At this point, the cost of the increased resource usage is minor compared to the cost of engineering a better load balancing mechanism.</p> \n<p>Additionally, operating Kubernetes in physical data centers is a challenge. There are standardized solutions for most use cases on cloud providers, but each data center is slightly different — especially if you are not starting from scratch, but rather integrating Kubernetes into an existing infrastructure.</p> \n<p>In this blog post, we described how we solved one particular problem for our particular situation. What’s next? The questions we are thinking about currently revolve around having multiple Kubernetes clusters in different locations, and determining how to route traffic to them in a way that results in each user having the best experience possible.</p> \n<p>How have you solved this problem? We would love to hear how you run Kubernetes. Leave a comment below!</p>","descriptionType":"html","publishedDate":"Thu, 07 Dec 2017 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/8ff1e/cdn-haproxy-k8s.png","linkMd5":"30c03fe964ebed44d678320e9a3bbe09","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn93@2020_6/2020/08/25/00-49-39-672_74a19b9a5247f6b8.webp","destWidth":800,"destHeight":600,"sourceBytes":37543,"destBytes":36554,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/8ff1e/cdn-haproxy-k8s.png":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn93@2020_6/2020/08/25/00-49-39-672_74a19b9a5247f6b8.webp"},"publishedOrCreatedDate":1598316569975},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"XML responses deprecated","link":"https://developers.soundcloud.com/blog/xml-responses-deprecated","description":"<p>The SoundCloud API will be dropping support for Extensible Markup Language (XML) responses. XML will be phased out on the following schedule:</p> \n<ol> \n <li>XML is currently the default response format for requests without an explicit format specified in the path (e.g. <code class=\"language-text\">/tracks</code>) or <code class=\"language-text\">Accept</code> header. This default will be changed to JSON on December 1, 2014.</li> \n <li>Explicit requests for XML — specified either in the path (e.g. <code class=\"language-text\">/tracks.xml</code>) or an <code class=\"language-text\">Accept: application/xml</code> header — will continue to be supported until December 15, 2014. After that point, only JSON responses will be supported.</li> \n</ol> \n<p>SoundCloud has been using JSON exclusively for internal APIs for several years. Dropping support for XML in our public API will allow us to focus on providing consistent and reliable service.</p> \n<p>If your app still uses XML responses, please start working to upgrade it to JSON immediately. If your app does not currently use XML responses, it should be unaffected by this change.</p> \n<p>If you are unable to migrate your app from XML to JSON for some reason, we recommend accessing the SoundCloud API through a proxy server that converts JSON to XML.</p> \n<p>Please let us know if you have any questions about this update <a href=\"mailto:api@soundcloud.com\">via email</a>.</p>","descriptionType":"html","publishedDate":"Mon, 17 Nov 2014 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"16f4c61b02602ad32d252aa672e56b7c","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569979},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"How We Develop New Features Using Offsites and Clean Architecture","link":"https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture","description":"<p>The current SoundCloud iOS App was built back in 2014, resulting in a huge codebase consisting of both Objective-C and Swift, with multiple architectural patterns and lots of legacy code. With time, the team changed and the platform evolved, so for the current iOS Team, maintenance, bug fixing, and implementing new features are all challenges.</p> \n<p>In 2017, our team of six engineers wanted to try out a clean architectural pattern and decided to use VIPER.</p> \n<p>I first read about VIPER four years ago in a post published by <a href=\"https://www.objc.io/issues/13-architecture/viper/\">objc.io</a>. This post is probably the most well-known guide to VIPER. At the time, most iOS applications were using Apple’s Model View Controller (MVC) pattern. This pattern is well suited for relatively small teams where there is only one developer working on one of the components (the Model, the View, or the Controller) at a time. VIPER, on the other hand, is good for larger teams and for parallelizing work among them, particularly when an app is big and complex, which the SoundCloud app is.</p> \n<p>In May 2017 when I joined SoundCloud, I was excited to improve the massive codebase with my previous learnings. Prior to starting at SoundCloud, I’d used VIPER on a project written in Swift in hopes of avoiding the obstacles of MVC. Overall, I had a really positive experience and I was looking forward to exploring it more, and my work at SoundCloud provided the perfect opportunity to do this.</p> \n<p>Because I was the only one on the team familiar with VIPER, we organized a one-day workshop where I explained the VIPER pattern to the team and we rewrote an existing screen (the System Playlist) with it. The feedback from the team was quite positive and everyone was excited to start using it. As a result, we went on to write the new Mini Player feature using VIPER, and because it was successful, we’ve since used VIPER to write additional features.</p> \n<h2>Offsites</h2> \n<p>Every time we set out to write a new feature, we begin with a project kickoff, which is where we define what we are doing and why. Only two engineers, the project’s point people, are present for the kickoff. Part of their responsibility is to organize an offsite to show the feature to the team and brainstorm on the implementation.</p> \n<p>I always liked how hackathons are done. The fast-paced environment, the chaos, the freedom, the focus on the problem without any interruption, and the brainstorming with the people in the room are all things that enable productivity. We can quickly solve a problem and accomplish a shared goal in a much shorter period, all while having fun at the same time.</p> \n<p>Offsites remind me of hackathons because they consist of a full day at another location, without any meetings and with food and drinks. In other words, they’re different than the usual work day. Working toward a goal together, all while having fun, helps with knowledge sharing and team bonding.</p> \n<p>The day starts with an explanation of the feature in question and the UX, followed up by questions to clarify the functionalities. The intention here is to have everyone on the same page without any misunderstandings. Once we have enough information, we start on the <code class=\"language-text\">Contract</code> for the new feature.</p> \n<p>For us, the <code class=\"language-text\">Contract</code> is the most important file, and it’s where all protocols of the VIPER module are defined. This provides a quick and easy overview of the behavior of the feature — <a href=\"https://github.com/gfendres/viper/blob/master/SampleViper/SampleViper/Modules/Tracks/TracksContract.swift\">as you can see here</a> — and helps us organize our ideas.</p> \n<h2>Example</h2> \n<p>As an example, here is how we might build a generic feature. It assumes some familiarity with VIPER, but for more details on the way we at SoundCloud use VIPER, <a href=\"https://github.com/gfendres/viper\">see here</a>.</p> \n<p>We start with a simple application that shows a list of tracks, as seen in the image below.</p> \n<p>As we can see:</p> \n<ul> \n <li>The user sees a list of tracks.</li> \n <li>The user can add a track.</li> \n <li>The user can delete a track.</li> \n</ul> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0d6cb4d2bc96d07a757427300c43775a/1f853/trackscreen.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAd6N1FgE/8QAGBAAAwEBAAAAAAAAAAAAAAAAAQIQETH/2gAIAQEAAQUCPFY7Mn//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8BEX//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAEAAwEBAAAAAAAAAAAAAAABABARIbH/2gAIAQEAAT8hWJiiPtPSBHcK/9oADAMBAAIAAwAAABDnz//EABYRAQEBAAAAAAAAAAAAAAAAAAEQEf/aAAgBAwEBPxBAdJ//xAAXEQEAAwAAAAAAAAAAAAAAAAABEBEh/9oACAECAQE/EEbxj//EABoQAQACAwEAAAAAAAAAAAAAAAEAEBExQcH/2gAIAQEAAT8QYbYKQHgHxQyD2HQadCv/2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"trackscreen\" title=\"trackscreen\" src=\"https://developers.soundcloud.com/blog/static/0d6cb4d2bc96d07a757427300c43775a/a296c/trackscreen.jpg\" srcset=\"/blog/static/0d6cb4d2bc96d07a757427300c43775a/f544b/trackscreen.jpg 200w,\n/blog/static/0d6cb4d2bc96d07a757427300c43775a/41689/trackscreen.jpg 400w,\n/blog/static/0d6cb4d2bc96d07a757427300c43775a/a296c/trackscreen.jpg 800w,\n/blog/static/0d6cb4d2bc96d07a757427300c43775a/1f853/trackscreen.jpg 1024w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h2>Contract</h2> \n<p>We tend to follow a specific order to create the <code class=\"language-text\">Contract</code> (Protocols). This doesn’t mean that a different order would be worse; this is just the way the conversation usually flows.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/c5f5aa4717c62570e3f546578d9e3a88/1f853/contract.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAAd0GNzeoU//EABkQAAIDAQAAAAAAAAAAAAAAAAECABExEP/aAAgBAQABBQJsphxsLWJ//8QAFREBAQAAAAAAAAAAAAAAAAAAAhD/2gAIAQMBAT8BU//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/ASf/xAAYEAEBAAMAAAAAAAAAAAAAAAABEAAREv/aAAgBAQAGPwLF7bon/8QAGxABAAICAwAAAAAAAAAAAAAAAQAQIVERQWH/2gAIAQEAAT8haY7IZKeJXfpISA8tf//aAAwDAQACAAMAAAAQN8//xAAWEQEBAQAAAAAAAAAAAAAAAAARECH/2gAIAQMBAT8QDs//xAAWEQEBAQAAAAAAAAAAAAAAAAARECH/2gAIAQIBAT8QZk//xAAcEAEBAAEFAQAAAAAAAAAAAAABEQAQITFh0eH/2gAIAQEAAT8QqnFCyyudgFBPmm3YohOhM4eI4PdP/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"contract\" title=\"contract\" src=\"https://developers.soundcloud.com/blog/static/c5f5aa4717c62570e3f546578d9e3a88/a296c/contract.jpg\" srcset=\"/blog/static/c5f5aa4717c62570e3f546578d9e3a88/f544b/contract.jpg 200w,\n/blog/static/c5f5aa4717c62570e3f546578d9e3a88/41689/contract.jpg 400w,\n/blog/static/c5f5aa4717c62570e3f546578d9e3a88/a296c/contract.jpg 800w,\n/blog/static/c5f5aa4717c62570e3f546578d9e3a88/1f853/contract.jpg 1024w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span> <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0cc85866837a1b7cfdaedc06ac43776f/1f853/viper.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAADAv/aAAwDAQACEAMQAAAB1FXkIUh5Cf/EABsQAAIBBQAAAAAAAAAAAAAAAAECAwAQERIT/9oACAEBAAEFAtz0WRyIyxXFRoy2/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERAv/aAAgBAwEBPwGaoj//xAAWEQADAAAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8Bqgz/xAAaEAACAgMAAAAAAAAAAAAAAAAAIQEQERIi/9oACAEBAAY/AsbEsddOv//EABsQAQACAgMAAAAAAAAAAAAAAAEAESExQVFh/9oACAEBAAE/IS574qc7gK1HC83E5oL7jjcCQA0T/9oADAMBAAIAAwAAABBoD//EABcRAQEBAQAAAAAAAAAAAAAAAAERAFH/2gAIAQMBAT8QZC9wQi7/xAAXEQEBAQEAAAAAAAAAAAAAAAABEQBR/9oACAECAQE/ECpnMhaG/8QAHBABAAICAwEAAAAAAAAAAAAAAQARITFBUXFh/9oACAEBAAE/EEUjTr8DzEcC9Q2vybESGDWOo0QmOmb9jmIADOYJQB8J/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"viper\" title=\"viper\" src=\"https://developers.soundcloud.com/blog/static/0cc85866837a1b7cfdaedc06ac43776f/a296c/viper.jpg\" srcset=\"/blog/static/0cc85866837a1b7cfdaedc06ac43776f/f544b/viper.jpg 200w,\n/blog/static/0cc85866837a1b7cfdaedc06ac43776f/41689/viper.jpg 400w,\n/blog/static/0cc85866837a1b7cfdaedc06ac43776f/a296c/viper.jpg 800w,\n/blog/static/0cc85866837a1b7cfdaedc06ac43776f/1f853/viper.jpg 1024w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h3>Presenting</h3> \n<p>We start with the <code class=\"language-text\">Presenting</code> protocol, which handles UI events as follows.</p> \n<p>This will probably call the <code class=\"language-text\">Interactor</code> to fetch the data:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token function\">viewDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>This will probably go to the <code class=\"language-text\">Router</code> to show another screen or call the <code class=\"language-text\">Interactor</code> to immediately add a new value:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token function\">didTapAdd</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>This will receive the index of the row and find which track should be deleted. It will probably call the <code class=\"language-text\">Interactor</code> to delete the track:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token function\">didSwipeToDelete</span><span class=\"token punctuation\">(</span>at row<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Int</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<h3>Interacting</h3> \n<p>Next, we develop the <code class=\"language-text\">Interacting</code> protocol because the UI interactions are already defined in the <code class=\"language-text\">Presenting</code> protocol.</p> \n<blockquote> \n <p>We found that using <code class=\"language-text\">delegate</code> over <code class=\"language-text\">blocks</code> between the components is clearer and more organized, given we often call the same <code class=\"language-text\">delegate</code> in multiple methods.</p> \n</blockquote> \n<p>This is how the <code class=\"language-text\">Interacting</code> protocol will look:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token function\">fetchTracks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">addTrack</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Track</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<h3>InteractorDelegate</h3> \n<p>It is time to go back to the View. So next is the <code class=\"language-text\">InteractorDelegate</code>, which is implemented by the <code class=\"language-text\">Presenter</code>. You can expect something like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token function\">didFetch</span><span class=\"token punctuation\">(</span>tracks<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">Track</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">handle</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">:</span> <span class=\"token builtin\">ServiceError</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<h3>Viewing</h3> \n<p>The <code class=\"language-text\">Viewing</code> protocol comes next, with the following:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token function\">update</span><span class=\"token punctuation\">(</span>viewModels<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">TrackViewModel</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>The above receives an array of <code class=\"language-text\">ViewModels</code> to be displayed in the <code class=\"language-text\">TableView</code>. Usually, when we delete something, we call the same method with the items updated. If necessary, we can create a method to update a specific item at the index.</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token function\">show</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>The above receives a <code class=\"language-text\">ViewModel</code> or a <code class=\"language-text\">String</code> to be shown.</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token function\">showLoadingIndicator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">hideLoadingIndicator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<h3>Routing</h3> \n<p>Let’s assume that tapping on a track will direct to another screen with more detail.</p> \n<p>The <code class=\"language-text\">Routing</code> protocol will just present the detail screen, like so:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token function\">presentDetailScreen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>It will get another <code class=\"language-text\">Builder</code> to retrieve the module and to use the <code class=\"language-text\">weak</code> <code class=\"language-text\">ViewController</code> to show the next screen.</p> \n<h2>Hands On</h2> \n<p>Before we start coding, we select the most challenging parts to work on. Depending on the project, it could be a UI interaction, or it could be the decoupling of a class, a service, or even some of the VIPER components.</p> \n<p>We split the team in groups, with each group trying to solve the problem that is given to them. Sometimes it is just a spike that will be performed on a different project, but sometimes we will work on the main application together.</p> \n<p>If the feature is straightforward, each group gets one of the VIPER parts. Then we start branching from a feature branch in which the <code class=\"language-text\">Contract</code> will be updated.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/1ea986f39dad63df30336c9283c35bda/1f853/branching.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAHuIqwgooCv/8QAGBAAAwEBAAAAAAAAAAAAAAAAAQIRABD/2gAIAQEAAQUCBNS1XaYKBz//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwFJ/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Bp//EABsQAAEEAwAAAAAAAAAAAAAAAAABAhAhMTKh/9oACAEBAAY/AtVFz0tjoqP/xAAcEAABBAMBAAAAAAAAAAAAAAABABARgSFBYfD/2gAIAQEAAT8hKgQdKqHmVsBTF5CG/9oADAMBAAIAAwAAABD3/wD/xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QVRgy/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EAglt//EAB0QAQABBQADAAAAAAAAAAAAAAERABAhQVGBodH/2gAIAQEAAT8QVAc5CPTSDZQoF68K6DbPqz2Sdytv/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"contract\" title=\"contract\" src=\"https://developers.soundcloud.com/blog/static/1ea986f39dad63df30336c9283c35bda/a296c/branching.jpg\" srcset=\"/blog/static/1ea986f39dad63df30336c9283c35bda/f544b/branching.jpg 200w,\n/blog/static/1ea986f39dad63df30336c9283c35bda/41689/branching.jpg 400w,\n/blog/static/1ea986f39dad63df30336c9283c35bda/a296c/branching.jpg 800w,\n/blog/static/1ea986f39dad63df30336c9283c35bda/1f853/branching.jpg 1024w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>As time goes on, we continue to communicate with one another, helping with the most difficult parts and explaining architectural decisions, which makes the team more aware of the entire development process. Thanks to a different environment without interruptions, we can have these discussions without disturbing other colleagues.</p> \n<p>By the end of the day, we have a rough idea of how our feature is going to behave. Through this process, we are essentially creating a bridge, wherein each team is constructing from a different place and hoping that in the end, all the pieces fit together.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/1f853/bridge.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAd4VCYv/xAAXEAADAQAAAAAAAAAAAAAAAAAAAREQ/9oACAEBAAEFAqiopFv/xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAwEBPwGn/8QAFREBAQAAAAAAAAAAAAAAAAAAECH/2gAIAQIBAT8Bh//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAQADAQEAAAAAAAAAAAAAAAEAEWEQUf/aAAgBAQABPyHaJNLKekyJRz//2gAMAwEAAgADAAAAEEP/AP/EABURAQEAAAAAAAAAAAAAAAAAAAAh/9oACAEDAQE/ECv/xAAVEQEBAAAAAAAAAAAAAAAAAAAAIf/aAAgBAgEBPxAj/8QAGxAAAwADAQEAAAAAAAAAAAAAAAERITHxUWH/2gAIAQEAAT8Q2Y4+jUgmpTrHOG61bhF4f//Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"contract\" title=\"contract\" src=\"https://developers.soundcloud.com/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/a296c/bridge.jpg\" srcset=\"/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/f544b/bridge.jpg 200w,\n/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/41689/bridge.jpg 400w,\n/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/a296c/bridge.jpg 800w,\n/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/1f853/bridge.jpg 1024w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>What we want to achieve on this day is to identify the possible problems we might have and try to solve or propose solutions while we are together and focused. As a bonus, we may have some of the components done by the end of the day, like a <code class=\"language-text\">Presenter</code> or <code class=\"language-text\">Interactor</code>.</p> \n<h2>After the Offsite</h2> \n<p>After having an offsite, it’s easier to create user stories and estimate and define what needs to be done. To date, the iOS team at SoundCloud has had four offsites. Each one had different outputs and sizes, but all of them helped us share knowledge and brainstorm problems that could have been difficult to solve later.</p> \n<p>Having a clean architecture has given us the possibility of splitting the work, which makes it easier to have six people working on the same feature. It also helps improve awareness of the areas that needed to be covered, thereby reducing unexpected issues.</p> \n<p>As a bonus, we discovered that having everybody in a different working environment with one goal in mind helped us discover problems earlier, improved our shared knowledge and ownership of a feature, and bonded the team.</p> \n<p>We are looking forward to building more features in this format and seeing what we’ll learn from it. We’ve found that every time we do it, our process evolves, we learn new things, and we’re able to refine our workflow. We hope that over time we can decrease assumptions, have more consistent estimations, reduce project risk, and be able to ship features with more confidence.</p>","descriptionType":"html","publishedDate":"Fri, 02 Nov 2018 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/0d6cb4d2bc96d07a757427300c43775a/a296c/trackscreen.jpg","linkMd5":"67a5a2e60f7bb11708bee110bec4ba4a","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn65@2020_2/2020/08/25/00-49-37-245_441dcdf3a03fec12.webp","destWidth":800,"destHeight":600,"sourceBytes":8416,"destBytes":5906,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/0d6cb4d2bc96d07a757427300c43775a/a296c/trackscreen.jpg":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn65@2020_2/2020/08/25/00-49-37-245_441dcdf3a03fec12.webp","https://developers.soundcloud.com/blog/static/c5f5aa4717c62570e3f546578d9e3a88/a296c/contract.jpg":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn10@2020_1/2020/08/25/00-51-41-844_411c18c2629a2d38.webp","https://developers.soundcloud.com/blog/static/0cc85866837a1b7cfdaedc06ac43776f/a296c/viper.jpg":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn7@2020_6/2020/08/25/00-51-45-017_161393d472657c98.webp","https://developers.soundcloud.com/blog/static/1ea986f39dad63df30336c9283c35bda/a296c/branching.jpg":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn9@2020_3/2020/08/25/00-51-42-400_d4f864a8279ac8ad.webp","https://developers.soundcloud.com/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/a296c/bridge.jpg":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn6@2020_1/2020/08/25/00-51-42-127_d0310eab7c1afce8.webp"},"publishedOrCreatedDate":1598316569974},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Deliver software faster by managing work in progress, not by adding overtime","link":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","description":"<p>Product development flow (flow) is the rate at which our products are developed, from idea to deployment. Good flow means that products should pass through the development cycle quickly and continuously.</p> \n<!-- more --> \n<h2>Problem Statement</h2> \n<p>SoundCloud faces challenges with its product development flow. SoundCloud’s CTO, Artem Fishman, summed up these challenges succinctly during the May 2017 Engineering Town Hall.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/c6f5381bbfbad6246acf19130fa69aec/67148/artem_engineering_town_hall.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 55.92948717948718%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACjklEQVQoz22SW0jTURzHt3lJ3fxv+/83r3PL66ZOnbdNzaksL7lMmwMNxQwlL5g9REKllNmNkMIXBQkqCKL3LpAvQS+hqD0UQT4kFSEWkuBr8ulMCrE88OXDeTgfvr9zjko2xqLIOuLNsSQl6ElJMmCzGEmM1+PISkYxarFnJBM46sZfV4ivwkGmVUKlUu1EE6YmMjKciAgNki4SlUEfg0kIE+IkLIlGrMmyiGBKPGMjHeQ7EjDFWXAVlZPtLMLp9pJXKpJXisvlxiaK/JVHRISFqGK/ROlkbl8bIDvVyOitGX4CK5u/WHwxx/v5ZT5twdLKJh7PITIddhSTWTTdR6jWqFELGs0WZqbO4bLHM353mm0h/Li+weKzOT4sLLEu9u++beD1NdF6opN8VxGSdOB/oUYIQ9QpSTycvUhZvpWJqVlCa217mx+CIVmo8dKXdc5fuEKw/TjNwS4URdq/od9lw1tYzOMHV6kqyaBrcJTltU1er3zmzeoa86vfeft1i5cLq+Q4i9HrJRISLcjiLfYI1X/Y583kcH4Bj+5fp//kEWKitZgUM1qdXhyWMRgUJL2CQTbvKWOUtfsLrSYJm9GMr6aSV08nGehtoa83SLC1gTs3B7k3dRavR0zhsYqkU1aSSpG4mhx73D8jh4ULhv5VNDFRMei0Wi6N9NLUVM+ZoVP09LQzPnqa508mCPrzCDTmijhp9Dmorcqi0m3bFaabNVTnaKl2aqnK1WGVw6nwFNDZ0UpLcwPDQlheXkJBnp3hvgBNtdlClEVHsHhHGJIVO827wjq7mu4SFV1lGhE1x3LDmJ4c4vLYAH6/T7RrIzXNSlV5LjfGunEXWvBVHiTgd1JfnUZ9TQ5D/W38BmTcemagRQWMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"artem engineering town hall\" title=\"artem engineering town hall\" src=\"https://developers.soundcloud.com/blog/static/c6f5381bbfbad6246acf19130fa69aec/8ff1e/artem_engineering_town_hall.png\" srcset=\"/blog/static/c6f5381bbfbad6246acf19130fa69aec/9ec3c/artem_engineering_town_hall.png 200w,\n/blog/static/c6f5381bbfbad6246acf19130fa69aec/c7805/artem_engineering_town_hall.png 400w,\n/blog/static/c6f5381bbfbad6246acf19130fa69aec/8ff1e/artem_engineering_town_hall.png 800w,\n/blog/static/c6f5381bbfbad6246acf19130fa69aec/6ff5e/artem_engineering_town_hall.png 1200w,\n/blog/static/c6f5381bbfbad6246acf19130fa69aec/67148/artem_engineering_town_hall.png 1248w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<blockquote> \n <p>“We have a ton of [good] product pressure… We work really hard, but are fundamentally slow to deliver… This resonated everywhere. It takes a very long time to ship something here.”</p> \n</blockquote> \n<p>His conclusion was reached by interviewing over a hundred employees from the Technology Organization. It is clear that employees understand these challenges on a qualitative and intuitive level.</p> \n<p>These are classic symptoms of an overloaded product development queue.</p> \n<p>The problem was then for project managers to develop quantitative metrics for understanding our product development flow and guidelines for improving the flow issues that the company already knew on qualitative and intuitive levels.</p> \n<h2>Post Structure</h2> \n<p>This post describes recent efforts to measure and improve software product development flow at SoundCloud. It demonstrates that we can deliver software faster by managing Work in Progress (WIP) and product quality rather than pushing employees to work overtime.</p> \n<p>The second section describes the discovery phase in which we define and measure some variables for improving flow. Project managers used tools from the <a href=\"https://github.com/soundcloud/project-dev-kpis\">Project Development KPIs Project</a> (PDKP) to understand the problems in our workflow. Understanding that data, they derived the strategy below for improving SoundCloud’s product development flow.</p> \n<ol> \n <li>The company should commit to fewer products at a time</li> \n <li>Teams should work on fewer product features at a time</li> \n <li>Engineers should work on fewer tasks at a time</li> \n <li>Engineering should reduce its code inventory</li> \n <li>Engineering should monitor and reduce the number of bugs over time</li> \n</ol> \n<p>The third section describes our continuous learning process and our first set of guidelines for improving flow.</p> \n<p>The fourth and last section describes preliminary results of our efforts.</p> \n<h2>Defining success and variables</h2> \n<p>This section identifies lead and cycle time as metrics of success in product development and motivates their use. It identifies variables that have an impact on lead and cycle time.</p> \n<h3>Lead and cycle time</h3> \n<p>To improve business outcomes, businesses <a href=\"https://en.wikipedia.org/wiki/SMART_criteria\">define the metrics for the desired outcome</a> then <a href=\"https://en.wikipedia.org/wiki/PDCA\">iterate towards achieving that outcome</a> by observing if actions taken improve or worsen the metrics. Members of the Process Optimization Group at SoundCloud use lead and cycle time as two important measures of our success in product development.</p> \n<p><strong>Lead time</strong> is the time between the initiation and completion of a product’s development. At SoundCloud, this is the time between when a product owner receives a work request to the time when the work is completed.</p> \n<p><strong>Cycle time</strong> is the time between when the production of a product is started and when it is completed. At SoundCloud this is the time between when an engineering team receives a feature request to the time that the software is deployed to users.</p> \n<p>Keeping lead and cycle times low has many benefits, four of which are noted here. The first benefit is that we ship products to users faster, before our competitors. Being first increases the chance that we capture market share.</p> \n<p>The second benefit is the reduction of backlog size. Product managers are incentivized not to commit to projects too far in advance. Since requirements for new products change rapidly, a minimal backlog means more responsive plans and product ideas are used instead of outdated ones.</p> \n<p>The third benefit concerns the size of products shipped. Focusing on minimizing lead time incentivizes teams to deliver new products as MVPs and smaller changes to existing products. This more granular approach decreases the probability of large failures and over-investment in projects that will not succeed.</p> \n<p>The fourth and most important benefit is that SoundCloud can gain information on its product development faster. By shipping faster, we get market information before our competitors. We get feedback on a product earlier in its development cycle. We can make small adjustments in strategies towards our desired outcome rather than large corrections after over-investing in a product that had limited success.</p> \n<p>How can SoundCloud improve lead and cycle time? There are several important variables we can leverage.</p> \n<h3>Variables affecting lead and cycle time</h3> \n<p>This section presents the definitions of variables affecting lead and cycle time as well as an explanation for the effect of each.</p> \n<h4>The ratio of WIP to contributors</h4> \n<p>The ratio of Work in Progress (WIP) to contributors is a measure of how much contributors in a team are multitasking on average. PDKP estimates this by dividing the number of WIP issues in a <a href=\"https://www.atlassian.com/software/jira\">Jira</a> project by the number of engineers active on that project.</p> \n<p>Keeping the ratio of WIP to contributors slightly below 1.0 can decrease cycle time in two ways. First, if engineers develop one product at a time, products will be ready sooner than if they multitask. Say an engineer has two tasks, each of which will take two days. They can either work on both in parallel or one after the other. The schedules of these two options are shown below.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/12305/one_engineer_two_tasks_schedule.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 16.237942122186492%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAA1UlEQVQI1xWLS0uEYAAA/f+39lGWleu6hXQr2Ah6E3UwK8hVET6waNcHFurXty6eJjvMaWa0qqrouo62bZFSEoQR5fcPat1SNw2h71PmORulkH3rLwLyokS1G6q6Ifj3RUHbe9X/WhRFxHFMnmXI3zXG/A3zRjB7yji+T3gebyP2DXJrQjK1MS8C7Icvjh5XOHeCWNdJzQNSyySdmGie5+G6LkIIaqnYuxTsXH+ye7tEv/pgevqCM3/HOfc5OfN4NWzCwxmLHt+wSAZbpOMhy9GA1WjIHwGAzGWTJKq1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"one engineer two tasks schedule\" title=\"one engineer two tasks schedule\" src=\"https://developers.soundcloud.com/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/8ff1e/one_engineer_two_tasks_schedule.png\" srcset=\"/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/9ec3c/one_engineer_two_tasks_schedule.png 200w,\n/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/c7805/one_engineer_two_tasks_schedule.png 400w,\n/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/8ff1e/one_engineer_two_tasks_schedule.png 800w,\n/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/6ff5e/one_engineer_two_tasks_schedule.png 1200w,\n/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/12305/one_engineer_two_tasks_schedule.png 1244w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  Scheduling two tasks for one engineer \n</div> \n<p>In Schedule 1, the engineer works on both in parallel, task 1 is complete at the end of day 3 and task 4 is complete at the end of day 4. The more the engineer interleaves the work, the longer it takes to complete both tasks. In the extreme case—multitasking within each day—both projects might not be completed until the end of day 4. In Schedule 2, the engineer works on the first and then the second, the first is completed at the end of day two and the second at the end of day four. By working on one thing at a time, the engineers have completed a task earlier without adding work!</p> \n<p>The second reason to keep the ratio of WIP to contributors ratio slightly below 1.0 concerns the ability of individual members to change development roles quickly. To understand why, see the idealized model of a team’s workflow below.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/7588d21a9431e8685dab8c4030a439f2/c6f47/u_shaped_flow_cell.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 68.42105263157895%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAB+ElEQVQ4y22TW5OqQAyE+f//yicf3GN5Q0VLvIsKeAEVFTXr16fG3YedqoEwk3Q6neBlWWaLxcImk4l1Oh0bDoc2n89tMBhYGIa2XC5tu93aZrORzZt1v9/tcrmYW6/XS9vj4ng82vl8tjzPZa/Xa4GNRiOdYddqNatWqxYEgRK0221rtVq23+8NUg7Usz8WjH3fF0sWoM1mU2fc5fnJiqKw0+lkX1//BPoB5FGWpUq4Xq92u91sPB4r+3Q6FVve9Xrd0jRV4OPx+CSnIgCfz6e2lySJslIWDLrd7lurle12u7dGhe4oLwgGCibI6ccdUvT7fWnP8lwGdOn1etISljBnwZqSaRSVuAUg/pVKRdpyD5aakqY7i6JIoL+B/rPrWKPReDPvCTCOE5UOIL5IQuxsNlMT1RQcGBtGgiDAuKQMykEK2CADfiRBV7pLLJofDgdp67kuhuFYTmhKEAA4wXq1WoklLCgLAHQFDMbML1OAVCqZEYBNHMcaBWxAYIqmgFI+FQBG45hHABkt3+/KBywPLWgKOlASNoCcAwhrNkB8kxAC2PiQkA1z4j3XALIDRjCa8Z1luQBwRh+AOIeZm1vOGaWyfPz8KdQOOm8ckySVlth/Lfd74l8UVwEB+gHEIDMO7psyYIeuUbSWRtiwc38KjPEDzMV9AxnHIEnPMdJQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"u shaped flow cell\" title=\"u shaped flow cell\" src=\"https://developers.soundcloud.com/blog/static/7588d21a9431e8685dab8c4030a439f2/8ff1e/u_shaped_flow_cell.png\" srcset=\"/blog/static/7588d21a9431e8685dab8c4030a439f2/9ec3c/u_shaped_flow_cell.png 200w,\n/blog/static/7588d21a9431e8685dab8c4030a439f2/c7805/u_shaped_flow_cell.png 400w,\n/blog/static/7588d21a9431e8685dab8c4030a439f2/8ff1e/u_shaped_flow_cell.png 800w,\n/blog/static/7588d21a9431e8685dab8c4030a439f2/6ff5e/u_shaped_flow_cell.png 1200w,\n/blog/static/7588d21a9431e8685dab8c4030a439f2/c6f47/u_shaped_flow_cell.png 1273w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  Software engineering is an invisible “U-shaped flow cell.” \n</div> \n<p>Engineers need to quickly transition between planning, developing, reviewing, and fixing bugs. They fulfill multiple roles in the software development process. This collaboration pattern is similar to <a href=\"http://www.tpslean.com/glossary/cellmfgdef.htm\">U-shaped flow cells</a> in Lean manufacturing.</p> \n<p>Processing tasks in U-shaped cells can be very efficient, but not if the queue of tasks is overloaded. If more tasks are in progress than there are engineers to complete it, items will form queues waiting for attention. For example, say an engineer developing code is overloaded with new feature requests. A queue of feature requests will form. Further, it is likely that they will not be able to review code completed by their teammates, contributing to the formation of a second queue in the review stage. Either cycle time will rise or quality will suffer. Engineers need to switch roles to where queues are forming to push tasks through the queue.</p> \n<p>Analogously, overloaded teams with a high WIP to contributors ratio will be less capable of dealing with incoming bug fixes and ad-hoc requests.</p> \n<h4>The number of products in WIP</h4> \n<p>“Products in WIP” are products in progress. PDKP estimates the number of products in WIP by counting the number of issues in a Jira project that represent a product. For most teams, these are ‘Epic’ or ‘Story’ issues. Products can be either for internal or external users.</p> \n<p>Decreasing the number of products in WIP can decrease lead and cycle time. To illustrate, imagine we have two tasks each of which takes four days and can be shared between two engineers with no overhead. There are two schedules for this work shown below: either each engineer takes one task or they pair on the first, then the second.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/b766f1ac96e814c9391fd28fa8872d63/1da0e/two_engineers_two_tasks.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 26.837060702875398%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABRUlEQVQY0z2Q7UvCcBRG9/cXllqpqZWKSYGU1MdK0TICCXVuWr6kc3NzWa5mycQPp18L+nDguTwX7uFKjuOwXq9ZLBbM53M8z/OxLIun3oAPd4Hz6dJS2lj2DPfrm15/wMtI43vpYUzE3nOPd+fT7yRFUWi326KYYAq63R7O/A11OGX/skHuTid7O+bgqkv2zvDz4U2fTEUjV51wVOyTKg05Fnu5qoHkui6r1cq31PUxcqOBIez0ZotyIEwzdogcO6ARSdJJpGlGk9RFVhMZWvEUj3sJlHhakPJnSVVUOp0OmjZGG41QhbFtT3nqjsnl7zm7qJE/f+A0X6Ug8kmhRl0cmQU3MXe2GQY2MENbWOE/pN8fLpdLPGFp6Dqy3GJqGsjDGeGiSbRis1OaELrWiFWmbJVtqqk8r7tB9GiEQSiIEdn95wdcZVOFZN2nXQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"two engineers two tasks\" title=\"two engineers two tasks\" src=\"https://developers.soundcloud.com/blog/static/b766f1ac96e814c9391fd28fa8872d63/8ff1e/two_engineers_two_tasks.png\" srcset=\"/blog/static/b766f1ac96e814c9391fd28fa8872d63/9ec3c/two_engineers_two_tasks.png 200w,\n/blog/static/b766f1ac96e814c9391fd28fa8872d63/c7805/two_engineers_two_tasks.png 400w,\n/blog/static/b766f1ac96e814c9391fd28fa8872d63/8ff1e/two_engineers_two_tasks.png 800w,\n/blog/static/b766f1ac96e814c9391fd28fa8872d63/6ff5e/two_engineers_two_tasks.png 1200w,\n/blog/static/b766f1ac96e814c9391fd28fa8872d63/1da0e/two_engineers_two_tasks.png 1252w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  Scheduling two tasks for two engineers \n</div> \n<p>In Schedule 1, each engineer takes a single task, both products ship in four days. In Schedule 2, the first task is ready in two days and the second at four days. We’ve shipped the first product two days earlier without adding any work. Pairing adds some overhead, but getting information from shipping a product sooner is often worth it. These same principles apply to the planning phases of product development.</p> \n<h4>Inventory</h4> \n<p>In business, inventory is the components of a product that have not been assembled or manifested into a product ready for sale. In engineering, our inventory is anything we work on that results in a feature that is yet undelivered including undeployed code, RFCs, and unfinished Jira issues. PDKP estimates inventory with the number of commits or number of additions and deletions in pull requests in repositories that have been updated in the last three months.</p> \n<p>Increasing amounts of code inventory is a symptom of bad flow and has a negative effect on cycle time. The more inventory there is, the more development time has accumulated in work not being seen by our users. Generally, inventory depreciates in value as it ages.</p> \n<p>Ideally, we want to achieve what is called a “one piece flow,” a process where all code inventory is actively being worked on. This means that there should be at most one product in progress per team and one task in progress per engineer.</p> \n<p>The challenge in accomplishing one piece flow in software development is that code inventory is invisible. In a factory that produces physical goods, inventory is obvious, it stacks up on the factory floor. In a software company, it’s not so obvious.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/e73797046b8aa406329cb906069e466b/d9f6f/code_inventory_visualized.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 74.97326203208556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAEMElEQVQ4yx2TW0zTBxSH+2jM4jInmHgBlGtpgdLKTVplFoHBbKFQoNxrLVBKgd64WEpZsUIRB0xoYeqKgCyiQ2XMbDFsLht7cNniLtmyzZk4NSZ725Zsyfbw7Z89nNfvfL9zES2+0cf1t/wsj9qZ6qhiLWDjo9lBNsM+3p8d4s7lAFs3Z/jl/rv8/uQL/vnrKfz9hB+3Nhg9VY4mLxWzoYwpXxeTvh5ES+ed3I6MMTfUgUOjwlOtZqC6kMGGMjzNWjwnKxh1mIhMDLK+FGJ9cZY3PTbqi/KoKlIyPdLLavgskfEBJvosiK56NayFB7h+4TRecznzXhPXx9pYHrOwNtfH5++d44ev13n+/Dk/f/sVLqFJlToDZ3sNM2edjDhNOIxVQumJBN2IFlwFrIybWJ50M9JZzbirnq4aFZ2GQsJnu7m/uczjh1+yuhDCWq+hx2xg88YYy9M2/H2n6Okw0ufsYTzg49NlL6K5bhVLAvCdM20s2XTMmdQ0l2VhqX2FlbCHD9fCBH12DNqjtBt1uK1NglUjfkcdlRXlVOoqOdVqxWhx4O7tRTTTmc9lfz0fXBzmwZVx7trL2Ir0shHx8/HGRTzOFjw2PcOOJvrb9ATcZk5b9DjNFVyYmmRowElnu5nzoStcXr0jADuUhE/r2boV4o/H93l2wcJKsBWdEDs0asXdXsloIIDT4WDq3CiLkWvYjTV0txl49Ow3QqFZ+u02Prt5la3b1xCFLCpm+vV8cjXIvw9u8OdUMwNNxRyU7hGAvQx2NtLS0kx5qZrikmOYs3NwlSjRVRSTpsgjMUWKPCOdSbeJOwuziHwNeYSHGrgbNPO0KI7vahW8bnoVb+Nx4bacWOvKyc/LQJkjIzE+jsTYfejUhzDW60lOz2X/gSTkOQUUlWgp1egR2arymPPWsRG0cC9jH/eKJTgrsxk2HKHOVMvxMjVqZSYKWTKxsXuErVrwdRjQvlZCqiwfQ1EWCyM25vvqCPm7EHVW5jIvGC4OtfK2Oo5LWgk2YT5t9lZKGqtR1tZQUKFBmS0hVRKPy9RMl76Uo6rDiDMVGI4l0F+ejFefyry9FFGP7pBg2EDEb8X7qoyRxiKm54K4Js5QLAClxws51tnP0fxMDmdLkWUkkymTID0kxxqfwKWYnWiOxHAiZy91qhhEXVoF0+4abglf8es36zz76XtmQudo6rVScKKQlxMTkVefRKVUkJslJUchJVcuJS1HzsSuKFZf2Mb5uJ0EDr5EvZBQ1F6aznh3BQu+Fh5urvBoZgpblZa9gsWBNDFRSfHESNPISE8R7MQoMsXI0lIQpyZQHhNNdWwUi9u2M7F7B1UFsYhc2nQGjEUMt+sYaq3BbzFxJCuDF3dsZ1f0TqL3RP+/jDRpMnKZmCx5CumSg4gT9nMgaR9JyXsxxURRsD8KSeJu/gOR35qwQmhx1AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"code inventory visualized\" title=\"code inventory visualized\" src=\"https://developers.soundcloud.com/blog/static/e73797046b8aa406329cb906069e466b/8ff1e/code_inventory_visualized.png\" srcset=\"/blog/static/e73797046b8aa406329cb906069e466b/9ec3c/code_inventory_visualized.png 200w,\n/blog/static/e73797046b8aa406329cb906069e466b/c7805/code_inventory_visualized.png 400w,\n/blog/static/e73797046b8aa406329cb906069e466b/8ff1e/code_inventory_visualized.png 800w,\n/blog/static/e73797046b8aa406329cb906069e466b/d9f6f/code_inventory_visualized.png 935w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  Software inventory isn’t visible in the same way manufacturing inventory is. \n</div> \n<p>For this reason, we need to take measures to monitor code inventory and make sure it gets shipped in a timely manner.</p> \n<h4>The ratio of features to engineers</h4> \n<p>The ratio of features to engineers measures how many features each team member must maintain on average. We estimate it by dividing the number of configuration files indicating an individual feature in a team’s active repositories by the number of engineers active on a team’s Jira board.</p> \n<p>Higher ratios correlate with higher rates of bug reports and maintenance overhead. If a team has an abnormally high ratio, the company should consider providing them with more headcount or redistributing their responsibilities to get a more even distribution.</p> \n<h4>Bugs</h4> \n<p>Our exposure to bugs is estimated by the number of issues of issue type ‘Bug’ in a Jira project.</p> \n<p>Persistent bugs have a negative impact on lead and cycle time. Users and Community Support re-report the same bugs which then have to be reinvestigated before confirming they are duplicates. If engineers build on top of buggy code, the resultant implementation can be flawed, at worst resulting in wasted code that cannot stay in production. Most importantly, bugs make it harder for engineers to learn what is going wrong and to prevent future problems.</p> \n<h4>Lower bound on time to backlog completion</h4> \n<p>Multiplying a team’s cycle time by the number of products remaining in their backlog estimates a lower bound on how long it would take a team to complete their backlog.</p> \n<p>Having a large backlog has three negative effects. First, it increases our lead time. Planning too far in advance creates a queue of work that teams cannot work through quickly and takes development time away from line managers and engineers. Second, it decreases our flexibility in changing plans in the future. Once something is on the backlog, teams feel committed to deliver them. Third, it decreases motivation.</p> \n<h2>What did we do about it?</h2> \n<p>This section describes SoundCloud’s continuous learning and improvement cycle where its project managers collect flow metrics and apply analysis thereof in guidelines to improve product development flow.</p> \n<p>For the first set of guidelines, project managers used principles from manufacturing and queueing theory to encourage teams to work on fewer products at a time and engineers work on fewer tasks at a time.</p> \n<p><em>Importantly, the guidelines don’t suggest that teams work harder. They are intended to increase focus, not the total number of hours worked.</em></p> \n<h3>Metrics collection</h3> \n<p>Starting in March 2017, PDKP has collected lead time, cycle time, WIP, bugs, contributor, and code inventory metrics from SoundCloud’s Jira and GitHub organizations.</p> \n<p>To date, 18 engineering teams have configured the system to collect lead and cycle time metrics. Inventory metrics are collected for all development in SoundCloud’s GitHub organization.</p> \n<p>All metrics are aggregated and presented in the PDKP <a href=\"https://developers.soundcloud.com/blog/posts/pdkp_overview_dashboard.png\">dashboard</a> and <a href=\"https://developers.soundcloud.com/blog/posts/pdkp_summary_dashboard.png\">summary dashboard</a>.</p> \n<h3>Guidelines and motivating analysis</h3> \n<h4>1. The company should commit to fewer products at a time</h4> \n<p>SoundCloud can reduce cycle time and increase its flexibility in planning new products by reducing the number of products it commits to. Teams had high lower bounds on time to backlog completion, suggesting that overcommitment was a problem.</p> \n<p>Of the 18 teams in the PDKP metrics collection, the median lower bound on time to backlog completion is 766 days, or about 2.1 years. While this number could represent misuse of Jira, it suggested an opportunity to shift more time from planning future products to focusing on more immediate products.</p> \n<h4>2. Teams should work on fewer product features at a time</h4> \n<p>Provided the work can be parallelized, teams should work on one product at a time in order to maximize flow. The number of products teams had in progress was too high.</p> \n<p>Across the 18 teams sampled, PDKP reported the median number of products in progress at once is four. An in-person survey of teams in the Creators Organization reported a similar number.</p> \n<p>It is unlikely that there is enough downtime in the development of products that teams needed to have four in progress at any given time to be productive.</p> \n<h4>3. Engineers should work on fewer tasks at a time</h4> \n<p>In theory, engineers should work on one task at a time until it is completed to maximize flow. The ratio of tasks in WIP to engineers was too high.</p> \n<p>Across the 18 teams sampled, PDKP reported the average ratio of WIP to engineers was consistently over 2.0.</p> \n<p>Of course, it is not always practical to work on one thing at a time while developing software. For example, teams with long running batch jobs will have enough downtime while waiting for the job to finish to do meaningful work on other tasks. However, like teams with too many products, it is unlikely that the majority of teams with high ratios in the sample have this specific problem.</p> \n<p>Importantly, high engineer utilization is not a goal. One important result of queuing theory is that <a href=\"https://hbr.org/2012/05/six-myths-of-product-development\">not all nodes in the queue have to be fully utilized</a> to maximize the throughput of the queue overall. In fact, it’s good if our engineers have a little idle time.</p> \n<h4>4. Engineering should reduce its code inventory</h4> \n<p>SoundCloud has a high amount of code inventory. Reducing it is a big opportunity for us to improve these metrics.</p> \n<p>Over SoundCloud’s GitHub repositories updated in the last three months at the time of the first metrics collection, there have been between 1,200 to 1,500 commits in open pull requests representing 200,000 to 300,000 lines of code. The average age of this inventory was 65 days old. On average, teams have 22 commits in open pull requests. That’s a lot.</p> \n<p>Teams at SoundCloud have had success in increasing flow by decreasing inventory. The Content ID Team reduced its inventory over a period of two months, bringing the daily average number of commits in open PRs from 46 to less than 5 and the average age of those commits from 14 to less than 1 day. During this time, the team’s cycle time dropped from 12 days to 3 days.</p> \n<p>Given this <a href=\"https://en.wikipedia.org/wiki/Longitudinal_study\">longitudinal experimental design</a>, it’s only possible to show correlation—not causation—between reducing inventory and cycle time. However, the correlation is positive and suggests further effort on this front could help.</p> \n<p>Importantly, code review should not be rushed. Rather, it is better to carefully and thoroughly review code as it reaches the review stage promptly or use a continuous integration review process where merging code into the master branch is not blocked by code review.</p> \n<h4>5. Engineering should monitor and reduce the number of bugs over time</h4> \n<p>Monitoring and reducing the number of bugs in a team’s system has a positive impact on lead and cycle time. SoundCloud is currently implementing a standardized bug reporting process. This is another opportunity to speed up both development and the learning feedback cycle.</p> \n<h3>Guidelines for management</h3> \n<p>The number of products product management commits to at once caused teams to overload their product development queues. Engineering managers then overloaded engineers by accepting multiple products into WIP at once.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0ca86d617846e9b6982889164343f3b5/0b460/multitasking_propagation.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20.920502092050206%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAnUlEQVQY03VP2wrDIAz1/3+ya9FZi8No6VXqmQkE9rLAefDcEk1rDYx/8zwPiDKstYJpmrBtm2ia0w6G0aASx3EIUkq4rgv3faOUIp51XeGswxIWWfRbqmN4OwfY/IkRb+fgOobhhdnPUl5rlauISDS+MnYvZzifcxZ933eYEALGcRRCLyJK8r3UC87z7FyVsBbxAvayxpz3Xhbz+wuwazS+6vqPHgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"multitasking propagation\" title=\"multitasking propagation\" src=\"https://developers.soundcloud.com/blog/static/0ca86d617846e9b6982889164343f3b5/8ff1e/multitasking_propagation.png\" srcset=\"/blog/static/0ca86d617846e9b6982889164343f3b5/9ec3c/multitasking_propagation.png 200w,\n/blog/static/0ca86d617846e9b6982889164343f3b5/c7805/multitasking_propagation.png 400w,\n/blog/static/0ca86d617846e9b6982889164343f3b5/8ff1e/multitasking_propagation.png 800w,\n/blog/static/0ca86d617846e9b6982889164343f3b5/6ff5e/multitasking_propagation.png 1200w,\n/blog/static/0ca86d617846e9b6982889164343f3b5/0b460/multitasking_propagation.png 1434w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  Overloaded product queues propagate from product managers to project managers to engineers. \n</div> \n<p>Note that the propagation of queue overload can cause both the single engineer and multiple engineers scheduling problems.</p> \n<p>Product and engineering management must lead and support changes to the way we work in order to improve flow, especially since some of these practices have become habitual in the company. Accordingly, the following guidelines were given to product managers.</p> \n<p><strong>1. The company should commit to fewer products at a time</strong> - Ideally, teams and product leadership should agree on a limit for the number of products that can be in progress for each team.</p> \n<p><strong>2. Teams should work on fewer product features at a time</strong> - Product managers should prioritize one product at time, one feature at a time and encourage the teams to deliver likewise if possible.</p> \n<p>The following guidelines were given to engineering managers.</p> \n<p><strong>2. Teams should work on fewer product features at a time</strong> - Engineering managers should be conscious of pulling disparate product features onto the board at the same time. They should encourage the team to focus on a limited number of features at once, ideally one. They should encourage dividing work for a product feature into subtasks that can be shared in the team to enable that focus.</p> \n<p><strong>3. Engineers should work on fewer tasks at a time</strong> - Engineering managers should educate their teams about flow management and encourage them to focus on a task until it’s done, if possible.</p> \n<p><strong>4. Engineering should reduce its code inventory</strong> - Engineering managers should monitor their team’s code inventory and encourage them to keep it low.</p> \n<p><strong>5. Engineering should monitor and reduce the number of bugs over time</strong> - Engineering managers should monitor their team’s backlog of bugs and schedule them to be fixed.</p> \n<h3>Guidelines for teams</h3> \n<p>Teams were given the following guidelines.</p> \n<p><strong>3. Engineers should work on fewer tasks at a time</strong> - Engineers should learn the basics of flow management and try to focus on one feature at a time if possible.</p> \n<p><strong>4. Engineering should reduce its code inventory</strong> - Engineers should review code promptly once it hits the review stage and alert others when work is blocked.</p> \n<p><strong>5. Engineering should monitor and reduce the number of bugs over time</strong> - Engineers should fix bugs!</p> \n<h3>A tool for improving flow</h3> \n<p><a href=\"https://en.wikipedia.org/wiki/Visual_control\">Simple, visual controls</a> are provided as part of PDKP to help project managers improve their product development flow. These are presented on the PDKP Summary Dashboard, shown below.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/8906688cbf168a58b495068d43e3a767/1c938/pdkp_summary_dashboard.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.47895229186156%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACtklEQVQozyWP60uTYRiH3z+go2fb5qbvDu+7Q3Mepk5ztrRlmy5HQUVB6czcrKzIPBWVlBadKAiCvvilVhDkXFpJZYcvJlTfglJsWWgE/QtXT/PDxf27Lx547p+kKSpDLW4gGNxLoz+Mz7sd3QaTwIhWa6XG48dXF8AX2ImjtpkMUwVZOjNGl5fiSh9e/w6q/TtRS6rRmJxIBp+KLqhQEFCwhEqwhd0Yg07kRuEbLeibrBga7DTWONhdp9LiMRL2yIRqrDR7LOz3u9jX4CRYbqCl2oRUPGqk4WkVdWNl1D4pwTfmpn68grpEGd4nLmqeOnHdNfAqtpafPWuYP7WOhVNr+X7OKJCZP7kqzfeeFS8Z7tiofFhPbTxAVXwrnrgfzwM/7vv1VN8P4o43Y7rm4FEkm5muHN7EcngZ1TDV6+H5wGaedcniM63weWmkoXYdt45lc70ri5uCG8d1Aj03Yv9dLre78xlq1XJvTx5THbkk27IZb8slEdGQaNeSaMtfIaJNO+nL0Qz+iFOXBvQsX3Tx+1IJyxdUlkfcLA0W8LdnNR+j65kR7371r2FhxEnqsovUsJ3UiIPUkEzqSimp/vWkekXlR5FCJqN6El0WEt3FjJ1wMy7mxDGVZMzIpKg0esBAfG8BU20yE+02Xh4y8qLTRjJaSjJi40WHlWetMpMHC5GSrZm87cxkujOH6Y51vI5pmD6iXcmHM3kfy+DxviwmLCY+KVZmVJVZk4kPLhczpaV8sCjMms3MKmo6S7Pdecz15fNtuIK5K5uYF7XnRir4dtXL1+FKFvpyeBfdwGeHwp/ycn6GQiw2NZFqCbO4axe/wmF+hHawWFnFksOO1L2tiN6gTG/AQF+gkP6AXkyD2Is4LehvkoluKeKEWeG8xc5Zi5VBxcGA4IzZJnZbOg8qGwV2/gEUKqUhO6otbgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"pdkp summary dashboard\" title=\"pdkp summary dashboard\" src=\"https://developers.soundcloud.com/blog/static/8906688cbf168a58b495068d43e3a767/8ff1e/pdkp_summary_dashboard.png\" srcset=\"/blog/static/8906688cbf168a58b495068d43e3a767/9ec3c/pdkp_summary_dashboard.png 200w,\n/blog/static/8906688cbf168a58b495068d43e3a767/c7805/pdkp_summary_dashboard.png 400w,\n/blog/static/8906688cbf168a58b495068d43e3a767/8ff1e/pdkp_summary_dashboard.png 800w,\n/blog/static/8906688cbf168a58b495068d43e3a767/1c938/pdkp_summary_dashboard.png 1069w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  The PDKP Summary Dashboard. \n</div> \n<p>The metrics below are displayed on the board.</p> \n<ul> \n <li>Lead time</li> \n <li>Cycle time</li> \n <li>Ratio of features to engineers</li> \n</ul> \n<p>A second set of metrics, shown below, is paired with colors to suggest specific actions. Green means the team’s performance against the metric is good, yellow means performance against the metric is likely OK, red means the metric should be brought down to promote flow.</p> \n<ul> \n <li>The estimated lower bound of days until backlog completion</li> \n <li>The number of unresolved bugs in the team’s backlog</li> \n <li>The number of products in WIP</li> \n <li>The ratio of WIP to engineers</li> \n <li>The number of commits in open PRs</li> \n <li>The average age of code in open PRs</li> \n</ul> \n<p>The motivations for optimizing these metrics was discussed in a previous section.</p> \n<p>The actions suggested by the action colors on the Summary Dashboard will not always be appropriate in your day-to-day work. Sometimes they will be wrong. However, simply asking questions about your workflow when a metric lights up red will likely improve your product development flow.</p> \n<p><em>Importantly, actions never suggest that a team isn’t working hard enough. They are intended to increase focus, not the total number of hours worked.</em></p> \n<h2>Preliminary results</h2> \n<p>Since the addition of the last teams to the PDKP project on June 23rd, 2017, SoundCloud has seen a reported 39% decrease in the average lead time from a mean of 106.4 days to 64.7 days and a 52% decrease in average cycle time from a mean of 77.8 days to 37.2 days.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/a043f1ce1cca7c3accfd1acce356c867/4b160/lead_time.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 26.46370023419204%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAzklEQVQY02WQWW7DMAxEfY7GIrVbku3aiYs0QdL7H2tKeUlR5ONhpCExotg4Y1BhpaCJXrCi3VM4TxMu8/zW879fasxovHNIIYBaBSIGSVDFSdFrRtsSTh+nlaNWYXqnBjfjMGLJHtfEOHcaF2HpGPei8ejlHjW+0sYcGJMwOEbQhGhIHqX1XNXWCa18d+njGvhdzEY2uAq33uJeKZveyp/3GDaeu/6MDoPXEihjfpaMMSf0KaCkDiV3iN4hOAu/7zjKag6tHL639uUbrfELjRmOFfu2OPwAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"lead time\" title=\"lead time\" src=\"https://developers.soundcloud.com/blog/static/a043f1ce1cca7c3accfd1acce356c867/8ff1e/lead_time.png\" srcset=\"/blog/static/a043f1ce1cca7c3accfd1acce356c867/9ec3c/lead_time.png 200w,\n/blog/static/a043f1ce1cca7c3accfd1acce356c867/c7805/lead_time.png 400w,\n/blog/static/a043f1ce1cca7c3accfd1acce356c867/8ff1e/lead_time.png 800w,\n/blog/static/a043f1ce1cca7c3accfd1acce356c867/4b160/lead_time.png 854w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  Aggregate lead time metrics since June 23rd, 2017. \n</div> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/12ad0764bf4bbe223d41b436ddfba418/4b160/cycle_time.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 26.229508196721312%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA10lEQVQY022Qa27DIBCEfZDAPsCYh9s4aZs4Se9/relCq6qV8uPTzgxol2UKIhAWuIMDOQ/vHJzhf/HYjtug+36H/TMcmAiTMuNUIqp6BCYkIZRAOC2MaxFktYwdgj+McyU/hjyDrPG01oa3EvDZGPcmuFcePMzvpTdl3KqYl6EvmXBOhJdI2H7qGr9rf8yktvK5pnHpPcs/Pooaf7TVS1XcmuJqdbdBe+1aRlYDW0Nb4VgLXmvGWhJazmhlwTJHpBAwqwyWGBFteIphEC3rflYdumf9+74Ah96PEofeUTAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"cycle time\" title=\"cycle time\" src=\"https://developers.soundcloud.com/blog/static/12ad0764bf4bbe223d41b436ddfba418/8ff1e/cycle_time.png\" srcset=\"/blog/static/12ad0764bf4bbe223d41b436ddfba418/9ec3c/cycle_time.png 200w,\n/blog/static/12ad0764bf4bbe223d41b436ddfba418/c7805/cycle_time.png 400w,\n/blog/static/12ad0764bf4bbe223d41b436ddfba418/8ff1e/cycle_time.png 800w,\n/blog/static/12ad0764bf4bbe223d41b436ddfba418/4b160/cycle_time.png 854w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  Aggregate cycle time metrics since June 23rd, 2017. \n</div> \n<p>This decrease is correlated with product and engineering leadership successfully decreasing the average number of products SoundCloud’s teams have in WIP from an average of 7.4 products per team to 3.1 products per team.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/35c55e88dd9e42b3a19ade9557142471/4b160/products_in_wip.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 29.156908665105384%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAA90lEQVQY02WRWXKEMAxEOUfAWLJZzJCwmllSSVUq979TR7In5CMfr1pCcreBorEGDdVwNlObjDUGjhhHjLgK6zSD6vof9qwNmAjF1xvh85VxGwjXQEk7zosaVFclypdKKMEp0JyhasSCqXLPVgxjbxF7wiFmWt8vjO+J8RC9Xwjvo9wyMOIzTNn6rDpXdLZ0Vt5IDG/Bppsph9S7mH6MlNAAPfjQw4Pu2aS5fwaE3Ku2TgyXjjC3hLVjaL0PXpSxia49Cw5byM/2ofnrz5lLugiOLIqx9YjLhFlovIdjlm9h4Z0Diep38Zzrxrn0o353dJZq0h1OOz+mV6ybNZiJ2AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"products in wip\" title=\"products in wip\" src=\"https://developers.soundcloud.com/blog/static/35c55e88dd9e42b3a19ade9557142471/8ff1e/products_in_wip.png\" srcset=\"/blog/static/35c55e88dd9e42b3a19ade9557142471/9ec3c/products_in_wip.png 200w,\n/blog/static/35c55e88dd9e42b3a19ade9557142471/c7805/products_in_wip.png 400w,\n/blog/static/35c55e88dd9e42b3a19ade9557142471/8ff1e/products_in_wip.png 800w,\n/blog/static/35c55e88dd9e42b3a19ade9557142471/4b160/products_in_wip.png 854w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  Aggregate metrics of the number of products in WIP decreasing since June 23rd, 2017. \n</div> \n<p>More recently, engineering managers and engineering teams successfully reduced our code inventory from a rolling average of about 1,200 commits to about 500 commits. It is likely that we have not yet seen the full benefits of this reduction reflected in our lead and cycle times.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/c031a6e6e484c9c502afa42b5758b239/b5f89/code_inventory_total.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 26.260257913247358%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABQElEQVQY0yWQ2U7CYBSEeQ3pRiHG0IotVZBFwEKlZSmEvUAtoAY18cYbX//zBy4mc3EmX85M6jqXI6vryJKMlE6jyhIZVUFVFG5NA9u2sC0Lp2hz7zhYhQLpqyt0NYMs8prIZVT14ppGSpEkbMPEr9dplWuYN6Y4auQ0Hce0eC4/US0+UrHKdGou/ecuQzdgHoyolSvo2gV8gp6Uyufz+I0Wx3nEazhm2esSui7LYEA8HnGYheynEw7zrfAZH4spR6HdODx7z21SMAwUWRGPCGA2m2HYGfL7/kc8jdkK8G6+4m2x5RglHNcJn5uI99WYn33MdxJzWM34ijd8LhM+1juSKGI06J2nSUlij+pDlbDTo9/2eGl28Z48uq1TNZ++qDfwfKEXgrZPoxFQrQeUSh73pTbNmkcgZpj0Jzh3Rf4BKQCrZF22kQkAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"code inventory total\" title=\"code inventory total\" src=\"https://developers.soundcloud.com/blog/static/c031a6e6e484c9c502afa42b5758b239/8ff1e/code_inventory_total.png\" srcset=\"/blog/static/c031a6e6e484c9c502afa42b5758b239/9ec3c/code_inventory_total.png 200w,\n/blog/static/c031a6e6e484c9c502afa42b5758b239/c7805/code_inventory_total.png 400w,\n/blog/static/c031a6e6e484c9c502afa42b5758b239/8ff1e/code_inventory_total.png 800w,\n/blog/static/c031a6e6e484c9c502afa42b5758b239/b5f89/code_inventory_total.png 853w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<div align=\"center\">\n  A recent decrease in code inventory. \n</div> \n<p>It is possible that much of the improvement in our measured lead and cycle times is due to cleanup and better use of our Jira. Tickets in Jira now better represent what is actually happening in reality. If this is true, at least we are getting a better understanding of what the true numbers are.</p> \n<h3>Future improvements</h3> \n<p>SoundCloud still has a great deal of room left to improve its product development flow. Specifically, the number of products teams work on at a time, the number of issues engineers work on at a time, and its amount of code inventory needs to be further reduced.</p> \n<p>The number of products teams are working on at a time has successfully been reduced, but should be reduced further. Teams still work on an average of 4.5 products at a time. While it does not always make sense for a whole team to work on one product simultaneously, having the average be just slightly below the average number of engineers per team (about five), suggests there is room for improvement.</p> \n<p>The number of tasks that engineers have in WIP has not improved and should be reduced. Since June 23rd, 2017, it has remained at an average of about 2.0 per engineer. Bringing this number closer to 1.0 would likely decrease our lead and cycle times.</p> \n<p>SoundCloud’s amount of code inventory also remains a problem. Further reducing this number represents another big opportunity to reduce our lead and cycle times.</p> \n<p>This said, we’ve improved our product development flow a great deal. We’re excited to learn more about our development cycle and to make future improvements.</p>","descriptionType":"html","publishedDate":"Wed, 27 Sep 2017 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/c6f5381bbfbad6246acf19130fa69aec/8ff1e/artem_engineering_town_hall.png","linkMd5":"db81c33aaeff94ca6ea252b6b8e18666","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn25@2020_5/2020/08/25/00-49-37-947_bc03cfc755b45670.webp","destWidth":800,"destHeight":447,"sourceBytes":75166,"destBytes":24408,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/c6f5381bbfbad6246acf19130fa69aec/8ff1e/artem_engineering_town_hall.png":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn25@2020_5/2020/08/25/00-49-37-947_bc03cfc755b45670.webp","https://developers.soundcloud.com/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/8ff1e/one_engineer_two_tasks_schedule.png":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn3@2020_5/2020/08/25/00-51-44-977_d840467bb754b4cb.webp","https://developers.soundcloud.com/blog/static/7588d21a9431e8685dab8c4030a439f2/8ff1e/u_shaped_flow_cell.png":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn57@2020_6/2020/08/25/00-51-45-528_a2b565631797656a.webp","https://developers.soundcloud.com/blog/static/b766f1ac96e814c9391fd28fa8872d63/8ff1e/two_engineers_two_tasks.png":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn84@2020_5/2020/08/25/00-51-43-879_a29b8e8e15a36265.webp","https://developers.soundcloud.com/blog/static/e73797046b8aa406329cb906069e466b/8ff1e/code_inventory_visualized.png":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn76@2020_5/2020/08/25/00-51-40-452_eeac489b0b412eaf.webp","https://developers.soundcloud.com/blog/static/0ca86d617846e9b6982889164343f3b5/8ff1e/multitasking_propagation.png":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn69@2020_5/2020/08/25/00-51-45-200_ecb05171c21ad4d5.webp","https://developers.soundcloud.com/blog/static/8906688cbf168a58b495068d43e3a767/8ff1e/pdkp_summary_dashboard.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn70@2020_2/2020/08/25/00-51-41-386_41a26592774c1d26.webp","https://developers.soundcloud.com/blog/static/a043f1ce1cca7c3accfd1acce356c867/8ff1e/lead_time.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn23@2020_4/2020/08/25/00-51-44-293_876ae8481b53a415.webp","https://developers.soundcloud.com/blog/static/12ad0764bf4bbe223d41b436ddfba418/8ff1e/cycle_time.png":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn65@2020_5/2020/08/25/00-51-45-303_19a47166d933f6d1.webp","https://developers.soundcloud.com/blog/static/35c55e88dd9e42b3a19ade9557142471/8ff1e/products_in_wip.png":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn49@2020_6/2020/08/25/00-51-43-750_4853ddbace9a3abf.webp","https://developers.soundcloud.com/blog/static/c031a6e6e484c9c502afa42b5758b239/8ff1e/code_inventory_total.png":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn54@2020_4/2020/08/25/00-51-46-090_0914e0702656f4cf.webp"},"publishedOrCreatedDate":1598316569976},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"The Next App Gallery Update","link":"https://developers.soundcloud.com/blog/the-next-app-gallery-update","description":"<p>We’re making some changes to how we manage our <a href=\"https://soundcloud.com/apps\">App Gallery</a> and wanted to take some time to explain them to you, our developer community.</p> \n<p>The App Gallery is where we highlight interesting and useful SoundCloud powered apps and services for our users. As our developer community continues to grow, it’s even more important that we keep a high bar for apps found in App Gallery. Having a high standard protects the value of being featured in App Gallery for all of our developers while giving our users a sense of confidence in the caliber of content we’re showcasing there.</p> \n<p>When evaluating a newly submitted app for App Gallery, we consider the following:</p> \n<ul> \n <li>Is the app both high quality and adhering to our <a href=\"https://developers.soundcloud.com/docs/api/terms-of-use\">API Terms of Use</a>?</li> \n <li>Does it enable new and valuable experiences for SoundCloud users?</li> \n <li>Has it shown notable traction in gaining connected users?</li> \n</ul> \n<p>Moving forward, we’ll be proactively reaching out to folks who meet this criteria about adding their apps to App Gallery instead of accepting mass submissions like we have in the past. Our long term hope is to completely rebuild App Gallery to work in conjunction with <a href=\"https://next.soundcloud.com\">Next SoundCloud</a> in a way that better serves our entire developer community. That includes ideas like better attribution of content within SoundCloud products and easier, relevant discovery within App Gallery for SoundCloud users.</p> \n<p>If you’re confident your app meets our criteria and we haven’t gotten in touch with you, feel free to drop us a line at <a href=\"mailto:api@soundcloud.com\">api@soundcloud.com</a>.</p>","descriptionType":"html","publishedDate":"Tue, 18 Sep 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"2e19fcb5190ceb2f7c5004842aaf49d6","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Moving API Support to Stack Overflow","link":"https://developers.soundcloud.com/blog/moving-api-support-to-stack-overflow","description":"<p>The SoundCloud Developer Community has grown immensely. We have over ten thousand registered applications and over three hundred showcased in our <a href=\"https://soundcloud.com/apps\">App Gallery</a>. Our goal as the Platform Team is to provide the best API tools possible, while also providing support and inspiration. So far, our primary channels have been this blog, our <a href=\"https://twitter.com/soundclouddev\">Twitter account</a>, and our <a href=\"https://groups.google.com/group/soundcloudapi\">mailing list</a>, hosted on Google Groups.</p> \n<p>In the coming months, you can expect some changes as we retool to accommodate the growth of our developer community. We are revisiting everything and doubling down on our efforts to provide the best, most accessible platform possible for building amazing applications that use sound in exciting new ways on the web.</p> \n<!-- more --> \n<p>Our first major change is that starting today, we are moving our primary support channel from the mailing list to <a href=\"http://stackoverflow.com/questions/tagged/soundcloud\">Stack Overflow</a>. Stack Overflow is a hugely popular Q&amp;A site, powered by <a href=\"http://stackexchange.com/\">Stack Exchange</a>. Developers from all communities have been using Stack Overflow to support each other and provide guidance on a great variety of programming topics.</p> \n<p>We encourage you to start using the <a href=\"http://stackoverflow.com/questions/tagged/soundcloud\">‘soundcloud’ tag</a> on Stack Overflow from now on for all questions related to the SoundCloud Platform. You can set up email notifications for new questions that show up with our tag, or you can subscribe to an <a href=\"http://stackoverflow.com/feeds/tag/soundcloud\">RSS feed</a>. We are monitoring questions, and will chime in when we can be of assistance. Our hope is that, using this new format, we will be able to build up a knowledge base, and will be able to take advantage of the expertise of our platform users as well as members of the broader programming community.</p> \n<p>On April 2nd, we will be turning the Google Group into a announcement only list. You can stay subscribed and expect regular updates on new features to the platform. Our team will continue to be active on the mailing list during the transition phase.</p> \n<p>See you all on Stack Overflow!</p>","descriptionType":"html","publishedDate":"Wed, 07 Mar 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"5b95bd49f7ca88694f7bddf10c8592c3","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Berlin Geekettes All-Women Hackathon Roundup","link":"https://developers.soundcloud.com/blog/berlin-geekettes-hackathon-roundup","description":"<p>Late last year, six women crowded in to a Mitte cafe booth and listened to Berlin Geekettes founder Jess Erickson share her idea: Berlin’s first all-women hackathon. With SoundCloud’s Amelie Anglade the then newly-appointed the Berlin Geekettes Tech Ambassador, we agreed that it was a great idea to produce the hackathon as a partnership between the Geekettes and the women developers of SoundCloud.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/48a11/bghack.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQGAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/2gAMAwEAAhADEAAAAXt8ZbKqMlBP/8QAGxAAAgIDAQAAAAAAAAAAAAAAAQMAAhITMUL/2gAIAQEAAQUCo1ZAdTbmuUIE9nv/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwFH/8QAHBAAAQMFAAAAAAAAAAAAAAAAAAERMRASMkGh/9oACAEBAAY/ApYsMkI6O+qf/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARITFBYf/aAAgBAQABPyG0aHRim3wRizmP2XKK426T1G8NT//aAAwDAQACAAMAAAAQHD//xAAVEQEBAAAAAAAAAAAAAAAAAAARAP/aAAgBAwEBPxAZv//EABYRAQEBAAAAAAAAAAAAAAAAAAAhAf/aAAgBAgEBPxDIt//EABsQAQACAwEBAAAAAAAAAAAAAAEAESExYXFB/9oACAEBAAE/EGBCkFmj75CSCFdN3Zyis9iQdo9Q65Crtn00wAigjOjNHhEpXgZ//9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Duana discussing APIs\" title=\"Duana discussing APIs\" src=\"https://developers.soundcloud.com/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/48a11/bghack.jpg\" srcset=\"/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/f544b/bghack.jpg 200w,\n/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/41689/bghack.jpg 400w,\n/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/48a11/bghack.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<p>Fast forward to the first weekend of March, when the vision became reality: after 24 hours of hacking, 80 women demoed 29 projects across a range of different platforms, from a belt transformed into a game controller to an app aimed to help toddlers learn to do everyday tasks.</p> \n<!-- more --> \n<h2>Hackathon with a twist</h2> \n<p>This hackathon invited all types of projects: web, iOS, Android, hardware, and so on. And the hackers rose to the challenge. One women even turned her belt into a game controller, and demo’d it by standing on a chair and playing Tetris by tapping her fingers on what she dubbed <a href=\"https://www.hackerleague.org/hackathons/berlin-geekettes-hackathon/hacks/wonderbelt\">The WonderBelt</a>.</p> \n<p>Achievement of a strong collaborative energy was an important part of what we set out to do. With over 120 applications, we accepted as many women as we could possibly fit into the generous space provided free of charge by Deutsche Telekom, complete with internet infrastructure and an onsite technician. In addition to API representatives, we asked attendees to identify themselves as ”domain experts” if they were willing to offer help and answer questions. We wanted to make the event also appealing to new programmers, as well as non-programmers such as designers and people with product ideas. We partnered with <a href=\"http://www.opentechschool.org/\">OpenTech School</a> to host a prep-school training session beforehand, with a presentation by SoundCloud’s very own Duana Stanley. The result? A wide range of women with different backgrounds and experience levels working together.</p> \n<p>And the Berlin Geekettes wanted to create a fun, healthy atmosphere, which is why we had a yoga teacher leading relaxation exercise classes and fresh organic meals (shout out to the amazing chefs!). Etsy joined the fun by providing a craft corner with instructions and materials for making plush birds. Many hackers took a break for a mental refresh, with stretching and stitching.</p> \n<h2>Lots of actually working demos!</h2> \n<p>We got the usual API mash-ups, such as <a href=\"https://www.hackerleague.org/hackathons/berlin-geekettes-hackathon/hacks/homethingy\">HomeThingy</a> which suggests apartments on ImmobilienScout24 based on your Etsy purchase history, <a href=\"https://www.hackerleague.org/hackathons/berlin-geekettes-hackathon/hacks/eye-moo\">Eye-MOO</a> which sends your EyeEM photos to be printed as postcards, and <a href=\"https://www.hackerleague.org/hackathons/berlin-geekettes-hackathon/hacks/mood-swings\">Mood Swings</a> which serves music from SoundCloud and images from Tumblr to suit your mood.</p> \n<p>There were not one but <em>three</em> mash-ups using the SoundCloud and Readmill APIs, combining books and sounds in various ways: <a href=\"https://www.hackerleague.org/hackathons/berlin-geekettes-hackathon/hacks/soundmill\">Soundmill</a> (share highlights from your SoundCloud audiobooks!), <a href=\"https://www.hackerleague.org/hackathons/berlin-geekettes-hackathon/hacks/bookbeat\">BOOKBEAT</a> (which also one the Best Student Project prize), and our staff pick <a href=\"https://www.hackerleague.org/hackathons/berlin-geekettes-hackathon/hacks/getup-readup\">GetUp-ReadUp</a> (a noisy alarm clock that uses book trivia to make you feel alert).</p> \n<p>More than one team built apps aimed at small children, including the overall winner: <a href=\"https://www.hackerleague.org/hackathons/berlin-geekettes-hackathon/hacks/monkey-see-monkey-do\">Monkey See, Monkey Do</a> helps your toddler understand daily routines using simple pictures. The team included an illustrator who made adorable drawings of a monkey brushing its teeth, having a snack, and other toddler activities.</p> \n<h2>More, please</h2> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/e84b60c281b7908661ad607382572430/48a11/bghack2.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAZABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgUD/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAG9efPOmzNIWmdBlzQB/8QAHBAAAwACAwEAAAAAAAAAAAAAAQIDABETIjFC/9oACAEBAAEFAmtnO6lbWYSuoF6EBbLoNrOzYkdj6Huf/8QAFhEAAwAAAAAAAAAAAAAAAAAAABAh/9oACAEDAQE/ASP/xAAXEQEAAwAAAAAAAAAAAAAAAAAAEBEh/9oACAECAQE/AWxb/8QAIBAAAgEDBAMAAAAAAAAAAAAAAAERAhAhEjJBcSKBsf/aAAgBAQAGPwLf6N04JUEVUuecGn4eVLb7HPKtkpF1b//EABwQAQACAgMBAAAAAAAAAAAAAAEAESExEEFhof/aAAgBAQABPyG0EFrt1HTc1EpBXqUGFtWvJfXeRFQp9sUjndilYm1qEjfcfmch/9oADAMBAAIAAwAAABCI/YD/xAAZEQACAwEAAAAAAAAAAAAAAAABIQAQEUH/2gAIAQMBAT8QAW8oGpgn/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEREEH/2gAIAQIBAT8Q7MNwo//EAB8QAQACAgICAwAAAAAAAAAAAAERIQAxQVEQcWGhsf/aAAgBAQABPxCRtuEN+yqxDI2CUlCVZ3WOmGooHVb9zkaP0Ih+Wj3jSEADLDYm4hwK3NgA4A4DOfnuzHWOgIJNsFEZDwZBxXjf0H7hn//Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Celebrating Hackers\" title=\"Celebrating Hackers\" src=\"https://developers.soundcloud.com/blog/static/e84b60c281b7908661ad607382572430/48a11/bghack2.jpg\" srcset=\"/blog/static/e84b60c281b7908661ad607382572430/f544b/bghack2.jpg 200w,\n/blog/static/e84b60c281b7908661ad607382572430/41689/bghack2.jpg 400w,\n/blog/static/e84b60c281b7908661ad607382572430/48a11/bghack2.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<p>Dive in to the whole list of projects <a href=\"https://www.hackerleague.org/hackathons/berlin-geekettes-hackathon/hacks\">list of submitted projects</a> on the hackathon’s official wiki. We were blown away by the quality of the presentations from so many first-time hackathon-attendees!</p>","descriptionType":"html","publishedDate":"Thu, 25 Apr 2013 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/48a11/bghack.jpg","linkMd5":"bffd0786bb86e91b1a565ded47ffa5b8","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn14@2020_3/2020/08/25/00-49-38-808_f71cb5a8762def5f.webp","destWidth":500,"destHeight":334,"sourceBytes":20249,"destBytes":26638,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/48a11/bghack.jpg":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn14@2020_3/2020/08/25/00-49-38-808_f71cb5a8762def5f.webp","https://developers.soundcloud.com/blog/static/e84b60c281b7908661ad607382572430/48a11/bghack2.jpg":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn36@2020_2/2020/08/25/00-51-44-118_00eb232b8d03112d.webp"},"publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Automatic Stubbing of Network Requests to Deflakify Automation Testing","link":"https://developers.soundcloud.com/blog/automatic-stubbing-of-network-requests-to-de-flakify-automation-testing","description":"<p>Apple introduced <a href=\"https://developer.apple.com/library/content/documentation/DeveloperTools/Conceptual/testing_with_xcode/chapters/09-ui_testing.html\">automated UI testing</a> in Xcode 7. This was a great addition for developers because this native support promised, among other things, an improvement in the flakiness notoriously associated with automation tests. As many of us developers have experienced, tests can sometimes fail even when there has been no modification to the test or underlying feature code.</p> \n<!-- more --> \n<p>Flakiness can often come from external factors. One such source of flakiness is <em>live data</em>, e.g. data loaded from a web service API. Data from the web service often drives the state of the UI. A test might assume the UI is in a certain state, e.g. the like button shows as “liked” or that a playlist has 10 songs. But when the data from the web service changes, the test fails.</p> \n<p>Such occurrences are relatively common, and there are many other scenarios, such as network connectivity issues, in which these false negatives can occur. In these situations, the functionality of the app is not broken; it’s just that our assumptions about the data are no longer valid. What’s more, debugging the cause of these failures can be a time-consuming affair.</p> \n<p>In this blog post, I’ll discuss how we at SoundCloud implemented a simple system for automatically recording and replaying the network responses that occur during the course of an Xcode UI automation test in order to remove any flakiness that may be introduced from the existence of live data coming from a web service.</p> \n<p>It should be noted that third-party options such as <a href=\"https://github.com/venmo/DVR\">DVR</a> provide similar functionality. However, given that automatic stubbing of network requests can be achieved with a handful of classes and extensions, this post aims to showcase a lightweight approach that doesn’t require adding yet another dependency to your project.</p> \n<p>An example project showcasing the approach taken can be found <a href=\"https://github.com/remover/NetworkStubbingBlog/tree/master\">here</a>. Open <code class=\"language-text\">ArtistsFeature.swift</code> for instructions.</p> \n<h2>Overview</h2> \n<p>The first step is to create an <code class=\"language-text\">AutomationTestURLSession</code> object that is capable of stubbing the app’s network responses with the contents of a JSON file, since this is the data format we expect from our web service.</p> \n<p>The next step is to inject this session whenever tests are running.</p> \n<p>Finally, we will implement a system for automatically recording and replaying network responses in order to create an easy-to-use API.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/eeafeb4fdbe62b6686721e1ebf068086/f570d/dob-network-stubbing-start.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAB2klEQVQ4y4VT226bQBDl//+jT+1bpVbqQ5S+JL0krtxWqp02GAMxBmNjLmuWZeF0Z/ESTFA70jILczg7c2bWatsWZFJKlGWJLMu055zDxIwf7oUQyPNcr6Zp+phlNowxHQzDUBOOgd3mktC2bY03GE04zLBSIAKuXRe+718ADVm3OjxV47oeomj3MkNjTS3QyvqZrNtMlo+2wYkVEBV/JjSAohTwdjmcbQIvShEc2EXJ7YA0YxxulMEJDlhvjwiPpx7bE24ThuufAd5//o0P9yvcLCKIWmJoBuvHBd7eLvHq3Q1eX33D7XILOSY8cYFInbSJVXb7HHFaojnHKiHhqIy46KRghFVxP0yw2aXYZwrbdNiXGir9Kl4qeaRqUIW8KHC33ODN9XfcPQRIVSNkXet4reLkzQhcaGg0Ii2o2+SpkzROwT7Dl8UGQZypJjD1vTkvRUrkg3GyxvqQJ+DYOK90V8eaGuw/CbtTKVuJx+CI+fqI2Z9Q+1WYqljTV0PY/xLSqV05Agv/gK92go9zR/uHp0RpKPpyx7fJmhqLodEPvBIo2KnXdmzD/yYzNNeLHqsww2yV4NOvJ8ycRL/jHG8nbpCFCesJ1Sh4cY4fXoK5HWlP792ITFf0F9yIkWM4PmEgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Network stubbing overview\" title=\"Network stubbing overview\" src=\"https://developers.soundcloud.com/blog/static/eeafeb4fdbe62b6686721e1ebf068086/8ff1e/dob-network-stubbing-start.png\" srcset=\"/blog/static/eeafeb4fdbe62b6686721e1ebf068086/9ec3c/dob-network-stubbing-start.png 200w,\n/blog/static/eeafeb4fdbe62b6686721e1ebf068086/c7805/dob-network-stubbing-start.png 400w,\n/blog/static/eeafeb4fdbe62b6686721e1ebf068086/8ff1e/dob-network-stubbing-start.png 800w,\n/blog/static/eeafeb4fdbe62b6686721e1ebf068086/f570d/dob-network-stubbing-start.png 960w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>The figure above shows how an <code class=\"language-text\">AutomationTestURLSession</code> is injected into the app in order to stub network responses using JSON files.</p> \n<h2>Session Stubbing</h2> \n<p>Let’s say we have a <code class=\"language-text\">Client</code> object our app uses to make all network requests. A simplified version might look like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Client</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> session<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSession</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSession</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>session <span class=\"token operator\">=</span> session\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">makeRequest</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">,</span> completion<span class=\"token punctuation\">:</span> @escaping <span class=\"token punctuation\">(</span><span class=\"token builtin\">Data</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">URLSessionDataTask</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> task <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">dataTask</span><span class=\"token punctuation\">(</span>with<span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">,</span> error <span class=\"token keyword\">in</span>\n            <span class=\"token comment\">// ...</span>\n        <span class=\"token punctuation\">}</span>\n        task<span class=\"token punctuation\">.</span><span class=\"token function\">resume</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> task\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>In order to replace/stub network responses with the contents of JSON files on disk, what we do is replace the app’s <code class=\"language-text\">URLSession</code> with our own <code class=\"language-text\">AutomationTestsURLSession</code> when tests are running. The <code class=\"language-text\">AutomationTestsURLSession</code> will then be responsible for stubbing the responses. To facilitate this, we start with a couple of protocols that our <code class=\"language-text\">Client</code>’s <code class=\"language-text\">URLSession</code> will conform to:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">protocol</span> <span class=\"token builtin\">URLSessionManaging</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">class</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">dataTaskFromRequest</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">,</span> completionHandler<span class=\"token punctuation\">:</span> @escaping <span class=\"token punctuation\">(</span><span class=\"token builtin\">Data</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">URLResponse</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">URLSessionDataTasking</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">protocol</span> <span class=\"token builtin\">URLSessionDataTasking</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">class</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">resume</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">suspend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>With these protocols in place, we can easily make <code class=\"language-text\">URLSession</code> and <code class=\"language-text\">URLSessionDataTask</code> conform to it:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">extension</span> <span class=\"token builtin\">URLSession</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSessionManaging</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">dataTaskFromRequest</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">,</span> completionHandler<span class=\"token punctuation\">:</span> @escaping <span class=\"token punctuation\">(</span><span class=\"token builtin\">Data</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">URLResponse</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">URLSessionDataTasking</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">dataTask</span><span class=\"token punctuation\">(</span>with<span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">,</span> completionHandler<span class=\"token punctuation\">:</span> completionHandler<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">URLSessionDataTasking</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">extension</span> <span class=\"token builtin\">URLSessionDataTask</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSessionDataTasking</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Now that we have <code class=\"language-text\">URLSession</code> and <code class=\"language-text\">URLSessionDataTask</code> conforming to our protocols, we can depend on the protocols from the <code class=\"language-text\">Client</code> instead of the concrete object types:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Client</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> session<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSessionManaging</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSessionManaging</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">URLSession</span><span class=\"token punctuation\">.</span>shared<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>session <span class=\"token operator\">=</span> session\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">makeRequest</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">,</span> completion<span class=\"token punctuation\">:</span> @escaping <span class=\"token punctuation\">(</span><span class=\"token builtin\">Result</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">URLSessionDataTasking</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> task <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">dataTaskFromRequest</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">,</span> error <span class=\"token keyword\">in</span>\n\t\t\t<span class=\"token comment\">//...</span>\n        <span class=\"token punctuation\">}</span>\n        task<span class=\"token punctuation\">.</span><span class=\"token function\">resume</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> task\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Now we can create our <code class=\"language-text\">AutomationTestsURLSession</code> to stub network responses with the contents of JSON files by making it conform to the same <code class=\"language-text\">URLSessionManaging</code> protocol:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">AutomationTestsURLSession</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSessionManaging</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">dataTaskFromRequest</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">,</span> completionHandler<span class=\"token punctuation\">:</span> @escaping <span class=\"token punctuation\">(</span><span class=\"token builtin\">Data</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">URLResponse</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">URLSessionDataTasking</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">AutomationTestsDataTask</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">.</span>url<span class=\"token operator\">!</span><span class=\"token punctuation\">,</span> completion<span class=\"token punctuation\">:</span> completionHandler<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>In the code above, <code class=\"language-text\">AutomationTestsURLSession</code> returns an instance of <code class=\"language-text\">AutomationTestsDataTask</code>, which conforms to our <code class=\"language-text\">URLSessionDataTasking</code> protocol instead of the standard <code class=\"language-text\">URLSessionDataTask</code>.</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">typealias</span> <span class=\"token builtin\">DataCompletion</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">Data</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">URLResponse</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Void</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">AutomationTestsDataTask</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSessionDataTasking</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> completion<span class=\"token punctuation\">:</span> <span class=\"token builtin\">DataCompletion</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">,</span> completion<span class=\"token punctuation\">:</span> @escaping <span class=\"token builtin\">DataCompletion</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>request <span class=\"token operator\">=</span> request\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>completion <span class=\"token operator\">=</span> completion\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">resume</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> json <span class=\"token operator\">=</span> <span class=\"token builtin\">ProcessInfo</span><span class=\"token punctuation\">.</span>processInfo<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">.</span>absoluteString<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">let</span> response <span class=\"token operator\">=</span> <span class=\"token function\">HTTPURLResponse</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">:</span> url<span class=\"token punctuation\">,</span> statusCode<span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> httpVersion<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">,</span> headerFields<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">let</span> data <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>using<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>utf8<span class=\"token punctuation\">)</span>\n            <span class=\"token function\">completion</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">,</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">suspend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>The <code class=\"language-text\">resume</code> method of our <code class=\"language-text\">AutomationTestsDataTask</code> is where the stubbing actually occurs.</p> \n<p>In order to explain the first line of the <code class=\"language-text\">resume</code> method, it’s useful to know that Xcode automation tests run to the app in a separate process, which limits the ways in which the app and the tests can share data. One common way to pass data between the tests and the app is by using the <a href=\"https://developer.apple.com/documentation/xctest/xcuiapplication/1500427-launchenvironment\"><code class=\"language-text\">launchEnvironment</code></a> property on <code class=\"language-text\">XCUIApplication</code>. This is basically a dictionary of type <code class=\"language-text\">[String: String]</code>. Keys and values you set in tests will be available to the app at runtime via the <code class=\"language-text\">environment</code> property of <code class=\"language-text\">ProcessInfo.processInfo</code>.</p> \n<p>Here we check to see if there is some JSON in <code class=\"language-text\">ProcessInfo</code>’s <code class=\"language-text\">environment</code> dictionary for the data task’s request, as identified by its <code class=\"language-text\">URL</code>. If we have some JSON for a given request, then we convert it to data and call completion immediately. This results in the stubbed data being returned to our application instead of the live data from the API that would usually be returned!</p> \n<p>Now all we need is a way of detecting that automation tests are running so that we can swap out the session object the <code class=\"language-text\">Client</code> uses.</p> \n<h3>Session Injection during Automation Tests</h3> \n<p>At SoundCloud, we create a separate app delegate object to use when running automation tests, e.g. <code class=\"language-text\">AutomationTestsApplicationDelegate</code>. This can be a good place to set up application state that your tests rely on and/or clean up that state between test runs.</p> \n<p>We can hook into this system to detect whether or not tests are running. First we need to set an environment variable whenever tests are running. We can use <code class=\"language-text\">XCUIApplication</code>’s <code class=\"language-text\">launchEnvironment</code> property to set a flag. Say we’re writing a test for a sign-in flow in our app. We could alter the implementation of <code class=\"language-text\">setUp</code>, like so:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SignInFeature</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">XCTestCase</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> app<span class=\"token punctuation\">:</span> <span class=\"token builtin\">XCUIApplication</span><span class=\"token operator\">!</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function\">setUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">setUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        app <span class=\"token operator\">=</span> <span class=\"token function\">XCUIApplication</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        app<span class=\"token punctuation\">.</span>launchEnvironment <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"IsAutomationTestsRunning\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"YES\"</span><span class=\"token punctuation\">]</span>\n        app<span class=\"token punctuation\">.</span><span class=\"token function\">launch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">test_signIn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token comment\">// ... test code</span>\n\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>We can dynamically set an app delegate class by deleting the standard <code class=\"language-text\">@UIApplicationDelegate</code> annotation that is added to the default app delegate class that Xcode creates and adding a <code class=\"language-text\">main.swift</code> file instead:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">import</span> <span class=\"token builtin\">UIKit</span>\n\n<span class=\"token keyword\">let</span> isAcceptanceTestsRunning <span class=\"token operator\">=</span> <span class=\"token builtin\">ProcessInfo</span><span class=\"token punctuation\">.</span>processInfo<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">[</span><span class=\"token string\">\"IsAutomationTestsRunning\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">nil</span>\n<span class=\"token keyword\">let</span> appDelegateClass<span class=\"token punctuation\">:</span> <span class=\"token builtin\">AnyClass</span> <span class=\"token operator\">=</span> isAcceptanceTestsRunning <span class=\"token operator\">?</span> <span class=\"token builtin\">AutomationTestsApplicationDelegate</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">self</span> <span class=\"token punctuation\">:</span> <span class=\"token builtin\">AppDelegate</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">self</span>\n\n<span class=\"token keyword\">let</span> args <span class=\"token operator\">=</span> <span class=\"token function\">UnsafeMutableRawPointer</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">CommandLine</span><span class=\"token punctuation\">.</span>unsafeArgv<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">bindMemory</span><span class=\"token punctuation\">(</span>to<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UnsafeMutablePointer</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">Int8</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">self</span><span class=\"token punctuation\">,</span> capacity<span class=\"token punctuation\">:</span> <span class=\"token function\">Int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">CommandLine</span><span class=\"token punctuation\">.</span>argc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">UIApplicationMain</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">CommandLine</span><span class=\"token punctuation\">.</span>argc<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">,</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">,</span> <span class=\"token function\">NSStringFromClass</span><span class=\"token punctuation\">(</span>appDelegateClass<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>The main thing we do here is use the <code class=\"language-text\">isAutomationTestsRunning</code> flag in order to decide which app delegate object to use.</p> \n<p>We can use this to create a simple helper method on <code class=\"language-text\">UIApplication</code> to tell if tests are running:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">extension</span> <span class=\"token builtin\">UIApplication</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">var</span> isAutomationTest<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Bool</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">guard</span> <span class=\"token keyword\">let</span> delegate <span class=\"token operator\">=</span> <span class=\"token builtin\">UIApplication</span><span class=\"token punctuation\">.</span>shared<span class=\"token punctuation\">.</span>delegate<span class=\"token punctuation\">,</span> delegate <span class=\"token keyword\">is</span> <span class=\"token builtin\">AutomationTestsApplicationDelegate</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Then all we need to do is create the correct session depending upon whether or not tests are running and use it wherever we usually create the client:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function\">makeClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Client</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> session<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSessionManaging</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">UIApplication</span><span class=\"token punctuation\">.</span>isAutomationTest <span class=\"token operator\">?</span> <span class=\"token function\">AutomationTestsURLSession</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLSession</span><span class=\"token punctuation\">.</span>shared\n    <span class=\"token keyword\">let</span> client <span class=\"token operator\">=</span> <span class=\"token function\">Client</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">:</span> session<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> client\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>With this, we already have the core of what we need to stub requests in our tests. However, using it as is would place a certain burden on developers; in order to stub requests, they first need to know what requests are made during a test, something which could potentially be a lot. Then they would need to manually make the requests, e.g. in Postman; save the responses to a file; and manually specify which stub should replace which request. The implementation currently lacks the API that would enable this final requirement, but since I’ve promised you automatic recording/replay functionality, I’ll skip straight to the good stuff!</p> \n<h2>Recording Stubs</h2> \n<p>What we’re aiming for is a simple API that takes the burden off developers and enables them to do network stubbing quickly. Our goal is to be able to call one API for recording, run our test, and if it succeeds, then switch to another API for replaying the recorded stubs — something like the record/replay functionality that is built into Xcode automation tests themselves.</p> \n<p>To achieve this, we rely on an important mapping throughout: <code class=\"language-text\">URLRequest -&gt; Stubbed Response</code>. We will basically use the <code class=\"language-text\">URLRequest</code> to construct a path on disk to the stubbed response. We can then use this path to save responses to disk as JSON files when we’re in “record mode” and load them back when we’re in “replay mode.”</p> \n<p><img src=\"https://developers.soundcloud.com/blog/da59fc91a0d3e044d127ee78658f0c16/dob-sign-in-test.gif\" alt=\"Recording of responses during a test\" /></p> \n<p>The gif above shows stubs being recorded for the <code class=\"language-text\">test_singIn</code> test.</p> \n<h3>Environment Setup</h3> \n<p>Before we get started with the automation and application side setup, it’s worth spending a little time on the part that binds the two together. We will need to pass data between the two processes, and because the <code class=\"language-text\">environment</code> and <code class=\"language-text\">launchEnvironment</code> dictionaries of <code class=\"language-text\">ProcessInfo</code> and <code class=\"language-text\">XCUIApplication</code>, respectively, are just “stringly typed,” we can add some syntactic sugar on top to make the whole thing a bit more type-safe:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">enum</span> <span class=\"token builtin\">EnvironmentKey</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> stubbedTestName\n    <span class=\"token keyword\">case</span> networkStubsDir\n    <span class=\"token keyword\">case</span> recordMode\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">enum</span> <span class=\"token builtin\">RecordMode</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> recording\n    <span class=\"token keyword\">case</span> replaying\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Environment</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> processInfo <span class=\"token operator\">=</span> <span class=\"token builtin\">ProcessInfo</span><span class=\"token punctuation\">.</span>processInfo\n\n    <span class=\"token keyword\">subscript</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">:</span> <span class=\"token builtin\">EnvironmentKey</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">String</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> processInfo<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">.</span>rawValue<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">extension</span> <span class=\"token builtin\">XCUIApplication</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">setEnvironmentValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> environmentValue<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> forKey key<span class=\"token punctuation\">:</span> <span class=\"token builtin\">EnvironmentKey</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> launchEnv <span class=\"token operator\">=</span> launchEnvironment\n        launchEnv<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">.</span>rawValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> environmentValue\n        launchEnvironment <span class=\"token operator\">=</span> launchEnv\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Here we basically define an <code class=\"language-text\">EnvironmentKey</code> enum that allows us to wrap the <code class=\"language-text\">environment</code> and <code class=\"language-text\">launchEnvironment</code> dictionaries of <code class=\"language-text\">ProcessInfo</code> and <code class=\"language-text\">XCUIApplication</code> in order to be able to pass data between the app and tests in a type-safe way. Along the way, we’ll discover what the various environment keys are used for, but most should be fairly self-explanatory.</p> \n<h3>Automation Tests Setup</h3> \n<p>We need to pass the name of the running test through to the app so that our <code class=\"language-text\">AutomationTestsURLSession</code> can construct the directory in which to record/replay stubs. We can benefit from the fact that each test in a given test case is essentially a new instance of the test case. This is how <code class=\"language-text\">XCTest</code> helps ensure that individual tests don’t interfere with each other. In fact, for an example test case called, say, <code class=\"language-text\">SignInFeature</code>, if you print <code class=\"language-text\">self.description</code> during a test, you will see something similar to the following:</p> \n<p><code class=\"language-text\">-[SignInFeature test_signIn]</code></p> \n<p>The output above reflects the test case name (<code class=\"language-text\">SignInFeature</code>) and the actual running test (<code class=\"language-text\">test_signIn</code>). This is perfect for our needs because it provides us with an easy way to associate a test name with the requests that are made during the test:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SignInFeature</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">XCTestCase</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> app<span class=\"token punctuation\">:</span> <span class=\"token builtin\">XCUIApplication</span><span class=\"token operator\">!</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function\">setUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">setUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        app <span class=\"token operator\">=</span> <span class=\"token function\">XCUIApplication</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        app<span class=\"token punctuation\">.</span>launchEnvironment <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"IsAutomationTestsRunning\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"YES\"</span><span class=\"token punctuation\">]</span>\n        app<span class=\"token punctuation\">.</span><span class=\"token function\">startRecordingStubs</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">)</span>\n        app<span class=\"token punctuation\">.</span><span class=\"token function\">launch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function\">tearDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        app <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">tearDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">test_signIn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t    <span class=\"token comment\">//...</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>We implement <code class=\"language-text\">startRecordingStubs</code> as an extension on <code class=\"language-text\">XCUIApplication</code>, passing <code class=\"language-text\">self</code> so that we can use <code class=\"language-text\">self.description</code> to get a name for the test. Although relying on the output from <code class=\"language-text\">self.description</code> may seem brittle, its convenience was too good for this developer to ignore:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">extension</span> <span class=\"token builtin\">XCUIApplication</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">startRecordingStubs</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span> testCase<span class=\"token punctuation\">:</span> <span class=\"token builtin\">XCTestCase</span><span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">:</span> <span class=\"token builtin\">StaticString</span> <span class=\"token operator\">=</span> #file<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UInt</span> <span class=\"token operator\">=</span> #line<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setupFileStubs</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> testCase<span class=\"token punctuation\">,</span> recordingMode<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>recording<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">:</span> file<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">:</span> line<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">setupFileStubs</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span> testCase<span class=\"token punctuation\">:</span> <span class=\"token builtin\">XCTestCase</span><span class=\"token punctuation\">,</span> recordingMode<span class=\"token punctuation\">:</span> <span class=\"token builtin\">RecordMode</span><span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">:</span> <span class=\"token builtin\">StaticString</span> <span class=\"token operator\">=</span> #file<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UInt</span> <span class=\"token operator\">=</span> #line<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> testName <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>describing<span class=\"token punctuation\">:</span> testCase<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">setEnvironmentValue</span><span class=\"token punctuation\">(</span>recordingMode<span class=\"token punctuation\">.</span>rawValue<span class=\"token punctuation\">,</span> forKey<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>recordMode<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">setEnvironmentValue</span><span class=\"token punctuation\">(</span>testName<span class=\"token punctuation\">,</span> forKey<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>stubbedTestName<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> networkStubsDir <span class=\"token operator\">=</span> <span class=\"token function\">networkStubsDirURL</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">:</span> file<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">:</span> line<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">setEnvironmentValue</span><span class=\"token punctuation\">(</span>networkStubsDir<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">,</span> forKey<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>networkStubsDir<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>The code above basically sets <code class=\"language-text\">test_signIn</code> into “record mode” so that the app knows to start recording network requests during its execution. We’ll later use <code class=\"language-text\">stubbedTestName</code> and <code class=\"language-text\">networkStubsDir</code> <code class=\"language-text\">EnvironmentKey</code> cases from the app to construct the path to the stubs on disk. The <code class=\"language-text\">.networkStubsDir</code> key will point to the root directory where all stubs are stored. The <code class=\"language-text\">.stubbedTestName</code> key will point to the name of the currently running test, used to create the path to the directory for all stubbed requests for this test.</p> \n<p>For the implementation of <code class=\"language-text\">networkStubsDirURL</code>, we take advantage of the default <code class=\"language-text\">#file</code> argument passed into every method, which gives the absolute path to the current file on disk. Using this, we can construct a new path for where we will record our network stubs, relative to some directory that we know will always be there, like <code class=\"language-text\">AutomationTests/</code> in the example below:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">networkStubsDirURL</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">:</span> <span class=\"token builtin\">StaticString</span><span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UInt</span> <span class=\"token operator\">=</span> #line<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token constant\">URL</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> filePath <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span>description\n    <span class=\"token keyword\">guard</span> <span class=\"token keyword\">let</span> range <span class=\"token operator\">=</span> filePath<span class=\"token punctuation\">.</span><span class=\"token function\">range</span><span class=\"token punctuation\">(</span>of<span class=\"token punctuation\">:</span> <span class=\"token string\">\"AutomationTests/\"</span><span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span>literal<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">XCTFail</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"AutomationTests directory does not exist!\"</span><span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">:</span> file<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">:</span> line<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> <span class=\"token constant\">nil</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">let</span> testsDirIndex <span class=\"token operator\">=</span> filePath<span class=\"token punctuation\">.</span><span class=\"token function\">index</span><span class=\"token punctuation\">(</span>before<span class=\"token punctuation\">:</span> range<span class=\"token punctuation\">.</span>upperBound<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">let</span> automationTestsPath <span class=\"token operator\">=</span> filePath<span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>testsDirIndex<span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">URL</span><span class=\"token punctuation\">(</span>fileURLWithPath<span class=\"token punctuation\">:</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>automationTestsPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">appendingPathComponent</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NetworkStubs\"</span><span class=\"token punctuation\">,</span> isDirectory<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<h3>App-Side Setup</h3> \n<p>In order to record the network responses in the app when the tests are running, we need to add a bit of functionality to our <code class=\"language-text\">AutomationTestsURLSession</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">AutomationTestsURLSession</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">NSObject</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">URLSessionManaging</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> environment <span class=\"token operator\">=</span> <span class=\"token function\">Environment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> _session <span class=\"token operator\">=</span> <span class=\"token function\">URLSession</span><span class=\"token punctuation\">(</span>configuration<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span><span class=\"token keyword\">default</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> testStubsRecorder <span class=\"token operator\">=</span> <span class=\"token function\">TestStubsRecorder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">dataTaskFromRequest</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">,</span> completionHandler<span class=\"token punctuation\">:</span> @escaping <span class=\"token builtin\">CompletionBlock</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">URLSessionDataTasking</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">if</span> environment<span class=\"token punctuation\">.</span>isRecordingStubs <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">let</span> completion <span class=\"token operator\">=</span> testStubsRecorder<span class=\"token punctuation\">.</span><span class=\"token function\">recordResult</span><span class=\"token punctuation\">(</span>of<span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">,</span> with<span class=\"token punctuation\">:</span> completionHandler<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> _session<span class=\"token punctuation\">.</span><span class=\"token function\">dataTask</span><span class=\"token punctuation\">(</span>with<span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">,</span> completionHandler<span class=\"token punctuation\">:</span> completion<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token function\">shouldStub</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">AutomationTestsDataTask</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">,</span> completion<span class=\"token punctuation\">:</span> completionHandler<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> _session<span class=\"token punctuation\">.</span><span class=\"token function\">dataTask</span><span class=\"token punctuation\">(</span>with<span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">,</span> completionHandler<span class=\"token punctuation\">:</span> completionHandler<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">shouldStub</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Bool</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">NetworkResponseStubStorage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">stubExists</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>The logic of <code class=\"language-text\">dataTaskFromRequest(_:completionHandler:)</code> should be easy enough to read:</p> \n<ul> \n <li>If we’re recording, record the stub and return the standard <code class=\"language-text\">URLSessionDataTask</code> to the application.</li> \n <li>Otherwise, if we should stub the response, return an instance of our <code class=\"language-text\">AutomationTestsDataTask</code>, which will do the stubbing.</li> \n <li>Otherwise, bypass the <code class=\"language-text\">AutomationTestsURLSession</code> by immediately returning a standard <code class=\"language-text\">URLSessionDataTask</code> to the application.</li> \n</ul> \n<p>We’ve added three new private properties. The first is an instance of our <code class=\"language-text\">Environment</code> class. It has a new property, <code class=\"language-text\">isRecordingStubs</code>, which informs the <code class=\"language-text\">AutomationTestsURLSession</code> of whether or not it should record the responses from the network. This is based on the call we made back in <code class=\"language-text\">setUp</code> of our test case, i.e. <code class=\"language-text\">app.startRecordingStubs(for: self)</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">var</span> isRecordingStubs<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Bool</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">guard</span> <span class=\"token keyword\">let</span> recordModelValue <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span>recordMode<span class=\"token punctuation\">]</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> recordModelValue <span class=\"token operator\">==</span> <span class=\"token builtin\">RecordMode</span><span class=\"token punctuation\">.</span>recording<span class=\"token punctuation\">.</span>rawValue\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>The second property, <code class=\"language-text\">_session</code>, is an internal <code class=\"language-text\">URLSession</code> property. We use this when we want the network response to complete as normal, i.e. in points 1 and 3 above.</p> \n<p>The final property, <code class=\"language-text\">testStubsRecorder</code>, is an instance of a new class, <code class=\"language-text\">TestStubsRecorder</code>, which actually saves the responses to disk:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">typealias</span> <span class=\"token builtin\">NetworkResponse</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Data</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLResponse</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">typealias</span> <span class=\"token builtin\">CompletionBlock</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">Data</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">URLResponse</span><span class=\"token operator\">?</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">Error</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Void</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestStubsRecorder</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> environment <span class=\"token operator\">=</span> <span class=\"token function\">Environment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> fileManager <span class=\"token operator\">=</span> <span class=\"token builtin\">FileManager</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">default</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">recordResult</span><span class=\"token punctuation\">(</span>of request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">,</span> with completionHandler<span class=\"token punctuation\">:</span> @escaping <span class=\"token builtin\">CompletionBlock</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">CompletionBlock</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">func</span> <span class=\"token function\">completionWrapper</span><span class=\"token punctuation\">(</span>networkResponse<span class=\"token punctuation\">:</span> <span class=\"token builtin\">NetworkResponse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">record</span><span class=\"token punctuation\">(</span>networkResponse<span class=\"token punctuation\">:</span> networkResponse<span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">)</span>\n            <span class=\"token function\">completionHandler</span><span class=\"token punctuation\">(</span>networkResponse<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> networkResponse<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">,</span> networkResponse<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> completionWrapper\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">record</span><span class=\"token punctuation\">(</span>networkResponse<span class=\"token punctuation\">:</span> <span class=\"token builtin\">NetworkResponse</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token comment\">// handle errors</span>\n\n        <span class=\"token keyword\">guard</span> <span class=\"token keyword\">let</span> testName <span class=\"token operator\">=</span> environment<span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span>stubbedTestName<span class=\"token punctuation\">]</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">guard</span> <span class=\"token keyword\">let</span> data <span class=\"token operator\">=</span> networkResponse<span class=\"token punctuation\">.</span>data <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">// create dir for test case if it doesn't already exist</span>\n        <span class=\"token function\">createTestCaseDirIfRequired</span><span class=\"token punctuation\">(</span>forTestName<span class=\"token punctuation\">:</span> testName<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\">// create and return path where stub JSON file will be saved (inside the test case dir)</span>\n        <span class=\"token keyword\">let</span> stubPath <span class=\"token operator\">=</span> <span class=\"token function\">makeTestStubPath</span><span class=\"token punctuation\">(</span>forTestName<span class=\"token punctuation\">:</span> testName<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">)</span>\n\n        fileManager<span class=\"token punctuation\">.</span><span class=\"token function\">createFile</span><span class=\"token punctuation\">(</span>atPath<span class=\"token punctuation\">:</span> stubPath<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">,</span> contents<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">,</span> attributes<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>The main method we’re interested in here is <code class=\"language-text\">recordResult(of:with:)</code>, which our <code class=\"language-text\">AutomationTestsURLSession</code> calls whenever “record mode” is enabled. It uses a local function which wraps the passed completion block. This is the completion block that will return network responses to the application. We actually return this wrapped function and pass it as the completion parameter of the internal <code class=\"language-text\">URLSession</code>’s <code class=\"language-text\">URLSessionDataTask</code> that our <code class=\"language-text\">AutomationTestsURLSession</code> holds so that when the data task’s completion block gets called, our <code class=\"language-text\">recordResult(of:with:)</code> method runs first, thereby writing the results to disk. This method then internally calls the <code class=\"language-text\">URLSessionDataTask</code>’s completion block so that the data can also be returned to the app as normal. The implementations of <code class=\"language-text\">createTestCaseDirIfRequired</code> and <code class=\"language-text\">makeTestStubPath</code> are omitted for brevity.</p> \n<p>One thing not explained so far is the <code class=\"language-text\">AutomationTestsURLSession</code>’s <code class=\"language-text\">shouldStub</code> method. This makes use of a <code class=\"language-text\">NetworkResponseStubStorage</code> object, which is a simple object that makes use of the <code class=\"language-text\">Environment</code> object and <code class=\"language-text\">FileManager</code> in order to construct the file paths to the stubbed responses on disk. If <code class=\"language-text\">shouldStub</code> returns true, we return an instance of our <code class=\"language-text\">AutomationTestsDataTask</code>, which actually does the stubbing:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">NetworkResponseStubStorage</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> environment <span class=\"token operator\">=</span> <span class=\"token function\">Environment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> fileManager <span class=\"token operator\">=</span> <span class=\"token builtin\">FileManager</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">default</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">stub</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Data</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// return stub</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">stubExists</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span> request<span class=\"token punctuation\">:</span> <span class=\"token builtin\">URLRequest</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Bool</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// check if stub exists</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>We can take advantage of the <code class=\"language-text\">NetworkResponseStubStorage</code> object just introduced to update the <code class=\"language-text\">resume</code> method of <code class=\"language-text\">AutomationTestsDataTask</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function\">resume</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> jsonData <span class=\"token operator\">=</span> <span class=\"token function\">NetworkResponseStubStorage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">stub</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">let</span> url <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>url <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> response <span class=\"token operator\">=</span> <span class=\"token function\">HTTPURLResponse</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">:</span> url<span class=\"token punctuation\">,</span> statusCode<span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> httpVersion<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">,</span> headerFields<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">completion</span><span class=\"token punctuation\">(</span>jsonData<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">,</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>You might notice that, for the sake of brevity, we are hardcoding the <code class=\"language-text\">statusCode</code> parameter of the <code class=\"language-text\">response</code> object. If your app explicitly handles these status codes, you may need to extend the solution to also record/replay the status code for a given request.</p> \n<p>The only remaining thing to do is actually return the stubbed response during test runs. In order to do this, we switch the callback in the <code class=\"language-text\">setUp</code> method of <code class=\"language-text\">SignInFeature</code> from <code class=\"language-text\">app.startRecordingStubs(for: self)</code> to <code class=\"language-text\">app.replayStubs(for: self)</code>. The implementation is a simple one-liner added to the extension on <code class=\"language-text\">XCUIApplication</code> where we implemented <code class=\"language-text\">startRecordingStubs(for:)</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function\">replayStubs</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span> testCase<span class=\"token punctuation\">:</span> <span class=\"token builtin\">XCTestCase</span><span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">:</span> <span class=\"token builtin\">StaticString</span> <span class=\"token operator\">=</span> #file<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UInt</span> <span class=\"token operator\">=</span> #line<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setupFileStubs</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> testCase<span class=\"token punctuation\">,</span> recordingMode<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>replaying<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">:</span> file<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">:</span> line<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>So there we have it. With a relatively small amount of code, we’ve been able to design a powerful feature that should go some way to alleviating flakiness in automated tests in a way that is easy to use and saves development time.</p> \n<h2>Conclusion</h2> \n<p>In this post, we first demonstrated how it’s possible to stub the responses to network requests made during an automation test in order to improve the stability of our tests with just a small amount of code. We then showed how the recording and replaying of these stubs can be automated using a simple API in order to remove the burden from the developer and enable this stubbing to be done quickly.</p> \n<h2>References</h2> \n<ul> \n <li><a href=\"https://qualitycoding.org/app-delegate-for-tests/\">How to Switch Your App Delegate for Improved Testing</a></li> \n</ul>","descriptionType":"html","publishedDate":"Fri, 26 Jan 2018 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/eeafeb4fdbe62b6686721e1ebf068086/8ff1e/dob-network-stubbing-start.png","linkMd5":"1aaf1ca40160c5116972179b4e1bb305","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn86@2020_6/2020/08/25/00-49-37-178_b1b824e0fec29ab2.webp","destWidth":800,"destHeight":600,"sourceBytes":18698,"destBytes":16818,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/eeafeb4fdbe62b6686721e1ebf068086/8ff1e/dob-network-stubbing-start.png":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn86@2020_6/2020/08/25/00-49-37-178_b1b824e0fec29ab2.webp","https://developers.soundcloud.com/blog/da59fc91a0d3e044d127ee78658f0c16/dob-sign-in-test.gif":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn86@2020_5/2020/08/25/00-51-54-099_8c328928e20b087f.webp"},"publishedOrCreatedDate":1598316569990},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Roshi: a CRDT system for timestamped events","link":"https://developers.soundcloud.com/blog/roshi-a-crdt-system-for-timestamped-events","description":"<p>Let’s talk about the stream.</p> \n<p>The SoundCloud stream represents stuff that’s relevant to you primarily via your social graph, arranged in time order, newest-first. The atom of that data model, an event, is a simple enough thing.</p> \n<ul> \n <li>Timestamp</li> \n <li>User who did the thing</li> \n <li>Identifier of the thing that was done</li> \n</ul> \n<p>For example,</p> \n<ul> \n <li>At 2014-04-01T13:14:15.034Z,</li> \n <li><a href=\"https://soundcloud.com/a-trak\">a-trak</a></li> \n <li>Reposted track <a href=\"https://soundcloud.com/skrillex/duck-sauce-nrg-skrillex-kill\">skrillex/duck-sauce-nrg-skrillex-kill</a></li> \n</ul> \n<p>If you followed A-Trak, you’d want to see that repost event in your stream. Easy. The difficult thing about time-ordered events is scale, and there are basically two strategies for building a large-scale time-ordered event system.</p> \n<h2>Data models</h2> \n<p><strong>Fan out on write</strong> means everybody gets an inbox.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 404px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/94700c78a46380cc5a7e80e582757b89/6cdf8/fan-out-on-write.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50.495049504950494%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABc0lEQVQoz2NggABOBiKAtbU1S09PD09NTQ03PnUgSWUgFgRiFiBmBGImKGYWFxdndXNzA7H5L1y4sOv79+8fvwHBmTNnskCatbS0hIGUKBCLADErSIwfaigfEMsBsRTUcBCfBwi4BAQE2IFssYMHD5588+bNn3fv3v3ftGlTNUizoqKiBCMjoyAQg8xhRnctM9QgmCUgg7hkZGTYQJKGhob6/v7+vl5eXt6qqqpCDCQAVqiBXNLS0qyysrKgoJC5fv362f////8F4v/nzp2rBCnU1NSUNTY2VjAyMpIDYjZCBrMDAa+YmBhY4e7du9ffunXrGRC/Xrt2bSZIzMbGhtfKyord1NSUDWgwM1HOlZKS4gCFa0BAgFNnZ2dIfX19aEZGhhiSEkai/b58+XIYk/P27dvX/0MBMJabQYIqKirSQEoBiAWIMrCyshLuCqA3FwINugHEtxcvXhwHEnRxcQG5ng1bDOMEOTk5yF5jhxqAFQAApHlumQtK2IcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Fan out on write\" title=\"Fan out on write\" src=\"https://developers.soundcloud.com/blog/static/94700c78a46380cc5a7e80e582757b89/6cdf8/fan-out-on-write.png\" srcset=\"/blog/static/94700c78a46380cc5a7e80e582757b89/9ec3c/fan-out-on-write.png 200w,\n/blog/static/94700c78a46380cc5a7e80e582757b89/c7805/fan-out-on-write.png 400w,\n/blog/static/94700c78a46380cc5a7e80e582757b89/6cdf8/fan-out-on-write.png 404w\" sizes=\"(max-width: 404px) 100vw, 404px\" loading=\"lazy\" /> </a> </span></p> \n<p>That’s how it works today: we use Cassandra, and give each user a row in a column family. When A-Trak reposts Skrillex, we fan-out that event to all of A-Trak’s followers, and make a bunch of inserts. Reads are fast, which is great. But writes carry perverse incentives: the more followers you have, the longer it takes to persist all of your updates. Storage requirements are also quadratic against user growth and follower count (i.e. affiliation density). And mutations, e.g. changes in the social graph, become costly or unfeasible to implement at the data layer. It works, but it’s unwieldy in a lot of dimensions.</p> \n<p>At some point, those caveats and restrictions started affecting our ability to iterate on the stream. To keep up with product ideas, we needed to address the infrastructure. And rather than tackling each problem in isolation, we thought about changing the model.</p> \n<p>The alternative is <strong>fan in on read</strong>.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 404px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/38fd90dc777269b8e41fb7a44abd73f3/6cdf8/fan-in-on-read.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJ0lEQVQoz2NggABOBjTg6urK2tfXx1NVVYUhRwhwA7EyEAuqqKiwggQCAwNlbty4cfnHjx+vP378+P7YsWNeIPHCwkKQPBMUMwMxCxBLA7EYEIsAMVg/PxDzADGvoKAgiGa1sbFRP3ny5Ks3b978f/ny5f/+/v5MkC+AFgpB1YM0ywCxPBDbMDIyCgMxH9QS7ICTk1NeUVFRR0JCQh1kCDMzM0gDLxCzA7EAEAvDXEQQODs7Y4ixsIB8B/YJHzSYRIFYjZWV1d7ExETByMhIDojZUTSZmpqCaR0dHYagoCDG6OhoptjYWEZVVVWwOBcXFwPUu9JQVzJYWVkxubu7sxobG7MBDWZiIBOAIkEJiDWhhrMzUAGwQ71vC8QG0OCgGmDGG8OUAAC8ADKG1qfkJgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Fan in on read\" title=\"Fan in on read\" src=\"https://developers.soundcloud.com/blog/static/38fd90dc777269b8e41fb7a44abd73f3/6cdf8/fan-in-on-read.png\" srcset=\"/blog/static/38fd90dc777269b8e41fb7a44abd73f3/9ec3c/fan-in-on-read.png 200w,\n/blog/static/38fd90dc777269b8e41fb7a44abd73f3/c7805/fan-in-on-read.png 400w,\n/blog/static/38fd90dc777269b8e41fb7a44abd73f3/6cdf8/fan-in-on-read.png 404w\" sizes=\"(max-width: 404px) 100vw, 404px\" loading=\"lazy\" /> </a> </span></p> \n<p>When A-Trak reposts Skrillex, it’s a single append to A-Trak’s outbox. When users view their streams, the system will read the most recent events from the outboxes of everyone they follow, and perform a merge. Writes are fast, storage is minimal, and since streams are generated at read time, they naturally represent the present reality. (It also opens up a lot of possibilities for elegant implementations of product features and experiments.)</p> \n<p>Of course, reads are difficult. If you follow thousands of users, making thousands of simultaneous reads, time-sorting, merging, and cutting within a typical request-response deadline isn’t trivial. As far as we know, nobody operating at our scale builds timelines via fan-in-on-read. And we presume that’s due at least in part to the challenges of reads.</p> \n<p>Yet we saw potential here. Storage reduction was actually huge: we projected a complete fan-in-on-read data size for all users on the order of a hundred gigabytes. At that size, it’s feasible to keep the data set in memory, distributed among commodity servers. The problem then becomes coördination: how do you reliably and correctly populate that data system (writes), and materialize views from up to thousands of sources by hard deadlines (reads)?</p> \n<h2>Enter the CRDT</h2> \n<p>If you’re into so-called <a href=\"https://en.wikipedia.org/wiki/CAP_theorem\">AP data systems</a>, you’ve probably run into the term <a href=\"http://research.microsoft.com/apps/video/default.aspx?id=153540&amp;r=1\">CRDT</a> recently. CRDTs are conflict-free replicated data types: data structures for distributed systems. The tl;dr on CRDTs is that by constraining your operations to only those which are associative, commutative, and idempotent, you sidestep a lot of the complexity in distributed programming. (See: <a href=\"http://lostechies.com/jimmybogard/2013/06/06/acid-2-0-in-action/\">ACID 2.0</a> and/or <a href=\"http://www.bloom-lang.net/calm\">CALM theorem</a>.) That, in turn, makes it straightforward to guarantee eventual consistency in the face of failure.</p> \n<p>With a bit of thinking, we were able to map a fan-in-on-read stream product to a data model that could be implemented with a specific type of CRDT. We were then able to focus on performance, optimizing our reads without becoming overwhelmed by incidental complexity imposed by the consistency model.</p> \n<h2>Roshi</h2> \n<p>The result of our work is <a href=\"https://github.com/soundcloud/roshi\">Roshi</a>, a distributed storage system for time-series events. It implements what we believe is a novel CRDT set type, closely resembling a <a href=\"https://github.com/aphyr/meangirls#lww-element-set\">LWW-element-set</a> with inline garbage collection. At its core, it uses the <a href=\"http://redis.io/commands#sorted_set\">Redis ZSET</a> sorted set to store state, and orchestrates self-repairing reads and writes on top, in a stateless operational layer. We spent a long while optimizing the read path to support our latency and QPS requirements, and we’re confident that Roshi will accommodate our exponential growth for years. It took about six developer months to build, and we’re in the process of rolling it out now.</p> \n<p>Roshi is fully open-source, and all the gory technical details are in the repository, so please do check it out. I hope it’s easy to grok: at the time of writing, it’s 5000 lines of Go, of which 2300 are tests. And we intend to keep the codebase lean, explicitly not adding features that are outside of the tightly defined problem domain.</p> \n<p>Open-sourcing our work naturally serves the immediate goal of providing usable software to the community. We hope that Roshi may be a good fit for problems in your organizations, and we look forward to collaborating with anyone who’s interested in contributing. Open-sourcing also serves another, perhaps more interesting goal, which is advancing a broader discussion about software development. The obvious reaction to Roshi is to ask why we didn’t implement it with an existing, proven data system like Cassandra. But we too often underestimate the costs of doing that: costs like mapping your domain to the generic language of the system, learning the subtleties of the implementation, operating it at scale, and dealing with bugs that your likely novel use cases may reveal. There are even second-degree costs: when software engineering is reduced to plumbing together generic systems, software engineers lose their sense of ownership, which is the foundation of craftsmanship and software quality.</p> \n<p>Given a well-defined problem, a specific solution may be far less costly than a generic version: there’s a smaller domain translation, a much smaller surface area, and less operational friction. We hope that Roshi stands in evidence for the case that the practice of software engineering can be a more thoughtful and crafted process. Software that is “invented here” can, in the right circumstances, deliver outstanding business value.</p> \n<p><em>Roshi was a team effort. I’m deeply indebted to the amazing work of <a href=\"https://twitter.com/tsenart\">Tomás Senart</a>, <a href=\"https://github.com/u-c-l\">Björn Rabenstein</a>, and <a href=\"http://www.freenerd.de\">Johan Uhle</a>, without whom Roshi would have never been possible.</em></p>","descriptionType":"html","publishedDate":"Fri, 09 May 2014 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/94700c78a46380cc5a7e80e582757b89/6cdf8/fan-out-on-write.png","linkMd5":"f473b97b5fe7249e67bfa42febf86c01","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn25@2020_4/2020/08/25/00-49-38-789_c03192d52c8125dc.webp","destWidth":404,"destHeight":204,"sourceBytes":3224,"destBytes":9940,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/94700c78a46380cc5a7e80e582757b89/6cdf8/fan-out-on-write.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn25@2020_4/2020/08/25/00-49-38-789_c03192d52c8125dc.webp","https://developers.soundcloud.com/blog/static/38fd90dc777269b8e41fb7a44abd73f3/6cdf8/fan-in-on-read.png":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn96@2020_6/2020/08/25/00-51-40-327_6db578dfa2b31528.webp"},"publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Synchronous communication for microservices: current status and learnings","link":"https://developers.soundcloud.com/blog/synchronous-communication-for-microservices-current-status-and-learnings","description":"<p>Since we started <a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-2-breaking-the-monolith\">breaking our monolith</a> and introduced a microservices architecture we rely a lot on synchronous request-response style communication. In this blog post we’ll go over our current status and some of the lessons we learned.</p> \n<!-- more --> \n<h2>Finagle and jvmkit</h2> \n<p>Most of our microservices are built on top of <a href=\"https://github.com/twitter/finagle\">Finagle</a> and are written in Scala. Finagle is a highly extensible and protocol agnostic RPC framework developed by Twitter.</p> \n<p>Finagle clients and servers use non blocking I/O on top of Netty. Non blocking I/O improves our scalability since we have a lot of scatter-gather style microservices or microservices that are I/O bound on external resources like databases.</p> \n<p>Finagle is also highly configurable and extensible which means we can tailor it to work well with our infrastructure.</p> \n<p>To make it easy for developers to build microservices that play nicely with the SoundCloud infrastructure and conventions we have an internal library called jvmkit which is maintained by our Core Services team. Some of the functionality jvmkit provides:</p> \n<ul> \n <li>Wrappers around Finagle HTTP, memcached and MySQL with reasonable default configurations and integration with <a href=\"https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud\">Prometheus</a></li> \n <li>DNS based service discovery implementation</li> \n <li>HTTP request routing on top of Finagle</li> \n <li>JSON parsing support for request / response entities</li> \n <li>Logging support according to our standards </li> \n <li>API support for rollout our feature toggle system</li> \n</ul> \n<p>Teams are responsible from development till running their microservices in production so they can decide not to use jvmkit as long as they stick to our standard protocol. In practice however most of our microservices do use jvmkit. By using jvmkit teams have more time to focus on delivering business features.</p> \n<h2>HTTP/1.1 + JSON</h2> \n<p>Almost all our services use HTTP/1.1 + JSON for communication. </p> \n<p>The advantage of HTTP + JSON is that it is supported everywhere so we don’t lock ourselves into a specific technology or programming language. </p> \n<p>There is very good tooling support for HTTP + JSON which makes it easy to debug and interact with our services. </p> \n<p>The HTTP method indicates useful properties of requests. It indicates if a request is idempotent and safe (read-only). These properties tell us if requests can be safely retried or cached. We found this useful when replaying requests to test new revisions of a service. Indication of these properties are missing from other protocols we looked into.</p> \n<p>Of course HTTP + JSON results in more overhead compared to other more optimized protocols. We have some services using Finagle <a href=\"http://twitter.github.io/finagle/guide/Protocols.html\">ThriftMux</a> and have thought about making ThriftMux the recommended protocol but we stepped away from that idea. ThriftMux is not ubiquitous and would lock us into Finagle if we want to get all the benefits.</p> \n<h2>Client side service discovery and load balancing</h2> \n<p>When we started using microservices we used separate load balancer processes as entry points for our services. With the increase in traffic we ran into failing load balancer processes which caused several outages. Our load balancers were single points of failure.</p> \n<p>These outages made us move to client side service discovery and load balancing. We wrote a Java service discovery implementation that queries DNS SRV records to get the instances for a given service. Writing it in Java means it can be integrated in any JVM based language and framework that supports Service Discovery. We obviously integrated it in Finagle by using the Finagle Resolver api. Having support in Finagle means we have client side service discovery and load balancing support for HTTP, ThriftMux, MySQL and memcached.</p> \n<h2>Resilience against failures</h2> \n<p>When investigating the root cause of some of our outages we realized that we had to invest more in improving our resilience against failures. It quickly showed how important it is to use a mature library or system like Finagle which is already equipped with important features like:</p> \n<ul> \n <li>Timeouts: every request across the network needs realistic timeouts. This protects you from issues with the systems you depend on.</li> \n <li>Transport and application level Circuit Breakers: supports ignoring hosts that become unavailable or unhealthy with automatic recovery when they become healthy again. It protects you from issues with systems you depend on and allows them to recover.</li> \n <li>Conditional retries: retrying can be effective but you shouldn’t retry unconditionally as this can result in retry storms that can overload the systems you depend on. Retry budgets allow you to configure a percentage of requests that can be retried on top of a minimum number within a time frame.</li> \n <li>Limiting concurrent requests: If you know the capacity your service can handle you can protect it from overload by limiting the maximum number of concurrent requests and waiters (queue size).</li> \n</ul> \n<p>Using and configuring these features have allowed us to better deal with failures which are inevitable in a distributed system like a microservices architecture.</p> \n<p>We also introduced automated integration tests for jvmkit which show and document how our systems will react to failures. These tests also notify us about potential behavioural changes when upgrading Finagle.</p> \n<h2>No more client libraries</h2> \n<p>When we started implementing microservices teams who implemented a service typically also provided a client library that could be used by other teams to access their service. Those client libraries were implemented in the same programming language as the service and were hiding network communication and serializing / deserializing of requests and responses behind an easy to use api. The idea was that the code to access a service only needed to be written once and could be re-used by many.</p> \n<p>After a while we noticed the client libraries approach also brings a lot of disadvantages:</p> \n<ul> \n <li>A client library brings in dependencies. It might bring in a HTTP library, JSON parsing library etc. This might result in conflicts with the libraries already used by your service. If you depend on more than 1 client library this problem only increases resulting in unnecessary dependencies and conflicts between teams.</li> \n <li>A client library might become bloated with custom logic. Using the client library might be the only way to successfully use the service and prevents it from being used by applications using other technologies. This imposes the use of a programming language and technology on other teams.</li> \n <li>A client library can have default error handling logic which is probably not a good fit for all use cases. Users of a service should be aware of the error scenario’s that can happen and act upon them in the best way for their use case.</li> \n <li>A client library will likely parse all returned fields of a response even if the client is only interested in a subset. This not only might have performance implications but also violates the tolerant reader principle.</li> \n</ul> \n<p>We think these disadvantages far outweigh the benefits. The use of client libraries results in increased coupling and dependencies. Instead of publishing clients we encourage teams to publish their API’s. Consumers write their own clients in a way they find most appropriate using their technology of choice.</p> \n<h2>What’s next?</h2> \n<p>We hope to introduce Consumer Driven Contract tests soon. These tests will catch breaking changes between services and consumers during build time. Some teams are currently working on proof of concepts and are building out and validating the process.</p> \n<p>A logical step for us would be to move from HTTP/1.1 to HTTP/2 as our default protocol. This would improve latency while sticking with a widely supported protocol without technology or programming language lock-in.</p> \n<p>We might also replace JSON with a more efficient serialization protocol like <a href=\"https://developers.google.com/protocol-buffers/\">protocol buffers</a>. This would further improve performance and should result in less handwritten serialization and deserialization code but this still needs more experimentation and investigation.</p>","descriptionType":"html","publishedDate":"Wed, 27 Jul 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"d3507e450017c4bda857cda9adbad322","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud Strategy for OmniAuth 1.0","link":"https://developers.soundcloud.com/blog/omniauth-soundcloud","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 522px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/6f3da632ced4a793ddcee874c3eda1a0/538d2/omniauth.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 28.544061302681996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABJUlEQVQY02NggABGKM1gaevIBGMbGJoyGxiYMukbmDCB2AxIAMgHipkwAjGUbwLRJ6ei5uwRGHImIDLmmL6ZhRVY0shMEmgIFwMaABoCNMCUTd/QBMVwfaA4WN7AlIHBPSDkUU559f/Cmob/7oGhJ6Wl5QwNjczagAZWA20NgmBTZyDfC0iHAHExEDcD+dJA2gGIm4C4G2ioNdj04MSMT7PXbv+/cPPe/xGpOVdFhEX8jU0s64EaJgMVHQLiVUAN+4C2LwDSO4H0ZiC9C2jRaqBL1wPlQfzlQNwHNlBBXSs/PCX7a3hK1kdlLd1kqNccgQbqADVJAWlZAwMTLaBBEkBsAhTTBMpLgNQAxfWAtDpQXBUoDnIxPC4UQcEJYqw6eIGBEgAAGV1URiUOstwAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"OmniAuth\" title=\"OmniAuth\" src=\"https://developers.soundcloud.com/blog/static/6f3da632ced4a793ddcee874c3eda1a0/538d2/omniauth.png\" srcset=\"/blog/static/6f3da632ced4a793ddcee874c3eda1a0/9ec3c/omniauth.png 200w,\n/blog/static/6f3da632ced4a793ddcee874c3eda1a0/c7805/omniauth.png 400w,\n/blog/static/6f3da632ced4a793ddcee874c3eda1a0/538d2/omniauth.png 522w\" sizes=\"(max-width: 522px) 100vw, 522px\" loading=\"lazy\" /> </a> </span></p> \n<p><a href=\"https://github.com/intridea/omniauth\">OmniAuth</a> is a great little Rack library that standardizes multi-provider authentication for web applications. As OmniAuth says, “it was created to be powerful, flexible, and do as little as possible.” I use it constantly on hacks that mash up multiple API providers.</p> \n<p>You can now add <a href=\"http://git.io/sc-omniauth\">SoundCloud</a> to the <a href=\"https://github.com/intridea/omniauth/wiki/List-of-Strategies\">growing list</a> of strategies OmniAuth 1.0 supports.</p> \n<!-- more --> \n<p>&nbsp;</p> \n<h3>Installing</h3> \n<p>Add to your <strong>Gemfile</strong>:</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\"> \n <pre class=\"language-ruby\"><code class=\"language-ruby\">gem <span class=\"token string\">'omniauth-soundcloud'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'~&gt; 1.0.0'</span></code></pre> \n</div> \n<p>Then <strong>bundle install</strong>.</p> \n<p>&nbsp;</p> \n<h3>Basic Usage</h3> \n<p>Add the following piece of Rack middleware.</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\"> \n <pre class=\"language-ruby\"><code class=\"language-ruby\">use <span class=\"token constant\">OmniAuth</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Builder</span> <span class=\"token keyword\">do</span>\n    provider <span class=\"token string\">\"soundcloud\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">ENV</span><span class=\"token punctuation\">[</span><span class=\"token string\">'SOUNDCLOUD_CLIENT_ID'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">ENV</span><span class=\"token punctuation\">[</span><span class=\"token string\">'SOUNDCLOUD_SECRET'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">end</span></code></pre> \n</div>","descriptionType":"html","publishedDate":"Fri, 18 Nov 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/6f3da632ced4a793ddcee874c3eda1a0/538d2/omniauth.png","linkMd5":"4235d0322e3223ceff490d5925389c07","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn30@2020_4/2020/08/25/00-49-38-763_880077ac577c42d3.webp","destWidth":522,"destHeight":149,"sourceBytes":4482,"destBytes":8362,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/6f3da632ced4a793ddcee874c3eda1a0/538d2/omniauth.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn30@2020_4/2020/08/25/00-49-38-763_880077ac577c42d3.webp"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"The Magic of Generating an Xcode Project","link":"https://developers.soundcloud.com/blog/tuist-project-generation","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 640px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/e49a9/jupiter_earth.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAs6AAALOgFkf1cNAAADKklEQVQ4y4WUaUzTdxzG24IFnFU25AoapAi1FOXoJMR4JJuLTAfTScALxDMKOEAUsYhKpLi0tSairkymUrACTpBDSFRUDkWtaCLGxSnTqEQFER17oy/8+Ldu8QgNL54339/vefJ9vpdIJBIxFBwcHPhy1Eh8vD1tGCkbYYv7jBlLkFJJYGAgKpUKLy+vd3H7QmKxmLHeHnwTGUpCzLekJcxl08p4NiTFsiBqBkp/X2SjXHFzc8Pd3R2ZTGZf8F1WqoBxxM2aSmbij+jSkzDlJmMuWE+5PosK3Ub2Z68mUhXwOXdwwQB/OYuiZ6JZHU9h1gos2jQaCnM4+1sebb/v4OIhLa0HtdQYNYQp5DaORHAk+t+aDRKJ7cHVbTSz53xPTmYKh/fspKmymBunK7l3oY6ejlP0dTTSd7WR3isNPGytxrxbyzCp1H6G8kAFi+Pmod+STvUBA9cbynhqbeDV3TbePOmE/r/ghYBnt3h9z0q3tYnpkRHv+Z6enqiCVfj5+aEKCsJ5+BdMDAkhITaavJ+TKMnP4HxxPtYjem7X7Odpazl97ZX0tpTR01xG95kSHjX/wfIFse8FJYJNhUJJaIgaFxdnnFyGM1kdSnL8bPZkLuWkPo0rpk10lmzj79q9/HvtBP+0H2VAQH9bKQ/q9/GoyULmqsQPln195YSHR9oCjsOkhIVOYtX8KHTJcVTkLuOCMYXbRWk8Nm+gvyKHgeo8Buq0DNQW8Px4Pt1VBtbGR9uroRhl8ESWLfxJGJWlVO5IodGQQUthFh1FGv4UMu06qqXLks8dSwE3S7VcMu9iytdh9pvi4e3DvJg55Aojc2TLcs78uo12s47OciMPThbRe7qYnlPF3K/Zx50aE6WG7UilTvYFxRIHwtVqUoW67Naso9a0k8tVB+g6W0HPxeO8uFzFy6t1dJ+zYD1mYlqE+tM5HAxOzs5MmxJB+oqFGDenUvJLNvWmApoO6mg+pKfFbKS+SMcPM2f8t6ZDbIqtQY6OBE8Yz6KY79i8ZgmG7BT2bs3AqEklPTEWhdx3MN7Q18ZJ2IIxwpVRjvdjgv84PL5y/eSAfPz3LUb4MwV/NlnqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Earth vs Jupiter\" title=\"Earth vs Jupiter\" src=\"https://developers.soundcloud.com/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/e49a9/jupiter_earth.png\" srcset=\"/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/9ec3c/jupiter_earth.png 200w,\n/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/c7805/jupiter_earth.png 400w,\n/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/e49a9/jupiter_earth.png 640w\" sizes=\"(max-width: 640px) 100vw, 640px\" loading=\"lazy\" /> </a> </span></p> \n<p>Planet Earth vs. Jupiter. There is the same order of magnitude between the ratio of these two planets and the amount of code that defined the SoundCloud iOS project before — Jupiter — and after — Earth — generating it using <a href=\"https://www.tuist.io/\">Tuist</a>.</p> \n<p>In this blog post, we will discuss the problems of maintaining a complex iOS project, how we managed to simplify the process by writing less and <em>more consistent</em> code, and how we ended up with lower build times as an unexpected result.</p> \n<h2>What’s the Problem with Xcode Projects?</h2> \n<p>Xcode is the official tool for developing apps on Apple platforms. Every time you make a change to an Xcode project, such as adding a new source file or changing a setting, the IDE generates some code into a file called <code class=\"language-text\">project.pbxproj</code>.</p> \n<p>For example, here is an extract of changes that are automatically generated by Xcode when creating a new file:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/da2f0/new-file-xcode.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.62857142857142%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACXElEQVQ4y52Sy08TURTGL6++6MsW26Gdvl8znRk701ALWghIFSVREf8BFy7cmEhcqiuDW90qojEaXsaolWJioih/VzOf596xoAlsXPxybk7mfvf7zhm28/Wgt9n92dvo7Pe2dn/8H9393s7eLwF71/mO23fuY2bpOmrtZVgXbsD8C2ues3wi9fZNaDNXsXTrLrZ298Fe7XRtpXnRZsGkzcaKNovk/1Cw2Smq4ZzNAhmb+dNHBNJOjxPK2swVtzPWrP3mw57N1jY/Q59eRDhrQNanIBst4jyipQb8uQaCOQvRooVIwRQ1WjThS+kYSWhwEe6kDhYpotS8hPXtDthLElSmFsBOlxHI1jGaseBNm/CkzsAt1zAsKfAmVXgIn1wVDEsVDMYUDEkqhsdVsHAexbNtrG+R4NrGJ+itKwhldUhKA5LaREKbRDhfhzdVowfqcHHhhIGBmIoBSSMRzREiE4NxBRQbhUZf8NBhBXG9jbixAEmfQ9aaxSg59qS5oEluTYppwJ1yEoioJwteBosW4UvXxIfuRBVemc9Hw1C8Qs7KdLnkMNanTP3KMYIUWaPIfOhJ/RwtZFrUcI7EZXKUNGj4upgXF+CueBqnHuPwcCnREnzZCUTUOcQqTcTKJoK0eR93mlCdBUi8KgJ+5mL8zEK5o6VwwfIkCQYzwgGP6E9XCU0QyOhiw85lp/bP/Hvhmu7mJ+ad32Z9+wtqs9fEi/5MjTZr0PwMMcuR8aro8+pKHI9H1sVMq61FvH6/C/b24zesPnuBlUdPcO/BqmDl4b/0+yfB7z5++hxc6zf2AcH9It1rWgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"New Xcode file\" title=\"New Xcode file\" src=\"https://developers.soundcloud.com/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/8ff1e/new-file-xcode.png\" srcset=\"/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/9ec3c/new-file-xcode.png 200w,\n/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/c7805/new-file-xcode.png 400w,\n/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/8ff1e/new-file-xcode.png 800w,\n/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/6ff5e/new-file-xcode.png 1200w,\n/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/2f950/new-file-xcode.png 1600w,\n/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/da2f0/new-file-xcode.png 1750w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>The first thing you may notice is that the generated code is not easy to read or change, as it uses unique random identifiers to refer to every entry of the project. Furthermore, a single file addition creates changes in different sections of the project file, which needs to respect a specific format and particular conventions, or else it would result in an invalid project that can’t be opened.</p> \n<h3>Project Files Are for Computers, Not for Humans</h3> \n<p>Now let’s try to imagine how large this file would be in a project of the size of the SoundCloud iOS app, which is composed of thousands of source files and split across dozens of frameworks with multiple targets, hundreds of build settings, and complex linking rules. To give you a better understanding of this, in December 2019, we had more than <strong>80,000</strong> lines of code representing our project. That’s Jupiter!</p> \n<p>Maintaining project files has always been a problem for iOS developers, especially as the number of contributors working on the same codebase grows. As an example of one possible issue, if multiple engineers are working in parallel and trigger changes on the same project file, there is a high chance that this will result in painful git conflicts.</p> \n<h2>Project Generation</h2> \n<p>To solve most of these problems, some engineers in the iOS community came up with the idea of automatically generating the project files. In this way, the projects can be redefined using a “user friendly” format composed of more concise and readable rules. A tool will then run to create a <code class=\"language-text\">pbxproj</code> file that adheres to Apple’s standards.</p> \n<p>The main benefits of this process are:</p> \n<ul> \n <li><strong>Consistency</strong> — one rule applies to all modules</li> \n <li><strong>Simplicity</strong> — it’s easier to understand how your project is defined</li> \n <li><strong>Microprojects</strong> — you can generate a subset of your project on demand, in order to work on a feature in isolation and get lower build times</li> \n <li><strong>No conflicts</strong> — you’ll avoid having to solve difficult conflicts on project files</li> \n <li><strong>Extensibility</strong> — you can easily add new modules</li> \n</ul> \n<h2>Introducing Tuist</h2> \n<p>When we decided to find a new way of generating projects, we opted to use <a href=\"https://www.tuist.io/\">Tuist</a>, an open source project started by one of our former employees, <a href=\"https://ppinera.es/\">Pedro Piñera</a>. Tuist generates Xcode projects based on some rules expressed on a Swift manifest file named <code class=\"language-text\">Project.swift</code> and on the current state of the filesystem.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 658px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/3bfe07ea07ca9ad4d4f8ab25cd2447ae/6164f/tuist-generate.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 64.13373860182371%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACoUlEQVQ4y5XSX0hTURwH8HO13HTOtAzFHprWg6ZBmDKn985w/6QgDCnrboL0Er0EPRgS/VEcJYE6ys39MbuTYdNslkGYsGQpGmgJBol/alNTQ9EeEjRb99e5082ZGXTgyzn3d8/5cDn3hxLTKOQf0XzESxCiXWjrCMXh4YRxDwCw+SYF7fZlY1xCM5ySGnw4HieKW7COQD2WIIgkHBFeh/vRy8jDj0fkoQQkFV1FwKtEawEYqbRzRy7o5l0lhiVniWHxTVH1bKfwKfBIScY5uVw+plAoBnAGZXny0YwTaWIPBpg4b09LEozbD8JwcxI72xgJD4JBSWHNN9DU4Ri+Q0HVzKqoHoQS8fE7NK0GtVoNNE1DsaYYMqlj54cQ8I1ha4uPowGsOG17AMwh7LNgkDxb5wXa+BM0ZoDT9xZA2geCbHF6mVKlAplM9ouLSqmCrLz0k4CAqEfeaSYS4FEMrNoiAIyIbQ2Acu3SfknZtCbrmkcjLnUXS2/OFaUUGqPSjx6OI0kqPycnR0GSpJLKzlUKzqDwZgTRJoKdahICMDHsWrOAA+FJAKxtuM9nXKPl1p5Puqbez3rLqwE1+sfQox/7TAgmdwRvNzqT7UPL4PjohZduAEPXxAhX7x2bR/L8U6EURYVwoVOu+1oKH8YguwHCdrCccSbb+r96WwcX2PYPy2Dp9rz1t4fJ6Q7sw4cIbq73gbAzeKuh84Cpe3LK4vqyhLNi6Bpv4+pjGKx2vPs/cGSj828YO+K0Ta9FlVZnYqmuRcjVatrfb7m7P0A3sw6u2NbBzb/8fAK2XXzwl/0FjMXgQksUgG0vgCPSB74IbEzNzEVam4uosvcTd+19RAXj9NV1HcPoShUTDPpnAQYrLDzQP4xgay1hrBn34UXu3W9ZCnQ8iiBJ+gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Tuist generate command\" title=\"Tuist generate command\" src=\"https://developers.soundcloud.com/blog/static/3bfe07ea07ca9ad4d4f8ab25cd2447ae/6164f/tuist-generate.png\" srcset=\"/blog/static/3bfe07ea07ca9ad4d4f8ab25cd2447ae/9ec3c/tuist-generate.png 200w,\n/blog/static/3bfe07ea07ca9ad4d4f8ab25cd2447ae/c7805/tuist-generate.png 400w,\n/blog/static/3bfe07ea07ca9ad4d4f8ab25cd2447ae/6164f/tuist-generate.png 658w\" sizes=\"(max-width: 658px) 100vw, 658px\" loading=\"lazy\" /> </a> </span></p> \n<p>Before using Tuist, creating a framework for a new μFeature<sup id=\"fnref-1\"><a href=\"https://developers.soundcloud.com/blog/tuist-project-generation#fn-1\" class=\"footnote-ref\">1</a></sup> at SoundCloud was manual, error-prone work. Those days of work are now behind us, as it takes just one line of code and a couple of seconds to run the <code class=\"language-text\">tuist generate</code> command.</p> \n<p>For example, this is the project definition of our μFeature Search:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/3ef42090d8683220360c3c37c2bae663/0a9c2/search.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 37.893296853625166%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABp0lEQVQoz53O20vTYRzH8cfTdA5/c8rWnIdtP506NTFhZHiALA9EF7UpUuE2p3gTzIqoC11eeBPRTYEhJInosoNz4sXGPEBl4R/1g9/bZ4cbCS/q4sXn4cuH7/MVu5lTLXF0piUP/2jJo/+zf3ymJQ5/a19TPzXxdm2b6MtXzL6IEV5YIvwkbyYnVrB0qcjTGKHoIivv1vme/oV4NP9cdzQ26UXuFl0obl1UF5glxZlndl3OourCYNdvTczo31I/dBGYXcBY56NW7cfcOoTFO4ziGZCGMDp9lDq6EdbWvxTZstoovuJFLmbYH2J7P4MIRKKY6ntQmq9T6fJRpfZhkqo9fVi9g9S03UBRr1HlzlPUXkzOHiqaeqlouIri6qbY6uHm/SBbe2nEveBjhLERYetE1HgQFqm2Xf7cjqG+k9I6LwZHNjty7/KGLkrs8ipbl+y3UGaX/UoHA3cfEs9euPj6PXcezDE+GWJsIsRoTpCRQJDb/ulcjmTTf3E2GpgudMOMT0V4tvyGraRcuJlIs/45yYeNL6x+2mF14999jCfY3E0RPzjhHAEERaEZiDJAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Search project definition\" title=\"Search project definition\" src=\"https://developers.soundcloud.com/blog/static/3ef42090d8683220360c3c37c2bae663/8ff1e/search.png\" srcset=\"/blog/static/3ef42090d8683220360c3c37c2bae663/9ec3c/search.png 200w,\n/blog/static/3ef42090d8683220360c3c37c2bae663/c7805/search.png 400w,\n/blog/static/3ef42090d8683220360c3c37c2bae663/8ff1e/search.png 800w,\n/blog/static/3ef42090d8683220360c3c37c2bae663/6ff5e/search.png 1200w,\n/blog/static/3ef42090d8683220360c3c37c2bae663/0a9c2/search.png 1462w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>The result of running Tuist is the creation of a non-trivial project all set up with our common dependencies, build settings, multiple targets, an example app, etc. Everything is generated by a single line of code:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0de7544370839f8d8fe966b24f23dd30/34106/search-project.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 61.50978564771668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABrUlEQVQoz3VSa2/jIBD0//9t7fe2Uk9pr6ksx2BMMRgWPLesH4lVHcrYhMd4dmYbbT38HAUmAJQLStmRoacFkQqwLPxbUfdijALnHOY4y9x7j6btDfw0IeUFT58J1gWkFBkJcQ54/puhXAYzIud8gChjKQuIz2WeVxARmq+PV7y/v8H9OIyqg+p7UbCrqaMkB+9G8P1jjVKA0lfEQphzFERGE2yH769PllsPDNBai7q9tMwsmRJ//b5W34kienODp4ApTQwvaLYPyrjdbmjbVvw4Llc1sSo07C+XuVRCVp0TUrAyl4e8UQnvpXVdh8vlAqXUSU1hoqr6HtYKGZsNO06ExhiEENZzsv6gcBql/HUdbMMMrb7hOeFUWG1ecSIcx1Ha4ERYL/PBGMMprJIJ1mpE7oi8cML8nzigE2H1b/dwvbwrnODswEHQUWrilP98vKDVHcbAQjiYH67kRFhDuV6vorT21L6XNw9pI1xTTmhVi94qjN5K0pX0V8nDMHApVkhkb1MYpjXRRw+Nabnc2lr/KbmGUgkPdWXzkHttDo7VPYTCvlrbcxC0BUKCf+s4qwAewYTuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Search generated project\" title=\"Search generated project\" src=\"https://developers.soundcloud.com/blog/static/0de7544370839f8d8fe966b24f23dd30/8ff1e/search-project.png\" srcset=\"/blog/static/0de7544370839f8d8fe966b24f23dd30/9ec3c/search-project.png 200w,\n/blog/static/0de7544370839f8d8fe966b24f23dd30/c7805/search-project.png 400w,\n/blog/static/0de7544370839f8d8fe966b24f23dd30/8ff1e/search-project.png 800w,\n/blog/static/0de7544370839f8d8fe966b24f23dd30/34106/search-project.png 1073w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h3>With Tuist, We Finally Got Control of Our Project</h3> \n<p>By using Tuist, we didn’t just improve our productivity, but we also upped the consistency of our projects. All the modules are now generated using the same rules, expressed in Swift, using <a href=\"https://tuist.io/docs/usage/helpers/\">Tuist project helpers</a>.</p> \n<p>If we want to change a build setting or a linking rule across all our frameworks, we can simply do it in a single place and regenerate all our projects. It is a faster and more robust approach.</p> \n<p>This is an example of a project helper function that defines the generation of the main target of our μFeatures:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/244c11997e85fd73d949a0252e476a7f/40805/tuist-helpers.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 71.46254458977407%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACo0lEQVQ4y42Ty08TURSHLxbb0oelj5mWlmlrC5136QOk0JbyaHiDCyK48D8wJi4NxqWJG4lbFxCRmBSQxCgpiRvBv4qE5P48M22CGnwsvpw7i/vld86Zy47OLq5aZ9+vWqcXV0ftc+Kiy/l/c0yOY3JYLvbh9BuePN1Gc3MDo8tbuLfwoMOixSbGCevbquNLW1R/pbL8EKXmBh49foYWudi7kzYvNdY4C2V4j6ByJhqcRU3OIhpnYfoOKZwJOmeBu5z5k0SqW7sE0pzdjnK1usTfn5xxtnf4Gfnp+/BmpiBoswhrTQTlBkK5CgR1AlFtAn3JEdyKqmCijB5RsbkVVeCIKegd0MCCGeQb69g7/AK2S0Jzag2ebB398hSCygxCahMhbQ5RkuaKdaTNMp0L8CU1woA7oZFUBhNytphSkmMVlqsrXIUjXiRhg5JW4EmVEcjVICrTEIeqiCljkMxJxNRxBNKGLXXE1JuFVky9vgKHoJFgFkF1Dl5q0Z8y0Z8pwCPpcEklukitCXQ5MkzkbJmV8o8J2Z00QtRuWJ+nOgVnIg8WyoKFhwiqwnBHJlzL/iFM2S0HVUopT9vLcUkFuJNlO6EzrtNySpS+M0MmWMLc34X+7CT8NDMfVYtOm7nuZmV7044oVTHXSfzTDI2bhBFjHgPFdQjGAkRzEaIxi3h+BlKhgUS+jphehag3EFFpYXoN/swYdVBCT1Sn32YNu62OkBv1Vc58Se4cLHJvtsrdyVHukso8MFzlQbnGvekSdyUM7iR64yZ3DFAlKDk9BJnT/LleW+GWi+2ftFGhZ9VLv4E3mbfn0zeo27jobOEeNGz6LKRrPJIJX2qE7ir209z/2AY7+PT1cuftweWLV28un798Tex0+f3cYfsGrLuWw3L9AM0O6gr+6uXfAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Tuist Helpers\" title=\"Tuist Helpers\" src=\"https://developers.soundcloud.com/blog/static/244c11997e85fd73d949a0252e476a7f/8ff1e/tuist-helpers.png\" srcset=\"/blog/static/244c11997e85fd73d949a0252e476a7f/9ec3c/tuist-helpers.png 200w,\n/blog/static/244c11997e85fd73d949a0252e476a7f/c7805/tuist-helpers.png 400w,\n/blog/static/244c11997e85fd73d949a0252e476a7f/8ff1e/tuist-helpers.png 800w,\n/blog/static/244c11997e85fd73d949a0252e476a7f/6ff5e/tuist-helpers.png 1200w,\n/blog/static/244c11997e85fd73d949a0252e476a7f/2f950/tuist-helpers.png 1600w,\n/blog/static/244c11997e85fd73d949a0252e476a7f/40805/tuist-helpers.png 1682w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>There are also other popular open source tools for generating Xcode projects, such as <a href=\"https://github.com/yonaskolb/XcodeGen\">XcodeGen</a>. But we decided to use Tuist because of its ability to express rules in a powerful language like Swift, as opposed to the more verbose approach of using a data interchange format like YAML or JSON. In addition, our developers prefer to edit projects in Swift on Xcode to benefit from code completion and all the features the IDE provides.</p> \n<h2>Serendipity</h2> \n<p>On our way to generate the SoundCloud project, two unplanned yet fortunate discoveries occurred. The first one is that we got better compilation times for our μFeatures. This is because, when using the <code class=\"language-text\">tuist generate</code> command, the tool also generates a separate workspace on which developers can work in isolation.</p> \n<p>So for example, when we want to make some changes on the Search feature, we can quickly generate a workspace that contains only the Search framework and all the modules needed to compile it:</p> \n<p><img src=\"https://developers.soundcloud.com/blog/ebc02e9d0638daf49208d70e87cbdf62/sc-tuist-focus2.gif\" alt=\"Tuist focus\" /></p> \n<p>Surprisingly, a smaller workspace resulted in faster compilation times, probably because Xcode and its compiler have an easier job understanding which source files should be indexed and recompiled and which ones don’t need to be.</p> \n<p>The second unplanned advantage was that we cleaned up our project. While writing the rules to generate SoundCloud, we got rid of: files that were not part of any targets, duplicate resources, and dependencies that should not have been linked. Also, the generated project looks tidier: for example, all of our dependencies are now ordered both by type and alphabetically.</p> \n<h2>Conclusion</h2> \n<p>Generating the project was not an easy journey, as the process of writing the manifest files can be tedious and error-prone. Debugging problems at the project level is not always easy, nor is it easy to validate if the generated project is semantically equal to the previously existing one, even with the support of a great open source tool like <a href=\"https://github.com/bloomberg/xcdiff\">xcdiff</a>.</p> \n<p>However, the benefits clearly overcame the costs for us. Being able to quickly change the setup of all our projects is a huge step toward further modularization of the SoundCloud app. It enables our iOS engineers to quickly create more modules while we are still able to keep the architecture under control.</p> \n<p>Looking to the future, we are planning on using Tuist to continue our process of extracting code from the main application to feature modules, since it’s increasing the productivity of our engineers. We are proud to contribute to open source projects like Tuist, and we are very interested in the further development of the tool that has already proven to be a game changer!</p> \n<div class=\"footnotes\"> \n <hr> \n  <ol> \n   <li id=\"fn-1\"> <p>A μFeature is an <a href=\"https://github.com/tuist/microfeatures-guidelines\">architectural approach</a> to structuring iOS applications to enable scalability, optimize build and testing cycles, and ensure good practices on your team.</p> <a href=\"https://developers.soundcloud.com/blog/tuist-project-generation#fnref-1\" class=\"footnote-backref\">↩</a> </li> \n  </ol> \n </hr> \n</div>","descriptionType":"html","publishedDate":"Thu, 20 Feb 2020 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/e49a9/jupiter_earth.png","linkMd5":"b1b7ea6f021159bbe86db6b0da568bf3","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn80@2020_5/2020/08/25/00-49-37-768_36012f33265ab9bb.webp","destWidth":640,"destHeight":480,"sourceBytes":58887,"destBytes":16664,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/e49a9/jupiter_earth.png":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn80@2020_5/2020/08/25/00-49-37-768_36012f33265ab9bb.webp","https://developers.soundcloud.com/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/8ff1e/new-file-xcode.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn78@2020_1/2020/08/25/00-51-44-842_9d7a8a00ad44a9ef.webp","https://developers.soundcloud.com/blog/static/3bfe07ea07ca9ad4d4f8ab25cd2447ae/6164f/tuist-generate.png":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn43@2020_1/2020/08/25/00-51-45-115_355ff0e58b28cac1.webp","https://developers.soundcloud.com/blog/static/3ef42090d8683220360c3c37c2bae663/8ff1e/search.png":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn68@2020_6/2020/08/25/00-51-43-792_cb90027559d3e472.webp","https://developers.soundcloud.com/blog/static/0de7544370839f8d8fe966b24f23dd30/8ff1e/search-project.png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn75@2020_3/2020/08/25/00-51-41-309_8e46eaba1278e443.webp","https://developers.soundcloud.com/blog/static/244c11997e85fd73d949a0252e476a7f/8ff1e/tuist-helpers.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn76@2020_2/2020/08/25/00-51-43-854_9777ef2598e8de94.webp","https://developers.soundcloud.com/blog/ebc02e9d0638daf49208d70e87cbdf62/sc-tuist-focus2.gif":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn100@2020_5/2020/08/25/00-51-48-507_e8a99ae82eefb9a8.webp"},"publishedOrCreatedDate":1598316569969},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Introducing JavaScript SDK version 2","link":"https://developers.soundcloud.com/blog/introducing-javascript-sdk-version-2","description":"<p>SoundCloud is pleased to introduce a new major version of the SoundCloud JavaScript SDK. In version 2, we’ve rewritten much of the internal code, resulting in better performance for your JavaScript applications and support for more streaming standards, such as HTTP Live Streaming.</p> \n<p>You can test the new version by pointing your JavaScript applications to <a href=\"https://connect.soundcloud.com/sdk-2.0.0.js\">https://connect.soundcloud.com/sdk-2.0.0.js</a>.</p> \n<p>We’ve also created a <a href=\"https://developers.soundcloud.com/docs/api/javascript-sdk-2\">guide</a> to help you upgrade from version 1 to version 2.</p> \n<p>JavaScript SDK version 1 is now deprecated and will be permanently replaced by version 2 on July 1, 2014.</p> \n<p>On June 17, 2014, we will temporarily replace version 1 with version 2 between 10:00 and 11:00 UTC. We will do this again on June 24, 2014, between 18:00 and 19:00 UTC. These two upgrade tests will give you an opportunity to understand the impact of this change on your applications. To ensure a seamless transition for your users, we strongly encourage you to upgrade and perform internal tests in advance of these dates.</p> \n<p>To receive notices before, during, and after these tests, <a href=\"https://twitter.com/SoundCloudDev\">follow @SoundCloudDev on Twitter</a>.</p> \n<p>If you have any questions about this upgrade, please feel free to email <a href=\"mailto:api-support@soundcloud.com?subject=JavaScript SDK 2.0.0\">api-support@soundcloud.com</a>.</p>","descriptionType":"html","publishedDate":"Thu, 01 May 2014 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"27c10d506f86234db492cf25ba89dcbf","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Building The Next SoundCloud","link":"https://developers.soundcloud.com/blog/building-the-next-soundcloud","description":"<blockquote> \n <p>This article is also available in:</p> \n <ul> \n  <li>Serbo-Croatian: <a href=\"http://science.webhostinggeeks.com/pravljenje-novog-soundcloud\">Pravljenje novog SoundCloud</a></li> \n  <li>Armenian: <a href=\"http://students.studybay.com/?p=318\">SoundCloud (ձայնամպ) ծրագրավորողների համար</a></li> \n </ul> \n</blockquote> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 113px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/4c740be23bd4eeba13011264809c5994/ae69b/playing.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAEH0lEQVQ4y02U/U9WZRjHb3hQQUh4eDGwWrUVbJZZoMg7Qj0FITaBeJH3h3eUPWJpqcvaWq1+yNrSaOk0RFlr2svcMtdKKrXFaMt+aJX1B9Dol36TA+fT9z7nATrb99z3ue/r+l7f67qvcxv6jKHfeA9hE2uiD7UmVd+NDMYdZ2jVNwyvuab5hOyH3Gbz4LJdrwksz8Vl3J5lMm+DcpPAQMzrRFLmeDEDjmTCgVQ4qLn9Prwe9qc7CnKBFpPt+QyujqXVrDx0+2Ruu3mIvWtv8VIW7FuHFDmK6kjFQhSOgjmMJPmBIuscN2w6fNKEWLfRknT6adJsyZL+5fAG6I+5TY9ZFIErwv8hxh97hF4zL6W+6m7T53H0RNOnRGkOJ97ihSy7acmgN9Z3tPMldAtdZmW9U6pHgjCahgQVraQcjn2DQ3db49uC7/SMcG4Evj8Dz2otHJDyBNgTtES+jQ3QoTI8dycMJM74ZGUmjcHgPwyqZq1Ks02Gw+kuXXFw8Sj8ehVq5LhTOBmGnz6DJkuo/XbZtlmlAYdRke42O4xezUSy7IdDa8CVo8v5A3B9Es7ugx8vwKvl8E49jHXC79dBbtQLbbLfbWy6DhEdUnfiuHHb4t9jWIVt0GLLKpeQDN7vhWuWcL9SPgcfvwxT4/B2I/x8RWnfC0dLoNqSibRBtezWyYeDvxi3NWmKrmTYpUWrLizpf83AVydh/Hn4btIfLx+Xylb4QYrH+sFdVOsU4/nsUqlaE5V62t+GlpQbtAftxiJPaTOyGe+5PAZnlPq35/3xixPwlghvXBRxh28zNgRPGtfzbVqrM0idM9QlTmoCVUq5VikXKo13peDrCR2CUr6qlMePwJVT8GazanpJvVcBp6S6SLa1ca58F6kXYVPqn4aa1XtoU0FDIqzWZoEinj6kQ/lUtRxV7T6CYz0w8Qq81gQ3p/CCVghV6lWr8An5NqsX61IuGXJNNg2ZDlVroFKbJcJALuwthA8OwvSXsFXO24QTEfht2icMBXz7SoNbqb+mORM3FBj0etENJXxCgw6jWBvbY/FIH5DTafXhtE71Ec1Lhcb7YLjI2qFLxBXsfJGn71Arpc5yj0nxm3uTyaEmwyGUZJUsUBqwKvS3bHBpyfHVlShQvsZcrRd78G3K4uZpuMvOB3yy4hj/2tpiOtipBq8Q6RbVpEAOecJjcirQpbAtOhYGXC/AVikrCsxTJ7Ky+LMeR+TxGJ+0Kt2/cfJMH9UiDaVaB0ffjsgXNC56yPVg1+cpV+BakZUkjC/fCRtNlDAoVGf6pNmmiOLgDNtV01IRF6g+efEKoIshX81brJ+gUkFL02fZHE3T+uUskeVHF7z0E1eu8/vNDjYmfUju+ptsCs7yaMac8AcPJ39OTvyg7JP9NGtjlsiUlfkPN6xP1XWpt1IAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"HTML5 widget\" title=\"HTML5 widget\" src=\"https://developers.soundcloud.com/blog/static/4c740be23bd4eeba13011264809c5994/ae69b/playing.png\" srcset=\"/blog/static/4c740be23bd4eeba13011264809c5994/ae69b/playing.png 113w\" sizes=\"(max-width: 113px) 100vw, 113px\" loading=\"lazy\" /> </a> </span>The front-end team at SoundCloud has been building upon our experiences with the&nbsp;<a href=\"https://blog.soundcloud.com/2012/01/26/html5-widget/\">HTML5 widget</a> to make the recently-released&nbsp;<a href=\"https://soundcloud.com/\">Next SoundCloud</a>&nbsp;beta as solid as possible. Part of any learning also includes sharing your experiences, so here we outline the front-end architecture of the new site.</p> \n<h2>Building a single-page application</h2> \n<p>One of the core features of Next SoundCloud is&nbsp;<em>continuous playback</em>, which allows users to start listening to a sound and continue exploring without ever breaking the experience. Since this really encourages lots of navigation around the site, we also wanted to make that as fast and smooth as possible. These two factors were enough in themselves for us to decide to build Next as a single-page Javascript application. Data is drawn from our&nbsp;<a href=\"https://developers.soundcloud.com/docs\">public API</a>, but all rendering and navigation happens in the browser for near-instant navigation without the need to make round-trip requests to the server.</p> \n<p>As a basis for this style of application, we have used the massively popular&nbsp;<a href=\"http://backbonejs.org/\">Backbone.js</a>. What attracted us to Backbone (apart from the fact that we’re already using it for our Mobile site and the Widget), is that it doesn’t prescribe too much about how it should be used. Backbone still provides a solid basis for working with views, data models and collections, but leaves lots of questions unanswered, and this is where its flexibility and strength really lies.</p> \n<p>For rendering the views on the front end, we use the&nbsp;<a href=\"http://handlebarsjs.com/\">Handlebars</a> templating system. We evaluated several other templating engines, but settled on Handlebars for a few reasons:</p> \n<ul> \n <li>No logic is performed inside the templates, which enforces good separation of concerns.</li> \n <li>It can be precompiled before deployment which results both in&nbsp;<a href=\"http://jsperf.com/handlebars-js-vs-mustache-js/3\">faster rendering</a>&nbsp;and a smaller payload that needs to be sent to clients (the runtime library is only 3.3kb even before gzip).</li> \n <li>It allows for custom helpers to be defined.</li> \n</ul> \n<h2>Modular code</h2> \n<p>One technique we used with the Widget which ended up being a great success was to write our code in modules and declare all dependencies explicitly.</p> \n<p>When we write code, we write in&nbsp;<a href=\"http://wiki.commonjs.org/wiki/Modules/1.1.1\">CommonJS-style modules</a>&nbsp;which are converted to&nbsp;<a href=\"http://requirejs.org/docs/whyamd.html#amd\">AMD modules</a>&nbsp;when they’re executed in the browser. There are some reasons we decided to have this conversion step, possibly best explained by seeing what each style looks like:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\"> \n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// CommonJS module ////////////////</span>\n<span class=\"token keyword\">var</span> View <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lib/view'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    Sound <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'models/sound'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    MyView<span class=\"token punctuation\">;</span>\n\nMyView <span class=\"token operator\">=</span> module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> View<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Equivalent AMD module //////////</span>\n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'require'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'exports'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'module'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'lib/view'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'models/sound'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> View <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lib/view'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      Sound <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'models/sound'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    MyView<span class=\"token punctuation\">;</span>\n\n  MyView <span class=\"token operator\">=</span> module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> View<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre> \n</div> \n<ul> \n <li>The extra&nbsp;<code class=\"language-text\">define</code>&nbsp;boilerplate is tedious to write</li> \n <li>Duplication of module dependencies is also tedious and error-prone</li> \n <li>Conversion from CommonJS to AMD is easily automated, so why not?</li> \n</ul> \n<p>During local development, we convert to AMD modules on-the-fly and use&nbsp;<a href=\"http://requirejs.org/\">RequireJS</a>&nbsp;to load them individually. This makes development quite frictionless as we can just save and refresh to see the updates, however it’s not so great for production since this method creates hundreds of HTTP requests. Instead, the modules are concatenated into several packages, and we drop RequireJS for the super-lightweight module loader&nbsp;<a href=\"https://github.com/jrburke/almond\">AlmondJS</a>.</p> \n<h3>CSS and Templates as dependencies</h3> \n<p>Since we’re already including all of our code by defining explicit dependencies, we thought it made sense to also include the CSS and template for a view in the same way. Doing this for templates was rather straight-forward since Handlebars compiles the templates into a Javascript function anyway. For the CSS, it was a new paradigm:</p> \n<p>Views define which CSS files are needed for it to display properly, just the same as you would define the javascript modules you need to execute. Only when the view is rendered do we insert its CSS to the page. Of course, there are some common global styles, but mostly, each view has its own small CSS file which just defines the styles for that view.</p> \n<p>When writing the code, we write in plain vanilla CSS (without help of preprocessors such as SCSS or LESS), but since they are being included by Require/Almond they need to be converted into modules as well. This is done with a build step which wraps the styles into a function which returns a&nbsp;<code class=\"language-text\">&lt;style&gt;</code>&nbsp;DOM element. Here’s an example of how it looks in essence:</p> \n<p><em>Input is plain CSS</em></p> \n<div class=\"gatsby-highlight\" data-language=\"css\"> \n <pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.myView</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 5px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #f0f<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.myView__foo</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 1px solid #0f0<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p><em>Result is an AMD module</em></p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\"> \n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"views/myView.css\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> style <span class=\"token operator\">=</span> module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'style'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  style<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>\n    document<span class=\"token punctuation\">.</span><span class=\"token function\">createTextNode</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.myView { padding: 5px; color ... }'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<h2>Views as components</h2> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 113px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/2623543bfa5746756f3fd0e5f1345b8e/ae69b/repost.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAD6UlEQVQ4y2VUTUxcVRQ+b4a2TGcszABlUFloUkha0QawRYa/Do5CgcZMsR06w8AMUKZYMraG/mCMrvxJdGGiTTU2sWpZNTbGxIUL24W6MN3UZTEujDGl0jQ2NVoecz+/e+90QL3J9+59557znfOde98TTIngsJiBrHikODAkIb4fQK7sPRzZ8A1mNn3L9af0P6ISsq3kNyne0ppcoiZKZGYD3eLDtPM68pXLOFUDvBwG5kLACa71+/xW4Hi1yyQXMSINJia30YOkrA1kLJkalR04unkRr9QBL24BK3KZ1WUVq0W4TOZiNmAT5be4KitpS+rzqAOaZMzKREKTBe5g/kHgsHMPE1IggSLh/zFBTMoKK7VVZ2TKcEwU5aODMmf8izhZpzfvUT5MkAXXzjqss4+x6tkgcKwKLKh9TXLW8yZOPwyMk2xc9KxoU8g4OghIr4Pez3qsT8bYXLxUC0z7r1qyLqlCLngLOfbsEGWOOgppYlj0OwPLgEk/K9ts5yRtei/NZKMkTelKvS6O1Wr/QeEjgXydfnF5agpJku2n00dT7CVP97sFmHH3FvDXHeCPJeDsmCVNlSkcIvFBxuZ5SBn/eVGp8jOYqdEOLhJehWfp+O6IJfnhEq/IDuDtuMVrPcDCvN2bexzG93nRalaR4clngz+KSgauYLwCiNM4yM03hmxAoWDnr88CT4sNHmfzM0z++y/ApbeooF7bFPaxVSm2Y6zqpmCk8nuMUtogjZrw3HHg8meUd5dyLwJfnWHgo0CMhAuv2iR//2nn2zdYVb1CH2MTrDAZWhbE/QtcgEYXA+zfHgZ2EbfZq3NzQBPXvUVEiMsXUBqno0APi9hLwv08tIOhnwQDG19AKqwrcPGM3tyg+PkB72Rs0E3K+20RuPEz8Ot14GgLcO0K8P4ssJv+/TyYXt1/tiNe+aWgWRowHHbRtwmsTiFK9Dq2mlwr8MEJ4MOTRZwCnmNgVGCURI0/VJRfTSIMFfPmzF1UMd/nGK7VJCvodrRkhR5e3l0M2vkfdBRbon26TeIC9j7AMwgtoV4q7eVukkYM1LiIBbSMVVNdhAEd/Fo6vfgXtN2AZE9x7ipbwfBDej1tySKO/W21Shr7eMH3kLSVPdlN0jaxfVqPNjMDT7Kydu8K4iTrKv/EcOR7HUvaV23/OC0yhX6SxkI6wGV/NVZpLxg0G7hcszVMPESyDt/50j9huxQJg0R/2JI2SDsiwavoYU87SdzG/rSUM4GPPeXljfAjiDJpZ/USnijK1HGN98l2FQ1Gvn/td/6IDGJ74GM0b72GpuASdtYsE9fxWMUXaCzP0b/Cyhxy7pNRlfwDNk5LbS4SsLAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"repost\" title=\"repost\" src=\"https://developers.soundcloud.com/blog/static/2623543bfa5746756f3fd0e5f1345b8e/ae69b/repost.png\" srcset=\"/blog/static/2623543bfa5746756f3fd0e5f1345b8e/ae69b/repost.png 113w\" sizes=\"(max-width: 113px) 100vw, 113px\" loading=\"lazy\" /> </a> </span>A central concept in developing Next is that of treating views as&nbsp;<strong>independent</strong>&nbsp;and&nbsp;<strong>reusable</strong>&nbsp;components. Each view can include other ‘sub’ views, which can themselves include subviews and so on. The effect of this is that some views are merely composites of other views and cover an entire page, whereas others can be as small as a button, or even a label in some cases.</p> \n<p>Keeping these views independent is very important. Each view is responsible for its own setup, events, data, and clean up. Views are ‘banned’ from modifying the behaviour or appearance of their subviews, or even making assumptions about how or where this view itself is being included. By removing these external factors, it means that each view can be included in any context with absolute minimum fuss, and we can be sure that it will work as it is supposed to.</p> \n<p>As an example, the ‘play’ button on Next is a view. To include one anywhere on the site, all that we need to do is create an instance of the button, and tell it the id of the sound it should play. Everything else is handled internally by the button itself.</p> \n<p>To actually create these subviews, most of the time they are created inside the template of the parent view. This is done by use of a custom Handlebars helper. Here is a snippet from a template which uses the&nbsp;<code class=\"language-text\">view</code>&nbsp;helper:</p> \n<div class=\"gatsby-highlight\" data-language=\"html\"> \n <pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>listenNetwork__creator<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span> {{view \"views/user/user-badge\" resource_id=user.id}}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre> \n</div> \n<p>As you can see, adding a subview is as simple as specifying the module name of the view and passing some minimal instantiation variables. What actually happens behind the scenes goes like this:</p> \n<p>When a view is rendered, the template must return a string. When the view helper is invoked, it pushes the attributes passed to it, plus a reference to the requested view class, into a temporary object with an id, and outputs a placeholder element (we use&nbsp;<code class=\"language-text\">&lt;view data-id=\"xxxx\"&gt;</code>). The id is just a unique, incrementing number. After a template is rendered, the output would be a string which might look something like:</p> \n<div class=\"gatsby-highlight\" data-language=\"html\"> \n <pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>foo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>view</span> <span class=\"token attr-name\">data-id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>123<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>view</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span></code></pre> \n</div> \n<p>Then we find the placeholders and replace those elements with the subview’s element which it automatically creates for itself. In essence, the code does this:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\"> \n <pre class=\"language-javascript\"><code class=\"language-javascript\">parentView<span class=\"token punctuation\">.</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'view'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">each</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> id <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data-id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        attrs <span class=\"token operator\">=</span> theTemporaryObject<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      SubView <span class=\"token operator\">=</span> attrs<span class=\"token punctuation\">.</span>ViewClass<span class=\"token punctuation\">,</span>\n      subView <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SubView</span><span class=\"token punctuation\">(</span>attrs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  subView<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// repeat the process again</span>\n  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replaceWith</span><span class=\"token punctuation\">(</span>subView<span class=\"token punctuation\">.</span>el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre> \n</div> \n<h2>Sharing Models between Views</h2> \n<p>So, we now have a system where there will be dozens of views on the screen at one time, many of which will be views of the same model. Take, for example, a “listen” page:</p> \n<p><a href=\"https://developers.soundcloud.com/blog/assets/posts/Selection_006.png\"><img src=\"https://developers.soundcloud.com/blog/assets/posts/Selection_006-505x231.png\" /></a></p> \n<p>There would be a view for the play button, the title of the sound, the waveform, the time since the sound was uploaded&nbsp;<em>(this dynamically updates itself, which is why it is a view)</em>, and so on. Each of these views are of the same sound model, but we wouldn’t want each to duplicate the data. Instead we need to find a way to share the model.</p> \n<p>Also remember that each of these views has to handle the case where there is no data yet. Almost all views are instantiated only with the id of its model, so it’s quite possible that the data for that model hasn’t been loaded yet.</p> \n<p>To solve this, we use a construct we call the&nbsp;<em>instance store</em>. This store is an object which is implicitly accessed and modified each time a constructor for a model is called. When a model is constructed for the first time, it injects itself into the store, using its id as a unique key. If the same model constructor is called with the same id, then the original instance is returned.</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\"> \n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> s1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Sound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">:</span> <span class=\"token number\">123</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    s2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Sound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">:</span> <span class=\"token number\">123</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ns1 <span class=\"token operator\">===</span> s2<span class=\"token punctuation\">;</span> <span class=\"token comment\">// true, these are the exact same object.</span></code></pre> \n</div> \n<p>This works because of a surprisingly little-known feature of Javascript. If a constructor returns an object, then that is the value assigned. Therefore, if we return a reference to the instance created earlier, we get the desired behaviour. Behind the scenes, the constructor is basically doing this:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\"> \n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> store <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Sound</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">attributes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> id <span class=\"token operator\">=</span> attributes<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// check if this model has already been created</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// if yes, return that</span>\n        <span class=\"token keyword\">return</span> store<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// otherwise, store this instance</span>\n    store<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>This is not a particularly new pattern: it’s simply just the Factory Method Pattern wrapped up into the constructor. It could have been written as&nbsp;<code class=\"language-text\">Sound.create({id: 123})</code>, but since Javascript gives us this expressive ability, it makes sense to use it.</p> \n<p>So, this feature means that it’s completely simple for views to share the same instance of a model without knowing anything about the other views, simply by calling the constructor with a single id. We can then use this shared instance as a localised ‘event bus’ to facilitate communication and synchronisation of the views. Usually this is in the form of listening to changes to the model’s data. If the views subscribe to the ‘change’ events which affect it, then they will be notified immediately upon change and the page can be kept up-to-date with very little effort required by the developer.</p> \n<p>This also is how we solve the issue of there being no data on the model. On the first pass, several views might have a reference to a model which only contains an id and no other attributes. When the first view is rendered, it can detect that the view does not have enough information and so it would ask the model to fetch its data from the API. The model keeps track of this request, so that when the other views also ask it to fetch, we do nothing and avoid duplicate requests. When the data comes back from the server, the attributes of the model will be updated, causing ‘change’ events which then notify all the views.</p> \n<h2>Making full use of data</h2> \n<p>A common feature of many APIs is that when one particular resource is requested, other related resources are included in the response. For example, on SoundCloud, when you request information about a sound, included in the response is a representation of the user who created that sound.</p> \n<div class=\"gatsby-highlight\" data-language=\"json\"> \n <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">/* api.soundcloud.com/tracks/49931 */</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">49931</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Hobnotropic\"</span><span class=\"token punctuation\">,</span>\n  ...\n  <span class=\"token property\">\"user\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1433</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"permalink\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"matas\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"username\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"matas\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"avatar_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http://i1.soundc...\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Rather than let this extra data go to waste, each model is aware of which ‘sub-resources’ it can expect in its responses. These sub-resources are inserted into the instance store in case any views need to use the data. This means we can save a lot of extra trips to the API and display the views much faster.</p> \n<p>So, for our example above, the Sound model would know that in its property “user” it has a representation of a User model. When that data is fetched, then two models are created and populated on the client side:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\"> \n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> sound <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Sound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">:</span> <span class=\"token number\">49931</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nsound\n  <span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>             <span class=\"token comment\">// get the data</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  <span class=\"token comment\">// and when it's done</span>\n    <span class=\"token keyword\">var</span> user <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">:</span> sound<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>id <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    user<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'matas' -- we already have the model data</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre> \n</div> \n<p>What’s important to remember is that because there’s only ever one instance of each model, even pre-existing instances are updated. Here’s the same example from above, but note when the User is created.</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\"> \n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> sound <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Sound</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">:</span> <span class=\"token number\">49931</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    user <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">:</span> <span class=\"token number\">1433</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nuser<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// undefined -- we haven't fetched anything yet.</span>\nsound\n  <span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    user<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'matas' -- the previous instance is updated</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre> \n</div> \n<h2>Letting go</h2> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 113px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/625e95ddaf0c1936b44c4c0d32018589/ae69b/notification.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAD20lEQVQ4y42UXWxTZRjHn3Y4Vlq3tdtw8+PCC7eEDyUb4NjWdW7UDOgQR9mK3fcHK1NS8RvUC2+IXBBjYogxMXGaeGGAZI4LjIF4oYbICDpJFDejBL0YmYkxRmGnff/+n/OWNsYYPcm/fc/7Ps/v+TrnCMZFsE/cCyPildyFLgnxvgepFW9g/23nMLnyU67fo/1+k5D78nZjUpRfkyVmNA9zDxARHyY8R5AuX8ILVcCL1cCzIeA5rvX+8GrgqUqHQU5gr9S6PqliL5JSuDBsYaZf1uKJVfN4uQZ4shTMyGFUh1lkcnIYzMGBgA2ULnXMiAxYqM9rehQyaMtEQmGB33D4TmCf9yZGJUuAIfCfGqXGZJmZ2qyHZdxljObKRwvLnPTP4/kaPVQYMOaxjrr+u4x7NuYBBpn1gSBwsAJMqKlQ8oj3VRy6GxgibIhOSTr1Uf1c9/2L1EZtB9iGp+8AJvyzFtYqFUgFf0GqVA2z6KXhB4cMrn8P/HgRuDZHfQ1c/RL46TLwA/cWF4Azr4FDsUEH2euDhD4mMeFPAukavXGQZCm7aXT5LP7z+vkb9TGUlusgzSEN+6fE9JUcxyQbG+dmr9dgFw0uTFunm38Cr7QBz9wPHItzWMzi6pw9mz8P9IjK0DeDYU5+JDgnJhn4BENlICiDOIExBc5Yp99/ZY/Y9E6BG2grdelMDvgF0C0qg0fZqqSfpVdcF+wt/xz9dIpxcxeB6nzhdKG0j98GHuZehDq6p7C/MAvsFJXhW8Xer+KgQkuCbv/7XGgWDmIEahbnP7RON/6w/6eOAUdY8vINIJuxe1eY4XZRaRJZ7CawN7Qg2FH8OPrY0CiBnQS20uDS/xjKtW/VxzB7TcJBgs9id/mMoF5qEa8mbCXQzsMW6qVHgI+mgJk3gZOv0/kKYAxw+i1g+rg9OzoEhGnb4YFp51uTqIaJFqXcZ9FEfacQ5wSbedDGN2AzDR9gOfXUWm08X8fP2IY2L7CO9xuojbSJeNQni+23cwahRdwj5fbhXi912FHlIMrRP8hph4uA1hUGYSpSDGwioINT3MrzFm2LntFmi+h6GfG7dD1hYc0e+9naKAPYyQf8oYBGdwgGGkUDGGwhRLNWNVJ6tomZNRUto5uw1pJ3XUa6w2OhnZX2i9Mg49hGaDSkDg5LVmW4n81L9xrYmggDdxHW4pvKfxPWSA4YpLZVW2itNKE5OIs29jRMcCP701DCAD72lmU38yVoZ9Bw5SL7PJGH1d2Cbc5tuOX7C5/zeyWGNYF3UL/6K6wPLmJD1RL1HdaVTaOuJEX7Mltml+cWjFXJX4h7cyAYrpgIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"notification\" title=\"notification\" src=\"https://developers.soundcloud.com/blog/static/625e95ddaf0c1936b44c4c0d32018589/ae69b/notification.png\" srcset=\"/blog/static/625e95ddaf0c1936b44c4c0d32018589/ae69b/notification.png 113w\" sizes=\"(max-width: 113px) 100vw, 113px\" loading=\"lazy\" /> </a> </span>Holding on to every instance of every model forever isn’t feasible, especially for the Next SoundCloud. Because of the nature of the site, it’s quite possible that a user might go for several <em>hours</em>&nbsp;without ever performing a page load. During this time, the memory consumption of the application would just continue to grow and grow. Therefore, at some point we need to flush some models out of the instance store. To decide when it is safe to do this, the instance store increments a usage counter each time an instance has been requested, and views can ‘release’ a model when it is no longer needed and the count is decremented.</p> \n<p>Periodically, we check the store to see if there are any models with a count of zero, and they’re purged from the store, allowing the browser’s garbage collector to free up the memory. This usage count is encapsulated in the store object, but in essence it’s something like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\"> \n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> store <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    counts <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Sound</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">attributes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> id <span class=\"token operator\">=</span> attributes<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    counts<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> store<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  store<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n  counts<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">Sound</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">release</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  counts<span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span><span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>The reason for performing the cleanup on a timer, rather than whenever a usage count hits zero is so that the model stays in the store when you switch views. If you navigate to another page, there will be a single moment between cleaning up the existing views and setting up the new ones when every single model’s count is zero. The new page might actually contain views of one or more of these models, so it’d be quite wasteful to remove them instantly.</p> \n<h2>A long journey…</h2> \n<p>This has been a brief introduction into some of the methods and concepts we’re using to create&nbsp;<a href=\"https://next.soundcloud.com/\">Next SoundCloud</a>, but it’s just the beginning. There are plenty more features which we have yet to build and therefore plenty more challenges to tackle. If you want join us along the way, remember that <a href=\"https://soundcloud.com/jobs\">we’re always hiring</a>!</p>","descriptionType":"html","publishedDate":"Thu, 14 Jun 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/4c740be23bd4eeba13011264809c5994/ae69b/playing.png","linkMd5":"e6bf24ccfd2d4d421302716717b1cfec","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn5@2020_4/2020/08/25/00-49-37-642_7a8fe105a73b37ff.webp","destWidth":113,"destHeight":113,"sourceBytes":1737,"destBytes":3420,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/4c740be23bd4eeba13011264809c5994/ae69b/playing.png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn5@2020_4/2020/08/25/00-49-37-642_7a8fe105a73b37ff.webp","https://developers.soundcloud.com/blog/static/2623543bfa5746756f3fd0e5f1345b8e/ae69b/repost.png":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn90@2020_1/2020/08/25/00-51-42-861_2df026fe69af4498.webp","https://developers.soundcloud.com/blog/assets/posts/Selection_006-505x231.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","https://developers.soundcloud.com/blog/static/625e95ddaf0c1936b44c4c0d32018589/ae69b/notification.png":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn42@2020_6/2020/08/25/00-51-43-622_39764ef810b0ecfa.webp"},"publishedOrCreatedDate":1598316569990},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Let’s go backstage. Welcome to the SoundCloud development blog!","link":"https://developers.soundcloud.com/blog/lets-go-backstage-welcome-to-the-soundcloud-development-blog","description":"<p><a href=\"http://www.flickr.com/photos/ericwahlforss/3527478421/\"><img src=\"http://farm4.staticflickr.com/3309/3527478421_c414163966.jpg\" alt=\"Our developers are too cool to not wear sunglasses!\" /></a></p> \n<p>Our very cool devs&nbsp;<a href=\"https://soundcloud.com/matas\">Matas</a> and <a href=\"https://soundcloud.com/hannes\">Hannes</a>.</p> \n<p>With over 15 developers working on the <a href=\"https://soundcloud.com/\">SoundCloud</a> site nowadays, we’re pumping out a steady stream of <a href=\"https://blog.soundcloud.com/2010/08/19/reuse-soundcloud-style/\">new features</a> and scalable web application code. It’s been a long journey building up such a great team, with lots of lessons learned along the way. We’re really thankful for the fact that the web startup community is so open about sharing technical knowledge–this has been super-helpful for us sofar. And we’re still regularly checking blogs of peer companies for updates on the latest available technologies and techniques…</p> \n<p>So, we thought that <em>now</em> would be a good time to start sharing back some of the innovation that is coming out of our own team, since we’ve got a fair amount of that going on these days. Our aim is to keep this a low-volume, high-quality blog for all things development related–from <a href=\"http://berlin.musichackday.org/index.php?page=Xylobot\">nightly hacks</a> at <a href=\"http://musichackday.org/\">Musichackday</a> to <a href=\"http://sgi.com\">server infrastructure</a> to <a href=\"http://jquery.com\">Javascript</a> lazy-loading techniques to <a href=\"http://cassandra.apache.org/\">NoSQL</a> installations. First up is a highlight on the newly available&nbsp;<a href=\"https://www.w3.org/TR/cors/\">CORS</a> support in the <a href=\"https://soundcloud.com/developers\">SoundCloud API</a> built by our mighty summer intern <a href=\"https://soundcloud.com/fractal\">Thor</a>.</p> \n<p>We’re excited about this and hope you’ll like it!</p>","descriptionType":"html","publishedDate":"Thu, 26 Aug 2010 00:00:00 +0000","feedId":10291,"bgimg":"http://farm4.staticflickr.com/3309/3527478421_c414163966.jpg","linkMd5":"ca3a045c5a0779a56e19168840bdc0ef","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn18@2020_4/2020/08/25/00-49-38-429_4a08e6f2d8199488.webp","destWidth":500,"destHeight":375,"sourceBytes":45594,"destBytes":21318,"author":"","articleImgCdnMap":{"http://farm4.staticflickr.com/3309/3527478421_c414163966.jpg":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn18@2020_4/2020/08/25/00-49-38-429_4a08e6f2d8199488.webp"},"publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Wave Raid powered by Timed Comments","link":"https://developers.soundcloud.com/blog/wave-raid","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 520px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/249e6/waveraid.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 65.76923076923077%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAACs0lEQVQozzWSy08TURjFJzFtJZ33dB6dmb5LC22B2hp8JMSNEY3ySKoo0KbFuMGNPIyJDdpSo2BKZWigUkKJ0KgrKSBiQFQU4x+ACRv5G3RnGljUr62e1Z17c+5vzvkuYvkvs9lsNBodDofdbrfZbCaTSa/XC4JAkiQsZFk2GAywabVanU6ny+Xy+XwIfMMunPE8z3GcJEmwBo/f71cUZX9/v6WlBUVRfUWiKAIA/MBobGxEqvexLAtn4IRji9UCtwQCgYmJ1HKhAAuNRsOxrE7HAkCq+OHX3G43Ah7w02VRFEVrCYpmdBhJowRpkESe1Wm1qBYnjqOEjqHhUo4XAAAZy2Zgwg4EU9do263qoaZjN5ya2w2qQK160KuSqZqhE+ouh7qnThXx1ES8JM8LwIOOIDYC8YAs6gWc5s476JFzXJuH7fMzPU1Mp4uyGYSIj7nqpkJ+LtwsXvMKgIZ0UGl9fT0iVgR8UdTzouzxnZJNFmudx2hzSCYrVFrrajDb67zNZ06ePosRFIHjkLyKRPiKKpnpwXvRhaV8OpubnpmZy2bn57LpdDqTyUwqU7FYXFGmhoeHMByrjg06R6olw5RYvfw9N1rKXT9aGzs8Ovp5cLC782nrw/bO12+r6xuzc/NvVtY3N7eADFgoHGKXM4Mf5sAbzbvdplIAKV5Bfm0vLb/fnp5MJRKPniZTyWfKw9HE4/FkNDoCMydJqvp+EBzHIbCOYWhB+tJlLLUjxUvI78+vXq+8G0vEHsTi0ej92Eh8/ElyPJkaGLgDZBhq9SEhBEEwDEPBrFj+YyZeeh4qFib+FA/39n5srK8VVt++zC/mc4vZ6fkX+fzCwixBkHilM9A/M00zGIZeuNzRP3A3dKs/HI7cLKsvGAyGI33dvb3tHZ29wVBr60WVSoVhGFiA/Beej8GaQWXIQQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Wave Raid\" title=\"Wave Raid\" src=\"https://developers.soundcloud.com/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/249e6/waveraid.png\" srcset=\"/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/9ec3c/waveraid.png 200w,\n/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/c7805/waveraid.png 400w,\n/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/249e6/waveraid.png 520w\" sizes=\"(max-width: 520px) 100vw, 520px\" loading=\"lazy\" /> </a> </span></p> \n<iframe width=\"100%\" height=\"166\" scrolling=\"no\" frameborder=\"no\" src=\"https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F42017162&amp;auto_play=false&amp;show_artwork=true&amp;color=ff7700\"></iframe> \n<p>One of the <a href=\"https://developers.soundcloud.com\">SoundCloud API’s</a> most powerful features is the <a href=\"https://developers.soundcloud.com/docs/api/comments\">timed comment</a>. At its core it seems simple enough: a piece of text associated with a point in time for a particular track. But where you see timed opinions, I see a light-weight game scripting engine.</p> \n<p>So when <a href=\"https://twitter.com/johanneswagener\">Johannes Wagener</a> told me he was adding an <code class=\"language-text\">ontimedcomments</code> event to our <a href=\"https://developers.soundcloud.com/docs/javascript-sdk\">JS SDK</a>, I immediately began work on <a href=\"http://waveraid.com\">Wave Raid: Quest for the Timed Comment</a>.</p> \n<!-- more --> \n<p>&nbsp;</p> \n<h2>Pre Game</h2> \n<p>I’m fairly new to gaming, html5, canvas… pretty much everything used in building this hack. So Daniel X Moore’s <a href=\"http://www.html5rocks.com/en/tutorials/canvas/notearsgame/\">No Tears Guide to HTML5 Games</a> was an absolute godsend. It gives you an extremely solid base to develop HTML5 games while <strong>simultaneously</strong> explaining the basics of canvas. I wish more tutorials were written like this.</p> \n<p>&nbsp;</p> \n<h2>OnTimedComments</h2> \n<p>So, how does this <code class=\"language-text\">ontimedcomments</code> event work? Just add it as a function to your <code class=\"language-text\">SC.stream</code> event and tell your app what to do with the comment chunks as they come in. In my case, I’m creating coins (comments) to collect in game.</p> \n<p>Disclaimer: <a href=\"http://coffeescript.org\">CoffeeScript</a>:</p> \n<div class=\"gatsby-highlight\" data-language=\"coffeescript\"> \n <pre class=\"language-coffeescript\"><code class=\"language-coffeescript\"><span class=\"token constant\">SC</span><span class=\"token punctuation\">.</span>stream <span class=\"token constant\">TRACK_ID</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">ontimedcomments</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>comments<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token keyword\">for</span> comment <span class=\"token keyword\">in</span> comments\n            coin <span class=\"token operator\">=</span> <span class=\"token function\">Coin</span><span class=\"token punctuation\">(</span><span class=\"token property\">comment</span><span class=\"token punctuation\">:</span> comment<span class=\"token punctuation\">)</span>\n            coins<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>coin<span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>Simple? Yes, indeed. Just loop through the comments and do <em>whatever</em> you want with them. <strong>[nerdrant]</strong>I <em>may</em> even want to look at the comment user’s details and vary the coin’s properties. Maybe if the comment came from the track owner, it would be a power up or obstacle.<strong>[/nerdrant]</strong></p> \n<p>&nbsp;</p> \n<h2>Post Game</h2> \n<p>“That’s great Lee. but I’m not building a game.”</p> \n<p>OKAY <strong>:(</strong> … You can use <code class=\"language-text\">ontimedcomments</code> in all sorts of ways:</p> \n<ul> \n <li>Display comments in time with a playing track visualized in interesting ways. 3D, perhaps?</li> \n <li>Maybe your track has an accompanied transcript of timed comments. Wouldn’t it be nice to display those while the track is playing? Yes, it would!</li> \n <li>How about rich media content? Add some <em>photos</em> as timed comments to your track and then build an app that displays those in realtime. We used a similar technique on <a href=\"http://storywheel.cc\">Storywheel</a>.</li> \n</ul> \n<p>But don’t take my word for it. Get in there, build something awesome, and let us know about it. We’ll be waiting.</p>","descriptionType":"html","publishedDate":"Thu, 05 Apr 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/249e6/waveraid.png","linkMd5":"dbdef8361976c739b05fe4b0b6f36467","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn29@2020_2/2020/08/25/00-49-37-268_0df2a43177b2cc80.webp","destWidth":520,"destHeight":342,"sourceBytes":56735,"destBytes":37190,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/249e6/waveraid.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn29@2020_2/2020/08/25/00-49-37-268_0df2a43177b2cc80.webp"},"publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"A Pragmatic Approach to Tech Debt Reduction","link":"https://developers.soundcloud.com/blog/a-pragmatic-approach-to-tech-debt-reduction","description":"<p>Almost every company accumulates tech debt as time goes on. Tight deadlines, changing requirements, scaling issues, poor or short-sighted system designs, knowledge silos, inconsistent coding practices, turnover of key staff — these things all happen and can contribute to tech debt. So what can be done about it once it’s there?</p> \n<!-- more --> \n<h2>Background</h2> \n<p>My SoundCloud team, the Content Team, looks after a large number of legacy systems, along with a number of large systems that are difficult to understand and work with. Topics such as “Tech debt constantly increases development time” and “We have too much tech debt” come up frequently at our team retrospectives.</p> \n<p>We have just completed a project that was almost exclusively about tech debt reduction. This post is a series of lessons learned about how to engage in this process (and when to decide not to).</p> \n<h2>How Much Tech Debt is Too Much?</h2> \n<h3>The Tech Debt Tipping Point</h3> \n<p>A system with too much tech debt eventually becomes unmaintainable. Changes either take too long, are too difficult to test, or carry an unacceptably high risk of unintended consequences. The only way to extend the system is to add more tech debt. New feature development stops because the value gained is not proportional to the effort required.</p> \n<p>Bad experiences with the system breed reluctance to work with the system at all, institutional knowledge of it gradually erodes, upgrades are postponed or simply don’t happen, and eventually someone puts a comment in the system’s README file that says something like “Never change this system again.”</p> \n<h3>Everyday Productivity Losses</h3> \n<p>Even for systems that haven’t reached the maintainability tipping point, tech debt can cause constant issues and increase development time, developer stress, and potential bugs.</p> \n<p>A classic example of this problem is a test suite with one or more intermittently failing tests. Each individual case of the suite failing but then succeeding on rerun is minor, but the cumulative effect over weeks or months is far from minor. The time lost to reruns is an obvious consequence, but the erosion of confidence in the test suite can be even more damaging. True test failures will be hard to distinguish from the intermittent, “expected” failures, and the temptation to deploy with failing tests, or disable the test suite entirely, will grow.</p> \n<h2>Paying Down Tech Debt</h2> \n<p>We’ve seen above why tech debt is undesirable, but deciding what to do about it is not always easy. Here are a few possibilities.</p> \n<h3>Radical Action</h3> \n<h4>Full Rewrite</h4> \n<p>Much has been said about “the allure of the full rewrite.” It’s tempting because it solves every problem the current system has — but at the expense of introducing every problem the new system will have. Note that the two lists of problems do not have to be mutually exclusive!</p> \n<p>Starting over may well be the only option for systems that have passed the tech debt tipping point or for systems that are no longer fit for purpose because of fundamental design or scaling problems.</p> \n<p>Starting over is also a large, all-or-nothing commitment to launching a new system. It will bring no value at all if the project fails, stalls, or is canceled.</p> \n<h4>Full Deletion</h4> \n<p>This is a common option of last resort for unreliable tests. Tests that don’t reliably report on correctness and run in a reasonable amount of time are not useful and may in fact be a hindrance. If rewriting the tests is not possible, not having the tests at all may well be preferable.</p> \n<p>Needless to say, not having tests is generally not a good state of affairs to be in either.</p> \n<h3>Radical Inaction</h3> \n<p>A depressingly common approach is to do nothing and ignore the problem. This can stem from inexperience, a business strategy that demands new feature development at all costs, or simple wishful thinking. Regardless of the reason, persistent inaction tends to lead to the tech debt tipping point.</p> \n<h3>A Pragmatic Middle Way</h3> \n<p>First…</p> \n<h4>You Will Never Remove All the Tech Debt</h4> \n<p>This is an important thing to accept. No system is perfect, and attempts at perfection eventually reach a point where massive effort is necessary for very little gain. The goal should be a system that’s “good enough.”</p> \n<p>But…</p> \n<h4>You Should Remove the Important Tech Debt</h4> \n<p>The definition of “good enough” will vary from system to system (see below), but tech debt that prevents the system from fulfilling this definition is important tech debt that needs paying down.</p> \n<h4>How To Identify the Important Tech Debt</h4> \n<p>It’s helpful to ask yourself the following questions:</p> \n<ul> \n <li>How important is this system? What’s the business and operational impact of bugs, outages, or long development cycles?</li> \n <li>Is this system still fundamentally fit for purpose? Do we foresee (or are we currently experiencing) significant scaling problems that this system cannot surmount in its current form?</li> \n <li>Is this system easy to understand? Is it well documented?</li> \n <li>How often do we need to change or maintain this system? How much staff time do we lose per week/month/quarter because this system is hard to work with?</li> \n <li>Is this system reliant on external libraries or underlying technologies that are deprecated?</li> \n <li>How many people are comfortable working with this system? Is the company overly reliant on a small number of key people, without whom this system might hit the tech debt tipping point?</li> \n</ul> \n<h2>Case Study: Converting a Microservice to a Batch Pipeline</h2> \n<p>One of my team’s services had a long history of tech debt-related problems. When we got a request for several new features, we believed adding these features would push the system perilously close to the tech debt tipping point. The system was designed in a way that put heavy, ever-increasing load on its database. We knew this load would eventually become unmanageable and the proposed new features would only hasten this process. The system needed either a substantial design change or a wholesale replacement. Our ideas for design changes were risky and complex, and we felt more confident of success with a wholesale replacement system. In other words, we felt radical action was justified in this case.</p> \n<p>The replacement system is a batch pipeline that we built as a new component in a related system I’ll call Gulper. While the new component was essentially a greenfield project, it still had to integrate with other parts of Gulper. Gulper has not hit the tech debt tipping point, but as one of the team’s oldest and most complex systems, it is tech debt heavy and often hard to work with. In addition to adding the new component, we wanted to pay down some of Gulper’s tech debt in other areas, but we needed to balance that against our project deadlines.</p> \n<p>Gulper’s already existing acceptance tests proved to be a particular pain point. They often failed spuriously, they were written in a language different than that in the main code base, they used external resources in a way that meant only one instance of the tests could run at a time, and they ran incredibly slowly. These tests run before every Gulper deploy. At times during our project, there were three people changing and deploying Gulper multiple times a day. The acceptance tests were costing us as much as ten or fifteen staff hours a week. The idea of full deletion of these tests did cross our minds at one point, but instead we committed to heavily refactoring the tests, using a contract-driven approach to uncouple test execution from shared external resources and mitigate spurious failures. Given the huge amounts of staff time the tests’ tech debt was causing, it was clear these tests were nowhere near “good enough.” So spending the staff time to make them “good enough” made perfect sense.</p> \n<p>In contrast, we encountered a number of issues with Gulper’s data model that we decided to live with. Refactoring these would have been a major undertaking, and we didn’t believe the time spent would produce sufficient benefit, especially when weighed against our other priorities.</p> \n<p>In a nutshell, this project involved some radical action in the form of a full rewrite of one system, some less radical action in the form of a heavy test suite refactor in another system, and some calculated inaction in the form of choosing not to refactor the data model issues.</p> \n<h2>Conclusions</h2> \n<p>Identifying important tech debt is not always easy — it takes practice and can be heavily subjective and situation-dependent as well — but paying down important tech debt now may very well keep your systems from hitting the tech debt tipping point later. Conversely, spending too much time paying down unimportant tech debt impedes your ability to deliver features in a timely manner and can be immensely frustrating. As with so many things in life, the key is finding balance.</p>","descriptionType":"html","publishedDate":"Fri, 23 Nov 2018 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"c7699e1b41b7b92f7e87adeb7c68d98f","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569973},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Velocity Europe Birds of a Feather Meetup","link":"https://developers.soundcloud.com/blog/velocity-europe-birds-of-a-feather-meetup","description":"<p>With excitement building for the <a href=\"http://velocityconf.com/velocityeu/\">Velocity Conference</a> in Berlin, we are happy to announce a pre-event meet up on Monday, November 7 at the Betahaus in Berlin. The event will be a great opportunity for visitors of the Velocity conference to beat the jet lag with a day of networking and relaxed sessions and talks. To get everyone in the Berlin-state-of-mind, the evening will be capped with a party.</p> \n<p>Berlin has quickly established itself as one of Europe’s main technology hubs. There are a lot of web companies in Berlin which are part of a constantly growing and vibrant local web community. The location for the BoF, <a href=\"http://betahaus.de/\">Betahaus</a>, is a shared-office innovation-inducing place that is used by small and large startups as well as established organisations.</p> \n<p>Participation is free for Velocity Europe attendees. Non-Velocity attendees can pay 50 Euros to take part in the BoF event. The evening party is open to all and does not require registration.</p> \n<p>The pre-event will be organized as an open space or unconference with on-spot planning of the sessions. The event is limited to 150 participants who must register in advance. If the event is not sold out in advance, participants can show up at the door.</p> \n<p>At the Betahaus, we have 2 larger rooms and 4 smaller meeting rooms. We will hold presentations in the larger rooms and hold discussions in the meeting rooms. The meeting rooms for the discussion can hold up to 10 people. Anyone interested in speaking at the event can contact Eliot (eliot(at)soundcloud.com to submit a discussion topic.</p> \n<p>The day will close with an open party . Event participants will enjoy a dinner buffet &amp; free drinks at the after-event party.</p> \n<p>You can register for the event here: <a href=\"http://veubof2011.eventbrite.co.uk/\">http://veubof2011.eventbrite.co.uk/</a> (free for Velocity attendees / 50 Euros at the door for non-Velocity attendees)</p> \n<p>Outline agenda (subject to change):</p> \n<ul> \n <li>13:00: Arrive at Betahaus</li> \n <li>14:00: Event starts with welcoming remarks and the session planning</li> \n <li>15:15 – 16:15: Sessions 1 &amp; 2, each 30 minutes</li> \n <li>16:15 – 16:45: Coffee break</li> \n <li>16:45 – 17:45: Sessions 3 &amp; 4, each 30 minutes</li> \n <li>17:45 – 18:15: Wrap up</li> \n <li>18:30: Dinner buffet for event participants</li> \n <li>19:30: Open party</li> \n</ul> \n<p>Event location: Betahaus Prinzessinnenstraße 19-20 10969 Berlin <a href=\"http://maps.google.com/maps/place?cid=1623497807966887921\">Betahaus on Google Maps</a></p>","descriptionType":"html","publishedDate":"Thu, 27 Oct 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"c9e0637b6e163ca2c0f1b235be28cbd4","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"How to Reindex One Billion Documents in One Hour at SoundCloud","link":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud","description":"<p>In the past, the Search Team at SoundCloud had high lead times for making updates to Elasticsearch clusters, either during the implementation of a new feature or simply while fixing a bug. This was because both tasks require us to reindex our catalog from scratch, which means reindexing more than 720 million users, tracks, playlists, and albums. Altogether, this process took up to one week, though there was even one scenario where it almost took one month to roll out a bug fix.</p> \n<p>In this post, I would like to share the concrete Elasticsearch tweaks we made so that we can now reindex our entire catalog in one hour.</p> \n<!-- more --> \n<h2>Search at SoundCloud</h2> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 593px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/17b23d599c14549fa785e6603e0f4344/fe994/indexing_pipeline.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 114.67116357504217%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsSAAALEgHS3X78AAAE2UlEQVQ4y5VUe2xTVRg/7RgZMcYsyiOYkCgh8UUMEQhRoiIQNUQDfzhIhJgYH4mJun8M26IuwtTwEJDxGA5h7MHoHl3XdX2svX3eR9vb29ve9d6+aNeybt06tjE2mOvYjufe8nBjgn7/3O/7ne/73d853/kOAMiUJgVQmZtlDg6TT8MJOYQQbN+xDaCvTFzX4u0v0hFHBRMjFd44UUXwpg/BXevEVVJOnepiDjhRfVQsBPPtHhkpWD8LpJg7fZPXYHI8AeM3emD0egR6rhItX3zz5WIxRxTzEMGZSyefxjz6tyzerl8V2vr3RczmwzYEB3yQ6YnDZqNzqqmLmsaDA1k6fjObGO9DpI5jYt5ANplXcuC7B2QmWvcx3m0O0VFyPHU7Bn0J92iTrmEfwk6nbvdAnI9nlWYWttu4WTo+CslQ8o6QDsHulOdaVcO5p0QOJCan8odfSlcyMSoYGuRgp0OFkhjIJtwT5Ye+X+ONuyrTUwkopH3Tds4FyaB31p/kZvl+diY2wsPuXiaDtrs8txtTjnDj6+sLqKC9EZHcwgMWxuDUnOiwKd8U14iAZU96Kgkj1wPZq8OBaX/SORPO+GciQ4HJweleyPa49HfPe9Hw6HCeWq3ObXnre1uWNGpq1yJXPv9s6SjRGMqkoMnDQiVmhh12HLLJJPTGPUN6l3LNQ80Yhv1z4thoUG50a+WNmrp7nZNZWctXdJTSk7ydd0cIkhTw368YFM8SOuqJRDJRlk6nj8ViseL6+vonpYqq+lPAQGnkNS3VoKxi/33ydqtZUlzV6C1UWT2f/tncXqI0U982GZjXRNxN07vGx8fh2NgYHBkZgTiObwAL2e5PPgIOzgra7d2SSr2Tf1VpZg6UVpwovtBq/FFLBvZKjbDZixIJ1DRBkEhZlt0EHmcavPv+pVUayR1tOtOSe3FQEJ5PpVIKtGUTIr6IYdjyR5Kp7T6w/6cj6JxzU4Nia7vNt03yTUQe+L9Wp7aA6iYt2Pv511JcWdPSirA3RP9Cm0WeyWRk6MpIsy9+g8HgowmpSAaUHzl9f64NrjCmpYR3RL/N4pXrCT9wu92A53ngdDr/m0o0ag+6bvNtNLjD0oNAhTOyxxYXFhaCZ5Yuk/znVq8Gl7WOnDJ3+BUNETh5+Gzt4St68pTJG9sn4l109N9Jz9QoABPulfwOs1MWTd9cJI6UGJ9v1q+ouqzeWVx2cM+h05eKGnXEOhHvn4Byh4fPM+KM7O4IPkxM+hf86+L5QP7igoJ/xp02z9yxPVldB7hYWiIzUb6XuuMDP5O+cKXa6NgiYlYn+wKG07stpGezNP9bt+Yr2jq3U15+p9ZoWSViQu/oAzG1KgzYuWRe7lnnSsNDWRgcmIRGOjTz29mad0m+1xbN/AW55Chs1jsOtGGuzb6eYcinxqDNF7tReb7h7TkK6ztswOi5KhGqHVwpLqShPdA3zCTG4BUdcVTnCjk6KQESoUGoo4QhhZ4sNtBRqHOFb/n7bkOFDlfNIUSHDvSukCS5FaNfNjGxQZEskJ6CLSZ3SZc7cjw0NAN9vRMQ5WUbNPYPMDae5vonYWBgCqqsbOeC3UYFEunB4+dWIWV7lGZPUYeDW7psxcp8hYEqR3exrgPnDq5bv0mORKxD63+g9Vq13b9LrPsbi2gSFnHNxacAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Simplified view of the search indexing pipeline\" title=\"Simplified view of the search indexing pipeline\" src=\"https://developers.soundcloud.com/blog/static/17b23d599c14549fa785e6603e0f4344/fe994/indexing_pipeline.png\" srcset=\"/blog/static/17b23d599c14549fa785e6603e0f4344/9ec3c/indexing_pipeline.png 200w,\n/blog/static/17b23d599c14549fa785e6603e0f4344/c7805/indexing_pipeline.png 400w,\n/blog/static/17b23d599c14549fa785e6603e0f4344/fe994/indexing_pipeline.png 593w\" sizes=\"(max-width: 593px) 100vw, 593px\" loading=\"lazy\" /> </a> </span></p> \n<p>At SoundCloud, we use what is canonically known as <a href=\"http://milinda.pathirage.org/kappa-architecture.com/\">Kappa Architecture</a> for our search indexing pipeline. The main idea here is: have an immutable data store and stream data to auxiliary stores.</p> \n<p>So, how does this work? Once a user, for example, uploads a track or a playlist on SoundCloud, we receive a live update<sup><a href=\"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f1\">1</a></sup> in the <code class=\"language-text\">eventfeeder</code>. Then the <code class=\"language-text\">indexer</code> fetches the uploaded data<sup><a href=\"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f2\">2</a></sup> from our primary data source — MySQL — and creates a JSON document, which is published to Kafka. The Kafka topics have <a href=\"https://kafka.apache.org/0100/documentation.html#compaction\">log compaction</a> enabled, which means we will only retain the latest version of the documents. Finally, the <code class=\"language-text\">shipper</code> reads the JSON documents from Kafka and sends them to Elasticsearch via the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html\">bulk API</a>.</p> \n<p>Since we use Kafka to back the document storage, we can reindex a new cluster from scratch by simply resetting the Kafka consumer offset of the <code class=\"language-text\">shipper</code> component, i.e. replaying all stored messages in Kafka.</p> \n<h2>Elasticsearch Cluster Setup</h2> \n<p>As you can see in the diagram above, in order to have high availability and isolation of failures, we have three clusters running in production, all with the same dataset. Each cluster consists of 30 Elasticsearch nodes running on 30 boxes. As a general rule of thumb, we try to scale Elasticsearch horizontally instead of vertically, i.e. adding more boxes instead of running multiple Elasticsearch nodes on the same box. This <a href=\"https://www.elastic.co/de/elasticon/2015/sf/scaling-elasticsearch-for-production-at-verizon\">Elastic talk</a> provides a good explanation of why this is the case.</p> \n<p>Coming back to our setup, each box consists of:</p> \n<ul> \n <li>150GB SSD<sup><a href=\"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f3\">3</a></sup></li> \n <li>64GB RAM</li> \n <li>32 cores</li> \n</ul> \n<p>So in total, we have approximately 2TB RAM and 1,000 cores available to serve more than 1,000 search queries per second at peak time.</p> \n<h2>Our Secret Sauce for Fast Indexing</h2> \n<p>Now that you’re somewhat familiar with SoundCloud’s indexing pipeline, in this section, I’ll share the concrete Elasticsearch tweaks we implemented that contributed to our performance improvements.</p> \n<h3>Ingredients</h3> \n<ul> \n <li>Concurrent bulk API calls and large bulk size<br /></li> \n <li>Optimal primary shards count<br /></li> \n <li>Async translog setting<br /></li> \n <li>Turned off Elasticsearch refresh<br /></li> \n <li>Merging of Lucene segments<br /></li> \n <li>Faster replication settings<br /></li> \n</ul> \n<h3>Directions</h3> \n<p><strong>Bulk API</strong></p> \n<p>Make sure that the sending part (in our case, <code class=\"language-text\">shipper</code>) utilizes the maximum possible combination of bulk size and concurrent requests against the Elasticsearch bulk API. To find this exact sweet spot, try to <a href=\"https://www.elastic.co/guide/en/elasticsearch/guide/current/bulk.html#_how_big_is_too_big\">incrementally increase the batch size</a> until the indexing throughput no longer improves. Since finding the exact sweet spot is a process of trial and error, rinse and repeat!</p> \n<p><strong>Primary Shards</strong></p> \n<p>Note: The primary shard configuration is a static setting and must be specified during the index creation time.</p> \n<p>As a rule of thumb, the count of primary shards defines how well the indexing load is distributed on the available nodes.<sup><a href=\"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f4\">4</a></sup> Before we started our spike, we had 10 primary shards distributed on 30 Elasticsearch nodes. Yes, this doesn’t sound like a configuration, because effectively, only 10 machines would be utilized and the rest would be idling. But after changing the primary shard size to 30, we saw lots of improvement in the indexing throughput.</p> \n<p>…And do not forget to turn off shard replication during the actual reindex!</p> \n<p><strong>Translog</strong></p> \n<p>The translog in Elasticsearch is a write-ahead/action log which is needed because the actual internal Lucene commit operation (writing to disk) is an expensive operation due to it occurring synchronously <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-translog.html#index-modules-translog\">after every write request</a>. The log stores all indexing and delete requests made to Elasticsearch. Furthermore, it also helps with recovery from hardware crashes by replaying all recent acknowledged operations that were not part of the previous Lucene commit.</p> \n<p>By default, there is a synchronous <code class=\"language-text\">fsync</code> that takes place for each indexing request, and the client receives an acknowledgment afterward. But during the reindexing, we <em>usually</em> don’t need this guarantee and could simply restart the process in the case of a hardware failure.</p> \n<p>By setting <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-translog.html#_translog_settings\"><code class=\"language-text\">index.translog.durability</code> to <code class=\"language-text\">async</code></a>, both the <code class=\"language-text\">fsync</code> and the Lucene commit will now occur in the background, thereby making the reindexing a lot faster. Remember to set the durability back to the default <code class=\"language-text\">value(request)</code> once the bulk indexing is done. You can also enhance the flush threshold by changing <code class=\"language-text\">translog.flush_threshold_size</code>. In our setup, we’re using 2GB. The default value is 512MB.</p> \n<p><strong>Refresh Interval</strong></p> \n<p>As you may know, the <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/tune-for-indexing-speed.html#_disable_refresh_and_replicas_for_initial_loads\">refresh interval</a> in Elasticsearch directly controls when an indexed document will be searchable. Since there are no searches during the reindex, you can turn the refresh process off completely by setting the <code class=\"language-text\">refresh_interval</code> to <code class=\"language-text\">-1</code>.</p> \n<p>Note: The default refresh interval is one second.</p> \n<p><strong>Segment Merging</strong></p> \n<p>After the primary shards have been indexed, you may want to turn on shard replication next, but before doing so, allow Elasticsearch to merge Lucene segments via <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/master/indices-forcemerge.html\"><code class=\"language-text\">_forcemerge?max_num_segments</code></a>. In doing so, the index will be compactified before it is replicated, i.e. saving disk space. Currently, we’re investigating the ideal merging strategy in our setup. If you are curious how Lucene’s segment merging works, you can find a great visualization of it <a href=\"http://blog.mikemccandless.com/2011/02/visualizing-lucenes-segment-merges.html\">here</a>.</p> \n<p><strong>Replication</strong></p> \n<p>Now there’s only one last thing to do: Turn on shard replication! But before doing so, consider increasing the concurrent shard recoveries per node (default: 2) and the recovering network throttle (default: 20MB) by tweaking <code class=\"language-text\">cluster.routing.allocation.node_concurrent_recoveries</code> and <code class=\"language-text\">indices.recovery.max_bytes_per_sec</code>.</p> \n<p>In our setup, we are allowing 100 concurrent shard recoveries, and the <code class=\"language-text\">indices.recovery.max_bytes_per_sec</code> rate is set to 2GB. Make sure you revert it to the previous value before going live!</p> \n<h2>Nutrition Facts</h2> \n<h3>Indexing Throughput</h3> \n<h3>Before</h3> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/7c78f554adcf65b3c43aa5f7de99538a/473b4/indexing_before.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 47.473736868434216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABKUlEQVQoz3WR6XKDMAyEeZBOMYdPjDEBkh5JJ+//UlvJhkDb9Mc3EtJ6tZMUrdQoqwbiCaWoUTcSIUT4fkDdqjQT/+hFVaMwxkK2EqJuUT2Bha9lBUFGTdMmtgDbPpP7InQOTiu8lPRQNMn4KOpox/XcG9wnh9toYaR8GNaEVRKKZiW9Lzrn8BYsotMYrEoChpPwgZHm/HDqNC5kysZfo0sGPL9Rfz/lUKwvtLZYvCFTg/ch95/R4oP7Ps/YhHs2Za605+Ocno8wVqmcUGsWZvGJ0rAhMxOXkCsbzn5nS8uHZ6/TLNj852bDg3Dy24E9UWbVHLWH+TU6GPot14R0JS1Vqg+8/vn9m8P+zCmNQqHIcBkHIvxhGnrCr5WI/d6v8znmfhl7hM7iG/+5Cu0wmYNLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Indexing throughput before the performance tuning\" title=\"Indexing throughput before the performance tuning\" src=\"https://developers.soundcloud.com/blog/static/7c78f554adcf65b3c43aa5f7de99538a/8ff1e/indexing_before.png\" srcset=\"/blog/static/7c78f554adcf65b3c43aa5f7de99538a/9ec3c/indexing_before.png 200w,\n/blog/static/7c78f554adcf65b3c43aa5f7de99538a/c7805/indexing_before.png 400w,\n/blog/static/7c78f554adcf65b3c43aa5f7de99538a/8ff1e/indexing_before.png 800w,\n/blog/static/7c78f554adcf65b3c43aa5f7de99538a/6ff5e/indexing_before.png 1200w,\n/blog/static/7c78f554adcf65b3c43aa5f7de99538a/2f950/indexing_before.png 1600w,\n/blog/static/7c78f554adcf65b3c43aa5f7de99538a/473b4/indexing_before.png 1999w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h3>After</h3> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/ef09ec4a064d6973f1ad877baff77f7e/2f950/indexing_after.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 43.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAA4UlEQVQoz32RC27DIBBEuUnMZ5c1YOxUidIaJ/c/VgfjpFbdRhqtBos34EFpbY22nbanrs6ua94QSQjJOcaG/6Qi0zz4LNyEZfY8CbNzSDHGWUuYf0pdAt+zLIO/5yqYZZ0ly0fAsU6besiacoCvkbG7DFIADCu2GUEWLsJE7on94tUt+T38oywta8mC/8IFdQVoz6uvt3AziHiMMvWV31dQ4ZL8nBBfT5jTpvLym2F88UQn9PyCPyOvPT07G6U1dzSPOuXc4yG2FtQY+imGMYZzirmX5PmouPNZ0KInS3iCbwpeV5NVBr1jAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Indexing throughput after the performance tuning\" title=\"Indexing throughput after the performance tuning\" src=\"https://developers.soundcloud.com/blog/static/ef09ec4a064d6973f1ad877baff77f7e/8ff1e/indexing_after.png\" srcset=\"/blog/static/ef09ec4a064d6973f1ad877baff77f7e/9ec3c/indexing_after.png 200w,\n/blog/static/ef09ec4a064d6973f1ad877baff77f7e/c7805/indexing_after.png 400w,\n/blog/static/ef09ec4a064d6973f1ad877baff77f7e/8ff1e/indexing_after.png 800w,\n/blog/static/ef09ec4a064d6973f1ad877baff77f7e/6ff5e/indexing_after.png 1200w,\n/blog/static/ef09ec4a064d6973f1ad877baff77f7e/2f950/indexing_after.png 1600w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Including the long tail, the primary shard indexing takes around 30 minutes for more than 720 million documents, whereas it previously took three hours.</p> \n<h3>Search Latency</h3> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/73e66afa598fa581f386392d5d026075/d5c82/search_latency.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 63.13823163138231%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAACQ0lEQVQoz22S246bMBCGeYZdwMQYbGyDw8mQcAjkyGaXZjdZbaV2te0r9KKHq970tg/eSSpFvag0+gU/2PPrmzFshNHERQ62odDEth3bQlCW7VDGkzg9O+D/rwzGxQQ51o1l35oYE8JDFqdqVvFA+MRXqZ7qUojIJdQlPnb9CSbQzMEuqJGkWu1HMYzevOWb+/mXH92v3/23n0lZ8XyWHt/r1Tbi0nU9KLjdgYC2gy4ZDTVN5ttFe1g3D/1iXK6Om83TZv/2snh9rT99Xn/9Xo0HvRtk3fCiFLM50yVNM5ppmmQGpTwu4tmy0G3aDU29nm/G1XgaTh/G3dg9vuye306PH0/tvuvul81dV+9a3ZfVtknb3CCUqSjMdMkCSWmAEPb9wJkQzw9MG2LSs0PBcX2fXXx2fqbMtJBxBuBg0wZ6+MZEt9bkrKYNB5IkT5IsyzSAhV/NywiueqYdpzmjnk+w72HOPMm9SFIuQhUnYagiFWe5DiMFqKEpKDSDzn/VyPKirmW34E3F+oUchngc8/GuAJCexxgTkUqVSi6johj7yCGWjRFyISmMqmiW8WqIu7Va7ZLVPtuOxdNzfXiqHg758aS7Xuc6CaNARkyGjEs/4IQLuJgYQqok5brgwL+cy3kV9X0+7NuHsVtu9P1jc3xeje8Wiz7u+rjtpnUbwQbVbVjMAoP4VIZhlueQraoaFggBLQKhVEwIhd0KghA+YZcGgYTksLPAnDJhWo6BXYDPAD3nkgsJr/9StWx05Xyt627/AcKNdjm1DDAhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Search latency after the performance tuning\" title=\"Search latency after the performance tuning\" src=\"https://developers.soundcloud.com/blog/static/73e66afa598fa581f386392d5d026075/8ff1e/search_latency.png\" srcset=\"/blog/static/73e66afa598fa581f386392d5d026075/9ec3c/search_latency.png 200w,\n/blog/static/73e66afa598fa581f386392d5d026075/c7805/search_latency.png 400w,\n/blog/static/73e66afa598fa581f386392d5d026075/8ff1e/search_latency.png 800w,\n/blog/static/73e66afa598fa581f386392d5d026075/d5c82/search_latency.png 803w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Our search latency for 95 percent of all requests dropped to roughly 90ms<sup><a href=\"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f5\">5</a></sup> after rolling out the 30 primary shards configuration.</p> \n<p>Note that the listed tweaks above were used in Elasticsearch 5.6.10. Depending on your used version of Elasticsearch, the shown tweaks might not work or could end with slightly different results.</p> \n<h2>Summary</h2> \n<p>When we first made the above improvements, we only had two engineers working on the Search Team, and as such, the new lead time for bringing up new clusters enabled us to be much more productive: We could now start an A/B test, prepare a second one, mitigate a recent incident, and reindex a development cluster in one sprint, whereas previously we hardly had room for more than two indexing runs in the same time span!</p> \n<p>The shown performance improvements helped to cut down the reindexing time for new clusters from one week to one hour, thereby enabling the Search Team to perform more effectively. In addition, we simultaneously improved the search latency by four times for 95 percent of all search requests.</p> \n<blockquote> \n <p><em>If our search problems sound interesting to you, then feel free to apply for the currently <a href=\"https://soundcloud.com/jobs/2019-03-12-backend-engineer-f-m-d-berlin\">vacant backend engineer position</a> on the Search Team! We would also <strong>love</strong> to hear your stories about managing and working with Elasticsearch in production or, in general, any other search-related topic. Don’t hesitate to get in touch via <a href=\"https://twitter.com/bashlog\">@bashlog</a>.</em></p> \n</blockquote> \n<h2>Future Work</h2> \n<p>Our work doesn’t stop here. There are, of course, more improvement areas beyond what’s detailed above. In the near future, we plan to further investigate the following topics:</p> \n<p><strong>60 Primary Shards:</strong><br> During a small test, we could reach up to even 1 million indexing op/s with 60 primary shards. A load test is currently pending to verify that the search latency won’t be degraded by having 60 primary shards.</br></p> \n<p><strong>Segment Optimization:</strong><br> As explained in the segment merging section, we want to verify if having only one segment in the indexing process could eventually result in Lucene segments that are too large.</br></p> \n<p><strong>Smaller Clusters:</strong><br> Currently, we are running clusters with 30 nodes. Here we want to find out the minimum number of nodes necessary that will allow us to handle the same amount of requests, in addition to having the same indexing performance and search latency for users. Smaller clusters would drastically decrease our operational efforts.</br></p> \n<p><strong>Optimized Schema:</strong><br> We also want to investigate whether our current schema could be further optimized, e.g. removing unused fields or analyzers. This would make the indexing process faster, and it could also save space.</br></p> \n<h2>Bonus Material</h2> \n<h4><a href=\"http://www.safetydifferently.com/why-do-things-go-right\">Identify and Enhance the Capacities That Make Things Go Right</a></h4> \n<p>So, the bonus is the simple idea above, which I thought was worth sharing with you. Instead of the usual focus on <em>why do things go wrong?</em>, one should also ask the opposite question: <em>Why do things go right?</em></p> \n<p>By increasing the capacity of things that go right, we can automatically lower the chance that things <em>go wrong</em> in the first place. In terms of our situation described above, we proactively planned time to improve what was already working, and as a result, we made it a lot better.</p> \n<h2>TL;DR</h2> \n<p>In the past, the Search Team at SoundCloud had high lead times for reindexing Elasticsearch clusters. Recently, we optimized the time required for this task, bringing it down from one week to one hour.</p> \n<p>This post is a follow-up to a <a href=\"https://speakerdeck.com/qabbasi/how-to-reindex-1b-documents-in-1-hour\">Meetup talk</a> that Rene Treffer (Production Engineer at SoundCloud) and I gave last December at the Berlin Elasticsearch Meetup on the topic of the latest improvements in search.</p> \n<p><a name=\"f1\">1</a>: Our average live update rate is 50 documents per second.</p> \n<p><a name=\"f2\">2</a>: The data that we actually index in Elasticsearch is a small subset of what is available in MySQL, and it consists of basic fields such as title, description, and user.</p> \n<p><a name=\"f3\">3</a>: If you are also using SSDs, make sure your I/O scheduler is configured correctly. See <a href=\"https://www.elastic.co/guide/en/elasticsearch/guide/current/hardware.html#_disks\">here</a>.</p> \n<p><a name=\"f4\">4</a>: Likewise, you can increase the search throughput by increasing the replication. This, of course, makes it necessary to add additional nodes to the cluster.</p> \n<p><a name=\"f5\">5</a>: During peak time, the latency for the 95th quantile reaches up to 150ms.</p>","descriptionType":"html","publishedDate":"Thu, 21 Mar 2019 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/17b23d599c14549fa785e6603e0f4344/fe994/indexing_pipeline.png","linkMd5":"b48d9296f462bc043ccc5738e0ea3485","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn64@2020_5/2020/08/25/00-49-37-696_a4873881372b41f2.webp","destWidth":593,"destHeight":680,"sourceBytes":12538,"destBytes":34246,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/17b23d599c14549fa785e6603e0f4344/fe994/indexing_pipeline.png":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn64@2020_5/2020/08/25/00-49-37-696_a4873881372b41f2.webp","https://developers.soundcloud.com/blog/static/7c78f554adcf65b3c43aa5f7de99538a/8ff1e/indexing_before.png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn2@2020_5/2020/08/25/00-51-42-356_6d89dc4f639ba516.webp","https://developers.soundcloud.com/blog/static/ef09ec4a064d6973f1ad877baff77f7e/8ff1e/indexing_after.png":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn100@2020_4/2020/08/25/00-51-44-126_9d5e2b07dd661589.webp","https://developers.soundcloud.com/blog/static/73e66afa598fa581f386392d5d026075/8ff1e/search_latency.png":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn74@2020_4/2020/08/25/00-51-45-496_a746b8ca2378b473.webp"},"publishedOrCreatedDate":1598316569973},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Tenacious D's Fenix rizes with SoundCloud","link":"https://developers.soundcloud.com/blog/tenacious-d-s-fenix-rizes-with-soundcloud","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 550px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/abc0fb4d58b738f63ae37a9d59deff25/2cf63/fenix.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 72.72727272727273%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAADOElEQVQoz0WT22/TdhTH/T61oZcNBKzNhSZpm2Rpm8ZJbCe+/Rw7viWO7fpCVqdL2/QiZZlAqdZNGoKBBEjwwAMqFKTCNG1IICEEk5j2hAQPSNMe9jAh7WF/wPYvcChIO/rJb9/z/Z7POcZM0/R9f2Vl5Qt4q6uG79c0TdU1Wa7JsiwIAl2plMtlHMcXFhYymczMzMzU1FQkEgmHw5ht247j+J7XCoJuq9Xj2CVZNi3bdF213kBCtUIzFEUVCoXFxcVsNgv6ZDIZi8Wi0Si2dFiWaTZdd01Vbo59dP740d1YdC2d/qpzemu93dB1hkM8z0OLXC43Nzc3PT0dOywMbN+pbbDyOqpy65PhW9EjeyeHzo2O7nWkx9e6D6/1Lg8CyM+yLPiDeHZ2Nh6PQ/gPYse2Lc8LJPHu+PCT4sgjMnQ7cfQgf+x8JnzdJc9aBZphYPJisQjiVCoF5olE4kNsaNB0nM8ROggN7R8Zebp47O/B8Qf+xKWp0af1iUqWZBHPsSxJkvPz8+l0GsQw+f9icO4o8sHQ0E/xE39sRP7dP3EzCLez47/3p+9tOohDkiSVKQqYvxfD9x1tKNdZsnx/VVV++Dj0sv7pX73Ifz9OvujEv58c+W23/vLCl70qJah1jmWAGTCHhUEEzLKAtAnO74HdOzn8QEz+2T71z2Dy13LifmT8qs3strQdWzIMneN4giAAWz6fh+Gxer3eaDSAdtNx13XlxmRoLY/vK6XXRvJNL/ZmY+J5UHx8Z+fVo3Nntv0KzTEMQ9M0x3FgicECYIdyrdaw7HVDOUOPaXguKBAXGeKGmNnB43fb0vOfL75+duXCt12OF0SxCsN7ntftdrFSqQTbR4gXJcW3RK8xxmXTjWxOySzQ8RQZSXy3Yf5y/5uHe4Ov+4GsaHASrRZcY7C9vY3BALAAQUAMKxg6NVgOoWRSSMxW05/VcFxnmJUlre2qqiSoqqppGqR1XXdra6vf72P8YUF4usJWJcL3U4ikaggpsqzpOo8QQZaLJVKqyYBG13UQA+Pl5eXNzU1MOixgABFYhuORzPF8haZLBEGRZAHHCwUc/is4T0kUgW6z2YQW1WrVMIy3s6EP3M9L+GIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Rize of the Fenix\" title=\"Rize of the Fenix\" src=\"https://developers.soundcloud.com/blog/static/abc0fb4d58b738f63ae37a9d59deff25/2cf63/fenix.png\" srcset=\"/blog/static/abc0fb4d58b738f63ae37a9d59deff25/9ec3c/fenix.png 200w,\n/blog/static/abc0fb4d58b738f63ae37a9d59deff25/c7805/fenix.png 400w,\n/blog/static/abc0fb4d58b738f63ae37a9d59deff25/2cf63/fenix.png 550w\" sizes=\"(max-width: 550px) 100vw, 550px\" loading=\"lazy\" /> </a> </span></p> \n<p>This is not The Greatest Website in the World, no. This is just a tribute.</p> \n<p>I was approached by <a href=\"https://soundcloud.com/tenaciousd\">Tenacious D</a> a week ago with an incredible quest: raising a phallus shaped phoenix onto the internet (oh <em>and</em> the first clip of audio from their new record.) How could I raise this majestic beast with the power of SoundCloud’s legendary API? The answer was simple: Have the sound itself <strong>rize</strong> the phoenix from its ashes.</p> \n<!-- more --> \n<p>&nbsp;</p> \n<h3>The Journey Begins</h3> \n<p>I started my journey by creating a Photoshop layered version of the <em>then</em> flat painting. Using the ever faithful polygonal lasso tool, I sliced out all the typography. Next I reached for my eraser tool and carefully removed the background around all the fenixs’ <em>curvatures</em>. Finally, using the sorcery power of the stamp and patch tools, I was able to create backgrounds where they did not exist. <strong>Black magic?</strong> Yes sir.</p> \n<p>With the fenix now in ashes (layers), I quickly jumped into my Textmate editor in an effort to raise him. In addition to jQuery, I included the great knight, Johannes Wagener’s, powerful SoundCloud <a href=\"https://developers.soundcloud.com/docs/javascript-sdk\">Javascript SDK</a> which now includes the ability to stream sound. Incredible! I also chose to quicken my pursuits by relying on the genius of such great libraries as <a href=\"http://learnboost.github.com/stylus/\">Stylus</a>, <a href=\"http://visionmedia.github.com/nib/\">Nib</a>, and <a href=\"http://jade-lang.com/\">Jade</a>.</p> \n<p>Each fenix layer was placed into the painting frame as an absolutely positioned DIV. I was able to initially hide each of these layers out of view, because this was no ordinary frame - it had the magical CSS property of overflow equals hidden.</p> \n<p>&nbsp;</p> \n<h3>The Fenix Rizes</h3> \n<p>I then called on the power of the Javascript <a href=\"https://developers.soundcloud.com/docs/javascript-sdk\">SDK</a>, uttering:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\"> \n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token constant\">SC</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/tracks/35303281'</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>In a second, my website was filled with the glorious sounds of Tenacious D, but if I was going to control it I needed <a href=\"http://www.schillmania.com/projects/soundmanager2/\">SoundManager2’s</a> aide.</p> \n<p>Using the <em>whileplaying</em> function of SoundManager2, I created a <em>percent played</em> property that I would reference to raise each part of the fenix perfectly in sync with the sounds of the D. However, the wings were out of control, falling each time I attempted to revive the bird.</p> \n<p>All hope was lost, until I remembered SoundManager2’s ability to use the <em>peak data</em> of both the left and right channel of the incoming sound. I applied the fix as quickly as possible and soon the wings were glowing as if Jables were singing right through them.</p> \n<p>The Fenix had Rizen.</p> \n<p>&nbsp;</p> \n<h3>The Journey Ends</h3> \n<p>In an effort to let the kingdom know what had transpired I used another great feature of our Javascript <a href=\"https://developers.soundcloud.com/docs/javascript-sdk\">SDK</a>: Favoriting. With as little as three lines of coded runes, users were able to favorite the track on SoundCloud without ever having to leave the website.</p> \n<p>As so concludes my tale. If you yield a modern browser, you can rize the fenix for yourself at <a href=\"http://rizeofthefenix.com/\">rizeofthefenix.com</a>. If it’s not rizing quite right you can journey to SoundCloud to listen to the <a href=\"https://soundcloud.com/tenaciousd/rize\">track</a> instead.</p> \n<p>Until next time. Go with Courage and the SoundCloud API.</p>","descriptionType":"html","publishedDate":"Fri, 03 Feb 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/abc0fb4d58b738f63ae37a9d59deff25/2cf63/fenix.png","linkMd5":"e54bb8a516d9110ebfd156ddf5fc0626","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn14@2020_5/2020/08/25/00-49-38-580_391a653ed3d1e1b2.webp","destWidth":550,"destHeight":400,"sourceBytes":68328,"destBytes":20374,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/abc0fb4d58b738f63ae37a9d59deff25/2cf63/fenix.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn14@2020_5/2020/08/25/00-49-38-580_391a653ed3d1e1b2.webp"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Music Hack Day Barcelona","link":"https://developers.soundcloud.com/blog/music-hack-day-barcelona","description":"<p><a href=\"http://www.flickr.com/photos/thomasbonte/5044855904/\"><img src=\"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/eric-300x139.jpg\" alt=\"Team SoundCloud Hacking at Music Hack Day Barcelona\" title=\"eric mhd\" /></a></p> \n<p>Team SoundCloud hacking at Music Hack Day Barcelona</p> \n<p>Last weekend a team of SoundCloud attended <a href=\"http://bcn.musichackday.org/\">Music Hack Day Barcelona</a>. This blog post is going to talk about what a <a href=\"http://musichackday.org/\">Music Hack Day</a> is and how we experienced the one in Barcelona.</p> \n<p>At a <a href=\"http://musichackday.org/\">Music Hack Day</a> people from around the world gather to spend 24 hours hacking on music and tech. Projects can range from connecting APIs and creating new webapps to building new instruments or mashup audio. The first Music Hack Day happened in London in <a href=\"http://london.musichackday.org/2009/\">July 2009</a> and since then already Music Hack Days took place around the world in cities like <a href=\"http://berlin.musichackday.org/\">Berlin</a>, <a href=\"http://amsterdam.musichackday.org/\">Amsterdam</a>, <a href=\"http://boston.musichackday.org/\">Boston</a>, <a href=\"http://stockholm.musichackday.org/\">Stockholm</a> and<a href=\"http://sf.musichackday.org/\"> San Francisco</a>. A lot of cool projects were created and a lot of people had tons of fun together. If you don’t believe me, have a look at <a href=\"http://issuu.com/musichackday/docs/musichackdaylondon?mode=embed\">the newspaper</a> that was printed for the last Music Hack Day in London. The interviews on page 4 offer a great insight into the Music Hack Day ecosystem. All Music Hack Days are free for the participants and financed by sponsors. Free food and drinks is supplied for the hackers.</p> \n<p><a href=\"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/hackers.jpg\"><img src=\"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/hackers-300x131.jpg\" title=\"hackers\" /></a></p> \n<p>Hackers</p> \n<p>Music Hack Day Barcelona started for us with a flight from Berlin to Barcelona on Friday. Unfortunately we missed the traditional pre-hack-meet-and-drink that night. On Saturday the Hack Day was opened by a nice breakfast. Afterwards companies like <a href=\"http://www.last.fm/\">Last.fm</a>, <a href=\"http://www.musescore.com/\">MuseScore</a> and <a href=\"http://www.canoris.com/\">Canoris</a> <a href=\"http://wiki.musichackday.org/index.php?title=API_Schedule\">showcased their APIs</a>. After lunch the hacking started. This means that there is people staring at their laptop screens everywhere and in irregular intervals you hear somebody saying “This is so cool” or “What the fuck?”. We started hacking as well, i’ll talk about our projects later in this post. Fairly regular other hackers came to our table to get support for our API, grab stickers and a T-Shirt or just have a nice chat with us. And we love that!</p> \n<p><a href=\"http://www.flickr.com/photos/hermzz/5046837914/\"><img src=\"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/hackingz-300x150.jpg\" title=\"hackingz\" /></a></p> \n<p>Hackingz</p> \n<p><a href=\"http://www.flickr.com/photos/thomasbonte/5044610253/\"><img src=\"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/concert-300x130.jpg\" title=\"concert\" /></a></p> \n<p>Evening Concert</p> \n<p><a href=\"http://www.flickr.com/photos/thomasbonte/5046937182/\"><img src=\"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/sleeping-300x158.jpg\" title=\"sleeping\" /></a></p> \n<p>Sleepy Hacker</p> \n<p>After lunch concerts started outside which where a pleasant change to the hardcore hacking going on in the main hall. Some hackers stayed overnight, working on their hacks or just hanging around. Monday morning kicked-off with the realization that there were only six hours left to finish the hacks. Tension increased in the hall as everyone tried to get their hack in a demo-able state. In the end <a href=\"http://wiki.musichackday.org/index.php?title=Barcelona_Hacks\">34 hacks</a> were submitted. During the <a href=\"http://www.ustream.tv/recorded/9975355\">final presentations</a> the hackers got 5 minutes each to present their hack, which often was accompanied by a cheering crowd. Afterwards the best hacks were awarded with prices including tickets for Sonar and an iPad.</p> \n<p><a href=\"http://www.flickr.com/photos/thomasbonte/5043979038/\"><img src=\"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/presentations-300x120.jpg\" title=\"presentations\" /></a></p> \n<p>Preparing for Demos</p> \n<p>We presented three hacks:</p> \n<ul> \n <li><a href=\"http://wiki.musichackday.org/index.php?title=TopBillin\">Top Billin</a> – Who to follow on SoundCloud?</li> \n <li><a href=\"http://wiki.musichackday.org/index.php?title=SoundCloud_Social\">SoundCloud Social</a> – Synchronous listening to SoundCloud tracks and chat</li> \n <li><a href=\"http://wiki.musichackday.org/index.php?title=SoundCloudGmail\">SoundCloud Gmail Plugin</a> -Player for SoundCloud tracks in emails</li> \n</ul> \n<p>Our hacks are still in a very beta stadium. You can try them now, but expect proper announcements once we finished them.</p> \n<p><a href=\"http://www.flickr.com/photos/hermzz/5046214977/\"><img src=\"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/workshop-300x124.jpg\" title=\"workshop\" /></a></p> \n<p>Reactable Workshop</p> \n<p>Hacking is one aspect of a Music Hack Day. Another one is <a href=\"http://wiki.musichackday.org/index.php?title=Workshop_Schedule\">workshops</a>. People give in-depth presentations and offer hands-on workshops. Past topics include Arduino, Android Audio and a massive amount of incredibly cool APIs. And last but not least, a Music Hack Day is a great way to get to know cool and likeminded people. Everybody at a Music Hack Day is super-nice and very approachable. Everyone wants to share their knowledge and help-out each other. The atmosphere at a Music Hack Day sports a great community feeling.</p> \n<p><a href=\"http://www.flickr.com/photos/hermzz/5046837980/\"><img src=\"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/morehackingz-300x120.jpg\" title=\"morehackingz\" /></a></p> \n<p>Music Hack Day Equipment: Laptop/Internet/Drink/Food</p> \n<p>The next Music Hack Day will happen in <a href=\"http://boston.musichackday.org/\">Boston</a> next weekend. And be assured that more are currently in planning. Follow <a href=\"https://twitter.com/musichackday\">@musichackday</a> on Twitter for more announcements on that and subscribe to the <a href=\"http://musichackday.org/\">Music Hack Day main page’s</a> RSS feed. If you think your city deserves a Music Hack Day as well, then you should organize one! We will be there <img src=\"http://scbackstage.wpengine.netdna-cdn.com/wp-includes/images/smilies/icon_smile.gif\" alt=\":)\" /></p> \n<p><em>Photos by <a href=\"http://www.flickr.com/photos/thomasbonte/\">thomasbonte</a> and <a href=\"http://www.flickr.com/photos/hermzz/\">hermzz</a> under <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">cc-by-sa</a></em></p>","descriptionType":"html","publishedDate":"Fri, 08 Oct 2010 00:00:00 +0000","feedId":10291,"bgimg":"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/eric-300x139.jpg","linkMd5":"234d9c7ffa6c94852e3918a79bfb52e2","author":"","articleImgCdnMap":{"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/eric-300x139.jpg":null,"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/hackers-300x131.jpg":null,"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/hackingz-300x150.jpg":null,"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/concert-300x130.jpg":null,"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/sleeping-300x158.jpg":null,"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/presentations-300x120.jpg":null,"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/workshop-300x124.jpg":null,"http://scbackstage.wpengine.netdna-cdn.com/wp-content/uploads/2010/10/morehackingz-300x120.jpg":null,"http://scbackstage.wpengine.netdna-cdn.com/wp-includes/images/smilies/icon_smile.gif":null},"publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Gradle Remote Build Cache Misses","link":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses","description":"<p>Until recently, one of the top technical risks facing SoundCloud’s Android team was increasing build times. Our engineering leadership was well aware of the problem, and it was highlighted in our company’s quarterly goals and objectives as <em>modularization</em>. Faster build times means more productive developers. More productive developers are happier and can iterate on products more quickly.</p> \n<p>Modularization is key to decreasing build times, but avoiding work is another important part of the puzzle, and build caching is one way to avoid that work. Gradle, our tool for building Android, has a local file system cache that reuses outputs of previously performed tasks. We have been using the <a href=\"https://proandroiddev.com/speed-up-your-build-with-gradle-remote-build-cache-2ee9bfa4e18\">Gradle remote build cache</a> in order to save our developers’ time. It helps us avoid redoing work that other teammates have already done or switching to old branches. However, to get the full benefits of caching, you have to go beyond simply setting it up.</p> \n<!-- more --> \n<p>This is the story about how we solved some cache misses with our remote build cache and, in turn, saved our developers’ time. Maybe some of these tips can help you and your team save some time as well. This is part one of two. More cache misses and results will come in part two.</p> \n<h2>Tasks and Caching</h2> \n<p>A task is an amount of work with inputs and outputs, and the remote build cache works by storing the outputs of Gradle tasks. If all the inputs are the same, we can skip the work and just reuse the outputs.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/8f009accc900f96648f1252ab248035a/640e4/image2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 36.427732079905994%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABXklEQVQoz2NgYGDgAWI2IBYFYnMg1gNiQQYCgJmdiwtIsUMxK7KcIhBrA7E1EIeBaEYWNnGQRNv//2yu878GO877EeQ8/3uQ87xvIZ7L/vtoRPeA5N0YGJm8gbQPEMtAzRJBNpgDiLmBWIWZnVsTSOso+pT5ey79999/xb//Psv+/PdZ8f+/+8IfP226ruqDfMXCJSAPpI2gvgKJOYMMYsLhK2kxh8ywoBV/fk88/ut//d6ffxv2//kfuPzXRxmvsmCgvC4rt6AM1Lvs6Jo5gZgXiIWBWIOZjQsUBKoyjqkRHot+/PZZ/OMPEP/yXfLjH5D/XjNhihPIm8zsPCCfaED1icPCUgeI1YHYHog9QM5nZGKWAkn8//+fwXX+dwuHud/NQdh+7ncLl/nfTI/8/88MkgeGNT/UIUpA7A4NNrDrGKCxbQvEZlBFYD24YpmRmVUASAUAsRc0YkCphAEAOJRdBVsH8ekAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Gradle Task Diagram\" title=\"Gradle Task Diagram\" src=\"https://developers.soundcloud.com/blog/static/8f009accc900f96648f1252ab248035a/8ff1e/image2.png\" srcset=\"/blog/static/8f009accc900f96648f1252ab248035a/9ec3c/image2.png 200w,\n/blog/static/8f009accc900f96648f1252ab248035a/c7805/image2.png 400w,\n/blog/static/8f009accc900f96648f1252ab248035a/8ff1e/image2.png 800w,\n/blog/static/8f009accc900f96648f1252ab248035a/640e4/image2.png 851w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>For example, in the <a href=\"https://docs.gradle.org/current/dsl/org.gradle.api.tasks.compile.JavaCompile.html\"><code class=\"language-text\">JavaCompile</code></a> task, the inputs are Java files such as <code class=\"language-text\">Audio.java</code> and <code class=\"language-text\">Waveform.java</code>, and the outputs of the compile task are the compiled class files such as <code class=\"language-text\">Audio.class</code> and <code class=\"language-text\">Waveform.class</code>. If we haven’t added any new Java files or changed any of the contents of the Java files, we can reuse the output of the previous <code class=\"language-text\">JavaCompile</code> task.</p> \n<p>To determine that none of the inputs have changed, Gradle computes a build cache key, which uniquely identifies a task. It is computed based on the list of inputs and outputs for that task. Gradle then packs and stores the outputs of cacheable tasks in the Gradle build cache. A cache is simply a store of the build cache keys and the outputs. The cache can be local (file system) or remote (http).</p> \n<h2>Comparing Builds</h2> \n<p>A cache miss occurs when Gradle can’t find a corresponding entry for a task that should have been cacheable. To identify build cache misses, we use Gradle Enterprise build scans. Gradle Enterprise identifies cache misses by recording the inputs to a Gradle task, which can then be used <a href=\"https://docs.gradle.com/enterprise/tutorials/task-inputs-comparison/\">to compare two builds</a>. Here is an example of the same exact build on the same computer but with a whitespace added to a specific file:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/a6404/image3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.412060301507537%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAtElEQVQY01WPOw4CMQxE9/5n4gg01NQI0JJN4vyVz2B7RUGkJ0v2ZOzZWiM831c48jg8wTiHUgpqrcqcE/LWWn/03lX300qV3sYzlDox+GOJEWQtcs5orWGMoYY/xEgrzqf9dc5EK/NNXHmkAve64XG/wLqAwOZiLKSUEVOC916hEPmIqkuFOeXqc8FWa+O4AZ6hyLHdB8dhFTERs1I4EusiL0ncCyHAcpJ932GMARFp7N4HvldXNv6ee803AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"BuildConfig comparison\" title=\"BuildConfig comparison\" src=\"https://developers.soundcloud.com/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/8ff1e/image3.png\" srcset=\"/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/9ec3c/image3.png 200w,\n/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/c7805/image3.png 400w,\n/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/8ff1e/image3.png 800w,\n/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/6ff5e/image3.png 1200w,\n/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/2f950/image3.png 1600w,\n/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/a6404/image3.png 1990w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>From this, we can gather that whitespace in Java source files is treated as part of the input’s cache key. Gradle must re-execute this task if any of the whitespace in any of the inputs changes, which is unnecessary.</p> \n<h2>BuildConfig Misses</h2> \n<p>We can also use Gradle Enterprise to compare the same task running locally vs. in our build seed cache. In order for the remote cache to work, the inputs to the tasks between the local machine and the remote machine must match.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/298e897fb464f06b1d46b431500d0140/a987b/image5.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 21.770833333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAoUlEQVQY01VPCQ7DMAjr/19atVnuNHc9HGnVimSBwBiz3fcNHyJ6H8g5w4WAlNKqe+/g/BdjjBf+Z4w5J7ba2hIjrivjPE8cxyFZQWsDYy2M8wKHIMesZCew0vfey84l4nMdoMbWRPBQHyhZJklrvYhcpNPWOng0xoh936GUgjFm8ShWSn0cP4IhJsR0yZtFCOVxTFCQrxOc19pejtgn54cv/783SeEU2eAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Gradle Task Diagram\" title=\"Gradle Task Diagram\" src=\"https://developers.soundcloud.com/blog/static/298e897fb464f06b1d46b431500d0140/8ff1e/image5.png\" srcset=\"/blog/static/298e897fb464f06b1d46b431500d0140/9ec3c/image5.png 200w,\n/blog/static/298e897fb464f06b1d46b431500d0140/c7805/image5.png 400w,\n/blog/static/298e897fb464f06b1d46b431500d0140/8ff1e/image5.png 800w,\n/blog/static/298e897fb464f06b1d46b431500d0140/6ff5e/image5.png 1200w,\n/blog/static/298e897fb464f06b1d46b431500d0140/2f950/image5.png 1600w,\n/blog/static/298e897fb464f06b1d46b431500d0140/a987b/image5.png 1920w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>The <code class=\"language-text\">BuildConfig</code> is a file in Android builds used to keep environment and configuration constants. Here is a sample <code class=\"language-text\">BuildConfig</code> class, and as you can see, all the values are constants:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">public final class BuildConfig {\n    public static final boolean DEBUG = Boolean.parseBoolean(\"true\");\n    public static final String APPLICATION_ID = \"com.soundcloud.android\";\n    public static final String BUILD_TYPE = \"debug\";\n    public static final int VERSION_CODE = -1;\n    public static final int TEST_RETRY_COUNT = 0;\n}</code></pre> \n</div> \n<p>However, the constants can be set by functions, which may be different depending on the environment:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">afterEvaluate {\n  android.libraryVariants.all { variant -&gt;\n    variant.resValue \"bool\", \"analytics_enabled\", \"true\"\n    variant.resValue \"bool\", \"verbose_logging\", \"false\"\n    variant.buildConfigField \"int\", \"TEST_RETRY_COUNT\", \"${getRetryCount()}\"\n  }\n}</code></pre> \n</div> \n<p>In our case, the <code class=\"language-text\">TEST_RETRY_COUNT</code> class was being set by a function, <code class=\"language-text\">getRetryCount()</code>. This function was very simple, but it led to different values locally vs. on the CI server:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">private static int getRetryCount() {\n  if (isCI) {\n    return 1\n  } else {\n    return 0\n  }\n}</code></pre> \n</div> \n<p>Since the value was always <code class=\"language-text\">0</code> locally and <code class=\"language-text\">1</code> on the CI server, we could not reuse the outputs of this task with CI for local builds. Unfortunately, this was in one of the largest modules in our codebase, which meant a large portion of our code would have had to be recompiled, even if it didn’t need to be.</p> \n<p>Our solution was to remove this check from our build configuration and instead check it at runtime. For this case, we could determine at runtime if we were running on the CI server or not:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">class ActivityTest&lt;T : Activity&gt; constructor(activityClass: Class&lt;T&gt;) {\n\n  val isRunningOnTestLab = Settings.System.getString(contentResolver, \"firebase.test.lab\") == \"true\"\n\n  @JvmField\n  val retryRule = RetryRule(if (isRunningOnTestLab) 1 else 0)\n}</code></pre> \n</div> \n<h2>Kotlin Compiler Flags</h2> \n<p>We also noticed that all of our Kotlin compile tasks were not pulling anything from the cache. Since we use Kotlin in nearly every module, this meant we were pulling almost nothing from the Gradle cache.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/7d8143c091a260f7e2d789924aa10c89/774fc/image1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.728813559322035%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABoklEQVQoz2VSi3KbMBD0//9ex5mmcWK3NrYAPUBvBHh7J+y2STWz6HGn1e2xu5Qycs4IMcGHCOfDHwTaT1P5gukLtrNSCu73O3ajddBmwOUqcDo3aG4CvVTopITSBoWTn5czrwtK/h+ZYutKhJkSFRFyddZ7jCEjljvCtMLnBS7NsHFGoHWcC+xEKqb0CZ6wrMtWYSSpV9FRRaqWfREa348C71eNl8MZ+7czvr3+xOtHgx+/TtgfD3g5HbD/eKs4igYX3SOmtBFyD5iwES16pTEOBkZrWGuhlawwWpHcRGsFcbtBST7XFYbasswLlmUhySt2pcxoKaHtZZUeY6iX6TnQ5+9MI9MP9M5jJiV1cHjdYkxWCSMlMRH3L1DZI/VLuQJlJ8gxQ9LcDVQdzZZ6paKrkMF+QpnnTTKz3roeHZXP8ltpcLy0aKRFbxzBVwwu02MBvTX0yIB+NHXN0P8SLkQoSK54SHZ2hB036emBnGKVFUPAyI4g2YlcURG3GJNVyYlMzT5kWEq05EtPps4P03KPn7Oj+DCM1fC8Z1c84wz24W/SPgIQHrD1FQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"KotlinCompile comparison\" title=\"KotlinCompile comparison\" src=\"https://developers.soundcloud.com/blog/static/7d8143c091a260f7e2d789924aa10c89/8ff1e/image1.png\" srcset=\"/blog/static/7d8143c091a260f7e2d789924aa10c89/9ec3c/image1.png 200w,\n/blog/static/7d8143c091a260f7e2d789924aa10c89/c7805/image1.png 400w,\n/blog/static/7d8143c091a260f7e2d789924aa10c89/8ff1e/image1.png 800w,\n/blog/static/7d8143c091a260f7e2d789924aa10c89/6ff5e/image1.png 1200w,\n/blog/static/7d8143c091a260f7e2d789924aa10c89/774fc/image1.png 1416w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>We looked at the <a href=\"https://github.com/JetBrains/kotlin/blob/deb416484c5128a6f4bc76c39a3d9878b38cec8c/libraries/tools/kotlin-gradle-plugin/src/main/kotlin/org/jetbrains/kotlin/gradle/tasks/Tasks.kt#L387\">source of <code class=\"language-text\">KotlinCompile</code></a> to understand what <code class=\"language-text\">incremental</code> (shown above) was and what it did. <code class=\"language-text\">incremental</code> is <code class=\"language-text\">true</code> by default, but it took us a while to realize that we had disabled incremental compilation for all our CI tasks.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/a78b43f8beffe810a9bf35527f8eb21d/1002f/image4.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 38.52080123266563%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABVklEQVQoz4WSWXLDIBBEdf8rZnFsa0MLMjsCSZ0WdvKVqlC86gGaERqozEPDWQcXIrSxUNo8Ufo3PueXh4Kh72d8EuKKNWWSXppRTdcbZD9AWY+269G0XdG6aSGGsei9bvBFX9cL6h01PafPOo+Ut5IovaguywGhE7pZQdqESQfMdkUvebqwwW+AI0UzdX/GXALtsOsBHfbi1aRqZITUEZOYsUiNx8NiZjyOEkZ7eBvgqNYE2FO5rpTjHg9JnZWFjRnsCPlAhWPDkROSEEjThMhfCfcaeRwR+h7L7Q7LEmSlCmkYYOiVy8KPjhCM1zWitIMJmRj7viOyXieeNVulhGfdLGvWcsMwS/zXjpdWkReS5gX+4wJ/uT7hBZzq3j/RvL2juXxhnWbsxmHnRfywvShjHwpVaLpiDm2PM3kUPGXdwt9qeM5JIlgCw3Hm08l8Llnbp/7BNxT9ZW4VkUlzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"gradle.properties\" title=\"gradle.properties\" src=\"https://developers.soundcloud.com/blog/static/a78b43f8beffe810a9bf35527f8eb21d/8ff1e/image4.png\" srcset=\"/blog/static/a78b43f8beffe810a9bf35527f8eb21d/9ec3c/image4.png 200w,\n/blog/static/a78b43f8beffe810a9bf35527f8eb21d/c7805/image4.png 400w,\n/blog/static/a78b43f8beffe810a9bf35527f8eb21d/8ff1e/image4.png 800w,\n/blog/static/a78b43f8beffe810a9bf35527f8eb21d/6ff5e/image4.png 1200w,\n/blog/static/a78b43f8beffe810a9bf35527f8eb21d/1002f/image4.png 1298w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>We turned incremental compilation back on for our CI nodes that seed our build cache and immediately saw a big boost in cache hits. More cache hits meant less time spent building something that was already built.</p> \n<h2>Conclusion</h2> \n<p>In the end, we learned that simply turning on a remote build cache is not very effective in improving build speeds. In fact, blindly turning it on might not get any cache hits at all. It is important to keep in mind how tasks work, how they behave on different systems, and how to use the right tools to analyze differences in task inputs across different systems. That’s how we solved some cache misses with our remote build cache and, in turn, saved our developers’ time. Maybe some of these tips can help you and your team save some time as well.</p> \n<p>In part two, we’ll dive into more complicated cache misses and talk more about the impact of solving them.</p> \n<p>In the meantime, if you’d like to learn more, check out “Remote Build Cache Misses” from <a href=\"https://www.meetup.com/berlindroid/events/259762503/\">BerlinDroid Gradle Night</a>. You can <a href=\"https://youtu.be/2frfDMJwvf4?t=384\">watch the talk</a> or <a href=\"https://speakerdeck.com/runningcode/remote-build-cache-misses-and-how-to-solve-them-by-annoying-your-colleagues\">browse the slides</a>.</p>","descriptionType":"html","publishedDate":"Fri, 30 Aug 2019 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/8f009accc900f96648f1252ab248035a/8ff1e/image2.png","linkMd5":"85a241edadbd6592e8ed62c076621a0a","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn61@2020_5/2020/08/25/00-49-39-225_232b54a6c4d38f51.webp","destWidth":800,"destHeight":291,"sourceBytes":10325,"destBytes":24406,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/8f009accc900f96648f1252ab248035a/8ff1e/image2.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn61@2020_5/2020/08/25/00-49-39-225_232b54a6c4d38f51.webp","https://developers.soundcloud.com/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/8ff1e/image3.png":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn91@2020_1/2020/08/25/00-51-44-179_2492faff053cb4be.webp","https://developers.soundcloud.com/blog/static/298e897fb464f06b1d46b431500d0140/8ff1e/image5.png":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn89@2020_3/2020/08/25/00-51-40-303_b1715cd77c5dc61e.webp","https://developers.soundcloud.com/blog/static/7d8143c091a260f7e2d789924aa10c89/8ff1e/image1.png":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn21@2020_5/2020/08/25/00-51-41-925_7f423c9755f48bc7.webp","https://developers.soundcloud.com/blog/static/a78b43f8beffe810a9bf35527f8eb21d/8ff1e/image4.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn95@2020_6/2020/08/25/00-51-44-252_153e83c3f1f0cae7.webp"},"publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Announcing new Python SDK","link":"https://developers.soundcloud.com/blog/announcing-new-python-sdk","description":"<p>It’s no secret that SoundCloud is a Ruby shop, but that doesn’t stop us from giving some love to the Pythonistas in our community.</p> \n<p>Our old Python API wrapper has been neglected. It doesn’t support OAuth 2 or all of the resources made available by our API. It’s old and crufty and we’re sorry for letting it get that way. In order to make it up to you, we wrote a new one and made it much better.</p> \n<!-- more --> \n<p>Our new Python SDK has an interface that should be very familiar to anyone who has used our Ruby or JS SDKs:</p> \n<div class=\"gatsby-highlight\" data-language=\"python\">\n <pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> soundcloud\n\n<span class=\"token comment\"># Create a new client that uses the user credentials oauth flow</span>\nclient <span class=\"token operator\">=</span> soundcloud<span class=\"token punctuation\">.</span>Client<span class=\"token punctuation\">(</span>client_id<span class=\"token operator\">=</span><span class=\"token string\">'YOUR_CLIENT_ID'</span><span class=\"token punctuation\">,</span>\n                           client_secret<span class=\"token operator\">=</span><span class=\"token string\">'YOUR_CLIENT_SECRET'</span><span class=\"token punctuation\">,</span>\n                           username<span class=\"token operator\">=</span><span class=\"token string\">'YOUR_USERNAME'</span><span class=\"token punctuation\">,</span>\n                           password<span class=\"token operator\">=</span><span class=\"token string\">'YOUR_PASSWORD'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># print the username of the authorized user</span>\n<span class=\"token keyword\">print</span> client<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'/me'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>username</code></pre>\n</div> \n<p>It is available on <a href=\"http://pypi.python.org/pypi/soundcloud/\">PyPi</a>, so you can install it using easy_install, or better yet, <a href=\"http://www.pip-installer.org/en/latest/index.html\">pip</a>. The source code is available on <a href=\"https://github.com/soundcloud/soundcloud-python\">GitHub</a>, contributions of all kind are very welcome.</p> \n<p>If you want to give it a whirl, you can install it from PyPi and take a look at the examples in the <a href=\"https://github.com/soundcloud/soundcloud-python/blob/master/README.rst\">README</a> file. As always, let us know if you’re building something cool, we’d love to hear about it!</p>","descriptionType":"html","publishedDate":"Tue, 06 Mar 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"f53844dc845b4eed60e82cacee9acb60","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Mobile: Unit Testing","link":"https://developers.soundcloud.com/blog/mobile-unit-testing","description":"<p>When we started the Mobile project early 2011, unit testing JavaScript was one of the goals to tackle on the&nbsp;technical side. The history of custom JavaScript code at SoundCloud up until then rarely included unit tests,&nbsp;so providing references and the necessary ground research was important for both the project at hand as well&nbsp;as for other projects at SoundCloud.</p> \n<p>This articles aims to provide an overview of the tools we use, what worked well and what we need to improve.</p> \n<h2>Tools</h2> \n<p>When we started the Mobile project, there were just two developers on the team, <a href=\"https://soundcloud.com/matas\">Matas</a> and <a href=\"http://bassistance.de\">Jörn</a>. With Jörn already maintaining and&nbsp;supporting <a href=\"http://docs.jquery.com/QUnit\">QUnit</a> for three years, this particular choice was an easy one. If you haven’t yet heard of it:&nbsp;Among available unit testing frameworks, QUnit is among the most popular ones. There’s a <a href=\"http://msdn.microsoft.com/en-us/scriptjunkie/gg749824.aspx\">comprehensive tutorial over at&nbsp;ScriptJunkie</a>.</p> \n<p>As we were building an API client in the browser, mocking API requests was really important for us. We didn’t want to depend on the&nbsp;API being available, both to be able to work offline and to not depend on data that changes all the time. At the start of the project,&nbsp;jQuery 1.5 and its ajax extension points like custom transports weren’t available yet, so we went with <a href=\"https://github.com/appendto/jquery-mockjax\">mockjax</a>, a library&nbsp;adding mocking on top of jQuery’s ajax module.</p> \n<p>To run tests in continuous integration systems (at SoundCloud, on Jenkins), we looked at quite a lot of options. Jörn has <a href=\"http://jquery.bassistance.de/webtesting/presentation.html#slide4\">some slides&nbsp;that give an overview of that research</a>. Other teams at SoundCloud use <a href=\"http://seleniumhq.org/\">Selenium</a>, which wasn’t an option for us due to the&nbsp;lack of support for Chrome or Safari (which is still a work in progress). In the end we went with <a href=\"http://www.phantomjs.org\">PhantomJS</a>. PhantomJS is built on top&nbsp;of Qt-WebKit, provides a reasonable browser-like environment and enough API to run our unit tests and report back results.</p> \n<p>We considered using TestSwarm to distribute running of our unit tests to regular desktop browsers as well as mobile devices. The lack&nbsp;of a Jenkins-TestSwarm plugin (<a href=\"https://github.com/appendTo/Jenkins-TestSwarm\">now actually available</a>) as well as tools for managing&nbsp;VMs, browsers, simulators and emulators (or even managing mobile devices) was enough of a hurdle that we skipped this. Until we get this&nbsp;in place, we won’t know how many bugs we could have catched earlier with this additional setup.</p> \n<h2>The Good</h2> \n<p>QUnit does a pretty good job. The few small issues we encountered were swiftly fixed upstream. We ended up customizing the&nbsp;<a href=\"http://docs.jquery.com/QUnit/module\">module-method</a> quite heavily, mostly to integrate Mockjax. Overall, Mockjax also did a pretty&nbsp;good job, once we figured out a pattern that worked for us. Here’s a typical module-call for testing Backbone Views and Models that&nbsp;fetch their data from the API:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">module</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"/users/183/tracks\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/fixtures/forss-tracks.json\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"/users/183/playlists\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/fixtures/forss-playlists.json\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"/users/183/favorites\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/fixtures/forss-favorites.json\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"/users/183/groups\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"/fixtures/forss-groups.json\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>We still call the module-method with the module-name as the first argument. The second argument can contain setup- and teardown-properties,&nbsp;just like QUnit expects it. In addition, we pass url-mock pairs, which are passed on to $.mockjax. In addition to those, we define a&nbsp;catch-all to make sure that no test ever ends up calling the actual API. And we have a global timeout for each test to ensure a broken async test never prevents the suite from finishing.</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> testTimeout<span class=\"token punctuation\">;</span>\n<span class=\"token function-variable function\">module</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">,</span> mocks</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  QUnit<span class=\"token punctuation\">.</span><span class=\"token function\">module</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">setup</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mocks<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mocks<span class=\"token punctuation\">.</span>setup<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          mocks<span class=\"token punctuation\">.</span><span class=\"token function\">setup</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        $<span class=\"token punctuation\">.</span><span class=\"token function\">each</span><span class=\"token punctuation\">(</span>mocks<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url<span class=\"token punctuation\">,</span> mock</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token regex\">/setup|teardown/</span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> $<span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span>mock<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">\"string\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            $<span class=\"token punctuation\">.</span><span class=\"token function\">mockjax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              url<span class=\"token punctuation\">:</span> <span class=\"token string\">\"/_api\"</span> <span class=\"token operator\">+</span> url<span class=\"token punctuation\">,</span>\n              proxy<span class=\"token punctuation\">:</span> mock<span class=\"token punctuation\">,</span>\n              responseTime<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            $<span class=\"token punctuation\">.</span><span class=\"token function\">mockjax</span><span class=\"token punctuation\">(</span>$<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>mock<span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span>url<span class=\"token punctuation\">:</span> <span class=\"token string\">\"/_api\"</span> <span class=\"token operator\">+</span> url<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      $<span class=\"token punctuation\">.</span><span class=\"token function\">mockjax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        url<span class=\"token punctuation\">:</span> <span class=\"token string\">\"/_api*\"</span><span class=\"token punctuation\">,</span>\n        responseTime<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">response</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">obj</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">var</span> message <span class=\"token operator\">=</span> <span class=\"token string\">\"Mockjax caught unmocked API call for url: \"</span> <span class=\"token operator\">+</span> obj<span class=\"token punctuation\">.</span>url\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">.</span>modelType<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            message <span class=\"token operator\">+=</span> <span class=\"token string\">\", from component \"</span> <span class=\"token operator\">+</span> obj<span class=\"token punctuation\">.</span>modelType<span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token function\">ok</span><span class=\"token punctuation\">(</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> message <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      testTimeout <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">equal</span><span class=\"token punctuation\">(</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"test timeout (5s)\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// could involve multiple stop calls, reset</span>\n        QUnit<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>semaphore <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">teardown</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>testTimeout<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      $<span class=\"token punctuation\">.</span><span class=\"token function\">mockjaxClear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mocks <span class=\"token operator\">&amp;</span>amp<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>amp<span class=\"token punctuation\">;</span> mocks<span class=\"token punctuation\">.</span>teardown<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        mocks<span class=\"token punctuation\">.</span><span class=\"token function\">teardown</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>The problem with this design was the lack of a <code class=\"language-text\">$.mockjaxClear(url)</code> method – you can’t remove an existing handler or replace it&nbsp;(<code class=\"language-text\">mockjaxClear(index)</code> is supported, but didn’t help us). We needed that to test error conditions, for example, when the API returned&nbsp;a 404 when asking if a particular track was a favorite of a user. In some cases, we could just mix it with other mocks.</p> \n<p>In other cases, we grouped these tests into a separate module-call (with the same name):</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">module</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"/users/183/playlists\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    responseStatus<span class=\"token punctuation\">:</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    responseText<span class=\"token punctuation\">:</span> <span class=\"token string\">\"servererror\"</span><span class=\"token punctuation\">,</span>\n    responseTime<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>With that, we did the regular tests in one place, the error conditions in the other.</p> \n<h2>The Bad</h2> \n<p>An interesting QUnit feature, inspired by Kent Beck’s work on <a href=\"http://junitmax.com/\">JUnit MAX</a>, is its built-in reordering. It basically records the&nbsp;results of one test run in <code class=\"language-text\">sessionStorage</code>, then looks at those results during the next run. If a test failed before, its scheduled to&nbsp;run first. All that happens without changing the order of the result output. If it works, you can get the relevant test results much&nbsp;faster then for regular sequential runs, as its likely that tests that failed before will fail again, while passing tests are a lot&nbsp;less likely to start failing.</p> \n<p>The problem with that reordering for us was that with all the asynchronous tests in our suite, sometimes tests would have side effects on&nbsp;other tests. As long as they ran in a fixed order, those effects weren’t noticeable. Instead of addressing the actual side effects,&nbsp;we ended up disabling the reordering. Its on the pile of chores to still address.</p> \n<p>Overall, the unit tests did a good job, though its not quite clear how much value they actually provided. Most bug reports are about visual&nbsp;issues, sometimes small glitches, often enough device specific issues. As a mobile web developer, Android, or Andy as we started to call it,&nbsp;becomes kind of an IE6. It gets updated only with the OS, the OS isn’t updated, so we’re stuck with this browser that was okay a year ago,&nbsp;but is a real pain today. On Android 2.1, you even have the same issue as on IE6: HTML5 elements like ‘header’ or ‘article’ aren’t styled.&nbsp;At least on IE6, there’s a workaround…</p> \n<p>Anyway, the other category of bugs were reported much less frequently, and unit testing didn’t help there either. We learned that&nbsp;client-side error logging is extremely valuable. Tools like <a href=\"http://airbrakeapp.com/\">Airbrake</a> and <a href=\"http://bugsense.com/\">Bugsense</a> still have a long way to go, but writing&nbsp;a single-page web application without logging of client side errors means you never know about the thousands of errors your users get to&nbsp;see. Expect another post on that topic.</p> \n<h2>The Ugly</h2> \n<p>As long as mockjax did its job, we were happy with it. When it didn’t, we had to look at the source, and we weren’t happy anymore. The whole&nbsp;thing is quite a mess and in dire need of some good refactorings. Still, in terms of features, alternatives like jQuery 1.5 custom transports or&nbsp;<a href=\"http://sinonjs.org/\">sinon.js</a> just aren’t on par, so we stuck with mockjax.</p> \n<p>What we now mostly gave up on is PhantomJS. The Jenkins-job that ran our QUnit tests using PhantomJS is currently disabled, as it kept&nbsp;failing for months. We spent overall several days trying to find the source of the one failing test, giving up at the end. We still don’t&nbsp;know why it was failing, and there were several hurdles that made it difficult to debug:</p> \n<ul> \n <li>It failed only on our Jenkins server. Running the tests locally, using the same PhantomJS version, worked fine. The difference was&nbsp;the enviroment, with mostly OSX running on developer machines, but Debian Lenny on the Jenkins box. Sure, that’s a problem, but the&nbsp;point of the tool is to provide a browser-like enviroment, it shouldn’t matter what system its running on.</li> \n <li>We were stuck with PhantomJS 1.1, even after 1.2.x was out for several months. While we could adapt to the completely backwards&nbsp;incompatible API changes from 1.1 to 1.2, we didn’t find any way around PhantomJS just crashing on our testsuite, with no useful output.&nbsp;If you’re interested, you can find the debugging process somewhat <a href=\"http://groups.google.com/group/phantomjs/browse_thread/thread/f505feeb51eb08\">documented on this Google Groups thread</a>. Even debugging&nbsp;with <code class=\"language-text\">gdb</code> proved to be a waste of time. The unhelpfulness of PhantomJS when failing to load a page is stunning.</li> \n</ul> \n<p>So as nice as PhantomJS is, the combination of not being able to upgrade and not being able to fix the existing build forced us to&nbsp;abandon it. TestSwarm is a lot more interesting now with the existing Jenkins plugin. And with Chrome support upcoming in Selenium,&nbsp;that is an attractive short term solution as well.</p> \n<h2>Epilog</h2> \n<p>As you can see, this story isn’t over yet. It seems to share a common theme with other developer tools, be that editors, bug tracking or&nbsp;testing tools: most of them do their job, but we aren’t satisfied with any of them.</p> \n<p>What are your experiences? What tools would you like to see improved, replaced or invented?</p>","descriptionType":"html","publishedDate":"Mon, 12 Sep 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"9b59267b8b287c5020653671b02d8498","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Stretch Opportunities for Engineers","link":"https://developers.soundcloud.com/blog/stretch-opportunities-for-engineers","description":"<p><a href=\"https://blog.iawomen.com/how-to-identify-stretch-opportunities-for-professional-growth/\">Stretch opportunities</a> are tasks or projects that are a bit beyond your current skill or knowledge level and that allow you to improve and learn new things. They are also essential for growth. At SoundCloud, some teams introduced a process so engineers can take on stretch opportunities. In this blog post, I’ll explain how this works for the Content Team.</p> \n<p>The need for stretch opportunities within the Content Team was raised in a retrospective. An engineer stated that they wanted to broaden their role and be exposed to requirement gathering, meetings with stakeholders, and driving new projects. Other engineers also showed interest, so we began discussing as a team what that would mean and how we could accomplish this. Based on these discussions, we ended up introducing the Project Lead role.<sup id=\"fnref-1\"><a href=\"https://developers.soundcloud.com/blog/stretch-opportunities-for-engineers#fn-1\" class=\"footnote-ref\">1</a></sup></p> \n<p>The Project Lead role is a voluntary non-permanent role that a team member gets assigned for the duration of a project. We assign the role for a new project when the current project is coming to completion and the new project will become the next main focus for the team.</p> \n<h2>Role Responsibilities</h2> \n<p>The team member in the Project Lead role takes over some of the responsibilities previously held by the Engineering Manager (EM) while still being supported by them. The responsibilities of a Project Lead are to:</p> \n<ul> \n <li>Be the technical representative for the project within the team but also externally. We expect that they answer questions about the implementation and participate in meetings with stakeholders.</li> \n <li>Write the Request for Comments (<a href=\"https://philcalcado.com/2018/11/19/a_structured_rfc_process.html\">RFC</a>) for the project and request and respond to feedback from the team and external stakeholders.</li> \n <li> <p>Be the driver for the execution and delivery of the project.</p> \n  <ul> \n   <li>Surface the work that is left and break it up in smaller chunks together with the team.</li> \n   <li>Identify what work can happen in parallel and encourage team members to help out.</li> \n   <li>Estimate and communicate how many iterations are still needed to complete the project.</li> \n   <li>Identify blockers and resolve them or ask for help.</li> \n  </ul> </li> \n <li>Make sure a retrospective happens when the project comes to an end, and find a facilitator for it.</li> \n</ul> \n<h2>Role Restrictions</h2> \n<p>In addition to the responsibilities of the Project Lead, we also came up with a list of restrictions:</p> \n<ul> \n <li>The Project Lead can’t unilaterally make decisions. In case of unresolved conflict, the EM and/or Product Manager (PM) will make the final decision (for example, for different opinions about technical implementations or product/prioritization or anything else).</li> \n <li>The Project Lead shouldn’t work alone. There can be some preparation work that happens in isolation for some time — for example, when writing the RFC — but we want to work as a team on all projects, as we think that getting different perspectives and leveraging the diversity of the team leads to better outcomes.</li> \n <li>We stick to one Project Lead per project. In case of unplanned absence, the EM and PM should be able to cover all the expectations and responsibilities. In case of planned absence (vacation), the Project Lead should find a replacement or alternative solution before leaving, and they should do a handover.</li> \n</ul> \n<h2>Learnings</h2> \n<p>After using the Project Lead role for several years, we’ve seen many advantages.</p> \n<p>Because the role is temporary and there is support from the EM and PM, it is a safe way for team members to take on additional responsibilities, and it’s an opportunity for growth and getting feedback.</p> \n<p>The voluntary nature of it means that team members can step into the role for a project they feel comfortable with. We have no restrictions on the experience level needed to step into the role, however, we noticed less experienced engineers will typically volunteer for smaller projects, while more experienced engineers are challenged by taking on larger projects with potentially more stakeholders and sometimes dependencies on other teams.</p> \n<p>We see that engineers who took on the Project Lead role, especially for larger projects, are in a better place for getting promoted because of the extra responsibilities they took on and the additional exposure they got outside the team. In fact, some of the Project Lead role responsibilities and expectations match well with some of <a href=\"https://developers.soundcloud.com/blog/engineering-levels\">our Level 3 Engineering Level expectations</a>, in particular:</p> \n<ul> \n <li>Drives larger projects reliably by delegating and coordinating</li> \n <li>Coordinates work across team boundaries</li> \n <li>Keeps the team honest and accountable to commitments</li> \n <li>Constantly puts effort into understanding the business/product big picture</li> \n</ul> \n<p>Furthermore, delegating some of the responsibilities previously taken on by the EM means that the EM will end up with more time for other things, which can be welcome, especially when leading larger teams.</p> \n<h2>Conclusion</h2> \n<p>The Project Lead role allows engineers to take on stretch opportunities. It’s also a way of acknowledging all the extra work that might not always be visible otherwise (what Tanya Reilly calls <a href=\"https://noidea.dog/glue\">glue work</a>).</p> \n<p>The fact that the role is voluntary and on a per-project basis is great, because it means that everyone who wants to take on the role will have a chance to sooner or later. Furthermore, it also works for people who prefer to focus on contributing but not leading.</p> \n<p>The Project Lead role concept may or may not work in your environment, but I believe it is important to create stretch opportunities for your engineers so they can get exposed to new skills, remain engaged, and grow.</p> \n<div class=\"footnotes\"> \n <hr> \n  <ol> \n   <li id=\"fn-1\"> <p>When talking about a project in the context of this blog post, I mean a software development project that has a purpose of reaching a certain outcome. A project can be part of a larger program consisting of multiple projects focused around a common theme.</p> <a href=\"https://developers.soundcloud.com/blog/stretch-opportunities-for-engineers#fnref-1\" class=\"footnote-backref\">↩</a> </li> \n  </ol> \n </hr> \n</div>","descriptionType":"html","publishedDate":"Wed, 20 May 2020 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"09a6f320a2ff4258ac78dbb9e3b3dc9e","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569968},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Hands-Off Deployment with Canary","link":"https://developers.soundcloud.com/blog/hands-off-deployment-with-canary","description":"<p>At SoundCloud, we follow best practices around continuous delivery, i.e. deploying small incremental changes often (many times a day). In order to do this confidently and reliably, we verify these changes before releasing, using different measures including, among others, unit, integration, and contract tests.</p> \n<p>This process is automated as part of a continuous delivery (CD) pipeline. Historically, a typical CD pipeline here has contained at least the following steps:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/b051382f9344df09700c36a57750a801/3eaf4/pipeline-original.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 71.10266159695817%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABl0lEQVQoz41TOUsDQRR+ENCttU0sFS218/g1If9AGzsbDVqsoBHSSGJU0CaYVu3ECG4jkRAQEYMHhqyY3cwec+zzbeJ97jfDG+aD710zD/A7ArR8q8mbJjfJtv02MT8CvtwFLYXTrZmedm/CHuhhvZlWhhhJK6I4xVJQB+1Sg2tYZIskDPkfxeT1bXfF8/bCoDc07k+Q3bALUSMTlFKc87BOFdYvuCDmpRtB8FkcYNEr6nI5g2sr3mpd1ok5YIc66lnM6oFuMIMYn/tChJlLKUPXL2KFk3ISHiFWj4GAPaeEHiYfk3AG2okGF5A209hC5rFqtVo+Lj80GiTuptAVT4EJsasYSCi5JXQxyZLkTjvVwIL0UxoZNpoPlcq5YRi1Ws1xnPe09/l+TuW3cLvAN+/UPTHHbjkX5HfULvEV9zysXAqpKGUpOvivYa/gPn9rWKSnmrPm4s3EaGMsbibW7fXOQ0X/JE4KbkA70uAWlpylvz7JR4QRFM7as32if/h+pI/3Z61s1MiduQh8l/uMig0tHcEvk/EMcAvhqnqUi9AAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Pipeline without canary step\" title=\"Pipeline without canary step\" src=\"https://developers.soundcloud.com/blog/static/b051382f9344df09700c36a57750a801/8ff1e/pipeline-original.png\" srcset=\"/blog/static/b051382f9344df09700c36a57750a801/9ec3c/pipeline-original.png 200w,\n/blog/static/b051382f9344df09700c36a57750a801/c7805/pipeline-original.png 400w,\n/blog/static/b051382f9344df09700c36a57750a801/8ff1e/pipeline-original.png 800w,\n/blog/static/b051382f9344df09700c36a57750a801/3eaf4/pipeline-original.png 1052w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>After building and packaging the code, a battery of automated tests was run in order to verify the expected behavior. Once all the tests passed, deployment to production could be manually triggered.</p> \n<p>This automated process, together with code reviews and other internal measures, greatly reduced the risk of introducing regressions.</p> \n<p>However, even with precautions like those mentioned above in place, things eventually can (and will) go wrong. In order to detect production issues, we use monitoring and alerting, so when a problem is found in production, we can react by reverting to a well-known previous state. Even so, since the change has already been fully rolled out, the user experience has already been severely impacted.</p> \n<p>In order to improve the user experience, we have been exploring different ways of reducing the <strong>impact</strong> and the <strong>Mean Time to Recovery (MTTR)</strong> of faulty deployments. Enter canary releases…</p> \n<h2>Iteration 1: Manual Canary Release</h2> \n<p>The term “canary” <a href=\"https://www.smithsonianmag.com/smart-news/story-real-canary-coal-mine-180961570/\">originates</a> from a mining tradition from the early 20th century, consisting of canaries being brought down to coal mines in order to detect toxic gases. When a canary died, it alerted workers to carbon monoxide or other poisons in the air, allowing them to evacuate before they were affected.</p> \n<p>In the context of software development, <a href=\"https://martinfowler.com/bliki/CanaryRelease.html\">canary release</a> is a technique that consists of making release candidates available to a small subset of users in order to detect regressions before the changes are available to all users.</p> \n<p>At SoundCloud, we initially implemented this technique by building tooling to allow packaging and publishing release candidates into a canary environment and configuring load balancers to divert a small amount of production traffic to it. By comparing metrics between production and canary environments, our developers are able to identify faulty release candidates before they make it to production.</p> \n<p>This was very convenient, but it came with some disadvantages. As it was a manual process and not integrated in the CD pipelines, it was easy for developers to forget to turn off old release candidates. Multiple versions receiving production traffic sometimes caused confusion and hard-to-debug issues. And although the process was documented, not everyone in the company was aware of the possibility of using canary environments. As a tedious manual process needed to be followed, it was only used for a very small number of releases. Finally, both the lack of traceability and allowing any developer to put arbitrary code into production without following standard quality checks came with a set of security and safety concerns.</p> \n<h2>Iteration 2: Canary Pipeline Integration</h2> \n<p>A natural next step was to integrate canaries into our deployment pipeline, thereby automating the process and ensuring it was used for every release. This also ensured that any code receiving production traffic had passed our standard quality processes and that the release candidate running in the canary environment was up to date.</p> \n<p>With these changes in effect, the pipeline looked like this:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/4f182e4d6e605f9894f241f2813e6bb2/23749/pipeline-manual-canary.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 53.973013493253376%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABc0lEQVQoz41ST0sCURCfD7DgQSOjPkRRn6UOLdR1oQzBS976LuKxDitmJ+2S3YJFEUWIMGO12NX1re/frq9ZV8ygrJmB997vzcybmd8DNZcZqlJE+Nf0piiLBV54Zf0lHm3mor4LxEuIqlRP9pJuCvoAb1DiJUQC1DXBeI0mlcSDze39ycH2ZGdznK7Re0QQx7xov7wcqoWhq5BLDyFEXFJUeKhmGK4W8ctEYHBDD3Rd6C3Z8oWfcS9OnNNjR2/S5jSYGsTQHf2QHDVYA7NQTl3XJYQEQdQOaEyDZwACJi0NpkPN1uAREDGn5sAfJEYJeAL4gLJXVlTZ7/ZDvW5ZFqU0Cs6zfIZl0LphFxNfyasczWVFtsM7LGCXJH82Pjc8o83bER0+8bzJyB0xyr6mvexThFJg76HknMccrpt2PMyYElvYu85e+mUrNdyosto/pr3KM+8lJ0mwAGwwhfk3z6s/jEpapbWKvLtllSEfrv6wH+UTzBVClne7yoIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Pipeline with manual canary step\" title=\"Pipeline with manual canary step\" src=\"https://developers.soundcloud.com/blog/static/4f182e4d6e605f9894f241f2813e6bb2/8ff1e/pipeline-manual-canary.png\" srcset=\"/blog/static/4f182e4d6e605f9894f241f2813e6bb2/9ec3c/pipeline-manual-canary.png 200w,\n/blog/static/4f182e4d6e605f9894f241f2813e6bb2/c7805/pipeline-manual-canary.png 400w,\n/blog/static/4f182e4d6e605f9894f241f2813e6bb2/8ff1e/pipeline-manual-canary.png 800w,\n/blog/static/4f182e4d6e605f9894f241f2813e6bb2/6ff5e/pipeline-manual-canary.png 1200w,\n/blog/static/4f182e4d6e605f9894f241f2813e6bb2/23749/pipeline-manual-canary.png 1334w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Every change went through a canary step in which developers could manually compare metrics and identify issues before proceeding to a full production deploy.</p> \n<p>This was a clear improvement over the previous situation, but it was still a manual process that relied on developers carefully looking at relevant graphs and spotting potential problems, which was time-consuming and error prone.</p> \n<h2>Iteration 3: Automated Canary Verification</h2> \n<p>In order to fully automate our deployments, we had to solve the problem of automatic canary verification. We soon realized we could leverage our existing monitoring and alerting infrastructure to accomplish just that.</p> \n<p>Every service at SoundCloud has a set of defined rules used to detect anomalies and undesired behaviors. With small modifications to the rule expressions, we were able to detect these conditions in each of our defined environments.</p> \n<p>The missing piece was to query our monitoring system from the CD pipelines to automatically detect and roll back any change introducing regressions. This allowed us to remove manual intervention while ensuring the same standards of quality used for our production environments.</p> \n<p>The resulting pipeline looked like this:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/cfcb22261ad68e86a1464a577e9cb957/f5ca1/pipeline-automatic-canary.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.295224312590456%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABrklEQVQoz4VSS0sjQRBuBJfNQdSTD9CzHtabv8cFiQePrv4A16Crh1VBD4vgkoMPvAgedtGTB09hFWJ84MZZY3xhZjKZ6Zmxp7v6YXeChgWJ1R9NdddXXdX9NVL/G3DwwPOE54MvhFANDb16QhmqRayOoLPVbfuEBzzq6R2pR4NkrrgGU0z7eZpvcpvQHep2u11wzaEcJOcajSrXjDBSEIVrVSjyIgP2TttSylX2c1J+nYaZW3GHKV7Ai9+D+RV/hSru/7v68232cG7uLJ02PQJET5EGAJhkKmk/7UdXCAVoN94r4iK6QSiDuh46HBVcbO8sJxKrLa1rg4OaHmCczWaPDo98H5tkIUWKpobI52SctLjlUjfJRoYrwxPxOFFQPjndHx09GPui62s2JaRsl+zHxzDAL3euPWd1jllsc9tRjgNOrbe6igBGPCkNXh9Mi6QBylAvqdVmt3+8SPSV+7TgJiq4Zsuq5jQMwl9reHOJu6U3dM7H+ebwA/qLeqLeCq3Uda4ln2S8H1PBxlL0e/0tqYDkaO6YHZ/H5/q31QPVViWJot2tcCfNS/d6+QwnBkLtCYfm3AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Pipeline with automatic canary step\" title=\"Pipeline with automatic canary step\" src=\"https://developers.soundcloud.com/blog/static/cfcb22261ad68e86a1464a577e9cb957/8ff1e/pipeline-automatic-canary.png\" srcset=\"/blog/static/cfcb22261ad68e86a1464a577e9cb957/9ec3c/pipeline-automatic-canary.png 200w,\n/blog/static/cfcb22261ad68e86a1464a577e9cb957/c7805/pipeline-automatic-canary.png 400w,\n/blog/static/cfcb22261ad68e86a1464a577e9cb957/8ff1e/pipeline-automatic-canary.png 800w,\n/blog/static/cfcb22261ad68e86a1464a577e9cb957/6ff5e/pipeline-automatic-canary.png 1200w,\n/blog/static/cfcb22261ad68e86a1464a577e9cb957/f5ca1/pipeline-automatic-canary.png 1382w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h2>Conclusion</h2> \n<p>The addition of automatic canary deployments and verifications at SoundCloud was a massive success and has greatly improved our productivity and reliability. The confidence we have in automatically detecting any regression has removed the manual toil around deployment and enables our developers to focus on adding value without spending time babysitting deployments. When things inevitably go wrong, we now have yet another safety net that protects us from large-scale outages. Using automatic processes and removing human interaction to verify and roll back faulty deployments has greatly reduced our Mean Time to Detect (MTTD) and Mean Time to Recovery (MTTR).</p>","descriptionType":"html","publishedDate":"Wed, 29 Aug 2018 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/b051382f9344df09700c36a57750a801/8ff1e/pipeline-original.png","linkMd5":"e23324783fc57afcc03c24d0a2f624db","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn45@2020_3/2020/08/25/00-49-38-668_1843398e2cbd871c.webp","destWidth":800,"destHeight":569,"sourceBytes":9002,"destBytes":14200,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/b051382f9344df09700c36a57750a801/8ff1e/pipeline-original.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn45@2020_3/2020/08/25/00-49-38-668_1843398e2cbd871c.webp","https://developers.soundcloud.com/blog/static/4f182e4d6e605f9894f241f2813e6bb2/8ff1e/pipeline-manual-canary.png":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn95@2020_1/2020/08/25/00-51-45-093_eed90e26cadb4fd2.webp","https://developers.soundcloud.com/blog/static/cfcb22261ad68e86a1464a577e9cb957/8ff1e/pipeline-automatic-canary.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn9@2020_5/2020/08/25/00-51-43-201_26a52ee5dc6501d3.webp"},"publishedOrCreatedDate":1598316569975},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Building radio stations at SoundCloud","link":"https://developers.soundcloud.com/blog/building_radio_stations_at_soundcloud","description":"<p>Over the last 100 years we have dialed into radio stations at home, on the road, or in the office to access a curated mix of top hits delivered to us by our favorite DJ. With more and more of our daily activities taking place online, we find our source of music now comes from a mix of our mobile phones, our desktop computers and the radio - and is available to us whenever we need it. The amount of music available today is endless. The music scene has never been so vibrant. A proliferation of production tools at low cost and the ease at which an artist can share their sounds, gives everyone the opportunity to share their work at any time, with only a few clicks.</p> \n<p>Keeping this in mind, we set out to determine: How can we bring a radio like experience to SoundCloud that would enable you to tune-in and lean back? </p> \n<!-- more --> \n<h2>The lean back experience</h2> \n<p>We consider the lean back experience those moments when you need music but don’t have the time to curate or choose something specific - at the gym, during your commute or those moments in the office when you need something to help your through the day. </p> \n<h2>The secret sauce for a successful radio station</h2> \n<p>Imagine a radio station that jumps from a jazz instrumental to the new EDM ‘floorkiller’. That just wouldn’t work. </p> \n<p>To create an enjoyable radio experience, it’s important the experience maintains consistency and context for the user. To create this experience on SoundCloud, we considered the following key ingredients that have lasted the test of time for radio as we built our latest discovery feature, Artist Stations. </p> \n<p><strong>Novelty.</strong> You want to hear something new. That’s why the mainstream radio stations revamp their playlists periodically, usually every month, so listeners return to hear the newest hits.</p> \n<p><strong>Familiarity.</strong> At the same time, you also want to hear something that’s familiar. You know the lyrics, or it’s an artist you like, or simply you heard that track before. Music often it closely tied with life events and experiences and hearing a familiar song can trigger memories that make us smile.</p> \n<p><strong>Context.</strong> Since we are in a lean back experience mode, our brain works better when changes in external factors are minimal. Imagine a radio station that jumps from a country song to the new EDM ‘floorkiller’. That would not work, that’s why providing context and maintaining that context consistently is crucial for every radio experience. </p> \n<h2>The future of radio stations.</h2> \n<p>Two weeks ago we launched <strong><a href=\"https://developer.soundcloud.com/blog/tracks\">Suggested Tracks</a></strong> on Mobile and <strong><a href=\"https://soundcloud.com/discover\">Discover</a></strong> tab on Web, the first of a series of features built on top of our machine learning infrastructure.</p> \n<p>We strongly believe the content available on our platform is unique, and so are the millions of listeners that tune-in on SoundCloud every day. Each of them has their own specific taste and sense of what is novel and familiar.</p> \n<p>By unlocking our catalog to algorithms trained to behave as radio curators, we can get the best of both worlds — an exceptional traditional radio experience coupled with an endless catalog of content available to you with just a few taps on your screen. </p> \n<p>This is the ultimate democratization of the radio experience. Our machines are composing a radio experience by detecting what is <em>new</em>, what is <em>familiar to the user</em>, and what is <em>trending</em> or <em>popular among listeners</em> in the SoundCloud community. All while keeping the context consistent with the Station you’ve selected, and your personal taste profile.</p> \n<h2>Continuous improvement</h2> \n<p>We are extremely excited to share this feature with you, and I hope you’ll enjoy it as much as we do. Track and Artist Stations are currently available on mobile, and will be coming to web in late summer.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/a66c8/suggestedStations.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.313932980599645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGQAAAQUAAAAAAAAAAAAAAAAAAAECAwQF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3oLCDgD/xAAZEAABBQAAAAAAAAAAAAAAAAACAQMSIDH/2gAIAQEAAQUCXAckVP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAABERIg/9oACAEBAAY/AiKtZ//EABkQAAIDAQAAAAAAAAAAAAAAAAERABAhMf/aAAgBAQABPyE0R6oRzK9o3//aAAwDAQACAAMAAAAQEA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAQUBAQAAAAAAAAAAAAABEQAQQWFxITH/2gAIAQEAAT8QQwUJgzU5keg5rdvijHbf/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"suggestedStations\" title=\"suggestedStations\" src=\"https://developers.soundcloud.com/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/a296c/suggestedStations.jpg\" srcset=\"/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/f544b/suggestedStations.jpg 200w,\n/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/41689/suggestedStations.jpg 400w,\n/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/a296c/suggestedStations.jpg 800w,\n/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/c35de/suggestedStations.jpg 1200w,\n/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/8179c/suggestedStations.jpg 1600w,\n/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/a66c8/suggestedStations.jpg 2835w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>As our algorithms are constantly in evolution and our data models continue to refine themselves, the more you listen, the better suggestions you will receive and the more input we will receive, the better stations perform for everyone on SoundCloud. Stay tuned for more iterations of stations and more ways to discover the more than 125 million tracks available on SoundCloud.</p>","descriptionType":"html","publishedDate":"Tue, 05 Jul 2016 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/a296c/suggestedStations.jpg","linkMd5":"90c67514dc81caf3deb52636f48e90e0","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn54@2020_4/2020/08/25/00-49-39-375_784e614a7de44075.webp","destWidth":800,"destHeight":371,"sourceBytes":12447,"destBytes":10916,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/a296c/suggestedStations.jpg":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn54@2020_4/2020/08/25/00-49-39-375_784e614a7de44075.webp"},"publishedOrCreatedDate":1598316569977},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Promoting your app in the SoundCloud App Gallery","link":"https://developers.soundcloud.com/blog/promoting-your-app","description":"<p><em>UPDATE: We made some changes to how we manage the App Gallery. Read about them here: <a href=\"https://developers.soundcloud.com/blog/blog/the-next-app-gallery-update\">The Next App Gallery Update</a></em></p> \n<p>So you’ve built a fantastic app that you would like to get showcased in the SoundCloud App Gallery? Here’s what you can do to improve your chances of getting your app featured and increase the likelihood of SoundCloud users trying out your app.</p> \n<!-- more --> \n<p>Add your App Gallery profile <a href=\"https://soundcloud.com/you/apps\">here</a>.</p> \n<ol> \n <li> <p><strong>Description</strong> - Sell it - let people know what makes your app one of a kind, why should they download it? As silly as this may sound, don’t forget to explain what it does! Make use of simple HTML formatting to give the text the presentation it deserves.</p> <p>Example: <a href=\"https://soundcloud.com/apps/deadmau5\">Deadmau5 Remix</a></p> </li> \n <li> <p><strong>Sound</strong> - if your app creates audio, let SoundCloud users what kinds of sounds they can expect to create! If not, why not record a short description of what the app can do that users can listen to?</p> <p>Example: <a href=\"https://soundcloud.com/apps/nanostudio\">NanoStudio</a></p> </li> \n <li> <p><strong>Screenshots</strong> - the more the merrier. Remember that SoundCloud users need to understand not only what your app does, but how they can connect with SoundCloud. Adding carefully selected screenshots will tell more of a story than just a short paragraph. You can add as many screenshots as you like!</p> <p>Example: <a href=\"https://soundcloud.com/apps/fire2\">Fire2 - Field Recorder</a></p> </li> \n <li> <p><strong>Group</strong> - create a group so that users of the app can submit tracks to it, the last five tracks from the group will show on your app page. Currently only SoundCloud admins can add a group URL, get in contact with “api [at] soundcloud.com” to get your app’s group added to your page!</p> <p>Example: <a href=\"https://soundcloud.com/apps/freestyle-app\">Freestyle App</a></p> </li> \n <li> <p><strong>Sound and Vision</strong> - Add a tutorial video. There are plenty of tools available for making short screencasts available, like <a href=\"http://www.techsmith.com/jing/\">Jing</a> for example.</p> \n  <div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 69.8%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\"> \n   <iframe src=\"http://www.youtube.com/embed/Cks_1miFLPM\" frameborder=\"0\" allowfullscreen=\"\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> \n  </div> </li> \n</ol> \n<p>After you have added your app, the SoundCloud admin team will check your app for adherence to SoundCloud guidelines and completeness. Once approved, your app will go live in the SoundCloud App Gallery and might get featured.</p>","descriptionType":"html","publishedDate":"Mon, 25 Jul 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"17fc0a6d6c9c9dd57a89c9e58b570fa4","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Web Scale Statistics – Failing with MongoDB","link":"https://developers.soundcloud.com/blog/web-scale-statistics-failing-with-mongodb","description":"<p>As SoundCloud rapidly grows our initial systems need an overhaul. Our scaling strategy has been very realistic, design for 10x our current usage. Our initial statistics system found under <a href=\"https://soundcloud.com/you/stats\">https://soundcloud.com/you/stats</a> was made when we were 100k users, living long past its expiration date.</p> \n<h2>Background</h2> \n<p>About a year ago we started off with the goal of redesigning the statistics pages to support 500 playbacks a second. We knew that this would be a write-heavy workload and that to sustain bursts of writes, we’d need decent partitioning. Coming from a successful experience moving the Dashboard feature to <a href=\"http://cassandra.apache.org/\">Cassandra 0.6</a> we started out prototyping a design that would be easily partitioned.</p> \n<p>The write side of this story went very well, Cassandra could keep up with everything we threw at it, however to naively pull out all the aggregates we were collecting took hundreds of queries to the cluster. Cassandra didn’t have atomic counters at the time, so we had a lot of individual counts that needed to be summed on the client. (This is changing with the much anticipated <a href=\"http://wiki.apache.org/cassandra/Counters\">upcoming 0.8 release</a>!)</p> \n<p>In a one-night experiment, we re-implemented the Cassandra based prototype to be backed by <a href=\"http://www.mongodb.org/\">MongoDB</a>. Not only could this quick prototype consume events as fast as Cassandra, there were some server side features in MongoDB that we could use to simplify a few of the queries that we had for the stats like atomic inplace insert/updates (<a href=\"http://www.mongodb.org/display/DOCS/Updating\">upserts</a>) to use fewer documents and <a href=\"http://www.mongodb.org/display/DOCS/Indexes\">secondary indexes</a> to build the time series. <em>Plus</em> it was <a href=\"http://en.wikipedia.org/wiki//dev/null\">web scale</a>.</p> \n<p>To answer the partitioning problem for MongoDB, we decided to lean on the <a href=\"http://www.mongodb.org/display/DOCS/Sharding+Introduction\">automatic sharding</a> router that was under development. This was built to automate the rebalancing of data between replication pairs and keep a cluster nice and healthy without much data administration.</p> \n<p>Away we went, implementing a correct, distributed key-value oriented MongoDB based statistics backend. We even deployed it into a cluster of Amazon EC2 instances and hooked it up to the website to start tracking our statistics alongside our existing solution.</p> \n<p>What we observed was disconcerting. On a 36GB RAM machine with a working set under 100 GB, the system performed better than needed. A single node could process thousands of plays per second. Once the working set approached 300 GB, the throughput dropped down to between 100 and 200 plays per second. The disk utilization of one of the shards in the cluster stayed at 100% and we were seeing a IO service latency of around 5ms and MongoDB latency spiking upwards to 15 seconds. This all pointed to becoming bound on disk seeks.</p> \n<h2>Seeking the answer</h2> \n<p>Being bound on IO was something that we anticipated as we would not need to keep the entire working set resident, but not this bad. Whatever that MongoDB’s sharding was doing was causing a single node in the cluster to bottleneck. Could it be those poor disk heads bouncing back and forth to support our write load?</p> \n<p>For any workload, a disk seek is the worst thing one could be spending time on. In <a href=\"http://norvig.com/21-days.html#answers\">“Numbers Everyone Should Know”</a> it’s obvious we can do better:</p> \n<table border=\"1\"> \n <tbody> \n  <tr> \n   <td>execute typical instruction</td> \n   <td align=\"right\">1/1,000,000,000 sec = 1 nanosec</td> \n  </tr> \n  <tr> \n   <td>fetch from L1 cache memory</td> \n   <td align=\"right\">0.5 nanosec</td> \n  </tr> \n  <tr> \n   <td>branch misprediction</td> \n   <td align=\"right\">5 nanosec</td> \n  </tr> \n  <tr> \n   <td>fetch from L2 cache memory</td> \n   <td align=\"right\">7 nanosec</td> \n  </tr> \n  <tr> \n   <td>Mutex lock/unlock</td> \n   <td align=\"right\">25 nanosec</td> \n  </tr> \n  <tr> \n   <td>fetch from main memory</td> \n   <td align=\"right\">100 nanosec</td> \n  </tr> \n  <tr> \n   <td>send 2K bytes over 1Gbps network</td> \n   <td align=\"right\">20,000 nanosec</td> \n  </tr> \n  <tr> \n   <td>read 1MB sequentially from memory</td> \n   <td align=\"right\">250,000 nanosec</td> \n  </tr> \n  <tr> \n   <td>fetch from new disk location (seek)</td> \n   <td align=\"right\"><strong>8,000,000 nanosec</strong></td> \n  </tr> \n  <tr> \n   <td>read 1MB sequentially from disk</td> \n   <td align=\"right\">20,000,000 nanosec</td> \n  </tr> \n  <tr> \n   <td>send packet US to Europe and back</td> \n   <td align=\"right\">150 milliseconds = 150,000,000 nanosec</td> \n  </tr> \n </tbody> \n</table> \n<p>The stress to get the stats released was mounting. Our existing solution was unusable for almost all of our active users and was actually causing a ripple effect in the databases that caused site performance degradation when anyone went to visit their stats page. And we had overshot our release goal already by 2 months.</p> \n<p>We struggled hard to identify the root cause for why we had a hotspot in the MongoDB cluster. If we could just distribute the seek-bound workload, we could at least release this iteration of the stats while we dug into the root cause of being seek bound in the first place.</p> \n<p>To identify the root cause, we tried confirming various theories about the workload we were introducing and the behavior of MongoDB. Each experiment was time consuming but we built up an understanding of how the system was (mis)behaving.</p> \n<h2>Death by design</h2> \n<p>The design of this system was fairly simple – create a document for each time aggregate that we needed to display in a time series. Use varying time spans to reduce the number of aggregates we would need to fetch and sum in the client. We used <em>year</em>, <em>month</em>, <em>day</em> and <em>hour</em> aggregation documents for each dimension of data we wished to track. This includes the total play counts, by user, country and source URL. Send these aggregates to a [mongos][mongo-mongos] node that would then shard the documents and distribute them to one of 4 backing replication pairs.</p> \n<p>The last theory is that when a track is first recorded, the 4 aggregate documents (year, month, day, hour) are written to the end of each collection. All 4 documents would end up on the right side of the tree and the right side on disk, because our understanding of the MongoDB disk layout goes as far as being a memory mapped BTree of the actual <a href=\"http://bsonspec.org/\">BSON</a> documents. As time passes, the longer duration documents, year and month, would start to become relatively shifted to the left of the disk storage, where the newer hours and days would end up on the right. Since MongoDB’s persistence was essentially a bunch of memory mapped files, this could have caused all the page faults loading up cold pages from the middle/left of the tree when attempting to update all aggregation buckets.</p> \n<p>We are still uncertain about how the documents were layed out in memory and on disk, how it grew, how it was mapped to disk and how the indexes resolved to documents. If the on-disk layout was by the random ID then we were screwed on writes and reads because they would both be random. If it was by time, we were screwed on reads as we’d get sparse reads over the time series, if it was on our bucket organization we were screwed in the future as our buckets locality would get sparser over time.</p> \n<h2>Coming to terms</h2> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 631px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/eef7a/IO-doing-it-wrong.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 72.10776545166404%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAADHklEQVQ4y12T329TZRjHT9dfazfaWfvz9LQ9PWs7zmy7jpXNbsAWYGNsUEbphiIbRombQUTcwsgujHFChASCPwJy4ZXohdGgIWpMTLz1ygvv/Vs+PuecljgvvnmfvHmfz/t9nvd9FLc7gMcTwOfrx+ffh9fnyOPt76jPWWWvx9OH4gqg9ARx94bwBsIEggP4Jc/hBFGswAKUiwWmKiVmaibz42XOTI3Snj7Iq8cbrM452r3c5Okn6/xw603unJrgkpFhKprAVLN4/SEbKsBecRaiVsozN6KzND7ExekK6yfqXFlscP3sEd5tTnLlZJ3f774Bfz/kn/sXeHQgxc2SxpftBsujJRSvVCWs58CXDJ1GKU1VT1JMR6nkEjTrJVanqyxPDtN+2eSrGyv89fUOz+5s8OPuBr99+j7fb7eYyaWlBeG9wPKgzpAWJRYJE4+EiL2wT8AxVqYqnKoPsXCgyJmGyZOPN/jps23+/OY2Pz/cYfetJmOS65T8H6CZ1xnOJkhHByhqcfZnk8QFemhYl1ZIf/fnaJg6T+9d44/H2zz5aJ1fPt/i2w/XpLICbushuz206JWCway4mJHklekakwLS4hEaAjpk5qjmUjTKBg+ur7B2tMLj7VVuXV7g7ZM1Roz8Xod+qb+YzdA6XOW7u5s82Hqd09K3I9VBuT3LwYJGOZNgTOIb5w9z/50lfv1ik/dak3xw6YTkZu0qHWCPAxzMSFIuydXzi6y3jjM3VrKd1WRvxFaCfCwsF6hcnKtzdWGCnWNlrs2U0aJxegMDWKznwJK8cklc6MkX7f6ZGUcVPcWooVIfTDOsxTCkx5H+fhbSEW6PZXl2rsLauCnfJtR9ZfnYMg3xWIpUQkVNqiTjnbijrJqxlZZYS3b2RGUtzYShUVRVe4rsR7HGxYK6XH4URSSryyU3KV6RS6Rwc3OL1165YMeK4hH57HP2+Y4smLs7eha0K683SI+0YSAcJa8XSCY02kstZo/OShUquaxBQGbYqSyIT+S1TFn5XYd7gX22Cz1XYPnsORvUXDzN/Oy8rbbsJeQSy+X/cy39Cz5on54Pw/RuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"IO doing it wrong\" title=\"IO doing it wrong\" src=\"https://developers.soundcloud.com/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/eef7a/IO-doing-it-wrong.png\" srcset=\"/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/9ec3c/IO-doing-it-wrong.png 200w,\n/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/c7805/IO-doing-it-wrong.png 400w,\n/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/eef7a/IO-doing-it-wrong.png 631w\" sizes=\"(max-width: 631px) 100vw, 631px\" loading=\"lazy\" /> </a> </span></p> \n<p>Not reasoning hard about this system’s IO patterns was a very late, and very obvious oversight. Even if we could partition the writes, we had designed a system that would require close to 100% in-memory residence to be performant over time. This is a very expensive proposal for mostly stale and very large data.</p> \n<p>Lessons learned, we faced and made the difficult decision to cancel this project as it could not meet our long-term goals under real workload.</p> \n<p>Yet the stress is still there, the SoundCloud statistics must work for all users, especially the people with millions of plays.</p> \n<p>Up soon – what we made instead (for now).</p> \n<p>Not reasoning hard about this system’s IO patterns was a very late, and very obvious oversight. Even if we could partition the writes, we had designed a system that would require close to 100% in-memory residence to be performant over time. This is a very expensive proposal for mostly stale and very large data.</p> \n<p>Lessons learned, we faced and made the difficult decision to cancel this project as it could not meet our long-term goals under real workload.</p> \n<p>Yet the stress is still there, the SoundCloud statistics must work for all users, especially the people with millions of plays.</p> \n<p>Up soon – what we made instead (for now).</p>","descriptionType":"html","publishedDate":"Thu, 28 Apr 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/eef7a/IO-doing-it-wrong.png","linkMd5":"5ebbebd692f2496d8bb2766357435740","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn93@2020_4/2020/08/25/00-49-38-629_3ebaaf89bf164a29.webp","destWidth":631,"destHeight":455,"sourceBytes":52177,"destBytes":18956,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/eef7a/IO-doing-it-wrong.png":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn93@2020_4/2020/08/25/00-49-38-629_3ebaaf89bf164a29.webp"},"publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Developer Contest: SoundCloud + Acapela Group Mashup","link":"https://developers.soundcloud.com/blog/contest-soundcloud-and-acapela-group","description":"<p>SoundCloud is teaming up with <a href=\"http://www.acapela-group.com\">Acapela Group</a> for our first Developer Contest. Acapela Group offers amazing text to speech solutions and have a variety of <a href=\"http://www.acapela-group.com/develop-with-text-to-speech.html\">SDKs</a> so you can write apps that create sound files using one of their voices (including hip-hop and country!). <a href=\"https://soundcloud.com/user6773090/sets/acapela-tts-voices/\">Take a listen to some sample voices</a>.</p> \n<p>We’re calling on our developer community to mashup SoundCloud and Acapela. Show us what you can do using a text to speech service with the best audio content platform on the web. Maybe you want to have your email read (or sung!) to you layered on some instrumental or drum tracks. We think there are loads of options for making interesting and accessible apps using these two services.</p> \n<!-- more --> \n<h3>Deadline: May 15th</h3> \n<p>The deadline for submissions is \n <strike>\n   May 1st \n </strike> May 15th. That gives you just under a month to <a href=\"https://developers.soundcloud.com\">check out our API docs</a> and get started with a <a href=\"http://www.acapela-group.com/develop-with-text-to-speech.html\">Acapela SDK</a>. Sign up for a free Acapela evaluation account <a href=\"http://www.acapela-vaas.com/signup-for-free-evaluation-account.html\">here</a>.</p> \n<p>When you’re app is ready to show off, send it to us using <a href=\"https://docs.google.com/a/soundcloud.com/spreadsheet/viewform?formkey=dDZGZ0tCdUlnQ3dCNURKd1Rla3ZQNWc6MQ\">this form</a>.</p> \n<h3>Prizes</h3> \n<p>This is a chance to get creative and show us something useful and fun. We’ve got some great prizes lined up for the top 3 picks:</p> \n<ul> \n <li>3rd place — A pair of <a href=\"http://www.monstercable.com/productdisplay.asp?pin=6403\">Monster iSport</a> headphones.</li> \n <li>2nd place — A pair of <a href=\"http://www.puritybymonster.com/\">Monster Purity</a> headphones.</li> \n <li>1st place — A special prize from <a href=\"http://www.monstercable.com/\">Monster</a> (to be announced) and a 1 year subscription to <a href=\"http://www.acapela-vaas.com\">Acapela VaaS</a></li> \n</ul> \n<p>All of our top picks will be showcased on this blog. Special thanks to our contest sponsor <a href=\"http://www.monstercable\">Monster</a> and our partner <a href=\"http://acapela-group.com\">Acapela</a>!</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 229px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/69ee5739e44097bf42f4e5fbb107cfc2/91578/isport-headphones.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 97.37991266375545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAMEBQL/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHdz4bR0sBIEIP/xAAbEAADAAMBAQAAAAAAAAAAAAABAgMABDIRFP/aAAgBAQABBQIsq5s2RTrOWmzU+iimmvMeTHeS4//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EAB0QAAICAgMBAAAAAAAAAAAAAAECABESIRAxUYH/2gAIAQEABj8C2auYsmUPejQjELtdCWyjOoteRuPpn//EABwQAQADAAIDAAAAAAAAAAAAAAEAETEhQRBhkf/aAAgBAQABPyGsr6LdnNEPdVNACot8R79HK4rG5syEalUyEGO6vxsdAH2f/9oADAMBAAIAAwAAABAABwD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAeEAEBAAICAgMAAAAAAAAAAAABEQAxIUFRYRDh8f/aAAgBAQABPxBktKGCvWU9MIs0+HZrKYDAkgNvcqX1jTWiSB5u9p+ZwsRDyQ2Xr7wZ4w6PG8MSJa88J8GB0x4Bwz//2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"iSport by Monster\" title=\"iSport by Monster\" src=\"https://developers.soundcloud.com/blog/static/69ee5739e44097bf42f4e5fbb107cfc2/91578/isport-headphones.jpg\" srcset=\"/blog/static/69ee5739e44097bf42f4e5fbb107cfc2/f544b/isport-headphones.jpg 200w,\n/blog/static/69ee5739e44097bf42f4e5fbb107cfc2/91578/isport-headphones.jpg 229w\" sizes=\"(max-width: 229px) 100vw, 229px\" loading=\"lazy\" /> </a> </span> <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 229px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/9056956503086f1ecf1160e8ad4c7227/91578/purity-headphones.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAMEBQb/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHXrWMY6ICEJgf/xAAcEAACAgIDAAAAAAAAAAAAAAACAwEEEBIAERP/2gAIAQEAAQUCsHokO1N5YHdAMks+YRj/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAfEAACAQIHAAAAAAAAAAAAAAABAhAAEQMhIkFRYZH/2gAIAQEABj8CJpdRKuN+YYdVhhjexnJR5H//xAAbEAACAwADAAAAAAAAAAAAAAABEQAQMSFhcf/aAAgBAQABPyEgso456NI1RZ7yEJ7DHVlAhljKf//aAAwDAQACAAMAAAAQK888/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHBABAQACAgMAAAAAAAAAAAAAAREQIQAxgZHB/9oACAEBAAE/EEFQAOysvAKjYiADurq4QZfYG/nHtA0ZUaPEzCHMIDaY/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Purity by Monster\" title=\"Purity by Monster\" src=\"https://developers.soundcloud.com/blog/static/9056956503086f1ecf1160e8ad4c7227/91578/purity-headphones.jpg\" srcset=\"/blog/static/9056956503086f1ecf1160e8ad4c7227/f544b/purity-headphones.jpg 200w,\n/blog/static/9056956503086f1ecf1160e8ad4c7227/91578/purity-headphones.jpg 229w\" sizes=\"(max-width: 229px) 100vw, 229px\" loading=\"lazy\" /> </a> </span></p> \n<p><em>Update:</em> We’ve moved the contest deadline to May 15th. You have a couple more weeks to get those entries in!</p>","descriptionType":"html","publishedDate":"Wed, 04 Apr 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/69ee5739e44097bf42f4e5fbb107cfc2/91578/isport-headphones.jpg","linkMd5":"edf53c47b004b074d6799824414530ff","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn1@2020_3/2020/08/25/00-49-39-035_bc13a85d16cbf792.webp","destWidth":229,"destHeight":223,"sourceBytes":5267,"destBytes":6042,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/69ee5739e44097bf42f4e5fbb107cfc2/91578/isport-headphones.jpg":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn1@2020_3/2020/08/25/00-49-39-035_bc13a85d16cbf792.webp","https://developers.soundcloud.com/blog/static/9056956503086f1ecf1160e8ad4c7227/91578/purity-headphones.jpg":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn70@2020_1/2020/08/25/00-51-41-924_9b233467d626f37c.webp"},"publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Building Products at SoundCloud —Part I: Dealing with the Monolith","link":"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith","description":"<p>Most of SoundCloud’s products are written in <a href=\"https://developers.soundcloud.com/blog/category/scala\">Scala</a>, <a href=\"https://developers.soundcloud.com/blog/category/clojure\">Clojure</a>, or <a href=\"https://developers.soundcloud.com/blog/category/ruby\">JRuby</a>. This wasn’t always the case. Like other start-ups, SoundCloud was created as a single, monolithic Ruby on Rails application running on the MRI, Ruby’s official interpreter, and backed by memcached and MySQL.</p> \n<p>We affectionately call this system <em>Mothership</em>. Its architecture was a good solution for a new product used by several hundreds of thousands of artists to share their work, collaborate on tracks, and be discovered by the industry.</p> \n<p>The Rails codebase contained both our Public API, <a href=\"https://soundcloud.com/apps\">used by thousands of third-party applications</a>, and the user-facing web application. With the launch of the <a href=\"https://developers.soundcloud.com/blog/building-the-next-soundcloud\">Next SoundCloud</a> in 2012, our interface to the world became mostly the Public API —we built all of our client applications on top of the same API partners and developers used.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 700px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/ebb4b534084c91b368f7641a794fd7cb/67d4f/product-engineering-diagram-1.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 37.28571428571429%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAHABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3aFB/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAFhABAQEAAAAAAAAAAAAAAAAAAQAQ/9oACAEBAAE/ISDP/9oADAMBAAIAAwAAABDwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAAMAAwAAAAAAAAAAAAAAAAABESFRcf/aAAgBAQABPxCnZgYrIuIj2f/Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Diagram 1\" title=\"Diagram 1\" src=\"https://developers.soundcloud.com/blog/static/ebb4b534084c91b368f7641a794fd7cb/67d4f/product-engineering-diagram-1.jpg\" srcset=\"/blog/static/ebb4b534084c91b368f7641a794fd7cb/f544b/product-engineering-diagram-1.jpg 200w,\n/blog/static/ebb4b534084c91b368f7641a794fd7cb/41689/product-engineering-diagram-1.jpg 400w,\n/blog/static/ebb4b534084c91b368f7641a794fd7cb/67d4f/product-engineering-diagram-1.jpg 700w\" sizes=\"(max-width: 700px) 100vw, 700px\" loading=\"lazy\" /> </a> </span></p> \n<p>These days, we have about 12 hours of music and sound uploaded every minute, and hundreds of millions of people use the platform every day. SoundCloud combines the challenges of scaling both a very large social network with a media distribution powerhouse.</p> \n<p>To scale our Rails application to this level, we developed, contributed to, and published several components and tools to help <a href=\"https://github.com/soundcloud/lhm\">run database migrations at scale</a>, <a href=\"https://github.com/soundcloud/master_slave_adapter\">be smarter about how Rails accesses databases</a>, <a href=\"https://github.com/soundcloud/empipelines\">process a huge number of messages</a>, and more. In the end we have decided to fundamentally change the way we build products, as we felt we were always patching the system and not resolving the fundamental scalability problem.</p> \n<p>The first change was in our architecture. We decided to move towards what is now known as a <em><a href=\"http://martinfowler.com/articles/microservices.html\">microservices architecture</a></em>. In this style, engineers separate domain logic into very small components. These components expose a well-defined API, and implement a <a href=\"http://martinfowler.com/bliki/BoundedContext.html\">Bounded Context</a> —including its persistence layer and any other infrastructure needs.</p> \n<p>Big-bang refactoring has bitten us in the past, so the team decided that the best approach to deal with the architecture changes would not be to split the Mothership immediately, but rather to not add anything new to it. All of our new features were built as microservices, and whenever a larger refactoring of a feature in the Mothership was required, we extract the code as part of this effort.</p> \n<p>This started out very well, but soon enough we detected a problem. Because so much of our logic was still in the Rails monolith, pretty much all of our microservices had to talk to it somehow.</p> \n<p>One option around this problem was to have the microservices accessing directly the Mothership database. This is a very common approach in some corporate settings, but because this database is <a href=\"http://martinfowler.com/ieeeSoftware/published.pdf\">a <em>Public</em>, but not <em>Published Interface</em></a>, it usually leads to many problems when we need to change the structure of shared tables.</p> \n<p>Instead, we went for the only <em>Published Interface</em> we had, which was the Public API. Our internal microservices would behave exactly like the applications developed by third-party organizations integrate with the SoundCloud platform.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 700px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/35484a6b037a3e0c87ce0a91acfaf724/67d4f/product-engineering-diagram-2.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 62.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe7UK0P/xAAWEAADAAAAAAAAAAAAAAAAAAAQESD/2gAIAQEAAQUChj//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAYEAADAQEAAAAAAAAAAAAAAAAAASEQQf/aAAgBAQABPyHgijdFWf/aAAwDAQACAAMAAAAQEw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhMRBRYXH/2gAIAQEAAT8QL0MXpgTVHwldo5Ty4iCjPH//2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Diagram 2\" title=\"Diagram 2\" src=\"https://developers.soundcloud.com/blog/static/35484a6b037a3e0c87ce0a91acfaf724/67d4f/product-engineering-diagram-2.jpg\" srcset=\"/blog/static/35484a6b037a3e0c87ce0a91acfaf724/f544b/product-engineering-diagram-2.jpg 200w,\n/blog/static/35484a6b037a3e0c87ce0a91acfaf724/41689/product-engineering-diagram-2.jpg 400w,\n/blog/static/35484a6b037a3e0c87ce0a91acfaf724/67d4f/product-engineering-diagram-2.jpg 700w\" sizes=\"(max-width: 700px) 100vw, 700px\" loading=\"lazy\" /> </a> </span></p> \n<p>Soon enough, we realized that there was a big problem with this model; as our microservices needed to react to user activity. The push-notifications system, for example, needed to know whenever a track had received a new comment so that it could inform the artist about it. At our scale, polling was not an option. We needed to create a better model.</p> \n<p>We were already using AMQP in general and RabbitMQ in specific — In a Rails application you often need a way to dispatch slow jobs to a <em>worker</em> process to avoid hogging the concurrency-weak Ruby interpreter. <a href=\"http://www.infoq.com/presentations/amqp-soundcloud\">Sebastian Ohm and Tomás Senart presented the details of how we use AMQP</a>, but over several iterations we developed a model called <em>Semantic Events</em>, where changes in the domain objects result in a message being dispatched to a broker and consumed by whichever microservice finds the message interesting.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 700px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/56bd8881dd8a35df5789994673747f9b/67d4f/product-engineering-diagram-3.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 62.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3WBmP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABsQAAICAwEAAAAAAAAAAAAAAAABITEQEUFR/9oACAEBAAE/IeFeIkbkT3eP/9oADAMBAAIAAwAAABADz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQACAwADAAAAAAAAAAAAAAEAESExQRBRcf/aAAgBAQABPxAvQ72GHD5UD2I5QrVxEGQ+P//Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Diagram 3\" title=\"Diagram 3\" src=\"https://developers.soundcloud.com/blog/static/56bd8881dd8a35df5789994673747f9b/67d4f/product-engineering-diagram-3.jpg\" srcset=\"/blog/static/56bd8881dd8a35df5789994673747f9b/f544b/product-engineering-diagram-3.jpg 200w,\n/blog/static/56bd8881dd8a35df5789994673747f9b/41689/product-engineering-diagram-3.jpg 400w,\n/blog/static/56bd8881dd8a35df5789994673747f9b/67d4f/product-engineering-diagram-3.jpg 700w\" sizes=\"(max-width: 700px) 100vw, 700px\" loading=\"lazy\" /> </a> </span></p> \n<p>This architecture enabled <a href=\"http://martinfowler.com/eaaDev/EventSourcing.html\"><em>Event Sourcing</em></a>, which is how many of our microservices deal with shared data, but it did not remove the need to query the Public API —for example, you might need all fans of an artist and their email addresses to notify them about a new track.</p> \n<p>While most of the data was available through the Public API, we were constrained by the same rules we enforced on third-party applications. It was not possible, for example, for a microservice to notify users about activity on private tracks as users could only access public information.</p> \n<p>We explored several possible solutions to the problem. One of the most popular alternatives was to extract all of the ActiveRecord models from the Mothership into a Ruby gem, effectively making the Rails model classes a <em>Published Interface</em> and a shared component. There were several important issues with this approach, including the overhead of versioning the component across so many microservices, and that it became clear that microservices would be implemented in languages other than Ruby. Therefore, we had to think about a different solution.</p> \n<p>In the end, the team decided to use Rails’ features of <em>engines</em> (or <em>plugins</em>, depending on the framework’s version) to create an Internal API that is available only within our private network. To control what could be accessed internally, we used Oauth 2.0 when an application is acting on behalf of a user, with different authorisation scopes depending on which microservice needs the data.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 700px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/1a6422e826679f9dcc889cdb99f83952/67d4f/product-engineering-diagram-4.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 62.71428571428571%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe6Q0o//xAAVEAEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAQABBQKrf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAMAAwEAAAAAAAAAAAAAAAABERAhMYH/2gAIAQEAAT8hXBeGyDgnYsf/2gAMAwEAAgADAAAAEPPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAQACAgMAAAAAAAAAAAAAAREAMRBBIVFx/9oACAEBAAE/EK013THCkHyYHsYngdXK0KPH/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Diagram 4\" title=\"Diagram 4\" src=\"https://developers.soundcloud.com/blog/static/1a6422e826679f9dcc889cdb99f83952/67d4f/product-engineering-diagram-4.jpg\" srcset=\"/blog/static/1a6422e826679f9dcc889cdb99f83952/f544b/product-engineering-diagram-4.jpg 200w,\n/blog/static/1a6422e826679f9dcc889cdb99f83952/41689/product-engineering-diagram-4.jpg 400w,\n/blog/static/1a6422e826679f9dcc889cdb99f83952/67d4f/product-engineering-diagram-4.jpg 700w\" sizes=\"(max-width: 700px) 100vw, 700px\" loading=\"lazy\" /> </a> </span></p> \n<p>Although we are constantly removing features from the Mothership, having both a <em>push</em> and <em>pull</em> interface to the old system makes sure that we do not couple our new microservices to the old architecture. The microservice architecture has proven itself crucial to developing production-ready features with much shorter feedback cycles. External-facing examples are <a href=\"http://techcrunch.com/2013/03/11/soundclouds-new-moving-sounds-feature-holds-promise-for-ads-viral-content-like-tumblrs-gifs/\">the visual sounds</a>, and <a href=\"https://blog.soundcloud.com/2014/03/04/new-soundcloud-stats/\">the new stats system</a>.</p>","descriptionType":"html","publishedDate":"Wed, 11 Jun 2014 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/ebb4b534084c91b368f7641a794fd7cb/67d4f/product-engineering-diagram-1.jpg","linkMd5":"fac53914c7e6fee9d4560f99a93a3063","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn98@2020_4/2020/08/25/00-49-39-787_600f8f968ae79053.webp","destWidth":700,"destHeight":261,"sourceBytes":10976,"destBytes":9594,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/ebb4b534084c91b368f7641a794fd7cb/67d4f/product-engineering-diagram-1.jpg":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn98@2020_4/2020/08/25/00-49-39-787_600f8f968ae79053.webp","https://developers.soundcloud.com/blog/static/35484a6b037a3e0c87ce0a91acfaf724/67d4f/product-engineering-diagram-2.jpg":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn77@2020_2/2020/08/25/00-51-41-375_3974ff2581464d2b.webp","https://developers.soundcloud.com/blog/static/56bd8881dd8a35df5789994673747f9b/67d4f/product-engineering-diagram-3.jpg":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn19@2020_1/2020/08/25/00-51-40-809_44f51307a9328cf9.webp","https://developers.soundcloud.com/blog/static/1a6422e826679f9dcc889cdb99f83952/67d4f/product-engineering-diagram-4.jpg":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn22@2020_2/2020/08/25/00-51-43-317_821440c53dcb271e.webp"},"publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Smooth image loading by upscaling","link":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","description":"<p>The site <code class=\"language-text\">soundcloud.com</code> is a single-page application that displays a multitude of users’ images. At SoundCloud, we use a technique to make the loading of an image appear smooth and fast. When displaying an image on screen, we want it to display to the user as fast as possible. The images display in multiple locations from a tiny avatar on a waveform to a large profile image. For this reason, we create each image in several sizes. If you are using <a href=\"http://en.gravatar.com/site/implement/images/\" title=\"Gravatar\">Gravatar</a>, this technique also applies because you can fetch arbitrarily-sized images by passing the desired size in a query parameter (<code class=\"language-text\">?s=</code>).</p> \n<p><img src=\"https://developers.soundcloud.com/blog/assets/posts/avatar-tiny.jpg\" alt=\"avatar-tiny\"> <img src=\"https://developers.soundcloud.com/blog/assets/posts/avatar-small.jpg\" alt=\"avatar-small\"> <img src=\"https://developers.soundcloud.com/blog/assets/posts/avatar-medium.jpg\" alt=\"avatar-medium\"> <img src=\"https://developers.soundcloud.com/blog/assets/posts/avatar-large.jpg\" alt=\"avatar-large\" /></img></img></img></p> \n<p>The technique uses the browser’s cache of previously loaded images. When displaying a large avatar image, first display a smaller version that is stretched out to full size. When the larger image has loaded, it fades in over the top of the smaller version.</p> \n<p>The HTML looks like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"html\">\n <pre class=\"language-html\"><code class=\"language-html\">![](small.jpg)\n![](large.jpg)</code></pre>\n</div> \n<p>The CSS looks like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"css\">\n <pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.fullImage</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> opacity 0.2s linear<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>For the sake of brevity, the positioning code is not included in the preceding snippet. However, the images should lie atop one another.</p> \n<p>Finally, the JavaScript code looks like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> fullImage   <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.fullImage'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    placeholder <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.placeholder'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nfullImage\n  <span class=\"token punctuation\">.</span><span class=\"token function\">css</span><span class=\"token punctuation\">(</span><span class=\"token string\">'opacity'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'load'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>opacity <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>placeholder<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span>placeholder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<iframe src=\"http://codepen.io/spadgos/full/GmFfz\" width=\"100%\" height=\"280\" frameborder=\"no\" scrolling=\"no\"></iframe> \n<p>Thus far, it’s not too complicated, and it gives a nice effect to the loading of images.</p> \n<p>But there’s a problem: we don’t want to make a request to get the small image just to display it for a few milliseconds. The overhead of making HTTP requests means that loading the larger image will usually not take significantly longer than the small one. Therefore, it only makes sense to use this technique if a smaller image has already been loaded during a particular session and thus served from the browser’s cache. How do we know what images are in cache? Each time an avatar is loaded, we need to keep track of that. However over time, there could be many thousands of avatars loaded within one session, so it needs to be memory efficient. Instead of tracking the full URLs of loaded images, we extract the minimum amount of information to identify a image, and use a bitmask to store what sizes have been loaded:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// a simple map object, { identifier =&gt; loaded sizes }</span>\n<span class=\"token keyword\">var</span> loadedImages <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// Let's assume a basic url structure like this:</span>\n  <span class=\"token comment\">// \"http://somesite.com/{identifier}-{size}.jpg\"</span>\n  imageRegex <span class=\"token operator\">=</span> <span class=\"token regex\">/\\/(\\w+)-(\\w+)\\.jpg$/</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token comment\">// a list of the available sizes.</span>\n  <span class=\"token comment\">// format is [pixel size, filename representation]</span>\n  sizes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"tiny\"</span>  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"small\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"medium\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"large\"</span> <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// extract the identifier and size.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">storeInfo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> parts <span class=\"token operator\">=</span> imageRegex<span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      id    <span class=\"token operator\">=</span> parts<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n      size  <span class=\"token operator\">=</span> parts<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      index<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// find the index which contains this size</span>\n  sizes<span class=\"token punctuation\">.</span><span class=\"token function\">some</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">info<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> size<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      loadedImages<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">|=</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> index<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// once the image has loaded, then store it into the map</span>\n<span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.fullImage'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">storeInfo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>src<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>When the image loads, we extract the important parts from the URL: namely, the identifier and the size modifier. Each size is mapped to a number—its index in the <code class=\"language-text\">sizes</code> array—and the appropriate bit is turned on in the <code class=\"language-text\">loadedImages</code> map. The code on line 27 does this conversion and bit manipulation; <code class=\"language-text\">1 &lt;&lt; index</code> is essentially the same as <code class=\"language-text\">Math.pow(2, index)</code>. By storing only a single number in the object, we save quite a bit of memory. A single-number object could contain many different flags. For example, assume there are four different sizes and 10,000 images in the following map:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\">asBools <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  a<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  b<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// etc...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nasInts <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  a<span class=\"token punctuation\">:</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 2^0 + 2^1 + 2^3 = 1 + 2 + 8</span>\n  b<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>   <span class=\"token comment\">// 2^1</span>\n  <span class=\"token comment\">// etc...</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>The memory footprints of these objects differ by 30%: 1,372,432 bytes for the booleans, and 1,052,384 for the integers. The key names consume the largest portion of these objects’ memory. For this reason, it is important to compress the key names as much as possible. Numeric keys are stored particularly efficiently by the V8 JavaScript engine found in Chrome and Safari.</p> \n<p>We now have a map that shows us what images have been loaded during this session, and you can use that information to choose a placeholder:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// find the largest image smaller than the requested one</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getPlaceholder</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fullUrl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> parts <span class=\"token operator\">=</span> imageRegex<span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span>fullUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      id <span class=\"token operator\">=</span> parts<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      targetSize <span class=\"token operator\">=</span> parts<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      targetIndex<span class=\"token punctuation\">;</span>\n\n  sizes<span class=\"token punctuation\">.</span><span class=\"token function\">some</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">info<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>info<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> targetSize<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      targetIndex <span class=\"token operator\">=</span> index<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>targetIndex <span class=\"token operator\">&gt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>loadedImages<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> targetIndex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> fullUrl<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>\n        <span class=\"token regex\">/\\w+\\.jpg$/</span><span class=\"token punctuation\">,</span>\n        sizes<span class=\"token punctuation\">[</span>targetIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">'.jpg'</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">--</span>targetIndex<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// and in usage:</span>\n<span class=\"token keyword\">var</span> placeholderUrl <span class=\"token operator\">=</span> <span class=\"token function\">getPlaceholder</span><span class=\"token punctuation\">(</span>fullSizeUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>placeholderUrl<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// there has been a smaller image loaded previously, so...</span>\n  <span class=\"token function\">addTheFadeInBehaviour</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// no smaller image has been loaded so...</span>\n  <span class=\"token function\">loadFullSizeAsNormal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>Although, this technique is a bit involved and I’ve deliberately glossed over some of the details, it creates a nice visual effect, greatly reduces the perceived load time of the image, and it is especially effective for long-lived, single-page applications.</p>","descriptionType":"html","publishedDate":"Thu, 20 Feb 2014 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/assets/posts/avatar-tiny.jpg","linkMd5":"f06f2d936ee74736092a85c8c87ad630","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/assets/posts/avatar-tiny.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","https://developers.soundcloud.com/blog/assets/posts/avatar-small.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","https://developers.soundcloud.com/blog/assets/posts/avatar-medium.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","https://developers.soundcloud.com/blog/assets/posts/avatar-large.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg"},"publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Building Clojure Services at Scale","link":"https://developers.soundcloud.com/blog/building-clojure-services-at-scale","description":"<p>SoundCloud has a service-oriented architecture, which allows us to use different languages for different services. With concurrency and scaling in mind, we started to build some services in Clojure due to its interoperability with the JVM, the availability of good quality libraries, and we just plain like it as a language.</p> \n<p>How do you build distributed, robust, and scalable micro-services in Clojure? <a href=\"http://blog.josephwilk.net/clojure/building-clojure-services-at-scale.html\">Read what Joseph Wilk, an engineer and Clojure enthusiast at SoundCloud, has to say</a>.</p>","descriptionType":"html","publishedDate":"Fri, 20 Sep 2013 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"b671cad0f9e6cef9925e5394d5a21a48","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Front-end JavaScript bug tracking","link":"https://developers.soundcloud.com/blog/front-end-javascript-bug-tracking","description":"<p>Proper and effective error tracking is a common issue for front-end JavaScript code compared to back-end environments.</p> \n<p>We felt this pain as well and experimented with different solutions over the past months on the<a href=\"https://m.soundcloud.com/\"> SoundCloud Mobile site</a>.</p> \n<h3>Analytics</h3> \n<p>The first approach we had was to track errors with<a href=\"http://www.google.com/analytics/\"> Google Analytics</a>. Their library permits to fire custom events and whenever an ajax error would occur, we would log it.</p> \n<p>The biggest benefit of this tool is to monitor the stability of the site and its evolution in longer periods as you can easily go back a few weeks or months to see which events were triggered. Also, it is easy to implement – almost a one-liner!</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 505px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/9cbc68dfac58d901f12708b3843f7601/8939e/google-analytics-report.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.603960396039604%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABTUlEQVQoz12Q2XbDIAxE/f+f2DatEydewZjVNtiZSmRp0od7kGA0SCr26xUPQFwJESJqu2LddtAl9n0n/nSZR/7vrcDdiAs3ejyogA/p8cXnGJDupm9cX+P97b4QPqJxKzo6z2ZBYxdMS8q0FJ/0jIsOqJRDTe+1man7BZ27aVuqZR3Hg19RNF2Pn+MR5emMqu4g5AgpJYQQ8M5CGwOlDSZjn4hRoZMKUk0YSMsn30mimJTC4fsH5bHCMAhME4mGIeOcQwgBkszLsoQxGqw/HU/ohcKlblDXNYzWOFdVrinmZYGcHIbJI8aElBK2bcvEGDP8Sd/36GiaZV3zJzORUsRK+UIeXGetQ2GtRdlIfJ4FRuOR4k3EPAwVddW2be6Gczbk7tlknmd4H3I88sjeezRSo+qpC2WfJq8Y2iPvlEfinE1CuJlwd5xzrGnXv7agaGq2wFGkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"google analytics report\" title=\"google analytics report\" src=\"https://developers.soundcloud.com/blog/static/9cbc68dfac58d901f12708b3843f7601/8939e/google-analytics-report.png\" srcset=\"/blog/static/9cbc68dfac58d901f12708b3843f7601/9ec3c/google-analytics-report.png 200w,\n/blog/static/9cbc68dfac58d901f12708b3843f7601/c7805/google-analytics-report.png 400w,\n/blog/static/9cbc68dfac58d901f12708b3843f7601/8939e/google-analytics-report.png 505w\" sizes=\"(max-width: 505px) 100vw, 505px\" loading=\"lazy\" /> </a> </span></p> \n<p>The drawback, at least for Google Analytics, is that this tool is not meant to track bugs. There is no way to add custom data to these events to get more insight about why and how an error happened, it also doesn’t work in real-time, and you obviously want that when you debug.</p> \n<p>So we kept Analytics in place for a long-term view, but took a look at other options for real-time and in-depth tracking.</p> \n<h3>Airbrake</h3> \n<p>In our pursuit of getting more insight, we decided to take a look at <a href=\"http://airbrake.io\">Airbrake</a> because we were already using it to track back-end errors on our main site.</p> \n<p>Our mobile site runs on Node.js, the first thing we did was to integrate an existing <a href=\"https://github.com/felixge/node-airbrake\">plugin</a> for it to handle error tracking on the back-end as well.</p> \n<p>Looking a little further we found a <a href=\"http://www.airbrakeapp.com/javascripts/notifier.js\">front-end notifier</a>, which would catch errors that would fire on window.onerror, but there was no way to report any custom errors.</p> \n<p>We decided to take a day to hack this on our own since their API is public and easy to implement.</p> \n<p>The benefits of Airbrake were instant. We could see what triggered which error, how, why, in which context, which browser, etc… in real-time!</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 505px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/38c24f5d0a997a90e334c014ae8479e5/8939e/airbrake-report.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 33.46534653465347%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAAwElEQVQoz5VRWw7DIAzj/ves1FIeaxnhXY+grX9UWiQrRAq2k4haKzhiTFDaYFca+8gG1tqOF0yvc864rguttZFnENzAoE5oXcBJBQdlvHxGbRd+wT0s/gTuESGEoe69hztP5BQRyCMGQkrpL5RSINZ1HVaZeNs2aK1xHCece3fV7n7iZAYROxE/mJ1dhm/NMdvTI6ELZXxmwmVZoJSClBLGmEHOIE8goluwc86PUmq7l77LfYxsje0ju+khnq78Acg6JJzzSWpsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"airbrake report\" title=\"airbrake report\" src=\"https://developers.soundcloud.com/blog/static/38c24f5d0a997a90e334c014ae8479e5/8939e/airbrake-report.png\" srcset=\"/blog/static/38c24f5d0a997a90e334c014ae8479e5/9ec3c/airbrake-report.png 200w,\n/blog/static/38c24f5d0a997a90e334c014ae8479e5/c7805/airbrake-report.png 400w,\n/blog/static/38c24f5d0a997a90e334c014ae8479e5/8939e/airbrake-report.png 505w\" sizes=\"(max-width: 505px) 100vw, 505px\" loading=\"lazy\" /> </a> </span> <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 505px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/6adc22b6d275182f0745fe733a9b3d36/8939e/airbrake-report-cont.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 35.84158415841585%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAArklEQVQoz5WR2wqFIBRE/f8vDe9aZkk1Z49g0MOBEoZ5UNeMbhWChzUGIQTs+47zPHFd1+1fpbzzMNpgXVeUUrq4cRxHh36VYjPnXBdhKWVwjcQ3TZ9ALw3lydQyz3DWwUtIzhlZ4GyeU4KXc0mcijHeTvE1A6wIstZiWQq2bcM0TdBa96bjG+i89E+PhkxmChM4lFlaEkxQrbXD6K+Hwr9jo9ZaBxEwFg8MfzuUHzAtI5dhUGXiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"airbrake report cont\" title=\"airbrake report cont\" src=\"https://developers.soundcloud.com/blog/static/6adc22b6d275182f0745fe733a9b3d36/8939e/airbrake-report-cont.png\" srcset=\"/blog/static/6adc22b6d275182f0745fe733a9b3d36/9ec3c/airbrake-report-cont.png 200w,\n/blog/static/6adc22b6d275182f0745fe733a9b3d36/c7805/airbrake-report-cont.png 400w,\n/blog/static/6adc22b6d275182f0745fe733a9b3d36/8939e/airbrake-report-cont.png 505w\" sizes=\"(max-width: 505px) 100vw, 505px\" loading=\"lazy\" /> </a> </span></p> \n<p>It also counts errors, which can help you prioritize and include fixes in your roadmap.</p> \n<p>However, the lack of filtering, grouping and custom sorting made it difficult to work with. There was also no sense of time or progress, as everything just gets dumped into a single list ordered by time. We needed something a little better than that.</p> \n<h3>BugSense</h3> \n<p>That’s when our Android team showed us their <a href=\"http://www.bugsense.com/\">BugSense</a> implementation. BugSense seemed to address all of these issues we had with Airbrake: grouping is more effective, searching and filtering is possible, charts of errors are drawn as well.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 505px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/9591325255d4ef940a2fc6c20f1793fa/8939e/bugsense-report.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.68316831683168%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABW0lEQVQoz32O3UrDQBCF82Zqm1b6Pl6Ib1DfoILoRZ9C8EJBpSJF+rtttIlJdnd2Z/PTJC21VXHTWghihY+zZ4dzhjFqNbN6aJbMkqZcKZvVilk111okD+wf7J0cH11enDfOGs1ms35aN27b1lPXssbjISG27bi+53oF3Fwdx7FGYzKeXD0MWu3+iAx7vT4hxLh5Zh0LlJRSyACDXcRB6FO8brPBq1BCcgo6bySBCqVEoVAiip1IgYHEJERFqU4qHZZoMArAxT+1IsCE0x8qDPJ1IA3OhH6UVLvAohdoPbb4m0snjp4b+s99Bhq6xd/qj+GCcu1zdX1yfzfpdO1uLz97fYCQDAQDWKtgvKAAukP5xnC9y6PgU+5R3TIcCi8u8CgNk7/BKHYpD6cpqMADEWWzKM1kFHN9NleRzdDzWJhk84+v2erzF+n7SsbTZLGM5wuVZJvhdLHEZP4N3R/+xzN1DIMAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"bugsense report\" title=\"bugsense report\" src=\"https://developers.soundcloud.com/blog/static/9591325255d4ef940a2fc6c20f1793fa/8939e/bugsense-report.png\" srcset=\"/blog/static/9591325255d4ef940a2fc6c20f1793fa/9ec3c/bugsense-report.png 200w,\n/blog/static/9591325255d4ef940a2fc6c20f1793fa/c7805/bugsense-report.png 400w,\n/blog/static/9591325255d4ef940a2fc6c20f1793fa/8939e/bugsense-report.png 505w\" sizes=\"(max-width: 505px) 100vw, 505px\" loading=\"lazy\" /> </a> </span></p> \n<p>There is one more benefit over Airbrake… JSON. No need to convert objects to XML strings anymore!</p> \n<p>If you are interested in our BugSense notifier you can find the <a href=\"https://github.com/soundcloud/Bugsense-js\">source on github</a>.</p> \n<h3>Conclusion</h3> \n<p>There is still a lot of work needed to make front-end JS debugging as easy as it is for regular back-end environments. For example, stack traces today aren’t that useful, because of anonymous objects and minified code, but hopefully browser vendors will tackle these issues soon. Maybe <a href=\"http://www.infoq.com/news/2011/08/debug-languages-on-javascript-vm\">Source Maps</a> could be the first milestone in this quest.</p> \n<p>At SoundCloud, we will continue to use a combination of these tools because of the different strengths outlined above, but there are also other tools we didn’t try out yet like <a href=\"http://www.getexceptional.com/\">getexceptional</a> or <a href=\"http://errorception.com/\">errorception</a>. If you have tried these, or if you have any suggestion on this subject we’d like to get your feedback in the comments below.</p> \n<p>Happy debugging!</p>","descriptionType":"html","publishedDate":"Mon, 21 Nov 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/9cbc68dfac58d901f12708b3843f7601/8939e/google-analytics-report.png","linkMd5":"faf31d858376c6584d716294eeb6cc11","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn90@2020_5/2020/08/25/00-49-38-600_0ab6b8e36480255a.webp","destWidth":505,"destHeight":200,"sourceBytes":10503,"destBytes":8956,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/9cbc68dfac58d901f12708b3843f7601/8939e/google-analytics-report.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn90@2020_5/2020/08/25/00-49-38-600_0ab6b8e36480255a.webp","https://developers.soundcloud.com/blog/static/38c24f5d0a997a90e334c014ae8479e5/8939e/airbrake-report.png":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn12@2020_2/2020/08/25/00-51-45-353_1d57d87e7c94be10.webp","https://developers.soundcloud.com/blog/static/6adc22b6d275182f0745fe733a9b3d36/8939e/airbrake-report-cont.png":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn65@2020_1/2020/08/25/00-51-43-156_2c7fa33af3697c7c.webp","https://developers.soundcloud.com/blog/static/9591325255d4ef940a2fc6c20f1793fa/8939e/bugsense-report.png":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn17@2020_5/2020/08/25/00-51-41-750_487a6afafaede7de.webp"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Project Necromancy","link":"https://developers.soundcloud.com/blog/project-necromancy","description":"<p>Or, how to raise a project from the dead with tools you probably have lying around at home.</p> \n<!-- more --> \n<h2>Background</h2> \n<p>In a perfect world, every project would flow smoothly — from requirement gathering, to implementation, to acceptance by stakeholders, to launch. Sadly, we don’t live in a perfect world. Sometimes projects hit bumps in the road due to changing business requirements, market conditions, or a host of other factors. This post describes our experiences managing a project that was deprioritized during implementation and lay dormant for an extended period of time before resuming in a different form.</p> \n<h2>The Life and Death of Project Mark I</h2> \n<p>The original incarnation of the project in question would have added a feature to an internal tool with significant use across different areas of SoundCloud.</p> \n<p>For this project, we added a new microservice to our backend architecture. We deployed and integrated this service without any functionality to begin with, and then we set about building (though not yet deploying) the service’s feature set.</p> \n<p>We suffered a minor setback in feature development when a crucial, overlooked edge case came to light and forced a partial redesign of one service component. This resulted in our having to throw away the code we’d written for the component and start again. It was not a significant development in and of itself, but it later informed our thinking about this component. We felt we’d learned an important lesson from the initial mistake and any further changes to the component would risk reintroducing the design flaw.</p> \n<p>Otherwise, the project was going fine… Until the day it was suddenly canceled. Our product roadmap had shifted. The functionality we were building was no longer important. The team’s energy needed to focus elsewhere.</p> \n<p>We discussed removing our new, currently non-functional service altogether, but we decided to leave it in place. After all, it wasn’t doing any harm, and perhaps the project would resume one day. We also preserved our partially finished feature code in a git branch, just in case.</p> \n<p>Then we moved on and largely forgot about our seemingly doomed project.</p> \n<h2>Interlude</h2> \n<p>The next several months saw our team merge with another team and several individual team members move to unrelated areas within SoundCloud. Meanwhile, our product roadmap continued to evolve, and the functionality we’d started to deliver with Project Mark I, previously unimportant, eventually became important again. Or rather, certain aspects of the functionality became important again.</p> \n<p>Four months after the original project’s cancellation, we were ready to resume developing a subset of its features with a team that contained almost none of the original engineers.</p> \n<h2>The Project Reanimated</h2> \n<p>We had to make a decision. Should Project Mark II build on the work we’d done for Project Mark I or not? Project Mark II contained only some of the planned Mark I features. Was there enough commonality to resume the old project, or would it be easier to start afresh?</p> \n<p>We decided to reuse as much of the Mark I code and documentation as possible. And after an abbreviated requirements phase, we set to work building Mark II on top of the existing Mark I codebase and data model.</p> \n<p>Picking up unfinished code written by engineers who were no longer on the team presented challenges, but not the typical challenges of working with legacy code. We had no problems with documentation, technical debt, or understanding the existing code. Instead, we developed a cognitive anchor effect around choices the previous engineers had made. We were reluctant to question design decisions because: “They must have done that for good reason.” This was especially the case given that we knew an earlier design mistake had necessitated a partial code rework. We thought we were incorporating earlier learnings by leaving things as they were and that we risked repeating the earlier mistake if we changed things.</p> \n<p>The engineers who wrote the initial code were all still at SoundCloud and would have been happy to answer questions, but they were also busy with their new teams, and we didn’t want to bother them. As it turned out, we should have bothered them more.</p> \n<p>Another group we should have bothered more was our set of stakeholders in SoundCloud’s product organization. This became apparent when we demonstrated Mark II’s functionality to them only near the end of the project, and at that demo, learned a crucial fact: a major feature we’d built for them was not needed. Unfortunately, the concept behind this feature was “baked into” the data model we’d reused, unchanged from the original Mark I project where it had been a hard requirement. As we’d failed to question the original data model, we’d also failed to question the need for this complicated feature that we had spent a considerable amount of time building.</p> \n<p>Oops.</p> \n<p>It didn’t make sense to support this feature if it wasn’t needed, especially as it complicated the user interface. We therefore made the somewhat painful decision to push back our launch while we removed the feature and simplified the data model. While the delay was frustrating, we felt it was important to deliver the right project, even if that meant delivering later. Today, Project Mark II has many happy users, so we believe we made the right decision.</p> \n<h2>Lessons Learned</h2> \n<p>Difficult or frustrating situations nevertheless yield valuable knowledge for the future. That said, here are some of the things we discovered over the lifetime of these projects.</p> \n<h3>Reanimated Projects Are Changed Projects</h3> \n<p>We thought of Project Mark II as a direct continuation of Project Mark I. This was only partially accurate. The decision to reuse the Mark I code and data model introduced an implicit assumption into Mark II: “When in doubt, old decisions are right.” While reusing the existing work certainly saved us substantial time and effort, the cognitive bias against questioning the existing work also cost us substantial time and effort.</p> \n<h3>Requirements Are Even More Important Than Usual</h3> \n<p>Getting requirements right is important in any project. It’s also hard, and it’s even harder when the requirements have a high chance of becoming outdated or being misunderstood.</p> \n<p>When we started Project Mark II, we revalidated some of the Mark I requirements, but we should have rerun the project’s entire requirements phase afresh. This would have forced us to examine requirements that had already become code. It would have also forced us to engage with our stakeholders, who were scattered across multiple teams and multiple geographic locations, and to have conversations we didn’t know we needed to have.</p> \n<h3>Show Your Work</h3> \n<p>Finally, given the project’s unusual lifecycle, we should have demoed our progress much sooner than we did. We don’t generally do sprint demos in our team, but in this case, it would have saved us a lot of effort.</p> \n<h2>TL;DR</h2> \n<p>When resurrecting an unfinished, dormant project:</p> \n<ul> \n <li>Revisit your requirements. All of them.</li> \n <li>Revisit your existing code. All of it.</li> \n <li>Be conscious of cognitive biases that say, “But someone decided that earlier.”</li> \n <li>Adopt a flexible mindset. Be prepared to change course.</li> \n <li>Communicate with stakeholders even more than usual.</li> \n</ul>","descriptionType":"html","publishedDate":"Tue, 05 Jun 2018 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"bcc842c7e8507d35012c39635ff5131c","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569988},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Leveraging frameworks to speed up our development on iOS - Part 1","link":"https://developers.soundcloud.com/blog/leveraging-frameworks-to-speed-up-our-development-on-ios-part-1","description":"<p>Growth in code bases come with exciting scalability challenges. As the size of our iOS codebase and team at SoundCloud grew, we faced challenges: long compile times and conflicts. Our productivity started to suffer as a result. We took inspiration from the work done in the backend (<a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith\">Building Products at SoundCloud</a>) and applied it to mobile development. The main goal was to get back to a state where development is fun, fast, and would scale as the number of contributors grew. We modularized our iOS project by splitting it up into modules with well-defined responsibilities and public interfaces that interconnect them.</p> \n<!-- more --> \n<p>It’s been a little over a year since we started our journey towards a modularized iOS app and we’re very happy with the results that we’ve achieved so far. In this series of posts we’ll talk about the modularization journey, the motivation behind deciding for modularizing the app, a technical overview of the approach, and the impact it has on developers when they work on new features.</p> \n<h2>Context</h2> \n<p>Originally, the iOS app was organized in two targets: one target that compiled the main app, and another target that compiled and ran the unit tests. The source code was mainly Objective-C, although some developers had already started adding Swift to the codebase. Moreover, the project used <a href=\"https://cocoapods.org\">CocoaPods</a> to fetch and statically link around 20 dependencies. The product was growing at a good pace and so did the size of the two main targets. The build time became very high, and the lack of some control over how things were getting imported triggered clean builds when a single file was modified. Waiting for the build gave us the perfect amount of time to grab a coffee, but we’d have a serious problem with our caffeine intake if we didn’t do anything about it. In a team of 10 people, doing 20 clean builds per day, each taking 7 minutes, the cost was 1400 minutes, 23.3 hours, or 3 days of work. These build were a waste of time and money. Also, delivering features took too long compared with our other platforms.</p> \n<p>On top of all that, CocoaPods and our git branch-based workflow made the problem worse as we had to run <code class=\"language-text\">pod install</code> on most branch switches <em>(It’s worth noting that CocoaPods has improved a lot since. The latest version prevents Xcode from invalidating its build cache after running pod install.)</em>.</p> \n<h2>Why modularization</h2> \n<p>Most of our development time went into the compilation of the huge app and tests target. We undertook research by looking at peer companies and conducting interviews. After careful research we put all the options on the table and decided towards splitting the iOS app into modules. With smaller compilation targets, modules would take much less time to compute and run, and developers could quickly iterate over better solutions. Moreover, smaller targets would encourage good API design, and allow us to leverage tools like <a href=\"https://www.apple.com/swift/playgrounds/\">Playgrounds</a> and example apps to iterate on features without compiling the main app.</p> \n<p>Our research showed that most companies going through this transition had bigger teams than us, including teams dedicated to building and maintaining tools to facilitate their transition. We had to come up with a plan to gradually transition to building modular features, iterating over the new architecture while still allowing the team to build features.</p> \n<p>Some companies are very successful using React Native, including SoundCloud with <a href=\"https://itunes.apple.com/us/app/soundcloud-pulse/id1074278256\">Pulse</a>. We ruled out that option because the framework comes with integration costs that we could not assume in the listener application: tooling maintenance and training for instance. However, React Native makes a lot of sense for some features and we may reconsider it in the future.</p> \n<h2>Advantages</h2> \n<h3>Clean interfaces (APIs)</h3> \n<p>When all the code is in the same target, having access to any other class is a matter of importing a header <em>(Objective-C)</em>, or having an internal access level <em>(the default one in Swift)</em>. It’s flexible, but at the same time dangerous since it allows everyone to create dependencies with almost no control. Having no control over how dependencies get imported leads to a very messy dependency graph, coupled code, and eventually to unpredictable states propagating through that graph. In a small app, with a small team, you can avoid these issues with code review. However, with our application and our team this was too hard to do.</p> \n<p>Modules help you prevent these issues by exposing an API that you as a developer need to define. As part of your workflow, you need to define how the API of your module will look like and how consumers of your API will interact with it. In Objective-C that means specifying which headers will be public, and in Swift, which components will have the public access level. An API defines a contract in the same way REST APIs do, and developers who consume your API will have to comply with it.</p> \n<h3>Example apps</h3> \n<p>Since modules include standalone features they can include example app for testing the features without the main iOS application. We recently built the new home screen in a separate app using test data, which allowed us to test different scenarios:</p> \n<ul> \n <li>Having tracks with long titles that exceed the limit of the label.</li> \n <li>Having tracks with no artwork.</li> \n <li>Having no data because of a connection error.</li> \n</ul> \n<p>With example apps, you can iterate on your feature with fast build and test times, designing the public API that the main application will eventually use. Following with the example above, the home feature would expose a view controller that the main application would push on the view hierarchy.</p> \n<p>The image below shows the structure of one of our modules that include an example app that you can experiment with.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/8036afa4de908d212e78fd25f6bbbadf/9bac8/ios-example-app.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 55.67805953693495%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACRklEQVQoz42Ty08TURTGJ/4BgkYwshEoFK0IKzHRaHyhppgYjVt3mqAkmhjQYGx1gXvcYFr8N3AjC/fGsR1a2jK282jnaae0dDrT1Laf945prUYTT3JyH7nzm++e812mUilDFAVYlgXHcWDbNuyaA7O0563bbUBTZOT4FFRFg6HpyGVz2E5ueylLMqyiBaWggP3MgqmYCYhf49B00wPUajUvJVmCYRgolUoQBAGGaUKWZaiq6mUmk0E2m4Wu696anksmk2B2VRYCz2Kv6vQAHXzTREhEeT5f8D6iUa1WUSgUuhBV+wmne51g7IqO/M5HKKrWBbr1OprfG3AdF41GAzzPI/QihGdLT/F8eRmvV1bwfmMD79bXsbS4iJfhMB7OP8Dmh00wjluHIX0idTDhkjkFUnAnWq0WWJbF2KgP/fv7vDx39gxehUO4eSOIg339ODwwiH0Mgzerq0ThrgBZSKNYLBGg2wW2STdoNptNxGMxnD41A9/IKCbG/bhz+xYeLdxH8NoVTE2exDH/BAYPDSAaiYAR8iIpOo9yudy98m/AVhOxLzEEjgcwdGQII0eHcX12FvP37uLyxQvkJz5P/QGi9O3aGhirbJOG2ETdrw53gDQ8hfE4pqemMUxgft845oJzePJ4AVcvnSewMUwGTnjXjkaiYCioV9mfQFoGRVGQSqXAxTlscRzS6TQkScROJg2O20IikUCMlEUnHmV6Vf0NSOcm8eD/BtMB/QtIFVLfaZrmjQrxnKEb5HWJ3X1qePoIqCN+ANyE4Bt0L3SEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"ios example app\" title=\"ios example app\" src=\"https://developers.soundcloud.com/blog/static/8036afa4de908d212e78fd25f6bbbadf/8ff1e/ios-example-app.png\" srcset=\"/blog/static/8036afa4de908d212e78fd25f6bbbadf/9ec3c/ios-example-app.png 200w,\n/blog/static/8036afa4de908d212e78fd25f6bbbadf/c7805/ios-example-app.png 400w,\n/blog/static/8036afa4de908d212e78fd25f6bbbadf/8ff1e/ios-example-app.png 800w,\n/blog/static/8036afa4de908d212e78fd25f6bbbadf/9bac8/ios-example-app.png 907w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h3>Playgrounds</h3> \n<p>Similarly to an example app, Playgrounds allow you to import your module and use its APIs. Changes run in real time and you can even see UI components there. We found Playgrounds very useful for documenting and onboarding.</p> \n<p>You can check out <a href=\"https://talk.objc.io/episodes/S01E51-playground-driven-development-at-kickstarter\">this episode</a> that shows how Kickstarter leverages Playgrounds to develop their features and try them with different scenarios.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/602eee3352663d0b66444926a0aca01a/64b01/ios-playground.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 42.377756471716204%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABE0lEQVQoz5WQy26DMBBFeRmblzEOwYYmqtIsumIBiP//tFvPRFSRqr4WR4MH+c74RF3Xoa5raK3Rti2apoG1lntUq6pCFEV/xzmHbduYdV2x7zvXeZ6xLAumaUKSJJBSQgjB5Hn+5TvLskfgsQFdIuI4ZtI05TNdKIoCZVlyPVBKMUefBnIgPavvew7419O+wxgDQpO/4JEJHgnySJX86qf+85n9Nw//tG1kOsPy/TBgcgNc2Hb0Hn4cQX69HzGESlD/HP4foRRwDP0MdHZA31koY5H1LxDhLJREmUvInKQLqCBcBfGJyBElv6h5dVe8X+6Y7jdU1zdU4wXanXCxJ5zbMNnWcLrBGDbKGoNY1kh+CPwAgoW0J8UMFp8AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"ios playground\" title=\"ios playground\" src=\"https://developers.soundcloud.com/blog/static/602eee3352663d0b66444926a0aca01a/8ff1e/ios-playground.png\" srcset=\"/blog/static/602eee3352663d0b66444926a0aca01a/9ec3c/ios-playground.png 200w,\n/blog/static/602eee3352663d0b66444926a0aca01a/c7805/ios-playground.png 400w,\n/blog/static/602eee3352663d0b66444926a0aca01a/8ff1e/ios-playground.png 800w,\n/blog/static/602eee3352663d0b66444926a0aca01a/64b01/ios-playground.png 1043w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h3>Fewer merge conflicts</h3> \n<p>Having a single project that indexes all the files and configurations in your projects leads to conflicts quite often when more than one branch is modifying the project file. By having different projects that contain the modules we still encounter conflicts but they are less probable. As a result, we spend less time solving conflicts on git when someone merges first and also modifies the project file.</p> \n<h3>Exploring new patterns</h3> \n<p>Working on modules allows developers to decide about the code architecture and the patterns that they want to use internally. They can even choose the language, for instance, using Objective-C instead of Swift, or maybe even React Native in the future. However, the public APIs of these modules need to comply with a contract to ensure there’s consistency across all our public APIs. We’ll talk in more detail in the upcoming articles about what the contract looks like.</p> \n<p>Moreover, we’ve tried to commit to Cocoa patterns for the interfaces of core components that modules have access to. Since developers are familiar with those patterns <em>(delegate, completion block…)</em> they don’t need to spend time figuring out how to hook those components into their features.</p> \n<h2>Pitfalls</h2> \n<h3>Maintenance</h3> \n<p>Maintaining a modular setup becomes a cumbersome process when you have a lot of modules. <code class=\"language-text\">.xcconfig</code> files are a good tool to ensure that all targets share the same configuration, yet it’s not enough. When it comes to specifying the targets that you want for each project, the schemes that are available, and the configuration of those schemes, there’s no tool or API that you can leverage to automate the process of creation and maintenance. We could use a tool like CocoaPods but they would decide the structure of our modules, which is too restrictive for our requirements. Buck is another option that we considered, but it didn’t fully support Swift back then and would have required a lot of investment that we couldn’t afford.</p> \n<p>We are internally exploring some tools to automate the process of creating and maintaining new modules.</p> \n<h3>External dependencies</h3> \n<p>In our experience, having a large amount of external dependencies brought unnecessary complexity and work, so we tried to reduce them. However, there are some dependencies that are necessary, which we need to fetch and link from the app. Some examples of these dependencies are <a href=\"https://fabric.io/kits/ios/crashlytics/install\">Crashlytics</a>, <a href=\"https://firebase.google.com/docs/ios/setup\">Firebase</a> or <a href=\"https://developers.facebook.com/docs/ios/\">Facebook</a>. Each dependency is distributed in a different way. Some provide a .podspec that you can use from CocoaPods. Some others publish the compiled framework/library and headers that we can fetch and link from the app. If they support <a href=\"https://github.com/carthage/Carthage\">Carthage</a>, they include a project that gets compiled by Carthage and whose output <code class=\"language-text\">.frameworks</code> gets copied to the Carthage build folder. There’s no standardized way to distribute dependencies and that makes things really hard, especially with no dependency management tool.</p> \n<p>There’s some manual work that we had to do in this area to generate a compiled version of the dependency that we can use, and that includes information about the version. Unfortunately, there’s no automation that we could do since as I mentioned, there’s no homogeneity in the setup of the dependencies.</p> \n<hr> \n <p>In the next post of this series, we’ll dive into technical details. We’ll present the current project architecture, guiding you through the principles of it, as well as some iterations the architecture has gone through based on the feedback from the team. Stay tuned!</p> \n</hr>","descriptionType":"html","publishedDate":"Mon, 16 Oct 2017 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/8036afa4de908d212e78fd25f6bbbadf/8ff1e/ios-example-app.png","linkMd5":"fefeab11e72cdfdba249848f6ee099ad","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn81@2020_5/2020/08/25/00-49-39-640_938629977fd8d987.webp","destWidth":800,"destHeight":445,"sourceBytes":44017,"destBytes":25244,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/8036afa4de908d212e78fd25f6bbbadf/8ff1e/ios-example-app.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn81@2020_5/2020/08/25/00-49-39-640_938629977fd8d987.webp","https://developers.soundcloud.com/blog/static/602eee3352663d0b66444926a0aca01a/8ff1e/ios-playground.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn61@2020_3/2020/08/25/00-51-44-708_85deda808f5d1edf.webp"},"publishedOrCreatedDate":1598316569988},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Hassle-free concurrency in Android using RxJava","link":"https://developers.soundcloud.com/blog/hassle-free-concurrency-in-android-using-rxjava","description":"<p>Both our Android and iOS teams use the reactive programming paradigm to simplify asynchronous, concurrent code in our native mobile apps. For Android, we use Netflix’s RxJava. Matthias Käppler—a SoundCloud engineer and a contributor to the <a href=\"https://github.com/Netflix/RxJava/tree/master/rxjava-contrib/rxjava-android\">RxJava Android library</a>—<a href=\"http://mttkay.github.io/blog/2013/08/25/functional-reactive-programming-on-android-with-rxjava/\">blogs about the HOWs and WHYs of RxJava on Android</a>.</p> \n<p>Tomorrow in London, Matthias will be talking about <a href=\"http://uk.droidcon.com/2013/sessions/conquering-concurrency-bringing-the-reactive-extensions-to-the-android-platform/\">RxJava at Droidcon</a>. You can grab a drink with him and other members of our Android Team at the <a href=\"http://scdroidcon.eventbrite.co.uk/\">SoundCloud Droidcon Drinkup</a>.</p>","descriptionType":"html","publishedDate":"Wed, 23 Oct 2013 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"143824a44c1ece888f0801b260920a5b","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Music Hack Day Barcelona 2012","link":"https://developers.soundcloud.com/blog/music-hack-day-barcelona-2012","description":"<p>SoundCloud <a href=\"https://developers.soundcloud.com/blog/2012-01-03-music-hack-day-london-2011\">loves</a> <a href=\"https://blog.soundcloud.com/2011/06/03/music-hack-day-berlin-2011/\">hack</a> <a href=\"https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf\">days</a>. Our latest hack day adventure brought us to Music Hack Day in Barcelona and we thought we’d share a bit of the great experience we had there.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/48a11/venue.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.39999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABhdnVFQIMv//EABoQAQACAwEAAAAAAAAAAAAAAAIBAwAREiL/2gAIAQEAAQUCsRUWsOOxnW4sjwAGf//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/AUf/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARL/2gAIAQIBAT8Baj//xAAbEAADAAIDAAAAAAAAAAAAAAAAAhEBEBITof/aAAgBAQAGPwLGFF60k1BS8fT/xAAcEAADAAIDAQAAAAAAAAAAAAAAAREhYUFRcZH/2gAIAQEAAT8haLm+GYa1vZXn6UwIelQWXZPQ/9oADAMBAAIAAwAAABCH3//EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAwEBPxBqv//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAgEBPxCTcb//xAAbEAEAAgMBAQAAAAAAAAAAAAABACERMUFhgf/aAAgBAQABPxBcDgXhOk3y6DoUns3Ej0wEhSwIOjkUEMsK+rEsKkTD7c//2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Music Hack Day Barcelona Venue\" title=\"Music Hack Day Barcelona Venue\" src=\"https://developers.soundcloud.com/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/48a11/venue.jpg\" srcset=\"/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/f544b/venue.jpg 200w,\n/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/41689/venue.jpg 400w,\n/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/48a11/venue.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span> <em>Photo by <a href=\"http://www.flickr.com/photos/thomasbonte/7380645010/in/pool-1495069@N24/\">Thomas Bonte</a></em></p> \n<!-- more --> \n<p><a href=\"http://bcn.musichackday.org/2012/\">MHD Barcelona</a> was organized by the <a href=\"http://bcn.musichackday.org/2012/\">Music Technology Group of Universitat Pompeu Fabra</a>. The first event on the program was a pre-meeting where all hack day attendees were invited to the university to enter the research labs and see what is under development. Several great projects were demoed including the <a href=\"http://www.reactable.com/products/\">Reactable</a> (pictured below), and a melody extraction algorithm that when ran extracted a main melody out of a song with several instruments. Fed back into a vocalizer the computer generated singing was eerily, impressively human.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0d4a8f3fce7fd6236daa5c36a39f4d7e/48a11/reactable.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.39999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAADBP/aAAwDAQACEAMQAAABiuuzBxBQKP/EABoQAAMBAAMAAAAAAAAAAAAAAAECAwAEERL/2gAIAQEAAQUCQetSOYAHiANNhqL2/wD/xAAYEQEBAAMAAAAAAAAAAAAAAAABAAMREv/aAAgBAwEBPwFyPWob/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAIRAf/aAAgBAgEBPwFVWDZNh//EABkQAAIDAQAAAAAAAAAAAAAAAAERABAhUf/aAAgBAQAGPwJtcFKMjaM//8QAGxABAAICAwAAAAAAAAAAAAAAAQARITFBYaH/2gAIAQEAAT8hEi9RgbLtmQkTYygCnMwp1Nyn/9oADAMBAAIAAwAAABBH7//EABYRAQEBAAAAAAAAAAAAAAAAAAEAIf/aAAgBAwEBPxDMSILf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAx/9oACAECAQE/ECYhUOX/xAAbEAEBAAIDAQAAAAAAAAAAAAABEQAhMVFh0f/aAAgBAQABPxCSBLSpJt9zTEFFBbXHkUBMj55i/Zgxz8wkSmzlJpGcdZ//2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"The Reactable\" title=\"The Reactable\" src=\"https://developers.soundcloud.com/blog/static/0d4a8f3fce7fd6236daa5c36a39f4d7e/48a11/reactable.jpg\" srcset=\"/blog/static/0d4a8f3fce7fd6236daa5c36a39f4d7e/f544b/reactable.jpg 200w,\n/blog/static/0d4a8f3fce7fd6236daa5c36a39f4d7e/41689/reactable.jpg 400w,\n/blog/static/0d4a8f3fce7fd6236daa5c36a39f4d7e/48a11/reactable.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span> <em>Photo by <a href=\"http://www.flickr.com/photos/thomasbonte/7374274310/in/pool-1495069@N24/\">Thomas Bonte</a></em></p> \n<p>The MTG had arranged that Music Hack Day would happen within the <a href=\"http://www.sonar.es/es/2012/\">Sonar music festival</a> and so the hacking venue was surrounded by music-goers of all kinds and the thumping bass of some of the world’s best new artists. Working on your hack while <a href=\"https://soundcloud.com/flyinglotus\">Flying Lotus</a> or <a href=\"https://soundcloud.com/jacquesgreene\">Jacques Greene</a> are playing several steps away proved to be one of the most challenging parts of the event but when the clock ran down to zero and all hacks had to be in 41 projects had made it to the wiki and were “ready” for demoing.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/853e72964762d6586a7b3020769ba5f8/48a11/end.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAEDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAACA//aAAwDAQACEAMQAAABqtyzeMAx/8QAGxAAAgMAAwAAAAAAAAAAAAAAAQIAAxEEEjH/2gAIAQEAAQUCSnQ/HwaZW79XZ4ff/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Bh//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/Aaf/xAAbEAACAgMBAAAAAAAAAAAAAAABEQAQISIxgf/aAAgBAQAGPwLpmC/KaCh1Ff/EABsQAAMAAgMAAAAAAAAAAAAAAAABESExQXGB/9oACAEBAAE/IeOojNeoO2yMtzgnDw7yb+z/2gAMAwEAAgADAAAAEAM//8QAFxEAAwEAAAAAAAAAAAAAAAAAARARMf/aAAgBAwEBPxCzi//EABcRAAMBAAAAAAAAAAAAAAAAAAEQESH/2gAIAQIBAT8QyYv/xAAbEAEBAAMBAQEAAAAAAAAAAAABEQAhMUGR8f/aAAgBAQABPxAjHxojL3TjcyeTfo4FFE1iNVmq9+4dD3otT9y1YFTDzP/Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"The Final Countdown\" title=\"The Final Countdown\" src=\"https://developers.soundcloud.com/blog/static/853e72964762d6586a7b3020769ba5f8/48a11/end.jpg\" srcset=\"/blog/static/853e72964762d6586a7b3020769ba5f8/f544b/end.jpg 200w,\n/blog/static/853e72964762d6586a7b3020769ba5f8/41689/end.jpg 400w,\n/blog/static/853e72964762d6586a7b3020769ba5f8/48a11/end.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span> <em>Photo by <a href=\"http://www.flickr.com/photos/81499407@N04/7465448984/in/pool-1495069@N24/\">Music Technology Group</a></em></p> \n<p>The quality of projects completed in such a short time span was really impressive - a sentiment repeated in other articles like <a href=\"http://thenextweb.com/events/2012/06/17/music-hackday-at-sonar-provides-the-link-between-technology-and-top-tracks/\">The Next Web’s review of the event</a>. Our favorites:</p> \n<p><a href=\"http://wiki.musichackday.org/index.php?title=Jamming_Invasion\">Jamming Invasion</a> - Winners of the SoundCloud prize of 400 Euros towards travel to the next Music Hack Day this hack was a Space Invaders style of game that used SoundCloud tracks and frequency analysis to generate the enemies. The demo was great and you could really see the effect the levels of the music had on the gameplay.</p> \n<p>[Free(CC)it!](<a href=\"http://wiki.musichackday.org/index.php?title=Free(CC%5C)it!\">http://wiki.musichackday.org/index.php?title=Free(CC\\)it!</a>) - This was an incredibly clever hack that took a normal music track, analysed it and then built another replacement track out of the closest matching samples from the FreeSound archive. The idea and analysis behind this was really inspiring.</p> \n<p><a href=\"http://wiki.musichackday.org/index.php?title=Legalize_It!\">Legalize It!</a> - This hack was an app inside of Spotify that used the Music Metric API to gather the latest quite literally “hot” tracks from torrent sites and then mapped them to available tracks on Spotify so that you can listen to the latest and greatest legally</p> \n<p><a href=\"http://wiki.musichackday.org/index.php?title=AriHits\">AriHits</a> - A tilt-controlled iPhone beat machine on that mashed up an instrumental track and a vocal track from SoundCloud. An inspired performance that had heads nodding to the beat.</p> \n<p><a href=\"http://wiki.musichackday.org/index.php?title=Tunemap\">Tunemap</a> - A very impressive music visualisation that mapped Echnoest and Deezer music info. Incredibly polished for the short time frame the hackers had to work on it.</p> \n<p>So to wrap up this post we would like to again thank the amazing organizers of this event. We are crossing our fingers that they decide to organize the same again next year, and if so, we will see you all back in beautiful Barcelona.</p>","descriptionType":"html","publishedDate":"Fri, 29 Jun 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/48a11/venue.jpg","linkMd5":"8cfff08585641cac6e3abd4ef46417c4","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn89@2020_3/2020/08/25/00-49-39-823_fb8ff4b915c733f4.webp","destWidth":500,"destHeight":332,"sourceBytes":21191,"destBytes":26626,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/48a11/venue.jpg":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn89@2020_3/2020/08/25/00-49-39-823_fb8ff4b915c733f4.webp","https://developers.soundcloud.com/blog/static/0d4a8f3fce7fd6236daa5c36a39f4d7e/48a11/reactable.jpg":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn29@2020_1/2020/08/25/00-51-43-360_4ea8b5550dc3911c.webp","https://developers.soundcloud.com/blog/static/853e72964762d6586a7b3020769ba5f8/48a11/end.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn62@2020_1/2020/08/25/00-51-43-049_7160e87d3f9a59dc.webp"},"publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Can a machine surprise you? We believe so.","link":"https://developers.soundcloud.com/blog/introducing_suggested_tracks","description":"<p>With more than 125 million tracks from over 12 million creators heard each month on our platform, SoundCloud is uniquely positioned to offer listeners a full spectrum of music discovery. </p> \n<p>Classic hits, the latest releases, gems from underground talent and the best of what’s up-and-coming – all in one place.</p> \n<p>How can you make great content discoverable and available at ease? How can you create a unique experience for every single user?</p> \n<!-- more --> \n<p><a href=\"https://soundcloud.com/discover\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.380457380457386%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAemoapH/xAAaEAADAAMBAAAAAAAAAAAAAAAAAQIDERMx/9oACAEBAAEFAvCd0c4KxyzSlYW6j//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EAB8QAAIBAgcAAAAAAAAAAAAAAAABAiFBAxIjMlFhkf/aAAgBAQAGPwKWnFO3Ys+HE2R8Kq5Jrgqf/8QAGxAAAwACAwAAAAAAAAAAAAAAAAERITFRcfH/2gAIAQEAAT8hVR30sRQedOHgBG8uw1ZjFQ9dP//aAAwDAQACAAMAAAAQKw//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxBZ/8QAFhEBAQEAAAAAAAAAAAAAAAAAAREQ/9oACAECAQE/ECNz/8QAHRABAAICAgMAAAAAAAAAAAAAAQARMUEhUXGR8P/aAAgBAQABPxAiSLSxXV9ajwSKSha9y0H4PERCeRXMqLfBzH1QZdan/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"personalized recommendations\" title=\"personalized recommendations\" src=\"https://developers.soundcloud.com/blog/static/6834021f21553f7ea0a8a88ab6794bda/a296c/personalized_recommendations.jpg\" srcset=\"/blog/static/6834021f21553f7ea0a8a88ab6794bda/f544b/personalized_recommendations.jpg 200w,\n/blog/static/6834021f21553f7ea0a8a88ab6794bda/41689/personalized_recommendations.jpg 400w,\n/blog/static/6834021f21553f7ea0a8a88ab6794bda/a296c/personalized_recommendations.jpg 800w,\n/blog/static/6834021f21553f7ea0a8a88ab6794bda/c35de/personalized_recommendations.jpg 1200w,\n/blog/static/6834021f21553f7ea0a8a88ab6794bda/fa43f/personalized_recommendations.jpg 1443w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </span></a></p> \n<p>Beginning today, we’re introducing <strong>Suggested Tracks</strong>, on web and on mobile, to bring listeners even more ways to discover music on SoundCloud. </p> \n<h2>Digital Serendipity</h2> \n<p>Months before Suggested Tracks developed to what it is today, SoundCloud’s recommendation team set out to answer one simple: </p> \n<center>\n **_Can a machine surprise us?_**\n</center> \n<p>For quite some time, the SoundCloud Core Data Science team has been working on state of the art machine learning projects to help its users discover new content. The idea of surprise in relation to discovery was a new concept. In order to further explore and develop this idea, it required a very different approach and perspective. </p> \n<p>We concluded that music generates emotion, and therefore we would need to view the element of surprise from the perspective of emotion. </p> \n<p>We knew if we really wanted to infuse the element of surprise into music discovery, we had to push our systems to understand the emotional element of our users.</p> \n<p>It was about taking traditional ways of discovering music to a new level. To a place where feelings were taken into consideration, and the “how” along with the “what,” was addressed in the computational effort.</p> \n<p>Overall, we wanted to create a serendipity effect. The moment where you find something new, something engaging that makes you move naturally from a passive listening experience to an active state of mind. The moment where….</p> \n<center>\n *The bass kicks in, you’re 30 seconds into the song, it’s a catchy groove. It sounds familiar, but you’ve never heard the track before. At 45 seconds, you have already liked the track by pushing our iconic heart button, and by the time the lead singer gets to the bridge, you have already shared the track on your favorite social network.* \n</center> \n<p>It’s a eureka moment. You just found a new, undiscovered track none of your friends know. And you love it. You feel it is the right track at the right moment. And it feels good.</p> \n<p>What if that track was recommended by a machine? An extremely sophisticated algorithm that just picked the track for you with the simple goal of surprising you? </p> \n<p>This is what we call <em>Digital Serendipity</em>.</p> \n<h2>It’s all about you</h2> \n<p>So can it be true? Can a machine know you that well? Not just recommending good tracks but amazing tracks? </p> \n<p>We believe the answer is yes. The very same machine has been learning from you all this time. It’s as if you had a skilled musicologist right next to you, carefully listening to what you’ve been playing and interacting with, all this time. </p> \n<p>With Suggested Tracks, this musicologist is not only a passive observer but a proactive entity. The more you listen, like, repost and engage with a track, the better our artificial agent gets to know you and your musical taste. The more you interact, the more it learns and perfects itself day after day.</p> \n<h2>Micro Moments</h2> \n<p><strong>Suggested Tracks</strong> is not a recurrent playlist or a weekly chart. Our new feature updates more frequently than any other service out there so you always have fresh new content for your listening pleasure. Now all of life’s micro moments will have the perfect soundtrack. </p> \n<p>Enough about Suggested Tracks, go and <strong><a href=\"https://soundcloud.com/discover\">try it out</a></strong>! </p>","descriptionType":"html","publishedDate":"Tue, 21 Jun 2016 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/6834021f21553f7ea0a8a88ab6794bda/a296c/personalized_recommendations.jpg","linkMd5":"15235b40d9de61b46288c326f2c5a1d3","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn75@2020_4/2020/08/25/00-49-37-770_1d834f25d243d8d3.webp","destWidth":800,"destHeight":459,"sourceBytes":36797,"destBytes":41876,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/6834021f21553f7ea0a8a88ab6794bda/a296c/personalized_recommendations.jpg":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn75@2020_4/2020/08/25/00-49-37-770_1d834f25d243d8d3.webp"},"publishedOrCreatedDate":1598316569977},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Go at SoundCloud","link":"https://developers.soundcloud.com/blog/go-at-soundcloud","description":"<p>SoundCloud is a polyglot company, and while we’ve always operated with Ruby on Rails at the top of our stack, we’ve got quite a wide variety of languages represented in our backend. I’d like to describe a bit about how—and why—we use <a href=\"http://www.golang.org\">Go</a>, an open-source language that recently hit version 1.</p> \n<p>It’s in our company DNA that our engineers are generalists, rather than specialists. We hope that everyone will be at least conversant about every part of our infrastructure. Even more, we encourage engineers to change teams, and even form new ones, with as little friction as possible. An environment of shared code ownership is a perfect match for expressive, productive languages with low barriers to entry, and Go has proven to be exactly that.</p> \n<p>Go has been described by several engineers here as a WYSIWYG language. That is, the code does exactly what it says on the page. It’s difficult to overemphasize how helpful this property is toward the unambiguous understanding and maintenance of software. Go explicitly rejects “helper” idioms and features like the <a href=\"https://groups.google.com/forum/?fromgroups#!msg/golang-nuts/oRTdZYmkpqg/e1HAcodU83QJ\">Uniform Access Principle</a>, operator overloading, default parameters, and even exceptions, on the basis that they create more problems through ambiguity than they solve in expressivity. There’s no question that these decisions carry a cost of keystrokes—especially, as most new engineers on Go projects lament, during error handling—but the payoff is that those same new engineers can easily and immediately build a complete mental model of the application. I feel confident in saying that time from zero to productive commits is faster in Go than any other language we use; sometimes, dramatically so.</p> \n<p>Go’s strict formatting rules and its “only one way to do things” philosophy mean we don’t waste much time bikeshedding about style. Code reviews on a Go codebase tend to be more about the problem domain than the intricacies of the language, which everyone appreciates.</p> \n<p>Further, once an engineer has a working knowledge of <a href=\"http://golang.org/doc/effective_go.html\">Effective Go</a>, there seems to be very little friction in moving from “how the application behaves today” to “how the application should behave in the ideal case.” Should a slow response from this backend abort the entire request? Should we retry exactly once, and then serve partial results? This agent has been acting strangely: can we install a 250ms timeout? Every high-level scenario in the behavior of a system can be expressed in a straightforward and idiomatic implementation, without the need for libraries or frameworks. Removing layers of abstraction reduces complexity; plainly stated, simpler code is better code.</p> \n<p>Go has some other nice properties that we’ve taken advantage of. Static typing and fast compilation enable us to do near-realtime static analysis and unit testing during development. It also means that building, testing and rolling out Go applications through our deployment system is as fast as it gets.</p> \n<p>In fact, fast builds, fast tests, fast peer-reviews and fast deployment means that some ideas can go from the whiteboard to running in production in less than an hour. For example, the search infrastructure on Next is driven by <a href=\"http://www.elasticsearch.org\">Elastic Search</a>, but managed and interfaced with the rest of SoundCloud almost exclusively through Go services. During validation testing, we realized that we needed the ability to mark indexes as read-only in certain circumstances, and needed the indexing applications to detect and respect this new dimension of index-state. Adding the abstraction in the code, polling a new endpoint to reliably detect the state, changing the relevant indexing behaviors, and writing tests for them, all took half an afternoon. By the evening, the changes had been deployed and running under load for hours. That kind of velocity, especially in a statically-typed, natively-compiled language, is exhilarating.</p> \n<p>I mentioned our build and deployment system. It’s called Bazooka, and it’s designed to be a platform for managing the deployment of internal services. (We’ll be open-sourcing it pretty soon; stay tuned!) Scaling <a href=\"http://www.12factor.net\">12-Factor apps</a> over a heterogeneous network can be thought of as one large, complex state machine, full of opportunities for inconsistency and race conditions. Go was a natural choice for this kind of job. Idiomatic Go is safely concurrent by default; Bazooka developers can reason about the complexity of their problem without being distracted by the complexity of their tools. And Bazooka makes use of <a href=\"https://github.com/ha/doozer\">Doozer</a> to coordinate its shared state, which—in addition to being the only open-source implementation of <a href=\"http://en.wikipedia.org/wiki/Paxos_(computer_science)\">Paxos</a> in the wild (that we’re aware of)—is also written in Go.</p> \n<p>All together, SoundCloud maintains about half a dozen services and over a dozen repositories written entirely in Go. And we’re increasingly turning to Go when spinning up new backend projects.</p> \n<p>Interested in writing Go to solve real problems and build real products? <a href=\"https://soundcloud.com/jobs\">We’d love to hear from you</a>!</p>","descriptionType":"html","publishedDate":"Tue, 24 Jul 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"68534398e09974fda78ecd87ba125327","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Hack Your Way to Berlin","link":"https://developers.soundcloud.com/blog/hack-your-way-to-berlin","description":"<p>Berlin is playing host to the oh-so-sold-out JSConf.eu conference happening October 1-2. Some members of the SoundCloud engineering crew well be on-site and we thought it would be great if you could come too.</p> \n<p>We have an extra ticket for the JSConf.eu conference that we are going to raffle away in a hack competition. The rules of engagement are simple: use this <a href=\"https://soundcloud.com/roman-mars/99-invisible-14-periodic-table\">podcast</a> on the periodic table from <a href=\"http://romanmars.com/\">Roman Mars</a> and build a page that presents it in an awesome way. Be it with a very creative playback method, aggregating content around the sound or building the nicest design we’ve ever seen. The only constraints are that you use JavaScript and that the page is served from GitHub Pages. We want to see the most interesting and incredible page that you can build to play this track.</p> \n<p>The page with the most creativity and “pop” will win the JSConf.eu ticket. We will get you from where you are in Europe to Berlin for the conference and find a nice place for you to sleep.</p> \n<p>Send your entry to <a href=\"mailto:eliot@soundcloud.com\">eliot@soundcloud.com</a> by 23:59:59 Central European Time on September 18.</p> \n<p><a href=\"http://jsconf.eu/2011/\">http://jsconf.eu/2011/</a></p> \n<p>Contest requirements:</p> \n<ul> \n <li>You reside in Europe</li> \n <li>You are at least 18 years old</li> \n <li>You are allowed to travel to Germany</li> \n <li>You want to come to the JSConf.eu conference</li> \n</ul> \n<p>tl;dr:</p> \n<ul> \n <li>Build awesome page with JavaScript highlighting this <a href=\"https://soundcloud.com/roman-mars/99-invisible-14-periodic-table\">track</a></li> \n <li>Deploy to <a href=\"http://pages.github.com/\">GitHub Pages</a></li> \n <li>Send a link to your page &amp; repo to <a href=\"mailto:eliot@soundcloud.com\">eliot@soundcloud.com</a> until September 18</li> \n <li>Win JSConf.eu ticket, flight &amp; accommodation for 3 nights</li> \n</ul> \n<p>Judging will be done by SoundCloud staff by September 22. Have questions? Send them to <a href=\"mailto:eliot@soundcloud.com\">eliot@soundcloud.com</a></p>","descriptionType":"html","publishedDate":"Fri, 02 Sep 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"d618245bfd2f6135e1ea5845dd28e379","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud at Music Hack Day SF","link":"https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf","description":"<p>This past weekend, hundreds of hackers showed up at the <a href=\"http://www.tokbox.com/\">TokBox HQ</a> with a mission to build the future of music. The event started with pitches — giving sponsors a chance to show off their APIs — followed by in-depth workshops where attendees could learn more about each platform and ask questions related to their project. Once the hacking time started, people quickly broke off into groups and got to work.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/8ab74287b4c087ff584c878847bb6439/48a11/hackers.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAABA//EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHscmQmHL//xAAbEAACAgMBAAAAAAAAAAAAAAABAgARAwQSMf/aAAgBAQABBQJqEPpZ4Ni2L9nrGZ//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwGH/8QAHBAAAgICAwAAAAAAAAAAAAAAABEBEiExAiJB/9oACAEBAAY/At48GzZF4tgfGKnazP/EABoQAQEBAAMBAAAAAAAAAAAAAAERACExUWH/2gAIAQEAAT8haRJy9YhA2drcN768uo3BonE91V+jf//aAAwDAQACAAMAAAAQ/M//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QW0v/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/EB//xAAcEAEBAAICAwAAAAAAAAAAAAABEQBBITFxkbH/2gAIAQEAAT8QCHYno6mjCiApoU7nGHNxegwwUEQ5XS3xlcxVS+mLlzegT7n/2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Room full of Hackers\" title=\"Room full of Hackers\" src=\"https://developers.soundcloud.com/blog/static/8ab74287b4c087ff584c878847bb6439/48a11/hackers.jpg\" srcset=\"/blog/static/8ab74287b4c087ff584c878847bb6439/f544b/hackers.jpg 200w,\n/blog/static/8ab74287b4c087ff584c878847bb6439/41689/hackers.jpg 400w,\n/blog/static/8ab74287b4c087ff584c878847bb6439/48a11/hackers.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<!-- more --> \n<p>SoundCloud were well represented. <a href=\"mailto:lee@soundcloud.com\">Lee Martin</a>, <a href=\"https://soundcloud.com/jwagener\">Johannes Wagener</a>, <a href=\"https://soundcloud.com/hannes\">Hannes Tydén</a> and <a href=\"https://soundcloud.com/jstnw\">Justin Street</a> built a hack that shows the future of concerts where a major ticket corporation has taken over the world and all concerts must be attended virtually. <a href=\"http://concert2021.com\">Check it out</a>, it’s really quite fun. Also, <a href=\"http://timbormans.com/\">Tim Bormans</a> got SoundCloud working with Sonos. Check out his <a href=\"http://www.youtube.com/watch?v=DxownCUQSi4\">demo video</a>.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/3d521bf844e75ef5465b82c3980c3d08/48a11/lee-johannes-hacking.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAU5vVl5ZeN//xAAaEAACAwEBAAAAAAAAAAAAAAAAAgEDEgQU/9oACAEBAAEFAoaB202iutDzVqNzLr//xAAWEQEBAQAAAAAAAAAAAAAAAAAAEQH/2gAIAQMBAT8Bq6//xAAWEQADAAAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8BiIj/xAAcEAACAgIDAAAAAAAAAAAAAAAAAREhAlEiMTL/2gAIAQEABj8Ci6QkslZ0eUXynY4bS0f/xAAaEAEBAQEAAwAAAAAAAAAAAAABEQAhMUFR/9oACAEBAAE/IUkdUvCGVAZeofckutpZUrxlfDQ3/9oADAMBAAIAAwAAABCEz//EABYRAAMAAAAAAAAAAAAAAAAAABARQf/aAAgBAwEBPxBoD//EABURAQEAAAAAAAAAAAAAAAAAACEQ/9oACAECAQE/EAZf/8QAHBABAAMAAgMAAAAAAAAAAAAAAQARITFRQWHB/9oACAEBAAE/EFQWNDqc1e6zsTCqAC/kHNTXkY1NK2W1AMkYqPfTmKlu04Z7Z//Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Lee and Johannes Hacking\" title=\"Lee and Johannes Hacking\" src=\"https://developers.soundcloud.com/blog/static/3d521bf844e75ef5465b82c3980c3d08/48a11/lee-johannes-hacking.jpg\" srcset=\"/blog/static/3d521bf844e75ef5465b82c3980c3d08/f544b/lee-johannes-hacking.jpg 200w,\n/blog/static/3d521bf844e75ef5465b82c3980c3d08/41689/lee-johannes-hacking.jpg 400w,\n/blog/static/3d521bf844e75ef5465b82c3980c3d08/48a11/lee-johannes-hacking.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span> <em>Lee and Johannes hacking away. Photo taken by <a href=\"http://www.flickr.com/photos/schill/6868010723/in/photostream\">Scott Schiller</a>.</em></p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/3ccd7308176bea53890a8e52b046ff09/48a11/professor-hannes.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAwb/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABoL78+XhQT//EABoQAAEFAQAAAAAAAAAAAAAAAAABAgMQEiH/2gAIAQEAAQUCGy6WuOm2p//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAICAwAAAAAAAAAAAAAAAAEQABEhQWH/2gAIAQEABj8ChGK0+Wv/xAAZEAADAQEBAAAAAAAAAAAAAAAAATEhEBH/2gAIAQEAAT8hUJcSveJ4NwaKVdP/2gAMAwEAAgADAAAAELPf/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Qp//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/EIf/xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhQf/aAAgBAQABPxAysRgAQ7ezuaPbdC8qANMOUuNT1erv/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Professor Hannes\" title=\"Professor Hannes\" src=\"https://developers.soundcloud.com/blog/static/3ccd7308176bea53890a8e52b046ff09/48a11/professor-hannes.jpg\" srcset=\"/blog/static/3ccd7308176bea53890a8e52b046ff09/f544b/professor-hannes.jpg 200w,\n/blog/static/3ccd7308176bea53890a8e52b046ff09/41689/professor-hannes.jpg 400w,\n/blog/static/3ccd7308176bea53890a8e52b046ff09/48a11/professor-hannes.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span> <em>Hannes demonstrates the very scientific sprite transition process.</em></p> \n<p>Hacking went on through the night, with many attendees going non-stop without sleep, wrapping up with demos at 3pm on Sunday. In total, more than 60 hacks were completed. Here are some of our favorites:</p> \n<h3>Cloud Player</h3> \n<p>Cloud Player, created by Aaron Leese, is an Ableton Live plugin that lets you drag and drop sounds from all over the web (including SoundCloud) into your Digital Audio Workstation. It was great to see someone bridging the gap between web platforms and audio production software. We picked Aaron’s hack as our favorite, so we’ll be flying him out to the next North American Music Hack Day.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/996aa0c3405802366ce3d8b0b66b6e47/d19c0/cloudbrowser.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 54.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACe0lEQVQoz21RSU9TYRT9Encakyort0bFxJShBUNpCw9KaakmdFGoJGUMgg0IFdCwgETURDAhcQiBYCKF0r7X19KBFigxDsgkUEbdgD/meN+HQ1AWJ+fcc2/OvV8+NiXH8Hrch/X0d2wfHHEsfviKpZVd7Hz7gfT+4R9s7x/9p7cJW3uHWF7fxfJGGiwYX8DLsUl8Wk1jbeuAI/VxBe+X1rle3dw/HVt/9fLGHr6s7eDz5gaYL5zE0Ku3eBeYgT8yB184Af9Mkutp0tOkOXOdOFX7QrMIRJLwBaNgXlHEizdj8EoxiNF5ahwH8VCCUv8Lf+Sk/3tO8ZkYnsbwyCgm5Tjk2RTEGIVG5yDFUwhSLcUW+AWTweOFSq3McESPEfjFocQimBRfxCA92StFyKSNtE2i50xJM5jwy/AGQvCHYpBjcxAjCUjRJOdQfJ57MnFQYUI4kQILJ5XAcYx6w/AGk5gQozCbLbBZy9DS5ITL5UJdbS06Ozrg8XTC7XYTe3C/vR3d3d3c7+rqwgPqdZDPhke8aO/pQ/+zATwZGkTv4+c4r7qIAu0V2G8ZUG4qRGWlnZaY4XA4OFutVuj1elgsFhgMNEMsFBejlHrMJ8+iracfekGH3Js5cHse4VrmDWRevQxNrhpaTQ6qnU7YbDbY7XYIggBTqQlarRZGoxEajQZCSQny8/NQZi4HG5+SUH/vIc5euAR25hyqGpuRqb4OxhhUKhUyMjJgq6iATqfjoUUUYqSr1Go1CsnLIlZ6OdlZKCBmyg929g6g0lEFk/U2evqeoqahFdmaPBiKBBTTNc2tbtTWN6LF3Ya6hia46hpQ5aw5wY7qO6hvuoufLHE7nlgHQZoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Drag and Drop Plugin\" title=\"Drag and Drop Plugin\" src=\"https://developers.soundcloud.com/blog/static/996aa0c3405802366ce3d8b0b66b6e47/d19c0/cloudbrowser.png\" srcset=\"/blog/static/996aa0c3405802366ce3d8b0b66b6e47/9ec3c/cloudbrowser.png 200w,\n/blog/static/996aa0c3405802366ce3d8b0b66b6e47/c7805/cloudbrowser.png 400w,\n/blog/static/996aa0c3405802366ce3d8b0b66b6e47/d19c0/cloudbrowser.png 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span> <em>Drag a loop from SoundCloud into Ableton</em></p> \n<h3>Buddhafy</h3> \n<p><a href=\"http://wiki.musichackday.org/index.php?title=Buddhafy\">Buddhafy</a> was one of the more out there hacks. <a href=\"https://twitter.com/#!/ocelma\">Oscar Celma</a> and <a href=\"https://twitter.com/#!/cweichen\">Ching-Wei Chen</a> hooked a NeuroSky MindWave controller up to Spotify, allowing you to control playlists with your mind. The users mental state would determine what songs would be played. Yes. Seriously. Sounds like something out of a sci-fi movie, right?</p> \n<h3>whsprs.co</h3> \n<p><a href=\"http://whsprs.co\">whsprs.co</a> lets you play a game of telephone using SoundCloud. It was built by <a href=\"https://twitter.com/#!/ianshmean\">Ian Butterworth</a> who was actually our pick for winner of the last music hack day, so we weren’t that surprised that he built something awesome again. Users connect with their SoundCloud account, and using the Javascript SDK can record a ‘whisper’. Other users can look for a whisper recorded by someone nearby and repeat it, and so on and so on. You can check on the status of a whisper and see how far around the globe it’s gotten. Kudos to Ian for finding an interesting new way to use sound on the web.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/1297efc7957969977f4d573057196bc5/48a11/whsprs-demo.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwEC/9oADAMBAAIQAxAAAAHQSBiu0e1P/8QAGBABAQEBAQAAAAAAAAAAAAAAAQIAAxL/2gAIAQEAAQUCvlWmM0iPuYuV8dTf/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8Bqv/EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/AYf/xAAgEAACAQEJAAAAAAAAAAAAAAAAAQIDEBESISIxQVGB/9oACAEBAAY/AsEVlyXs69JSqS0o3dn/xAAbEAACAwEBAQAAAAAAAAAAAAABEQAhMUFhcf/aAAgBAQABPyEDNonsL0o0osI+CUbPqFsM2I8BDEcsP6Z//9oADAMBAAIAAwAAABB/H//EABcRAQADAAAAAAAAAAAAAAAAAAABUXH/2gAIAQMBAT8Qm7T/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8Qhkf/xAAdEAEBAAICAwEAAAAAAAAAAAABEQAhMUFhkaFR/9oACAEBAAE/EC2IrYWHXgwE6YJCzS37igxfpnoxXxxJrXy695xAaIjuD44xUBpURWOf/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Ian demoing whsprs.co\" title=\"Ian demoing whsprs.co\" src=\"https://developers.soundcloud.com/blog/static/1297efc7957969977f4d573057196bc5/48a11/whsprs-demo.jpg\" srcset=\"/blog/static/1297efc7957969977f4d573057196bc5/f544b/whsprs-demo.jpg 200w,\n/blog/static/1297efc7957969977f4d573057196bc5/41689/whsprs-demo.jpg 400w,\n/blog/static/1297efc7957969977f4d573057196bc5/48a11/whsprs-demo.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span> <em>Ian demoing <a href=\"http://whsprs.co\">whsprs.co</a></em></p> \n<h3>SoundCloud Wordpress Plugin</h3> \n<p>Richard Cáceres took on the task of integrating SoundCloud with WordPress. The plugin allows WordPress users to connect their blog to their SoundCloud account, then choose from a list of tracks to embed in a blog post. This is an incredibly useful plugin. The source code is already up on <a href=\"https://github.com/rcaceres/SoundCloud-Wordpress\">Github</a>.</p> \n<p>It was great to see all of the hacks people worked on. Thanks to <a href=\"http://the.echonest.com/\">The Echo Nest</a>, <a href=\"http://www.tokbox.com/\">TokBox</a> and <a href=\"http://www.rdio.com\">Rdio</a> for organizing a great event and thanks to everyone who participated. It was a lot of fun.</p>","descriptionType":"html","publishedDate":"Tue, 14 Feb 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/8ab74287b4c087ff584c878847bb6439/48a11/hackers.jpg","linkMd5":"15f673584ea6f54247384e89ce11b72c","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn67@2020_4/2020/08/25/00-49-37-189_165f4e02805fa248.webp","destWidth":500,"destHeight":375,"sourceBytes":27346,"destBytes":35546,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/8ab74287b4c087ff584c878847bb6439/48a11/hackers.jpg":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn67@2020_4/2020/08/25/00-49-37-189_165f4e02805fa248.webp","https://developers.soundcloud.com/blog/static/3d521bf844e75ef5465b82c3980c3d08/48a11/lee-johannes-hacking.jpg":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn97@2020_2/2020/08/25/00-51-42-999_958cccfc2f9f5877.webp","https://developers.soundcloud.com/blog/static/3ccd7308176bea53890a8e52b046ff09/48a11/professor-hannes.jpg":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn36@2020_1/2020/08/25/00-51-40-781_b9bf586a42366f37.webp","https://developers.soundcloud.com/blog/static/996aa0c3405802366ce3d8b0b66b6e47/d19c0/cloudbrowser.png":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn74@2020_4/2020/08/25/00-51-43-026_931f9c0b7792fa7a.webp","https://developers.soundcloud.com/blog/static/1297efc7957969977f4d573057196bc5/48a11/whsprs-demo.jpg":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn59@2020_1/2020/08/25/00-51-40-825_c21b3915d3ed0476.webp"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Stop! Hacker Time.","link":"https://developers.soundcloud.com/blog/stop-hacker-time","description":"<p>At SoundCloud we like to invent new ideas. But we’re not adverse to implementing really great tried and tested ideas like the 20% time concept made famous by Google.</p> \n<p>We’re calling it Hacker Time. We’re still very much in start-up mode so we’re keen to nurture the spirit of hacking. We’ve been testing out Hacker Time for a few weeks now and we’re excited about its potential, from&nbsp;industry-changing initiatives like <a href=\"http://areweplayingyet.org/\" title=\"Are we playing yet\">“Are we playing yet”</a> to unusual passion projects like the <a href=\"http://owloctave.com/\" title=\"Owl Octave\">“Owl Octave”</a>.</p> \n<h2>Why we’re doing it**</h2> \n<p>When I arrived at SoundCloud I gathered all the engineers and developers in a room and asked them what they wanted more of. This was one of the top requests: <img src=\"https://backstage.soundcloud.com/wp-content/uploads/2011/12/Retrospective-505x377.jpg\" title=\"Retrospective Results\" /></p> \n<p>Like every other fast-paced tech company out there, the everyday demands of development leave little time for pet projects or invention outside of the roadmap. But we shouldn’t let great ideas slip away: it’s wasteful of talent and it’s frustrating for developers themselves. Hacker Time is an attempt to keep both the ideas and the employees focused on making the product even better.</p> \n<p>I don’t think there’s a single developer at SoundCloud who isn’t a sound creator. Or at least they quickly become one once they’ve joined. We’re a company of electronic music producers, acoustic musicians, field recordists and social sound fanatics. Of course we’re developing the product for 9 million people, but we’re also developing something we want to use ourselves.</p> \n<p>Ironically we’re not trying to invent anything new by initiating Hacker Time. Aside from Google, we’ve been watching the Atlassian experiment and are taking a similar approach; we’ll start with a simple set of rules and adapt to what works best for us. Like Atlassian, we’ll be blogging about our experiences too.</p> \n<h2>Which projects are engineers allowed to work on?</h2> \n<p>We’ve compiled a list which is not meant to be restrictive but rather should be a guideline:</p> \n<ul> \n <li>Pet features/improvements that never made it onto the roadmap</li> \n <li>Apps based on the Soundcloud API</li> \n <li>Hack Days</li> \n <li>Anything for SoundCloudLabs.com</li> \n <li>“this always annoyed me” bug-fixes or architectural improvements</li> \n <li>Integration of some technology-du-jour with Soundcloud</li> \n <li>Contributing to OSS used at Soundcloud</li> \n <li>Other cool projects using SoundCloud</li> \n <li>Conferences</li> \n <li>Writing Blog Posts, Technical Articles</li> \n</ul> \n<h2>How will time be allocated?</h2> \n<p>The big decision is how to allocate time to these projects. We don’t want to cannibalize valuable product development time but we do want to give people as much freedom as possible,</p> \n<p>There are lots of approaches out there – from reserving one day a week, accumulating time to set aside whole weeks or handling that time like vacation. We’ve decided to put the decision-making in the hands of each team, allowing them to allocate Hacker Time according to each team’s workstyle. It’s an experiment, and something we’ll be reviewing in the early stages.</p> \n<h2>Demo it!</h2> \n<p>We’re pretty disciplined about demoing work to the whole company. Hacker Time projects will be included in the demos (which happen every 2 weeks at SoundCloud), giving developers a chance to showcase their projects and sparking interest in their hacks from everyone in the organization.</p> \n<p>Watch this blog for further reports!</p> \n<h2>Many thanks to</h2> \n<p>Atlassian for blogging about their experiences</p> \n<p>Simon Stewart from Google</p> \n<p>Jim Webber from Neo4J</p> \n<p>Jan Lehnhardt from Couchbase</p> \n<p>Stefan Roock from it-agile</p> \n<p>for sharing their experiences with us.</p>","descriptionType":"html","publishedDate":"Fri, 09 Dec 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://backstage.soundcloud.com/wp-content/uploads/2011/12/Retrospective-505x377.jpg","linkMd5":"07deb1e57e3b99f2e3445ccdf5b3bc29","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"author":"","articleImgCdnMap":{"https://backstage.soundcloud.com/wp-content/uploads/2011/12/Retrospective-505x377.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Microservices and the monolith","link":"https://developers.soundcloud.com/blog/microservices-and-the-monolith","description":"<p><a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith\">In a previous series of blog posts</a>, we covered our decision to move away from a monolithic architecture, replacing it with microservices, interacting synchronously with each other over HTTP, and asynchronously using events. In this post, we review our progress toward this goal, and talk about the conditions and strategy required to decommission our monolith.</p> \n<!-- more --> \n<p>Let’s review briefly. We are presented with a problem; namely, we are unable to confidently make changes to the monolithic system powering SoundCloud, and that the growth of its database schema exceeds our ability to support it. So we need to decommission the monolith, and decided to migrate to a microservices architecture. Our plan for migrating away from a monolithic architecture to one based on microservices has been:</p> \n<ul> \n <li>Invest in internal tools and libraries to make the creation of microservices easier.</li> \n <li>Expect that new features can be built outside of the monolith, using only the internal API it provides to access its data, or the events it emits on state changes.</li> \n <li>When making significant changes to a feature or entity which exists inside the monolith, consider implementing these in a new service which is outside the monolith. We call these <em>extraction projects</em>.</li> \n</ul> \n<p>This strategy has given us some great results. We have drastically reduced the time and number of decisions required to create a new service. These services benefit from world-class telemetry capabilities provided by <a href=\"https://prometheus.io\">Prometheus</a>; confidence in deployments thanks to <a href=\"https://www.docker.com\">Docker</a>, <a href=\"http://kubernetes.io/\">Kubernetes</a> and the work we do to improve testing of service interactions; and an efficient and powerful network stack in <a href=\"https://twitter.github.io/finagle/\">Finagle</a>. Work done in any of these areas has a powerful effect on the productivity of all engineers using these tools and libraries. If an engineer working in the core group makes a change which increases the productivity of many other engineers, the net effect can be equal to hiring an additional engineer. As we grow, these small effects result in dramatic improvements visible across the entire engineering organization.</p> \n<p>As a strategy for decommissioning our monolith, though, this strategy has not served us well. We have noticed that:</p> \n<ul> \n <li>An extraction project, if its goal is to remove all code related to an entity from the monolithic codebase, is a multiple-month undertaking with dependencies on all teams who use that entity.</li> \n <li>Deploying a new service which serves all needs around an entity requires understanding — and, in cases where database joins are performed, changing — the code related to that entity in the monolithic codebase.</li> \n <li>Investing heavily in the skills and tools needed for our new microservices architecture makes it harder to find the engineers who are willing and able to work on the monolithic codebase. Many engineers feel intimidated by it and do not feel a sense of ownership for it.</li> \n</ul> \n<p>That being said, we have been able to extract some services. Most often, this has happened in teams where engineers have experience with the monolith. In these cases, the engineers were able to make the case for an extraction project: the feature they were beginning to work on required integration with the monolith, and could only be expected to work for as long as the monolith continued to work. With database growth rates as they are, and diminishing knowledge of the codebase, this was a short enough period that the decision to do an extraction project was clear.</p> \n<p>In many other cases, though, developers were not able to make this case, or were not even aware that they should, because they felt so removed from the monolith. In these cases, we have even seen services bypass the monolith and access its database directly, because the developers working on a new feature lacked the knowledge of how to modify its code, and were far quicker on our newer, better-supported, Scala stack. When we come to work on an extraction later, services accessing the database directly present a problem for the project. They require a special negotiation about how to integrate, rather than the standard “from this date on, please use the Foo service for this endpoint, rather than the monolith.” Our investment in making services easier to build has created the conditions for behaviors which make it harder to decommission our monolith.</p> \n<p>How, then, should we revise our strategy, and decommission the monolith faster? We are exploring a new approach:</p> \n<ul> \n <li>Recognize that, for an extraction project whose definition of done is “remove all code related to an entity from the monolith,” the part that will take the longest and be the most complicated is to change all call sites related to this entity. This is especially difficult in cases where the calling code relies on an endpoint which joins two entities, and the future architecture will see these entities belonging to different services. To accelerate this effort, we must distribute the work.</li> \n <li>Change the definition of done for an extraction project to “there is a service available which supports all access patterns for this entity which we can support in future, but there is still use of the monolith by some downstreams integrating with this entity.” Since this means an extraction will not be complete until downstream services make changes, the below points ensure progress toward the eventual goal of complete extraction from the monolith.</li> \n <li>Use monitoring to measure progress in migrating calling code.</li> \n <li>Produce guidelines which explain how and why to compose responses from multiple backing services. This guidance should include what to do about the resulting consistency issues (“the tracks service has returned me a track belonging to user 123, but the users service tells me that user doesn’t exist”).</li> \n <li>Produce clear guidance around the ways in which services of different kinds can integrate with an entity. For example, a service should never access another service’s database directly for online use cases. Hold engineers to account for ensuring their systems follow this guidance.</li> \n <li>Prioritize extraction projects based on their size and rate of growth in the monolith’s database, since this is the most pressing risk to the health of that codebase.</li> \n <li>Make use of the monolith experts we have to guide and accelerate the creation of services which will replace parts of it.</li> \n</ul> \n<p>We hope that this approach will get us to the goal of decommissioning our monolith faster, and continue to make use of the investment we have made in our microservices ecosystem, while dealing with the forces which led it to work against this goal.</p> \n<p>Are you working to decommission a monolith and move to microservices? We’d love to hear from you about ideas or approaches which have worked for you.</p>","descriptionType":"html","publishedDate":"Fri, 26 Aug 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"226f92e2514b823bf08c883009670da6","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569979},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Defining a Role with a Retrospective Activity","link":"https://developers.soundcloud.com/blog/defining-a-role-with-a-retrospective-activity","description":"<p>Agile retrospectives are a widely used practice within engineering teams. They provide teams with a way to reflect on how they work and become better at what they do. One of the main benefits of retrospectives is that they empower teams to define and make changes by analyzing what happened in an iteration and by determining what can be improved moving forward. Here at SoundCloud, we hold retrospectives at the end of every iteration (every two weeks), and we often do them at the end of projects as well.</p> \n<!-- more --> \n<p>In this blog post, I’ll share how I used a well-known retrospective activity with my team to define the responsibility of a role.</p> \n<p>A few months ago, our iOS Tech Lead took on a new role, which left the team with an open position to fill. Usually, the person in a particular role is the one to define the tasks and expectations of that role as part of a handover. This can be done by writing down what they did and what they were supposed to do, but this process can be somewhat subjective and error-prone.</p> \n<p>In this case, because the iOS Tech Lead was involved in many things, some of which weren’t directly related to the team or the platform, there weren’t clear boundaries for the role. That said, both the team and the hiring manager agreed that the definition of the role needed to be updated.</p> \n<p>As the Engineering Manager of the Consumer iOS Team, I was asked to come up with a proposal on how to rewrite this role definition together with the iOS Collective. The iOS Collective consists of engineers from the Consumer Team, the Media Streaming Team, and the Core Clients Team. What a great challenge!</p> \n<p>I began by asking myself what a good format was for creating a safe space for gathering peoples’ opinions, facilitating discussion, and finding out what the team needed from a Tech Lead. I knew it was important to have the opportunity to bring up new ideas and responsibilities as well, since the team has changed and evolved over time.</p> \n<p>I invited everyone from the iOS Collective to come prepared for a one-hour meeting and give me their answers to the following questions:</p> \n<ul> \n <li>What is good in the role, and do you see a value in it?</li> \n <li>Is there something new you want to see in this role?</li> \n <li>Is there something that is being done that you would rather see less of?</li> \n <li>Is there something that is being done that you think would bring more value if it is done more?</li> \n</ul> \n<p>This is a modified version of the <a href=\"http://www.funretrospectives.com/kalm-keep-add-more-less/\">KALM</a> — Keep, Add, More and Less retrospective format, which is used for having a conversation about current activities and their values as perceived by team members.</p> \n<p>For our meeting, we used Post-it Notes to give answers to each of the four questions. Everyone came with their notes, organized by color, and added them to the whiteboard. Since we had a limited amount of time and there were nine of us, each giving around 10 answers for the questions, we knew we couldn’t discuss everything. Instead, we focused on the answers that people did not agree on or that were not clear.</p> \n<p>We managed to discuss and clarify the topics that stood out as things people didn’t agree on or were confused about, and we ended up with the following, not counting the duplicates:</p> \n<ul> \n <li>Keep: 26 topics</li> \n <li>Add: 12 topics</li> \n <li>Less: 5 topics</li> \n <li>More: 11 topics</li> \n</ul> \n<p>The fact that there were so many responsibilities to be kept and almost the same number to be added and done more justified the need of the role definition. It felt really good to being able to do this important work together and have the assurance that the next Tech Lead would be set up for a good start.</p> \n<p>In addition to using this information to define the role of the new Tech Lead, the results were given to the former Tech Lead as feedback on the work they did in that role. It was also a chance to realize what the team was happy with, what was not necessary, what they were missing, and what they wished was done more often.</p> \n<p>Using the output of this session, together with the hiring manager and the former Tech Lead, we defined the responsibilities of what is now called the iOS Platform Lead.</p> \n<p>Involving the team in the process resulted in a renewed sense of trust, which reinforced morale. It also gave everyone confidence that the new iOS Platform Lead can work in a way that meets the needs of everyone. This is in addition to having well-defined expectations for their role, which is a necessity for performing well and growing.</p> \n<h4>Roles of the iOS Platform Lead</h4> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/c3ac2/ios-platform-lead-role.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 121.07396149949341%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAYABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAH2rKbBzBsH/8QAGBAAAgMAAAAAAAAAAAAAAAAAEEEBITH/2gAIAQEAAQUCYnQ6H//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABgQAAIDAAAAAAAAAAAAAAAAAAAxARAg/9oACAEBAAY/AhzlCr//xAAaEAEBAQADAQAAAAAAAAAAAAABABEhQVGB/9oACAEBAAE/IVBcp9uI09h2c+QD2xOa3VsAeX//2gAMAwEAAgADAAAAEEDHPP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABwQAQACAgMBAAAAAAAAAAAAAAEAETGRIUGBYf/aAAgBAQABPxAQsX0Ag8Gz0hRl7DsqlurMQznwYQM7j2pAuCkYXTc//9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"ios platform lead role\" title=\"ios platform lead role\" src=\"https://developers.soundcloud.com/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/a296c/ios-platform-lead-role.jpg\" srcset=\"/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/f544b/ios-platform-lead-role.jpg 200w,\n/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/41689/ios-platform-lead-role.jpg 400w,\n/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/a296c/ios-platform-lead-role.jpg 800w,\n/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/c3ac2/ios-platform-lead-role.jpg 987w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p>","descriptionType":"html","publishedDate":"Fri, 22 Jun 2018 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/a296c/ios-platform-lead-role.jpg","linkMd5":"ded1cd08d129daebc82e226570d5bab8","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn21@2020_4/2020/08/25/00-49-38-638_1bde94b7c0e5da37.webp","destWidth":800,"destHeight":969,"sourceBytes":94603,"destBytes":119924,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/a296c/ios-platform-lead-role.jpg":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn21@2020_4/2020/08/25/00-49-38-638_1bde94b7c0e5da37.webp"},"publishedOrCreatedDate":1598316569978},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"OceaniaSmashing Pumpkins use Premiere 1.5 BETA to debut \"Oceania\"","link":"https://developers.soundcloud.com/blog/smashing-pumpkins-use-premiere-1-5-beta-to-debut-oceania","description":"<p><img src=\"http://img.svbtle.com/inline_leemartin_24119721339192_raw.jpg\" alt=\"Premiere 1.5\" /></p> \n<p>Smashing Pumpkins are using a BETA of the next version of <a href=\"http://bit.ly/sc-premiere\">Premiere</a> to debut their new record “Oceania.” Here’s what’s new about the app.</p> \n<!-- more --> \n<p><strong>Moving Stacks</strong></p> \n<p>I converted the app from a basic Sinatra app over to my <a href=\"http://leemart.in/hipster-stack\">Hipster Stack</a> of Node.js, Jade, and Stylus for rapid development. I chose to use <a href=\"http://backbonejs.org/\">Backbone.js</a> similarly to how I utilized it in <a href=\"https://stratus.sc\">Stratus 2</a> to define a basic player structure. It’s really nice to be able to define a single model for <code class=\"language-text\">tracks</code> and use it for multiple views. In this case, the model is used to create a track list item and each waveform sound element.</p> \n<p><strong>Meta Data</strong></p> \n<p>In an effort to make deploying the app even quicker, I’m pulling as much <strong>data</strong> from your SoundCloud account, album, and track as possible. Simply adjust the single setup line and everything will populate automatically.</p> \n<ul> \n <li>The <strong>purchase</strong> link is pulled from the set. You can even give it a custom title now from SoundCloud.com.</li> \n <li>Your <strong>Official Site</strong>, <strong>Twitter</strong>, and <strong>Facebook</strong> links are pulled directly from your account profile.</li> \n <li>And, of course, the <strong>album</strong> and <strong>track</strong> data is used to generate all the tracks and artwork.</li> \n</ul> \n<p>What I’m trying to say is be sure to fill out those SoundCloud profiles <strong>completely</strong>, and this app will make your life easier.</p> \n<p><strong>Waveform</strong></p> \n<p>I was going to write an entire section on waveform coloring (exciting, I know) here, but I’ve decided to wait until next week because <a href=\"https://twitter.com/johanneswagener\">Johannes</a> and I have written a <strong>new</strong> library called <a href=\"http://waveformjs.org\">Waveform.js</a> to handle this. More on that soon. <strong>;-)</strong></p> \n<p>I’ve used it in Premiere 1.5 to construct the <strong>sound navigator</strong> which is heavily inspired by our team’s work on <a href=\"https://developers.soundcloud.com/blog/next.soundcloud.com\">SoundCloud Next</a>.</p> \n<p><strong>Permalinks with Pushstate</strong></p> \n<p>Each album track is given its own <strong>permalink</strong> mirrored from the its SoundCloud permalink url. This permalink also drives the URL system of Premiere 1.5 which will change automatically via <code class=\"language-text\">history.pushState</code>. This allows for deep linking and individual tracks to be shared.</p> \n<p><strong>What’s next?</strong></p> \n<p>I’m going to build more of the JavaScript <a href=\"https://developers.soundcloud.com/docs/api/sdks#javascript\">SDK’s</a> authenticated functions like commenting, liking, and following right into the app. Once that’s done, I’ll document the app and make it available via <strong>open-source</strong> on Github.</p> \n<p>Premiere 1.5 represents a stepping stone to <strong>2.0</strong> which will see the app being <em>hosted</em> for the first time. This will make it as easy to deploy an album premiere as it is to launch an <strong>email for download</strong> campaign with <a href=\"http://emailunlock.com\">Email Unlock</a>.</p>","descriptionType":"html","publishedDate":"Mon, 18 Jun 2012 00:00:00 +0000","feedId":10291,"bgimg":"http://img.svbtle.com/inline_leemartin_24119721339192_raw.jpg","linkMd5":"d64d6ee96585661311bf713f2d9785ea","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"author":"","articleImgCdnMap":{"http://img.svbtle.com/inline_leemartin_24119721339192_raw.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg"},"publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Speeding Up Builds with Dagger Reflect","link":"https://developers.soundcloud.com/blog/dagger-reflect","description":"<p>A large portion of an Android app’s build time can consist of Dagger<sup id=\"fnref-1\"><a href=\"https://developers.soundcloud.com/blog/dagger-reflect#fn-1\" class=\"footnote-ref\">1</a></sup> annotation processing,<sup id=\"fnref-2\"><a href=\"https://developers.soundcloud.com/blog/dagger-reflect#fn-2\" class=\"footnote-ref\">2</a></sup> and most developers agree that productivity is important, so we decided to experiment to see if we could save time when compiling the SoundCloud Android app. This blog post covers how we used Dagger Reflect to save developer time with minimal changes to our codebase. Before we dive deep into how we saved Dagger annotation processing time, let’s make sure we’re on the same page in understanding what dependency injection is.</p> \n<p><a href=\"https://www.droidcon.com/media-detail?video=380844287\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAACbUlEQVQozwFiAp39AEy2wkuSm0aSm1udpFWdpmWWmrWUhrqPfbKeko7X34zk95ze7ce2rNO4rMHSzejexriaksdLSpZmQKN4LQBav8qcx8yUytF7v8elztOizNGSw8qRw8mZzdWS2t/A0JXC1KCy38bAyrLmtJapm5QoKSFJQ0GvlmKBVhsAN7rKQrbERbrGRrvIUb3KV77LYMTPZsPNbMbSccvViczAndK2rtasttah6Ni4r6OhiFg8WD83wqVt4o0kACeotyKKlyeLly2Qmy+OmDSRm0Ons0iptUmep0iUnVCgrYC6wai/vbSuqeK5p/vx6b6GbbCDbdLB0cRHnQAfo7Meg48kj5wmiJMri5cui5Y1l6E6maQ8kZw8i5VUoqm0pZKoq6SjxbXMwIny1LrFjXGyinK7oJu1Y5UAFae4EY2bF5GgGY6cH5WjKJekMaCtMpijOJynPpymQ6SwXM/eldCussZ9jMizwJiI0Z9xzJZvx6p8udCqACi8zEbI10HG1U7K2VHL2jbC0jC+zjfA0T7E0ju/0kWrvKW5dIu/nay8bbS3lZ6bv5GLk6SIf6XFvsXRiwAbrL46q7c0p7Q+rro/qrcmrb0mucssuss1u8gmmLA2f6uFyJ1rtanUpUX/uIC0ioefVVqQSGLEoaCi0sMAA6G3AIeZBIqaBouaC5qpF7PEHrXHIbnLLKm4l0tP15Fpo7ldOpGUkmiV9ZV71m5Aun+HrX+I0aCmroCJAAWrwwWnvgipvwypvhCwwhO1xhi0xRq4ySemtrxQTv+cWqquSi+Wp4tpuvCOgdRwRK1cc7tUaOBziKxVWoirWfsyf3I1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"droidconsf\" title=\"droidconsf\" src=\"https://developers.soundcloud.com/blog/static/68ddbda0aacdf5ed4b8dc29f35f7da6a/8ff1e/droidcon-sf-speaker-image.png\" srcset=\"/blog/static/68ddbda0aacdf5ed4b8dc29f35f7da6a/9ec3c/droidcon-sf-speaker-image.png 200w,\n/blog/static/68ddbda0aacdf5ed4b8dc29f35f7da6a/c7805/droidcon-sf-speaker-image.png 400w,\n/blog/static/68ddbda0aacdf5ed4b8dc29f35f7da6a/8ff1e/droidcon-sf-speaker-image.png 800w,\n/blog/static/68ddbda0aacdf5ed4b8dc29f35f7da6a/6ff5e/droidcon-sf-speaker-image.png 1200w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </span></a></p> \n<h2>Basics of Dependency Injection</h2> \n<p>Dependency injection is a great way to write maintainable, testable code by using the dependency inversion principle. For more information on the basics of dependency injection, take a look at this <a href=\"https://www.vogella.com/tutorials/DependencyInjection/article.html\">introduction tutorial</a>.</p> \n<h2>History of Dependency Injection</h2> \n<p>Dependency injection frameworks in the Android world started by bringing practices from the Java server side to Android. At the time, these frameworks, e.g. <a href=\"https://github.com/google/guice\">Guice</a>, were reflection based, meaning they inspected the program’s code during runtime. <a href=\"https://blog.nimbledroid.com/2016/03/07/performance-of-dependency-injection-libraries.html\">This approach</a> was especially slow on Android. Then <a href=\"https://github.com/google/dagger\">Dagger</a> came along and alleviated this problem by generating code at compile time instead of using reflection at runtime. However, the tradeoff to the faster app startup time was a longer time spent compiling, which was especially noticeable as apps grew in size.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/487afaffa2f2da376dad0cae945959e5/05a72/annotation-42-secs.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 71.69517884914463%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAB9ElEQVQ4y3VUa5OiMBDk//+zvav7eOuqiyAISi1vEkggoXcmQKnnXld1hRCm7XlET+sRTdehqpuFTetYVDVK2iulMU0TxvFO3mutIYTAMAxP556ig7YTLjgvSuRl5dbsq0CWFxSgKMC4oGU1q8BIgvJVECsyErnmJSw9GzyDAzrKwhgDa5dTpZRzyOsjvHmeAWJPqUdVi1vX49JKGGvhzgjspixLNE3jHDFYvK5rJ8rgb5ke1geGHA2iRiImqunukwWrqnoSZLRt+yq4iWljkZK7hNxFDaVi7oLcABZkbilKKX92OD84rNWIoBaOPRUYDymzWFEUrp78PdeU37Hwjw55zcTgXBa9JqqnGm7pmdW5pRqzw/8KCj0hJGdp2+PxRxhcN3Z0xxLMgtv7F8HRzriQu4rS/hfskLkJbSuLbU26dxlLqYQc0NCg1q2A6MmR7DGs4oYaxjdmnTBsMcstMqvndQ6hEkwyxsfuDbv3N+w/fuHz+AeH/W/U+ZGmOoPtLxi7M7X7SnZvpJRiEjGK6w5d4bv9PCSO3jxR220PKUq87//idD7iFB4RRj784IBz7COgd8ww+sQlCaCH2sUMFFPlKXRfuT1reZtVRU3ZBxHO6Q1+lMCPE5yIUZrhGMY4hJHb3+h6GrvOLo1WSX8immK3tL8B+rs+eeBsvG0AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"42 seconds\" title=\"42 seconds\" src=\"https://developers.soundcloud.com/blog/static/487afaffa2f2da376dad0cae945959e5/8ff1e/annotation-42-secs.png\" srcset=\"/blog/static/487afaffa2f2da376dad0cae945959e5/9ec3c/annotation-42-secs.png 200w,\n/blog/static/487afaffa2f2da376dad0cae945959e5/c7805/annotation-42-secs.png 400w,\n/blog/static/487afaffa2f2da376dad0cae945959e5/8ff1e/annotation-42-secs.png 800w,\n/blog/static/487afaffa2f2da376dad0cae945959e5/6ff5e/annotation-42-secs.png 1200w,\n/blog/static/487afaffa2f2da376dad0cae945959e5/05a72/annotation-42-secs.png 1286w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>In the above example from our app, a 59-second build spent 42 seconds processing annotations. More specifically, the 42-second processing time is spent checking the code, analyzing the object graph, and generating the code. To put this in perspective, in the SoundCloud Android app, Dagger generates a very large component class with more than 10,000 lines of code.</p> \n<p>So this is how we as developers using Dagger started to suffer. What this meant for us here at SoundCloud is that we needed to find a solution that saved time. This sparked looking into Dagger Reflect. We did this because it offered the possibility of the best app startup time for users and the best compile time for developers, with little changes to the production code. Another option would have been to migrate our entire codebase to a runtime- or reflection-based dependency injection framework. However, we decided against it because the cost of migration and the slower startup times were not worth it.</p> \n<h2>How Dagger Reflect Works</h2> \n<p>Dagger Reflect is an open source project by Jake Wharton that mimics the API of Dagger.<sup id=\"fnref-3\"><a href=\"https://developers.soundcloud.com/blog/dagger-reflect#fn-3\" class=\"footnote-ref\">3</a></sup> However, instead of generating code at compile time, it parses injectable objects and the component dependencies at runtime. This skips generating and regenerating the same code for every build. It instead uses a <a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/reflection/proxy.html\">dynamic proxy class</a>, which implements an interface specified at runtime. Dagger Reflect proxies an application’s Dagger Component to the Dagger Reflect runtime.</p> \n<h2>How to Use Dagger Reflect in Your Project</h2> \n<p>There are a few ways to use Dagger Reflect in your project. One approach is full reflection, and the other approach is partial reflection, as outlined in the <a href=\"https://github.com/JakeWharton/dagger-reflect/blob/master/README.md\">Dagger Reflect README</a>. You can also swap the dependencies manually for every module. The simplest approach is to use the Delect Gradle Plugin, something that was created here at SoundCloud to make integrating Dagger Reflect simple and painless. For this blog post, we are going to cover the partial reflection approach using Delect.</p> \n<p>The partial reflection approach requires the least amount of changes to your existing codebase, and almost no downside — it takes only 60 ms of code generation to glue your code to Dagger Reflect. Here’s how to start using Dagger Reflect in your project.</p> \n<h3>Step 1</h3> \n<p>Make sure to use the Dagger Component Factory or Component Module annotations:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">@Component\n  public interface ApplicationComponent {\n    @Component.Factory\n    interface Builder { }\n  }\n}</code></pre> \n</div> \n<h3>Step 2</h3> \n<p>Ensure that all Qualifier annotations have <code class=\"language-text\">AnnotationRetention.RUNTIME</code>. Additionally, all <code class=\"language-text\">MapKey</code> annotations must have runtime retention:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">@Qualifier\n@Retention(AnnotationRetention.RUNTIME)\nannotation class LibraryStorage</code></pre> \n</div> \n<h3>Step 3</h3> \n<p>Apply the Delect plugin to your root build script:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">buildscript {\n  classpath 'com.soundcloud.delect:delect-plugin:&lt;latest_version&gt;'\n}\napply plugin: 'com.soundcloud.delect'</code></pre> \n</div> \n<p>This will automatically swap Dagger for Dagger Reflect when the Gradle property <code class=\"language-text\">dagger.reflect</code> is set to <code class=\"language-text\">true</code>.</p> \n<h2>Delect — the Dagger Reflect Gradle Plugin</h2> \n<p><a href=\"https://github.com/soundcloud/delect\">Delect is our open source Gradle plugin</a> that makes it much easier to switch out all the regular Dagger dependencies for the Dagger Reflect versions in your project. Here is an example of the following dependency swap you would need to perform in each Gradle module:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">implementation “com.google.dagger:dagger:&lt;latest-version&gt;”\nimplementation “com.google.dagger:dagger-android-support:&lt;latest-version&gt;”\nlintChecks “com.jakewharton.dagger:dagger-reflect-lint:&lt;latest-version&gt;”\nif (useDaggerReflect()) {\n  implementation “com.jakewharton.dagger:dagger-reflect:&lt;latest-version&gt;”\n  kapt “com.jakewharton.dagger:dagger-reflect-compiler:&lt;latest-version&gt;”\n} else {\n  kapt “com.google.dagger:dagger-compiler:&lt;latest-version&gt;”\n  kapt “com.google.dagger:dagger-android-processor:&lt;latest-version&gt;”\n}</code></pre> \n</div> \n<p>The plugin works by using the <a href=\"https://docs.gradle.org/current/userguide/resolution_rules.html\">Gradle Dependency Substitution API</a>. When it detects that there is a dependency on the Dagger runtime, it adds the Dagger Reflect runtime. When it detects the Dagger compiler or the Dagger Android compiler, it swaps them out for the Dagger Reflect compiler. There is no need for a separate runtime or compiler component in order to use the Dagger Android processor.</p> \n<p>To give you an idea of how it works, here’s a small snippet of code <a href=\"https://github.com/soundcloud/delect/blob/master/buildSrc/src/main/java/com/soundcloud/reflect/DaggerReflectPlugin.kt#L58\">from the plugin</a> where the Dagger annotation processor is substituted for the Dagger Reflect annotation processor:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">substitute(\n  module(\"$com.google.dagger:dagger-compiler\")\n).apply {\n  with(module(\"$com.jakewharton.dagger:dagger-reflect-compiler:${extension.daggerReflectVersion}\"))\n}</code></pre> \n</div> \n<p>In some initial trials, we noticed that developers’ workflows switched from the IDE to the command line while working on the same task. Only enabling Dagger Reflect for IDE builds triggered a full rebuild when switching and vice versa. Because of this painful rebuild, we chose not to enable Dagger Reflect in the Gradle Plugin only in IDE builds. Instead, Delect is enabled or disabled via a user controlled Gradle property, <code class=\"language-text\">(dagger.reflect)</code>.</p> \n<p>A quick way to enable Dagger Reflect when the plugin is applied is the following:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">echo \"dagger.reflect=true\" &gt; ~/.gradle/gradle.properties</code></pre> \n</div> \n<p>We also seed our Gradle build cache with Dagger Reflect enabled; otherwise, building with Dagger Reflect would always be the slower option.</p> \n<h2>Performance Benchmark</h2> \n<p>Before we dig into the numbers, we want to note that we’ve spent a lot of time optimizing our builds by using incremental annotation processors and enabling caching, and as a result, have solved <a href=\"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses\">as many build cache misses as we possibly could</a>.</p> \n<p>Though on average, local developer builds are under 60 seconds, some builds can take as long as 3-5 minutes here at SoundCloud. As an example, the following build scan shows a build that took 5 minutes and 44 seconds.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/cb8c4a1333877c8e197c4ee9530641c5/e4566/annotation-3-mins.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 77.4247491638796%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAB10lEQVQ4y42TC3OiMBSF/f8/b2d2qraioggqlkd4BERO77kSFmpnupkJCUnuyXcfWUCabVpc4htyY2CKAkmWobaWW3g8Hjr2fY+6rrW7tZ/agp+mbRHeEhjbwnb/Dreynok4x67rYOUSI5dy7i753hf8sHUyRqbCtRACtyaGeZ6riGuFeHC/30fBF0K3mNsGfmJwyspRkGRxHCNJEhUpyxJpmur6r4Ldo0csdCRsB7cpQkJSkbaqqnH+q+CttAiyAmVzF8GnQdM06q5LAkfS/hdhUrf4rJrZJg1H40GAxNMYTvuYZRqluUEu7hiJU1FWg2Q/uufOMdPTUpo2zbJmTkSWGw9vHx7W3g6ef0BVW5QSszTLtSYpxvixjKYxpDiJ3SWjy2fJ5iGMEF1jnM4XBNEZh1Oonf+1bV5o9FEMtcl4zwR9MfzztlLS5WaLlbfF+3av/3/XH9jsDyIeieE8ISRjKbEC5kkRV47hWcn84El1FGIS+sEJ4eWq8WUovjfWJ5/kTJCukozx8/yjEu2Ogf6vtzulpXAsZcOn2k7iRpdfBEmwlKRs9v7YKfy+26v7K0kW56S+3j4RyXlH+6MgN+l2bp6lwxIqhhJiN8VzXlb1S3JI6nS+AObQjPUktKaFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"3 mins annotation processing\" title=\"3 mins annotation processing\" src=\"https://developers.soundcloud.com/blog/static/cb8c4a1333877c8e197c4ee9530641c5/8ff1e/annotation-3-mins.png\" srcset=\"/blog/static/cb8c4a1333877c8e197c4ee9530641c5/9ec3c/annotation-3-mins.png 200w,\n/blog/static/cb8c4a1333877c8e197c4ee9530641c5/c7805/annotation-3-mins.png 400w,\n/blog/static/cb8c4a1333877c8e197c4ee9530641c5/8ff1e/annotation-3-mins.png 800w,\n/blog/static/cb8c4a1333877c8e197c4ee9530641c5/e4566/annotation-3-mins.png 1196w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Out of all the annotation processors in use here, Dagger takes the most amount of time by far. It took a total of 3m 9s in the above example.<sup id=\"fnref-4\"><a href=\"https://developers.soundcloud.com/blog/dagger-reflect#fn-4\" class=\"footnote-ref\">4</a></sup></p> \n<p>When using Dagger Reflect, the compiler never spends more than 80 ms processing annotations — a huge decrease in build times.</p> \n<p>Our Dagger Reflect benchmark in our Android project led to a decrease in build times from 62 seconds to 31 seconds for an ABI change to a module. Dagger Reflect makes builds take half as long!</p> \n<p>But what about overall build speeds for all our developers? In a four-week period, our average build time for all local builds without Dagger Reflect was 81.13 seconds. The build time with Dagger Reflect enabled was 55.33 seconds. This is, on average, a 26 second and <em>32% decrease</em> in build speeds!</p> \n<table> \n <thead> \n  <tr> \n   <th>No Dagger Reflect</th> \n   <th>With Dagger Reflect</th> \n  </tr> \n </thead> \n <tbody> \n  <tr> \n   <td><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 398px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/32781ec968f6aaa35ce71ae8b96d0246/2b173/without-reflect.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 149.2462311557789%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAACXBIWXMAABYlAAAWJQFJUiTwAAAD0ElEQVRIx61VZ3PbRhDFt0x6T+z09s/yMRmnjNPzNzKTalUXxXKScRx7rIydUSwWUJJtFYpiAUmxN4kgQVIkCPBld8mjRFmORx7d6AnAEXi3u7f3ntZq7aLd7sC2u0N0Orag23XkmX/f3W3/L5iHrxq/XKlsI5VKIZncgmHEkc1mCTlEozGZq1ZNuebzBVmIPz4IJrOsBjS+qdXqKBSKyOXyhBzK5QqKxRLS6YwQm2ZNnpm40xmNVkWviDX+Z9s2HjRcx5USOI4D1+2h1+vJPX/P80zMEEKHJvKlMuYWfFhe38DC8l347qxicS0oCKyuY6daQzpXgNVoDhdpNpuSUavVklIMCTlCDjuSTGGb0tqhFMs7VdSpJozS9g66tDkM9CDR8eAILcuiCLujEfIEkxipDBLprERSpI0KxeKEBEVfQZQWCxkJxLbSaFCUBaozB6EGkw1ryClzRJ7bK7g678ESpc3kK5sR3A5uClE4sYW7oTCWgyGJmjNRhBzxCCHnf6QxSFmR3UOodln9+CAcNkYI+cF1XSryw8IZ9qK2vymPA0PCxjGh3zZt2q2ufS/so0Pr0dnUc1W8P2/gg1txfLgQx6kFAx95DHxM+MRr4FPCaZ+Bzwif+w184Y/hSz2GrwhfB6L4hrEYxbcEDY6N8VAB2g86HjmzSAjgsbEAnhgP4KmJAJ6Z1PHclI4XpnW8dFbHiXN+nDzvx6sX/Hh9xoc3Zrx461cv3r7oxbuzXiKk1CaF0I9HiYjxOJE9OaHjaSJ7lsieJ7IXz/rxMpMRXjnvw2sXvEL25oDsnVkP3rvkgeZQypGKhe/Wcvgx2MdPhJ83+viFcCaUxdgA45tZTAwwGc5iKpzBVCSD6QE0Vo8OqQVs2pjOQ6K9B2ob6p/do7ZH6z6gtsExD214PumPj5+o84GrvOP2Ffow8HsMfk9TH8ZJrthkcsUyTPIY1sBa3UKxvC1qXSW9bDYPP27sSayRzKPR2nLjJck3SDznPH4R0dm5m7h8819MXb4qdnDur+v448a8WIVSFnVs2eDYwPopc0qUDhNWzToy+aJEZFJ0/Kz0kqNtNlt9ZSKF4XtFquZN0+wTcoT6yjqyhRIZUnDochzNraU7ouRmzRIlXw1H5ZnH/rR50VKpNJpyirxk7Pcr4iNcy3A8iek/r2Hm2t9YC8dw8foN/KMv4fuZ36QsXOt2e0/+JGW1KcFoXFLcIGOKkH+Uyel4ASZif2GCSCIl3rJpJKXe9XpjxORZbDXVFn3FdvaMnVvmPnKvBpsbO6aCtM1Bj3D3+YYsdERv+Q+akbwF7q42KAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"81.13 secs average\" title=\"81.13 secs average\" src=\"https://developers.soundcloud.com/blog/static/32781ec968f6aaa35ce71ae8b96d0246/2b173/without-reflect.png\" srcset=\"/blog/static/32781ec968f6aaa35ce71ae8b96d0246/9ec3c/without-reflect.png 200w,\n/blog/static/32781ec968f6aaa35ce71ae8b96d0246/2b173/without-reflect.png 398w\" sizes=\"(max-width: 398px) 100vw, 398px\" loading=\"lazy\" /> </a> </span></td> \n   <td><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 384px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0d3dcbb4e7fae32e898feb5bf44864a6/45483/with-reflect.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 153.12500000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAfCAYAAADnTu3OAAAACXBIWXMAABYlAAAWJQFJUiTwAAAD90lEQVRIx62W6XIbRRDH9yNFcV+pUJyheAWqeAc+Q4UU9/UOvATfgIQjiQ2JCQkkpMiBFeTYjqSV40PHateWJcu2ZCXGuu9j909378HKZQOGTNVPM7Mz899Wz0z3Ku12B81mC51OF61WW+BnjNvmsWq1ikajKW332W54vsI/mUwWKytpJJMaNC2FXG4dhrGMWCyOVEpHqVSWfrF4B71e33uhn263h0qlCsV9mzvA7a6v3263ZbJtXQd9EuQ+w+L9/kBq10qFfwaDIQ30qR6gxSIs6izq+BbyC3iOW3hNrVaTWua6gsPhEJGlBC4GphCNJXEjHEVoIYbwYhzhpThmbi+iXm8it1lAk1zkllarRW4o0h40PSs9QZ64U67AHJqe+fycJ7LVlmkBli00pDl2PSTLujBNc9RCNllfXSOyWNAMrK5vIpffwuz8EhLLaWQ38ogbaRjZHFbW1mU3N7aK6NE6t7Agu8Tx4YBENhBajOH6bBjp3AbWSFBLZ6Bn1uQF2c28CBrUlx2t1sT3XCzLGhVkkw9SWMDf3lOQHsOkAdO0vEn7sVfxBN2jwKLsbK4PytDZSE/wXiG7zIe4SZ1Gi+70XrQPhviQ7hMdKjoCg/+Pwvf2wuo2Plsq4PPEFlHAF8SXSZvjxAmtgK+Ir5lUAd8Q3zJ6HieJU4yRx2lCfPjKRQ3KcRX3nZwjorifeOBUFA+djuKRMRWPjat44jsVT32v4tCZCA4TT5+N4JmJMJ77IYznz4Xw4o8hHDkfovBFgq9eIsETKonMidCDJPTwWBSPjkfxOIk9SWKHSOzwGdURiuBZEQrjBeIIib1EYi9fCNk+/DSSw2vXdLwRWMbrAYNqA0dvGHiTOPa7gbeCBt4O6nhnSse7xHs3U3h/OoUPiA9nUviI+HhWwye3NCc4dG0G/5meh8KBs95oEM19aPjqf0ax5LqZ9wxl96W3dl16F/Nv7rG/iCDHNT4+JgVMvtcS5nmtg+kEVG5zKrDzSW8ktzAccEVwa/sPxCmQclB1A+r03IIE21uUCjj4cjrgulypjSQx3tSdnZJkRo6PIpi/cxfRhCYBdT6pI0OCAcorTFC9LdH6cnAaN6Pz2KbFbip1U0WZUgenUM+HLMjW8ETOK5wq+W9z7QL2oZM79kq9vJYzoAhuFu8iSdZNhlRMXPkN479cRalcxdlfr+NnyoSXp2bEhQ36wvDEOn9ZaAt3JW+L4DolnEV9Wf4uC567FkAklsDE1Un8NBnE2KUrMib+81noh595m1Kp1ZEnK2v1hiwqkT92yMJtcjS7QChVJNt1Rr4qRmE3Kd7Z8ucMF2Dk+HCoZyv2g9cq/kPsX2+3Ladv/euM+CdSMARLfyS6xwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"55.33 secs average\" title=\"55.33 secs average\" src=\"https://developers.soundcloud.com/blog/static/0d3dcbb4e7fae32e898feb5bf44864a6/45483/with-reflect.png\" srcset=\"/blog/static/0d3dcbb4e7fae32e898feb5bf44864a6/9ec3c/with-reflect.png 200w,\n/blog/static/0d3dcbb4e7fae32e898feb5bf44864a6/45483/with-reflect.png 384w\" sizes=\"(max-width: 384px) 100vw, 384px\" loading=\"lazy\" /> </a> </span></td> \n  </tr> \n </tbody> \n</table> \n<p>However, we see the biggest wins on the longest builds because those are the ones that spend the most amount of time in annotation processing. For simply applying a Gradle plugin in the root of a project, this is probably the easiest build speed win!</p> \n<p>To sum it up, we saw that Dagger was taking a large portion of our build times. We saved up to 50 percent of our local build times with little maintenance cost by swapping regular Dagger for Dagger Reflect. Try it out in your project!</p> \n<h2>Additional Reading</h2> \n<ul> \n <li>For more information about Dagger Reflect, <a href=\"https://github.com/jakewharton/dagger-reflect\">see here</a>.</li> \n <li>For more information about Delect, <a href=\"https://github.com/soundcloud/delect\">check out the GitHub repository</a>.</li> \n <li>Click for recorded version of this <a href=\"https://www.droidcon.com/media-detail?video=380844287\">talk at Droidcon SF</a> as well as corresponding <a href=\"https://speakerdeck.com/runningcode/dagger-reflect-the-circle-from-runtime-to-compile-time-and-back-again-af6dae83-4030-4e23-8598-12dc0dd0afa2\">slides</a>.</li> \n</ul> \n<div class=\"footnotes\"> \n <hr> \n  <ol> \n   <li id=\"fn-1\"> <p><a href=\"https://github.com/google/dagger\">Dagger</a> is a popular <a href=\"https://en.wikipedia.org/wiki/Dependency_injection\">dependency injection framework</a> in the Android and JVM world that leverages annotation processing.</p> <a href=\"https://developers.soundcloud.com/blog/dagger-reflect#fnref-1\" class=\"footnote-backref\">↩</a> </li> \n   <li id=\"fn-2\"> <p>Annotation processing is a way of hooking in to the compilation to analyze source code and generate code.</p> <a href=\"https://developers.soundcloud.com/blog/dagger-reflect#fnref-2\" class=\"footnote-backref\">↩</a> </li> \n   <li id=\"fn-3\"> <p>Dagger Reflect is designed to be used for development builds only.</p> <a href=\"https://developers.soundcloud.com/blog/dagger-reflect#fnref-3\" class=\"footnote-backref\">↩</a> </li> \n   <li id=\"fn-4\"> <p>This time is cumulative, not wall clock time. Multiple threads or Gradle tasks could be compiling using Dagger in parallel and the time spent in parallel might be double counted.</p> <a href=\"https://developers.soundcloud.com/blog/dagger-reflect#fnref-4\" class=\"footnote-backref\">↩</a> </li> \n  </ol> \n </hr> \n</div>","descriptionType":"html","publishedDate":"Thu, 30 Jan 2020 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/68ddbda0aacdf5ed4b8dc29f35f7da6a/8ff1e/droidcon-sf-speaker-image.png","linkMd5":"e7843e3c8d7edf648d14eda3b1179958","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn77@2020_1/2020/08/25/00-49-38-068_d410104545cbb6cc.webp","destWidth":800,"destHeight":419,"sourceBytes":109577,"destBytes":59216,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/68ddbda0aacdf5ed4b8dc29f35f7da6a/8ff1e/droidcon-sf-speaker-image.png":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn77@2020_1/2020/08/25/00-49-38-068_d410104545cbb6cc.webp","https://developers.soundcloud.com/blog/static/487afaffa2f2da376dad0cae945959e5/8ff1e/annotation-42-secs.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn12@2020_6/2020/08/25/00-51-40-393_32bc80dc707dfe6f.webp","https://developers.soundcloud.com/blog/static/cb8c4a1333877c8e197c4ee9530641c5/8ff1e/annotation-3-mins.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn62@2020_6/2020/08/25/00-51-40-887_8df67dbce9f33f65.webp","https://developers.soundcloud.com/blog/static/32781ec968f6aaa35ce71ae8b96d0246/2b173/without-reflect.png":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn59@2020_4/2020/08/25/00-51-41-243_ce90c0ed2a14d203.webp","https://developers.soundcloud.com/blog/static/0d3dcbb4e7fae32e898feb5bf44864a6/45483/with-reflect.png":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn94@2020_4/2020/08/25/00-51-41-539_60a88e280e5ce186.webp"},"publishedOrCreatedDate":1598316569970},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"A Better Model of Data Ownership","link":"https://developers.soundcloud.com/blog/a-better-model-of-data-ownership","description":"<p>Once upon a time, we had a single monolith of software, one mothership running everything. At SoundCloud, the <a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith\">proliferation of microservices</a> came from moving functionality out of the mothership. There are plenty of benefits to splitting up features in this way. We want the same benefits for our data as well, by defining ownership of datasets and ensuring that the right teams own the right datasets.</p> \n<!-- more --> \n<p>In this post we’ll briefly recap the motivations for splitting up the monolith, describe what we mean by ownership of (micro)services, and see that the responsibilities of ownership apply to datasets too. With the help of some examples, we’ll see how to decide who should be the owner of a dataset, where the costs arise when ownership is in the wrong place, and the visibility concerns that are addressed with this stronger definition of ownership. Finally, a brief word on the task of getting from where we are to a closer adherence to this model.</p> \n<h2>Recap: why split up a monolith?</h2> \n<p>It’s much easier to keep cohesion high and coupling low when there’s a boundary between components. We know this from writing code, where we split code into smaller pieces when it gets too large.</p> \n<p>At the level of building services, that split might be across modules or code repositories, and access might be over HTTP. Defining these interfaces between components allows you to design a clearer architecture, and often leads to simpler maintenance, though at the cost of complexity that comes from communicating over the network.</p> \n<p>Clear interfaces also reduce the coordination required when multiple teams work together. The teams agree on the interface, what the data and schema looks like, and can then work independently to build and maintain components. This also allows the system to scale as teams grow independently.</p> \n<p>We saw the lack of clear interfaces within our monolith create problems. It cost more time than it should have to make progress on features, and cost more to maintain them. Importantly, these costs of working with a feature were often not visible because they were distributed around everyone who touched it – which, in the monolith, meant everyone.</p> \n<p>All of this has been <a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith\">covered before</a>. The important point is that clear interfaces allow us to define ownership of the features exposed through these interfaces.</p> \n<h2>What is ownership?</h2> \n<p>Ownership of a service brings a number of responsibilities to a team. These include</p> \n<ul> \n <li><strong>availability and timeliness</strong> – clients should be able to access data and operations provided by the service, and expect the data to be up to date (whatever that means for this service).</li> \n <li><strong>quality and correctness</strong> – the service should do what was agreed with its users, and when it doesn’t the owner should fix the bugs. This puts a burden on the service provider to manage, for example, the lifecycle of response schemas in a way that its clients can handle.</li> \n <li><strong>identification of consumers</strong> – the service owner should know who their users are, so that when changes are made they can be negotiated with the consumers before breaking things elsewhere.</li> \n</ul> \n<p>The key insight is that <strong>none of this is specific to services</strong>. All of these responsibilities apply equally well to an owner of a dataset, a piece of shared infrastructure, or really anything that is an integration point between two teams! This is because a service is just one way to provide an interface to some data, giving a way to read and modify the backing dataset.</p> \n<h3>What does ownership mean for datasets?</h3> \n<p>Similarly to owning a service, owning a dataset means that you have the responsibility to produce data according to some contract with your consumers. Data should be available within some understood time window and should be correct according to that contract. As the producer, you have the responsibility to fix problems with the data.</p> \n<p>You should also be able to know who your consumers are. This visibility makes it possible to make changes to what you publish over time. There are technological fixes for this. With services this can be done by authentication/authorisation on the service, something simple like requiring a request header stating who the client is, or more sophisticated such as distributed tracing. With datasets you can monitor access to wherever the dataset is stored (e.g. reads from HDFS or an RDBMS), or adopt more asynchronous ideas like <a href=\"https://research.google.com/pubs/pub45390.html\">scraping for dataset</a> locations and the jobs that read/write them, and building a dependency graph between them.</p> \n<h2>How do you decide who’s the owner?</h2> \n<p>To begin with, the owner of a dataset must also be the producer – the team that runs the process that creates the data. This is because the owner can only fulfil their responsibilities if they have control over writing the data.</p> \n<p>There are two main factors that come into deciding which team should be the owner. We’ll go through them both here with an example. These two ideas are enough to reason about the ownership of a lot of datasets. (There are also cases where it may be clear that ownership is currently in the wrong place, but where there isn’t a clear team that should own it. This includes datasets that are populated from multiple sources, where ownership of an entity is shared between teams.)</p> \n<h3>Semantics</h3> \n<blockquote> \n <p>The team producing a dataset should be the team responsible for the semantics of that dataset. Equivalently, a team not responsible for the semantics should not be producing the dataset.</p> \n</blockquote> \n<p>A dataset is only meaningful with some definition of the information in the dataset. Many teams might have some idea of what a dataset means, but only one team has the responsibility of designing and evolving the semantics. That team should be the owner of the dataset.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 540px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/553cec1abb4f689ca597fbe7d124edd8/22492/dataset-semantics.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 44.62962962962963%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABTUlEQVQoz42RXc+CMAyF+f+/zEsSL3yNCTCNEj5UEEEZ0HpOHZdv4pJmXds9PeuiaZp0GAb13pu93287P59P21+vl47jqKxjjjbPs8WaptHH48Fd+r5njY+YWJbFjEAWF0Whp9NJz+ezdl1nsTW3CqCfZZnVOeeEcNT4iB3Zpa5rvV6vWpalqVsXgbfbzfL0qYRA+rzHO8gLY8j5iAUMVlWl+/1eL5eLAWvE/nDu4Dso2e12BmNdmqamjsDNZsOccDQAfxVSLhXwYkUlUDkCOIR45py641FzjKINKgngfr/fCRZyEPMRZ8EDZ0mfhZyTR/ECBRMujIDOAHmoNcM8FxF7Nl/Ttq2ET/WR/rrQEJIU3XXCs7vtViu8Io5jPRwOAuh3hoJOPxmYEtge8B7qCEmSRPM8l/BZ/ygEwGz1wy7BX8fEn+XH4OnCkcH8Bxzjte+Gtt0kAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Dataset semantics implemented in the wrong place\" title=\"Dataset semantics implemented in the wrong place\" src=\"https://developers.soundcloud.com/blog/static/553cec1abb4f689ca597fbe7d124edd8/22492/dataset-semantics.png\" srcset=\"/blog/static/553cec1abb4f689ca597fbe7d124edd8/9ec3c/dataset-semantics.png 200w,\n/blog/static/553cec1abb4f689ca597fbe7d124edd8/c7805/dataset-semantics.png 400w,\n/blog/static/553cec1abb4f689ca597fbe7d124edd8/22492/dataset-semantics.png 540w\" sizes=\"(max-width: 540px) 100vw, 540px\" loading=\"lazy\" /> </a> </span></p> \n<p>We see teams trying to rebuild views of datasets from elsewhere in order to fit their precise needs. In this toy example, suppose that this Tracks team creates an event (in the event sourcing sense) each time a new track becomes available on the platform, and uses that to build a dataset summarising all of the tracks. Parts of that process might be simple (e.g. showing counts of tracks, totals of media length), but some may be much more complicated (e.g. tracks have geographical permissions modelled in a different system, and we want to summarise the number of tracks per country).</p> \n<p>Now consider a Reports team using this information to build reports. If they need more than a summary, the published dataset may not be enough. A direct way to get the information they need would be to read all of the events that went into that summary, and build the new dataset themselves. But that requires knowledge of all of the details of tracks and the permissions model and for all of that to be exposed in the events. The logic will be duplicated in the two teams, separated from where it should be. This leads to a high risk of inconsistency in different views of data.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 540px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/96849b6e142dda28942baa092aceabf5/22492/dataset-semantics-fixed.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 44.62962962962963%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABPUlEQVQoz32SyY6CQBCGef8344gHTAwEDBoWCaAoYANdw1fSZi4zJpW2a/mXajxjjEzTJL/P+/0ubdvK4/GQ5/Mp8zx/6wT39/v97em6zr5eL/LGG8dRG9Z1lWVZNIqikMvlItfrVcHJAejqzNCfpqlkWSbn89nSt5EYDyZrrfz1g+x2u0lZltL3vSpGFeoAobaFHYYB9caDmSGs0OwsoYShOI7ldDrJ4XCQpmmkrmuN4/Godd/3qVtINlDjgUwDNp1VBmGnRuO+J7WKG0ixzN52pRZhW/0DSBLQMAzVGsPEzqqD2OU/4fZJbq/Z/UE/O+TihjjJMRBFkZIlSaJk1CBmDTwIpEEQqGWINmfGA+y/RwFwe0UFrapKVwEQa0EA4Hme2309H0AX7Ah17nTKCfdNknffIXdAscwMln8AIUuyJa8FCUAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Dataset semantics done right\" title=\"Dataset semantics done right\" src=\"https://developers.soundcloud.com/blog/static/96849b6e142dda28942baa092aceabf5/22492/dataset-semantics-fixed.png\" srcset=\"/blog/static/96849b6e142dda28942baa092aceabf5/9ec3c/dataset-semantics-fixed.png 200w,\n/blog/static/96849b6e142dda28942baa092aceabf5/c7805/dataset-semantics-fixed.png 400w,\n/blog/static/96849b6e142dda28942baa092aceabf5/22492/dataset-semantics-fixed.png 540w\" sizes=\"(max-width: 540px) 100vw, 540px\" loading=\"lazy\" /> </a> </span></p> \n<p>At the start of a project using this data, it would be difficult to predict the cost of the work, because the expertise is in the other team. Over time the cost of maintenance of the dataset is also hidden (and larger) because the work is distributed around the consumers. When the semantics of the data change later, it will be easy to miss making the required change everywhere. Handling this all in events can be particularly difficult, because changes to the schema require manipulating the history of events.</p> \n<p>A better solution is for the work to be done in the team that has full knowledge of the semantics and the responsibility of maintaining the dataset. In this case, the Tracks team should build that dataset with enough information for the consumer, and the Reports team should use the published dataset. It’s clearer what the costs are and work is not duplicated. When changes happen to the semantics, the owning team simply publishes a new dataset.</p> \n<h3>Encapsulation</h3> \n<blockquote> \n <p>Don’t consume data from other systems’ internal data stores</p> \n</blockquote> \n<p>The internal data structures of a component (of any size: system, service or single class) are non-public so that invariants can be maintained. Other parties (calling code, other teams) get access through an interface. This level of indirection through a published interface allows the owner of a system to make changes to the data store without other users having to coordinate.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 517px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/d0bd698936a521b8e3e1f5e3087dd37f/60eaf/dataset-encapsulation.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 60.928433268858804%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABW0lEQVQoz52T247CMAxE8///xgOPFVAKqqAXrqLcmhLjY8mrPrC72o00auLE4xknDVHH9XqNl8sldl0Xn89nHIYhikhMKf0ZQflkv9/LfD6X7XYrj8dDXq+X/HcEVZWOx2Ni9H2fdrudfVVp0mI258uaua99PgbxcLvdZLPZSFVVcjqdTC0q1bYBBz4vikIWi4WBM+w5lFDu97sE7Z8RNk0jqtTmJC6XS9G+WgEKkfTTUINWJJCEOrVuiWrZiCBdr9eSZZmUZSl1XVv8fD5bImqAzymobZFAACKUAYIcwCJFIMEFF0V8MplInudWZLVamX0vyHkjbNvWNiEkGVKIiBPDNu0gBgEuAPu0yl2ZZVix4X1gE7vT6dTIZrOZfTnD/rhnDh9GyC1DQK94h4BklFLVwS2Oe4cL1g54rIcoxA49orEoHFf9pOg72MNGifcBHA6Hrz/lk63fns4bktufz+gosHgAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Dataset encapsulation violated\" title=\"Dataset encapsulation violated\" src=\"https://developers.soundcloud.com/blog/static/d0bd698936a521b8e3e1f5e3087dd37f/60eaf/dataset-encapsulation.png\" srcset=\"/blog/static/d0bd698936a521b8e3e1f5e3087dd37f/9ec3c/dataset-encapsulation.png 200w,\n/blog/static/d0bd698936a521b8e3e1f5e3087dd37f/c7805/dataset-encapsulation.png 400w,\n/blog/static/d0bd698936a521b8e3e1f5e3087dd37f/60eaf/dataset-encapsulation.png 517w\" sizes=\"(max-width: 517px) 100vw, 517px\" loading=\"lazy\" /> </a> </span></p> \n<p>In this example, consider how data gets from various systems in the company to a data warehouse used by data analysts. Such a tool can be great for analysis (find all of the data in one place, easy to query) but can lead to problems of maintenance later.</p> \n<p>Consider a tool to take a full snapshot from a database and push it to the data warehouse, where it’s available with the same schema and data as at the source. This provides a really easy way to get your data into one place. But it also couples the data warehouse to the internal database of your service – specifically it couples together the schema of your database, the data warehouse, and any query that reads that data and expects a certain schema. When you want to change your supposedly-internal database schema, you suddenly have to coordinate with a lot of downstream users. Worse, given that the data warehouse is a centrally accessible resource, you probably can’t know who those users are.</p> \n<p>This setup has <strong>made the internal database an interface to the data</strong>, breaking the system’s encapsulation.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 605px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/4a306802f50ee060998f06283978e5ce/b1c25/dataset-encapsulation-fixed.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.06611570247933%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQoz22S7a6CMAyGuf87JCESBCIoICIowlhPnyY98YdLmvXzbftuybZtAdn33eTz+YR1XUPf92GaJrO/c7C5ReSnJMuyyPP5lNfrJeicGKPcbrd/230hBFFgUVBRUHm/35ZDLX4kud/vcRzHqIGIrkHTubWR6QoUu66LwzDYTQwfdVVVxcvlEo/jiNogAihN08j1ehVd03RNkvP5LHmeS9u28ng8JMsyKYrCbCZEqKVOm9iUSpUk2kUQHDqBaCdbDRoQ1uIASh6A0AEg8TRNbQhsAwSIZILwMc+z6XVdWzFxfN8xdKZlI24aAUjzxEl1hx/W+X4UHoEccskry9LAoYKVyaUmYU2EoN9OAxNwswoAiD6A8cZkrA7P8K1fzEAN0HkBgGSKKDidTuanCTYxhEk5/n38y8C9PQqg8MON0/+b/zlsVvXpHfDX+QPSpgAgt8JaAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Dataset encapsulation with a proper interface\" title=\"Dataset encapsulation with a proper interface\" src=\"https://developers.soundcloud.com/blog/static/4a306802f50ee060998f06283978e5ce/b1c25/dataset-encapsulation-fixed.png\" srcset=\"/blog/static/4a306802f50ee060998f06283978e5ce/9ec3c/dataset-encapsulation-fixed.png 200w,\n/blog/static/4a306802f50ee060998f06283978e5ce/c7805/dataset-encapsulation-fixed.png 400w,\n/blog/static/4a306802f50ee060998f06283978e5ce/b1c25/dataset-encapsulation-fixed.png 605w\" sizes=\"(max-width: 605px) 100vw, 605px\" loading=\"lazy\" /> </a> </span></p> \n<p>Indirection to the rescue. Rather than using the snapshot tool to copy from the database to the data warehouse, you as the team producing the data should copy the data somewhere else, say on a shared filesystem such as HDFS. You’ll need to define a schema for the snapshot, even if this is (initially) only a representation of the source schema. You’ll want to consider the design of this interface, too. For example, include only the fields you need first, adding others later as required. As the schema evolves you’ll need to think about backwards compatibility, to ensure that consumers will continue to be able to read the data.</p> \n<p>This approach gives a new integration point, and a way to decouple the lifecycle of your database schema from that of your consumers. This doesn’t solve all of your problems (what if my schema has to change in a way that isn’t backwards-compatible?) but it does give a place to start and makes it easier to manage those more difficult changes.</p> \n<h2>What does this mean for my team?</h2> \n<p>Overall, the point of arranging ownership better is that as a company we spend less on maintenance. This will mean work moving between teams and consolidating in a single place per dataset. In some cases this will mean a team needs to take on more work; in some cases less.</p> \n<p>Let’s look at the viewpoints for a few different roles.</p> \n<h3>I’m a producer</h3> \n<p>Where you produce data there is an expectation that it should be exposed appropriately to consumers who need it. This may mean some new work to understand their requirements and build the integration. You should understand the severity of failure or data loss on your consumers.</p> \n<p>Where there are existing dependencies on data you own, but where you don’t own the process that produces that dataset, there is an opportunity to remediate technical debt. This can happen by introducing a publishing workflow that you own and that makes sense in your domain, and negotiating usage with consumers. Your consumers will then have much easier access to this data, and you will be in control of all of the moving parts when you need to make changes.</p> \n<h3>I’m a consumer</h3> \n<p>Where you consume data, there is an expectation that you do less rebuilding of datasets, and instead, negotiate with the producer of your data to have them produce it in an appropriate form.</p> \n<p>Where you are already building datasets whose semantics you don’t control, work with the team that should own the dataset so that they produce and publish the data you need in a way that’s appropriate for both. This may be as simple as the producing team running an existing job, or may involve asking them to build something new to expose the data.</p> \n<h3>I’m a product owner</h3> \n<p>Where you own a feature, consumers of the data generated by your feature are your users too. When considering priorities for your team, you’ll need to balance the needs of your internal data consumers with those of your external users.</p> \n<h2>Show me the data!</h2> \n<p>How can this work in practice? A common fear arises when you need some data, when it isn’t available in the right form and when your project is short on time. It may appear quicker to build the data yourself than to request that the work be prioritised in another team, where you’re competing for attention among their other priorities.</p> \n<p>There are essentially three options that distribute the initial cost (writing the job to produce the data) and the ongoing maintenance cost. Either way, the code to produce the dataset has to be built somewhere.</p> \n<ol> \n <li>consumer builds and owns – the consumer takes on all of the cost and the wider organisation takes no shared benefit</li> \n <li>consumer builds, producer owns – the consumer, in cooperation with the producer, builds the dataset and then hands off ownership to the producer. The consumer takes the up-front cost, the producer takes the longer term cost, and the total future cost is reduced because no-one needs to duplicate the implementation.</li> \n <li>producer builds and owns – the producer does the initial work and takes all of the cost, and again the benefit is shared. This is the no-compromise approach, and may not be possible in short-term due to balancing other priorities.</li> \n</ol> \n<p>In any case, the outcome of this project should be that a curated dataset exists, the dataset is owned by the producer of the data, and consumers integrate with this and not the source data.</p> \n<h2>Conclusion</h2> \n<p>When accessing and using data that is owned by other teams, certain patterns lead to high costs of maintenance that are not apparent at the start. It can be difficult to track these costs later when they become distributed around multiple teams.</p> \n<p>As a consumer of data, avoid building datasets whose semantics you don’t own, because it’s duplicate effort and you leave yourself at the mercy of future changes you don’t control. Use published interfaces to access data; asking the producer of the data to create one is preferable to doing it yourself or accessing their internal data stores directly. As a producer, it’s important to think about how the data your feature generates will be used, and how to expose to other teams in a way that doesn’t spread maintenance responsibilities.</p> \n<p>Following these two principles should make it easier to keep your data integrations well understood and maintainable, by giving better visibility over data that is shared between teams.</p>","descriptionType":"html","publishedDate":"Tue, 20 Jun 2017 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/553cec1abb4f689ca597fbe7d124edd8/22492/dataset-semantics.png","linkMd5":"81ac367778605dafa205f894368fee2d","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn70@2020_6/2020/08/25/00-49-37-645_384e6ffa1a1846f0.webp","destWidth":540,"destHeight":241,"sourceBytes":7120,"destBytes":14982,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/553cec1abb4f689ca597fbe7d124edd8/22492/dataset-semantics.png":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn70@2020_6/2020/08/25/00-49-37-645_384e6ffa1a1846f0.webp","https://developers.soundcloud.com/blog/static/96849b6e142dda28942baa092aceabf5/22492/dataset-semantics-fixed.png":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn85@2020_2/2020/08/25/00-51-40-736_6fd7a713caf26290.webp","https://developers.soundcloud.com/blog/static/d0bd698936a521b8e3e1f5e3087dd37f/60eaf/dataset-encapsulation.png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn93@2020_4/2020/08/25/00-51-42-080_d0ff9e553d16a9f3.webp","https://developers.soundcloud.com/blog/static/4a306802f50ee060998f06283978e5ce/b1c25/dataset-encapsulation-fixed.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn97@2020_3/2020/08/25/00-51-42-300_22204eb910385ba9.webp"},"publishedOrCreatedDate":1598316569988},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"node.js knockout — August 28th & 29th","link":"https://developers.soundcloud.com/blog/node-js-knockout-august-28th-29th","description":"<p>A few days ago a small team of SoundCloud developers (<a href=\"https://twitter.com/goldjunge\">@goldjunge</a>, <a href=\"https://twitter.com/jberkel\">@jberkel</a>, <a href=\"https://twitter.com/purzelrakete\">@purzelrakete</a> and&nbsp;<a href=\"https://twitter.com/sohm\">@sohm</a>) participated in the first node.js knockout competition. Aptly named “Team SoundCloud”, we set out to explore the current state of server side Javascript using node.js and the real-time web.</p> \n<p>(For those unfamliar with Node.js, head over to<a href=\"http://nodejs.org/\"> http://nodejs.org/</a> or the project wiki at<a href=\"https://github.com/ry/node/wiki\"> https://github.com/ry/node/wiki</a> for an introduction.)</p> \n<p>The <a href=\"http://nodeknockout.com/\">node.js Knockout</a> is a competition inspired by the popular <a href=\"http://railsrumble.com/\">Rails Rumble</a>. The rules are simple: Teams of up to 4 people have 48 hours to build a web app that is awesome enough to woo the judges and results in as many votes from the audience as possible. To level the playing field, each team was required to deploy their application to a dedicated hosting environment provided by either&nbsp;<a href=\"http://heroku.com\">heroku.com</a> or&nbsp;<a href=\"http://joyent.com\">joyent.com</a>. The competition started on Saturday at 2:00AM and ended on Monday 2:00 AM. Yes, that’s a weekend right there.</p> \n<p>We had done a minimal amount of planning beforehand and agreed that we’d try to visualize traffic on<a href=\"https://soundcloud.com\"> soundcloud.com</a> by hooking into the varnish HTTP accelerator that’s part of our infrastructure. We basically set out to build a pimp HTML5 + WebSockets based version of varnishtop (with a sprinkle of varnishlog, because that’s just so exciting!).</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/48a11/late_night_hackingz.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 62%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAUGBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAFRrW0kIC1D/8QAGhABAAMAAwAAAAAAAAAAAAAAAQACAwQRE//aAAgBAQABBQKjVa5ekRGcI6xKk//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EAB0QAAECBwAAAAAAAAAAAAAAAAEAAhARISIxQVH/2gAIAQEABj8CvRc2oGoz6VgL/8QAGhABAAIDAQAAAAAAAAAAAAAAAQARITFBgf/aAAgBAQABPyFxklYnGTb1G4XNag1tkNwJQXk//9oADAMBAAIAAwAAABDED//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ECf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAwEBAQEAAAAAAAAAAAABABExIUFhkf/aAAgBAQABPxAguUVrj+RuWGJbCeNbsKY05XT4xVikdmwtVFXkPgDwE//Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"late night hackingz\" title=\"late night hackingz\" src=\"https://developers.soundcloud.com/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/48a11/late_night_hackingz.jpg\" srcset=\"/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/f544b/late_night_hackingz.jpg 200w,\n/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/41689/late_night_hackingz.jpg 400w,\n/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/48a11/late_night_hackingz.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<p>@purzelrakete, @goldjunge and @jberkel hard at work.</p> \n<p>Being confined to the Joyent environment, the first challenge to overcome was not having access to a varnish instance that serves any real traffic. To solve that, we hooked into the Twitter Streaming API and filtered all links to the popular URL shortening service <a href=\"http://bit.ly\">bit.ly</a>. For each bit.ly link a request is made against the local varnish instance to generate traffic. Of course, all of these requests result in (eventually cached) 404s, but oh well. The rest of Saturday saw us create a layout, start working on the C++ extension required to access a running varnish instance’s shared memory to read logs &amp; statistics and generate events in node, culminating in having the basic functionality and deployment configuration done at around 3AM on Sunday.</p> \n<p>After a few hours of sleep, Sunday was a blur of getting the C++ extension to emit more statistics and log details, writing the client-side javascript that updates the DOM and wrestling with Solaris on the Joyent SmartMachine. We deployed the final version about 30 minutes before the competition deadline. Lessons learned (in no particular order):</p> \n<ul> \n <li>node.js is fun, building realtime stuff with it is incredibly easy</li> \n <li>deploying early and continuously == win</li> \n <li>Solaris is a pain</li> \n <li>Twitter is full of spam and porn</li> \n <li>Server side javascript!!</li> \n</ul> \n<p>You can check out the app here (using Chrome or Safari):<a href=\"http://team-soundcloud.no.de/\"> http://team-soundcloud.no.de/</a></p> \n<p>Vote for us here:<a href=\"http://nodeknockout.com/teams/team-soundcloud\"> http://nodeknockout.com/teams/team-soundcloud</a></p>","descriptionType":"html","publishedDate":"Tue, 31 Aug 2010 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/48a11/late_night_hackingz.jpg","linkMd5":"8cfe8b9ba812d40f17fab5acd931ff97","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn33@2020_1/2020/08/25/00-49-38-874_91406d2233329368.webp","destWidth":500,"destHeight":310,"sourceBytes":13777,"destBytes":16080,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/48a11/late_night_hackingz.jpg":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn33@2020_1/2020/08/25/00-49-38-874_91406d2233329368.webp"},"publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Music Hack Day London 2011","link":"https://developers.soundcloud.com/blog/music-hack-day-london-2011","description":"<p>Last month we attended Music Hack Day London 2011. A special one, Music Hack Day was born in London 3 years ago and we were happy to attend a hack day again in it’s homeland.</p> \n<p><img src=\"http://farm8.staticflickr.com/7164/6449320395_c39bd50b92_d.jpg\" alt=\"Picture\" /></p> \n<p>For those who do not know of Music Hack Day, it’s a great weekend-long event aimed at music and sound hackers. Anyone can attend the event for free, and their goal is to conceptualize and develop innovative hacks of either software or hardware.</p> \n<!-- more --> \n<p><a href=\"http://davehaynes.me/\">Dave Haynes</a> and <a href=\"http://flavors.me/martyndavies\">Martyn Davies</a> raised the bar again, by organizing a hack day right in the center of east London, <a href=\"http://www.barbican.org.uk/\">the Barbican</a>. Having gained so much experience in organizing hack days, it was clear from the start that this was going to be good. The Barbican had made three rooms and a cinema hall available to us, plus a central area to serve coffee, drinks and of course pizza.</p> \n<p><img src=\"http://farm8.staticflickr.com/7165/6449374135_33dcc56139_d.jpg\" alt=\"Picture\"> <img src=\"http://farm8.staticflickr.com/7167/6449370055_e981750e37_d.jpg\" alt=\"Picture\" /></img></p> \n<p>It was great seeing all those excited faces coming in, getting ready to hack on their ideas. There were lots of different hackers attending, from hardware to clothing, to musical instruments, from web to applications, some forming cross teams to combine their skills.</p> \n<p>Although Spotify had a lot of interest in their newly launch <a href=\"http://developer.spotify.com/en/spotify-apps-api/overview/\">Apps API</a>, it seemed that this hack day was dominated by interactive hacks, where the audience could participate or needed to contribute. During the presentations there were quite some hacks where people could ‘tune in’ their phones or laptops.</p> \n<p>While the overall level of the presented hacks was amazing, I can only highlight a few here:</p> \n<ul> \n <li><a href=\"http://wiki.musichackday.org/index.php?title=The_Inhuman_Microphone\">The Inhuman Microphone</a> - A circumvention for the “No megaphones” rule. You shout a message in your phone to upload it to the service, where it will send it synchronized to all connected phones and laptops. The only thing you need to do is open a web page.</li> \n <li> <p><a href=\"http://wiki.musichackday.org/index.php?title=Notorious_Siri\">Notorious Siri</a> - Apple’s iPhone 4S voice recognition service called ‘Siri’ is being fooled into singing rap songs. Check out the video:</p> \n  <div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 45%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\"> \n   <iframe src=\"http://player.vimeo.com/video/33402886?color=B185EA\" frameborder=\"0\" webkitallowfullscreen=\"\" mozallowfullscreen=\"\" allowfullscreen=\"\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> \n  </div> </li> \n <li><a href=\"http://wiki.musichackday.org/index.php?title=Waveformer\">Waveformer</a> - An interface to create high precision audio waveforms by outputting JSON data for every point.</li> \n <li><a href=\"http://scotd.herokuapp.com/\">SCOTD Showcase</a> - A gallery to show all the SoundClouders of the Day, synced from a Google Spreadsheet.</li> \n <li><a href=\"http://owloctave.com\">Owloctave.com</a> - An octave of owls, the hoots are streamed from SoundCloud. HTML5 audio, works on iPad. Tap or click on an owl to see where it lives and hear it’s hoots.</li> \n <li><a href=\"http://CloudChamber.co\">CloudChamber.co</a> - A service to reverbize your sounds using SoundCloud and the reverb chamber at the National Physical Laboratory UK. You submit a SoundCloud track and it will play in a chamber designed for perfect reverb, get recorded and send back to you when it’s done.</li> \n</ul> \n<p>Have a look at the photos made by <a href=\"https://twitter.com/thomasbonte\">Thomas Bonte</a>:</p> \n<p>\n <div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 90%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\"> \n  <object style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></object> \n </div> <param name=\"flashvars\" value=\"offsite=true&amp;lang=en-us&amp;page_show_url=%2Fphotos%2Fthomasbonte%2Fsets%2F72157628266066707%2Fshow%2F&amp;page_show_back_url=%2Fphotos%2Fthomasbonte%2Fsets%2F72157628266066707%2F&amp;set_id=72157628266066707&amp;jump_to=\"> <param name=\"movie\" value=\"http://www.flickr.com/apps/slideshow/show.swf?v=109615\"> <param name=\"allowFullScreen\" value=\"true\"><embed type=\"application/x-shockwave-flash\" src=\"http://www.flickr.com/apps/slideshow/show.swf?v=109615\" allowfullscreen=\"true\" flashvars=\"offsite=true&amp;lang=en-us&amp;page_show_url=%2Fphotos%2Fthomasbonte%2Fsets%2F72157628266066707%2Fshow%2F&amp;page_show_back_url=%2Fphotos%2Fthomasbonte%2Fsets%2F72157628266066707%2F&amp;set_id=72157628266066707&amp;jump_to=\" width=\"100%\" height=\"450\" /></param></param></param></p> \n<p>That’s a wrap! Want to attend the next Music Hack Day? Keep an eye on the website for upcoming events in your area: <a href=\"http://musichackday.org/\">http://musichackday.org/</a> The next ones are happening in <a href=\"http://cannes.musichackday.org/2012/\">Cannes</a> and <a href=\"http://sf.musichackday.org/2012/\">San Francisco</a> early this year.</p>","descriptionType":"html","publishedDate":"Tue, 03 Jan 2012 00:00:00 +0000","feedId":10291,"bgimg":"http://farm8.staticflickr.com/7164/6449320395_c39bd50b92_d.jpg","linkMd5":"79f3b3462e4f06843f8b0b6c4fe8b454","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn54@2020_2/2020/08/25/00-49-37-444_251bb8124dce40c1.webp","destWidth":500,"destHeight":332,"sourceBytes":34912,"destBytes":14404,"author":"","articleImgCdnMap":{"http://farm8.staticflickr.com/7164/6449320395_c39bd50b92_d.jpg":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn54@2020_2/2020/08/25/00-49-37-444_251bb8124dce40c1.webp","http://farm8.staticflickr.com/7165/6449374135_33dcc56139_d.jpg":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn15@2020_4/2020/08/25/00-51-40-593_cc03daa9463d3ec8.webp","http://farm8.staticflickr.com/7167/6449370055_e981750e37_d.jpg":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn31@2020_6/2020/08/25/00-51-42-752_7af34333328f20e0.webp"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Prometheus has come of age – a reflection on the development of an open-source project","link":"https://developers.soundcloud.com/blog/prometheus-has-come-of-age-a-reflection-on-the-development-of-an-open-source-project","description":"<p>On Monday this week, the <a href=\"https://prometheus.io\">Prometheus</a> authors have released <a href=\"https://github.com/prometheus/prometheus/releases/tag/v1.0.0\">version 1.0.0</a> of the central component of the Prometheus monitoring and alerting system, the <a href=\"https://github.com/prometheus/prometheus\">Prometheus server</a>. (Other components will follow suit over the next months.) This is a major milestone for the project. Read more about it on the <a href=\"https://prometheus.io/blog/2016/07/18/prometheus-1-0-released/\">Prometheus blog</a>, and check out the <a href=\"https://cncf.io/news/blogs/2016/07/prometheus-10-here\">announcement</a> of the <a href=\"http://cncf.io\">CNCF</a>, which has recently accepted Prometheus as a hosted project.</p> \n<!-- more --> \n<p>In just a few years, Prometheus has gone a long way from its beginnings as a pet project of Matt T. Proud and Julius Volz to a widely adopted monitoring system with an amazingly active community of more than 300 contributors and a user-base spanning many different organizations, including companies like <a href=\"https://www.coreos.com/\">CoreOS</a>, <a href=\"https://www.digitalocean.com/\">DigitalOcean</a>, <a href=\"https://www.docker.com/\">Docker</a>, <a href=\"http://www.ericsson.com/\">Ericsson</a>, <a href=\"https://www.percona.com/\">Percona</a>, and <a href=\"https://www.weave.works/\">Weaveworks</a>. A pivotal midpoint in the history of the project was the public announcement in January 2015 in an <a href=\"https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud\">earlier backstage blog post</a>.</p> \n<p>In this article, I would like to reflect a bit on the childhood of Prometheus at SoundCloud, and on the benefits a company can gain from developing projects in the open under a free software license.</p> \n<p>SoundCloud has a very liberal open-source policy. We have published a large number of projects in our <a href=\"https://github.com/soundcloud/\">GitHub organization</a>. Matt and Julius, who had joined SoundCloud as engineers back in 2012, knew from the beginning that Prometheus would have a much larger scope than any of those projects. When they suggested that SoundCloud should invest in the development of a completely new monitoring system, the resistance they had to overcome was not so much related to the open-source character of the project but to its scope. After all, why should a music-streaming company with a relatively small engineering force dare to fundamentally change the way open-source monitoring is done? It was a bold move, indeed. But it was also the time of <a href=\"https://twitter.com/search?q=%23monitoringsucks\">#monitoringsucks</a>, and no open-source effort in sight to make a real dent. So we took the torch and went on our Promethean mission, cautiously avoiding the eagles.</p> \n<p>In hindsight, we know that it has paid off. For one, SoundCloud has just finished the quarter with the highest availability in the history of the company — which was also the quarter with the most features and the highest complexity the site ever had. This tremendous accomplishment would have been impossible without a novel way of monitoring our growing microservice architecture — the way enabled by Prometheus.</p> \n<p>As the main source of early contributions to the project, SoundCloud was also the earliest adopter. A nice strategic technical advantage, which – naively thought – could have been so much larger if Prometheus had been developed in secret. However, that would ignore the overwhelming advantages of an open-source development. First and foremost, without the countless contributions from the community, Prometheus would not be what it is today, and the technical advantage would be much smaller. Kickstarting a successful open-source project that is then joined by many other parties is a good way for a small company to get something going it could never have accomplished on its own. The SoundCloud open-source policy states “free bug fixes from the community” as one of the key benefits of open-sourcing projects. In the case of Prometheus, that’s quite an understatement, to say the least.</p> \n<p>Tech credibility and the resulting impact on recruiting is another important benefit. Excellent engineers like to work for companies with excellent projects, and they like to work on those projects in the open, where they benefit a whole community and provide visibility for the engineers, too. And then there is a perhaps surprising side-effect we can observe by now with Prometheus: If an open-source project is popular, some of your new-hires will already be familiar with it, resulting in a smoother and shorter onboarding.</p> \n<p>Prometheus has grown up to a real titan. We are eagerly looking forward to the further evolution of the project and to what humankind will do with the fire that was given to them.</p> \n<p><em>Björn is a production engineer at SoundCloud. He joined the company and the Prometheus project in 2013 and has been a Prometheus core developer ever since.</em></p>","descriptionType":"html","publishedDate":"Tue, 19 Jul 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"1e01099596ee94ca22f8f854d6ec4b44","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569977},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"MySQL for Statistics – Old Faithful","link":"https://developers.soundcloud.com/blog/mysql-stats-old-faithful","description":"<p>MySQL turns out to be a good Swiss Army Knife for persistence, if used wisely. Understanding disk access patterns driven by your storage engine is key. Choosing a read or write optimized disk layout will get you very far. We chose a read-optimized disk layout using InnoDB and MySQL for statistics.</p> \n<p>While our wheels were spinning trying to find out why our statistics storage patterns were <a href=\"https://developer.soundcloud.com/2011/04/failing-with-mongodb/\">causing MongoDB to thrash our disks</a>, we started looking for an emergency alternative with the technology that we already had: MySQL+InnoDB.</p> \n<p>What we knew:</p> \n<ul> \n <li>We need to persist a log entry for each play</li> \n <li>The play events are coming in sequentially ordered by time</li> \n</ul> \n<p>What we needed:</p> \n<ul> \n <li>Counts for 5 different dimensions of the plays: by referrer, listener, 3rd party application, and country, and the total count.</li> \n <li>Counts for 3 different time ranges – all time, currently displayed period and previous period to calculate the percentage changed.</li> \n <li>A time series of the totals for a single dimension over the displayed period</li> \n</ul> \n<p>What we had so far (don’t do this at home!):</p> \n<ul> \n <li>A single log table called <em>plays</em> in our online database with the below schema</li> \n <li>A secondary index on each dimension used by the statistics pages to build aggregates using the <em>count</em> aggregate function</li> \n</ul> \n<p>We posed the question, “what is the minimum we could do with our current InnoDB log table so that it can service our read load”.</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> plays <span class=\"token punctuation\">(</span>\n  id <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">AUTO_INCREMENT</span><span class=\"token punctuation\">,</span>\n  created_at <span class=\"token keyword\">datetime</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n  track_id <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n  user_id <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n  referer <span class=\"token keyword\">text</span> <span class=\"token keyword\">COLLATE</span> utf8_unicode_ci<span class=\"token punctuation\">,</span>\n  country <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">COLLATE</span> utf8_unicode_ci <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n  api_consumer_key <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">COLLATE</span> utf8_unicode_ci <span class=\"token keyword\">DEFAULT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">KEY</span> index_plays_on_track_id <span class=\"token punctuation\">(</span>track_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">KEY</span> index_plays_on_user_id <span class=\"token punctuation\">(</span>user_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">KEY</span> index_plays_on_created_at <span class=\"token punctuation\">(</span>created_at<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">KEY</span> index_plays_on_referer <span class=\"token punctuation\">(</span>referer<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span><span class=\"token keyword\">InnoDB</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">CHARSET</span><span class=\"token operator\">=</span>utf8 <span class=\"token keyword\">COLLATE</span><span class=\"token operator\">=</span>utf8_unicode_ci<span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>The impending doom of letting this table continue to grow was also approaching fast. This table was ticking along at multiple billions of rows, consuming hundreds of gigabytes of data, had no clear shard key and the indexes added another 80% on top of the data and filling too much storage space on our OLTP databases.</p> \n<p>To answer the question “what can we do to serve stats within a second”, we should also find the root cause of “why aren’t we currently servicing our current read load?”</p> \n<p>Still bruised from getting whacked by the reality stick from our previous experiences, the first step was to trace the entire operation of a typical query from request to response, paying close attention to where the IO operations <em>could</em> be occurring and take the assumption that they will always occur. We no longer assumed that our dataset would reside in memory.</p> \n<p>Our typical query looked something like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> track_id<span class=\"token punctuation\">,</span> country<span class=\"token punctuation\">,</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> total\n  <span class=\"token keyword\">from</span> plays\n <span class=\"token keyword\">where</span> track_id <span class=\"token operator\">=</span> <span class=\"token number\">123</span>\n   <span class=\"token operator\">and</span> created_at <span class=\"token operator\">between</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">interval</span> <span class=\"token number\">7</span> <span class=\"token keyword\">day</span> <span class=\"token operator\">and</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> track_id<span class=\"token punctuation\">,</span> country</code></pre>\n</div> \n<p>This was performed over date intervals of week, last week and all time. For the other dimensions, we’d group by the additional column like <em>country</em>.</p> \n<p>The first thing that gets hit is the query planner. An <a href=\"http://dev.mysql.com/doc/refman/5.1/en/explain-output.html\">explain</a> on query for a 1 row table reveals this:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\"> select_type: SIMPLE\n        table: plays\n         type: ref\npossible_keys: index_plays_on_track_id,index_plays_on_created_at\n          key: index_plays_on_track_id\n      key_len: 5\n          ref: const\n         rows: 1\n        Extra: Using where; Using temporary; Using filesort</code></pre>\n</div> \n<p>Ah, nice and simple, traverse the <em>track_id</em> index then load the row, fill out a temporary table with the aggregate fields <em>track_id</em> and <em>country</em>, then split up that temporary table into chunked buffers sorting each buffer, potentially writing it to disk, then perform a merge sort from all the temporary buffers.</p> \n<p>It looks so obvious now because we have spent the effort to read the MySQL source, read the documentation and walked through every step and the tuning variables that affect each step. We currently don’t have a DBA on staff to ask, so thankfully we could teach ourselves from the online manual and source code.</p> \n<p>Taking a little detour, it’s good to explain how we’re interpreting the Extra column one at a time. In reverse:</p> \n<h2>Using filesort</h2> \n<p>A filesort doesn’t necessarily mean it goes to files. This <a href=\"http://s.petrunia.net/blog/?p=24\">article by Sergey Petrunia</a> gives a very good overview of what a filesort actually does, putting in clear terms what is suggested for <a href=\"http://dev.mysql.com/doc/refman/5.1/en/order-by-optimization.html\">optimizing MySQL order by</a> clauses.</p> \n<p>We were obviously not hitting any <a href=\"http://dev.mysql.com/doc/refman/5.1/en/group-by-optimization.html\">group by optimizations</a> with this query.</p> \n<h2>Using temporary</h2> \n<p>This is a byproduct of <em>order by</em>, <em>group by</em> or <em>select distinct</em> as described by <a href=\"http://dev.mysql.com/doc/refman/5.1/en/internal-temporary-tables.html\">how MySQL uses internal temporary tables</a>. MySQL must use a temporary table to satisfy these kinds of query. If you have a lot of temporary tables created going to disk by monitoring the <a href=\"http://dev.mysql.com/doc/refman/5.1/en/server-status-variables.html#statvar_Created_tmp_disk_tables\">Created_tmp_disk_tables</a> status variable, you should increase your <em>tmp_table_size</em> and <em>max_heap_table_size</em> variables to prevent “swapping” on your temporary partition.</p> \n<h2>Using where</h2> \n<p>This means that the condition of the query cannot be fulfilled solely from the index. The row data must be fetched so that the condition “created_at between ? and ?” can be tested. The number of rows in the <em>rows</em> column will indicate how many rows MySQL guesses it needs to pull out from the storage engine.</p> \n<p>How the rows are fetched is actually specific to the storage engine and this is where we learned our most important lesson about InnoDB: Everything is a BTree. The InnoDB table itself is a <a href=\"http://en.wikipedia.org/wiki/Index_(database)#Clustered\">clustered index</a> on the primary key with the leaves containing the row data. The secondary indexes (the ones you add to your table) are organized by indexed columns with their leaves containing the primary key of the row. References: [Xarb][xarb], <a href=\"http://dev.mysql.com/doc/refman/5.1/en/innodb-table-and-index.html\">MySQL Indexes</a>.</p> \n<p>When you see “using where”, you are making 2 index lookups. One on the secondary index to find the primary key, and one on the clustered index (table) to find the row data.</p> \n<p>What this means for the <em>plays</em> table is a classic example of how easy it is to optimize for writes or reads but not both. The <em>plays</em> table is optimized for writes as plays come in, the surrogate ID gets incremented and ends up settling cosy next to the warm data on the right side of the BTree. A read comes in and performs a quick traversal down a secondary index. What it gets is a list of primary keys that can range from 0 to max(id). The lookup of those primary keys turn a sequential secondary index traversal into effectively multiple random lookups on the clustered index. Traverse primary key – load database page, traverse next primary key – load database page, seek to next primary key – load page, etc…</p> \n<p>In the worst-case, we incur 1 seek for every statistic. At about 10ms per seek… and some tracks with many millions of plays… we effectively try to load almost all pages from the table. Now we have the answer why we’re not able to perform.</p> \n<h2>How to fix</h2> \n<p>What we now know:</p> \n<ul> \n <li>We have effectively random reads on the full plays table using secondary indexes</li> \n</ul> \n<p>What we needed:</p> \n<ul> \n <li>Sequential reads by not reading the rows in our AUTO_INCREMENT primary key order</li> \n</ul> \n<h2>Covering indexes</h2> \n<p>This is one very good option to avoid the 2nd index lookup on the primary key in the table. A <a href=\"http://dev.mysql.com/doc/innodb/1.1/en/glossary.html#glos_covering_index\">Covering Index</a> contains all columns that will satisfy the SELECT, WHERE, ORDER BY and GROUP BY clauses in a composite index so after you traverse the secondary index, you already have all the data you need and do not need to go to the table storage. This will show up in the EXPLAIN as “Using index” and is a sign that you’ll perform only a single BTree traversal instead of one for the index and one for each of rows that index points to.</p> \n<p>Designing a covering index for our plays table requires careful thought to the ordering of the indexed columns. We need to order our indexed columns so that the composite index that composes the covering index can be reused for multiple queries. We also need to be thrifty what we’re storing here, because a covering index will make a partial copy of column data in the index.</p> \n<p>For the <em>country</em> counts, we could do something like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> <span class=\"token keyword\">index</span> covering_country_index <span class=\"token keyword\">on</span> plays <span class=\"token punctuation\">(</span>track_id<span class=\"token punctuation\">,</span> created_at<span class=\"token punctuation\">,</span> country<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>And the above select would explain like this:</p> \n<p><code class=\"language-text\">Using where; Using index; Using temporary; Using filesort</code></p> \n<p>Almost – we are using columns from the index but because the index is ordered by <em>track_id</em>, <em>created_at</em> and the GROUP BY is on <em>track_id</em>, <em>country</em>, the GROUP BY will need to create the temporary table from the row data to perform the aggregation. If we reorder the columns in the index:</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> <span class=\"token keyword\">index</span> covering_country_index <span class=\"token keyword\">on</span> plays <span class=\"token punctuation\">(</span>track_id<span class=\"token punctuation\">,</span> country<span class=\"token punctuation\">,</span> created_at<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>The query explains a bit better:</p> \n<p><code class=\"language-text\">Using where; Using index</code></p> \n<p>Using where?! Where is this coming from? We have a covering index that has the first two columns used by the GROUP BY, all columns in the WHERE and all columns in the SELECT.</p> \n<p>Ah, always <a href=\"http://dev.mysql.com/doc/refman/5.1/en/explain-output.html\">read the fine print</a>:</p> \n<blockquote> \n <p>Even if you are using an index for all parts of a WHERE clause, you may see Using where if the column can be NULL.</p> \n</blockquote> \n<p>This table is old… like SoundCloud early days prototype to get it out the door old. It was created using the ActiveRecord schema language which didn’t encourage decent table schema design. ALL of the columns can be NULL… shit.</p> \n<h2>So you want to ALTER TABLE eh?</h2> \n<p>No worries, we can just convert the column type to be able to create our covering index. Being in production, the table should still be readable while it’s being migrated to the new “NOT NULL” columns. Rehearsing the necessary operations cost on production dataset took over 1 day before looking at the temporary table size to realize it was only 20% completed.</p> \n<p>The index creation would also lock the table due to a <a href=\"http://bugs.mysql.com/bug.php?id=33650\">known bug</a> to perform <a href=\"http://dev.mysql.com/doc/refman/5.1/en/alter-table.html#alter-table-online-limitations\">online table alterations</a> on columns that are in the UTF8 charset. UTF8 column alterations will take out a read lock.</p> \n<p>Alter table on <em>plays</em> to change the charset, and add copies of all of our data into covering indexes causing up to a day of unavailability to achieve this wasn’t worth it. If we’re going to fix this, we may as well fully separate our write-optimized log from our read-optimized index.</p> \n<h2>Aha moment</h2> \n<p>What we now know:</p> \n<ul> \n <li>Covering indexes can remove the filesort and surrogate key lookup from the clustered index.</li> \n</ul> \n<p>What we need:</p> \n<ul> \n <li>A table and index format that does not cause random I/O reads.</li> \n</ul> \n<p>We were looking at duplicating the dataset of the logging table <em>plays</em> in the indexes. Only if we had tighter control of the indexes we could tune them to meet the requirements of sequential disk lookups and in-memory aggregation…</p> \n<h2>Use the clustered index… (luke).</h2> \n<p>InnoDB requires a primary key because this is the clustered index key. For almost all cases, a surrogate AUTO_INCREMENT integer key is the best because it will have good insertion performance and small overhead for the leaf nodes of the secondary indexes. But, you can specify an alternative key, even a composite key as long as it follows some constraints. Here’s the money quote, <a href=\"http://dev.mysql.com/doc/refman/5.1/en/innodb-index-types.html\">again from the excellent documentation</a>:</p> \n<blockquote> \n <ul> \n  <li>If you define a PRIMARY KEY on your table, InnoDB uses it as the clustered index.</li> \n  <li>If you do not define a PRIMARY KEY for your table, MySQL picks the first UNIQUE index that has only NOT NULL columns as the primary key and InnoDB uses it as the clustered index.</li> \n  <li>If the table has no PRIMARY KEY or suitable UNIQUE index, InnoDB internally generates a hidden clustered index on a synthetic column containing row ID values. The rows are ordered by the ID that InnoDB assigns to the rows in such a table. The row ID is a 6-byte field that increases monotonically as new rows are inserted. Thus, the rows ordered by the row ID are physically in insertion order.</li> \n </ul> \n <p>Accessing a row through the clustered index is fast because the row data is on the same page where the index search leads. If a table is large, the clustered index architecture often saves a disk I/O operation when compared to storage organizations that store row data using a different page from the index record. (For example, MyISAM uses one file for data rows and another for index records.)</p> \n</blockquote> \n<p>The primary key must contain unique, non-null columns. This doesn’t work very well for the raw plays table because we could have 2 plays on the same track in the same second from the same country and would like to count both. Not to mention an increase in the key size would explode the size of our secondary indexes.</p> \n<p>A new table schema could take advantage of the clustered index that InnoDB provides. The trade-off is bloated secondary indexes due to the secondary index’s leaf nodes containing the primary key of the table. If we don’t need secondary indexes, then lets look at how to shape a clustered index.</p> \n<h2>Introducing aggregate tables</h2> \n<p>To support the time series and totals query for both per-user and per-track using unique primary keys that help shape our clustered index leveraged the “bucket” model from our prior attempts at the stats. We looked at the minimum granularity we wanted for the statistics and found that hourly and daily were sufficient for all aggregations. Given that, we could create a schema that looked something like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> <span class=\"token keyword\">table</span> plays_by_hour <span class=\"token punctuation\">(</span>\n  owner_id <span class=\"token keyword\">integer</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>\n  track_id <span class=\"token keyword\">integer</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">hour</span> <span class=\"token keyword\">timestamp</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>\n  count <span class=\"token keyword\">integer</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">primary</span> <span class=\"token keyword\">key</span> <span class=\"token punctuation\">(</span>owner_id<span class=\"token punctuation\">,</span> track_id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">hour</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>Our time series per track query could be as simple as:</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> owner_id<span class=\"token punctuation\">,</span> track_id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">hour</span><span class=\"token punctuation\">,</span> count\n  <span class=\"token keyword\">from</span> plays_by_hour\n <span class=\"token keyword\">where</span> owner_id <span class=\"token operator\">=</span> <span class=\"token number\">123</span>\n   <span class=\"token operator\">and</span> track_id <span class=\"token operator\">=</span> <span class=\"token number\">123</span>\n   <span class=\"token operator\">and</span> <span class=\"token keyword\">hour</span> <span class=\"token operator\">between</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">interval</span> <span class=\"token number\">1</span> <span class=\"token keyword\">day</span> <span class=\"token operator\">and</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>This explains as:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">  select_type: SIMPLE\n        table: plays_by_hour\n         type: range\npossible_keys: PRIMARY\n          key: PRIMARY\n      key_len: 12\n          ref: NULL\n         rows: 1\n        Extra: Using where</code></pre>\n</div> \n<p>The “Using where” in this explain is effectively the same thing as “Using index” because all columns in the where make up the branches in the clustered index and since we only need the count, that value stored on the leaves is already loaded from disk from the index traversal.</p> \n<p>The composition of coarser grained time series isn’t so bad now because we have loaded adjacent pages during the primary key choice.</p> \n<p>To get the total for that time series on day groupings, all that is needed is to sum the counts:</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> track_id<span class=\"token punctuation\">,</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>count<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> total\n  <span class=\"token keyword\">from</span> plays_by_hour\n <span class=\"token keyword\">where</span> owner_id <span class=\"token operator\">=</span> <span class=\"token number\">123</span>\n   <span class=\"token operator\">and</span> track_id <span class=\"token operator\">=</span> <span class=\"token number\">123</span>\n   <span class=\"token operator\">and</span> <span class=\"token keyword\">hour</span> <span class=\"token operator\">between</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">interval</span> <span class=\"token number\">1</span> <span class=\"token keyword\">month</span> <span class=\"token operator\">and</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> owner_id<span class=\"token punctuation\">,</span> track_id</code></pre>\n</div> \n<p>Back of the hand math is if we have 64 bytes per row, and even if we’re looking at 5 years of counts, our upper bound is no more than 3 MB to pull off of disk. When the tables are optimized, this is a sequential read at ~50MB/s, keeping well under 100ms which is acceptable for this application.</p> \n<p>By including the owner_id in the primary key, we get a degree of locality and a handy partitioning key for our queries as well.</p> \n<p>For the remaining metrics around countries and apps, we just added one more column to the clustered index.</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">create</span> <span class=\"token keyword\">table</span> plays_by_country_day <span class=\"token punctuation\">(</span>\n  track_id <span class=\"token keyword\">integer</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">day</span> <span class=\"token keyword\">timestamp</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>\n  country <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>\n  count <span class=\"token keyword\">integer</span> <span class=\"token keyword\">unsigned</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">primary</span> <span class=\"token keyword\">key</span> <span class=\"token punctuation\">(</span>track_id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">day</span><span class=\"token punctuation\">,</span> country<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>(Don’t forget to pick the simplest character encoding to support your dataset like <em>latin1</em> if you have any character columns).</p> \n<h2>Reasoning about I/O</h2> \n<p>In our <a href=\"https://developer.soundcloud.com/2011/04/failing-with-mongodb/\">MongoDB experience</a> we spent a long time running experiments to identify the worst case performance. With MySQL and InnoDB, we have very clear documentation on the on-disk layout of the tables and indexes. We can reason very well about the worst case performance of our non-optimized plays table and index layout. Now we can reason very well about the worst case performance of this new table layout. The explain output is somewhat limited. We have one signal out of MySQL “Using where” and copious documentation to give that meaning.</p> \n<p>We chose this approach because we could reason about I/O. We also can reason about space. By using a partial aggregation on <em>hour</em>, we know that upper bound for storage is one row for every hour since the creation of the track. By treating the data as the (clustered) index, we can reason both about the index and data size, because they are the same! We can calculate storage requirements by correlating track growth to these aggregate tables by hour, not by popularity.</p> \n<p>What we also get is the desired sequential disk access on a cold cache because the row data (the count) is on the same page that gets traversed. We also get data locality of the time series for balanced BTrees. However, the persistence of the BTree can produce page splits where pages are not physically located next to each other, but due to the separation of these read-optimized tables from the source-of-truth, write-optimized event storage means we can run OPTIMIZE TABLE weekly which will reorganize the physical pages of the aggregate tables so that they are mostly sequential.</p> \n<p>The catch is, by using aggregate tables in read-optimized form, there is no way we can sustain the writes directly from our raw stream of events. We must also use an <a href=\"http://en.wikipedia.org/wiki/Extract,_transform,_load\">ETL</a> process that batches the updates per hour and per day from the log table. We started running ours every 15 minutes, but found that we must tune that back to every hour. Not so realtime. To get the realtime behavior another in-memory system would be the best bet to lay over the persistence for the most recent hour/day of counts.</p> \n<h2>Takeaway</h2> \n<p>This is not the end of our stats story. We want realtime stats for ourselves, and want you to have them too! This solution won’t last forever, but from start to finish, leveraging all the knowledge gained from an incomplete Cassandra implementation, and incomplete MongoDB implementation plus our in-house experience with MySQL, it took 3 months to research, design and deploy. With about 2 weeks purely on the data migration.</p> \n<p>This is not a story about how NoSQL fails, how MySQL wins, or how to code like a <a href=\"http://lolcat.biz/\">lolcat</a>. It’s a story of what we’re doing to get by with the core physical limitations of CPU/Memory/Network/Disk and operational resources, one order of magnitude of user growth at a time.</p> \n<p>Speaking with others about this solution has also led to some insights. SSDs will likely make the data locality of using a clustered index a non-issue. And we could generalize the table layout for other metrics as well, instead of saying “plays_by_country_day” it would be “daily_stats_by_country” and include a 2 byte “metric_id” that would indicate this was a ‘play’ rather than ‘download’.</p> \n<p>Understanding the lower and upper bounds of your I/O profile is critical when designing for consistent performance, data-driven systems with any technology. Good documentation and understanding of your storage engine’s implementation is the key to achieve that.</p> \n<h2>Curious</h2> \n<p>If you’re storing and serving hundreds of GB or TB of stats for your customers, how have you designed your system?</p>","descriptionType":"html","publishedDate":"Tue, 05 Jul 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"0ae142942d4032467fe3ab1dba7b1237","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud Signs Apache Corporate Contributor License Agreement","link":"https://developers.soundcloud.com/blog/soundcloud-signs-apache-corporate-contributor-license-agreement","description":"<p>We just signed the corporate contributor license agreement (CCLA). SoundCloud always was big on open source – we nearly exclusively use open source software in our company and use a lot of Apache projects like Hadoop, Solr, Flume, Zookeeper and Cassandra on our large scale production site.</p> \n<p>As SoundCloud is using a lot of Apache projects and started to contribute to project we decided to sign the CCLA and enable all our developers to contribute to Apache projects even during work time if that project is used by SoundCloud.</p> \n<p>The first project we will commit code to is Flume, we hope there are several more coming.</p> \n<p>Apache, keep up the great work and we will support you wherever possible!</p>","descriptionType":"html","publishedDate":"Fri, 14 Oct 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"99da1ef273f62b384b256b46d8743d3e","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Architecture behind our new Search and Explore experience","link":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","description":"<p>Search is front-and-center in the new SoundCloud, key to the consumer experience. We’ve made the search box one of the first things you see, and beefed it up with suggestions that allow you to jump directly to people, sounds, groups, and sets of interest. We’ve also added a brand-new Explore section that guides you through the huge and dynamic landscape of sounds on SoundCloud. We’ve also completely overhauled our search infrastructure, which helps us provide more relevant results, scale with ease, and experiment quickly with new features and models.</p> \n<h3>In the beginning</h3> \n<p>In SoundCloud’s startup days, when we were growing our product at super speed, we spent just two days implementing a straightforward search feature, integrating it directly into our main app. We used Apache Solr, as was the fashion at the time, and built a master-slave cluster with the common semantics: writes to the master, reads from the slaves. Besides a separate component for processing deletes, our indexing logic was pull-based: the master Solr instance used a Solr <a href=\"http://wiki.apache.org/solr/DataImportHandler\">DataImportHandler</a> to poll our database for changes, and the slaves polled the master.</p> \n<p>At first, this worked well. But as time went on, our data grew, our entities became more complex, and our business rules multiplied. We began to see problems.</p> \n<h3>The problems</h3> \n<ul> \n <li>The index was only getting updated on the read slaves about every fifteen minutes. Being real-time is crucial in the world of sound, as it’s important that our users’ sounds are searchable immediately after upload.</li> \n <li>A complete re-index of the master node from the database took up to 24 hours, which made making a simple schema change for a new feature or bugfix a Sisyphean task.</li> \n <li>Worse, during those complete-reindex periods, we couldn’t do incremental indexing because of limitations in the DataImportHandler. That meant the search index was essentially frozen in time: not a great user experience.</li> \n <li>Because the search infrastructure was tightly coupled in the main application, low-level Solr or Lucene knowledge leaked everywhere. If we wanted to make a slight change, such as to a filter, we had to touch 25 parts of the codebase in the main application.</li> \n <li>Because the application directly interacted with the master, if that single-point-of-failure failed, we lost information about updates, and our only reliable recovery was a complete reindex, which took 24 hours.</li> \n <li>Since Solr uses segment or bulk replication, our network was flooded when the slaves pulled updates from the master, which caused additional operational issues.</li> \n <li>Solr felt like it was built in a different age, for a different use-case. When we had performance problems, it was opaque and difficult to diagnose.</li> \n</ul> \n<p>In early 2012, we knew we couldn’t go forward with many new features and enhancements on the existing infrastructure. We formed a new team and decided we should rebuild the infrastructure from scratch, learning from past lessons. In that sense, the Solr setup was an asset: it could continue to serve site traffic, while we were free to build and experiment with a parallel universe of search. Green-field development, unburdened by legacy constraints: every engineer’s dream.</p> \n<h3>The goals</h3> \n<p>We had a few explicit goals with the new infrastructure.</p> \n<p>* <strong>Velocity</strong>: we want high velocity when working on schema-affecting bugs and features, so a complete reindex should take on the order of an hour. * <strong>Reliability</strong>: we want to grow to the next order of magnitude and beyond, so scaling the infrastructure—horizontally and vertically—should require minimum effort. * <strong>Maintainability</strong>: we don’t want to leak implementation details beyond our borders, so we should strictly control access through APIs that we design and control.</p> \n<p>After a survey of the state of the art in search, we decided to abandon Solr in favor of ElasticSearch, which would theoretically address our reliability concerns in their entirety. We then just had to address our velocity and maintenance concerns with our integration with the rest of the SoundCloud universe. To the whiteboard!</p> \n<h3>The plan</h3> \n<p>On the read side, everything was pretty straightforward. We’d already built a simple API service between Solr and the main application, but had hit some roadblocks when integrating it. We pivoted and rewrote the backend of that API to make ElasticSearch queries, instead: an advantage of a lightweight service-oriented architecture is that refactoring services in this way is fast and satisfying.</p> \n<p>On the write side—conceptually, at least—we had a straightforward task. Search is relatively decoupled from other pieces of business and application logic. To maintain a consistent index, we only need an authoritative source of events, ie. entity creates, updates, and deletes, and some method of enriching those events with their searchable metadata. We had that in the form of our message broker. Every event that search cared about was being broadcast on a well-defined set of exchanges: all we had to do was listen in.</p> \n<p>But depending on broker events to materialize a search index is dangerous. We would be susceptible to schema changes: the producers of those events could change the message content, and thereby break search without knowing, potentially in very subtle ways. The simplest, most robust solution was to ignore the content of the messages, and perform our own hydration. That carries a runtime cost, but it would let us better exercise control over our domain of responsibility. We believed the benefits would outweigh the costs.</p> \n<p>Using the broker as our event source, and the database as our ground truth, we sketched an ingestion pipeline for the common case. Soon, we realized we had to deal with the problem of synchronization: what should we do if an event hadn’t yet been propagated to the database slave we were querying? It turned out that if we used the timestamp of the event as the “external” version of the document in ElasticSearch, we could lean on ElasticSearch’s consistency guarantees to detect, and resolve, problems of sync.</p> \n<p>Once it hit the whiteboard, it became clear we could re-use the common-case pipeline for the bulk-index workflow; we just had to synthesize creation events for every entity in the database. But could we make it fast enough? It seemed at least possible. The final box-diagram looked like this:</p> \n<p><img src=\"https://developers.soundcloud.com/blog/assets/search-infra1.png\" /></p> \n<p>Implementation and optimization began. Over a couple of weeks, we iterated over several designs for the indexing service. We eked out a bit more performance in each round, and in the end, we got where we wanted: indexing our entire corpus against a live cluster took around 2 hours, we had no coupling in the application, and ElasticSearch itself gave us a path for scaling.</p> \n<h3>The benefits</h3> \n<p>We rolled out the new infrastructure in a dark launch on our beta site. Positive feedback on the time-to-searchability was immediate: newly-posted sounds were discoverable in about 3 seconds (post some sounds and try it out for yourself!). But the true tests came when we started implementing features that had been sitting in our backlog. We would start support for a new feature in the morning, make schema changes into a new index over lunch, and run A/B tests in the afternoon. If all lights were green, we could make an immediate live swap. And if we had any problems, we could rollback to the previous index just as fast.</p> \n<p>There’s no onerous, manual work involved in bootstrapping or maintaining nodes: everything is set up with ElasticSearch’s REST API. Our index definitions are specified in flat JSON files. And we have a single dashboard with all the metrics we need to know how search is performing, both in terms of load and search quality.</p> \n<p>In short, the new infrastructure has been an unqualified success. Our velocity is through the roof, we have a clear path for orders-of-magnitude growth, and we have a stable platform for a long time to come.</p> \n<h3>Enter DiscoRank</h3> \n<p>It’s not the number of degrees of separation between you and John Travolta: DiscoRank is our modification of the PageRank algorithm to provide more relevant search results: short for Discovery Rank. We match your search against our corpus and use DiscoRank to rank the results.</p> \n<p><img src=\"https://developers.soundcloud.com/blog/assets/cool_disco.png\" /></p> \n<p>The DiscoRank algorithm involves creating a graph of searchable entities, in which each activity on SoundCloud is an edge connecting two nodes. It then iteratively computes the ranking of each node using the weighted graph of entities and activities. Our graph has millions and millions of nodes and a lot more edges. So, we did a lot of optimizations to adapt PageRank to our use case, to be able to keep the graph in memory, and to recalculate the DiscoRank quickly, using results from previous runs of the algorithm as priors. We keep versioned copies of the DiscoRank so that we can swap between them when testing things out.</p> \n<h3>How do we know we’re doing better?</h3> \n<p>Evaluating the relevance of search results is a challenge. You need to know what people are looking for (which is not always apparent from their query) and you need to get a sample that’s representative enough to judge improvement Before we started work on the new infrastructure, we did research and user testing to better understand how and why people were using search on SoundCloud.</p> \n<p>Our evaluation baseline is a set of manually-tagged queries. To gather the first iteration of that data, we built an internal evaluation framework for SoundCloud employees: thumbs up, thumbs down on results. In addition, we have metrics like click positions, click engagement, precision, and recall, all constantly updating in our live dashboard. This allows us to compare ranking algorithms and other changes to the way we construct and execute queries. And we have mountains of click log data that we need to analyse.</p> \n<p>We have some good improvements so far, but there’s still a lot of tuning that can be done.</p> \n<p><img src=\"https://developers.soundcloud.com/blog/assets/SearchTimings-505x378.png\" /></p> \n<p><img src=\"https://developers.soundcloud.com/blog/assets/SuggesterTimings-505x378.png\" /></p> \n<h3>Search as navigation</h3> \n<p>The new Suggest feature lets you jump straight to the sound, profile, group, or set you’re looking for. We’ll trigger your memory if you don’t remember how something is spelled, or exactly what it’s called. Since we know the types of the results returned, we can send you straight to the source. This ability to make assumptions and customizations is a consequence of knowing the structure and semantics of our data, and gives a huge advantage in applications like this.</p> \n<p>Architecture-wise, we decided to separate the suggest infrastructure from the main search cluster, and build a custom engine based on Apache Lucene’s Finite State Transducers. As ever, delivering results fast is crucial. Suggestions need to show up right after the keystroke. It turned out we are competing with the speed of light for this particular use-case.</p> \n<p>The fact that ElasticSearch doesn’t come with a suggest engine turned out to be a non-issue and rather forced us to build this feature in isolation. This separation proved to be a wise decision, since update-rate, request patterns and customizations are totally different, and would have made a built-in solution hard to maintain.</p> \n<h3>Search as a crystal ball</h3> \n<p>Similar to suggest, <a href=\"https://www.soundcloud.com/explore\">Explore</a> is based on our new search infrastructure, but with a twist: our main goal for Explore is to showcase the sounds in our community at this very moment. This led to a time-sensitive ranking, putting more emphasis on the newness of a sound.</p> \n<h3>So far, so good</h3> \n<p>We hope you enjoy using the new search features of SoundCloud as much as we enjoyed building them. Staying focused on a re-architecture is painful when you see your existing infrastructure failing more and more each day, but we haven’t looked back—especially since our new infrastructure allows us to deliver a better user experience much faster. We now can roll out new functionality with ease, and the new Suggest and Explore along with an improved Search itself are just the first results.</p> \n<p>Keep an eye out for more improvements to come!</p> \n<p><em>Apache Lucene and Solr are trademarks of the Apache Software Foundation</em></p>","descriptionType":"html","publishedDate":"Tue, 04 Dec 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/assets/search-infra1.png","linkMd5":"a1f960286d7cd6e29448487562ca7cca","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/assets/search-infra1.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","https://developers.soundcloud.com/blog/assets/cool_disco.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","https://developers.soundcloud.com/blog/assets/SearchTimings-505x378.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","https://developers.soundcloud.com/blog/assets/SuggesterTimings-505x378.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg"},"publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Stratus 2 BETA","link":"https://developers.soundcloud.com/blog/stratus-2-beta","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 550px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/32c3986a57ccc05df110971382a6512a/2cf63/stratus2-beta.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 68.36363636363636%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAAB2klEQVQoz21STU/CQBDtz1J/Gokx3DgRvGnCBTXx42BQqYHUA94sCQRM+EzEIsVCW/sBbbcUqL7dFULEl3Q67e6bmTczwmKxWK0Rx3FIyGw2c6cUcGBt23YcJwiCJQPuL9cQwPnewnw+x1XXdbnlsJkPvu/7iOh5Hnf+IeMeTe46U2ppETAu8wghYRhu7A45mjuuw8hTRuMKfskbjagZ9i85iqLJZKKq6nA4HI/Ho9EIjsqAT0Txt/CXjNiQpOv6SFVN0/yk0PAgChxD178YTPPLsqx/yGiVZVuofNOeDaZrcDm/5JgBDtqgaShwjGNOQAhKY9rJGiHDbuZlEBAuCTw0BgNCIyzL9v2ApaHXYpZPwDE+JrrearUNw4C2drutKAqK/9S0breLZXnrv2HU+Anxg4+PwWCA5GAJiIrXcSZzsLd/fnZeKpUKhUI2m71gEEVRkqRcLtfr9YrFYqVSkWW5VquhLkrmmRv1+s3VNWK/Nhqy/FIul/P5/KMoVqvV+7s7SXpCF5rNJlZoW6MQEW9JvBWTgjNsM+ass5GgclisGtabr3RAQRuGmyhZMF6fverD5e390eFhMplMpVLpdDqRSJycnGKckKe8K7AYe6fT7ff7GAVi8YH9AGFWA3L6tEQWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Stratus 2 BETA\" title=\"Stratus 2 BETA\" src=\"https://developers.soundcloud.com/blog/static/32c3986a57ccc05df110971382a6512a/2cf63/stratus2-beta.png\" srcset=\"/blog/static/32c3986a57ccc05df110971382a6512a/9ec3c/stratus2-beta.png 200w,\n/blog/static/32c3986a57ccc05df110971382a6512a/c7805/stratus2-beta.png 400w,\n/blog/static/32c3986a57ccc05df110971382a6512a/2cf63/stratus2-beta.png 550w\" sizes=\"(max-width: 550px) 100vw, 550px\" loading=\"lazy\" /> </a> </span></p> \n<p><a href=\"https://stratus.sc\">Stratus</a> is a <a href=\"http://jquery.com\">jQuery</a> powered <a href=\"https://soundcloud.com\">SoundCloud</a> player that lives at the bottom (or top) of your website or blog. In <strong>version 2</strong>, we’ve rebuilt Stratus from the ground up to include many requested features, a nicer aesthetic, and a much easier installation.</p> \n<p>Pumped? <em>Yeh</em>, me too. Here’s how to participate in the BETA:</p> \n<!-- more --> \n<p>&nbsp;</p> \n<h2>Installation</h2> \n<p><strong>See installation guides for:</strong> <a href=\"https://stratus.sc/guides#wordpress\">Wordpress</a> <a href=\"https://stratus.sc/guides#tumblr\">Tumblr</a> <a href=\"https://stratus.sc/guides#blogger\">Blogger</a></p> \n<p>Installing Stratus is easy. All you need to do is add some code to the <code class=\"language-text\">head</code> section of your HTML.</p> \n<p>First, make sure you have <a href=\"http://jquery.com\">jQuery</a> installed.</p> \n<p>Next, include the main Stratus library.</p> \n<div class=\"gatsby-highlight\" data-language=\"html\"> \n <pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://stratus.sc/stratus.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre> \n</div> \n<p>Finally, <a href=\"https://stratus.sc/#customization\">configure</a> and load the Stratus plugin.</p> \n<div class=\"gatsby-highlight\" data-language=\"html\"> \n <pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">stratus</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      links<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://soundcloud.com/foofighters/sets/wasting-light'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre> \n</div> \n<p><strong>That’s it!</strong> For a list of all configuration options, go <a href=\"https://stratus.sc/#customization\">here</a>.</p> \n<p>&nbsp;</p> \n<h2>Feedback</h2> \n<p>All good BETA tests require good feedback. If you’ve got a suggestion, found a bug, or deployed the player on your site: <strong>Please</strong>, let me know <a href=\"https://twitter.com/leemartin\">@leemartin</a> or at <a href=\"mailto:lee@soundcloud.com\">lee@soundcloud.com</a>. We really appreciate the help!</p> \n<p>Thanks and happy BETA testing!</p>","descriptionType":"html","publishedDate":"Mon, 12 Mar 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/32c3986a57ccc05df110971382a6512a/2cf63/stratus2-beta.png","linkMd5":"837aabdfb380892539f5756be934664e","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn45@2020_4/2020/08/25/00-49-37-182_2e90e8ad6e40e901.webp","destWidth":550,"destHeight":376,"sourceBytes":17655,"destBytes":13466,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/32c3986a57ccc05df110971382a6512a/2cf63/stratus2-beta.png":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn45@2020_4/2020/08/25/00-49-37-182_2e90e8ad6e40e901.webp"},"publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Building Products at SoundCloud—Part III: Microservices in Scala and Finagle","link":"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-3-microservices-in-scala-and-finagle","description":"<p>In the first two parts of this series, we talked about how SoundCloud started breaking away from a monolithic Ruby on Rails application into a microservices architecture. In this part we will talk a bit more about the platforms and languages in which we tend to write these microservices.</p> \n<p>At the same time that we started the process of building systems outside the <em>Mothership</em> (our Rails monolith) we started breaking our large team of engineers into smaller teams that focused on one specific area of our platform.</p> \n<p>It was a phase of high experimentation, and instead of defining which languages or runtimes these teams should use, we had the rule of thumb <em>write it in whatever you feel confident enough putting in production and being on-call for</em>.</p> \n<p>This led to a <a href=\"http://en.wikipedia.org/wiki/Cambrian_explosion\">Cambrian Explosion</a> of languages, runtimes and skills. We had systems being developed in everything from Perl to Julia, including Haskell, Erlang, and node.js.</p> \n<p>While this process proved quite productive in creating new systems, we started having problems when maintaining them. The <a href=\"http://en.wikipedia.org/wiki/Bus_factor\">bus factor</a> for several of our systems was very low, and we eventually decided to consolidate our tools.</p> \n<p>Based on the expertise and preferences across teams, and an assessment of the industry and our peers, we decided to stick to the JVM and select JRuby, Clojure, and Scala as our company-wide supported languages for product development. For infrastructure and tooling, we also support Go and Ruby.</p> \n<p>Turns out that selecting the runtime and language is just one step in building products in a microservices architecture. Another important aspect an organization has to think about is what <em>stack</em> to use for things like RPC, resilience, and concurrency.</p> \n<p>After some research and prototyping, we ended up with three alternatives: a pure <em>Netty</em> implementation, the <em>Netflix stack</em>, and the <em>Finagle stack</em>.</p> \n<p>Using pure <a href=\"http://netty.io/\">Netty</a> was tempting at first. The framework is well documented and maintained, and the support for HTTP, our main protocol for RPC, is good. After a while, though, we found ourselves implementing abstractions on top of it to do basic things for the concurrency and resilience requirements of our systems. If such abstractions were to be required, we would rather use something that exists than re-invent the wheel.</p> \n<p>We tried the Netflix stack, and a while back <a href=\"http://blog.josephwilk.net/clojure/building-clojure-services-at-scale.html\">Joseph Wilk wrote about our experience with Hystrix and Clojure</a>. <a href=\"https://github.com/Netflix/Hystrix\">Hystrix</a> does very well in the resilience and concurrency requirements, but its API based on the <em>Command</em> pattern was a turnoff. In our experience, Hystrix commands do not compose very well unless you also use RxJava, and although we use this library for several back-end systems and our Android application, we decided that the reactive approach was not the best for all of our use cases.</p> \n<p>We then started trying out <a href=\"http://twitter.github.io/finagle/\">Finagle</a>, a protocol-agnostic RPC system developed by Twitter and used by many companies our size. Finagle does very well in our three requirements, and its design is based on a familiar and extensible <em><a href=\"http://www.eaipatterns.com/PipesAndFilters.html\">Pipes-and-Filters</a> meets <a href=\"http://docs.scala-lang.org/overviews/core/futures.html\">Futures</a></em> model.</p> \n<p>The first issue we found with Finagle is that, as opposed to the other alternatives, it is written in Scala, therefore the language runtime jar file is required even for a Clojure or JRuby application. We decided that this wasn’t too important, though it adds about 5MB to the transitive dependencies’ footprint, the language runtime is very stable and does not change often.</p> \n<p>The other big issue was to adapt the framework to our conventions. Twitter uses mostly Thrift for RPC; we use HTTP. They use ZooKeeper for Service Discovery; we use DNS. They use a Java properties-based configuration system; we use environment variables. They have their own telemetry system; we have our own telemetry system (we’re not ready to show it just yet, but stay tuned for some exciting news there). Fortunately, Finagle has some very nice abstractions for these areas, and most of the issues were solved with very minimal changes and there was no need to patch the framework itself.</p> \n<p>We then had to deal with the very messy state of Futures in Scala. Heather Miller, from the Scala core team, <a href=\"http://www.infoq.com/presentations/Asynchronous-Scala-Java\">explained the history and changes introduced by newer versions of the language in a great presentation</a>. But in summary, what we have across the Scala ecosystem are several different implementations of Futures and Promises, with Finagle coupled to <a href=\"https://github.com/twitter/util/blob/master/util-core/src/main/scala/com/twitter/util/Future.scala\">Twitter’s Futures</a>. Although <a href=\"https://groups.google.com/d/msg/finaglers/wjADYhoiJKM/Ejqd6A9rahMJ\">Scala allows for compatibility between these implementations</a>, we decided to use Twitter’s everywhere, and invest time in <a href=\"https://github.com/twitter/util/pull/97\">helping the Finagle community move closer to the most recent versions of Scala</a> rather than debug weird issues that this interoperability might spawn.</p> \n<p>With these issues addressed, we focused on how best to develop applications using Finagle. Luckly, Finagle’s design philosophy is nicely described by Marius Eriksen, one of its core contributors, in his paper <a href=\"http://monkey.org/~marius/funsrv.pdf\"><em>Your Server as a Function</em></a>. You don’t need to follow these principles in your <em>userland</em> code, but in our experience everything integrates much better if you do. Using a Functional programming language like Scala makes following these principles quite easy, as they map very well to pure functions and combinators.</p> \n<p>We have used Finagle for HTTP, Thrift, memcached, Redis, and MySQL. Every request to the SoundCloud platform is very likely hitting at least one of our Finagle-powered microservices, and the performance we have from these is quite amazing.</p> \n<p>In the last part of this series of blog posts, we will be talking about how Finagle and Scala are being used to move away from a <em>one-size-fits-all</em> RESTful API to optmized back-ends for our applications.</p>","descriptionType":"html","publishedDate":"Fri, 13 Jun 2014 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"8c8c8c8a0c1ca1d9c16dbf68cbf7a9cf","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569979},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SocialFolders Releases SoundCloud Ruby Gem","link":"https://developers.soundcloud.com/blog/socialfolders-releases-soundcloud-gem","description":"<p>There are many approaches to building libraries that wrap HTTP APIs. For many of our <a href=\"https://developers.soundcloud.com/docs/api/sdks\">officially supported SDKs</a> we chose to build light wrappers around HTTP client libraries with a few added features to make it easier to work with the SoundCloud API. This approach has a few benefits. It guarantees a certain consistency and is relatively easy to maintain. It’s also fairly future proof. Changes in the HTTP API do not typically require updates to client libraries.</p> \n<p>Sometimes however, you might be looking for something a bit more feature-full, or with more abstraction from our HTTP API. That’s why I was really happy to see that the great folks at <a href=\"http://socialfolders.me/\">SocialFolders</a> built an alternative SoundCloud Ruby gem and released it to the public. You can check out their <a href=\"http://socialfolders.me/2012/06/new-soundcloud-gem/\">blog post</a> about it or go straight to the source on <a href=\"https://github.com/SocialFolders/soundcloud-client\">GitHub</a>.</p> \n<!-- more --> \n<p>You can install the library from source or by running:</p> \n<div class=\"gatsby-highlight\" data-language=\"shell\">\n <pre class=\"language-shell\"><code class=\"language-shell\">$ gem <span class=\"token function\">install</span> soundcloud-client</code></pre>\n</div> \n<p>The library is based on the excellent <a href=\"https://github.com/technoweenie/faraday\">Faraday</a> HTTP client library and can therefore be used really easily with libraries like <a href=\"http://rubyeventmachine.com/\">EventMachine</a> or <a href=\"https://github.com/typhoeus/typhoeus\">Typhoeus</a>. It also provides wrapper methods for all SoundCloud API endpoints. This means that instead of calling a method named for an HTTP verb and providing an endpoint path, you can write code that looks like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\">\n <pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">require</span> <span class=\"token string\">'soundcloud-client'</span>\n\nclient <span class=\"token operator\">=</span> <span class=\"token constant\">Soundcloud</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">API</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ACCESS_TOKEN'</span><span class=\"token punctuation\">)</span>\ntracks <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span>tracks<span class=\"token punctuation\">(</span><span class=\"token symbol\">:order</span> <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'hotness'</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:limit</span> <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\ntracks<span class=\"token punctuation\">.</span><span class=\"token keyword\">each</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>track<span class=\"token operator\">|</span>\n  puts <span class=\"token string\">\"Track: <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>track<span class=\"token punctuation\">.</span>title<span class=\"token delimiter tag\">}</span></span>\"</span>\n<span class=\"token keyword\">end</span></code></pre>\n</div> \n<p>It’s great to see tools like this coming out of our developer community. Huge shout out to <a href=\"https://github.com/rewritten\">Saverio Trioni</a> and the rest of the <a href=\"http://socialfolders.me\">SocialFolders</a> team.</p>","descriptionType":"html","publishedDate":"Fri, 06 Jul 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"b7adb7ddec890dcdd353d684a03833d0","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Of CORS We Do","link":"https://developers.soundcloud.com/blog/of-cors-we-do","description":"<p>If you’re a JavaScript head, we’ve got something for you. SoundCloud now supports <a href=\"https://www.w3.org/TR/cors/\">Cross Origin Resource Sharing</a>, using&nbsp;XMLHttpRequest. Or, to put it another way: no more implausible <a href=\"http://en.wikipedia.org/wiki/JSONP#JSONP\">JSON-P</a> hacks.</p> \n<p>Some background on CORS can be found&nbsp;<a href=\"https://developer.mozilla.org/en/HTTP_access_control\" title=\"here\">here</a> and&nbsp;<a href=\"http://hacks.mozilla.org/2009/07/cross-site-xmlhttprequest-with-cors/\" title=\"here\">here</a>. &nbsp;Our implementation is super-simple: &nbsp;we let you do GET requests, for our public resources. Full documentation of the feature&nbsp;<a href=\"http://wiki.github.com/soundcloud/api/06-cross-site-scripting\" title=\"is on our wiki\">is on our wiki</a>, but here’s a bit of code to get you started:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> invocation <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XMLHttpRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Internet Explorer uses a propritary object called XDomainRequest</span>\n<span class=\"token keyword\">var</span> url <span class=\"token operator\">=</span> <span class=\"token string\">'https://api.soundcloud.com/tracks'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">callOtherDomain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>invocation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        invocation<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        invocation<span class=\"token punctuation\">.</span>onreadystatechange <span class=\"token operator\">=</span> handler<span class=\"token punctuation\">;</span>\n        invocation<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>As we’re just setting headers, the implementation was done as an addition to our Rack stack, which means that it’s easy for us to pull out or move around as needed. Once the appropriate headers are added, these newfangled modern browsers handle the rest.</p>","descriptionType":"html","publishedDate":"Fri, 27 Aug 2010 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"aea11e4d5f3a4313ba05f2405db857c1","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Announcing Twinagle: Twirp and Protobuf for Finagle","link":"https://developers.soundcloud.com/blog/announcing-twinagle","description":"<p>A <a href=\"https://developers.soundcloud.com/blog/synchronous-communication-for-microservices-current-status-and-learnings\">previous post</a> on this blog ended with the following paragraph:</p> \n<blockquote> \n <p>“We might also replace JSON with a more efficient serialization protocol like <a href=\"https://developers.google.com/protocol-buffers/\">protocol buffers</a>. This would further improve performance and should result in less handwritten serialization and deserialization code but this still needs more experimentation and investigation.”</p> \n</blockquote> \n<p>To follow up on the above, this article announces the release of Twinagle, an open source implementation of the Twirp protocol for Scala/Finagle.</p> \n<h2>Background</h2> \n<p>The backend of SoundCloud is designed around a set of <a href=\"https://developers.soundcloud.com/blog/category/microservices\">microservices</a>. As <a href=\"https://developers.soundcloud.com/blog/synchronous-communication-for-microservices-current-status-and-learnings\">detailed previously</a>, services expose a REST-like interface and use HTTP and JSON to communicate. Our services are usually implemented in Scala, making use of Twitter’s Finagle library, but we have a fair amount of Ruby and Go powering production as well.</p> \n<p>This choice has worked well for us, because tooling around HTTP and JSON is widespread and allows for easy debugging by humans. However, the very flexibility offered by the stack has, in significant ways, slowed down development. This is because, for each endpoint, developers need to decide:</p> \n<ul> \n <li>Which HTTP method to use</li> \n <li>Whether to expose parameters in the path or as query parameters</li> \n <li>How to structure the response</li> \n <li>How to name fields in JSON objects</li> \n <li>How to represent common data types, such as time stamps and durations</li> \n <li>How to represent error conditions</li> \n</ul> \n<p>Internal guidelines and recommendations have only helped so much — variations tend to creep in between teams and over time. Small inconsistencies between server and client implementations have caused outages (e.g. a client mistakenly made use of camelCase for field names but the server expected snake_case).</p> \n<p>The “artisanal” approach to HTTP API development and consumption can be frustrating: Even where guidelines are followed perfectly, an engineer still needs to forensically examine application code in order to get comprehensive information about how any given endpoint works.</p> \n<p>As a result of discussion in our weekly engineering forum, a subgroup of engineers decided to explore alternatives. The group honed in on <a href=\"https://blog.twitch.tv/en/2018/01/16/twirp-a-sweet-new-rpc-framework-for-go-5f2febbf35f/\">Twirp</a>.</p> \n<h2>Why Twirp?</h2> \n<p>Twitch engineering created the <a href=\"https://blog.twitch.tv/en/2018/01/16/twirp-a-sweet-new-rpc-framework-for-go-5f2febbf35f/\">Twirp</a> project, which is a Go-based server implementation of the Twirp <a href=\"https://twitchtv.github.io/twirp/docs/spec_v5.html\">wire protocol</a>:</p> \n<blockquote> \n <p>“The Twirp wire protocol is a simple RPC protocol based on HTTP and Protocol Buffers (proto). The protocol uses HTTP URLs to specify the RPC endpoints, and sends/receives proto messages as HTTP request/response bodies.”</p> \n</blockquote> \n<p>Engineers compose API contracts in the protobuf Interface Description Language (IDL). They then use those contracts to generate server stubs and clients using protobuf tooling. The generated code takes care of HTTP request/response parsing and serialization to either JSON or the binary protobuf format. All requests are simple HTTP POST. And the wire protocol itself is simple and well-thought-out (thank you, Twirp engineering).</p> \n<p>Twirp seemed like a great fit: It enabled us to start introducing IDLs to simplify microservice development in a way that incrementally “slotted into” a complex backend. We looked at gRPC but decided against it, and our reasons for this decision match very well with those stated in the original <a href=\"https://blog.twitch.tv/en/2018/01/16/twirp-a-sweet-new-rpc-framework-for-go-5f2febbf35f/\">Twirp blog post</a>). We already run some Go services, and Twirp has a Go implementation we could just drop in and use.</p> \n<p>However, more than 70 percent of microservices we deploy are based on Scala + Finagle…</p> \n<h2>Twinagle = Twirp + Finagle</h2> \n<p>Due to the simplicity of the Twirp protocol, we decided to implement it ourselves. And we are pleased to announce the release of <a href=\"https://soundcloud.github.io/twinagle/\">Twinagle</a>, our implementation of Twirp for Finagle.</p> \n<p>The project is split into two components, outlined below.</p> \n<ul> \n <li> <p>An SBT plugin that takes a protobuf interface and uses it to generate:</p> \n  <ul> \n   <li>a trait that defines the service’s interface</li> \n   <li>code that implements both the server-side and client-side of this interface. This includes (de)serialization of requests and response bodies, error handling, and transmitting data over the wire.</li> \n  </ul> </li> \n <li>A runtime library that implements the logic to route requests, performs (de)serialization of messages, and integrates with Finagle.</li> \n</ul> \n<p>For instructions and code examples, please see the <a href=\"https://soundcloud.github.io/twinagle/\">Twinagle project page</a>.</p> \n<h2>Migrating a Service</h2> \n<h3>About the Track Authorization Service</h3> \n<p>The first high-impact production service at SoundCloud to adopt Twinagle was our track authorization service. This service is responsible for deciding how users can access tracks on SoundCloud based on the user’s location, client application, and subscription status. Should they hear an ad? Should they be able to see the track exists in other countries? Every time the SoundCloud backend handles a track identifier, this service gets a request. Needless to say, this service receives a large number of requests.</p> \n<p>In addition, JSON response bodies for track lookups can be large: Up to 100 tracks may be requested at a time, and in practice, the average request is for 25 tracks. However, the structure of these responses is not complex; it consists of a long list of relatively simple objects.</p> \n<p>The track authorization service is only used by one client application, meaning we only needed to perform one client migration. A combination of systems-integration simplicity and handling of significant request load made this service a natural early candidate for conversion to Twinagle.</p> \n<h3>Code Conversion</h3> \n<p>First we implemented a new Twinagle-based endpoint in the authorization service. We defined messages in the protobuf file that are based on existing domain model classes found in the service’s codebase, and we implemented a thin layer to convert between both. In exchange for this small amount of extra boilerplate code, we were able to reuse the existing business logic code, untouched. As a result, we could limit potential bugs to serialization and deserialization code.</p> \n<p>Once we deployed the new endpoint, we brought the Twirp library and protobuf file into the client application. We took a similar approach to the client side as we did on the server, building in a thin (de)serialization layer that isolates the existing business logic.</p> \n<h3>Rollout</h3> \n<p>Then we had the option of using both the REST and Twirp versions of the endpoint from the client app. We redirected client traffic using a percentage-based rollout flag in two phases. In the first phase, we made duplicate requests and compared the results. This meant that with a rollout percentage of 1 percent, the client made a request to both the REST and Twirp endpoints 1 percent of the time and reported discrepancies in the responses, but returned only the REST endpoint’s response. We caught a few critical bugs this way. We then moved on to use the Twirp endpoint only — and to stop duplicating requests. We rolled out to 100 percent with no outages and no bugs on the first attempt as a result of this process.</p> \n<h3>Findings</h3> \n<p>The results of this migration were positive but produced some mild surprises. We expected a drop in response time, but we only saw marginal benefits in the 90th percentile, and no benefits in the 50th or 99th percentiles. This was likely because most of the response time comes from accessing the database, and not from request/response serialization and deserialization. Additionally, the variability of 90th percentile latency dropped significantly.</p> \n<p>We saw a huge drop in bandwidth between the two services; network usage decreased by more than 40 percent when using binary protobuf instead of JSON! We also discovered that many fields in the response were being ignored by the client application, and we were able to confidently clean things up in the new Twirp endpoint. Finally, we deleted all of the custom JSON serialization and deserialization code in both services, which is always a satisfying developer experience!</p> \n<h2>Conclusion</h2> \n<p>This initial service conversion confirmed our hopes for Twinagle: Protobuf contracts make services easier to understand, allow us to get rid of an entire class of low-value code, and even result in some nice efficiency benefits. We are actively converting old services to use Twinagle, and all new SoundCloud services are now Twinagle-based. To try it out for yourself, check out the <a href=\"https://soundcloud.github.io/twinagle/\">project page</a>.</p> \n<h2>Thank You</h2> \n<p>The implementation and rollout of Twinagle has been a great cross-team effort. Special thanks to:</p> \n<ul> \n <li>Bernd Louis</li> \n <li>Frank Calma</li> \n <li>Jorge Creixell</li> \n <li>Niko Dziemba</li> \n <li>Sean Treadway</li> \n</ul> \n<p>And extra special thanks to Twitch engineering, for Twirp!</p>","descriptionType":"html","publishedDate":"Fri, 12 Jun 2020 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"f30f973b66cca511a730812a404e609f","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569968},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud launches the HTML5 Audio Improvement Initiative","link":"https://developers.soundcloud.com/blog/soundcloud-launches-the-html5-audio-improvement-initiative","description":"<p>We at SoundCloud want to build the best sound player for the web, and we want to do that using the Open Web standards. While working on the native audio features on our mobile site and new widgets, or even as an experiment on the main site, we have discovered that the <a href=\"http://dev.w3.org/html5/spec/Overview.html#media-elements\">HTML5 Audio standard</a> is not equally well implemented across all modern browsers and some decisions can be made that would benefit the web audio users and web developers alike.&nbsp;Soundcloud launches the “<a href=\"http://areweplayingyet.org\" title=\"Are We Playing Yet\">Are We Playing Yet?</a>” project, which aims to raise the awareness about the state of HTML5 Audio implementations in the web browsers.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 379px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/45a70551b98044234e736cc9106dd3f7/4c799/are-we-playing-yet.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.35092348284961%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHThYYhh//EABgQAAIDAAAAAAAAAAAAAAAAAAIDABMg/9oACAEBAAEFAiWJyhWf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGRAAAQUAAAAAAAAAAAAAAAAAAAERICIy/9oACAEBAAY/ArI5iP8A/8QAGxAAAgEFAAAAAAAAAAAAAAAAAAEQESFBYaH/2gAIAQEAAT8htSaDU6JJGYR//9oADAMBAAIAAwAAABDAD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQACAQUBAAAAAAAAAAAAAAEAIREQMUFxkdH/2gAIAQEAAT8QRBCUytPssFVNr+oY4MWsAVpy7n//2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"are we playing yet\" title=\"are we playing yet\" src=\"https://developers.soundcloud.com/blog/static/45a70551b98044234e736cc9106dd3f7/4c799/are-we-playing-yet.jpg\" srcset=\"/blog/static/45a70551b98044234e736cc9106dd3f7/f544b/are-we-playing-yet.jpg 200w,\n/blog/static/45a70551b98044234e736cc9106dd3f7/4c799/are-we-playing-yet.jpg 379w\" sizes=\"(max-width: 379px) 100vw, 379px\" loading=\"lazy\" /> </a> </span></p> \n<p>We have decided to help the parties involved and collect the issues in one place, document them, provide the code and add interactive tests that will show the implementation progress. We understand how the software development works, and that a few iterations are needed until something is fully done. We hope&nbsp;”<a href=\"http://areweplayingyet.org\" title=\"Are We Playing Yet\">Are We Playing Yet?</a>” can function as a handy development and quality monitoring tool.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 379px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/ac26210c0063863e1b7e411ba9c2cd0c/4c799/areweplayingyet.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 69.65699208443272%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMCBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe21IsD/xAAZEAACAwEAAAAAAAAAAAAAAAAQIQABEUH/2gAIAQEAAQUCc0cpD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAQEBAQEAAAAAAAAAAAAAAAERADHh/9oACAEBAAE/IelZNL640i1Crjm//9oADAMBAAIAAwAAABCgz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EFn/xAAbEAEAAwEAAwAAAAAAAAAAAAABABEhMVFhkf/aAAgBAQABPxADYRdVdwsWhXohQ3zH6DHoA7hyOwnHdn//2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"areweplayingyet\" title=\"areweplayingyet\" src=\"https://developers.soundcloud.com/blog/static/ac26210c0063863e1b7e411ba9c2cd0c/4c799/areweplayingyet.jpg\" srcset=\"/blog/static/ac26210c0063863e1b7e411ba9c2cd0c/f544b/areweplayingyet.jpg 200w,\n/blog/static/ac26210c0063863e1b7e411ba9c2cd0c/4c799/areweplayingyet.jpg 379w\" sizes=\"(max-width: 379px) 100vw, 379px\" loading=\"lazy\" /> </a> </span></p> \n<p>“Are We Playing Yet?” was started by SoundCloud but it’s open to all companies and developers who care about the state of HTML5 audio and want to build applications based on this <a href=\"http://dev.w3.org/html5/spec/Overview.html#media-elements\">Web standard</a>. You can get the project source on <a href=\"https://github.com/soundcloud/areweplayingyet\" title=\"Are We Playing Yet repository\">GitHub</a>, contribute tests and fixes via the pull requests or <a href=\"https://github.com/soundcloud/areweplayingyet/issues\">Issue Tracker</a>,&nbsp;and connect to the people involved via <a href=\"https://twitter.com/areweplayingyet\" title=\"&quot;Are We Playing Yet?&quot; Twitter account\">@areweplayingyet</a> on&nbsp;Twitter.</p>","descriptionType":"html","publishedDate":"Wed, 09 Nov 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/45a70551b98044234e736cc9106dd3f7/4c799/are-we-playing-yet.jpg","linkMd5":"8287c953457e19277b175ad6423b25ad","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn9@2020_5/2020/08/25/00-49-37-749_1d21e8854f165b29.webp","destWidth":379,"destHeight":278,"sourceBytes":10104,"destBytes":12768,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/45a70551b98044234e736cc9106dd3f7/4c799/are-we-playing-yet.jpg":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn9@2020_5/2020/08/25/00-49-37-749_1d21e8854f165b29.webp","https://developers.soundcloud.com/blog/static/ac26210c0063863e1b7e411ba9c2cd0c/4c799/areweplayingyet.jpg":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn93@2020_2/2020/08/25/00-51-42-881_6897c1cc506a8b6c.webp"},"publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"How (Not) to Build Datasets and Consume Data at Your Company","link":"https://developers.soundcloud.com/blog/how-not-to-build-datasets-and-consume-data-at-your-company","description":"<p>The topic of datasets is not new, and they have been successfully used at SoundCloud for analytics purposes for a long time. In this blog post, however, we’ll delve into how the culture of building and providing datasets is being adopted in more areas of engineering beyond the domain of analytics.</p> \n<p>When we talk about datasets, we’re talking about <strong>published datasets</strong>. In this case, a team owning the data in question would also own the published dataset and be responsible for delivering it in a particular shape, as agreed upon with the internal consumers, i.e. the end users of the dataset. As a result, the dataset <strong>encapsulates any domain intricacies</strong> that should not leak into the consumer’s domain.</p> \n<p>This post shares our experience of adopting “<a href=\"https://developers.soundcloud.com/blog/a-better-model-of-data-ownership\">A Better Model of Data Ownership</a>,” which we blogged about more than two years ago. It discusses our learnings and digs deeper into the specifics and technical details.</p> \n<p>In particular, we’ll focus on exploring three questions:</p> \n<ol> \n <li>How <strong>not</strong> to consume data</li> \n <li>How to consume data and who should provide it</li> \n <li>How to build datasets and what to consider before you start</li> \n</ol> \n<p>The process of data management in a data privacy-compliant organization is beyond the scope of this blog post. Whenever the access to or use of personally identifiable information is not justified by the business case, further treatment of data is required, but this is not discussed here.</p> \n<h2>Examples of Datasets at SoundCloud</h2> \n<p>Before going any further, here are a couple of examples of datasets we will refer to in the following sections. We deal with artists, tracks, and plays here at SoundCloud, so we’ll draw examples from that domain</p> \n<p><strong>Track Metadata Dataset</strong> <em>(holds information about a given track)</em></p> \n<table> \n <thead> \n  <tr> \n   <th align=\"left\"><code class=\"language-text\">track_id</code></th> \n   <th align=\"left\"><code class=\"language-text\">title</code></th> \n   <th align=\"left\"><code class=\"language-text\">artist</code></th> \n   <th align=\"left\"><code class=\"language-text\">valid_from</code></th> \n   <th align=\"left\"><code class=\"language-text\">valid_to</code></th> \n   <th align=\"left\"><code class=\"language-text\">is_current</code></th> \n  </tr> \n </thead> \n <tbody> \n  <tr> \n   <td align=\"left\">1</td> \n   <td align=\"left\">Longer, Better, Stronger Passwords</td> \n   <td align=\"left\">Adept Surfer</td> \n   <td align=\"left\">2019-02-05</td> \n   <td align=\"left\">2060-01-01</td> \n   <td align=\"left\"><code class=\"language-text\">true</code></td> \n  </tr> \n  <tr> \n   <td align=\"left\">2</td> \n   <td align=\"left\">Think Before You Click</td> \n   <td align=\"left\">Cautious Mouse</td> \n   <td align=\"left\">2019-02-05</td> \n   <td align=\"left\">2019-05-01</td> \n   <td align=\"left\"><code class=\"language-text\">false</code></td> \n  </tr> \n  <tr> \n   <td align=\"left\">2</td> \n   <td align=\"left\">Think Before You Click (On My Heart)</td> \n   <td align=\"left\">Cautious Mouse</td> \n   <td align=\"left\">2019-05-01</td> \n   <td align=\"left\">2060-01-01</td> \n   <td align=\"left\"><code class=\"language-text\">true</code></td> \n  </tr> \n </tbody> \n</table> \n<p><strong>Track Rightsholders Dataset</strong> <em>(records the label or individual who owns rights to a track in a given territory)</em></p> \n<table> \n <thead> \n  <tr> \n   <th align=\"left\"><code class=\"language-text\">track_id</code></th> \n   <th align=\"left\"><code class=\"language-text\">territory</code></th> \n   <th align=\"left\"><code class=\"language-text\">rightsholder_id</code></th> \n   <th align=\"left\"><code class=\"language-text\">valid_from</code></th> \n   <th align=\"left\"><code class=\"language-text\">valid_to</code></th> \n   <th align=\"left\"><code class=\"language-text\">is_current</code></th> \n  </tr> \n </thead> \n <tbody> \n  <tr> \n   <td align=\"left\">1</td> \n   <td align=\"left\">DE</td> \n   <td align=\"left\">182</td> \n   <td align=\"left\">2019-02-05</td> \n   <td align=\"left\">2060-01-01</td> \n   <td align=\"left\"><code class=\"language-text\">true</code></td> \n  </tr> \n  <tr> \n   <td align=\"left\">1</td> \n   <td align=\"left\">FR</td> \n   <td align=\"left\">182</td> \n   <td align=\"left\">2019-02-05</td> \n   <td align=\"left\">2060-01-01</td> \n   <td align=\"left\"><code class=\"language-text\">true</code></td> \n  </tr> \n  <tr> \n   <td align=\"left\">2</td> \n   <td align=\"left\">DE</td> \n   <td align=\"left\">42</td> \n   <td align=\"left\">2019-02-05</td> \n   <td align=\"left\">2060-01-01</td> \n   <td align=\"left\"><code class=\"language-text\">true</code></td> \n  </tr> \n </tbody> \n</table> \n<p>The particular representation shown above is called a <strong>slowly changing dimension table</strong>, since it captures the historical changes of an entity, e.g. a track, over time. For many datasets, SoundCloud has settled on the following shape:</p> \n<ul> \n <li><strong>Primary keys</strong> — one or more columns that uniquely identify an entity (e.g, <code class=\"language-text\">track_id</code>, <code class=\"language-text\">territory</code>). However, there may be multiple entries for the same entity as it changes over time.</li> \n <li><code class=\"language-text\">valid_from</code>: <code class=\"language-text\">datetime</code> — the start of the validity period for the given row (technically also part of the primary key)</li> \n <li><code class=\"language-text\">valid_to</code>: <code class=\"language-text\">datetime</code> — the end of the validity period for the given row (or a time in the far future)</li> \n <li><code class=\"language-text\">is_current</code>: <code class=\"language-text\">boolean</code> — <code class=\"language-text\">true</code> if the given row is the valid one at the time of dataset creation, and <code class=\"language-text\">false</code> otherwise.</li> \n</ul> \n<p>The dataset may or may not contain gaps in the time dimension for a single entity. This depends on whether or not it makes sense in the domain.</p> \n<p>One word on representing entities that have been deleted: Deleted records appear as rows, with the latest <code class=\"language-text\">valid_to</code> in the past and <code class=\"language-text\">is_current = false</code>. In that sense, these rows look similar to old versions of an entity with no <code class=\"language-text\">is_current</code> row. This makes it harder to retrieve all entities, regardless of whether or not they have been deleted. If retrieval of deleted entries is required, it should also be possible to introduce an <code class=\"language-text\">is_deleted</code> column in the dataset.</p> \n<p>Naturally, not all datasets need to have or can have a time dimension. A plays dataset is an example of a simple <code class=\"language-text\">fact</code> table:</p> \n<p><strong>Plays Dataset</strong></p> \n<table> \n <thead> \n  <tr> \n   <th align=\"left\"><code class=\"language-text\">timestamp</code></th> \n   <th align=\"left\"><code class=\"language-text\">listener_id</code></th> \n   <th align=\"left\"><code class=\"language-text\">track_id</code></th> \n   <th align=\"left\"><code class=\"language-text\">territory</code></th> \n  </tr> \n </thead> \n <tbody> \n  <tr> \n   <td align=\"left\">2019-02-15 11:20:00 UTC</td> \n   <td align=\"left\">1349</td> \n   <td align=\"left\">1</td> \n   <td align=\"left\">DE</td> \n  </tr> \n  <tr> \n   <td align=\"left\">2019-02-15 11:30:00 UTC</td> \n   <td align=\"left\">1349</td> \n   <td align=\"left\">1</td> \n   <td align=\"left\">DE</td> \n  </tr> \n  <tr> \n   <td align=\"left\">2019-02-15 12:05:00 UTC</td> \n   <td align=\"left\">1066</td> \n   <td align=\"left\">2</td> \n   <td align=\"left\">FR</td> \n  </tr> \n </tbody> \n</table> \n<p>Now that we’ve seen what the datasets actually look like, we will now consider all the various ways in which the company exchanged and consumed data before adopting the idea of published datasets.</p> \n<h2>How Not to Consume Data</h2> \n<p>The shift toward using datasets at SoundCloud arrived together with the shift toward batch-oriented processing where it makes sense. This means replacing online services with batch jobs for tasks such as: royalties calculation, report generation for labels and artists, processing content delivered by labels, some aspects of search and recommender systems, etc. All of these examples rely on data owned by other teams in the company, which brings up questions of contracts, SLAs, domain encapsulation, and team interdependency.</p> \n<h3>Data Consumption: A Story of One Team</h3> \n<p>This post will now highlight the experience of the Royalties &amp; Reporting team here at SoundCloud, a team that has always been a heavy consumer of data and has undergone a shift toward the use of published datasets. The responsibilities of the team include calculating royalties and building reports for artists and labels.</p> \n<p>An example of a report is a CSV file that shows the breakdown of tracks, track metadata, play counts, and associated royalty earnings. In relational database terms, you could think of it as a join between a plays table, a track metadata table, a track rightsholder table, and a royalties table. Usually, these reports are generated on a schedule (as opposed to on demand), so they fit the batch-processing model quite well.</p> \n<p>With reference to the following figure, consider the various ways in which these reporting jobs used to consume data in the past. We will discuss the pros and cons of consuming events, snapshotting databases, and consuming live service APIs, all of which we have tried but eventually moved away from.</p> \n<p><img src=\"https://developers.soundcloud.com/blog/148913331dae75abf2c0bfba78673908/undesirable_scenarios.svg\" alt=\"Undesirable Scenarios\" /></p> \n<h3>Consuming Events</h3> \n<p>Events are great. They are a solid approach for storing the changes of state of a system without imposing a way of how such events should later be consumed or interpreted. Many SoundCloud systems already publish events.</p> \n<p>Events can be consumed in batch jobs directly, and were, in fact, the principle way of consuming data in our reporting jobs until very recently. But this approach carries with it a handful of tradeoffs, which are outlined below.</p> \n<h4>Pros</h4> \n<ul> \n <li><strong>Flexibility:</strong> Events allow for ultimate flexibility, as they capture the most amount of detail and the entire history. This can also be a bad thing, as the details may expose domain complexity.</li> \n <li><strong>Excellent time resolution:</strong> Each event is timestamped.</li> \n <li><strong>Auditing:</strong> Investigating and debugging historical changes is free, and nothing is ever deleted. As such, it is possible to recreate system state at any point in time.</li> \n</ul> \n<h4>Cons</h4> \n<ul> \n <li><strong>Expensive infrastructure:</strong> Each service must support event infrastructure, and this cost is not justified for all uses.</li> \n <li><strong>Difficult to consume:</strong> Consumers must read all events from the beginning of time. It is impossible to get the current state without reading everything. This does not scale well.</li> \n <li><strong>Heavyweight:</strong> At SoundCloud, events are encoded as <a href=\"https://developers.google.com/protocol-buffers\">Google Protobuf</a> messages and stored in Hadoop Sequence Files. This makes them opaque, with no ability to selectively consume individual fields without decoding complete events. This limitation is implementation-specific.</li> \n <li><strong>Exposes domain complexity:</strong> Events tend to include all of the information available for interpretation later on. This interpretation is better handled by the data owner than by every consumer.</li> \n <li><strong>Potentially lower quality data:</strong> This occurs in cases where the data owner does not consume their own events and instead relies on their databases and APIs. The same may be true of datasets.</li> \n</ul> \n<p>Events seemed very promising at first. However, as time went on, we realized they were difficult to work with and the jobs did not scale well after a year or two. The limited ad hoc querying abilities and increasingly slow jobs made development and operations frustrating and costly.</p> \n<h3>Snapshotting Databases</h3> \n<p>We did this. We performed full dumps of the database table backing the live service we don’t own.</p> \n<h4>Pros</h4> \n<ul> \n <li><strong>Accurate:</strong> The data owner and data consumer consume the same data.</li> \n <li><strong>Easy to consume:</strong> Structured data that can be consumed cheaply and easily.</li> \n <li><strong>Easy to develop with:</strong> Can be queried in an ad hoc manner for development and debugging purposes.</li> \n</ul> \n<h4>Cons</h4> \n<ul> \n <li><strong>Bad coupling:</strong> The database model becomes an implicit contract and the consumer needs to be consulted regarding any changes.</li> \n <li><strong>No SLA:</strong> No explicit contract with the data owner around the quality and availability of data.</li> \n <li><strong>Bad domain encapsulation:</strong> This exposes internal domain complexity that may be misinterpreted by the consumer. It bypasses any domain processing that happens in the service.</li> \n <li><strong>No time dimension:</strong> There is no visibility of changes of data over time or deleted entities.</li> \n</ul> \n<p>It’s quite clear how snapshotting databases breaks many principles of encapsulation. Additionally, we were spending a lot of time building and maintaining all the datasets we needed ourselves. They were not the responsibility of the data owner, and they were not available to other consumers.</p> \n<p>To be clear, snapshotting is a viable option for cheaply and easily building datasets. However, it’s a completely different story when the data owner, and not the consumer, is doing it with full knowledge and understanding of their databases.</p> \n<h3>Consuming Live Services through APIs</h3> \n<p>Yes, we did this too. We would make API calls to a live service from inside a batch job.</p> \n<h4>Pros</h4> \n<ul> \n <li><strong>Accuracy:</strong> This was the most accurate and up-to-date data.</li> \n</ul> \n<h4>Cons</h4> \n<ul> \n <li><strong>Bad fit for batch-processing paradigm:</strong> Depending on the API design, it would not normally be possible to work with the data in bulk with all the flexibility you’d expect.</li> \n <li><strong>Poor performance:</strong> It does not scale well and has the possibility of introducing unnecessary strain on the consumed API and its database.</li> \n <li><strong>Hard to develop against:</strong> Ad hoc querying is easy, but it may not be possible to do in bulk.</li> \n <li><strong>No time dimension:</strong> There is no visibility of changes of data over time or deleted entities unless the service keeps all the history.</li> \n</ul> \n<h2>Enter Published Datasets</h2> \n<p><img src=\"https://developers.soundcloud.com/blog/e501cbf007aa4075fe8a7c6272b932a5/good_scenarios.svg\" alt=\"Good Scenarios\" /></p> \n<p>Published datasets combine some of the positive aspects of the above approaches, but they practically eliminate all the negative ones. To reiterate, <em>published datasets are produced by the data owner following an agreement with the consumer or consumers</em>. We’ll discuss the pros and cons of these below.</p> \n<h4>Pros</h4> \n<ul> \n <li><strong>Domain encapsulation:</strong> The dataset producer can preprocess the data to hide domain complexities.</li> \n <li><strong>Contract and SLA:</strong> Follows a well-defined contract between the producer and the consumer of what the shape, correctness, and availability should be.</li> \n <li><strong>May be easy to build:</strong> Internally built tooling can help build datasets for many use cases with low effort.</li> \n <li><strong>Easy to consume:</strong> Structured data that can be cheaply and easily consumed.</li> \n <li><strong>Easy to develop with:</strong> Can be queried in an ad hoc manner for development and debugging purposes.</li> \n <li><strong>Clear ownership:</strong> The producer assumes the responsibility for maintaining the dataset and fixing issues.</li> \n <li><strong>Decoupling:</strong> The producer is free to evolve the schema of their databases and events, so long as they maintain the dataset interface the same, when it makes sense.</li> \n</ul> \n<h4>Cons</h4> \n<ul> \n <li><strong>Potentially lower quality data:</strong> The producer doesn’t usually consume their own datasets — data problems are still possible.</li> \n <li><strong>Takes effort to build:</strong> Datasets go beyond what can be built using standard tooling (more on that in the next section), and they may still take effort to build. In the cases where a need for a dataset is blocking the consumer but the producer has other competing priorities, the consumer may take on the responsibility of building the dataset for the producer to own and maintain.</li> \n</ul> \n<h2>How We Build Datasets</h2> \n<p>There are two primary ways in which we build our datasets: <strong>from events</strong>, and <strong>from database snapshots</strong>. As discussed in the previous section, we have experience consuming both events and snapshots in our batch jobs. What we wanted to do differently was to (a) establish a coherent way of building these datasets, (b) create standard tooling to cover the most common cases, and (c) make it the responsibility of the data owner to provide a dataset that was clean, consistent, and timely.</p> \n<p>The two methods of building datasets (from events and from snapshots) are not as dissimilar as they may seem. In fact, they share many of the same steps, which becomes apparent when looking at the figure below. Most datasets we produce at SoundCloud take the shape of dimension tables, and they capture the historical changes of an entity over time, as shown in the introduction section. We will assume we’re building such a dataset in the discussion below.</p> \n<p><img src=\"https://developers.soundcloud.com/blog/2bf414b0fa6ca0acc8e9a247935e0c3d/building_datasets.svg\" alt=\"Building Datasets\" /></p> \n<h3>Building a Dataset from Events</h3> \n<p>In case of events, the workflow is a single step, outlined below.</p> \n<ol> \n <li><strong>Roll up events on top of the previous dataset:</strong> This step reads the previous version of the published dataset, as well as the events emitted since the last dataset was published. It applies the new events on top of the old dataset, performing any necessary transformations, and writes a new dataset. This is a <strong>release candidate for the published dataset</strong>.</li> \n</ol> \n<p><strong>Note:</strong> If you have a very small number of events, you may choose to roll them up from the beginning of time every time you produce the dataset. This gives you the most flexibility and ensures the most recent code is used for rollup.</p> \n<h3>Building a Dataset from Database Snapshots</h3> \n<p>The workflow to produce a release candidate is covered below.</p> \n<ol> \n <li><strong>Dump a table to a snapshot:</strong> The tool reads from the database and writes this snapshot to a temporary table. This is a direct copy of the table, with no further processing. This is not the published dataset.</li> \n <li><strong>Transform the snapshot (optional):</strong> This is where you’d implement steps such as filtering/removing or renaming columns, or transforming values in the dataset. This is also not the published dataset.</li> \n <li><strong>Roll up snapshot on top of the previous dataset (optional):</strong> This step reads the transformed snapshot and the previous version of the published dataset and writes a new dataset. This step is required when building <em>slowly changing dimension tables</em> or when the entities deleted from the database must be preserved in the dataset. This is a release candidate for the published dataset.</li> \n</ol> \n<p>This multistep procedure allows you to decouple your published dataset from the source table. In the past, we’ve had problems caused by coupling schemas in the database with schemas in the data warehouse, because changing the source becomes impossible without coordinating changes far downstream.</p> \n<p>Whether the dataset is produced from snapshots or from events, the shape of the release candidate is the same, so the validation and publishing/promoting steps are the same.</p> \n<ol> \n <li><strong>Validate dataset:</strong> This is a <strong>very important step</strong> that’s often overlooked. Testing the <strong>code</strong>, e.g. through unit testing, lets us gain confidence in the <strong>logic</strong> of the various steps in dataset production. However, it is usually done using a contrived set of toy data. But when dealing with large amounts of data and moving parts, it is important to also test the data that is actually produced:</li> \n <li>Does it contain the expected values in each field?</li> \n <li>Does it satisfy the dimension table rules (see the Examples of Datasets at SoundCloud section above)?</li> \n <li>Is the dataset a truthful representation of the upstream data? Even a simple comparison of the number of rows in the input and the output can go a long way.</li> \n <li><strong>Publish dataset:</strong> Usually the dataset is published to the “latest location” (thereby overwriting the previous version), as well as to a location corresponding to the time of publishing (for safekeeping).</li> \n</ol> \n<p>At SoundCloud, we have standard tooling for building datasets from snapshots of MySQL databases. This greatly simplifies the creation of new datasets, and as a side effect, it promotes a consistent and common shape of datasets.</p> \n<h2>Considerations for Building a Dataset</h2> \n<p>Now that we’ve looked at the two ways of building a dataset, let’s look at the considerations that the dataset producer and consumers need to agree on that would inform the approach taken.</p> \n<ul> \n <li>Do you need to record the <strong>previous versions</strong> of an entity?</li> \n <li>Do you need information about <strong>deleted entities</strong>?</li> \n <li>Can entities be <strong>deleted and reinstated</strong>? How would you like to handle <strong>gaps</strong>?</li> \n <li>How often do you need the dataset updated with the newest data?</li> \n <li>Is there a specific time by which an updated version of the dataset needs to be available?</li> \n <li> <p>For a dataset with a time dimension, what is the <strong>time resolution</strong> required? Hourly, every six hours, daily? Highest precision possible?</p> \n  <ul> \n   <li>Generally, the datasets based on snapshots suffer from the loss of precision.</li> \n   <li>In some cases, it may be possible to keep the complete history of changes with exact timestamps in the database, though it makes the service more complex.</li> \n   <li>Events can provide high time accuracy, though there may still be a time difference between the event timestamp and the time that the change became effective in the other systems.</li> \n  </ul> </li> \n <li>For a dataset with a time dimension, how far back is the <strong>historical information</strong> required? Where do you get this historical data from (e.g. from events, from a different dataset, or inferred from the current value)?</li> \n</ul> \n<p>Finally, for some datasets, it may be important to distinguish between two types of changes to an entity:</p> \n<ul> \n <li>It may be a <strong>retrospective fix</strong> or a <strong>correction</strong>, in which case the change should be considered effective <strong>before</strong> it is made in the service/database; or</li> \n <li>It may be a real brand-new change, effective from the time the change is made.</li> \n</ul> \n<h2>Conclusion</h2> \n<p>As more datasets were built at SoundCloud, common patterns led to standard semantics and standard tooling for the most common cases. Even in those cases where standard tooling did not apply, there was already an established pattern for what the dataset could look like and how it could be published.</p> \n<p>For heavy consumers of datasets, that also meant that the burden of building and maintaining the datasets was now shared with those who knew most about the data, albeit not always those who had the most experience with building the datasets. But even that was changing quickly. The additional effort and the initial learning curve on the part of data owners led to the organization-wide benefits of shared, well-specified, and well-maintained datasets.</p>","descriptionType":"html","publishedDate":"Tue, 03 Mar 2020 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/148913331dae75abf2c0bfba78673908/undesirable_scenarios.svg","linkMd5":"7e1fac7ae2cbdcaac924e69f75c25d60","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn82@2020_3/2020/08/25/00-49-39-104_58edae415fb70534.svg","destWidth":0,"destHeight":0,"sourceBytes":92460,"destBytes":92460,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/148913331dae75abf2c0bfba78673908/undesirable_scenarios.svg":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn82@2020_3/2020/08/25/00-49-39-104_58edae415fb70534.svg","https://developers.soundcloud.com/blog/e501cbf007aa4075fe8a7c6272b932a5/good_scenarios.svg":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn32@2020_3/2020/08/25/00-51-40-781_f489ef083ff53143.svg","https://developers.soundcloud.com/blog/2bf414b0fa6ca0acc8e9a247935e0c3d/building_datasets.svg":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn15@2020_3/2020/08/25/00-51-42-602_e79853673ec48372.svg"},"publishedOrCreatedDate":1598316569970},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Building the new SoundCloud iOS application — Part I: The reactive paradigm","link":"https://developers.soundcloud.com/blog/building-the-new-ios-app-a-new-paradigm","description":"<p>Recently, SoundCloud launched the new iOS application which was a complete rewrite of the existing iOS application. The Mobile engineering team saw this as an opportunity to build a solid foundation for the future of SoundCloud on iOS and to experiment with new technologies and processes at the same time.</p> \n<p>In the world of mobile, you deal with data, errors, threads and concurrency a lot. The common scenario starts with a user tapping on the screen. The application jumps off of the main UI thread, does some I/O related work, some database-related operations along with some transformations to the data. The application then jumps back to the UI thread to render some new information onto the screen.</p> \n<p>Both the Android and iOS platforms provide some tools to deal with the different aspects of this scenario yet they are far from ideal. Some of them do not provide much in terms of error handling, which forces you to write boiler-plate code while some of them force you to deal with low-level concurrency primitives. You might have to add some additional libraries to your project so that you do not have to write filtering and sorting predicate code.</p> \n<p>We knew early on we wanted to avoid these issues and thus came into the picture the functional reactive paradigm and <a href=\"https://github.com/ReactiveCocoa/ReactiveCocoa\">Reactive Cocoa</a>.</p> \n<p>In short, <a href=\"https://github.com/ReactiveCocoa/ReactiveCocoa\">Reactive Cocoa</a> allows you to create composable, event-driven (finite or infinite) streams of data while making use of functional composition to perform transformations on those streams. <a href=\"http://en.wikipedia.org/wiki/Erik_Meijer_(computer_scientist)\">Erik Meijer</a> is best known in this space with his Reactive Extensions on the .NET platform which also spawned the JVM based implementation <a href=\"https://github.com/Netflix/RxJava\">RxJava</a>. By adopting this paradigm, we now have a uniform way of dealing with data models and operators that can apply transformations on those data models while taking care of low level concurrency primitives so that one does not have to be concerned about threads or the difficult task of concurrent programming.</p> \n<p><strong>Let’s take an example</strong></p> \n<p>Like most mobile applications, the SoundCloud iOS application is a typical case of an API client with local storage. It fetches JSON data from the API via HTTP and parses it into API model objects. The persistent store technology we use is Core Data. We decided early on that we wanted to isolate the API from our storage representation so there is a final mapping step involved where we convert API models to Core Data models.</p> \n<p>We break this down into smaller units of work: we have</p> \n<ol> \n <li>Execute a network request. Parse the JSON response.</li> \n <li>Transform JSON objects into API model objects.</li> \n <li>Transform API model objects into Core Data models.</li> \n</ol> \n<p><strong>1. Executing the network request</strong></p> \n<p>For simplicity, assume that the network-access layer implements the following method:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>RACSignal <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>executeRequest<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span>NSURL <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>url<span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>We do not pass in any delegates or callback blocks, we just give it an <code class=\"language-text\">NSURL</code> and get back a <code class=\"language-text\">RACSignal</code> representing a possible asynchronous operation, or <a href=\"http://en.wikipedia.org/wiki/Futures_and_promises\">future</a>. To obtain the data from that operation, we can <em>subscribe</em> to the signal using <a href=\"http://cocoadocs.org/docsets/ReactiveCocoa/2.3.1/Classes/RACSignal.html#//api/name/subscribeNext:error:completed:\">subscribeNext:error:completed:</a></p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>RACDisposable <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>subscribeNext<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">^</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>id result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>nextBlock\n                           error<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">^</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>NSError <span class=\"token operator\">*</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>errorBlock\n                       completed<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">^</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>completedBlock</code></pre>\n</div> \n<p>You might recognize the familiar-looking error and success-callback blocks from other asynchronous APIs. This is where some of Reactive Cocoa’s and FRP’s strengths lie as we shall see later.</p> \n<p><strong>2. Parsing the JSON response</strong></p> \n<p>After the network request has been made, the JSON response needs to be parsed into an API model representation. For this we use a thin layer around Github’s <a href=\"https://github.com/Mantle/Mantle\">Mantle</a> library, which wraps parsing in a <code class=\"language-text\">RACSignal</code> and pushes the result (or error) to the subscriber:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>RACSignal <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>parseResponse<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>data\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>RACSignal createSignal<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">&lt;</span>RACSubscriber<span class=\"token operator\">&gt;</span> subscriber<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    NSError <span class=\"token operator\">*</span>error <span class=\"token operator\">=</span> nil<span class=\"token punctuation\">;</span>\n    id apiModel <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>MTLJSONAdapter modelOfClass<span class=\"token punctuation\">:</span>ApiTrack<span class=\"token punctuation\">.</span>class\n                            fromJSONDictionary<span class=\"token punctuation\">:</span>data\n                                         error<span class=\"token punctuation\">:</span><span class=\"token operator\">&amp;</span>error<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">[</span>subscriber sendError<span class=\"token punctuation\">:</span>error<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">[</span>subscriber sendNext<span class=\"token punctuation\">:</span>apiModel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">[</span>subscriber sendCompleted<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>To achieve the composition of operations that we have mentioned earlier, we wrapped the functionality of existing libraries with signals, where appropriate.</p> \n<p><strong>3. Persisting the API model with Core Data</strong></p> \n<p>In our architecture, the database represents the single source of truth. Therefore to show tracks to the user we first need to store them as Core Data objects. We have a collection of adapter classes that are responsible for mapping API model objects to Core Data model objects. An <code class=\"language-text\">ApiTrackAdapter</code> might look as follows:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>RACSignal <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>adaptObject<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span>ApiTrack <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>apiTrack\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token keyword\">self</span> findOrBuildTrackWithUrn<span class=\"token punctuation\">:</span>apiTrack<span class=\"token punctuation\">.</span>urn<span class=\"token punctuation\">]</span>\n                           map<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>CoreDataTrack <span class=\"token operator\">*</span>coreDataTrack<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      coreDataTrack<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> apiTrack<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// set other properties</span>\n      <span class=\"token keyword\">return</span> coreDataTrack<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p><strong>Putting it all together</strong></p> \n<p>We now have the building blocks to issue a network request, parse the JSON, and store it as a Core Data object. RAC makes it very easy to compose the individual methods functionally by feeding the output of each operation as an input to the next one. The following example uses <a href=\"http://cocoadocs.org/docsets/ReactiveCocoa/2.3.1/Classes/RACStream.html#//api/name/flattenMap:\">flattenMap:</a></p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>RACSignal <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>loadAndStoreTrack<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span>NSURL <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>url\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>requestHandler executeRequest<span class=\"token punctuation\">:</span>url<span class=\"token punctuation\">]</span> flattenMap<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>id json<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>parser parseResponse<span class=\"token punctuation\">:</span>json<span class=\"token punctuation\">]</span> flattenMap<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>ApiTrack <span class=\"token operator\">*</span>track<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>adapter adaptObject<span class=\"token punctuation\">:</span>track<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>The <code class=\"language-text\">flattenMap:</code> method maps or transforms values emitted by a signal and produces a new signal as a result. In this example, the newly created signal returned by <code class=\"language-text\">loadAndStoreTrack:</code> would either return the adapted Core Data track object <em>or</em> error if any of the operations failed. In addition to <code class=\"language-text\">flattenMap:</code>, there is a whole range of predefined functional operators like <code class=\"language-text\">filter:</code>or <code class=\"language-text\">reduce:</code> that can be applied to signals.</p> \n<p><strong>RAC Schedulers</strong></p> \n<p>We left out one powerful feature of RAC which is the ability to parametrize concurrency. To ensure that the application stays responsive, we want to perform the network I/O and model parsing in a background queue.</p> \n<p>Core Data operations are different, we do not have a choice there. They have to be executed on a predefined private queue, otherwise we risk creating deadlocks in our application.</p> \n<p>With the help of <a href=\"http://cocoadocs.org/docsets/ReactiveCocoa/2.3.1/Classes/RACScheduler.html\">RACScheduler</a> we can easily control where the side-effects of a signal are performed by simply calling <a href=\"http://cocoadocs.org/docsets/ReactiveCocoa/2.3.1/Classes/RACSignal.html#//api/name/subscribeOn:\">subscribeOn:</a> on it with a custom scheduler implementation:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>RACSignal <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>loadAndStoreTrack<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span>NSURL <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>url\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>requestHandler executeRequest<span class=\"token punctuation\">:</span>url<span class=\"token punctuation\">]</span> flattenMap<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>id json<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>parser parseResponse<span class=\"token punctuation\">:</span>json<span class=\"token punctuation\">]</span> flattenMap<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>ApiTrack <span class=\"token operator\">*</span>track<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>adapter adaptObject<span class=\"token punctuation\">:</span>track<span class=\"token punctuation\">]</span>\n                       subscribeOn<span class=\"token punctuation\">:</span>CoreDataScheduler<span class=\"token punctuation\">.</span>instance<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>Here, we use a scheduler that is aware of the current Core Data context to ensure that <code class=\"language-text\">adaptObject:</code> is executed on the right queue by wrapping everything internally with <a href=\"https://developer.apple.com/library/ios/documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html#//apple_ref/occ/instm/NSManagedObjectContext/performBlock:\">performBlock:</a>.</p> \n<p>If we want to update our UI with the title of the track we just fetched, we could do something like the following:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>trackService loadAndStoreTrack<span class=\"token punctuation\">:</span>trackUrl<span class=\"token punctuation\">]</span> subscribeNext<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>Track <span class=\"token operator\">*</span>track<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>trackView<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> track<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> error<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>NSError <span class=\"token operator\">*</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// handle errors</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>To ensure that this final update happens on the UI thread we can tell RAC to deliver us the information back on the main thread by using the <a href=\"http://cocoadocs.org/docsets/ReactiveCocoa/2.3.1/Classes/RACSignal.html#//api/name/deliverOn:\">deliverOn:</a> method:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>trackService loadAndStoreTrack<span class=\"token punctuation\">:</span>trackUrl<span class=\"token punctuation\">]</span>\n      deliverOn<span class=\"token punctuation\">:</span>RACScheduler<span class=\"token punctuation\">.</span>mainThreadScheduler<span class=\"token punctuation\">]</span>\n  subscribeNext<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>Track <span class=\"token operator\">*</span>track<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>trackView<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> track<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> error<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>NSError <span class=\"token operator\">*</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// handle errors</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>By breaking down each operation within this common scenario into isolated units of work, it becomes easier to perform the operations we need on the desired threads by taking advantage of Reactive Cocoa’s scheduling abilities. The functional reactive paradigm has also helped us to compose these independent operations one after another by using operators such as <code class=\"language-text\">flattenMap</code>. Although adopting FRP and ReactiveCocoa has had its difficulties, we have learned many lessons along the way.</p> \n<p><strong>Steep learning curve</strong></p> \n<p>Adopting FRP requires a change of perspective, especially for developers who are not used to a functional programming style. Methods do not return values directly, they return intermediate objects (signals) that take callbacks. This can lead to more verbose code, especially when the code is heavily nested which is common when doing more complex things with RAC.</p> \n<p>Therefore, it is important to have short and well-named methods, for example a method signature like <code class=\"language-text\">-(RACSignal *)signal</code> does not communicate anything about the type of values the caller is going to receive.</p> \n<p>Another problem is the sheer number of methods or operators defined on a base classes like <code class=\"language-text\">RACStream</code> / <code class=\"language-text\">RACSignal</code>. In practice only a few (like <code class=\"language-text\">flattenMap:</code> or <code class=\"language-text\">filter:</code>) are used on a regular basis, but the remaining 80% tend to confuse developers who are new to the framework.</p> \n<p><strong>Memory management</strong></p> \n<p>Memory management can be problematic because of RAC’s heavy use of blocks which can easily lead to retain cycles. They can be avoided by breaking the cycle with weak references to <code class=\"language-text\">self</code> (<code class=\"language-text\">@weakify</code> / <code class=\"language-text\">@strongify</code> macros).</p> \n<p>One of RAC’s promises is to reduce the amount of state you need to keep around in your code. This is true but you still need to manage the state introduced by the framework itself, which comes in the form of <a href=\"http://cocoadocs.org/docsets/ReactiveCocoa/2.3.1/Classes/RACDisposable.html\">RACDisposable</a>, an object returned as a result of signal subscription. A common pattern we introduced is to bind the lifetime of the subscription to the lifetime of the object with <a href=\"http://cocoadocs.org/docsets/ReactiveCocoa/2.3.1/Classes/RACDisposable.html#//api/name/asScopedDisposable\">asScopedDisposable</a>:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>disposable <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>signal subscribeNext<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">{</span> <span class=\"token comment\">/* stuff */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span> asScopedDisposable<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p><strong>Overdoing it</strong></p> \n<p>It is easy to fall into the trap of trying to apply FRP to every single problem one encounters (also known as the golden hammer syndrome), thereby unnecessarily complicating the code. Defining clear boundaries and rules between the reactive and non-reactive parts of the code base is important to minimize verbosity and to use the power of FRP And Reactive Cocoa where appropriate.</p> \n<p><strong>Performance</strong></p> \n<p>There are inherent performance problems within RAC. For example, a simple imperative <code class=\"language-text\">for</code> loop is guaranteed to execute much faster than <code class=\"language-text\">flattenMap:</code> which introduces a lot of internal method dispatching, object allocation, and state handling.</p> \n<p>In most cases this overhead is not noticeable, especially when I/O latency is involved, as in the preceding examples.</p> \n<p>However in situations where performance really matters, such as fast UI rendering, it makes sense to avoid RAC completely.</p> \n<p><strong>Debugging</strong></p> \n<p>We found this to be a non-issue if your application components are well designed and individually tested. Backtraces tend to get longer but this can be alleviated with some extra tooling like custom LLDB filters. A healthy amount of debug logging across critical components also does not hurt.</p> \n<p><strong>Testing</strong></p> \n<p>Testing a method that returns a <code class=\"language-text\">RACSignal</code> is more complicated than testing code that returns plain value objects, but it can be made less painful with a testing library that supports custom matchers. We have created a collection of matchers for <code class=\"language-text\">expecta</code> that lets us write concise tests. For example:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\">RACSignal <span class=\"token operator\">*</span>signal <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>subject executeRequest<span class=\"token punctuation\">:</span>url<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>signal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">.</span><span class=\"token function\">sendSingle</span><span class=\"token punctuation\">(</span><span class=\"token operator\">@</span><span class=\"token punctuation\">{</span> <span class=\"token string\">@\"track\"</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">@</span><span class=\"token punctuation\">{</span> <span class=\"token string\">@\"title\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">@\"foo\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>We found that adopting FRP tends to produce easily testable components because they are generally designed to perform one single task, which is to produce an output given a specific input.</p> \n<p>It took a while for the team to get up to speed with FRP and Reactive Cocoa and to learn for which parts of the application it can be used most effectively. Right now it has become an indispensable part of our mobile development efforts, both on Android and iOS. The functional reactive approach has made it easier to build complex functionality out of smaller pieces whilst simplifying concurrency and error handling.</p>","descriptionType":"html","publishedDate":"Mon, 07 Jul 2014 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"6d8c523254ef6b04f928d9ec4fd92ca1","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"oEmbed support for the new HTML5 widget","link":"https://developers.soundcloud.com/blog/oembed-support-for-the-html5-widget","description":"<p>Today we’ve added support for our <a href=\"https://blog.soundcloud.com/2011/11/03/html5/\">new HTML5 widget</a> to the oEmbed endpoint.</p> \n<p>Aside from a brand new user interface with lots of improvements, the HTML5 widget doesn’t require Adobe Flash anymore. That means the widget will load much faster and finally work well on most mobile platforms, including Android &amp; iOS.</p> \n<p>And we won’t stop here. We’ll continue to improve the new widget in the coming months.</p> \n<!-- more --> \n<p>To retrieve the embed code for a HTML5 widget just pass the <strong>iframe=true</strong> parameter. For example a call to:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">https://soundcloud.com/oembed?iframe=true&amp;url=https://soundcloud.com/erasedtapes/olafur-arnalds-poland</code></pre>\n</div> \n<p>will return this:</p> \n<iframe width=\"100%\" height=\"166\" scrolling=\"no\" frameborder=\"no\" src=\"https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F32431542&amp;show_artwork=true\"></iframe> \n<p>We are planning to make the HTML5 widget the default for oEmbed by the end of January. So if you prefer to stick to the old widget, please update your oEmbed calls to include the <strong>iframe=false</strong> parameter.</p>","descriptionType":"html","publishedDate":"Mon, 09 Jan 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"749fb1d60edd96e463c3ba5967bf62b8","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud at HackTO","link":"https://developers.soundcloud.com/blog/soundcloud-at-hackto","description":"<p>On Saturday, I joined over a hundred other hackers at <a href=\"http://hackdays.ca\">HackTO</a>. This has become a regular event in the Toronto tech scene, thanks to excellent organizing by <a href=\"https://twitter.com/leilaboujnane\">Leila Boujnane</a> and <a href=\"https://twitter.com/#!/barsoomcore\">Corey Reid</a>. SoundCloud joined several other API providers, including <a href=\"http://www.atomicreach.com/\">Atomic Reach</a>, <a href=\"http://context.io/\">Context.IO</a>, <a href=\"http://www.freshbooks.com\">FreshBooks</a>, <a href=\"http://www.shopify.com\">Shopify</a>, <a href=\"http://www.tineye.com/\">TinEye</a>, <a href=\"http://www.twilio.com\">Twilio</a>, <a href=\"http://trendspottr.com/welcome.php\">Trendspottr</a>, <a href=\"http://wordpress.com/\">WordPress</a> and <a href=\"http://www.yellowapi.com/\">YellowAPI</a>.</p> \n<p>The idea behind the event is simple: find a team (or go solo) and build an app using one or more of the APIs presented by sponsors. All apps have to be demoable by 5pm at which time you pitch to the judges who select the 1st, 2nd and 3rd place winners.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 450px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/df2c7/hackto.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAMEBQL/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQMC/9oADAMBAAIQAxAAAAGpxoTtYyYy9MS3jCh//8QAGxAAAgMBAQEAAAAAAAAAAAAAAQIAAxEiEjH/2gAIAQEAAQUCWswjJ4lTuY6ZWl+Ck82Dk/f/xAAXEQEAAwAAAAAAAAAAAAAAAAAAARAh/9oACAEDAQE/AWor/8QAFhEBAQEAAAAAAAAAAAAAAAAAEAEx/9oACAECAQE/AS6f/8QAHBAAAQQDAQAAAAAAAAAAAAAAAAECEBEhMXFh/9oACAEBAAY/AspgqKbr0Xhobyf/xAAbEAADAQADAQAAAAAAAAAAAAAAAREhMUFRYf/aAAgBAQABPyGnSux/Y2KuaOIKfH3RMGNeOdMGRrUEWKk0P//aAAwDAQACAAMAAAAQD+eA/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQAQEf/aAAgBAwEBPxDrLg3/xAAXEQADAQAAAAAAAAAAAAAAAAAAAREQ/9oACAECAQE/EKroj//EABwQAQEBAAIDAQAAAAAAAAAAAAERACFBMVGRof/aAAgBAQABPxBQu4Ql709gFCd+ppVIb1dFxOsF4cNQcKUp5PH37miaLayfmYkkGIgRnvCnAu//2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Hackers\" title=\"Hackers\" src=\"https://developers.soundcloud.com/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/df2c7/hackto.jpg\" srcset=\"/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/f544b/hackto.jpg 200w,\n/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/41689/hackto.jpg 400w,\n/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/df2c7/hackto.jpg 450w\" sizes=\"(max-width: 450px) 100vw, 450px\" loading=\"lazy\" /> </a> </span></p> \n<!-- more --> \n<p>For a one day hackathon, there were an impressive number of hacks demoed — 23 in total. Nearly half used SoundCloud, which was awesome. One thing that struck me was how much sound enhanced the demo process. Having an app that produces audio content makes for a much more engaging demonstration. It’s hard to ignore a demo when speakers are blaring.</p> \n<p>Here’s a few of my favourites from the event:</p> \n<h3>HackPad</h3> \n<p>Built by <a href=\"http://alanhietala.tumblr.com/\">Alan Hietala</a>, HackPad allows you to create loops and triggers using the SoundCloud API. Alan gave an impressive demo that had the crowd moving (not an easy task after a long day of hacking!). He’s got a write up with <a href=\"http://alanhietala.tumblr.com/post/21151951258/hackpad-a-hackto-joint\">an overview of the app and a link to Github</a>.</p> \n<h3>80s Joke Line</h3> \n<p>This Twilio and SoundCloud mashup lets users call up a Twilio provisioned number and record or listen to jokes. Jokes are all stored and served by SoundCloud. <a href=\"https://twitter.com/funkaoshi\">Ram</a>, <a href=\"https://twitter.com/mveytsman\">Max</a>, <a href=\"https://twitter.com/letstweetbro\">Houssam</a> and <a href=\"https://twitter.com/osirius\">Sam</a> did a great job demoing. Protip: If your app is based on jokes, your demo will be pretty funny! <a href=\"http://jokeline.ontoillogical.com/\">Check out the app</a> to post your own jokes and listen to others.</p> \n<h3>Podcasting Robots</h3> \n<p>Feeling too lazy to read a blog? That’s cool, <a href=\"https://twitter.com/mjangda\">Mo</a> built this WordPress, SoundCloud and Twilio mashup so you can have robots read it to you. Despite the fun angle, this kind of thing could be a great accessibility app. Could really use some <a href=\"https://developers.soundcloud.com/blog/contest-soundcloud-and-acapela-group\">different voices</a> though :-)</p> \n<p>It was great to see so many people finish their app in just under 6 hours. Thanks to everyone who participated and special thanks to <a href=\"http://www.freshbooks.com\">FreshBooks</a> for hosting!</p>","descriptionType":"html","publishedDate":"Tue, 17 Apr 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/df2c7/hackto.jpg","linkMd5":"47c2af3b8c0b1e75e9b9663f72901b83","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn53@2020_6/2020/08/25/00-49-38-722_3997713436a82152.webp","destWidth":450,"destHeight":450,"sourceBytes":24862,"destBytes":30050,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/df2c7/hackto.jpg":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn53@2020_6/2020/08/25/00-49-38-722_3997713436a82152.webp"},"publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Lessons in resilience at SoundCloud","link":"https://developers.soundcloud.com/blog/lessons-in-resilience-at-SoundCloud","description":"<p>Building and operating services distributed across a network is hard. Failures are inevitable. The way forward is having resiliency as a key part of design decisions.</p> \n<p>This post talks about two key aspects of resiliency when doing RPC at scale - the circuit breaker pattern, and its power combined with client-side load balancing.</p> \n<!-- more --> \n<h2>Circuit breakers v1.0</h2> \n<p>A basic definition of the Circuit Breaker pattern and its applicability is explained in <a href=\"http://martinfowler.com/bliki/CircuitBreaker.html\">Martin Fowler’s post on the topic</a>.</p> \n<p>SoundCloud’s original implementation meant a client’s view of a remote service transitioned between three pre-defined states:</p> \n<ul> \n <li><strong>Closed</strong> -&gt; Everything seems fine, let all requests go through. After <em>n</em> consecutive failures, transition into <em>Open</em>.</li> \n <li><strong>Open</strong> -&gt; The request, if let through, has a high probability of failing, given recent data. Fail the request pre-emptively and allow the remote service to recover. The circuit remains open for a pre-defined duration, and all requests are failed during that time. Thereafter an attempt to reset is made by transitioning into <em>Half-Open</em> mode.</li> \n <li><strong>Half-Open</strong> -&gt; Something bad happened a while back, let’s be cautious and let a single request through. If it passes, transition to <em>Closed</em>, else to <em>Open</em>.</li> \n</ul> \n<p>With this implementation, a <strong>single failure</strong> becomes the deciding factor for opening a circuit, blocking all requests to the remote service for a period. This meant degraded end user experience and having to manually restart client systems to reset the state.</p> \n<h2>The missing parts</h2> \n<p>As you start operating systems under high load, the following questions arise:</p> \n<ul> \n <li>Can we make more accurate predictions about the health of a remote service by using a moving window and tracking success as a <strong>percentage</strong> of total requests, as opposed to opening on <strong>n consecutive failures</strong> with unbounded duration?</li> \n <li>What happens when one or a few instances (limited to a specific network zone in a data-center, maybe) of a service are unhealthy, but a majority of other instances are healthy and available? Is it fair to <strong>fail all requests</strong> to a service in such a situation? This is especially relevant in a microservices architecture, where scaling horizontally is common.</li> \n <li>How can remote services convey more information about their health? A HTTP-based service may be up and running but repeatedly responding with <strong>5xx</strong>. Can we make clients smarter by using application specific information to decide when it’s a good idea to avoid overloading services?</li> \n</ul> \n<h2>A better alternative</h2> \n<p>In <a href=\"https://developers.soundcloud.com/blog/category/finagle\">a series of previous posts</a>, we’ve described how <a href=\"http://twitter.github.io/finagle/guide/\">Finagle</a> plays a key role in building our services.</p> \n<p>Given JSON over HTTP is used for inter-service communication at SoundCloud by most services, resiliency at this layer is critical to our uptime and dealing with all possible classes of failures.</p> \n<p>Earlier this year, we started exploring solutions aimed at improving resilience for our HTTP clients.</p> \n<p>We found that most of the gaps detailed above could be addressed through a combination of modules included in the Finagle stack for building clients.</p> \n<p>This was good news, but we still needed custom tweaks. The most important of these was to identify and compose multiple available modules, to help us define policies for how clients behave in failure scenarios and meet our expectations for high availability and a great user experience.</p> \n<p>Specifically, we could map each question to a module in Finagle that could potentially address the gaps:</p> \n<h3>Better than n consecutive failures <br /></h3> \n<p><strong>The problem</strong> : An unbounded duration, instead of a moving window, means clients infer inaccurate information about the health of remote services. A <a href=\"https://twitter.github.io/finagle/guide/Clients.html#failure-accrual\">failure accrual module in Finagle</a> allows clients to define a policy for success in terms of:</p> \n<ul> \n <li>a moving window specified as a duration or number of requests</li> \n <li>a success rate, expressed as a percentage of requests that should return an acceptable response</li> \n <li>a duration for which to mark a specific instance of a service as unavailable</li> \n</ul> \n<p>This captures all dimensions by which we want to define success thresholds.</p> \n<h3>Client’s view of individual service instances</h3> \n<p><strong>The problem</strong> : A client’s aggregated view of a remote service means a single rogue instance can trick you into believing that the whole service is unhealthy.</p> \n<p>Finagle monitors health of services, per instance, and applies the success policy defined by clients to decide if it can allow requests through to a given instance.</p> \n<p>A few unhealthy nodes can no longer render your service completely unavailable. Big win!</p> \n<p>In conjunction with <a href=\"https://twitter.github.io/finagle/guide/Clients.html#load-balancing\">client side load balancing</a>, this creates a dynamic view of a service for clients.</p> \n<p>Clients can now continue fetching data, with requests smartly routed only to service instances marked healthy, while unhealthy instances are temporarily ignored and allowed to recover.</p> \n<h3>Using the Application layer for decision making</h3> \n<p><strong>The problem</strong> : network layer information alone is often not good enough to make informed decisions about health of remote services.</p> \n<p>The ability for clients to define what classifies as failures, using information available in Application layer protocols, is powerful. This gives fine-grained control, and is an improvement over the standard network layer signals to classify remote invocations as success or failure.</p> \n<p>Clients should be able to classify failures from services, based on protocol specific data (e.g.: a HTTP <strong>5xx</strong> response code).</p> \n<p>This provides much needed application specific context to circuit breakers and results in accurate decisions regarding the health of individual instances of a service.</p> \n<p>Support for <a href=\"https://finagle.github.io/blog/2016/02/09/response-classification/\">response classification</a> was introduced in Finagle earlier this year, just in time for us to put it to good use.</p> \n<h2>Wrapping up</h2> \n<p>It is important to acknowledge that even the task of composing appropriate modules and configuring thresholds takes a fair bit of learning until you get it right.</p> \n<p>We switched to using a moving window of <em>duration</em> instead of <em>number of requests</em>, as we realised it was hard to define thresholds that worked equally well for high and low traffic services.</p> \n<p>Similar implementations exist for services that talk to database systems, cache nodes etc.</p> \n<p>Given that we were already on the Finagle stack, the capabilities listed were compelling. A combination of <a href=\"https://github.com/Netflix/ribbon\">Ribbon</a> + <a href=\"https://github.com/Netflix/hystrix\">Hystrix</a> (Java-based libraries, aimed at fault tolerance, from Netflix) make for a decent alternative.</p> \n<p>The above points aim to provide a high level summary of capabilities to look for when choosing to implement or use a framework aimed at improving resiliency.</p> \n<h2>Related concerns</h2> \n<ul> \n <li>What should be the policy around clients retrying requests?</li> \n <li>When dealing with sudden surge in incoming traffic, how can we cordon off services at the edge layer and keep critical core systems available?</li> \n</ul> \n<p>We hope to share our experiences on these aspects, as we move forward, and scale out further.</p>","descriptionType":"html","publishedDate":"Wed, 07 Dec 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"19b523322d3a2d9fb6e4bd832d1e36e1","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Irrational Fun: Find Yourself at Berlin Buzzwords","link":"https://developers.soundcloud.com/blog/buzzwords-contest","description":"<p>We were counting down the days until <a href=\"http://berlinbuzzwords.de/\">Berlin Buzzwords</a> on May 25, when we realised that it would be great if you came too! With that in mind, we’ve created a contest. One lucky winner will receive a free ticket to Berlin Buzzwords, including travel expenses and accommodation. Here are the details about how to apply.</p> \n<hr> \n <p>The ratio of a circle’s circumference to its diameter, represented by the Greek letter π, is an irrational number—it never terminates or repeats. Your goal is to find the SoundCloud logo in π.</p> \n <p>We have provided a 14 pixel by 6 pixel, greyscale reference image: <img src=\"https://developers.soundcloud.com/blog/5e0db8179b7cc2b056f00227038fd312/ref.gif\" /></p> \n <p>Here is the same image at 60X magnification:</p> \n <p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 420px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/c205b7d9d328c0738c46f04b092375b8/635b1/mag.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 42.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeUlEQVQoz52Sr6sCQRDH1/P8gYIWq8EgiPmKnl0NJhHkusWkxcNiUzAIYrou2sRg9x8wyKVLwuUzaBPxvO9jBvYQ3uM9eAvDzuzOfPju7IggCEBL7nK5rovdbofj8YhutwshBOLxOCKRCFKpFBqNBg6HA+f6vh/Wi0/Y9XrF+XyGbdtYLBZotVqwLAvNZpOBsVgMiqIgmUwin89jPB7DcRw8n89QlHi9Xng8HnxwOp2wXC6xWq1QrVYZMhwOUalU2FdVFdFolMEU67rO+bfbDe/3m00Q9X6/43K5YD6fM2gymaBWq3GRaZqhLxUSmOJCoYB2uw3P88JWifV6jX6/j81mA8MwkMvlGCJVjUYjViKBpJCMepnJZFAsFtHr9bieRIl6vc7Jg8EAmqaFEPnkn4CkUkLJ6I4+ab/fQ5RKJU4gVbKQIH8plFDZz3K5jE6nA0E9SCQS3575m8JPKI0S+QTbbrcQ0+kU2WyWR+A/QBqhdDqN2WzGn/IFV0dvxnjMvw4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"mag\" title=\"mag\" src=\"https://developers.soundcloud.com/blog/static/c205b7d9d328c0738c46f04b092375b8/635b1/mag.png\" srcset=\"/blog/static/c205b7d9d328c0738c46f04b092375b8/9ec3c/mag.png 200w,\n/blog/static/c205b7d9d328c0738c46f04b092375b8/c7805/mag.png 400w,\n/blog/static/c205b7d9d328c0738c46f04b092375b8/635b1/mag.png 420w\" sizes=\"(max-width: 420px) 100vw, 420px\" loading=\"lazy\" /> </a> </span></p> \n <p>Each of the 10 shades of grey in this image can be mapped to a number:</p> \n <table> \n  <thead> \n   <tr> \n    <th style=\"text-align: center\">Color</th> \n    <th style=\"text-align: center\">RGB Hex</th> \n    <th style=\"text-align: center\">Number</th> \n   </tr> \n  </thead> \n  <tbody> \n   <tr> \n    <td style=\"background-color: #fffff\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>ffffff</tt></td> \n    <td style=\"text-align: center\">0</td> \n   </tr> \n   <tr> \n    <td style=\"background-color: #f0f0f0\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>f0f0f0</tt></td> \n    <td style=\"text-align: center\">1</td> \n   </tr> \n   <tr> \n    <td style=\"background-color: #ebebeb\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>ebebeb</tt></td> \n    <td style=\"text-align: center\">2</td> \n   </tr> \n   <tr> \n    <td style=\"background-color: #d0d0d0\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>d0d0d0</tt></td> \n    <td style=\"text-align: center\">3</td> \n   </tr> \n   <tr> \n    <td style=\"background-color: #c1c1c1\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>c1c1c1</tt></td> \n    <td style=\"text-align: center\">4</td> \n   </tr> \n   <tr> \n    <td style=\"background-color: #a8a8a8\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>a8a8a8</tt></td> \n    <td style=\"text-align: center\">5</td> \n   </tr> \n   <tr> \n    <td style=\"background-color: #878787\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>878787</tt></td> \n    <td style=\"text-align: center\">6</td> \n   </tr> \n   <tr> \n    <td style=\"background-color: #535353\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>535353</tt></td> \n    <td style=\"text-align: center\">7</td> \n   </tr> \n   <tr> \n    <td style=\"background-color: #333333\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>333333</tt></td> \n    <td style=\"text-align: center\">8</td> \n   </tr> \n   <tr> \n    <td style=\"background-color: #000000\">&nbsp;</td> \n    <td style=\"text-align: center\"><tt>000000</tt></td> \n    <td style=\"text-align: center\">9</td> \n   </tr> \n  </tbody> \n </table> \n <p>Applying this mapping to the reference image produces the following 84-digit bitmap:</p> \n <pre>\n0 0 0 0 0 3 3 9 9 9 6 0 0 0\n0 0 0 3 4 9 5 9 9 9 9 4 0 0\n0 1 2 7 5 9 5 9 9 9 9 7 1 0\n3 9 5 9 5 9 5 9 9 9 9 9 9 3\n6 9 5 9 5 9 5 9 9 9 9 9 9 6\n1 8 5 9 5 9 5 9 9 9 9 9 8 1\n</pre> \n <p>Your challenge is to write an algorithm that finds the 10 sequences that most closely approximate the reference image. Each result should include the sequence and its position (after the decimal point) in π.</p> \n <p>Here is an example result set:</p> \n <table> \n  <thead> \n   <tr> \n    <th style=\"text-align: center\">Rank</th> \n    <th style=\"text-align: center\">Image</th> \n    <th style=\"text-align: center\">Sequence</th> \n    <th style=\"text-align: center\">Offset</th> \n   </tr> \n  </thead> \n  <tbody> \n   <tr> \n    <td style=\"text-align: center\">1</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/2ebccf21cf56cba42df5d0c35274453d/top-2.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 082201638940102393659252475011295776958920 282336494898427768768699465405437965994582 </tt></td> \n    <td style=\"text-align: right\"> 297,640,119 </td> \n   </tr> \n   <tr> \n    <td style=\"text-align: center\">2</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/7005b183f66e437e591eb82937666301/top-5.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 310015049916890341096198545241549627773525 291969856827158758552799587406476458977970 </tt></td> \n    <td style=\"text-align: right\"> 792,987,187 </td> \n   </tr> \n   <tr> \n    <td style=\"text-align: center\">3</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/9759dc7ed4f11651d3ee281112c50844/top-1.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 212021479960265330123798820231693768599316 147634474729776147987653958935291919768971 </tt></td> \n    <td style=\"text-align: right\"> 972,165,010 </td> \n   </tr> \n   <tr> \n    <td style=\"text-align: center\">4</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/ce8c549d406a1307b3f1ff9d041cba64/top-3.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 000053743536020032496985553181128909983810 344939134894807349584729687746183109884672 </tt></td> \n    <td style=\"text-align: right\"> 981,165,566 </td> \n   </tr> \n   <tr> \n    <td style=\"text-align: center\">5</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/9a00f5fc9731c187ee5477b79a60f7da/top-9.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 142204297650171312983445842322141909755200 787408739757838589593329762648444919386594 </tt></td> \n    <td style=\"text-align: right\"> 789,652,974 </td> \n   </tr> \n   <tr> \n    <td style=\"text-align: center\">6</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/1cf2891ffed889a6c92890b9fb0d87e4/top-6.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 300011495970664010077917573663456957498854 662995598898697947677549686339433357728071 </tt></td> \n    <td style=\"text-align: right\"> 197,342,990 </td> \n   </tr> \n   <tr> \n    <td style=\"text-align: center\">7</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/6b1b03d22f6affac3672abd8d8fcb3b7/top-10.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 313560984264300011495970664010077917573663 456957498854662995598898697947677549686339 </tt></td> \n    <td style=\"text-align: right\"> 197,342,978 </td> \n   </tr> \n   <tr> \n    <td style=\"text-align: center\">8</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/8545ccc3db8d8061df4a11f433587c2b/top-8.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 870402479996214234001557832923050859979903 649788689695954439755933903629798966788984 </tt></td> \n    <td style=\"text-align: right\"> 75,975,342 </td> \n   </tr> \n   <tr> \n    <td style=\"text-align: center\">9</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/6791562a522f2c4ee0d83a3b3e293fe5/top-7.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 208503759370245135490877462200175839969750 453766432680245845143285985661373828688970 </tt></td> \n    <td style=\"text-align: right\"> 343,577,393 </td> \n   </tr> \n   <tr> \n    <td style=\"text-align: center\">10</td> \n    <td style=\"text-align: center\"><img src=\"https://developers.soundcloud.com/blog/f7e32a09adbca3768ba99a9b91e38d50/top-4.gif\" /></td> \n    <td style=\"text-align: center\"><tt> 300544295771128716836756973814286978997516 282647269986574856578306678421894769876141 </tt></td> \n    <td style=\"text-align: right\"> 950,462,734 </td> \n   </tr> \n  </tbody> \n </table> \n <p>Entries will be judged against the follow criteria:</p> \n <ul> \n  <li>Code quality</li> \n  <li>Runtime performance</li> \n  <li>Visual closeness to the reference image (subjective)</li> \n </ul> \n <p>You should run your algorithm against the following <a href=\"http://stuff.mit.edu/afs/sipb/contrib/pi/pi-billion.txt\">data set</a> (approximately 1 GB), which contains the first 1,000,000,000 (billion) digits of π.</p> \n <p>Please send your submission, including a link to the source-code repository, to <a href=\"mailto:e@soundcloud.com\">e@soundcloud.com</a> on or before May 5, 2014 23:59 UTC. Your repository should contain a <code class=\"language-text\">README</code> that includes instructions about how to set up and run your code. Entries are subject to the <a href=\"https://developers.soundcloud.com/blog/docs/api/contest-terms\">terms and conditions</a>.</p> \n <hr> \n  <p><em><a name=\"buzzwords-update\">UPDATE</a></em></p> \n  <p>Congratulations to Tomasz Pewiński, who submitted the <a href=\"https://github.com/pewniak747/soundcloud-logo\">winning entry</a>.</p> \n  <p>We’d also like to acknowledge entries by <a href=\"https://github.com/oveddan/soundcloud-irrationalfun\">Dan Oved</a> and <a href=\"https://gist.github.com/mkhl/6e79aae644c7c0cb4d52\">Martin Kühl</a>, which were also excellent. Thanks to everyone else who participated in the contest. We hope it was fun!</p> \n </hr> \n</hr>","descriptionType":"html","publishedDate":"Sun, 27 Apr 2014 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/5e0db8179b7cc2b056f00227038fd312/ref.gif","linkMd5":"a5be158aef155aa89a77ab3a286f477c","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn50@2020_4/2020/08/25/00-49-38-998_924027af6c21307f.webp","destWidth":14,"destHeight":6,"sourceBytes":117,"destBytes":114,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/5e0db8179b7cc2b056f00227038fd312/ref.gif":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn50@2020_4/2020/08/25/00-49-38-998_924027af6c21307f.webp","https://developers.soundcloud.com/blog/static/c205b7d9d328c0738c46f04b092375b8/635b1/mag.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn52@2020_6/2020/08/25/00-51-40-332_ce7bbdbc7ae6c965.webp","https://developers.soundcloud.com/blog/2ebccf21cf56cba42df5d0c35274453d/top-2.gif":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn65@2020_1/2020/08/25/00-51-42-044_faeeb88f7b8de5e2.webp","https://developers.soundcloud.com/blog/7005b183f66e437e591eb82937666301/top-5.gif":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn16@2020_3/2020/08/25/00-51-44-219_bd25a75332ff82af.webp","https://developers.soundcloud.com/blog/9759dc7ed4f11651d3ee281112c50844/top-1.gif":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn79@2020_6/2020/08/25/00-51-43-798_67b028b82783d561.webp","https://developers.soundcloud.com/blog/ce8c549d406a1307b3f1ff9d041cba64/top-3.gif":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn48@2020_2/2020/08/25/00-51-40-709_bd7069bfa299f418.webp","https://developers.soundcloud.com/blog/9a00f5fc9731c187ee5477b79a60f7da/top-9.gif":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn74@2020_1/2020/08/25/00-51-41-964_286dc77c117f6c6d.webp","https://developers.soundcloud.com/blog/1cf2891ffed889a6c92890b9fb0d87e4/top-6.gif":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn37@2020_4/2020/08/25/00-51-43-686_571f03f5b1f38456.webp","https://developers.soundcloud.com/blog/6b1b03d22f6affac3672abd8d8fcb3b7/top-10.gif":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn47@2020_2/2020/08/25/00-51-40-378_2e600faf6e652916.webp","https://developers.soundcloud.com/blog/8545ccc3db8d8061df4a11f433587c2b/top-8.gif":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn54@2020_4/2020/08/25/00-51-41-899_aa81581cffde0ac5.webp","https://developers.soundcloud.com/blog/6791562a522f2c4ee0d83a3b3e293fe5/top-7.gif":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn61@2020_5/2020/08/25/00-51-45-639_6b5aee6d2017081b.webp","https://developers.soundcloud.com/blog/f7e32a09adbca3768ba99a9b91e38d50/top-4.gif":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn45@2020_1/2020/08/25/00-51-43-561_653caee56fc4732a.webp"},"publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Introducing the iOS Sharing Kit","link":"https://developers.soundcloud.com/blog/introducing-the-ios-sharing-kit","description":"<p>Not long ago we released a <a href=\"https://developers.soundcloud.com/blog/blog/introducing-the-android-sharing-kit\">sharing kit for Android</a>. Today, we’re equally excited to announce a similar <a href=\"https://github.com/soundcloud/CocoaSoundCloudAPI\">sharing kit for iOS</a>.</p> \n<p>With the sharing kit, you can add SoundCloud sharing to your iPhone and iPad apps with only a few lines of code. We provide everything you need to let your users share their sounds to SoundCloud, including authentication, UI and connections to other social networks like Facebook and Twitter.</p> \n<!-- more --> \n<p>It only takes a couple of minutes to implement. Yeah, really! This video shows you how to do it:</p> \n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.36363636363636%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\"> \n <div style=\"width: 100%; text-align: center\"> \n  <iframe src=\"http://player.vimeo.com/video/28715664?title=0&amp;byline=0&amp;portrait=0\" frameborder=\"0\" webkitallowfullscreen=\"\" allowfullscreen=\"\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> \n </div> \n</div> \n<p>As you see the kit takes care of the authentication and also provides a nice sharing screen similar to what we have in our own iPhone application. The whole project is hosted and documented on our <a href=\"https://github.com/soundcloud/CocoaSoundCloudAPI\">Github account</a>.</p> \n<p>Take a look and let us know what you think in the comments or our <a href=\"https://groups.google.com/forum/#!forum/soundcloudapi\">Google Group</a>.</p> \n<p>Happy Hacking!</p>","descriptionType":"html","publishedDate":"Tue, 25 Oct 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"dc029f8cfccb41763354afec48816397","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud at PennApps","link":"https://developers.soundcloud.com/blog/pennapps-recap","description":"<p>Last weekend, we sponsored and attended our first <a href=\"http://pennapps.com/\">PennApps</a>, the world’s largest student run hackathon held at the <a href=\"http://www.upenn.edu/\">University of Pennsylvania</a> in Philadelphia. Nearly 500 students participated from a variety of universities across the US and elsewhere. Students were given 36 hours to get into teams, hack on projects, then show them off to the judges. The results were astounding. In total, over <a href=\"https://www.hackerleague.org/hackathons/pennapps-spring-2013/hacks\">100 hacks were submitted</a>. Here are some of my personal favourites.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/917e9d55a63002b2f03ea66ef19b70d8/48a11/pennapps.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEBf/EABQBAQAAAAAAAAAAAAAAAAAAAAL/2gAMAwEAAhADEAAAAccWgqMYR//EABkQAAIDAQAAAAAAAAAAAAAAAAABAgMREv/aAAgBAQABBQKsejEzt2k1kv/EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ASf/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPwFn/8QAGRAAAgMBAAAAAAAAAAAAAAAAACEBEBEi/9oACAEBAAY/AmNVB0Yf/8QAGhAAAwEBAQEAAAAAAAAAAAAAAAERMVFBgf/aAAgBAQABPyGPrCeGNEkvHTc6c4i23h//2gAMAwEAAgADAAAAECz/AP/EABYRAQEBAAAAAAAAAAAAAAAAAAAhAf/aAAgBAwEBPxCo1//EABcRAAMBAAAAAAAAAAAAAAAAAAABMRH/2gAIAQIBAT8QrRQ//8QAHhABAQABAwUAAAAAAAAAAAAAAREAITFBEFGhscH/2gAIAQEAAT8QEyArXdXjzlgcrES9Du4+g2fu2J6hQgcLi7yj1n//2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Giving my API Demo\" title=\"Giving my API Demo\" src=\"https://developers.soundcloud.com/blog/static/917e9d55a63002b2f03ea66ef19b70d8/48a11/pennapps.jpg\" srcset=\"/blog/static/917e9d55a63002b2f03ea66ef19b70d8/f544b/pennapps.jpg 200w,\n/blog/static/917e9d55a63002b2f03ea66ef19b70d8/41689/pennapps.jpg 400w,\n/blog/static/917e9d55a63002b2f03ea66ef19b70d8/48a11/pennapps.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<!-- more --> \n<h3>Cloud Sequencer</h3> \n<p>The winners of the Best Audio Hack Prize, Cloud Sequencer is an app that allows you to hook up a midi keyboard to your browser, and map portions of SoundCloud tracks to the keys. The level of polish on this app was amazing and I’m happy to note that the team is working on making a public version available that will work with a midi keyboard or your computer’s keyboard. Here’s the team, <a href=\"https://twitter.com/naklugman\">Noah Klugman</a>, <a href=\"http://maxseiden.com/\">Max Seiden</a>, <a href=\"https://twitter.com/gargury\">Gaurav Kulkarni</a> and <a href=\"https://twitter.com/daiyunxing\">Yunxing Dai</a> demoing their project.</p> \n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 75%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\"> \n <iframe src=\"http://www.youtube.com/embed/B3fGSrFxzbA\" frameborder=\"0\" allowfullscreen=\"\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> \n</div> \n<h3>SoundScultpr</h3> \n<p>This was fairly mind blowing. Four <strong>High</strong> School students, <a href=\"https://twitter.com/jzone333\">Jared Zoneraich</a>, Kenny Song, <a href=\"http://www.linkedin.com/pub/russell-kaplan/61/76a/b37\">Russell Kaplan</a>, David Maginley built <a href=\"http://soundsculptor.herokuapp.com/\">SoundSculptr</a>. SoundSculptr uses a <a href=\"https://www.leapmotion.com/\">Leap Motion</a> to enable users to create music by moving their hands. It’s a fantastic idea and they pulled it off brilliantly. You can even upload the result to SoundCloud!</p> \n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\"> \n <iframe src=\"http://www.youtube.com/embed/J5c0htimgWc\" frameborder=\"0\" allowfullscreen=\"\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> \n</div> \n<h3>Astoria</h3> \n<p>Ever checked out a neighbourhood using Google maps Street View? Astoria takes this to a new level by allowing you to use your phone to “steer” your way through a city Grand Theft Auto style, pulling in venues from Yelp as you pass them, showing property values, and letting you listen to local sounds on SoundCloud. Get the full neighbourhood experience with this app. Astoria was built by Joshua Ma, Anisha Pai, Max Kolysh and Thomas Georgiou. Here’s team member Anvisha Pai giving it a go.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 450px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/e405663ada13f8054ac2646ede66561a/df2c7/astoria.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 133.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAwL/xAAWAQEBAQAAAAAAAAAAAAAAAAACAAH/2gAMAwEAAhADEAAAAcHJbp3YUDs9lXhmuKlf/8QAHBAAAgMAAwEAAAAAAAAAAAAAAQMAAhESIjEy/9oACAEBAAEFAkMwBh4xJrt/ATlTEvNYe0rDF/H/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8BK//EABYRAAMAAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPwEj/8QAHRAAAQQCAwAAAAAAAAAAAAAAAQAREkECECAhQv/aAAgBAQAGPwKXp1CNu+gMgpAFXogno0nGceH/xAAbEAACAwEBAQAAAAAAAAAAAAABEQAhMUFRYf/aAAgBAQABPyEQUxf2XHRoOQwBLXVN1wXeQ8Dg5UKkEe+QtWHESyDzYNiacuE//9oADAMBAAIAAwAAABDbEcP/xAAYEQACAwAAAAAAAAAAAAAAAAAAARARYf/aAAgBAwEBPxDYItH/xAAYEQADAQEAAAAAAAAAAAAAAAAAAREQUf/aAAgBAgEBPxB8ReRn/8QAHxABAAICAgIDAAAAAAAAAAAAAQARITFRYUGBccHR/9oACAEBAAE/EF/c5CgzvsYcpCpKBVqbaitjmuwLydlxi/oLDs7quufMpacmTJ6mMgMDY599yoUIB5D9ELiybmHwwio3+R0xhGhOIlKt2+Z//9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Checking out the hood with Astoria\" title=\"Checking out the hood with Astoria\" src=\"https://developers.soundcloud.com/blog/static/e405663ada13f8054ac2646ede66561a/df2c7/astoria.jpg\" srcset=\"/blog/static/e405663ada13f8054ac2646ede66561a/f544b/astoria.jpg 200w,\n/blog/static/e405663ada13f8054ac2646ede66561a/41689/astoria.jpg 400w,\n/blog/static/e405663ada13f8054ac2646ede66561a/df2c7/astoria.jpg 450w\" sizes=\"(max-width: 450px) 100vw, 450px\" loading=\"lazy\" /> </a> </span></p> \n<h3>LiveTale.us</h3> \n<p>I love apps that explore new ways of telling stories. LiveTale, built by Nathan Schloss, Yair Aviner, Ben Glickman and Tyler Cloutier lets users record snippets of a story or listen to previously recorded story tales plotted on a google map. Bonus points for deploying it live, so you can <a href=\"http://livetale.us/\">check it out</a>.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 450px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/f4dcd6a46d940501cc67ab04694d0b03/df2c7/livetale.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 133.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgMF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAFxfl7ZbCQOrKYlSSv/xAAeEAACAQMFAAAAAAAAAAAAAAABAgMAESEQEhMiMv/aAAgBAQABBQK44mHffajK4YyPZjkFWaaTGaHiTT//xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8BcP/EABcRAAMBAAAAAAAAAAAAAAAAAAAQEUH/2gAIAQIBAT8Bwj//xAAeEAABBAIDAQAAAAAAAAAAAAAAAREhMRASAgNRUv/aAAgBAQAGPwLsR5ZyfEG1OU2Ovz4WSau6JRWEx//EABoQAQADAQEBAAAAAAAAAAAAAAEAETEhcWH/2gAIAQEAAT8hsuKcIybD2i0i1Q9EYfJpuAhuntJvh9qDUEmieEfLNyLU/9oADAMBAAIAAwAAABDIL8P/xAAWEQADAAAAAAAAAAAAAAAAAAABIDH/2gAIAQMBAT8QFR//xAAYEQACAwAAAAAAAAAAAAAAAAAAARARQf/aAAgBAgEBPxB4lZ//xAAcEAEBAAMBAQEBAAAAAAAAAAABEQAhMUFxUdH/2gAIAQEAAT8QScHgPSYhGb0mo/zCI2lvc20p+WvM8W0QQOB9xJUAWXHLKaBQ/cSDUGM1POmO0bGuXGDMabzq9yZvP//Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"The LiveTale.us Team\" title=\"The LiveTale.us Team\" src=\"https://developers.soundcloud.com/blog/static/f4dcd6a46d940501cc67ab04694d0b03/df2c7/livetale.jpg\" srcset=\"/blog/static/f4dcd6a46d940501cc67ab04694d0b03/f544b/livetale.jpg 200w,\n/blog/static/f4dcd6a46d940501cc67ab04694d0b03/41689/livetale.jpg 400w,\n/blog/static/f4dcd6a46d940501cc67ab04694d0b03/df2c7/livetale.jpg 450w\" sizes=\"(max-width: 450px) 100vw, 450px\" loading=\"lazy\" /> </a> </span></p> \n<h3>Instagramaphone</h3> \n<p>This one made me laugh. Built by Dina Lamdany, Christopher Yan, Daria Jung and Nate Brennand, <a href=\"http://instagramophone.info/\">Instagramaphone</a> allows you to record audio and then apply “Filters” before sharing it with the world. Such a brilliant concept and really well executed. <a href=\"http://instagramophone.info/\">Check it out</a> and start playing with filters now. Oh, and they had a banana on their team. I applaud this.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 450px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/806cfc30f521eb9c01e9562ca8bcd587/df2c7/instagramaphone.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 133.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAwH/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAGlKcm51RJA3t1LCpbFBn//xAAcEAACAgMBAQAAAAAAAAAAAAABAgARAwQiIxL/2gAIAQEAAQUCxmptN76r+Rb5Ow/ZJmd+1fFV1GJKwz//xAAVEQEBAAAAAAAAAAAAAAAAAAAQAf/aAAgBAwEBPwEp/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAIhEBL/2gAIAQIBAT8BWnIsz//EABwQAAEEAwEAAAAAAAAAAAAAAAAQESExAQJRgf/aAAgBAQAGPwIyel2lE4g2fV36k9X/xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMUFR/9oACAEBAAE/IYVK/hNEIl9LB8jIqjPIqkXPMhpEx55ClZ4XpE4uK1XUG9nU/9oADAMBAAIAAwAAABAfCzD/xAAYEQADAQEAAAAAAAAAAAAAAAAAAREQIf/aAAgBAwEBPxBvpcU//8QAFxEBAQEBAAAAAAAAAAAAAAAAAREAEP/aAAgBAgEBPxAxc4JDn//EAB8QAQACAgICAwAAAAAAAAAAAAEAESExUWFBcYGhsf/aAAgBAQABPxBFkrqICxZ9S6xzf8IiArIacTNEqqMrfmC5oFtS/RKrlVeTjvEMCnRYK4+Y6LU8y90pHpu4l0rDVxR//9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"The Instagramaphone Team\" title=\"The Instagramaphone Team\" src=\"https://developers.soundcloud.com/blog/static/806cfc30f521eb9c01e9562ca8bcd587/df2c7/instagramaphone.jpg\" srcset=\"/blog/static/806cfc30f521eb9c01e9562ca8bcd587/f544b/instagramaphone.jpg 200w,\n/blog/static/806cfc30f521eb9c01e9562ca8bcd587/41689/instagramaphone.jpg 400w,\n/blog/static/806cfc30f521eb9c01e9562ca8bcd587/df2c7/instagramaphone.jpg 450w\" sizes=\"(max-width: 450px) 100vw, 450px\" loading=\"lazy\" /> </a> </span></p> \n<p>I could go on, there were so many amazing hacks. Special mention to <a href=\"http://blog.pennapps.com/post/40993980632/whos-hacking-what-the-musical-toilet\">The Musical Toilet</a> which lets users control SoundCloud with their, ahem, stream.</p>","descriptionType":"html","publishedDate":"Wed, 23 Jan 2013 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/917e9d55a63002b2f03ea66ef19b70d8/48a11/pennapps.jpg","linkMd5":"b27715d5d2a8093929774bbb15a3b2c6","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn97@2020_4/2020/08/25/00-49-37-633_ddf59dbbe7ef7dad.webp","destWidth":500,"destHeight":375,"sourceBytes":13885,"destBytes":14914,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/917e9d55a63002b2f03ea66ef19b70d8/48a11/pennapps.jpg":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn97@2020_4/2020/08/25/00-49-37-633_ddf59dbbe7ef7dad.webp","https://developers.soundcloud.com/blog/static/e405663ada13f8054ac2646ede66561a/df2c7/astoria.jpg":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn62@2020_2/2020/08/25/00-51-43-937_561845c0b0d468f7.webp","https://developers.soundcloud.com/blog/static/f4dcd6a46d940501cc67ab04694d0b03/df2c7/livetale.jpg":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn88@2020_2/2020/08/25/00-51-45-213_0c12f884e6196d6d.webp","https://developers.soundcloud.com/blog/static/806cfc30f521eb9c01e9562ca8bcd587/df2c7/instagramaphone.jpg":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn99@2020_6/2020/08/25/00-51-40-790_0d27acc8cc27a372.webp"},"publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"New Activities","link":"https://developers.soundcloud.com/blog/new-activities","description":"<p>Today we announce new activities available over the API. As a reminder: Activites are the items on your <a href=\"https://soundcloud.com/dashboard\">Dashboard</a>.</p> \n<!-- more --> \n<p>The activities resource now supports favoritings and comments. They look like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"json\">\n <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"comment\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"created_at\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2011/07/21 10:07:50 +0000\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"origin\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">123456</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"I like this track a lot\"</span><span class=\"token punctuation\">,</span>\n    ...\n    <span class=\"token property\">\"user\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span>\n      ...\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"track\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">123456</span><span class=\"token punctuation\">,</span>\n      ...\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"tags\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"affiliated\"</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"favoriting\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"created_at\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2011/07/22 06:50:39 +0000\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"origin\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"track\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">123456</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"My new nice track\"</span><span class=\"token punctuation\">,</span>\n      ...\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"user\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"tags\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"affiliated\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre>\n</div> \n<p>Also, you are now able to filter recent comments and favoritings that happened on your own tracks via</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">https://api.soundcloud.com/me/activities/all/own?oauth_token=A_VALID_TOKEN</code></pre>\n</div> \n<p>The documentation can be found <a href=\"https://developers.soundcloud.com/docs/api/me-activities\">here</a>.</p>","descriptionType":"html","publishedDate":"Fri, 22 Jul 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"8746c70cdf52ffc21c220acdd833e0a7","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"API Sign-up Changes","link":"https://developers.soundcloud.com/blog/api-sign-up-changes","description":"<p><strong>Today we are launching a new API application process.</strong></p> \n<p>Starting today, developers will need to fill out an application form to request access to our API.</p> \n<p><strong>Here is why.</strong></p> \n<p>As SoundCloud has grown, we’ve seen our API used in countless innovative ways that support and enhance the SoundCloud experience for our creators and listeners around the globe. At the same time, we’ve also seen a number of apps or services that act on behalf of our users without their explicit permission or attempt to use creator content in ways that are not permitted by our API Terms of Use. Apps or services that operate in this way do not support our creators, listeners or the SoundCloud community.</p> \n<p><strong>Here is what it means.</strong></p> \n<p>Developers who currently have API credentials and comply with our API Terms of Use may continue to use the SoundCloud API. All new requests for an API key must go through the review process, where applications will be reviewed on a case by case basis, in line with our API Terms of Use. If your application is successful, you will receive an API key.</p> \n<p>To review our API Terms of Use, <a href=\"https://developers.soundcloud.com/docs/api/terms-of-use\">click here</a>.</p> \n<p>If you wish to submit an API Application Form, <a href=\"https://soundcloud.com/you/apps/new\">click here</a>.</p>","descriptionType":"html","publishedDate":"Fri, 23 Sep 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"f5f73195319d0aa0b1c4f9dc9cf35305","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Creating Readable Spark Jobs","link":"https://developers.soundcloud.com/blog/creating-readable-spark-jobs","description":"<p>Nowadays, it’s rather common to encounter <a href=\"https://spark.apache.org/\">Apache Spark</a> being utilized in a lot of companies that need to process huge amounts of data, and things aren’t any different here at SoundCloud — as one can imagine, we have lots of data to process all the time.</p> \n<!-- more --> \n<p>While Spark does offer a <a href=\"https://spark.apache.org/streaming/\">streaming API</a>, along with other tools like <a href=\"https://kafka.apache.org/documentation/streams/\">Kafka Streams</a> and <a href=\"https://flink.apache.org/\">Apache Flink</a>, we mainly (but not exclusively) use batch processing with Spark to solve a variety of problems, such as:</p> \n<ul> \n <li>The creation of some partners’ reports</li> \n <li><a href=\"https://developers.soundcloud.com/blog/pagerank-in-spark\">Machine learning</a></li> \n <li><a href=\"https://spark.apache.org/docs/2.3.0/api/java/index.html?org/apache/spark/sql/Dataset.html\">Datasets</a></li> \n <li>Data (re)processing pipeline</li> \n</ul> \n<p>While Spark’s Scala API could be more <a href=\"https://github.com/typelevel/frameless\">idiomatic and type safe</a>, it does offer a nice <a href=\"https://en.wikipedia.org/wiki/Domain-specific_language\">DSL</a> that allows one to create expressive pipelines. However, it’s also not uncommon to see these jobs getting a little bit out of control in terms of readability, with many nested operations. This can lead to situations where one needs to spend some time reasoning about what’s going on and what types are being passed through all of those intermediate operators.</p> \n<p>In this article, we’ll see how to break down the aforementioned types of jobs into smaller chunks and how to compose them using <a href=\"https://en.wikipedia.org/wiki/Functional_programming\">functional programming techniques</a>. In order to illustrate this approach, let’s go through a simplified use case of a real system our team is responsible for. Even though the example illustrated here is implemented using Spark, these techniques could be employed with other technologies as well, like <a href=\"http://crunch.apache.org/scrunch.html\">Scrunch</a>.</p> \n<h2>Practical Example</h2> \n<p>One of the things the <a href=\"https://developers.soundcloud.com/blog/managing-unplanned-and-support-tasks\">Content Team</a> here at SoundCloud is responsible for is receiving content from labels and making it available to users. As part of this process, our systems need to decide which SoundCloud profile each track should be uploaded to.</p> \n<p>The way this decision process works is based on rules that are matched against specific parts of the metadata of each track. For our simplified use case, we have two rule types:</p> \n<ul> \n <li>One matching both artist and label names</li> \n <li>One based only on the artist name</li> \n</ul> \n<p>We’ll assume there are no conflicting rules, i.e. there will be no two rules matching the same label/artist or artist, and the rules matching both artist and label names have higher priority than the ones matching only the artist name. Of course, things are more complex in the real world, but this should be good enough for our example. Before getting into the job itself, let’s take a look at the model:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\"> \n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">case</span> <span class=\"token keyword\">class</span> Label<span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token keyword\">class</span> Artist<span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token keyword\">class</span> Track<span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> artistId<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">,</span> labelId<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token keyword\">class</span> RuleType<span class=\"token punctuation\">(</span>name<span class=\"token operator\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">object</span> RuleType <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">val</span> Artist <span class=\"token operator\">=</span> RuleType<span class=\"token punctuation\">(</span><span class=\"token string\">\"artist\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> ArtistAndLabel <span class=\"token operator\">=</span> RuleType<span class=\"token punctuation\">(</span><span class=\"token string\">\"artist-and-label\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">trait</span> MappingRule <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">def</span> id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span>\n  <span class=\"token keyword\">def</span> ruleType<span class=\"token operator\">:</span> RuleType\n  <span class=\"token keyword\">def</span> userId<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token keyword\">class</span> MappingRuleArtistAndLabel<span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">,</span> artist<span class=\"token operator\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> userId<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">extends</span> MappingRule <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">override</span> <span class=\"token keyword\">def</span> ruleType<span class=\"token operator\">:</span> RuleType <span class=\"token operator\">=</span> RuleType<span class=\"token punctuation\">.</span>ArtistAndLabel\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token keyword\">class</span> MappingRuleArtist<span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">,</span> artist<span class=\"token operator\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> userId<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">extends</span> MappingRule <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">override</span> <span class=\"token keyword\">def</span> ruleType<span class=\"token operator\">:</span> RuleType <span class=\"token operator\">=</span> RuleType<span class=\"token punctuation\">.</span>Artist\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token keyword\">class</span> AppliedRule<span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">,</span> ruleType<span class=\"token operator\">:</span> RuleType<span class=\"token punctuation\">,</span> userId<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">case</span> <span class=\"token keyword\">class</span> TrackWithAppliedRule<span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> artist<span class=\"token operator\">:</span> Artist<span class=\"token punctuation\">,</span> label<span class=\"token operator\">:</span> Label<span class=\"token punctuation\">,</span> maybeAppliedRule<span class=\"token operator\">:</span> Option<span class=\"token punctuation\">[</span>AppliedRule<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>A few things could be better in this model:</p> \n<ul> \n <li>We could use <a href=\"https://docs.scala-lang.org/overviews/core/value-classes.html\">value classes</a> to wrap the primitive types like IDs and names.</li> \n <li>The <code class=\"language-text\">RuleType</code> could be defined as a sealed trait with case objects implementing it.</li> \n <li>The <code class=\"language-text\">TrackWithAppliedRule</code> could have a field of type <code class=\"language-text\">MappingRule</code> instead, thereby removing the need for the <code class=\"language-text\">AppliedRule</code> class.</li> \n</ul> \n<p>Unfortunately, some of these ideas are rather difficult to implement with vanilla Spark. One approach to overcome these issues is by using <a href=\"https://github.com/typelevel/frameless\">Frameless</a>, but that would be a topic for another blog post, so let’s leave the model as it is.</p> \n<p>Moving forward, the input to the job will be five <a href=\"https://spark.apache.org/docs/2.3.0/api/java/index.html?org/apache/spark/sql/Dataset.html\">datasets</a>:</p> \n<ul> \n <li>One with the tracks</li> \n <li>One with the artists</li> \n <li>One with the labels</li> \n <li>One with the artists’/labels’ rules</li> \n <li>Another one with the artists’ rules</li> \n</ul> \n<p>The job basically needs to:</p> \n<ul> \n <li>Join tracks with artists and labels</li> \n <li>Apply the artists’/labels’ rules</li> \n <li>Apply the artists’ rules</li> \n <li>Select the best rule and return a dataset of <code class=\"language-text\">TrackWithAppliedRule</code></li> \n</ul> \n<h3>Starting with the Tests</h3> \n<p>Below is a single test case that can help with better understanding the logic and that will also help with the development and refactoring of the job:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\"> \n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>spark<span class=\"token punctuation\">.</span>sql</span><span class=\"token punctuation\">.</span>SparkSession\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>specs2<span class=\"token punctuation\">.</span>mutable</span><span class=\"token punctuation\">.</span>Specification\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>specs2<span class=\"token punctuation\">.</span>specification</span><span class=\"token punctuation\">.</span>Scope\n\n<span class=\"token keyword\">class</span> RuleApplierJobSpec <span class=\"token keyword\">extends</span> Specification <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">trait</span> Context <span class=\"token keyword\">extends</span> Scope <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">val</span> spark <span class=\"token operator\">=</span> SparkSession\n    <span class=\"token punctuation\">.</span>builder<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>appName<span class=\"token punctuation\">(</span><span class=\"token string\">\"tracks-rules-applier\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>master<span class=\"token punctuation\">(</span><span class=\"token string\">\"local\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">(</span><span class=\"token string\">\"spark.sql.shuffle.partitions\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>getOrCreate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> job <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> RuleApplierJob<span class=\"token punctuation\">(</span>spark<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">val</span> label1 <span class=\"token operator\">=</span> Label<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> name <span class=\"token operator\">=</span> <span class=\"token string\">\"Label 1\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">val</span> artist1 <span class=\"token operator\">=</span> Artist<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> name <span class=\"token operator\">=</span> <span class=\"token string\">\"Artist 1\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> artist2 <span class=\"token operator\">=</span> Artist<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> name <span class=\"token operator\">=</span> <span class=\"token string\">\"Artist 2\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> artist3 <span class=\"token operator\">=</span> Artist<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> name <span class=\"token operator\">=</span> <span class=\"token string\">\"Artist 3\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">val</span> ruleArtist1AndLabel1 <span class=\"token operator\">=</span> MappingRuleArtistAndLabel<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> artist <span class=\"token operator\">=</span> <span class=\"token string\">\"Artist 1\"</span><span class=\"token punctuation\">,</span> label <span class=\"token operator\">=</span> <span class=\"token string\">\"Label 1\"</span><span class=\"token punctuation\">,</span> userId <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> ruleArtist1 <span class=\"token operator\">=</span> MappingRuleArtist<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> artist <span class=\"token operator\">=</span> <span class=\"token string\">\"Artist 1\"</span><span class=\"token punctuation\">,</span> userId <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> ruleArtist2 <span class=\"token operator\">=</span> MappingRuleArtist<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> artist <span class=\"token operator\">=</span> <span class=\"token string\">\"Artist 2\"</span><span class=\"token punctuation\">,</span> userId <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">val</span> track1 <span class=\"token operator\">=</span> Track<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">\"Title Track 1\"</span><span class=\"token punctuation\">,</span> artistId <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> labelId <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> track2 <span class=\"token operator\">=</span> Track<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">\"Title Track 2\"</span><span class=\"token punctuation\">,</span> artistId <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> labelId <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> track3 <span class=\"token operator\">=</span> Track<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">\"Title Track 3\"</span><span class=\"token punctuation\">,</span> artistId <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> labelId <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token string\">\"it should match rules against artist and label of each track\"</span> in <span class=\"token keyword\">new</span> Context <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">import</span> <span class=\"token namespace\">spark<span class=\"token punctuation\">.</span>implicits</span><span class=\"token punctuation\">.</span>_\n\n  <span class=\"token keyword\">val</span> labels <span class=\"token operator\">=</span> Seq<span class=\"token punctuation\">(</span>label1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>toDS<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> artists <span class=\"token operator\">=</span> Seq<span class=\"token punctuation\">(</span>artist1<span class=\"token punctuation\">,</span> artist2<span class=\"token punctuation\">,</span> artist3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>toDS<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> artistsAndLabelsRules <span class=\"token operator\">=</span> Seq<span class=\"token punctuation\">(</span>ruleArtist1AndLabel1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>toDS<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> artistsRules <span class=\"token operator\">=</span> Seq<span class=\"token punctuation\">(</span>ruleArtist1<span class=\"token punctuation\">,</span> ruleArtist2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>toDS<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> tracks <span class=\"token operator\">=</span> Seq<span class=\"token punctuation\">(</span>track1<span class=\"token punctuation\">,</span> track2<span class=\"token punctuation\">,</span> track3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>toDS<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">val</span> result <span class=\"token operator\">=</span> job<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>tracks<span class=\"token punctuation\">,</span> artists<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">,</span> artistsAndLabelsRules<span class=\"token punctuation\">,</span> artistsRules<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>collect<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>toSeq\n\n  result should containTheSameElementsAs<span class=\"token punctuation\">(</span>Seq<span class=\"token punctuation\">(</span>\n    TrackWithAppliedRule<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Title Track 1\"</span><span class=\"token punctuation\">,</span> artist1<span class=\"token punctuation\">,</span> label1<span class=\"token punctuation\">,</span> Some<span class=\"token punctuation\">(</span>AppliedRule<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> RuleType<span class=\"token punctuation\">.</span>ArtistAndLabel<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      TrackWithAppliedRule<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Title Track 2\"</span><span class=\"token punctuation\">,</span> artist2<span class=\"token punctuation\">,</span> label1<span class=\"token punctuation\">,</span> Some<span class=\"token punctuation\">(</span>AppliedRule<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> RuleType<span class=\"token punctuation\">.</span>Artist<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      TrackWithAppliedRule<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Title Track 3\"</span><span class=\"token punctuation\">,</span> artist3<span class=\"token punctuation\">,</span> label1<span class=\"token punctuation\">,</span> None<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<h3>Working and Iterating on the Job</h3> \n<p>The first version of the job works and gets the tests passing, but it’s not that readable — especially if you consider people joining a team and having to understand and maintain the job:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\"> \n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>spark<span class=\"token punctuation\">.</span>sql</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">{</span>Dataset<span class=\"token punctuation\">,</span> SparkSession<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> RuleApplierJobV1<span class=\"token punctuation\">(</span>spark<span class=\"token operator\">:</span> SparkSession<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">import</span> <span class=\"token namespace\">spark<span class=\"token punctuation\">.</span>implicits</span><span class=\"token punctuation\">.</span>_\n\n  <span class=\"token keyword\">def</span> run<span class=\"token punctuation\">(</span>tracks<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Track<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          artists<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Artist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          labels<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          artistsAndLabelsRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtistAndLabel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          artistRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>TrackWithAppliedRule<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span>\n  tracks\n    <span class=\"token punctuation\">.</span>joinWith<span class=\"token punctuation\">(</span>artists<span class=\"token punctuation\">,</span> tracks<span class=\"token punctuation\">(</span><span class=\"token string\">\"artistId\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> artists<span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"inner\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>joinWith<span class=\"token punctuation\">(</span>labels<span class=\"token punctuation\">,</span> $<span class=\"token string\">\"_1.labelId\"</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> labels<span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"inner\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>map <span class=\"token punctuation\">{</span> <span class=\"token keyword\">case</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span> <span class=\"token keyword\">=&gt;</span> <span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">.</span>joinWith<span class=\"token punctuation\">(</span>artistsAndLabelsRules<span class=\"token punctuation\">,</span> $<span class=\"token string\">\"_2.name\"</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> artistsAndLabelsRules<span class=\"token punctuation\">(</span><span class=\"token string\">\"artist\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>\n      $<span class=\"token string\">\"_3.name\"</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> artistsAndLabelsRules<span class=\"token punctuation\">(</span><span class=\"token string\">\"label\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"left_outer\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span>map <span class=\"token punctuation\">{</span> <span class=\"token keyword\">case</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> artistAndLabelRule<span class=\"token punctuation\">)</span> <span class=\"token keyword\">=&gt;</span> <span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">(</span>artistAndLabelRule<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">.</span>joinWith<span class=\"token punctuation\">(</span>artistRules<span class=\"token punctuation\">,</span> $<span class=\"token string\">\"_2.name\"</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> artistRules<span class=\"token punctuation\">(</span><span class=\"token string\">\"artist\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"left_outer\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>map <span class=\"token punctuation\">{</span> <span class=\"token keyword\">case</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> maybeArtistAndLabelRule<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ruleArtist<span class=\"token punctuation\">)</span> <span class=\"token keyword\">=&gt;</span> <span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> maybeArtistAndLabelRule<span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">(</span>ruleArtist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">.</span>map <span class=\"token punctuation\">{</span> <span class=\"token keyword\">case</span> <span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> maybeArtistAndLabelRule<span class=\"token punctuation\">,</span> maybeArtistRule<span class=\"token punctuation\">)</span> <span class=\"token keyword\">=&gt;</span>\n      TrackWithAppliedRule<span class=\"token punctuation\">(</span>\n        track<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n          track<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n          artist<span class=\"token punctuation\">,</span>\n          label<span class=\"token punctuation\">,</span>\n          maybeArtistAndLabelRule<span class=\"token punctuation\">.</span>orElse<span class=\"token punctuation\">(</span>maybeArtistRule<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>map<span class=\"token punctuation\">(</span>r <span class=\"token keyword\">=&gt;</span> AppliedRule<span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>ruleType<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>A first approach to make it better is a very basic technique in programming: breaking a big problem into smaller pieces. We can do that by creating smaller functions, each one doing one part of the work:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\"> \n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>spark<span class=\"token punctuation\">.</span>sql</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">{</span>Dataset<span class=\"token punctuation\">,</span> SparkSession<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> RuleApplierJob<span class=\"token punctuation\">(</span>spark<span class=\"token operator\">:</span> SparkSession<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">import</span> RuleApplierJob<span class=\"token punctuation\">.</span>_\n\n  <span class=\"token keyword\">def</span> run<span class=\"token punctuation\">(</span>tracks<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Track<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          artists<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Artist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          labels<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          artistsAndLabelsRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtistAndLabel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          artistRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>TrackWithAppliedRule<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">val</span> tracksWithArtists <span class=\"token operator\">=</span> joinTracksWithArtists<span class=\"token punctuation\">(</span>tracks<span class=\"token punctuation\">,</span> artists<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> tracksWithArtistsAndLabels <span class=\"token operator\">=</span> joinTracksAndArtistsWithLabels<span class=\"token punctuation\">(</span>tracksWithArtists<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>spark<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> withArtistsAndLabelsRules <span class=\"token operator\">=</span> applyArtistsAndLabelsRules<span class=\"token punctuation\">(</span>tracksWithArtistsAndLabels<span class=\"token punctuation\">,</span> artistsAndLabelsRules<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>spark<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">val</span> withArtistsRules <span class=\"token operator\">=</span> applyArtistRules<span class=\"token punctuation\">(</span>withArtistsAndLabelsRules<span class=\"token punctuation\">,</span> artistRules<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>spark<span class=\"token punctuation\">)</span>\n  convertToTrackWithAppliedRule<span class=\"token punctuation\">(</span>withArtistsRules<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>spark<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">object</span> RuleApplierJob <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> joinTracksWithArtists<span class=\"token punctuation\">(</span>tracks<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Track<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> artists<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Artist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span>\n  tracks<span class=\"token punctuation\">.</span>joinWith<span class=\"token punctuation\">(</span>artists<span class=\"token punctuation\">,</span> tracks<span class=\"token punctuation\">(</span><span class=\"token string\">\"artistId\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> artists<span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"inner\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> joinTracksAndArtistsWithLabels<span class=\"token punctuation\">(</span>tracksWithArtists<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> labels<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>spark<span class=\"token operator\">:</span> SparkSession<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">import</span> <span class=\"token namespace\">spark<span class=\"token punctuation\">.</span>implicits</span><span class=\"token punctuation\">.</span>_\n  tracksWithArtists<span class=\"token punctuation\">.</span>joinWith<span class=\"token punctuation\">(</span>labels<span class=\"token punctuation\">,</span> $<span class=\"token string\">\"_1.labelId\"</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> labels<span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"inner\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>map <span class=\"token punctuation\">{</span> <span class=\"token keyword\">case</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span> <span class=\"token keyword\">=&gt;</span> <span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> applyArtistsAndLabelsRules<span class=\"token punctuation\">(</span>tracksWithArtistsAndLabels<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">,</span> Label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> artistAndLabelRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtistAndLabel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>spark<span class=\"token operator\">:</span> SparkSession<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">import</span> <span class=\"token namespace\">spark<span class=\"token punctuation\">.</span>implicits</span><span class=\"token punctuation\">.</span>_\n  tracksWithArtistsAndLabels\n    <span class=\"token punctuation\">.</span>joinWith<span class=\"token punctuation\">(</span>artistAndLabelRules<span class=\"token punctuation\">,</span> tracksWithArtistsAndLabels<span class=\"token punctuation\">(</span><span class=\"token string\">\"_2.name\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> artistAndLabelRules<span class=\"token punctuation\">(</span><span class=\"token string\">\"artist\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>\n      tracksWithArtistsAndLabels<span class=\"token punctuation\">(</span><span class=\"token string\">\"_3.name\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> artistAndLabelRules<span class=\"token punctuation\">(</span><span class=\"token string\">\"label\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"left_outer\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>map <span class=\"token punctuation\">{</span> <span class=\"token keyword\">case</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> artistAndLabelRule<span class=\"token punctuation\">)</span> <span class=\"token keyword\">=&gt;</span> <span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">(</span>artistAndLabelRule<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">.</span>empty<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> applyArtistRules<span class=\"token punctuation\">(</span>tracksWithRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">,</span> Label<span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">[</span>MappingRuleArtistAndLabel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> artistRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>spark<span class=\"token operator\">:</span> SparkSession<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">import</span> <span class=\"token namespace\">spark<span class=\"token punctuation\">.</span>implicits</span><span class=\"token punctuation\">.</span>_\n  tracksWithRules\n    <span class=\"token punctuation\">.</span>joinWith<span class=\"token punctuation\">(</span>artistRules<span class=\"token punctuation\">,</span> tracksWithRules<span class=\"token punctuation\">(</span><span class=\"token string\">\"_2.name\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span><span class=\"token operator\">=</span> artistRules<span class=\"token punctuation\">(</span><span class=\"token string\">\"artist\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"left_outer\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>map <span class=\"token punctuation\">{</span> <span class=\"token keyword\">case</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> maybeArtistAndLabelRule<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> ruleArtist<span class=\"token punctuation\">)</span> <span class=\"token keyword\">=&gt;</span> <span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> maybeArtistAndLabelRule<span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">(</span>ruleArtist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> convertToTrackWithAppliedRule<span class=\"token punctuation\">(</span>tracksWithRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">,</span> Label<span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">[</span>MappingRuleArtistAndLabel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>spark<span class=\"token operator\">:</span> SparkSession<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">import</span> <span class=\"token namespace\">spark<span class=\"token punctuation\">.</span>implicits</span><span class=\"token punctuation\">.</span>_\n  tracksWithRules<span class=\"token punctuation\">.</span>map <span class=\"token punctuation\">{</span> <span class=\"token keyword\">case</span> <span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> artist<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> maybeArtistAndLabelRule<span class=\"token punctuation\">,</span> maybeArtistRule<span class=\"token punctuation\">)</span> <span class=\"token keyword\">=&gt;</span>\n    TrackWithAppliedRule<span class=\"token punctuation\">(</span>\n      track<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n        track<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n        artist<span class=\"token punctuation\">,</span>\n        label<span class=\"token punctuation\">,</span>\n        maybeArtistAndLabelRule<span class=\"token punctuation\">.</span>orElse<span class=\"token punctuation\">(</span>maybeArtistRule<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>map<span class=\"token punctuation\">(</span>r <span class=\"token keyword\">=&gt;</span> AppliedRule<span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>ruleType<span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>If you want to avoid passing around these gigantic dataset types with lots of tuples, there are basically two approaches to deal with these types of intermediate state:</p> \n<ul> \n <li>Defining basic alias types</li> \n <li>Wrapping them in case classes</li> \n</ul> \n<p>In our case, let’s go with the first approach and define some alias types to pass around:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\"> \n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">type</span> TracksWithArtists <span class=\"token operator\">=</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">type</span> TracksWithArtistsAndLabels <span class=\"token operator\">=</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">,</span> Label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">type</span> TracksWithRules <span class=\"token operator\">=</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">,</span> Label<span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">[</span>MappingRuleArtistAndLabel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code></pre> \n</div> \n<p>There are still some nuances in this code that are worth elaborating on.</p> \n<ul> \n <li>All of these small functions need to be defined in the companion object instead of in the class itself. The reason is simple: If they are defined in the class, it will cause Spark to try to serialize the entire class, and that will lead to the infamous <a href=\"https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/TaskNotSerializableException.scala\"><code class=\"language-text\">TaskNotSerializableException</code></a> once the <code class=\"language-text\">SparkSession</code> object is not serializable.</li> \n <li>Because Spark needs default encoders provided as implicit parameters by the <code class=\"language-text\">SparkSession</code> instance, the <code class=\"language-text\">SparkSession</code> needs to be passed to pretty much all of the internal functions.</li> \n</ul> \n<p>Another point that plays on our side to help with the refactoring is the fact that the types of each one of the functions align perfectly (with exception of the <code class=\"language-text\">SparkSession</code>), i.e. the output of one function is the input of the next one:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/f3ae4/creating-readable-spark-jobs-function-pipeline.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 49.689991142604065%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABsklEQVQoz2VSi26jMBDk/7+tUtUmKRBI0kR58KZAeNnYc7PucVepjkZjdsN4drBXVRWyLEOSJI6LsnCcpgnKMkdZ5XxO8HhcyTVuN+B4Au53/FrWWng/C8YYmMXCGss9oBWhAUUMg3VYpG9n9mdM04SREBYxWd4wDAgCnwgRHyPs4neHbXTGyybBuy+OLR0C5zPwoLOyqFEUJfKM7tOMnPGg5VtQlDVtyCmalmbNE+cRahkwmw6jbrkfoc3Avy+wUDCOjfvR7++Rm6aB7/vY7XbkAAGx/dhgu38j6DjaOAQHH/tP9qI3bNiLjlscw1fkpwhDXTlpb81uzeBfnnKisP0LSJYLFkKrb9iFVcIqBRf6OrKstm1xuVxwvV5RkZswxNd+j5H59Pcb6jhGx5uQpinzK5DnubsZKfs580xYr+v6v6CMLWJyZQY2u/iA9nDA3LTQ84yFMAxeMW9NN0r2dCaQb7Cyt4YpS76UCH/Rbd11qMgl72lPR0+6mbjXrI90NxE9+8++R0fuWJf3ncNVUEaJogifpxNijhhybIlh4ihTWTpWfFmEBR2fu+fTxSUQh38AKE385P8ty0EAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"creating readable spark jobs function pipeline\" title=\"creating readable spark jobs function pipeline\" src=\"https://developers.soundcloud.com/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/8ff1e/creating-readable-spark-jobs-function-pipeline.png\" srcset=\"/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/9ec3c/creating-readable-spark-jobs-function-pipeline.png 200w,\n/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/c7805/creating-readable-spark-jobs-function-pipeline.png 400w,\n/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/8ff1e/creating-readable-spark-jobs-function-pipeline.png 800w,\n/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/6ff5e/creating-readable-spark-jobs-function-pipeline.png 1200w,\n/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/2f950/creating-readable-spark-jobs-function-pipeline.png 1600w,\n/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/f3ae4/creating-readable-spark-jobs-function-pipeline.png 2258w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>So we have a scenario that function composition is almost 100 percent a good fit, except for the annoyance of also having to pass the <code class=\"language-text\">SparkSession</code> around to almost all the functions. Having said that, it looks like this situation would allow the creation of a pipeline of functions if we could somehow inject the <code class=\"language-text\">SparkSession</code> dependency when we want to execute it instead of providing it to each function call. This seems to be a good fit for the <a href=\"http://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-Reader.html\">Reader Monad</a> pattern:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">  \"The Reader monad represents a computation, which can read values from a\n  shared environment, pass values from function to function, and execute\n  sub-computations in a modified environment.\"</code></pre> \n</div> \n<p>This is also a perfect fit for our scenario, as each function needs to read a value (<code class=\"language-text\">SparkSession</code>) from a shared environment in order to perform its computation and return its value. Both <a href=\"http://eed3si9n.com/learning-scalaz/Reader.html\">Scalaz</a> and <a href=\"https://typelevel.org/cats/datatypes/kleisli.html\">Cats</a> provide implementations of the Reader Monad. In our case, we’ll be using Cats, as it’s already part of the project we were working on, but the implementation would be quite similar with Scalaz. Here’s how the final version would look:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\"> \n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">cats<span class=\"token punctuation\">.</span>data</span><span class=\"token punctuation\">.</span>Reader\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>spark<span class=\"token punctuation\">.</span>sql</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">{</span>Dataset<span class=\"token punctuation\">,</span> SparkSession<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> RuleApplierJob<span class=\"token punctuation\">(</span>spark<span class=\"token operator\">:</span> SparkSession<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">import</span> RuleApplierJob<span class=\"token punctuation\">.</span>_\n\n  <span class=\"token keyword\">def</span> run<span class=\"token punctuation\">(</span>tracks<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Track<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          artists<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Artist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          labels<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          artistsAndLabelsRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtistAndLabel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n          artistRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>TrackWithAppliedRule<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span>\n  joinTracksWithArtists<span class=\"token punctuation\">(</span>tracks<span class=\"token punctuation\">,</span> artists<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>flatMap<span class=\"token punctuation\">(</span>joinTracksAndArtistsWithLabels<span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>flatMap<span class=\"token punctuation\">(</span>applyArtistsAndLabelsRules<span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> artistsAndLabelsRules<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>flatMap<span class=\"token punctuation\">(</span>applyArtistRules<span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> artistRules<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>flatMap<span class=\"token punctuation\">(</span>convertToTrackWithAppliedRule<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>spark<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">object</span> RuleApplierJob <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">type</span> TracksWithArtists <span class=\"token operator\">=</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">type</span> TracksWithArtistsAndLabels <span class=\"token operator\">=</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">,</span> Label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">type</span> TracksWithRules <span class=\"token operator\">=</span> Dataset<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>Track<span class=\"token punctuation\">,</span> Artist<span class=\"token punctuation\">,</span> Label<span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">[</span>MappingRuleArtistAndLabel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> Option<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> joinTracksWithArtists<span class=\"token punctuation\">(</span>tracks<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Track<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> artists<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Artist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Reader<span class=\"token punctuation\">[</span>SparkSession<span class=\"token punctuation\">,</span> TracksWithArtists<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> _ <span class=\"token keyword\">=&gt;</span>\n    <span class=\"token comment\">// same as previous listing</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> joinTracksAndArtistsWithLabels<span class=\"token punctuation\">(</span>tracksWithArtists<span class=\"token operator\">:</span> TracksWithArtists<span class=\"token punctuation\">,</span> labels<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>Label<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Reader<span class=\"token punctuation\">[</span>SparkSession<span class=\"token punctuation\">,</span> TracksWithArtistsAndLabels<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> spark <span class=\"token keyword\">=&gt;</span>\n    <span class=\"token comment\">// same as previous listing</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> applyArtistsAndLabelsRules<span class=\"token punctuation\">(</span>tracksWithArtistsAndLabels<span class=\"token operator\">:</span> TracksWithArtistsAndLabels<span class=\"token punctuation\">,</span> artistAndLabelRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtistAndLabel<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Reader<span class=\"token punctuation\">[</span>SparkSession<span class=\"token punctuation\">,</span> TracksWithRules<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> spark <span class=\"token keyword\">=&gt;</span>\n    <span class=\"token comment\">// same as previous listing</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> applyArtistRules<span class=\"token punctuation\">(</span>tracksWithRules<span class=\"token operator\">:</span> TracksWithRules<span class=\"token punctuation\">,</span> artistRules<span class=\"token operator\">:</span> Dataset<span class=\"token punctuation\">[</span>MappingRuleArtist<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Reader<span class=\"token punctuation\">[</span>SparkSession<span class=\"token punctuation\">,</span> TracksWithRules<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> spark <span class=\"token keyword\">=&gt;</span>\n    <span class=\"token comment\">// same as previous listing</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">def</span> convertToTrackWithAppliedRule<span class=\"token punctuation\">(</span>tracksWithRules<span class=\"token operator\">:</span> TracksWithRules<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Reader<span class=\"token punctuation\">[</span>SparkSession<span class=\"token punctuation\">,</span> Dataset<span class=\"token punctuation\">[</span>TrackWithAppliedRule<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> spark <span class=\"token keyword\">=&gt;</span>\n    <span class=\"token comment\">// same as previous listing</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>As seen above, instead of each function returning only its desired type, it returns a <code class=\"language-text\">Reader</code> that produces a type given a <code class=\"language-text\">SparkSession</code>. Reader Monads are composable, so the functions can be aligned after each other, thereby creating a pipeline of functions, and only when this pipeline is triggered does the external dependency (<code class=\"language-text\">SparkSession</code> in this case) need to be provided. The code above is much cleaner and easier to reason about! Even a newcomer to this codebase would be able to easily understand what’s going on here.</p> \n<p>Another approach to compose the functions would be using a <a href=\"https://docs.scala-lang.org/tour/for-comprehensions.html\"><code class=\"language-text\">for comprehension</code></a> instead of <code class=\"language-text\">flatMap</code>. Both approaches work and are quite similar, with the disadvantage that in this specific use case, one will need to give names to the intermediate values in the <code class=\"language-text\">for comprehension</code> solution.</p> \n<p>For completeness, it’s worth mentioning that <a href=\"https://docs.scala-lang.org/tour/implicit-parameters.html\">implicit parameters</a> could also be used to pass the <code class=\"language-text\">SparkSession</code> around, but I find that less readable and a little bit harder to reason about, as the dependencies are not very clear. Having said that, it might be a better approach in some scenarios, such as that of an external library, and it’s also a matter of preference/style.</p> \n<p>For the sake of simplicity, I decided to keep all the functions inside the same companion object, but you could also create a dedicated object for each of them instead, and the solution would end up being pretty much the same.</p> \n<h2>Conclusion</h2> \n<p>As companies write more and more Spark code in Scala, it’s important that we strive to bring more functional aspects to this codebase. In addition to looking for opportunities to apply these concepts as shown in this article, frameworks like <a href=\"https://github.com/typelevel/frameless\">Frameless</a> are also working toward creating more expressive DSLs to work with Spark, so it’s worth keeping an eye on those as well.</p>","descriptionType":"html","publishedDate":"Mon, 06 Aug 2018 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/8ff1e/creating-readable-spark-jobs-function-pipeline.png","linkMd5":"4c7f961445a7d3da14be7437048a8db2","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn85@2020_4/2020/08/25/00-49-38-584_8ff8f1bbacbb3954.webp","destWidth":800,"destHeight":398,"sourceBytes":35871,"destBytes":39586,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/8ff1e/creating-readable-spark-jobs-function-pipeline.png":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn85@2020_4/2020/08/25/00-49-38-584_8ff8f1bbacbb3954.webp"},"publishedOrCreatedDate":1598316569979},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Inside a SoundCloud Microservice","link":"https://developers.soundcloud.com/blog/inside-a-soundcloud-microservice","description":"<p>If you’re a regular visitor to this blog, you might be aware that we have been transitioning to a microservices based architecture over the past four to five years, as we have shared insights into the process and the related challenges <a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith\">on</a> <a href=\"https://developers.soundcloud.com/blog/synchronous-communication-for-microservices-current-status-and-learnings\">multiple</a> <a href=\"https://developers.soundcloud.com/blog/microservices-and-the-monolith\">occasions</a>. To recap, adopting a microservices architecture has allowed us to regain team autonomy by breaking up our monolithic backend into dozens of decoupled services, each encapsulating a well defined portion of our product domain. Every service is built and deployed individually, communicating with other services over the network via light-weight data interchange formats such as JSON or Thrift. What we haven’t touched on so far is how a microservice at SoundCloud looks backstage.</p> \n<!-- more --> \n<p>The answer is: it depends! A necessary property of a microservices driven architecture is that a microservice represents a unit of encapsulation. As long as there is some well-understood contract in the form of an API that other services can consume, anything else becomes an implementation detail. Consequently, moving between code bases may reveal different languages, stacks, and patterns, and whether this is a blessing or curse is a hotly debated topic for someone else to explore. </p> \n<p>What’s covered in this article is written from the perspective of a single team—the Creators Team—and as such highlights some of the programming patterns that we unilaterally settled on.</p> \n<h2>Your Server as a Function</h2> \n<p>With that out of the way, it might be interesting to know what kinds of services our team owns. Since we’re responsible for anything powering the user-facing products that serve our creators (i.e. musicians and podcasters rather than listeners) the services we build and operate are quite varied: track management, messaging, RSS feed syndication, statistics and APIs powering our mobile app (<a href=\"https://play.google.com/store/apps/details?id=com.soundcloud.creators\">SoundCloud Pulse</a>) are just some examples. All our services are written in Scala and built on top of <a href=\"https://twitter.github.io/finagle/\">Finagle</a> with the help of a few light-weight, shared internal libraries adding support for cross-cutting concerns such as configuration injection, telemetry, and session termination.</p> \n<p>Microservices are often intermediate nodes in a graph of services, acting as façades where an incoming request translates to N outgoing requests upstream, the responses to which are then combined into a single response back downstream to the client. In the fictional scenario illustrated below, ServiceA needs to reach out to and collect responses from ServiceB and ServiceC, which in turn might have more dependencies such as other services, databases, and caches.</p> \n<p><img src=\"https://developers.soundcloud.com/blog/6ce7cbc21f85a59ae3ab7712a969b0c3/microservice_graph.svg\" /></p> \n<p>One solution to this “scatter-gather” problem based on functional programming was pioneered by Twitter and presented in the very approachable paper <a href=\"https://monkey.org/~marius/funsrv.pdf\">Your Server as a Function</a>, which outlines the ideas that eventually materialized in Finagle. Finagle models each node as a pure function from some request to some eventual response:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">class</span> Service<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span>Req<span class=\"token punctuation\">,</span> <span class=\"token operator\">+</span>Rep<span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">(</span>Req <span class=\"token keyword\">=&gt;</span> Future<span class=\"token punctuation\">[</span>Rep<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> </code></pre>\n</div> \n<p>While Finagle does an excellent job at abstracting away the tedious details behind communication protocols, connection management, and concurrency, it does leave us with certain complexities when working with this abstraction. Specifically, we will explore solutions to the following problems:</p> \n<ul> \n <li>How to collect results from multiple service calls into a single data structure</li> \n <li>How to explicitly model failures in a service’s logic layer using Scala’s <a href=\"http://www.scala-lang.org/api/2.11.0/index.html#scala.util.Either\">Either</a> type</li> \n <li>How to bring the above together in a convenient way using monad transformers</li> \n</ul> \n<h2>Parallel Futures</h2> \n<p>The service signature above tells us that we’re dealing with effectful functions: they return <code class=\"language-text\">Future</code>s, not the things we’re actually after. This means we will have to lean on different combinators to extract the desired result. Imagine we want to fetch a track and all user comments it received into some hypothetical <code class=\"language-text\">TrackWithComments</code> object:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">{</span>\n  track <span class=\"token keyword\">&lt;-</span> fetchTrack<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span>\n  comments <span class=\"token keyword\">&lt;-</span> fetchTrackComments<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">yield</span> TrackWithComments<span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> comments<span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>Scala will desugar for-comprehensions into a combination of <code class=\"language-text\">flatMap</code> and <code class=\"language-text\">map</code> calls, which means that comments will be fetched only after we have retrieved the track. However, these two calls do not depend on each other, so we could run them in parallel instead. There are <a href=\"http://viktorklang.com/blog/Futures-in-Scala-protips-2.html\">documented solutions</a> to the problem of executing Scala futures in parallel in for-comprehensions, but they are non-intuitive and do not clearly express our intent.</p> \n<p>Twitter’s <a href=\"https://twitter.github.io/util/docs/com/twitter/util/Future.html\">Future</a> implementation gives us a powerful combinator, <code class=\"language-text\">join</code>, to solve this problem both more elegantly and explicitly:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">val</span> res<span class=\"token operator\">:</span> Future<span class=\"token punctuation\">[</span>TrackWithComments<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">for</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> comments<span class=\"token punctuation\">)</span> <span class=\"token keyword\">&lt;-</span> Future<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>\n    fetchTrack<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    fetchTrackComments<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span>\n   <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">yield</span> TrackWithComments<span class=\"token punctuation\">(</span>track<span class=\"token punctuation\">,</span> comments<span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>These instructions explicitly encode our intent to obtain a pair of independent values: given <code class=\"language-text\">(Future[A], Future[B])</code> we want <code class=\"language-text\">Future[(A, B)]</code>. Moreover, if either of the original futures fail, the result is a failed <code class=\"language-text\">Future</code>, which allows us to propagate errors as return values instead of throwing exceptions. Looking at this, you might be reminded of database joins: given two tables, the SQL join operator will take the <a href=\"https://en.wikipedia.org/wiki/Cartesian_product\">cartesian product</a> of their rows and return a new table where rows are tuples containing data from both sources.</p> \n<p>In distributed systems where data crosses network boundaries frequently, failure is expected and should be embraced. We will now explore how we represent failure as a first class concept in our systems, without error handling ever getting in the way of productivity. We accomplish this by using Scala’s <code class=\"language-text\">Either</code> class, a return type that allows us to focus on the “happy path”.</p> \n<h2>Down The Future Stack</h2> \n<p><code class=\"language-text\">Future</code>s are internally represented by the <a href=\"https://twitter.github.io/util/docs/com/twitter/util/Try$.html\">Try</a> structure. <code class=\"language-text\">Try[A]</code> is a <a href=\"https://en.wikipedia.org/wiki/Tagged_union\">union type</a>, which can be either successful (carrying a value of <code class=\"language-text\">A</code>) or failed (carrying an exception.) Exceptions are well suited to dealing with operational issues such as I/O failures, runtime platform errors, and unmet system expectations, but when it comes to representing failures in our problem domain, we avoid using exceptions. This is because logical failures in an application are best represented by proper values, and their presence should be made explicit in the type system instead of disappearing from plain view in unchecked exceptions. The upshot is that any service call in the logic layer of our systems returns a type that can either be a success or a failure:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">def</span> fetchTrack<span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Future<span class=\"token punctuation\">[</span>Either<span class=\"token punctuation\">[</span>ApplicationError<span class=\"token punctuation\">,</span> Track<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span></code></pre>\n</div> \n<p>where <code class=\"language-text\">ApplicationError</code> is a union type of possible things that can go wrong. For instance, we can define errors like the following:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">sealed</span> <span class=\"token keyword\">trait</span> ApplicationError\n<span class=\"token keyword\">case</span> <span class=\"token keyword\">object</span> NotFound <span class=\"token keyword\">extends</span> ApplicationError\n<span class=\"token keyword\">case</span> <span class=\"token keyword\">object</span> AccessDenied <span class=\"token keyword\">extends</span> ApplicationError\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre>\n</div> \n<p>Using <code class=\"language-text\">Either</code> as the return type instead of a <code class=\"language-text\">Track</code> directly states that any call to <code class=\"language-text\">fetchTrack</code> will return either a valid track, or a “not found” error, or an “access denied” error, but not all, meaning all possible outcomes are explicit in the function type, and must be dealt with accordingly. <code class=\"language-text\">Future</code> is already a functor so it comes with the <code class=\"language-text\">map</code> combinator defined, which allows us to focus on the happy path and “dive into” a successful <code class=\"language-text\">Future</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token comment\">// only executes the lambda if the Future was successful</span>\nfetchTrack<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span> map <span class=\"token punctuation\">{</span> trackOrError <span class=\"token keyword\">=&gt;</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">}</span> </code></pre>\n</div> \n<p>However, <code class=\"language-text\">fetchTrack</code> now returns an <code class=\"language-text\">Either</code> value, not a track. We would ideally like to map <code class=\"language-text\">trackOrError</code> again to continue following the happy path, but indeed this only works as of Scala 2.12. In Scala 2.11 or older (which is what our systems are deployed with), <code class=\"language-text\">Either</code> is not “biased” toward either of the outcomes it captures (in our case an <code class=\"language-text\">ApplicationError</code> or <code class=\"language-text\">Track</code>), so no functor instance is defined that allows us to focus on the happy path. Fortunately, we found a solution in Typelevel’s <a href=\"http://typelevel.org/cats/\">Cats</a> library, which compresses an enormous amount of utility into a small library. Let’s check it out!</p> \n<h2>Catnip’ed</h2> \n<p>Cats is not a reference to the furry animal but is short for “categories”, a nod to the branch of mathematics that studies structure in mathematics itself. It turns out that category theory is concerned with abstractions that are extremely useful when working with strongly typed languages. Specifically, category theory provides us with “blueprints” or “recipes” for the traversal and transformation of types in ways that are provably correct. One such recipe is encoded in the <a href=\"http://typelevel.org/cats/typeclasses/functor.html\">Functor</a> type class, which allows us to turn any type constructor into a functor, given some rules are obeyed. Cats already provides a functor instance for Scala’s <code class=\"language-text\">Either</code> type, so we can now <code class=\"language-text\">map</code> over <code class=\"language-text\">Either</code>s:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">def</span> fetchTrack<span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Future<span class=\"token punctuation\">[</span>Either<span class=\"token punctuation\">[</span>ApplicationError<span class=\"token punctuation\">,</span> Track<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span></code></pre>\n</div> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\">fetchTrack<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span> map <span class=\"token punctuation\">{</span> trackOrError <span class=\"token keyword\">=&gt;</span> trackOrError map <span class=\"token punctuation\">{</span> track <span class=\"token keyword\">=&gt;</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>The drawback of nesting effects is that we now have two levels of machinery: <code class=\"language-text\">Future</code> and <code class=\"language-text\">Either</code>, which have to be dealt with separately. This makes it cumbersome to get our hands on a track. Ideally we want a functor instance which folds both into one: if the <code class=\"language-text\">Future</code> succeeds, and the <code class=\"language-text\">Either</code> contains a “happy outcome”, then map the result. It turns out that Cats provides precisely such an abstraction: it’s called a monad transformer, and for <code class=\"language-text\">Either</code> it’s called <code class=\"language-text\">EitherT</code>. In our case specifically, since we’re always dealing with <code class=\"language-text\">Future</code>s and <code class=\"language-text\">ApplicationError</code>s, we decided to glue these together into a compact internal library written on top of <code class=\"language-text\">EitherT</code> to model results of any computation in our systems. We call it Outcome.</p> \n<h2>The Final Outcome</h2> \n<p>Outcome is a set of type aliases and type converters that bind together <code class=\"language-text\">Future</code> and a well thought out <code class=\"language-text\">ApplicationError</code> hierarchy (with broad applicability to most or all our services) using Cats’ <code class=\"language-text\">EitherT</code> type:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">type</span> OutcomeF<span class=\"token punctuation\">[</span>A<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> EitherT<span class=\"token punctuation\">[</span>Future<span class=\"token punctuation\">,</span> ApplicationError<span class=\"token punctuation\">,</span> A<span class=\"token punctuation\">]</span></code></pre>\n</div> \n<p>This definition allows us to specify return types in a compact fashion while maintaining our focus on the happy path:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">def</span> fetchTrack<span class=\"token punctuation\">(</span>trackId<span class=\"token operator\">:</span> <span class=\"token builtin\">Long</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> OutcomeF<span class=\"token punctuation\">[</span>Track<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span><span class=\"token operator\">?</span></code></pre>\n</div> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\">fetchTrack<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span> map <span class=\"token punctuation\">{</span> track <span class=\"token keyword\">=&gt;</span> track<span class=\"token punctuation\">.</span>title <span class=\"token punctuation\">}</span> <span class=\"token comment\">// works!</span></code></pre>\n</div> \n<p>We can also recover from potential errors:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\">fetchTrack<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span> map <span class=\"token punctuation\">{</span> track <span class=\"token keyword\">=&gt;</span> track<span class=\"token punctuation\">.</span>title <span class=\"token punctuation\">}</span> recover <span class=\"token punctuation\">{</span> \n  <span class=\"token keyword\">case</span> NotFound <span class=\"token keyword\">=&gt;</span> <span class=\"token string\">\"(unknown)\"</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>In fact, we have recover clauses like these in all our request handlers, so we can easily map a <code class=\"language-text\">NotFound</code> error to an HTTP 404 response code. But that’s not all. You may recall from above how <code class=\"language-text\">Future.join</code> can flip futures inside out. Using the <code class=\"language-text\">EitherT</code> transformer, we can do the same for outcomes:</p> \n<div class=\"gatsby-highlight\" data-language=\"scala\">\n <pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">val</span> trackWithComments<span class=\"token operator\">:</span> OutcomeF<span class=\"token punctuation\">[</span>TrackWithComments<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> \n        <span class=\"token punctuation\">(</span>fetchTrack<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span>@<span class=\"token operator\">|</span> fetchTrackComments<span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>map<span class=\"token punctuation\">(</span>TrackWithComments<span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>Here, <code class=\"language-text\">|@|</code> is the product combinator of Cats’ <a href=\"http://eed3si9n.com/herding-cats/Cartesian.html\">Cartesian</a> type which joins outcomes into a tuple of values without stepping out of the “outcome context”. We can then conveniently map this tuple onto a properly named data structure.</p> \n<h2>Summary</h2> \n<p>We started out by exploring what makes writing microservices challenging. The frequent crossing of network boundaries requires us to deal with asynchronous, error prone operations. We furthermore pointed out that we draw a sharp distinction between operational errors and those arising in our product domain. To deal with the latter, we used Scala’s <code class=\"language-text\">Either</code> type, leaving us with more explicit but verbose service function calls. Finally we revealed how Cats can restore compactness of service function calls via <code class=\"language-text\">EitherT</code> and <code class=\"language-text\">Cartesian</code>, and how we capture their functionality in a convenient type alias: <code class=\"language-text\">OutcomeF</code>. We barely scratched the surface of Cats in this article, it provides a wealth of utility when opting for a more functional style of programming. However, we hope we could give you a glimpse at the patterns you would find in a typical Scala code base in SoundCloud’s Creators Team and hope they may turn out as useful for you as they did for us.</p> \n<p>Until next time!</p> \n<p><strong>Matthias and the Creators Team</strong></p>","descriptionType":"html","publishedDate":"Fri, 28 Jul 2017 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/6ce7cbc21f85a59ae3ab7712a969b0c3/microservice_graph.svg","linkMd5":"345279736b0b6d64e3b17757d12d615d","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn74@2020_3/2020/08/25/00-49-37-643_cc75cd744155aaba.svg","destWidth":0,"destHeight":0,"sourceBytes":19968,"destBytes":19968,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/6ce7cbc21f85a59ae3ab7712a969b0c3/microservice_graph.svg":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn74@2020_3/2020/08/25/00-49-37-643_cc75cd744155aaba.svg"},"publishedOrCreatedDate":1598316569977},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Engineering Levels at SoundCloud","link":"https://developers.soundcloud.com/blog/engineering-levels","description":"<p>An absolutely crucial part of the experience of being an engineer at SoundCloud is learning and growing as a person. Pretty much everyone we hire mentions this aspect as one of their main motivations for joining the company. And while retaining highly talented and motivated people and helping them develop is naturally valuable for SoundCloud as a company, it’s also profoundly beneficial for the employees themselves.</p> \n<!-- more --> \n<p>Internally, we have programs that exist to help our engineers grow. These include providing a budget for conferences and courses, organizing tech talks and meetups, and coordinating with external experts to host special workshops. We put a lot of effort into creating an environment where people are encouraged to improve. It’s a mindset — part of our culture. We keep leveling up everything: ourselves, our teams, our systems, our processes. Every day is an opportunity to make something work a bit better.</p> \n<p>The other side of this story is that SoundCloud also has to recognize this growth. We want to embrace people who are making great progress, and we also want to make sure we keep paying them fairly as their market value grows alongside their skills and expertise.</p> \n<h2>Why Do We Have Levels?</h2> \n<p>To provide clarity on what our understanding of growth is, we have a level system (as many other companies do). This system defines our engineering culture by giving guidance to people on how to increase their impact within SoundCloud, facilitating career discussions between engineers and their managers, providing a framework for setting salaries, and last but not least, encouraging and rewarding certain behaviors.</p> \n<p>Transparency around everyone’s level at a company helps people identify their role models. Additionally, an explicit level structure is beneficial for people who are underrepresented, as non-explicit hierarchies tend to favor the people who form the majority (which, most of the time, is white men).</p> \n<h2>How Do We Set Levels and How Do We Use Them?</h2> \n<p>Our leveling process begins as early as a prospective new employee’s interviews. There are three key factors that help us assess the proper level someone enters the company at. We start with their past experience — how long they have been in the industry and what kind of companies they have worked for. Second, we review the interview panel’s feedback, which helps us understand how the candidate could contribute to the team. Finally, we take into consideration a candidate’s personal assessment of which level they belong at.</p> \n<p>With every candidate, we actively work against any unconscious biases to ensure that we make a fair and accurate decision. For example, <a href=\"http://www.pnas.org/content/111/12/4403\">research shows</a> that employers in science tend to underestimate women’s seniority and market value. This is the kind of bias that we are committed to acting against.</p> \n<p>Once someone has joined the company, we set expectations to match their level. It’s important to emphasize that even though being on a higher level comes with a higher salary, it also sets higher expectations.</p> \n<p>When someone has clearly grown, picked up new responsibilities, and through this, increased their impact, they should be promoted to the next level. Currently, we have a process where someone who wants to be promoted puts together a promotion case accompanied by feedback from peers with whom they work closely. People giving feedback are asked to use the document that defines each level to reason about skills and performance. Then a promotion panel, made up of a diverse group of SoundClouders, convenes twice a year to make decisions about each individual case.</p> \n<p>Regardless of an employee’s level, managers regularly meet with engineers in private one-to-one meetings to discuss how they are doing. The content of these discussions is based on the engineering level definitions, and the meetings themselves provide guidance about which areas an engineer is doing well in and where they need to improve. Conversations like this help them to be successful at the company and reach the next level.</p> \n<h2>What Is Expected at Each Level?</h2> \n<p>We have five levels for engineers at SoundCloud. Here is a short summary of them and what they entail:</p> \n<ul> \n <li><strong>Level 1</strong> — The individual scale<br /> Focusing on themselves and improving their own skills. Successfully delivering as part of a team with the help of other team members.</li> \n <li><strong>Level 2</strong> — The team scale<br /> Focusing on their team and improving the team’s efficiency and productivity. Successfully driving a team project.</li> \n <li><strong>Level 3</strong> — The area scale<br /> Focusing on their own team and some neighboring teams and improving collaboration between these teams, e.g. successfully driving a cross-team project.</li> \n <li><strong>Level 4</strong> — The organization scale<br /> Having an impact on the entire engineering organization. Improving efficiency and collaboration across the organization.</li> \n <li><strong>Level 5</strong> — The company scale<br /> Having an impact on the entire company. Driving cross-organization initiatives, and leveling up SoundCloud as a business.</li> \n</ul> \n<p>To create the official descriptions of expectation for an engineer at each level, we collected all the behaviors we desire in an engineer and assigned them to five dimensions:</p> \n<ul> \n <li>Results/Delivery</li> \n <li>Behavior/Mindset</li> \n <li>Tech Skills/Mastery</li> \n <li>Influence/Visibility</li> \n <li>Communication/Collaboration</li> \n</ul> \n<p>It’s important that this list of behaviors is not used as a checklist; one does not need to tick all the boxes to be eligible for a promotion. Additionally, many of them are not explicit expectations, but rather indicators, and we are often convinced that someone has reached a particular level if we see most of these indicators in practice.</p> \n<p>Here is the detailed view of these levels:</p> \n<iframe style=\"width: 100%; height: 400px;\" src=\"https://docs.google.com/spreadsheets/d/e/2PACX-1vRM9ubTFMAG8wktk25l6thTwSHi4b-bc7JD3mPtQ6z0CLF8QwgOtjJcOghds0Bn8bs4EdALVDVgzekg/pubhtml?widget=true&amp;headers=false\"></iframe> \n<hr /> \n<p>We are proud of our engineering culture here at SoundCloud and the many steps we have taken to grow it, and we’ve found that the definitions of our engineering levels are the best way to capture and document it. As our culture evolves, we will continue to update the level definitions in order to reflect these changes. This ensures that we can keep providing our engineers with clear definitions of how to be successful at their jobs.</p>","descriptionType":"html","publishedDate":"Thu, 24 May 2018 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"5a4f67a372b2e3a321395032866e455f","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569978},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Hack Ideas","link":"https://developers.soundcloud.com/blog/hack-ideas","description":"<p>If you are looking for some inspiration for your next weekend hack project, here is a list of ideas that could be built using the SoundCloud platform. Feel free to add your own ideas in the comments!</p> \n<!-- more --> \n<h3>Web</h3> \n<ul> \n <li><strong>Moodboards</strong>: blend available ambient sounds and music from SoundCloud to make ‘moodboards’, e.g. moodboard.com/fire or moodboard.com/forest</li> \n <li><strong>Street musicians of the world</strong>: world map of all the recorded street music on SoundCloud</li> \n <li><strong>Send a sound to a Facebook friend</strong>: simple way to share sounds and recordings to Facebook friends</li> \n <li><strong>Current events</strong>: audio commentary pages of world current events</li> \n <li><strong>Commentary Overlay</strong>: Artist’s audio commentary or audio listener feedback</li> \n <li><strong>Moodline</strong>: record users who move their mouses if they like a part of a track or not. create composites of moodlines.</li> \n <li><strong>Last.fm + SoundCloud</strong>: Enter your last.fm username and get suggestions on who to follow on SoundCloud</li> \n <li><strong>Record a telephone call</strong>: e.g. a prank call recordings</li> \n <li><strong>Moodboards #2</strong>: — layering sounds, innovative interface for blending SoundCloud sounds together in the browser using various HTML5 technology</li> \n <li><strong>Crowdsourced lyrics for sounds</strong></li> \n <li><strong>Crowdsourced book reading</strong></li> \n <li><strong>Rap battle hiphop</strong>: a la <a href=\"http://takesquestions.com\">http://takesquestions.com</a> but for rappers</li> \n <li><strong>“SoundCards”</strong>: Moocards+SoundCloud. Secret track links, invite-codes, waveform-displays and comments on the cards.</li> \n <li>Moodbar analyzer for tracks.</li> \n <li>A standard JS picker UI for SoundCloud tracks from your profile or from the whole site.</li> \n <li><strong>Ingestion-app for SoundCloud</strong>: Uses SoundCloud Connect to bulk add 100s of files over SFTP+manifest xml files (standard ingestion scheme).</li> \n <li><strong>WeFollow tweak</strong> for popular SoundCloud users etc.</li> \n <li>Use the new Mozilla recording API to record and share on SoundCloud</li> \n <li><strong>Download limit monitor</strong>: Check if a track has been uploaded more than expected, if so, disable download</li> \n <li><strong>Rapportive plugin</strong> for GMail.</li> \n <li><strong>Discography</strong>: Turn sets into a discography page with artwork, buy link, cat no etc.</li> \n <li><strong>Slideshare Mashup</strong>: Sync presentation audio recording with the slides. Leverage <a href=\"http://popcornjs.org/\">http://popcornjs.org/</a> ?</li> \n <li><strong>Birthday messages</strong>: Facebook based app to track your friends birthdays and remind you to share an audio greeting with them</li> \n <li><strong>Instagram for Sound</strong>: <a href=\"http://madebymany.com/blog/what-would-instagram-sound-like\">http://madebymany.com/blog/what-would-instagram-sound-like</a></li> \n</ul> \n<h3>Mobile</h3> \n<ul> \n <li><strong>Audiogram</strong>: an Instagram style app to record sounds, applying audio filters and share on SoundCloud</li> \n <li><strong>Personal audio diary</strong>: inspired by the memento/everyday iphone apps</li> \n</ul> \n<h3>Desktop</h3> \n<ul> \n <li>A file system plugin (fuse?) that lets you mount your SoundCloud account and add files to it by dragging and dropping.</li> \n <li>Audio visualizer using timed comments for textual-based artistic visualization at the right point in the sound.</li> \n</ul>","descriptionType":"html","publishedDate":"Sun, 29 May 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"c0c4f32b5c800ccb5510b1d1e0733795","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Garbage Collection in Redux Applications","link":"https://developers.soundcloud.com/blog/garbage-collection-in-redux-applications","description":"<p>The SoundCloud <a href=\"https://blog.soundcloud.com/2017/05/31/get-in-the-game/\">Xbox application</a> is a regular React Redux application that runs in a native web view wrapper on <a href=\"https://docs.microsoft.com/en-us/windows/uwp/xbox-apps/\">Microsoft’s UWP framework</a>. In order to allow users to play music in the background, we also ship a native C++ playback layer with the app. A thin API wrapper allows for communication between the web layer and the native layer.</p> \n<p>Background audio is not the only reason for us to ship a native player; we also have to make sure that our application doesn’t use more than <a href=\"https://docs.microsoft.com/en-us/windows/uwp/xbox-apps/system-resource-allocation\">128 MB</a> when put into background mode. This is because applications with more than 128 MB can get killed by the Xbox application scheduler when it notices that the system or a game needs more memory. Our application shares the 128 MB with the web browser process, so the actual amount of memory someone is allowed to use is much lower than 128 MB.</p> \n<p>The native player we’re using is the same one used in our mobile applications, which means it’s optimized for low memory consumption. Our initial tests, which we ran before we released the application, showed a low-enough memory usage of the application, and we were confident that we would not hit the maximum memory limit anytime soon.</p> \n<h2>The Memory Leak That Was Just a Cache</h2> \n<p>When we ran more memory tests later on, we noticed that our memory consumption for sessions with a use time of more than one hour was steadily growing and never shrinking. As a result, our hunt for a memory leak began. We quickly identified our Redux store as the part of our application that just kept growing, which makes complete sense, since Redux does not define explicit ways to remove parts of the state in order to save memory.</p> \n<p>Just to be clear, I’m not blaming Redux here for clogging up our users’ memory! Memory consumption should not be your concern when you are building a web application, unless you have to work in an environment that is enforcing strict memory limits (like the Xbox application scheduler) or you are building an application that users are spending a lot of time in without reloading the page or closing the app (e.g. in the case of Electron apps).</p> \n<h2>Normalized State</h2> \n<p>Our Redux store is normalized, which means that we organize incoming data into its different type entities instead of keeping nested structures. Working with nested structures can be very tricky — e.g. when you want to propagate changes of an entity. Let’s look at an example:</p> \n<div class=\"gatsby-highlight\" data-language=\"json\">\n <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"playlists\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"p1\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"tracks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"t1\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"t2\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"p2\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"tracks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"t1\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"t3\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>The above code represents a user’s playlists. They have two playlists (<code class=\"language-text\">p1</code> and <code class=\"language-text\">p2</code>) that each have two tracks. <code class=\"language-text\">p1</code> contains tracks <code class=\"language-text\">t1</code> and <code class=\"language-text\">t2</code>, and <code class=\"language-text\">p2</code> contains tracks <code class=\"language-text\">t1</code> and <code class=\"language-text\">t3</code>. If the user now wants to update the title of track <code class=\"language-text\">t1</code>, we have to iterate over all playlists and all tracks in those playlists, because track <code class=\"language-text\">t1</code> might be in other playlists as well. This problem becomes even more complicated if you have other collections of tracks in your Redux store (e.g. a user’s liked tracks), because then you will have to iterate over all track collections in your store to make sure you’re updating the track in all places:</p> \n<div class=\"gatsby-highlight\" data-language=\"json\">\n <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"entities\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"playlists\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"p1\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"p2\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"tracks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"t1\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"t2\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"t3\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>A normalized state like the one above allows for better change propagation because it a) removes duplicates, so you only ever have to change a single object, and b) merges entities from different requests into a single “entities” store so that you don’t have to worry about updating tracks from other collections. In this case, we only have to update the title of the object at <code class=\"language-text\">entities.tracks.t1</code> and it will propagate correctly throughout our entire application.</p> \n<p>Another great property of normalized state is that it becomes trivial to check if you already have a locally cached instance of, for example, a track you want to render. This can decrease the number of requests your application makes by a lot:</p> \n<div class=\"gatsby-highlight\" data-language=\"json\">\n <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"entities\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"playlists\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"p1\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"p2\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"tracks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"playlists\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"p1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"p2\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>In the example above, you can see that our playlist representation now only consists of an array of IDs that “point” to playlist entities.</p> \n<p>If you are interested in learning more about normalization and how to add it to your application, I recommend checking out <a href=\"https://github.com/paularmstrong/normalizr\">normalizr</a>.</p> \n<h2>Garbage Collection in JavaScript</h2> \n<p>In the case of our problem, with every request we made, we were increasing the number of objects in our entities store, and we never removed objects, even if they were no longer needed. Usually in JavaScript, your data gets garbage collected once you remove all references to it (e.g. <code class=\"language-text\">myState = null</code>). In the case where all your data is encapsulated in your React components, garbage collection happens automatically when React unmounts your component. However, when you use Redux, the Redux store will always have a reference to all your data, so it will never get released.</p> \n<p>Another way to free memory in JavaScript is to just reload the page every now and then when you detect that the session is already very long or when a lot of objects have accumulated in your entities store. Of course, this requires that your app be able to reload quickly so that users don’t get frustrated with your site’s performance. Additionally, you should make sure your users are not playing any media, because you really don’t want to interrupt them.</p> \n<p>For our use case, we wanted to save memory for a background-listening experience, so we were not able to just reload the page. We came to the conclusion that we had to build a garbage collector on top of our Redux store to free memory efficiently. However, this is not the first time we’ve had to build a garbage collection algorithm into one of our applications. The main website at <a href=\"https://soundcloud.com\">soundcloud.com</a> has had a garbage collection system built into its model layer from the very beginning. But since the main site is built with Backbone.js, we could not reuse the garbage collecting implementation for the Xbox application.</p> \n<h2>Tracing Garbage Collection</h2> \n<p>When we looked at the different approaches to garbage collection, we saw a striking similarity between how <a href=\"https://en.wikipedia.org/wiki/Tracing_garbage_collection\">tracing garbage collection</a> works and the way Redux works in general.</p> \n<p><img src=\"https://upload.wikimedia.org/wikipedia/commons/4/4a/Animation_of_the_Naive_Mark_and_Sweep_Garbage_Collector_Algorithm.gif\" alt=\"Mark and sweep in a tracing garbage collector\" /></p> \n<p>A tracing garbage collector works in two steps (mark and sweep):</p> \n<ol> \n <li>Mark — This marks objects that still have references.</li> \n <li>Sweep — This scans all objects in memory and removes all the ones that are not marked.</li> \n</ol> \n<p>If we were to implement a garbage collector in Redux this way, we would never be able to remove objects, because there would always be references to all objects. In order to make this concept work, we needed to be able to remove references, and as such, find a way to determine which parts of the state were no longer needed. If we could identify unused state, we could remove the state and all its referenced entities.</p> \n<p>Redux provides, by design, all the tools necessary to identify used and unused state. Each component’s selector function (<code class=\"language-text\">mapStateToProps</code>) tells you which part of the state it needs, so we could use those to keep track of state that was no longer used. The only problem is that we didn’t have a list of all selectors currently onscreen, but that’s exactly where our garbage collector library comes in.</p> \n<h2>Our Redux Garbage Collector</h2> \n<p>The first thing our library does is keep track of selector functions that are currently onscreen. We do this by wrapping our component with a higher-order component that mimics React Redux’s <code class=\"language-text\">connect</code> API:</p> \n<div class=\"gatsby-highlight\" data-language=\"js\">\n <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">mapStateToProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">compose</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>mapStateToProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">lifecycle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Register onscreen selector</span>\n        <span class=\"token function\">registerSelector</span><span class=\"token punctuation\">(</span>mapStateToProps<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Remove onscreen selector</span>\n        <span class=\"token function\">removeSelector</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>(I left the other parameters of <code class=\"language-text\">connect</code> out to shorten the example code.)</p> \n<p>We are using <a href=\"https://github.com/acdlite/recompose\">Recompose</a> to create a composed component that a) connects to the Redux store, and b) registers and removes the selector when the component mounts/unmounts:</p> \n<div class=\"gatsby-highlight\" data-language=\"js\">\n <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> selectors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">registerSelector</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">selectorFn<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">,</span> instance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  selectors<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> selectorFn<span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">,</span> instance <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>In <code class=\"language-text\">registerSelector</code>, we add the selector to our list of onscreen selectors, along with a reference to the passed props and a reference to the component’s instance:</p> \n<div class=\"gatsby-highlight\" data-language=\"js\">\n <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">removeSelector</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">instance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  selectors <span class=\"token operator\">=</span> selectors<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">selector</span> <span class=\"token operator\">=&gt;</span> selector<span class=\"token punctuation\">.</span>instance <span class=\"token operator\">!==</span> instance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>We need the reference to the instance of the component because we use it to remove a selector from the list. It’s important to mention that we need to check against the reference of the component and not against a reference of the selector itself. This is because we want to prevent removing a selector of the component that is going to unmount, regardless of the selector function. Another component — one that is still onscreen — might use the same selector function (by reference), but we want to keep its selector function. If we were to filter by the reference of the component’s selector function, we’d run the risk of removing selectors we still wanted to keep around.</p> \n<p>Right now, we are keeping track of selectors of components that are onscreen. We can use this information to calculate the part of our component’s state that we can remove, but first we have to change our selectors slightly so that we can make sense of the data they return.</p> \n<p>As described before, the bulk of our data is organized in the <code class=\"language-text\">entities</code> part of our Redux store, which is the part of the store we should remove unused objects from. All other parts of the store are only ID references or arrays of ID references, and they are not consuming that much data, so we can keep them.</p> \n<p>However, one problem we’re facing now is that selector functions can return arbitrary shapes of data, and they might aggregate data in a way that does not represent the pure data of the Redux store. One example would be a component that renders the title of a track:</p> \n<div class=\"gatsby-highlight\" data-language=\"js\">\n <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">store<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> trackId <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    title<span class=\"token punctuation\">:</span> store<span class=\"token punctuation\">.</span>entities<span class=\"token punctuation\">.</span>tracks<span class=\"token punctuation\">[</span>trackId<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>title\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>The result of that function would be something like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"json\">\n <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Redbone\"</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>Just looking at this result, the garbage collector will not be able to determine which parts of the state are used to compute the <code class=\"language-text\">title</code>. In order to make sense of a selector’s result, we need it to somehow return its dependencies in addition to its regular result. This is why all garbage collectable selectors have to return data in the following shape:</p> \n<div class=\"gatsby-highlight\" data-language=\"json\">\n <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"result\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Redbone\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"entity\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"track\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"t1\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>The data returned in <code class=\"language-text\">dependencies</code> gives us clear instructions on which type of entity and which instance of this entity this selector depends on. Now, returning this extra metadata from all of your components is pretty tedious, which is why we mainly use these selectors in specialized container components that abstract this extra overhead away for us:</p> \n<div class=\"gatsby-highlight\" data-language=\"jsx\">\n <pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">WithTrack</span></span> <span class=\"token attr-name\">trackId</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>t1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n  (track) =&gt; </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TrackComponent</span></span> <span class=\"token attr-name\">track</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>track<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">WithTrack</span></span><span class=\"token punctuation\">&gt;</span></span></code></pre>\n</div> \n<p>In the above example, <code class=\"language-text\">WithTrack</code> is connected to the Redux store, and it makes sure to return the proper metadata. This removes a lot of the extra overhead created by the garbage collection library.</p> \n<h2>Taking Out the Garbage</h2> \n<p>The actual garbage collection is initiated by a regular Redux action. Let’s call it the <code class=\"language-text\">sweep</code> action since we are now in the sweep phase of the original algorithm:</p> \n<div class=\"gatsby-highlight\" data-language=\"js\">\n <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> action</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token constant\">SWEEP_ACTION_TYPE</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">sweep</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">.</span>selectors<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">combinedReducers</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>The <code class=\"language-text\">sweep</code> action is “intercepted” in our top-level reducer, which passes the action to our sweep reducer:</p> \n<div class=\"gatsby-highlight\" data-language=\"js\">\n <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sweep</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">oldState<span class=\"token punctuation\">,</span> selectors</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> entities <span class=\"token operator\">=</span> selectors\n    <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span><span class=\"token parameter\">dependencies<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> selector<span class=\"token punctuation\">,</span> props <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n        dependencies<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span><span class=\"token function\">selector</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>dependencies<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span><span class=\"token parameter\">newState<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> entity<span class=\"token punctuation\">,</span> id <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span>\n        <span class=\"token punctuation\">(</span>newState<span class=\"token punctuation\">.</span>entities<span class=\"token punctuation\">[</span>entity<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> oldState<span class=\"token punctuation\">.</span>entities<span class=\"token punctuation\">[</span>entity<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>oldState<span class=\"token punctuation\">,</span>\n    entities\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>There are essentially three things happening in our sweep reducer.</p> \n<ol> \n <li>We create a list of all dependencies by iterating over and evaluating all selectors. Here we make use of the stored props as well, because we need to pass them to each selector function in order to get the correct dependencies. When we’re done, we end up with an array that contains the dependencies of all components that are onscreen right now.</li> \n <li>We start off with an empty object and then copy over each required entity from the <code class=\"language-text\">oldState</code> to the <code class=\"language-text\">newState</code> by iterating over the dependencies. The result of this is a fresh entities object that only consists of entities that are required by mounted components. This essentially performs the <code class=\"language-text\">sweep</code> we know from the algorithm, but instead of removing objects from the state, we actually started with a clean state and then added objects to it. Instead of <code class=\"language-text\">mark &amp; sweep</code>, we basically execute a <code class=\"language-text\">mark &amp; keep</code>.</li> \n <li>We return the garbage collected state with the slimmed down <code class=\"language-text\">entities</code> object. Our store now only contains the objects that are necessary to render the current screen.</li> \n</ol> \n<p>Determining when is best to start the garbage collection depends on the nature of your application. Some applications might just do it at a certain interval, some might want to check if they are using a lot of memory, and others might just execute every time the user is moved to a different major screen.</p> \n<h2>Performance</h2> \n<p>We have not observed a slowdown of our application due to our garbage collection process. Our initial thoughts were that components might rerender after garbage collection, but because the state references in the components are the same before and after garbage collection, components do not rerender. The only thing that differentiates garbage collection from any other Redux action is that it will evaluate all the selector functions on top of all reducers. If you keep your <a href=\"https://egghead.io/lessons/react-redux-pure-and-impure-functions\">selector functions pure</a>, you should not see a performance hit.</p> \n<p>You might be thinking to yourself: “Wow, this would really make my application so much more efficient. I will add it right away!!!” Please, before you consider adding a garbage collection process to your application, check if you actually have problems with too-high memory usage. I would argue that 99 percent of Redux applications don’t require a custom garbage collection process, as they’re either too shortlived or they don’t have strict memory restrictions.</p> \n<p>This system is working very well for us and we will keep using it on new applications when needed. We would love to know what you think about our approach if you have dealt with similar problems :)</p>","descriptionType":"html","publishedDate":"Thu, 24 Jan 2019 00:00:00 +0000","feedId":10291,"bgimg":"https://upload.wikimedia.org/wikipedia/commons/4/4a/Animation_of_the_Naive_Mark_and_Sweep_Garbage_Collector_Algorithm.gif","linkMd5":"52715b91b32b85b6f9843f907f39b609","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn57@2020_4/2020/08/25/00-49-37-767_a9ea7d365c2f9428.webp","destWidth":420,"destHeight":321,"sourceBytes":147344,"destBytes":85754,"author":"","articleImgCdnMap":{"https://upload.wikimedia.org/wikipedia/commons/4/4a/Animation_of_the_Naive_Mark_and_Sweep_Garbage_Collector_Algorithm.gif":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn57@2020_4/2020/08/25/00-49-37-767_a9ea7d365c2f9428.webp"},"publishedOrCreatedDate":1598316569974},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Remote device sign-in","link":"https://developers.soundcloud.com/blog/remote-device-sign-in","description":"<h2>A method for signing in to a device that doesn’t have a keyboard</h2> \n<p>When we were developing our SoundCloud app for Xbox One, something became very obvious during usability testing: signing in with a game controller really sucks. Entering text requires navigating a virtual keyboard to individual letters, numbers, and characters one at a time – such a nightmare! Plus, letters, numbers, and special characters are spread across three screens. The more secure your password is, the worse the experience is.</p> \n<p><img src=\"https://developers.soundcloud.com/blog/eb13cfd093ee1597a3acd0c7672fc8de/sc-xbox-password-entry.gif\" alt=\"Entering a password with a game controller using an onscreen keyboard\" /></p> \n<!-- more --> \n<p>We needed a way for people to sign in to the app some other way. Something secure and simple and fast.</p> \n<h2>The solution, in brief</h2> \n<p>The person wants to sign in to SoundCloud on Xbox One. They visit soundcloud.com/activate on another device, such as their phone or laptop, and enter a short code. Boom, they are now signed in to SoundCloud on Xbox One. Magic!</p> \n<p>We needed to consider that the person might initiate this flow on a laptop, tablet or a mobile phone. We hoped to take advantage of the person already being signed in on their second device.</p> \n<h2>How it works</h2> \n<p>Consider a person who has two devices:</p> \n<ul> \n <li>Device A: a game console or a TV or really any device with no keyboard or otherwise awful usability for entering text.</li> \n <li>Device B: a device where it’s easy to enter text, like a phone or a laptop.</li> \n</ul> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/13f2004388594fcc16116f97e5302987/e11df/pairing-illustrations-0.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAAn0lEQVQY06WQwQqEIBRF/f/v6Qf8ADdDoVgbURDRxVgRIU3NzQZXM0LMXTxc3OM7So6beeVcZ7Lv+zMnhDBN0y8GNUznHGOs7/sPnFKKMYKc5xlXlN5XmHPedd0wDOu6nvC2bVprpRSm974OCyGMMdiMTScMk6ZpHjmUUohUtCHYtq2U8no2WZYFCzHHcbTWQqT+YSgUNXL8EXIpldyC37IM0hs2fek7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"A game console with monitor on the left, labelled “A”, and a mobile phone on the right, labelled “B”.\" title=\"A game console with monitor on the left, labelled “A”, and a mobile phone on the right, labelled “B”.\" src=\"https://developers.soundcloud.com/blog/static/13f2004388594fcc16116f97e5302987/8ff1e/pairing-illustrations-0.png\" srcset=\"/blog/static/13f2004388594fcc16116f97e5302987/9ec3c/pairing-illustrations-0.png 200w,\n/blog/static/13f2004388594fcc16116f97e5302987/c7805/pairing-illustrations-0.png 400w,\n/blog/static/13f2004388594fcc16116f97e5302987/8ff1e/pairing-illustrations-0.png 800w,\n/blog/static/13f2004388594fcc16116f97e5302987/e11df/pairing-illustrations-0.png 1000w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>The person wants to be signed in to your service on Device A. The person has Device B nearby.</p> \n<p>The app on Device A requests a short easy-to-read code from your service and displays it along with an easy-to-read URL.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/de58b17e8e6a61d895298deefbfbd4d6/e11df/pairing-illustrations-1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAA7klEQVQY05VQuwqDQBC8//8PSzvFxsZWEDUoKkRRfD+Q+EDwnckZQlBSZIrlltuZ2VmyX9D3fdM0bdvmeb6u6/4bZNu2B0VVVaBhOgxDTdN0XZdleVmWEyFNU9u2oyjCJJmmCT5gdl2HB1rf903TBN913Y8zPFDLshQEgWVZhmHquibQhlUQBKhFUWAiSRJFUe4UwzCAj5l5nvGVZZkoihzH8TwPJ4JgaG4UkiRhCCbwBxOK2MLzPJ8C7TiOjuOoqoqAr8zQxjKouBDyHCEhYRiGZVkgQAVM1DiOzwf7dUn4LxTH2tfLvcnbF/Z/8AQ2zsKjewElYwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"A game console labelled “A” on the left and a web server on the right are having a short dialog. The game console says, “Give me a code, please!” The web server says, “Okay! ABC123”\" title=\"A game console labelled “A” on the left and a web server on the right are having a short dialog. The game console says, “Give me a code, please!” The web server says, “Okay! ABC123”\" src=\"https://developers.soundcloud.com/blog/static/de58b17e8e6a61d895298deefbfbd4d6/8ff1e/pairing-illustrations-1.png\" srcset=\"/blog/static/de58b17e8e6a61d895298deefbfbd4d6/9ec3c/pairing-illustrations-1.png 200w,\n/blog/static/de58b17e8e6a61d895298deefbfbd4d6/c7805/pairing-illustrations-1.png 400w,\n/blog/static/de58b17e8e6a61d895298deefbfbd4d6/8ff1e/pairing-illustrations-1.png 800w,\n/blog/static/de58b17e8e6a61d895298deefbfbd4d6/e11df/pairing-illustrations-1.png 1000w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>The app on Device A polls your service every few seconds to see if the code is associated with a user.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/1af3dd922e401466c29156a301ae649f/e11df/pairing-illustrations-2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAA/0lEQVQY042QOW6EQBBFuf89CIlYoknmBAgiECCGTQz7DPtm7GecWMiBf9Dq6qr6Swuf/8PHicujcBzH60RZlsMw9H1vWVZd12EYRlH0fD6zLHs8HpR0WUjTlIE4juES1nV9v99sdl0HBVyU+75P00Q7CALXdX3f9zyvqqqiKDRNkyRJFEUEBOZQYIiT3jzPcCdJAh2XPM+3bUNgWRZkMXK73WRZVlUVDQFXiqKYpmkYxv1+R/Bnej+BHUiZcRyHk5Zt27quk+478ziOCHK2bYsUwcIT6QnS4oKQWIPr+mGXmgn8NE2DJhFgZJPYsPAjfywfv3Bp84JDWLBGlkv3C7WCwW4IWTPAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"A game console labelled “A” on the left and a web server on the right are having a dialog. The game console says, “What is the status of ABC123?” The web server says, “Not activated.” The game console says, “How about now?” The web server says, “Not activated.” The game console says, “How about now? Any update?” The web server says, “Not activated.”\" title=\"A game console labelled “A” on the left and a web server on the right are having a dialog. The game console says, “What is the status of ABC123?” The web server says, “Not activated.” The game console says, “How about now?” The web server says, “Not activated.” The game console says, “How about now? Any update?” The web server says, “Not activated.”\" src=\"https://developers.soundcloud.com/blog/static/1af3dd922e401466c29156a301ae649f/8ff1e/pairing-illustrations-2.png\" srcset=\"/blog/static/1af3dd922e401466c29156a301ae649f/9ec3c/pairing-illustrations-2.png 200w,\n/blog/static/1af3dd922e401466c29156a301ae649f/c7805/pairing-illustrations-2.png 400w,\n/blog/static/1af3dd922e401466c29156a301ae649f/8ff1e/pairing-illustrations-2.png 800w,\n/blog/static/1af3dd922e401466c29156a301ae649f/e11df/pairing-illustrations-2.png 1000w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>The person pulls Device B from between the couch cushions, opens a browser, and goes to that easy-to-read URL. On Device B, the person might already be signed in to your service. If they aren’t, they either sign in or create an account.</p> \n<p>Once authenticated, the person is prompted to enter the short easy-to-read code.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/686af2fc0c46de5ce22a0bf509175526/e11df/pairing-illustrations-3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAA1ElEQVQY06WQzQqDMBCE8/7vIt70KHjw4g8oRkVFREQUFAwoKtrawdhUSksPncOy+ZLZTEL2T7o/tSwLY2yaJrF1O8R7wtee57mu23XdOI4gaEAopbqum6aZZdm6ruBN09i2nSTJywykqqosy4qi5HkO0ve97/vwB0GAWlUVN4dhiIlpms7zfJrrutY0zTAMSZK4eRgGegixER7RUMGjKCrLEjfjwGnetq0oCsdxLMviIxEbyziOxfO4uW1bJBKcfPswTBQXXgUuILkOfvPvv0T2P/QACODHDhwpu80AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"A web server on the left and a mobile phone labelled “B” on the right are having a dialog. The phone says, “Hey is ABC123 a valid code?” The web server says, “Yes!”\" title=\"A web server on the left and a mobile phone labelled “B” on the right are having a dialog. The phone says, “Hey is ABC123 a valid code?” The web server says, “Yes!”\" src=\"https://developers.soundcloud.com/blog/static/686af2fc0c46de5ce22a0bf509175526/8ff1e/pairing-illustrations-3.png\" srcset=\"/blog/static/686af2fc0c46de5ce22a0bf509175526/9ec3c/pairing-illustrations-3.png 200w,\n/blog/static/686af2fc0c46de5ce22a0bf509175526/c7805/pairing-illustrations-3.png 400w,\n/blog/static/686af2fc0c46de5ce22a0bf509175526/8ff1e/pairing-illustrations-3.png 800w,\n/blog/static/686af2fc0c46de5ce22a0bf509175526/e11df/pairing-illustrations-3.png 1000w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Device B asks your service if the code that was entered is valid. For security reasons (outlined in a later section), the person is asked to confirm that they want to allow Device A to be signed in as them.</p> \n<p>Upon confirmation by the person, Device B updates the code using the authenticated user’s access token, to associate the code with the target user.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/74397e83677fe39912ec67eaa63c47df/e11df/pairing-illustrations-4.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABB0lEQVQY06VQyYqDQBT0/79FPOpRvbgjajSIimsMcUyCGjdwyRQxmGHmOHVout+rqq73iOcfLMuyrisu8zz3fT8MQ9M0XdftXWC7E9vbsizTNG+3G0iXy0VRFFmWNU0zDMNxHNTruq6qCi1d133f/4iLomAYhqIomqajKLrf74IgQM9xnKqqkiSB/fWC67rwCoJgHMe3GH4sy0JAkmSWZRAjSBzH7gv4/HA4QIMpPM8DAV5t277FqKZpijzIOU1TWZb4P8/zJEmOx2MYhlgBOGBer1fbtmGxjU3se9qWBICNFDzPi6KICKfTCY47DS47k/ip3M7H43E+nzELTqTAqnb2LxDPf+AbcJS8agrsyOsAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"A web server on the left and a mobile phone labelled “B” on the right are having a dialog. The phone says, “Someone with access token XYZ2753258 just confirmed ABC123”. The web server says, “I’ll take it from here, thanks!”\" title=\"A web server on the left and a mobile phone labelled “B” on the right are having a dialog. The phone says, “Someone with access token XYZ2753258 just confirmed ABC123”. The web server says, “I’ll take it from here, thanks!”\" src=\"https://developers.soundcloud.com/blog/static/74397e83677fe39912ec67eaa63c47df/8ff1e/pairing-illustrations-4.png\" srcset=\"/blog/static/74397e83677fe39912ec67eaa63c47df/9ec3c/pairing-illustrations-4.png 200w,\n/blog/static/74397e83677fe39912ec67eaa63c47df/c7805/pairing-illustrations-4.png 400w,\n/blog/static/74397e83677fe39912ec67eaa63c47df/8ff1e/pairing-illustrations-4.png 800w,\n/blog/static/74397e83677fe39912ec67eaa63c47df/e11df/pairing-illustrations-4.png 1000w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>At the moment of confirmation, the code is associated with the user. The next time Device A polls, it sees that it can use the code to request an access token for that user. Device A then makes a request for an access token using the code.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/38fbf30a70c481bb27226a36390f8ce5/e11df/pairing-illustrations-5.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABG0lEQVQY02WQyY6CYBCEef/38OgJSLx4gZCJG6tE4TBGhYQ9A7gvzHwDiXGpQ6fTf3VV/S38fuB6vZ5Op8PhsN/vqcfjkcqE5o0pNE3z0yJNU0hVVX212G63tm17nrfZbKjz+dx1XXSjKFoul0EQ3O934XK5lGWZZVld10jcbrdOqKuj0cg0TVSm0ylNGIaDwaDf7/d6vaIoBNiYrNdrKmzCIEkcTHj6buH7/mKxwB/OcDgURVGWZSyFOI4lSULbsixVVUk1m810Xe88WaAyURTFcZzz+czEMIzdbvf/Z/75+C1CpF2tVviQExINQjTs0xPq5WCf1+5icxXWsB2Px5qmTSYTepzfl5snPB4IkiQJV+GWaYs8z58J4A+pFrOppadYPwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"A game console labelled “A” on the left and a web server on the right are having a dialog. The game console says, “What is the status of ABC123?” The web server says, “It’s confirmed!” The game console says, “Great! Please accept ABC123 in exchange for an access token.” The web server says, “Here: 52WTQ710J6”.\" title=\"A game console labelled “A” on the left and a web server on the right are having a dialog. The game console says, “What is the status of ABC123?” The web server says, “It’s confirmed!” The game console says, “Great! Please accept ABC123 in exchange for an access token.” The web server says, “Here: 52WTQ710J6”.\" src=\"https://developers.soundcloud.com/blog/static/38fbf30a70c481bb27226a36390f8ce5/8ff1e/pairing-illustrations-5.png\" srcset=\"/blog/static/38fbf30a70c481bb27226a36390f8ce5/9ec3c/pairing-illustrations-5.png 200w,\n/blog/static/38fbf30a70c481bb27226a36390f8ce5/c7805/pairing-illustrations-5.png 400w,\n/blog/static/38fbf30a70c481bb27226a36390f8ce5/8ff1e/pairing-illustrations-5.png 800w,\n/blog/static/38fbf30a70c481bb27226a36390f8ce5/e11df/pairing-illustrations-5.png 1000w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Et voilà! Now Device A has an access token for the target user. In other words, the person is signed in to Device A as the desired user.</p> \n<p>This pattern is not something we invented. Our flow is influenced by a similar flow used by YouTube on TVs and <a href=\"https://developers.google.com/identity/sign-in/devices\">Google Sign-In for TVs and Devices</a>.</p> \n<h2>Using an authenticated session on Device B</h2> \n<p>This method of signing in means the person does not have to enter their password on Device A. If they are signed in to your service on Device B, it is possible for them to avoid needing to sign in again at all.</p> \n<p>At SoundCloud, we have a web app at soundcloud.com, and we have native apps available for Android and iOS.</p> \n<p>If the person visits soundcloud.com/activate on a laptop, we use our standard means of requiring authentication before showing the prompt for the person to enter the activation code.</p> \n<p>On mobile, we chose to reuse the same “activate” web app opened in a web view in the native app. If the person visits soundcloud.com/activate on a mobile device, we invite them to open our native app. Inside the app, we use our standard means of requiring authentication, and then we open a web view with the user’s access token appended in a URL fragment to an oauth2-style callback web address:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">https://example.com/activate_oauth2_callback#access_token=ACCESS_TOKEN</code></pre> \n</div> \n<p>This allows the web app to get the access token from the URL fragment. We put secrets in a fragment instead of a query parameter so that secrets are not sent to the web server and therefore not stored in the web server logs. This is the recommended way of passing access tokens and other secrets in a web address.</p> \n<p>We also instruct the web app how to display the page using a query parameter:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">https://example.com/activate_oauth2_callback?display=android#access_token=ACCESS_TOKEN</code></pre> \n</div> \n<p>You could of course build this form into your native app directly. We like that our implementation allows us to iterate quickly on this brand new feature. We can easily make security or usability improvements to the interface without shipping a new version of our native apps.</p> \n<h2>Choosing codes that are easy to read</h2> \n<p>You want the code to be as short as possible while still having enough possible codes available so that everyone who wants to sign in at the same time can.</p> \n<p>You also need to have a sparse enough usage of the possible codes such that it is unlikely that a typo will result in the person entering a valid code that has been issued at the same time to someone else.</p> \n<p>Imagine if your codes were one number long, ranging from 0 through 9. The risk of an unnoticed typo is very low, but you could still only issue 10 codes at one time.</p> \n<p>If your codes were two letters long, then you could issue 26 x 26 = 676 codes at the same time. There is now a risk of an unnoticed typo, which means you can’t safely issue all 676 codes at the same time.</p> \n<p>If you use just numbers, and your codes are 6 digits long, then there are one million codes available, assuming you allow leading zeros. Pretty good! That might be enough for your needs.</p> \n<p>If you use just letters, and your codes are 4 letters long, then there just under half a millions codes available. Still pretty good, and the codes are shorter. Not bad!</p> \n<p>If you chose to use a mix of letters and numbers, then do not use characters that are hard to tell apart. Specifically, the letter O and the number 0 are hard to tell apart, as are the letter I and the number 1. Even if you use fonts that make these characters distinct, you should avoid these altogether.</p> \n<p>Definitely don’t use special characters. That’s just asking for usability problems. If you use letters, display the codes in uppercase for readability, but verify the codes with case insensitivity. Our form for entering the code uses CSS to transform the characters into uppercase for ease of entry.</p> \n<p>We chose to use a mix of letters and numbers, and we chose to use 6 characters, which gives us over a billion codes that we can issue at one time. If a billion seems like way more than one needs, read on for further security considerations.</p> \n<h2>Security considerations</h2> \n<p>In its most basic form, this flow has a number of security problems ranging from mild and unlikely to wildly irresponsible. Mitigating these security considerations requires adding details to the basic implementation.</p> \n<h3>Accidentally granting Device A access to the wrong user</h3> \n<p>When the person visits the your service on Device B, a user may already be signed in there. People who share a device, or those with more than one account on your service, may want to sign in with a different user than the one that is currently authenticated. If they are not informed which user is authenticated on Device B, they might accidentally grant Device A access to the wrong user.</p> \n<h4>To mitigate this risk</h4> \n<p>Show the person which user is authenticated on Device B, or display several authenticated users, and allow them to choose which user will be granted access.</p> \n<h3>Accidentally granting access to someone else’s device</h3> \n<p>Imagine that two similar codes, such as XXN and XXM, were issued at the same time. XXN was issued to Device AN and shown to Person N. XXM was issued to Device AM and shown to Person M. Person N is authenticated as User N. If they mistype and enter code XXM before Person M does, then Device AM will become authenticated as User N. Oops!</p> \n<h4>To mitigate this risk</h4> \n<p>Have a big enough range of possible codes that typo collisions are unlikely. If you have very a large range of possible codes, the chances that a typo is also a valid code is very small.</p> \n<p>If possible, collect information from Device A when you create the code that the person could recognize when they are granting access. For example, if the device has a name like “Deejay’s TV”, then collect that from Device A, and show this information to the person when they are confirming that they want to grant the device access. We found that we did not have access to such data on Xbox One, however, so the best we could do was capture the type of device.</p> \n<h3>Using up the possible codes so no one can sign in</h3> \n<p>An attacker could destroy the ability for people to sign in by exhausting all the available codes. If your codes are generated on request, then as your possible codes are being used up, your service may have a near impossible time finding one it can issue.</p> \n<h4>To mitigate this risk</h4> \n<p>Implement a rate limit for creating codes. Limit based on all the facets of the request that you can, such as the IP and any unique device identifier. You will need to investigate to determine what the peak rate would be for legitimate traffic.</p> \n<p>Your codes should expire so you can reuse codes after a time. If you reuse codes, then you need a large enough pool of codes so that you don’t re-issue the same code too soon between uses. Your pool of codes should be able to carry you through at least several days before you need to start re-using them.</p> \n<h3>Guessing codes and using them to get access tokens</h3> \n<p>An attacker could try to poll for random codes, hoping to find one that is activated so they can exchange the code for a user access token.</p> \n<h4>To mitigate this risk</h4> \n<p>You could have such a very large number of possible codes that guessing a valid one is nearly impossible. However, a code that works for a person needs to be short and use a limited character set, and a bot can burn through guessing many codes if they are easy for people.</p> \n<p>You could add rate limiting for polling, and then cross your fingers and hope that you have enough possible codes, and your rate limits are good enough that the attacker won’t be able to guess a valid code while staying within your rate limits. You should add rate limiting for polling, but there is a much more secure way to mitigate this risk.</p> \n<p>When you issue a code, you should also issue a very long, hard to guess polling token. You should require this polling token for unauthenticated requests for the code. You can see this secure feature described in the Google Sign-In for TVs and Devices documentation. They call the easy-to-read code “<code class=\"language-text\">user_code</code>”, and they call the polling token “<code class=\"language-text\">device_code</code>”.</p> \n<h3>Tricking people into giving away access to their account</h3> \n<p>There is a category of attacks where an attacker attempts to influence their victim to take an action that is not in their best interest. These are called “social engineering attacks”.</p> \n<p>For example, the attacker could take advantage of your UI design choices and their ability to supply some aspect of the display text, and use it to trick people into thinking the UI does something different than it does.</p> \n<p>Take this example, where “Deejay’s TV” is an open text field called device_name that is supplied when the code is created:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 506px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/ea8c73f9856fe0af532ed2e8d841c2f4/26532/confirm-naive.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.51778656126483%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAABpElEQVQoz41Ry0rDQBQdFNy5duHOnxBcKNqlH+AHiPgZLgUt+CgUxa0KUnxiW2tRm6bVVtqFdWmfi1ZLBR+TJk1mkutNNDFGqx4uYebee07OSYiu64YNcMFz9YzeQZwlTdM6qirLsiRRRVFUVcUDKjONtdsS4xybOMU1R4I476xVq4KQEJLCZTqVSqVLxdJJ9LhQuBVFMZkQcvlcLB4XEhe5fP4L2fGDqpwzDMIYxz7nHDtoATuaBWbBS9a53lGU78Hc+Z3OZ2ZUxXtwPTDvn3t6ei7e3ZXK5UqlqnY60B1fyJnspZA6xzul9JVSWVZ0C2jS+Anv/4h8t+cA06KW26eXjGlxHN4KbQc3aFuqViqNer31aOK/tvNJUYzGNFVpNuqth/s2fVEkCpx1K4Mz27aj55H/vUwybjXLRnpHz+wa2T0Dn9YBMli7cL0PWaw9V+3DVQhuz5BokQ8WYZiArxfGyUeNEZjsg5kBmB2EqX4YJTBhj3w9MEJgesgm127gcAEiKxBetmsJIqtwugaxIEQDrv6yuXbkh+SmSTY/+p/xumR+A9HlNaoCgKrzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Screenshot. Title: Confirm the activation. Then the word “theophani” with an avatar image beside it, followed by a link symbol, followed by the words “Deejay’s TV”. There is a call-to-action button that says “Confirm”.\" title=\"Screenshot. Title: Confirm the activation. Then the word “theophani” with an avatar image beside it, followed by a link symbol, followed by the words “Deejay’s TV”. There is a call-to-action button that says “Confirm”.\" src=\"https://developers.soundcloud.com/blog/static/ea8c73f9856fe0af532ed2e8d841c2f4/26532/confirm-naive.png\" srcset=\"/blog/static/ea8c73f9856fe0af532ed2e8d841c2f4/9ec3c/confirm-naive.png 200w,\n/blog/static/ea8c73f9856fe0af532ed2e8d841c2f4/c7805/confirm-naive.png 400w,\n/blog/static/ea8c73f9856fe0af532ed2e8d841c2f4/26532/confirm-naive.png 506w\" sizes=\"(max-width: 506px) 100vw, 506px\" loading=\"lazy\" /> </a> </span></p> \n<p>From a design perspective, this UI seems succinct and clear.</p> \n<p>Now imagine an attacker sends a victim an email saying “Visit this URL and enter this code to get a FREE subscription!” When the victim gets to the page and enters the code it looks like this:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 506px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0f2e7215e4132593d5394400b04f1c38/26532/confirm-exploit.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 73.51778656126483%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAAB0ElEQVQoz41Ry07bQBQdFYld112w4yeQuigClnwAH1BVfAZLJIoELVIE6hYqVYhHERACgsZxAomULArLPEggwcQ2ScCOnzNzuQ6xMQEER0f2zJk5d86dIYwx7gNC6Jn2LD2ABJscx7Fs2zAMXddM07RtGwdY2XXcdlt3KUURV3FbUIIEZ1bKZUGICwnhOJVMJlPFQnEvun16eiaKYiIuZHPZ2MGBEP+XzeWemIM8WJVSFxtxXYo6pRQVjICK04HbQa+ZUWaZ5vPGwv0HymPPWBXnkaWF6dmpZrNVyOeLpdL5edm2LHgdT8zpzLGQPMK5pml3mma0DcxMGfMyc858BGc+jMnzeAFo54ZffKSuGbtFdWdl9Xfkl97Wq9XaxWW1VqvKch1/0tWVJEl1Wa5clBVFwSAvxM4lRDEacyxDuZYaqtJU1daNcttsNJQ6EgeqfN26UR3LxLsF6nJkN3aQCt4AD9Mzo1Yv8dQfll7jmXWO3zA95VGEzDpkNuBkFc4O0dgxb36HIQJjfTBCuhwmMN4P3z7B5ABMfIQvBEb9pbEP8JnA10HfXPkPf2dg9wfszPucg92fsL8IsQhEF0L6vLdtaxYSy57Zu/SeZt5Jzu8BXNwyh4mOdnkAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Screenshot. Title: Confirm the activation. Then the word “theophani” with an avatar image beside it, followed by a link symbol, followed by the words “SoundCloud Premium Add-on”. There is a call-to-action button that says “Confirm”.\" title=\"Screenshot. Title: Confirm the activation. Then the word “theophani” with an avatar image beside it, followed by a link symbol, followed by the words “SoundCloud Premium Add-on”. There is a call-to-action button that says “Confirm”.\" src=\"https://developers.soundcloud.com/blog/static/0f2e7215e4132593d5394400b04f1c38/26532/confirm-exploit.png\" srcset=\"/blog/static/0f2e7215e4132593d5394400b04f1c38/9ec3c/confirm-exploit.png 200w,\n/blog/static/0f2e7215e4132593d5394400b04f1c38/c7805/confirm-exploit.png 400w,\n/blog/static/0f2e7215e4132593d5394400b04f1c38/26532/confirm-exploit.png 506w\" sizes=\"(max-width: 506px) 100vw, 506px\" loading=\"lazy\" /> </a> </span></p> \n<p>The attacker has created a code with the device_name “SoundCIoud Premium Add-on”. The design makes it possible to fool people into giving away access to their account.</p> \n<h4>To mitigate this risk</h4> \n<p>Use wording and design elements that make it clear what is happening. Some labels and text might seem redundant in the standard scenario, but are necessary to prevent this type of attack.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 506px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/9d66726967ac1ac4ac9244c609b0d002/26532/confirm-mitigated.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100.59288537549406%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAACXUlEQVQ4y41TzWsTURDPRfAP8CBeehM8CXqwFfFvEBG1HgUFPYgHUUgQz1pMelGooEe9ePQUEQPdqqlbhRZpL8kmGjfJfme/3n6+cd7bzTaaNnV4OzvvMb+Zeb95U0rTlI4FJuSf7cRxLggsTToRLiPbdl03CII4jsMwjKLI9/0gDANCcDsZJgdnEURxQxCEer2+vi5ubW1uiOLHRmNne0dYXV0ThLW1T1+aTToNzgQrwTxpkqARR5HnebiNx8LtZI/M6I0aq9J1HWsejUbWyLL4z3Fcx7bRNC0L8bBf5mnCmKb5nqlJxgrwV7EpfG4QEpgGJrBs285q2U9ycOZUXV6qPXsckLDdanV/dmW5jzc/GFzcOZ7yxm5h52b0Os+8/W3zh/id8lYjbayxQeC4LhJOfOIzIVksQnwkPicsA79defXm+YsoCpRB39S1jtTutFuoux2p1+mgLbWlfu9XV5K67ZZpGLzYcdlRSuNkFkN/lT2mvcShBFwDPBMcndoqGDI1+9ToUeM3mDJqqvM1Uqit86UiBIEc/H4Frh2GG0fh+hG4NQeVBbh3Eh6eg8pZKC9AZR7K8+zw9hxzuHkMrh6Cd9UxWHgNd09A+Qw8OM0A1cvw5ALUrkBtEZYuwtNL7GR5ER6dh/unWKA7x+HDSw4unk7xgOIQkhg1W8yIIOGLpsWdc7bZJPqerqmqqmiqYpmGqmm6hiaeqLphoNY0zTCRY11VhgNZdm17F+y5znA4VPAbDHgQBb2xw6y5vMWu6zAbk3gItKMo3B0MNonY+GL0cPBmvs2Dp+p/wH8AZ21am+uZf7UAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Screenshot. Title: Confirm your device. Subtitle: Sign in to SoundCloud on this device? Then the word “theophani” with an avatar image beside it, followed by a link symbol, followed by the label “Device” and the words “SoundCloud Premium Add-on”. There is a call-to-action button that says “Yes, activate this device”. Under the call-to-action is the following text: “By activating, you allow this device to sign you in. Only activate if you are doing this intentionally. Do not activate if you followed a link someone sent to you.”\" title=\"Screenshot. Title: Confirm your device. Subtitle: Sign in to SoundCloud on this device? Then the word “theophani” with an avatar image beside it, followed by a link symbol, followed by the label “Device” and the words “SoundCloud Premium Add-on”. There is a call-to-action button that says “Yes, activate this device”. Under the call-to-action is the following text: “By activating, you allow this device to sign you in. Only activate if you are doing this intentionally. Do not activate if you followed a link someone sent to you.”\" src=\"https://developers.soundcloud.com/blog/static/9d66726967ac1ac4ac9244c609b0d002/26532/confirm-mitigated.png\" srcset=\"/blog/static/9d66726967ac1ac4ac9244c609b0d002/9ec3c/confirm-mitigated.png 200w,\n/blog/static/9d66726967ac1ac4ac9244c609b0d002/c7805/confirm-mitigated.png 400w,\n/blog/static/9d66726967ac1ac4ac9244c609b0d002/26532/confirm-mitigated.png 506w\" sizes=\"(max-width: 506px) 100vw, 506px\" loading=\"lazy\" /> </a> </span></p> \n<p>When the code is created, you could store the requesting IP or resolved geography, and then provide a warning if the code is entered in suspiciously different geography.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 506px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/56eb450495d9020860d124750176995b/26532/confirm-mitigated-w-warning.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 115.61264822134387%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsSAAALEgHS3X78AAAC20lEQVQ4y41UvU8UURC/lkYr/gRbo8FKCxMTexMLDfiRaG1HoCHRxEYKCRBKE2ksTCwoDYWScEfgPArBjxMucLt73O3u7fd7b793x3m7C7ccYJz73cvMvpn3MfN7U0mSJD0WKMmQWfpcCAZWyk5eJrbjUEp934+iKAiCMAxd1/WDwPc8NMvLFMH5Co3GdrVaXV1drdcbu7s7243G17W15u9mdX29Vq3WahubW1vp2WAejSeJY9wHR0QUBozSMAiiMMzB9SjKPU8HZxJGkWHb1PMdyixCbcpsQonrEeaibhIaxvHQsQGSGEwVHBMcA5gDxAbbAEvnYASoA4YKxOKzCDtDlrMK39dnIO5xCHvQbvJRaHJlfwcOfoHYyr7/gYOffOwcgtTCRTEwP3b2DwPotUGXQenwg2g9kCXoHYLWzXQRNBnkDuC1j0s2uPNQWdOLUJIiuF7fXK998ZhrGoZlmo5tY8KzxCZFek9Q4koFiYLG2/nZuaU3vh+0WvvttnB0dITFgtP7nDJOds6ZeZaNSDIk3D8oWuz8Y2v7++Y3tDkTfZ9Q6jLmOA5jjBLicMIynKJoUpqTdBC88v7Dp3fLyCqtr+KdRVGUREEUBEkUu51OB21BUnpdNCVBsCwLQ/BBFQmLkzSKE/g/OUl7RpLATU05tRQOo5v2xVST0r7AoYnc5LrIp9ANYfSQVxlJMPjzEtyvwJNLMDECz0Zh6jq8uALTN2BqDCavFZgeg+ejMD4CTy/DvQqszB4Hb3zkAS9vw8wteHUHFh/D3AM+IuYfwsI4LEzA4iN4fRdmbnK3yauwtlzQM28L+BATrsRx4CVhkODIFR+RZuAemSf6FdnOG4hpmrrBBduIjiwzLV03EJhY3cAp07Jt00bdUNU+Vm0QjKVTFEVVVUWWtT6KqmkaFtTDymK5GSOEcNXz0BNrjn1h0AyyM8fYJWL+41pcevQXFmyok5zfJs+T3OEvE6MEvYGh5hUAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Screenshot. Title: Confirm your device. Subtitle: Sign in to SoundCloud on this device? Under the title and subtitle is the following text: “Warning: your current IP address is in a different region than the one your activation code was requested in. Only continue if you are trying to sign in to SoundCloud on another device.”\" title=\"Screenshot. Title: Confirm your device. Subtitle: Sign in to SoundCloud on this device? Under the title and subtitle is the following text: “Warning: your current IP address is in a different region than the one your activation code was requested in. Only continue if you are trying to sign in to SoundCloud on another device.”\" src=\"https://developers.soundcloud.com/blog/static/56eb450495d9020860d124750176995b/26532/confirm-mitigated-w-warning.png\" srcset=\"/blog/static/56eb450495d9020860d124750176995b/9ec3c/confirm-mitigated-w-warning.png 200w,\n/blog/static/56eb450495d9020860d124750176995b/c7805/confirm-mitigated-w-warning.png 400w,\n/blog/static/56eb450495d9020860d124750176995b/26532/confirm-mitigated-w-warning.png 506w\" sizes=\"(max-width: 506px) 100vw, 506px\" loading=\"lazy\" /> </a> </span></p> \n<p>Have tight enough expirations on your codes such that this kind of attack would need to occur in a tight time frame. If your codes are only valid for 5 minutes, then the attacker has to find a way to provoke an action from their victim within 5 minutes.</p> \n<h2>Designing and implementing a new authentication flow</h2> \n<p>From the very beginning, we included colleagues from our Security Team to perform a Threat Model analysis. We built out our API design using this analysis as a basis, instead of waiting until later to consider the security implications. During development, we had an eye on how to secure our new feature at all times. We adjusted the graphical interface based on a security review as well.</p> \n<p>Our team really enjoyed thinking through this problem. We were able to make the painful experience of entering text with a game controller seamless for our users. We had a lot of fun delivering a shiny new authentication experience that’s secure and feels like magic.</p>","descriptionType":"html","publishedDate":"Wed, 28 Jun 2017 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/eb13cfd093ee1597a3acd0c7672fc8de/sc-xbox-password-entry.gif","linkMd5":"0e056153e93f7607efe3888e96205d0b","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn98@2020_5/2020/08/25/00-49-39-035_ebd26b8b11b7229e.webp","destWidth":800,"destHeight":450,"sourceBytes":244573,"destBytes":74776,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/eb13cfd093ee1597a3acd0c7672fc8de/sc-xbox-password-entry.gif":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn98@2020_5/2020/08/25/00-49-39-035_ebd26b8b11b7229e.webp","https://developers.soundcloud.com/blog/static/13f2004388594fcc16116f97e5302987/8ff1e/pairing-illustrations-0.png":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn23@2020_3/2020/08/25/00-51-42-563_9914b2a6849ffc11.webp","https://developers.soundcloud.com/blog/static/de58b17e8e6a61d895298deefbfbd4d6/8ff1e/pairing-illustrations-1.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn63@2020_3/2020/08/25/00-51-40-909_171cff27b0ed5f20.webp","https://developers.soundcloud.com/blog/static/1af3dd922e401466c29156a301ae649f/8ff1e/pairing-illustrations-2.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn50@2020_3/2020/08/25/00-51-43-086_83b2c5502232633a.webp","https://developers.soundcloud.com/blog/static/686af2fc0c46de5ce22a0bf509175526/8ff1e/pairing-illustrations-3.png":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn65@2020_6/2020/08/25/00-51-44-410_4ea340f8b32a53fc.webp","https://developers.soundcloud.com/blog/static/74397e83677fe39912ec67eaa63c47df/8ff1e/pairing-illustrations-4.png":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn70@2020_6/2020/08/25/00-51-43-108_7506695b9c64869e.webp","https://developers.soundcloud.com/blog/static/38fbf30a70c481bb27226a36390f8ce5/8ff1e/pairing-illustrations-5.png":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn87@2020_2/2020/08/25/00-51-44-872_6dcaf0ba65958b60.webp","https://developers.soundcloud.com/blog/static/ea8c73f9856fe0af532ed2e8d841c2f4/26532/confirm-naive.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn81@2020_1/2020/08/25/00-51-42-959_c4e74aca3a78a8c0.webp","https://developers.soundcloud.com/blog/static/0f2e7215e4132593d5394400b04f1c38/26532/confirm-exploit.png":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn57@2020_3/2020/08/25/00-51-43-829_fd7d52ac9cf9fb1d.webp","https://developers.soundcloud.com/blog/static/9d66726967ac1ac4ac9244c609b0d002/26532/confirm-mitigated.png":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn35@2020_4/2020/08/25/00-51-42-804_0542dac4f245c246.webp","https://developers.soundcloud.com/blog/static/56eb450495d9020860d124750176995b/26532/confirm-mitigated-w-warning.png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn72@2020_3/2020/08/25/00-51-42-335_c87ea1d79846f3de.webp"},"publishedOrCreatedDate":1598316569991},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Data pipelines with Apache Crunch and Java 8","link":"https://developers.soundcloud.com/blog/data-pipelines-apache-crunch-java-8","description":"<p>With Java 8 now in the mainstream, Scala and Clojure are no longer the only choices to develop readable, functional code for big data technology on the JVM. In this post we see how SoundCloud is leveraging Apache Crunch and the new Crunch Lambda module to do the high-volume data processing tasks which are essential at early stages in our batch data pipeline efficiently, robustly and simply in Java 8.</p> \n<!-- more --> \n<h2>Hadoop MapReduce is not dead</h2> \n<p>It may not be cool or trendy any more, but Hadoop MapReduce (based on the Google <a href=\"http://research.google.com/archive/mapreduce.html\">MapReduce</a> paper from 2004) still has an important role to play in today’s world of big data technology. Whilst <a href=\"http://spark.apache.org/\">Spark</a> captures people’s imagination as a replacement for it, with its interactive response times and suitability for machine learning, it’s not a silver bullet to every batch processing requirement. It can be unstable at times, and uses far more cluster resources (especially memory) than its simpler predecessor. Spark is used in the application domain for products like search, recommendations and classification tasks, but for preparing our datasets for downstream usage, MapReduce still has a huge part to play. It still provides a robust and relatively reliable platform which is ideally suited to transforming, cleaning and partitioning our huge data volumes ready for use by the insights and product engineering teams.</p> \n<h2>Type safety is crucial</h2> \n<p>Working with data at this end of the pipeline has different developer requirements too. Whilst at the application end of the pipeline the workflows are often based on picking out individual fields from the data and aggregating them in various ways (such functionality is well provided on MapReduce by <a href=\"http://hive.apache.org\">Hive</a> and <a href=\"https://github.com/twitter/scalding\">Scalding</a>), at early stages of our pipelines we are working with complete objects with strict schemas to adhere to, so trying to work with a fields-based API would be very dangerous.</p> \n<p>Event data at SoundCloud is stored in the structured binary <a href=\"https://developers.google.com/protocol-buffers/\">Protobuf</a> format, so being able to work directly with Java Protobuf objects rather than an API-specific view saves us lots of mapping code, and prevents errors if we were to get it wrong.</p> \n<p><a href=\"http://crunch.apache.org\">Crunch</a> provides a useful abstraction for this kind of workload, because it works with type safety and structured records at its heart. It’s based on Google’s <a href=\"http://research.google.com/pubs/pub35650.html\">FlumeJava</a> paper, and provides a general-purpose boilerplate-free developer-friendly typesafe Java API for developing data jobs to run on Hadoop MapReduce.</p> \n<p>Crunch code is relatively simple to understand, as this classic “word count” example demonstrates:</p> \n<div class=\"gatsby-highlight\" data-language=\"java\">\n <pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Pipeline</span> crunch <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MRPipeline</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WordCountJob</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncrunch<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">From</span><span class=\"token punctuation\">.</span><span class=\"token function\">textFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/path/on/hdfs\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">parallelDo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DoFn</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> s<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Emitter</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">&gt;</span></span> emitter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> word<span class=\"token operator\">:</span> s<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                  emitter<span class=\"token punctuation\">.</span><span class=\"token function\">emit</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">parallelDo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MapFn</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Pair</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">&gt;</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Pair</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">&gt;</span></span> wordCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token keyword\">return</span> wordCount<span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> wordCount<span class=\"token punctuation\">.</span><span class=\"token function\">second</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">To</span><span class=\"token punctuation\">.</span><span class=\"token function\">textFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/path/to/output\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncrunch<span class=\"token punctuation\">.</span><span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>Reading from top to bottom, we see that we’re reading a collection of Strings from a text file, then applying a <code class=\"language-text\">DoFn</code> which tokenizes each line into words and outputs each word. We then use the built-in <code class=\"language-text\">count()</code> method to count occurrences, then we apply a <code class=\"language-text\">MapFn</code> operation which formats those pairs back into <code class=\"language-text\">String</code> lines and writes them to a text file. The execution is lazy, so <code class=\"language-text\">crunch.done()</code> tells Crunch to run everything.</p> \n<p>Unfortunately this code snippet suffers in the same way that a lot of functional-style Java code has suffered with over the years. Those anonymous inner classes are ugly and add a huge amount of redundant information, making it difficult to read and irritating to write.</p> \n<h2>Java 8 to the rescue</h2> \n<p>Luckily, Java 8 gave us the gift of Lambda expressions, method references and <code class=\"language-text\">Stream</code>s; all of which are intended specifically to make functional programming in Java more user friendly. With the rest of our code starting to look more functional and concise, the Crunch parts of the code started to look even more archaic then they did before, so I set about building a thin Java-8-friendly wrapper around the Crunch API to make the situation better. That wrapper became Crunch Lambda, which as of version 0.14.0 is now part of the main Crunch project (in the crunch-lambda submodule, artifact org.apache.crunch:crunch-lambda:0.14.0)</p> \n<p><em>Mini side-note about Crunch versions</em>: Some people are worried about using Crunch because it’s not version “1” yet, but Crunch version numbers are incredibly conservative. We and many other large organisations have been using Crunch in production for some time and we consider it very stable.</p> \n<h2>Crunch Lambda</h2> \n<p>Let’s revisit the above example with Crunch Lambda instead:</p> \n<div class=\"gatsby-highlight\" data-language=\"java\">\n <pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Pipeline</span> crunch <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MRPipeline</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">WordCountJobLambda</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Lambda</span><span class=\"token punctuation\">.</span><span class=\"token function\">wrap</span><span class=\"token punctuation\">(</span>\n  crunch<span class=\"token punctuation\">.</span>read   <span class=\"token punctuation\">(</span><span class=\"token class-name\">From</span><span class=\"token punctuation\">.</span><span class=\"token function\">textFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/path/on/hdfs\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">flatMap</span><span class=\"token punctuation\">(</span>line <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Arrays</span><span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span>count  <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span>map    <span class=\"token punctuation\">(</span>wc <span class=\"token operator\">-&gt;</span> wc<span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> wc<span class=\"token punctuation\">.</span><span class=\"token function\">second</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span>write  <span class=\"token punctuation\">(</span><span class=\"token class-name\">To</span><span class=\"token punctuation\">.</span><span class=\"token function\">textFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/path/to/output\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncrunch<span class=\"token punctuation\">.</span><span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>See how the type information is only required once now for each transformation and there’s no distracting superfluous information.</p> \n<h2>What about the real world?</h2> \n<p>Let’s take a look at how we’re using Crunch at SoundCloud in one of our data jobs.</p> \n<p>The <em>EventStatsJob</em> counts the number of events that have successfully made it through to the end of the core event pipeline and splits it out by application and event type. We use this data to compare against data collected in real-time as events are first collected to check for any anomalies in our computation.</p> \n<p>Once it is collected the data, it emits it as data points to a <a href=\"http://prometheus.io\">Prometheus</a> PushGateway so they can be graphed over time.</p> \n<div class=\"gatsby-highlight\" data-language=\"java\">\n <pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Pipeline</span> crunch <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MRPipeline</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EventStatsJob</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Prometheus setup</span>\n<span class=\"token class-name\">PushGateway</span> pushGateway <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PushGateway</span><span class=\"token punctuation\">(</span>PUSH_GATEWAY_ADDRESS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Gauge</span> gauge <span class=\"token operator\">=</span> <span class=\"token class-name\">Gauge</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"event_count\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">labelNames</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"event_type\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"application\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Read events from Protobuf SequenceFile</span>\n<span class=\"token class-name\">LTable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Long</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Event</span><span class=\"token punctuation\">&gt;</span></span> events <span class=\"token operator\">=</span> \n  <span class=\"token class-name\">Lambda</span><span class=\"token punctuation\">.</span><span class=\"token function\">wrap</span><span class=\"token punctuation\">(</span>\n    crunch<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>\n      <span class=\"token class-name\">From</span><span class=\"token punctuation\">.</span><span class=\"token function\">sequenceFile</span><span class=\"token punctuation\">(</span>\n        dataPath<span class=\"token punctuation\">,</span>\n        <span class=\"token class-name\">Writables</span><span class=\"token punctuation\">.</span><span class=\"token function\">longs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token class-name\">PTypes</span><span class=\"token punctuation\">.</span><span class=\"token function\">protos</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Event</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">WritableTypeFamily</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Count events by their stats key and set Gauge values</span>\nevents<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StatsKey</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span><span class=\"token function\">fromEvent</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">StatsKey</span><span class=\"token punctuation\">.</span><span class=\"token function\">pType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">materialize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>statsRecord <span class=\"token operator\">-&gt;</span>\n          gauge<span class=\"token punctuation\">.</span><span class=\"token function\">labels</span><span class=\"token punctuation\">(</span>\n                  statsRecord<span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>eventType<span class=\"token punctuation\">,</span>\n                  statsRecord<span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>application<span class=\"token punctuation\">)</span>\n               <span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>statsRecord<span class=\"token punctuation\">.</span><span class=\"token function\">second</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Send the gauge contents to the PushGateway</span>\npushGateway<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>gauge<span class=\"token punctuation\">,</span> <span class=\"token string\">\"event_stats_job\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>Here we see how simply Crunch code can interoperate with normal Java code. It calls out to a nearby normal method to perform a distributed map operation (via the <code class=\"language-text\">StatsKey::fromEvent</code> method reference) and then brings the results back locally via the <code class=\"language-text\">materialize()</code> method to operate on as a normal Java <code class=\"language-text\">Stream</code>. Note that we didn’t even specify an output file, because they only output from this job is to feed metrics to Prometheus; Crunch handles all the temporary files and IO for you.</p> \n<p>The <code class=\"language-text\">StatsKey</code> custom type is a simple immutable wrapper for the <code class=\"language-text\">eventType</code> and <code class=\"language-text\">application</code> (it has a few more fields in real life, but these are omitted here for brevity). We can easily work with this in Crunch by giving it a conversion mechanism in and out of a built-in Crunch type, as seen in the <code class=\"language-text\">pType()</code> method here:</p> \n<div class=\"gatsby-highlight\" data-language=\"java\">\n <pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">StatsKey</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> eventType<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> application<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">StatsKey</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> eventType<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> application<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>eventType <span class=\"token operator\">=</span> eventType<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>application <span class=\"token operator\">=</span> application<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">PType</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StatsKey</span><span class=\"token punctuation\">&gt;</span></span> <span class=\"token function\">pType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">derivedImmutable</span><span class=\"token punctuation\">(</span>\n              <span class=\"token class-name\">StatsKey</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span>\n              <span class=\"token function\">mapFn</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">-&gt;</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StatsKey</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> t<span class=\"token punctuation\">.</span><span class=\"token function\">second</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              <span class=\"token function\">mapFn</span><span class=\"token punctuation\">(</span>k <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Pair</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">.</span>eventType<span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">.</span>application<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              <span class=\"token function\">pairs</span><span class=\"token punctuation\">(</span><span class=\"token function\">strings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">StatsKey</span> <span class=\"token function\">fromEvent</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Event</span> event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* ... */</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>This <code class=\"language-text\">PType</code> serialization/deserialization behaviour descriptor is provided built-in to Crunch for many serialization types, including Protobuf (as you can see with the <code class=\"language-text\">PTypes.protos</code> call above) and <a href=\"http://avro.apache.org\">Avro</a>.</p> \n<h2>A more complex example - Creating toplists</h2> \n<p>As part of the Soundcloud Stats product, we present toplists to sound creators in different dimensions - for example “my most-favourited tracks” or “top countries where my sound is played”. This is the main part of the code to compute these:</p> \n<div class=\"gatsby-highlight\" data-language=\"java\">\n <pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">LTable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Bucket</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">&gt;</span></span> summedBuckets <span class=\"token operator\">=</span>\n  events\n    <span class=\"token punctuation\">.</span><span class=\"token function\">flatMap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span><span class=\"token function\">createFactsFromEvent</span><span class=\"token punctuation\">,</span>\n             <span class=\"token function\">tableOf</span><span class=\"token punctuation\">(</span><span class=\"token function\">proto</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Bucket</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">longs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">groupByKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">reduceValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filterByValue</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">-&gt;</span> count <span class=\"token operator\">&gt;</span> <span class=\"token number\">0L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Remove negative counts</span>\n\n<span class=\"token keyword\">return</span> summedBuckets\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span><span class=\"token function\">remapDimensionKeys</span><span class=\"token punctuation\">,</span>\n         <span class=\"token function\">tableOf</span><span class=\"token punctuation\">(</span><span class=\"token function\">proto</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FactKey</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">proto</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TopListPair</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">groupByKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">mapValues</span><span class=\"token punctuation\">(</span>rowSet <span class=\"token operator\">-&gt;</span> <span class=\"token function\">findTopK</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">,</span> rowSet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>       \n               <span class=\"token function\">collections</span><span class=\"token punctuation\">(</span><span class=\"token function\">proto</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TopListPair</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>Here you can see that we are doing some much more complex operations than in our previous example.</p> \n<p>Firstly we transform each events into a set of “facts”. A “sound played” event, for example, might generate several facts. One based on which country it occured in, one based on which creator published the sound, and so on. The <code class=\"language-text\">createFactsFromEvent</code> method takes an Event as its parameter, and returns a Java <code class=\"language-text\">Stream</code> of facts corresponding to each of these so-called “dimensions”. We group by the key (eg. ‘my<em>awesome</em>sound’), dimension (eg. “country”) and its value (eg. “Sweden”) - together called a ‘bucket’ - and sum the Long values as a reduce operation. As some events (such as “sound un-favourited”) can cause a negative impact on the counts, we filter out any totals which are non-positive, as these tend to look strange to users.</p> \n<p>Following this, the <code class=\"language-text\">remapDimensionKeys</code> operation effectively moves the dimension value (eg. “Sweden”) from the key part of the record to the value part, so we’re left with a FactKey(“my<em>awesome</em>sound”, “country”) and a TopListPair(“Sweden”, 581). We then <code class=\"language-text\">groupByKey()</code> with this new key to collect all the <code class=\"language-text\">TopListPair</code>s for each <code class=\"language-text\">FactKey</code>, then run them through the <code class=\"language-text\">findTopK</code> to obtain the K <code class=\"language-text\">TopListPair</code>s with the greatest count.</p> \n<div class=\"gatsby-highlight\" data-language=\"java\">\n <pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TopListPair</span><span class=\"token punctuation\">&gt;</span></span> <span class=\"token function\">findTopK</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Stream</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TopListPair</span><span class=\"token punctuation\">&gt;</span></span> input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token class-name\">SortedSet</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TopListPair</span><span class=\"token punctuation\">&gt;</span></span> set <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TreeSet</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">(</span>\n           <span class=\"token class-name\">Comparator</span><span class=\"token punctuation\">.</span><span class=\"token function\">comparingLong</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TopListPair</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span><span class=\"token function\">getCount</span><span class=\"token punctuation\">)</span>\n                   <span class=\"token punctuation\">.</span><span class=\"token function\">reversed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                   <span class=\"token punctuation\">.</span><span class=\"token function\">thenComparing</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TopListPair</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span><span class=\"token function\">getDimensionValue</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   input<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>pair <span class=\"token operator\">-&gt;</span> <span class=\"token punctuation\">{</span>\n       set<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>pair<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>set<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> k<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n           set<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>set<span class=\"token punctuation\">.</span><span class=\"token function\">last</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">return</span> set<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>As you can see, there’s absolutely nothing unusual about this part of the computation. We use a standard streaming top-k algorithm to create the result set for the key.</p> \n<h2>Testing</h2> \n<p>Finally, one of the greatest advantages of using Crunch is how it facilitates easy local testing of your pipeline logic. A combination of an in-memory implementation of the <code class=\"language-text\">Pipeline</code> object <a href=\"http://crunch.apache.org/apidocs/0.14.0/org/apache/crunch/impl/mem/MemPipeline.html\">MemPipeline</a> and the fact that the API encourages using normal Java methods to compose your pipes (for simple low-level unit testing) means that it’s really easy to have confidence in your pipeline before it even makes it on to the cluster.</p> \n<h2>Future</h2> \n<p>We’ve got our eyes firmly on the <a href=\"http://beam.incubator.apache.org/\">Apache Beam</a> project as it progresses. Inspired by work from FlumeJava, Crunch, Google DataFlow, Spark and Flink (and also running on at least the latter 3) it aims to generalise the expression of data pipelines like this away from Hadoop altogether and break the cycle of having to rewrite everything to keep up with the latest technology. This sounds like a big step in the right direction, but we’re confident writing new Crunch code now isn’t a waste of time either, as it looks very likely so far that translating from Crunch to Beam would be a relatively simple operation when the time comes.</p> \n<p><em>David is a Data Engineer at SoundCloud and a committer to the Apache Crunch project. You can learn more by reading the <a href=\"https://crunch.apache.org/user-guide.html\">Crunch User Guide</a> and the <a href=\"https://crunch.apache.org/apidocs/0.14.0/org/apache/crunch/lambda/Lambda.html\">Javadocs for Crunch Lambda</a>. If you’re interested in working on problems like these, check our open positions on the <a href=\"https://soundcloud.com/jobs/product_design_engineering\">SoundCloud Jobs page</a></em></p>","descriptionType":"html","publishedDate":"Wed, 01 Jun 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"301327bbe8bb58fc1186817a1de0aaa4","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569979},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Java API Wrapper","link":"https://developers.soundcloud.com/blog/java-api-wrapper","description":"<p>Alongside with the <a href=\"https://soundcloud.com/apps/android\">SoundCloud Android app</a> we’ve created a new <a href=\"https://github.com/soundcloud/java-api-wrapper\">Java Wrapper</a> for the SoundCloud API and today we can finally release it to the public!</p> \n<p>It is simple to use, supports OAuth2 and requires a minimum of external dependencies so it should be easily embeddable in both desktop and mobile applications.</p> \n<!-- more --> \n<p>Here is a quick demonstration how easy it is to use it:</p> \n<div class=\"gatsby-highlight\" data-language=\"java\">\n <pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// Create a wrapper instance</span>\n<span class=\"token class-name\">ApiWrapper</span> wrapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApiWrapper</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"client_id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"client_secret\"</span><span class=\"token punctuation\">,</span>\n                                    <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Env</span><span class=\"token punctuation\">.</span>LIVE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Obtain a token</span>\nwrapper<span class=\"token punctuation\">.</span><span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"password\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Execute a request</span>\n<span class=\"token class-name\">HttpResponse</span> resp <span class=\"token operator\">=</span> wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Request</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/me\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Update a resource</span>\n<span class=\"token class-name\">HttpResponse</span> resp <span class=\"token operator\">=</span>\n      wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Request</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">to</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/me\"</span><span class=\"token punctuation\">)</span>\n             <span class=\"token punctuation\">.</span><span class=\"token keyword\">with</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user[full_name]\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Che Flute\"</span><span class=\"token punctuation\">,</span>\n                   <span class=\"token string\">\"user[website]\"</span><span class=\"token punctuation\">,</span>   <span class=\"token string\">\"http://cheflute.com\"</span><span class=\"token punctuation\">)</span>\n             <span class=\"token punctuation\">.</span><span class=\"token function\">withFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user[avatar_data]\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"flute.jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>You’ll find the wrapper on <a href=\"https://github.com/soundcloud/java-api-wrapper\">GitHub</a> and more infos and examples in the <a href=\"https://github.com/soundcloud/java-api-wrapper/blob/master/README.md\">Readme</a>. Let us know what you think!</p>","descriptionType":"html","publishedDate":"Thu, 19 May 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"2d2e2081f4b37cf81fae19fccb067f41","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Alerting on SLOs like Pros","link":"https://developers.soundcloud.com/blog/alerting-on-slos","description":"<p>If there is anything like a silver bullet for creating meaningful and actionable alerts with a high signal-to-noise ratio, it is alerting based on service-level objectives (SLOs). Fulfilling a well-defined SLO is the very definition of meeting your users’ expectations. Conversely, a certain level of service errors is OK as long as you stay within the SLO — in other words, if the SLO grants you an <em>error budget</em>. Burning through this error budget too quickly is the ultimate signal that some rectifying action is needed. The faster the budget is burned, the more urgent it is that engineers get involved.</p> \n<p>This post describes how we implemented this concept at SoundCloud, enabling us to fulfill our SLOs without flooding our engineers on call with an unsustainable amount of pages.</p> \n<!-- more --> \n<h2>Let’s Talk SRE</h2> \n<p>SLOs, alerting, and error budgets are central concepts of <a href=\"https://landing.google.com/sre/\">Site Reliability Engineering (SRE)</a>, a discipline invented by Google in the early 2000s. Although it was initially proprietary to Google, over the last few years, SRE has become a widely discussed topic and is now applied in various flavors throughout the industry. An important milestone in this development was Google’s publication of the bestselling book <a href=\"https://landing.google.com/sre/sre-book/toc/index.html\"><em>Site Reliability Engineering: How Google Runs Production Systems</em></a>. The book is available online for free. If you run anything even remotely at scale, there is really no excuse as to why you shouldn’t read this book in its entirety. Among all of its important chapters, there are three of particular importance for this blog post:</p> \n<ul> \n <li><a href=\"https://landing.google.com/sre/sre-book/chapters/service-level-objectives\">Chapter 4 — Service Level Objectives</a> explains everything you need to know about SLOs (and SLIs and SLAs, in case you’ve ever wondered about the difference).</li> \n <li><a href=\"https://landing.google.com/sre/sre-book/chapters/monitoring-distributed-systems\">Chapter 6 — Monitoring Distributed Systems</a> lays the foundation of “alerting philosophy” and creates an understanding of when it makes sense to page engineers (and when it does not).</li> \n <li><a href=\"https://landing.google.com/sre/sre-book/chapters/practical-alerting\">Chapter 10 — Practical Alerting</a> mostly describes Borgmon, Google’s traditional internal monitoring system. While Borgmon is proprietary to Google, the author points out that you can try out the described concepts at home (or at work, even) because many current open-source monitoring systems follow similar semantics, with <a href=\"https://prometheus.io\">Prometheus</a> receiving a special shoutout. Conveniently, we use Prometheus for the large majority of our monitoring (which is not surprising, as most of Prometheus’ <a href=\"https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud\">initial development took place here at SoundCloud</a>).</li> \n</ul> \n<p>Keep in mind, though, that <a href=\"https://blog.bradfieldcs.com/you-are-not-google-84912cf44afb\">you are not Google</a>. We all can learn from the giants, but blindly copying them could go horribly wrong. On that note, how different organizations ventured into SRE territory is the main topic of yet another SRE-themed book: <a href=\"https://www.oreilly.com/library/view/seeking-sre/9781491978856/\"><em>Seeking SRE</em></a>, which was curated and edited by David Blank-Edelman. We at SoundCloud contributed a chapter, too, in which we talked about our somewhat bumpy road to applying SRE principles in an organization that is totally not Google.</p> \n<p>The Google SREs themselves also felt the pain of us “mere mortals” trying to figure out how to make use of the lessons from the SRE book in our day-to-day work, so they published a companion to the original SRE book, called [<em>The Site Reliability Workbook</em>], which they again made available online for free. There are a bunch of cookbook-style chapters that are directly applicable in practice. One of them, <a href=\"https://landing.google.com/sre/workbook/chapters/alerting-on-slos/\">Chapter 5 — Alerting on SLOs</a>, describes perfectly what we had been doing already, albeit in a less sophisticated way. With the inspiration from that chapter, we were able to refine our SLO-based alerting with great success. In fact, the solution we ended up using is so similar to the one described in the chapter that you should just read it together with this blog post to get the most out of it.</p> \n<h2>Symptoms vs. Causes</h2> \n<p>But let’s first take a step back and think about alerting on symptoms vs. causes. This is an important topic in <a href=\"https://landing.google.com/sre/sre-book/chapters/monitoring-distributed-systems\">Chapter 6</a> from the original SRE book (where you can read up all the details if you feel so inclined).</p> \n<p>Back in the days when your entire site ran on one LAMP server, there wasn’t much of a need to think about the difference between symptoms and causes. If your one web server went down (cause), your site was down (symptom). Waking somebody up the moment your web server stopped replying to ping probes was the right thing to do.</p> \n<p>Nowadays, even mid-size sites run on hundreds, if not thousands of servers, and one or two of them are almost guaranteed to be down at any time. And that’s fine, because the software is designed to tolerate some failures. As such, it wouldn’t make any sense to wake somebody up whenever a single machine goes down.</p> \n<p>You can apply the same thought to many other — actual or potential — <em>causes</em> of an outage. Paging alerts, those that wake you up in the night, should be based on <em>symptoms</em>, i.e. something that actively or imminently impacts the user experience. In addition, the alerting condition should also be urgent and actionable. If any of these requirements are not met, the alert should not be a page.</p> \n<p>However, there could still be a meaningful alert on a non-paging level. Let’s call these kinds of alerts <em>tickets</em>, as somebody will have to look at them eventually, e.g. a dead server has to be dealt with at a suitable time. A user-visible but not urgent problem can easily be addressed during work hours rather than in the middle of the night, but even during an actual outage, it is helpful to get informed (via some kind of dashboard rather than via your pager) about possible causes of an outage that are detected by the monitoring system.</p> \n<p>Ideally, your SLO is a precise definition of an unimpacted user experience. In other words, symptom-based alerts are usually alerts on (active or imminent) violations of your SLO.</p> \n<h2>Black-Box vs. White-Box Monitoring</h2> \n<p>With the lessons of symptoms vs. causes in mind, you might think now that black-box monitoring is the obvious choice for detecting symptoms, while white-box monitoring is ideal for causes. That’s a reasonable thought, but in reality, our practice at SoundCloud is a perfect match of what Google tells us in <a href=\"https://landing.google.com/sre/sre-book/chapters/monitoring-distributed-systems\">Chapter 6</a> of the SRE book: “We combine heavy use of white-box monitoring with modest but critical uses of black-box monitoring.”</p> \n<p>We mostly use black-box probes as a workaround for legacy software that isn’t yet instrumented for white-box monitoring. And we run fairly complex Catchpoint probes to simulate typical usage of our site. Interestingly, these probes are what we use to determine if we have hit our monthly, quarterly, and yearly availability goals, but we don’t use them to page anybody. Why is that so? The lazy answer is: We need white-box monitoring anyway (to investigate causes). Why should we invest in additional black-box monitoring except for in the most critical cases? But there are more reasons (quotes are again from the SRE book):</p> \n<ul> \n <li>Ideally, we want to detect user-impacting outages <em>before</em> they do noticeable harm. However, “for not-yet-occurring but imminent problems, black-box monitoring is fairly useless.”</li> \n <li>Probes are <em>not</em> real user traffic. For example, the test track that our Catchpoint probes attempt to play might be perfectly available, while, for some complex reasons, the rap battle that has just gone viral is not.</li> \n <li>Measuring long-tail latency and detecting low error rates take a lot of probes and thus a long time. However, tail latency is quite crucial in distributed systems, and our availability goals are usually measured in many nines, and so even a small error rate might violate our SLO. This could be the main reason why we don’t page anybody based on our Catchpoint probe. The probes are too slow to detect low but significant error rates, despite already limiting them to probing a very specific business KPI. The latter is a problem on its own, as we want our paging alerts to cover all relevant features of the site. However, the long-term results of the Catchpoint probes are great as a general quality calibration for our other monitoring. If they detect something, we can revisit historical alerting records to see if the near-real-time monitoring caught the issue, too.</li> \n <li>In a multilayered system, like a microservice architecture, “one person’s symptom is another person’s cause.” A frontend service sees a failing backend service as a cause, while for the backend service, its own failure is a symptom, as it is now violating the (internal service-to-service) SLO. Adopting this view, we can use the white-box monitoring of the instrumented frontend service to track requests issued to the backend service. This is essentially black-box probing of the backend with the complete and real user traffic.</li> \n</ul> \n<p>The most rewarding place to apply the pattern described in the last point above is our HAProxy-based terminator layer at the edge of our infrastructure. An <a href=\"https://developers.soundcloud.com/blog/how-soundcloud-uses-haproxy-with-kubernetes-for-user-facing-traffic\">earlier Backstage Blog post</a> described it in detail.</p> \n<p>Recently, HAProxy announced the introduction of a native <a href=\"https://www.haproxy.com/blog/haproxy-exposes-a-prometheus-metrics-endpoint/\">Prometheus metrics endpoint</a>, but the versions we have been working with are not yet instrumented for Prometheus. This gap is bridged by the <a href=\"https://github.com/prometheus/haproxy_exporter\">Prometheus HAProxy exporter</a>, a small glue binary that can be scraped by the Prometheus server in the usual way, whereupon it talks to HAProxy in its own fashion to retrieve metrics and convert them to the Prometheus format and then sends them back as the scrape result. By running such an HAProxy exporter next to each HAProxy instance, we get all the metrics we need. In particular, there is a counter for all HTTP requests HAProxy has sent to the various backends, partitioned not only by the backend, but also by the HTTP status code. With Prometheus, we can easily calculate relative rates of 5xx responses over arbitrary time spans.</p> \n<h2>Multiwindow, Multi-Burn-Rate Alerts</h2> \n<p>With the error rate as seen by the HAProxy terminator layer, we can now apply the alerting technique described in <a href=\"https://landing.google.com/sre/workbook/chapters/alerting-on-slos/\">Chapter 5</a> of the SRE workbook. If you haven’t yet read that chapter, now is probably really a good time to do so. It progresses quite nicely, approaching the ultimate solution iteratively and solving one problem after another. Spoiler alert: Here, we will only implement the ultimate solution, the sixth iteration in the chapter, which is called <em>Multiwindow, Multi-Burn-Rate Alerts</em>. This features a set of alerts, each of which has a different alerting threshold that corresponds to different rates of burning through the monthly error budget. Depending on the burn rate, each alert uses a combination of two different time windows over which the error rate is calculated. Fast burning is detected quickly. Slow burning needs a longer time window.</p> \n<p>First, we need to actually set the SLO. The chapter from the SRE workbook assumes an error rate of 0.1% (or a 99.9% success rate) as a typical value. That’s also generally true for SoundCloud, so the various numbers calculated in the chapter make sense for our scenario. However, some backends might have a stricter or more relaxed SLO. We still keep the various burn rates and window sizes the same for them, but we allow the target error rate to be configured by backend. This configuration takes the form of rules in PromQL (the Prometheus expression language, which is also used in the SRE workbook). They look like the following:</p> \n<div class=\"gatsby-highlight\" data-language=\"yaml\">\n <pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> slos_by_backend\n  <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">record</span><span class=\"token punctuation\">:</span> backend<span class=\"token punctuation\">:</span>error_slo<span class=\"token punctuation\">:</span>percent\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">backend</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"api-v4\"</span>\n    <span class=\"token key atrule\">expr</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.1</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">record</span><span class=\"token punctuation\">:</span> backend<span class=\"token punctuation\">:</span>error_slo<span class=\"token punctuation\">:</span>percent\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">backend</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"api-v3\"</span>\n    <span class=\"token key atrule\">expr</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0.2</span>\n  <span class=\"token comment\"># ... Many more backends.</span></code></pre>\n</div> \n<p>Next, we need the actual error rate averaged over various time windows: 5m, 30m, 1h, 2h, 6h, 1d, 3d. These are also calculated as recording rules, but they are now based on actual live data instead of a constant number. This is the rule for the 5m case:</p> \n<div class=\"gatsby-highlight\" data-language=\"yaml\">\n <pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> multiwindow_recording_rules\n  <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">record</span><span class=\"token punctuation\">:</span> backend<span class=\"token punctuation\">:</span>haproxy_backend_http_errors_per_response<span class=\"token punctuation\">:</span>ratio_rate5m\n    <span class=\"token key atrule\">expr</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span>2\n        sum by (backend)(rate(haproxy_backend_http_responses_total<span class=\"token punctuation\">{</span>job=\"haproxy\"<span class=\"token punctuation\">,</span> code=\"5xx\"<span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span>5m<span class=\"token punctuation\">]</span>))\n      /\n        sum by (backend)(rate(haproxy_backend_http_responses_total<span class=\"token punctuation\">{</span>job=\"haproxy\"<span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span>5m<span class=\"token punctuation\">]</span>))\n  <span class=\"token comment\"># Other rules accordingly with 5m replaced by 30m, 1h, 2h, 6h, 1d, 3d.</span></code></pre>\n</div> \n<p>The <code class=\"language-text\">rate</code> with the <code class=\"language-text\">[5m]</code> range selector calculates requests per second, averaged over the specified timeframe, from the ever-increasing counters. The <code class=\"language-text\">sum</code> aggregator in both enumerator and denominator separately sums up the rate from all HAProxy instances for each <code class=\"language-text\">backend</code>. Each <code class=\"language-text\">backend</code> ends up as a label on the elements in the resulting vector. The denominator includes all requests, while the enumerator only selects those with <code class=\"language-text\">code=\"5xx</code> — which results in an error rate.</p> \n<p>With all these recording rules in place, we can now assemble the multiwindow, multi-burn-rate alerts. We have chosen to use four different alerts, each combining a <em>long window</em>, a <em>short window</em>, and a <em>burn rate factor</em>, as listed in the following table.</p> \n<table> \n <thead> \n  <tr> \n   <th>Alert</th> \n   <th>Long Window</th> \n   <th>Short Window</th> \n   <th><code class=\"language-text\">for</code> Duration</th> \n   <th>Burn Rate Factor</th> \n   <th>Error Budget Consumed</th> \n  </tr> \n </thead> \n <tbody> \n  <tr> \n   <td>Page</td> \n   <td>1h</td> \n   <td>5m</td> \n   <td>2m</td> \n   <td>14.4</td> \n   <td>2%</td> \n  </tr> \n  <tr> \n   <td>Page</td> \n   <td>6h</td> \n   <td>30m</td> \n   <td>15m</td> \n   <td>6</td> \n   <td>5%</td> \n  </tr> \n  <tr> \n   <td>Ticket</td> \n   <td>1d</td> \n   <td>2h</td> \n   <td>1h</td> \n   <td>3</td> \n   <td>10%</td> \n  </tr> \n  <tr> \n   <td>Ticket</td> \n   <td>3d</td> \n   <td>6h</td> \n   <td>1h</td> \n   <td>1</td> \n   <td>10%</td> \n  </tr> \n </tbody> \n</table> \n<p>Each alert fires if the SLO error rate times the <em>burn rate factor</em> is exceeded when averaged over both the <em>long window</em> and the <em>short window</em>.</p> \n<p><em>Example:</em> The SLO error rate for <code class=\"language-text\">api-v4</code> is 0.1% (to achieve “three 9s” of availability). The owners of <code class=\"language-text\">api-v4</code> get paged if their backend has returned more than 1.44% 5xx responses over the last 1h <em>and</em> over the last 5m. They also get paged if their backend has returned more than 0.6% 5xx responses over the last 6d <em>and</em> over the last 30m.</p> \n<p>The short window ensures a short reset time of the alert, i.e. an alert should stop firing soon after the problem has been solved (which is not only convenient but also allows for paging to happen again if the problem comes back).</p> \n<p>Why the different burn rate factors? They enable pages for fast burning of the monthly error budget and tickets for slow burning of the budget. (Slow burning of the error budget must not go undetected and must be addressed eventually, but it’s no reason to wake somebody up in the middle of the night.) The Error Budget Consumed column lists the percentage of the monthly error budget consumed at the time the alert triggers. The math is easiest to check in the last row, with a burn rate factor of 1: If the error rate happens to be exactly at the target of 0.1%, and that happens for 3 days, then 10% of the monthly error budget is burned because 3 days is 10% of a 30-day-long month.</p> \n<p>Note that an alert can fire much more quickly than within the length of the long window. A backend that suddenly starts to return 100% 5xx will cross the 1.44% hourly error rate after only 52s (1.44% of 3,600s).</p> \n<p>This leaves us with the <em><code class=\"language-text\">for</code> duration</em> column, which is interestingly missing in the SRE workbook. We’ll talk about it in a minute. But let’s first see how the alerting rules actually appear:</p> \n<div class=\"gatsby-highlight\" data-language=\"yaml\">\n <pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> multiwindow_alerts\n  <span class=\"token key atrule\">rules</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">alert</span><span class=\"token punctuation\">:</span> ErrorBudgetBurn\n    <span class=\"token key atrule\">expr</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span>2\n        (\n          100 * backend<span class=\"token punctuation\">:</span>haproxy_backend_http_errors_per_response<span class=\"token punctuation\">:</span>ratio_rate1h\n        <span class=\"token punctuation\">&gt;</span> on (backend)\n          14.4 * backend<span class=\"token punctuation\">:</span>error_slo<span class=\"token punctuation\">:</span>percent\n        )\n      and\n        (\n          100 * backend<span class=\"token punctuation\">:</span>haproxy_backend_http_errors_per_response<span class=\"token punctuation\">:</span>ratio_rate5m\n        <span class=\"token punctuation\">&gt;</span> on (backend)\n          14.4 * backend<span class=\"token punctuation\">:</span>error_slo<span class=\"token punctuation\">:</span>percent\n        )\n    <span class=\"token key atrule\">for</span><span class=\"token punctuation\">:</span> 2m\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">system</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"{{$labels.backend}}\"</span>\n      <span class=\"token key atrule\">severity</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"page\"</span>\n      <span class=\"token key atrule\">long_window</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"1h\"</span>\n    <span class=\"token key atrule\">annotations</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">summary</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"a backend burns its error budget very fast\"</span>\n      <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Backend {{$labels.backend}} has returned {{ $value | printf `%.2f` }}% 5xx over the last hour.\"</span>\n      <span class=\"token key atrule\">runbook</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"https://runbooks.soundcloud.com/terminator/#errorbudgetburn\"</span>\n  <span class=\"token comment\"># Followed by the other three alerting rules.</span></code></pre>\n</div> \n<p>For the sake of brevity, this only lists the first of the four alerting rules. By replacing the relevant recording rules, the factors, the <code class=\"language-text\">for</code> duration, and the applicable label values with the values from the table above, you can easily deduce how the other three alerting rules appear.</p> \n<p>The SRE workbook also lists the alerting rules in PromQL, but in a more compact form. Our example here is more verbose because we have added a few things we needed for our particular use case:</p> \n<ul> \n <li>As explained above, the SLO error rate might be different per backend and the threshold is configured as a recording rule named <code class=\"language-text\">backend:error_slo:percent</code>. You can find it in the expression above. Note that the <code class=\"language-text\">&gt;</code> comparison operator is used with a modifier, <code class=\"language-text\">on (backend)</code>, to tell Prometheus which label to use for the label matching.</li> \n <li><code class=\"language-text\">annotations</code> which follow internal conventions, are added to facilitate handling the alerts. For example, each alert should contain a link to the relevant runbook in our runbook repository.</li> \n <li>We also add a <code class=\"language-text\">system</code> label for alert routing. The Prometheus Alertmanager allows us to configure alert routing based on labels in a very powerful way. Somewhere else in our codebase, we have a registry of which team owns which systems. From there, we autogenerate an Alertmanager config that routes alerts to their owners based on the <code class=\"language-text\">system</code> label. Everything that can be labeled (for example, pods on Kubernetes) also gets a <code class=\"language-text\">system</code> label, and that label is propagated into Prometheus. HAProxy only knows the backend, and thus the HAProxy exporter doesn’t expose a system label. However, by convention, we use the system name as the backend name, and thus we can simply set the <code class=\"language-text\">system</code> label to the value of the <code class=\"language-text\">backend</code> label. (In harsh reality, the <code class=\"language-text\">backend</code> label is a multi-component string with other components, too. Prometheus has you covered there as well, with the <code class=\"language-text\">label_replace</code> function used to cut out the system part. This little complication is left out above to keep things a bit shorter.)</li> \n <li>Finally, there is the <code class=\"language-text\">for</code> clause, with the duration from the table above. An alert with a <code class=\"language-text\">for</code> clause only fires once the alerting condition has been fulfilled continuously for the configured duration. Intriguingly, the SRE workbook explicitly advises against <code class=\"language-text\">for</code> clauses because they inevitably increase the detection time for the alerting condition. We still decided to use a <code class=\"language-text\">for</code> clause with a duration that is short compared to expected response times (of the alert itself and of the engineers getting alerted). The <code class=\"language-text\">for</code> clause is essentially a simple but effective defense against statistical outliers. For example, if a service has just started to receive traffic after a launch or an undrain operation, the error rate over any time window will be dominated by the very short time it has received traffic at all. Without the <code class=\"language-text\">for</code> clause, even a very short and modest initial error spike (maybe caused by cold caches) will trigger all the alerts.</li> \n</ul> \n<h2>Conclusion</h2> \n<p>With the alerts described above, we can reliably detect breaches of configurable SLOs with an appropriate detection time (the quicker the error budget is burned, the sooner the alert will fire) and a sufficiently short reset time. The resulting alerts are strictly symptom-based and therefore always relevant. To reach a person able to act on a particular alert, it is routed to the on-call rotation owning the affected backend.</p>","descriptionType":"html","publishedDate":"Tue, 04 Jun 2019 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"b11f33aa62fbafe4a41a0d052b3843fb","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569972},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Keeping Counts In Sync","link":"https://developers.soundcloud.com/blog/keeping-counts-in-sync","description":"<p>Track play counts are essential for providing a good creator experience on the SoundCloud platform. They not only help creators keep track of their most popular songs, but they also give creators a better understanding of their fanbase and global impact. This post is a continuation of an earlier post that discussed what we do at SoundCloud to ensure creators get their play stats (along with their other stats), both reliably and in real time.</p> \n<!-- more --> \n<p>A long time has passed since we shared about the challenges of and our approach to <a href=\"https://developers.soundcloud.com/blog/real-time-counts-with-stitch\">real-time stats</a>. Since then, we’ve had to expand our infrastructure to cope with the continuously growing stream of events representing plays, likes, downloads, and other important social signals that we’d like to count and present to creators. As a result, what might seem like a simple counting system is actually a cornucopia of services orchestrated to power features like creator statistics, reporting, search, and recommendations. The list goes on and on.</p> \n<h1><img src=\"https://developers.soundcloud.com/blog/bb110ebe55e84aad2c7f8a59340e75ee/bubble.svg\" alt=\"problem\"> What We Talk about When We Talk about Counts and Statistics</img></h1> \n<p>The main challenge for a statistics powering system is that we not only need to present summed up totals for arbitrary time ranges, but we also need to allow creators to dig into these summed time ranges with dynamic granularity. For instance, when someone is interested in a week of play counts, aside from displaying the totals for that week, they might like to see the daily performance as well. Ideally, the total of those days should add up to the total shown for the week, and when zooming in to a specific day, all the hourly counts would be shown as well.</p> \n<p>Another challenge is keeping the total counts of plays, likes, reposts, and other signals we would like to display for a certain track updated. These counters offer an aggregated view of the entire time a track is present on our platform, and they are ubiquitous in that they are visible everywhere a track is displayed. Because, most of the time, these counters are public, they are requested from the service several orders of magnitude more times than the actual stats that are only visible to the individual creators.</p> \n<h1><img src=\"https://developers.soundcloud.com/blog/f2f6d71e2b425162e229c3ffeb0c72a3/gears.svg\" alt=\"gears\"> Current Solution: Stitching Counts</img></h1> \n<p>As highlighted in the aforementioned post, our system <em>Stitch</em> is at the heart of the stats and counters. Stitch pre-aggregates events over several dimensions to answer queries efficiently. The main dimension is time, and the buckets consist of hourly, daily, and monthly partitions. The second dimension is the different type of events, of which the play events are the most abundant, making them the most challenging to keep updated. On top of all this, we are doing this pre-aggregation for every track, along with a summation of every creator’s overall stats and counters.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 776px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/d55f08cc89ab80f46068e977d4213585/0901c/counts_stitch.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 78.35051546391753%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADUklEQVQ4y6VTa0iTURg+c9907pI5sywTWohaSdKVLCrsRxhBfyolyloXmgrVjyAMM03KXIqF2izrh9oNLVIM0lLTec3mbc62uavTbU2dljbQrcvbOR9GYSJUD7yc873nfZ7znee8B8HEW3A7msbco7VrEYZ7pM4D/QkGDl8Wi7UIj36xMbF+BQUF4ReTk5ZoO8y3NHLjZ43cZFA09Fcig6ICJqz1TnC2bibMLw4ZLagYmEJ17wwIANCatRuYXC5PQMRwCCIiIvxTUlICIiMj+bouc01noxLkDYqvfU16J2qpLdnX1/44mIg8eliCHtxJRfVyHZoL166mr76RmbHy99x4/7RPbaUstrVGvtPw1s5GCWeShAjtZc4mV7+zUG2aSU55vYrztPa994PyRt71Gze3FD0sCyHr4vh4xpXUdPo0CWfFQvG5kwtpog/fa8GyAD/exg3rKXw8xoTTRRe9t7juqa3uCd0wDBocYNGNgFVtc+P4qlWYXaGkhtQTf+OOxAWJjh4ngl4kT3ZcKhQK+ZkSyTqJRBIZHb1H0DvgbLRPATR2DUAV9qiuXQsaqwsMowCV9b3R58/Gh1y6nBqEuUSI+OuLYxfaGbVDEHcsbjH+8MiX5gvy8nMDyC59Q1OysW8AGpsbVJZpwH8H5k8AxjEAWffQ9sxraetz824TQbZAIOAxmUwunq9CB3bHcsqflofM9lBp/r5JOTh9Wv3hm0jvAFGH9qO4x+Q8pRxyHVYNA+dnnU436wJLqu+veFRVFGYDU6DRrV4utzYvb+h/HVityfNB86B7GOZeGHCaQDOqgrb+VmhRN0PfByWQnHHSAF2Wjm0z5lP7D53wlhZXsPDco+xVJzq41Q89efaC1vD09Pwl2Gvryewe6rzepJJlNSjeSNt1bblKuyKD5O4/v0t6jhEcFkwYLA8MiqJoHp6if0JYeCjpUe7MKyE2sOYlmMbNlHZYT6msGsrmtjPtX0aY+lEjpXcYSF8iHuKjGREug8Egl0HNK5heKUapL0VIUnYB5RZJ0K3iDJTSFIOSSkQoITGBrklOTubh1uAkJib6l5aW0oI5OTl/f9ysrCx6zM7O5rPZbK+0tLRALEjfQGFhIfpfeEdFRfGIDQRSqXTOoh8lTJIf2+TVNQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Stitch architecture\" title=\"Stitch architecture\" src=\"https://developers.soundcloud.com/blog/static/d55f08cc89ab80f46068e977d4213585/0901c/counts_stitch.png\" srcset=\"/blog/static/d55f08cc89ab80f46068e977d4213585/9ec3c/counts_stitch.png 200w,\n/blog/static/d55f08cc89ab80f46068e977d4213585/c7805/counts_stitch.png 400w,\n/blog/static/d55f08cc89ab80f46068e977d4213585/0901c/counts_stitch.png 776w\" sizes=\"(max-width: 776px) 100vw, 776px\" loading=\"lazy\" /> </a> </span></p> \n<p>Stitch architecture is an incremental <a href=\"http://lambda-architecture.net/\">Lambda Architecture</a>. Instead of always regenerating the serving layer from the beginning of time, we only generate the changed buckets of hours, days, and months. Batch counts for the current day — including hourly batches — are handled with a daily job, and batch counts for the current month are handled with a monthly scheduled job.</p> \n<p>We’ve chosen this way of regenerating the serving layer in batches from the end of the last batch calculation performed because play counts do not generally come from the past (with the exception of things like spam and backfills from bugs in the event pipeline). Creators also tend to expect monotonically increasing play counts over time, although this property is not valid for counts of “likes” or “reposts” that could actually go down as well.</p> \n<p>With this setup (shown and described above), we have the possibility of swapping or recalculating certain days or months of data, but usually we don’t need to, so long as everything goes fine (as in no bugs and no network failures or other outages). The <a href=\"https://developers.soundcloud.com/blog/data-pipelines-apache-crunch-java-8\">Crunch</a> batch jobs run in our <a href=\"https://www.cloudera.com/\">Cloudera</a>-flavored <a href=\"http://hadoop.apache.org/\">Hadoop</a> cluster over data ingested and archived by our event pipeline based on <a href=\"http://kafka.apache.org/\">Kafka</a>. Both the batch and the real-time layer convert the <a href=\"https://developers.google.com/protocol-buffers/\">Protobuf</a> event messages into increments and sum them up in their specific buckets.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 401px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/582e02631c980b94411d5cf92fe39825/302a3/counts_cassandra.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 89.52618453865337%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACwElEQVQ4y6WU30uTURjH34lvbktzacPR0K3JjIGYOCyDflCX3XfllddeCdkfEHYzGgq1sYQ1icibYVGZoJKuKbsQTdPNjNnc+4PlNnU/IC2T0/e8O4LSD0c+8OF53/Oe832f55znORz3u1nBdXATXAY3gJ07humY6HlgAhZQB1TcMa0MaP9rpc/nO/Su1WotPM9fBVc0Gg2NkLPZbMq3rq6u4oU7Ozv3H/UsZRtLX7GGhobihAghnNfrVZ7T6XSlx+Mxtbe32zs6Opp7e3vPbWxsVP1l6RmgYZwAZ5VRl8tVOF6rtTyVSkVzuRxJJpM/wd7W1tYeBPP9/f2tdI7dbi87sLgWGNmhnQb1itDAwEAhT72+ChFOZ7PZ9UwmswaxOMRFjH1xu93NdI7BYKiEq2aLa5kQ3aIKVhGH7JQkSY/j8fiYKIpvwLAgCCPwQ36/n0ZSWlNTo2WC/AFKGWoqUmIymegLZ7FY9Igus7m5SSBEEokEwQ/Izs4OwbbQQucwl0Z48l9nUq5SqS7SbGjFxGKxR7Isj0DoBSJ7CV5DfDAUCtG0eJ1OV3FkkTc1NZVQbzQaDfl8XqIRrq6uEqSuRIq9JE6nk7Yg19LSoi66DlHEOpzyU0QZDIfDY9FodBzCExgbDgQC9AB4WmJHmiSJiler1ZVI14dyCaTSqdH15Poo/LggCm+773Y3spo9uqcTckLxZrNZn8vmklhEfnzfJbuA2va3bTL4fPCS0qZPfCVFdQqzisXY/J1lYenhihR5sCJHnMtiuG9pbeE+5vzpZPfrT8suk0KnDC0ULgf7LWv1vDz3dTY+SwKLk2Ti4zsSjLwnC/IH4vD2XFP6udG6v7icCdJeb2WFblaE3K8cir99r42fE2b8oc/TM8Hw5FQwEpia/hQMYWyy75mDXhYqU32dmrUejZjeFhdAG6B73PwLUMJTO+kcmzgAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Stitch Cassandra structure\" title=\"Stitch Cassandra structure\" src=\"https://developers.soundcloud.com/blog/static/582e02631c980b94411d5cf92fe39825/302a3/counts_cassandra.png\" srcset=\"/blog/static/582e02631c980b94411d5cf92fe39825/9ec3c/counts_cassandra.png 200w,\n/blog/static/582e02631c980b94411d5cf92fe39825/c7805/counts_cassandra.png 400w,\n/blog/static/582e02631c980b94411d5cf92fe39825/302a3/counts_cassandra.png 401w\" sizes=\"(max-width: 401px) 100vw, 401px\" loading=\"lazy\" /> </a> </span></p> \n<p>The batch-generated “serving” layer and the real-time or “speed” layer, as coined in the Lambda Architecture, both use <a href=\"https://cassandra.apache.org/\">Cassandra</a> as their primary data store. In the batch layer, we use the Sorted String Table (SSTable) loading feature of Cassandra to effectively ingest even several months of data. For the speed layer, we took a different approach of leveraging the distributed counters feature, issuing every increment (or decrement for comment, repost, or like counts) as a database update.</p> \n<p>The Stitch API constitutes the query layer that consolidates (or should we say <em>stitches</em>) the real-time view and the batch-aggregated numbers seamlessly as a unified response to the clients of the service.</p> \n<h3>Total Counts</h3> \n<p>Given that the system aggregates counts by the creator, track, and time, answering total counts on a given track for all time requires fetching by all track and time buckets. Given this constraint, we added a caching layer to store total counts for a given track. To lower the pressure on our Cassandra cluster, we added a <a href=\"https://memcached.org/\">Memcached</a> cluster to serve approximately the top 90 percent of the most requested total counters.</p> \n<p>We increment both the source-of-truth counters in Cassandra and the cache counters in real time, but in order to limit the divergence of the two views, we <a href=\"https://martinfowler.com/bliki/TwoHardThings.html\">invalidate</a> the entire cache on a daily basis with a randomized time to live (TTL) parameter. The randomization is needed to lower the probability of highly accessed track counters all <a href=\"https://en.wikipedia.org/wiki/Thundering_herd_problem\">invalidating at the same time</a>, which would cause periodic spikes in our cluster usage. The invalidation is needed because our event pipeline only supports at-least-once delivery and the updates are not transactional.</p> \n<h3>Top Lists</h3> \n<p>As part of our stats product for creators, we offer various top lists, thereby allowing them to gain more insight into their audiences and track performances. This system is responsible for generating and serving these lists in a way similar to how Stitch provides counts. By connecting to the same event pipeline, the system aggregates the events and creates partitioned top lists for every dimension we’re interested in, such as the most played tracks for a creator for a day.</p> \n<p>One of the challenges we’ve faced in splitting these two facets of the same product into two different systems is keeping the two views in sync by scheduling them at the same cadence and always triggering recalculation on all the systems affected by a problem. Additionally, it’s important to run spam filtering and throttling as part of a common processing unit upstream in the event pipeline.</p> \n<p>There is another system that provides global top lists. It relies on the same event stream and is a good example of the versatility of having a consistent pipeline that can be tapped into by several decoupled systems. That said, it faces challenges similar to those of the aforementioned stat product for creators in terms of consistency of the numbers and ordering.</p> \n<h1><img src=\"https://developers.soundcloud.com/blog/895d086e871a111fa120219d5d80655f/tools.svg\" alt=\"tools\"> Alternatives</img></h1> \n<p>Our internal engineering culture is driven by <a href=\"https://en.wikipedia.org/wiki/Request_for_Comments\">RFC</a>-based decision making, and one of the key points in these collaborative documents is finding alternatives to the presented solution.</p> \n<p>Additionally, while growing and optimizing a system, it’s important to properly assess whether it’s actually the right thing to do or else consider that maybe it’s time for a radical change. Every time we have to grow our Cassandra cluster or fine-tune the batch jobs to cope with more and more data, we get a tingling feeling that maybe this is not the way forward. The inherent tradeoffs we’ve made around using more storage for query efficiency, or dealing with caching and invalidation, or having to reconcile different views of the same dataset, were all predicated on older knowledge of the problem and solution space.</p> \n<p>By exploring the alternatives (sometimes over and over again) we are able to substantiate our choices. In the case of Stitch, we tried out most of the following approaches, either during SAT (self-allocated time), or as scheduled spikes to improve our systems, but none resulted in a breakthrough that would justify fundamentally changing our current setup (yet).</p> \n<h3>Always Count</h3> \n<p>Historically, we started with a huge database of all events. Every time a statistic or a total count was needed, we issued a query to this database to actually count all the events in real time. This quickly became infeasible and we started extracting this functionality into dedicated databases, and finally into our current Stitch system.</p> \n<p>With “Fast Analytics“ databases “buzzwording” around, it might be time to revisit this approach. By storing these increments in columnar stores that provide efficient analytical queries, we could use less storage than the pre-aggregation approach does. Analytical databases like <a href=\"https://aws.amazon.com/redshift/\">Amazon Redshift</a>, <a href=\"https://cloud.google.com/bigquery\">Google BigQuery</a>, <a href=\"https://kudu.apache.org/\">Apache Kudu</a>, or even <a href=\"https://www.vertica.com/\">Vertica</a> provide results in seconds, but not milliseconds (as our current approach does). Maybe a hybrid approach like <a href=\"https://github.com/filodb/FiloDB\">FiloDB</a>, implementing columnar storage on top of the Cassandra store, could be a valid alternative.</p> \n<h3>Pre-Aggregate Differently</h3> \n<p>Our current solution relies heavily on pre-aggregation, so another approach would be to use a different pre-aggregation scheme by leveraging some funky data structures like <a href=\"https://en.wikipedia.org/wiki/Fenwick_tree\">Fenwick trees</a>. The main challenges would be in creating efficient distributed versions of these <a href=\"https://en.wikipedia.org/wiki/Prefix_sum\">prefix sum</a> data structures.</p> \n<p>One viable way could be by leveraging the partitions already present in our Kafka-based event pipeline and building stateful services by continuously consuming events, similar to Kafka Streams, and providing a query API on top of these mini stores.</p> \n<p>Another challenge is augmenting algorithms to not only result in total counts for a range, but to efficiently calculate all the individual data points for a specific range and granularity. When we tried out this alternative, we represented the trees as sparse arrays, utilizing fast integer-packing algorithms implemented in <a href=\"https://github.com/lemire/JavaFastPFOR\">JavaFastPFOR</a> to lower the serialized footprint of the data. Nonetheless, the overall latencies were not as performant as the Cassandra store approach, and the complexity of the code was significantly higher. Essentially, we were reimplementing a database.</p> \n<p>Another alternative would be to only aggregate data that will be queried. This would trade some initial latency for a queried period for a substantial amount of storage and potentially unused computation time. We could take user requests and pipe this into an adaptive caching system.</p> \n<h1><img src=\"https://developers.soundcloud.com/blog/2b48b1043f93447ab678bfb17fcda9ab/sound.svg\" alt=\"tools\"> Back to the Drawing Board</img></h1> \n<p>As already stated above, none of these approaches has resulted in us changing our setup, because of extra operational/engineering overhead and the unacceptable increase in latency they would require. However, it has taught us valuable lessons about engineering tradeoffs and the challenges of keeping things synchronized and consistent, and we remain open to exploring new ways of keeping track of counts.</p> \n<hr> \n <p>Special thanks to <a href=\"https://github.com/anastasiiabasha\">Anastasiia Basha</a>, <a href=\"https://github.com/jkao\">Jeff Kao</a>, and <a href=\"http://www.natalye.com/\">Natalye Childress</a> for all the help on this post, and of course to other past and present SoundClouders who have contributed to continuously evolving these systems. If you are interested in solving these kinds of challenges, please check out our <a href=\"https://soundcloud.com/jobs\">jobs page</a>.</p> \n</hr>","descriptionType":"html","publishedDate":"Fri, 11 May 2018 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/bb110ebe55e84aad2c7f8a59340e75ee/bubble.svg","linkMd5":"15e0b5215de1cee87672a5788e8bc0b1","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn13@2020_4/2020/08/25/00-49-37-599_5e0d4a66d45afc3d.svg","destWidth":0,"destHeight":0,"sourceBytes":456,"destBytes":456,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/bb110ebe55e84aad2c7f8a59340e75ee/bubble.svg":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn13@2020_4/2020/08/25/00-49-37-599_5e0d4a66d45afc3d.svg","https://developers.soundcloud.com/blog/f2f6d71e2b425162e229c3ffeb0c72a3/gears.svg":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn79@2020_3/2020/08/25/00-51-40-653_3354efc17f15d9f8.svg","https://developers.soundcloud.com/blog/static/d55f08cc89ab80f46068e977d4213585/0901c/counts_stitch.png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn18@2020_1/2020/08/25/00-51-43-411_70af058947cf6c32.webp","https://developers.soundcloud.com/blog/static/582e02631c980b94411d5cf92fe39825/302a3/counts_cassandra.png":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn33@2020_5/2020/08/25/00-51-43-606_7cfa4d598ec92d4f.webp","https://developers.soundcloud.com/blog/895d086e871a111fa120219d5d80655f/tools.svg":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn39@2020_4/2020/08/25/00-51-42-769_9399e41668830282.svg","https://developers.soundcloud.com/blog/2b48b1043f93447ab678bfb17fcda9ab/sound.svg":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn39@2020_5/2020/08/25/00-51-40-716_c76a669ecf38d2f6.svg"},"publishedOrCreatedDate":1598316569975},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Off-Platform Validation","link":"https://developers.soundcloud.com/blog/off-platform-validation","description":"<p>Last month we launched SoundCloud Premier Distribution, which allows creators to distribute their music from SoundCloud to many other streaming platforms and stores. The result? Artists can now get paid for plays on other platforms just like they can on SoundCloud.</p> \n<p>For many of our users, this will be their first experience with the conventions and requirements of the music industry supply chain. The barriers to entry to this world are very different than those to a creator uploading to SoundCloud. At SoundCloud, we’re proud of how easy it is and how few clicks it takes to publish your work. In contrast, the process of getting your content onto Spotify, iTunes, or any of the other platforms fed by distributors has many more strict requirements regarding metadata and media.</p> \n<p>The aim of SoundCloud Premier Distribution is to make the path from SoundCloud upload to off-platform plays as frictionless as possible. Here we’ll look at how a system of automatic and manual validations allows users to get fast feedback as they prepare a release.</p> \n<h2>What Are These Extra Requirements?</h2> \n<p>To upload to SoundCloud, the minimum metadata required is the track title, and even that gets auto-completed based on the name of the file you upload. Easy. There’s a maximum length restriction, but that’s about all.</p> \n<p>To send content to other platforms, the title has many more strict requirements, as do other fields. There are syntactic, structural, and semantic rules that have to be observed. Some examples of these are:</p> \n<ul> \n <li>The metadata has a fixed character set that, in particular, does not include emojis. 😢</li> \n <li>Words in the title should be capitalized, with the exception of a list of short prepositions.</li> \n <li>Some words — such as references to physical formats or other streaming platforms — are not allowed.</li> \n <li>The artist or label name shouldn’t go in the title, as there are other fields for that.</li> \n <li>You shouldn’t specify in the title that it is a live recording or a remastering — there’s another field for that.</li> \n <li>The audio format has minimum quality requirements, as does the artwork image format.</li> \n <li>The title in the album artwork has to match the title.</li> \n</ul> \n<p>There are so many rules and style guides with frightening levels of detail about what will pass quality control for the various streaming services.</p> \n<p>Many of these rules are <strong>difficult to automate completely</strong>. We can’t just block the word “live” in the title, because while “My Hit Song (Live Version)” isn’t allowed, “Live and Let Live” is fine.</p> \n<p>Not only are the rules difficult to navigate, but they are also <strong>spread out in time</strong>. While we can check some rules in real time whenever a user makes a change on soundcloud.com, some take too long to run every time, or they require manual input from our QC team. These checks have to happen asynchronously, with results shown to the user later.</p> \n<p>What’s worse is we can also receive validation failures from streaming services much later — in some cases, even after a track has been live for a while.</p> \n<p>All that said, how do we help the user through this maze of rules that can fail immediately or even weeks later?</p> \n<h2>Automatic Checks with Supervision</h2> \n<p>We’ve built a system of validation rules that can be applied to all of the different fields of metadata. This system checks that data is present and follows the rules, and it reports errors to users. Some rules are easy and can be entirely automatic — for example, image dimensions. Some are almost impossible to check automatically — for example whether or not a track is explicit. And some would be expensive to automate and hard to make correct — for example, genre checking or parsing text from an image. Whenever a change is made to the metadata of a track or a release, it needs to be checked before the update is shipped off-platform.</p> \n<p>So we’ve settled on a mixture of rules that can be applied automatically, those that require human eyes, and those that can defer to a human if there’s doubt. Everything can be overridden manually later.</p> \n<p>The thing is, we need to cope with a lot of volume, and we only have a finite number of humans checking these releases. And while computer time is cheap, theirs is precious.</p> \n<p>As such, there are two lifecycles here that we can model separately:</p> \n<ul> \n <li><strong>Fast automatic feedback</strong> — We want to know whether each product is valid each time we look at it, and so we run the validations every time a user looks at a page. This is fine for simple validations about the presence of data or many of the rules about text fields.</li> \n <li><strong>Asynchronous feedback</strong> — There are expensive validations (e.g. manual) that we want to run at most once for each value of the content (whether text, audio, or image), and not repeatedly if it doesn’t change.</li> \n</ul> \n<p>Consider that a release might change over time as more metadata is added or changed. Each time there’s a change, the fields that were edited should be checked by the QC team, but the team shouldn’t have to, for example, approve the same artwork every time. Unless the image changes, we should store the pass/fail result and use that whenever we want to check the validity of the release. We call that stored pass/fail result <strong>evidence</strong> for the validity of the release.</p> \n<p>To understand these two lifecycles, we can think of a validation result as being the output and having evidence for the validity of the content as an input. When we check a release, we look for indications that the value satisfies the validation rule — either as stored evidence applicable to that value, or by actually checking the content.</p> \n<p>This distinction between slow and fast and synchronous and asynchronous implementations of validation rules has allowed us to run them a lot — every time the user looks at the page, every time we build the rendering of a release that we send to a partner, and every time the release is shown in the QC process. This means that the results are both fast and as up-to-date as possible.</p> \n<h2>Simple Patterns</h2> \n<p>Caching values so they don’t have to be recomputed is not a novel idea. Here we’re treating evidence of validity as a cached result of a validation rule. This has allowed us to model changes to data and the various stages of quality control in a way that combines these very different lifecycles. As a result, we can give fast and consistent feedback to users distributing their content, all without overwhelming our QC team.</p>","descriptionType":"html","publishedDate":"Wed, 06 Mar 2019 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"98188b182534737fb86de167dfdc4b51","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569972},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Apple's June 1 64-bit deadline","link":"https://developers.soundcloud.com/blog/apple_64_bit_deadline","description":"<p>In October 2014, Apple <a href=\"https://developer.apple.com/news/?id=10202014a\">announced</a> that all submissions to the App Store must include \n <nobr>\n  64-bit\n </nobr> support by June 1, 2015. The <a href=\"https://github.com/soundcloud/CocoaSoundCloudAPI\">SoundCloud API for Cocoa</a> contains \n <nobr>\n  32-bit\n </nobr> dependencies and will not be updated, because it has been discontinued. Anyone using the SoundCloud API for Cocoa will need to will need to migrate away from it if they wish to update their app after June 1.</p> \n<p>To ease this transition we have built a <a href=\"https://github.com/soundcloud/iOSOAuthDemo\">sample app</a> that demonstrates how to authorize a user via OAuth using only built-in Foundation libraries.</p> \n<p>Once an <code class=\"language-text\">access_token</code> has been obtained via OAuth, you can make <code class=\"language-text\">GET</code> requests like so:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\">\n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> urlSession <span class=\"token operator\">=</span> <span class=\"token builtin\">NSURLSession</span><span class=\"token punctuation\">.</span><span class=\"token function\">sharedSession</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> urlString <span class=\"token operator\">=</span> <span class=\"token string\">\"https://api.soundcloud.com/me\"</span>\n<span class=\"token keyword\">let</span> urlComponents <span class=\"token operator\">=</span> <span class=\"token function\">NSURLComponents</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">:</span> urlString<span class=\"token punctuation\">)</span><span class=\"token operator\">!</span>\nurlComponents<span class=\"token punctuation\">.</span>queryItems <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span> <span class=\"token function\">NSURLQueryItem</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"oauth_token\"</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">:</span> <span class=\"token string\">\"insert an OAuth token here\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> url <span class=\"token operator\">=</span> urlComponents<span class=\"token punctuation\">.</span><span class=\"token constant\">URL</span><span class=\"token operator\">!</span>\n\n<span class=\"token keyword\">let</span> dataTask <span class=\"token operator\">=</span> urlSession<span class=\"token punctuation\">.</span><span class=\"token function\">dataTaskWithRequest</span><span class=\"token punctuation\">(</span><span class=\"token function\">NSURLRequest</span><span class=\"token punctuation\">(</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">:</span> url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Void</span> <span class=\"token keyword\">in</span>\n   <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> jsonOutput <span class=\"token operator\">=</span> <span class=\"token builtin\">NSJSONSerialization</span><span class=\"token punctuation\">.</span><span class=\"token function\">JSONObjectWithData</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">:</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">String</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">AnyObject</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token comment\">// do stuff with JSON</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\ndataTask<span class=\"token punctuation\">.</span><span class=\"token function\">resume</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p><code class=\"language-text\">POST</code> requests that contain multipart data (e.g. uploading a track) look like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\">\n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">import</span> <span class=\"token builtin\">UIKit</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">uploadTrack</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> trackPath<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> urlSession <span class=\"token operator\">=</span> <span class=\"token builtin\">NSURLSession</span><span class=\"token punctuation\">.</span><span class=\"token function\">sharedSession</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> urlRequest <span class=\"token operator\">=</span> <span class=\"token function\">getURLRequest</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">,</span> audioPath<span class=\"token punctuation\">:</span> trackPath<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> task <span class=\"token operator\">=</span> urlSession<span class=\"token punctuation\">.</span><span class=\"token function\">dataTaskWithRequest</span><span class=\"token punctuation\">(</span>urlRequest<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Void</span> <span class=\"token keyword\">in</span>\n            <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> httpResponse <span class=\"token operator\">=</span> response <span class=\"token keyword\">as</span><span class=\"token operator\">?</span> <span class=\"token builtin\">NSHTTPURLResponse</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"returned <span class=\"token interpolation\"><span class=\"token delimiter variable\">\\(</span>httpResponse<span class=\"token punctuation\">.</span>statusCode<span class=\"token delimiter variable\">)</span></span>\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> data <span class=\"token operator\">!=</span> <span class=\"token constant\">nil</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">let</span> response <span class=\"token operator\">=</span> <span class=\"token function\">NSString</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">,</span> encoding<span class=\"token punctuation\">:</span> <span class=\"token builtin\">NSUTF8StringEncoding</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">println</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> err <span class=\"token operator\">=</span> error <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">println</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        task<span class=\"token punctuation\">.</span><span class=\"token function\">resume</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">getURLRequest</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> audioPath<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">NSURLRequest</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> boundary <span class=\"token operator\">=</span> <span class=\"token function\">NSUUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">UUIDString</span>\n        <span class=\"token keyword\">let</span> request <span class=\"token operator\">=</span> <span class=\"token function\">NSMutableURLRequest</span><span class=\"token punctuation\">(</span><span class=\"token constant\">URL</span><span class=\"token punctuation\">:</span> <span class=\"token function\">NSURL</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">:</span> <span class=\"token string\">\"https://api.soundcloud.com/tracks\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!</span><span class=\"token punctuation\">)</span>\n        request<span class=\"token punctuation\">.</span><span class=\"token builtin\">HTTPMethod</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"POST\"</span>\n        request<span class=\"token punctuation\">.</span><span class=\"token builtin\">HTTPBody</span> <span class=\"token operator\">=</span> <span class=\"token function\">getPostData</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"insert an OAuth token here\"</span><span class=\"token punctuation\">,</span> boundary<span class=\"token punctuation\">:</span> boundary<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">:</span> title<span class=\"token punctuation\">,</span> audioPath<span class=\"token punctuation\">:</span> audioPath<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> contentType <span class=\"token operator\">=</span> <span class=\"token string\">\"multipart/form-data; boundary=\"</span> <span class=\"token operator\">+</span> boundary\n        request<span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>contentType<span class=\"token punctuation\">,</span> forHTTPHeaderField<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> request\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">getPostData</span><span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> boundary<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">,</span> audioPath<span class=\"token punctuation\">:</span> <span class=\"token builtin\">String</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">NSData</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> boundaryStart <span class=\"token operator\">=</span> <span class=\"token string\">\"--<span class=\"token interpolation\"><span class=\"token delimiter variable\">\\(</span>boundary<span class=\"token delimiter variable\">)</span></span>\\r\\n\"</span>\n        <span class=\"token keyword\">let</span> boundaryEnd <span class=\"token operator\">=</span> <span class=\"token string\">\"\\r\\n--<span class=\"token interpolation\"><span class=\"token delimiter variable\">\\(</span>boundary<span class=\"token delimiter variable\">)</span></span>--\\r\\n\"</span>\n        <span class=\"token keyword\">let</span> bodyData <span class=\"token punctuation\">:</span> <span class=\"token builtin\">NSMutableData</span> <span class=\"token operator\">=</span> <span class=\"token function\">NSMutableData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\">// add the token</span>\n        <span class=\"token keyword\">var</span> tokenSection <span class=\"token operator\">=</span> boundaryStart\n        tokenSection <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token string\">\"Content-Disposition: form-data; name=\\\"oauth_token\\\"\\r\\n\\r\\n\"</span>\n        tokenSection <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token delimiter variable\">\\(</span>token<span class=\"token delimiter variable\">)</span></span>\\r\\n\"</span>\n        bodyData<span class=\"token punctuation\">.</span><span class=\"token function\">appendData</span><span class=\"token punctuation\">(</span>tokenSection<span class=\"token punctuation\">.</span><span class=\"token function\">dataUsingEncoding</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">NSUTF8StringEncoding</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\">// add the track title</span>\n        <span class=\"token keyword\">var</span> titleSection <span class=\"token operator\">=</span> boundaryStart\n        titleSection <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token string\">\"Content-Disposition: form-data; name=\\\"track[title]\\\"\\r\\n\\r\\n\"</span>\n        titleSection <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token delimiter variable\">\\(</span>title<span class=\"token delimiter variable\">)</span></span>\\r\\n\"</span>\n        bodyData<span class=\"token punctuation\">.</span><span class=\"token function\">appendData</span><span class=\"token punctuation\">(</span>titleSection<span class=\"token punctuation\">.</span><span class=\"token function\">dataUsingEncoding</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">NSUTF8StringEncoding</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\">// add the audio file</span>\n        <span class=\"token keyword\">let</span> trackData <span class=\"token operator\">=</span> <span class=\"token function\">NSData</span><span class=\"token punctuation\">(</span>contentsOfFile<span class=\"token punctuation\">:</span> audioPath<span class=\"token punctuation\">)</span><span class=\"token operator\">!</span>\n        <span class=\"token keyword\">var</span> trackSection <span class=\"token operator\">=</span> boundaryStart\n        trackSection <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token string\">\"Content-Disposition: form-data; name=\\\"track[asset_data]\\\"; \"</span>\n        trackSection <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token string\">\"filename=\\\"<span class=\"token interpolation\"><span class=\"token delimiter variable\">\\(</span>audioPath<span class=\"token punctuation\">.</span>lastPathComponent<span class=\"token delimiter variable\">)</span></span>\\\"\\r\\n\"</span>\n        trackSection <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token string\">\"Content-Type: application/octet-stream\\r\\n\"</span>\n        trackSection <span class=\"token operator\">+</span><span class=\"token operator\">=</span> <span class=\"token string\">\"\\r\\n\"</span>\n        bodyData<span class=\"token punctuation\">.</span><span class=\"token function\">appendData</span><span class=\"token punctuation\">(</span>trackSection<span class=\"token punctuation\">.</span><span class=\"token function\">dataUsingEncoding</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">NSUTF8StringEncoding</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!</span><span class=\"token punctuation\">)</span>\n        bodyData<span class=\"token punctuation\">.</span><span class=\"token function\">appendData</span><span class=\"token punctuation\">(</span>trackData<span class=\"token punctuation\">)</span>\n        bodyData<span class=\"token punctuation\">.</span><span class=\"token function\">appendData</span><span class=\"token punctuation\">(</span>boundaryEnd<span class=\"token punctuation\">.</span><span class=\"token function\">dataUsingEncoding</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">NSUTF8StringEncoding</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> bodyData\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p><strong>Note:</strong> This example assumes access tokens will never expire, however, we encourage you not to make this assumption in your production code. Instead, build your app assuming that tokens will periodically expire and can be refreshed using a refresh token. For details on how to use a refresh token, see <a href=\"https://tools.ietf.org/html/rfc6749#section-1.5\">Section 1.5 of the OAuth 2.0 specification</a>.</p>","descriptionType":"html","publishedDate":"Mon, 18 May 2015 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"d44a346a26a4fa5f0cc4358eda1afc76","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569992},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Competition App - Host a contest, powered by SoundCloud","link":"https://developers.soundcloud.com/blog/competition-app","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 550px;\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.63636363636363%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAACxElEQVQoz1WS2U9TQRTGxwbFB4WgRgKtgQKhpTa0LAlWkaWA2hI1KMr2AOJCIKiIASOQGGJBaUsT/wQiTyqCSwBFEllkUaAL0NICt7d3a3u7Q1keIDjFF/zlm5xJJmfJnA+QyCppRkiLxU4Qbrvd66A9/8u7L6fViqIWkiQpisIwnCCInZ0dYFLKjKp2Q+szo6x5Vd6Kd8qwThmqeGlVySwqGaqSIao2QtWmfSPPyM6O4XJ5AmE8nx9/li9XKAD6sAKprUDqH5hK8qmWuomiy98k58nCzKH8jPH89BWpSCcRGS+l/rwtZbPOBAFwIjj4KIPBAKCyvBzoRDxdhmBenKJOZCG3rkyzj3ffDO+/y2yMOjR5KkgdGzLDC1+ID/uUFNP7okn3qHriSfVkbcXU4/uvmp6DpapSQ0ONsaFmjh+BFUu0WZHGt+LhnsL+vNAVYRQcavleEdVY8+NO8WBVyXStaORqCnI921xZqGxpBjORh3+fBrORQdNHgKlAYmAfU3ckdjdzphMY82GMOc7J2ZiQ+bjQz0lxQ8W5v55GTwhCF3isBXHK64Z6oMlJ/nOBp85MNOQkmZvrlguylkrP9VxLM99IX5Gk6XOTDXmpiFjwXXpx7MM78stH/GuvZ6jfMzosb28HFhSFv+/zevf29vzr64uLehLF3Fbbpt+/EQBG/+7urn5R/76vT29Gnf4N+9q6y78hlysARZIOh2N7exsmwxJjY6N2miYokiBwEsdwLABN0+Pj46MjIy67zQZXjGN2q02pVAIHTcPVO10umLy5uQnvVpsNCrqBpignSdqtVpfbPTk1OTA4gJhMOo1mSa/HzGhHhxzsHWBrawvHA+6hAkai8H0/4QTucDq1Wk0ClxvBZHK4CXGxcUwWq6ysFKwdwOfzuf/hgYLHDXu6XC74BCtKpRI2O1ooFHA40GC8rq6uv28ay81K0QFxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Competition\" title=\"Competition\" src=\"https://developers.soundcloud.com/blog/static/0cf3edd86f936113ae3447faaf202966/2cf63/competition.png\" srcset=\"/blog/static/0cf3edd86f936113ae3447faaf202966/9ec3c/competition.png 200w,\n/blog/static/0cf3edd86f936113ae3447faaf202966/c7805/competition.png 400w,\n/blog/static/0cf3edd86f936113ae3447faaf202966/2cf63/competition.png 550w\" sizes=\"(max-width: 550px) 100vw, 550px\" loading=\"lazy\" /> </span></p> \n<p>Competitions are a great way to get your fans involved around a particular theme or release. They encourage original content creation and tend to be extremely viral due to the high level of self-promotion involved with participating.</p> \n<p>The infrastructure you choose to throw these contests on should be accessible from any device while also providing a nice aesthetic backdrop to apply your branding. Users should be able to submit, vote, and comment no matter where they’re coming from: Web, iPhone, Facebook Tab, etc.</p> \n<p>Today we’re putting forth an <em>open-source</em> app called <a href=\"https://github.com/soundcloud/soundcloud-competition\">Competition</a> which we think is a great solution to the problem.</p> \n<!-- more --> \n<p>While I explain what makes this app unique, it may help to follow along with any of the live examples here:</p> \n<p><a href=\"http://contest.mastodonrocks.com\">contest.mastodonrocks.com</a></p> \n<p><a href=\"http://brandnewunsigned.mtv.co.uk\">brandnewunsigned.mtv.co.uk</a></p> \n<p><a href=\"http://remix.moby.com\">remix.moby.com</a></p> \n<p>I’ll be discussing the main sections and features: Front Page, Track Page, Submit Page, and Mobile</p> \n<p>&nbsp;</p> \n<h3><a href=\"http://contest.mastodonrocks.com/\">Front Page</a></h3> \n<p>This well structured page includes the following:</p> \n<ul> \n <li>Call to action block which gives a brief intro into your competition</li> \n <li>Large banner graphic</li> \n <li>Long form explanation about the competition</li> \n <li>Two columns showing both new tracks and those which are most popular</li> \n <li>Section for prizing</li> \n <li>And finally, a separate section to promote your company or artist</li> \n</ul> \n<p>&nbsp;</p> \n<h3><a href=\"http://contest.mastodonrocks.com/tracks/12\">Track Page</a></h3> \n<p>SoundCloud powers all voting, commenting, favoriting, and submitting which allows for a sync between your Competition app and SoundCloud. So when users comment on a track on the app, they’re also contributing a comment to the track on SoundCloud which carries socially. Simply login (or sign-up, we have Facebook for login too) with your SoundCloud account to participate. In addition this page includes about, stats, and sharing.</p> \n<p>&nbsp;</p> \n<h3><a href=\"http://contest.mastodonrocks.com/submit\">Submit Page</a></h3> \n<p>The submission system works simply enough:</p> \n<ol> \n <li>Sign-up for SoundCloud (if you haven’t already)</li> \n <li>Upload your track to SoundCloud</li> \n <li>Return to the app, login, and select your track from the provided drop-down list</li> \n</ol> \n<p>The song will then be instantly added to the app and the submitter will be encouraged to share it with friends.</p> \n<p>&nbsp;</p> \n<h3><a href=\"http://vimeo.com/26834553\">Mobile</a></h3> \n<p>Competition is built from the group up to play nicely with mobile devices. Here’s how:</p> \n<ul> \n <li>The player was built with an HTML5 fallback so it will work on as many devices as possible, such as the iPhone or iPad</li> \n <li>The entire layout is elastic so it resizes auto-magically to the screen size of your device. Try resizing your browser down or opening one of the examples up on your iPhone.</li> \n</ul> \n<p>This additional layer of accessibility will add tons to the engagement. Allowing creators and voters to participate in your competition from anywhere.</p> \n<p>&nbsp;</p> \n<h3><a href=\"https://github.com/soundcloud/soundcloud-competition/wiki/How-to-Deploy\">Deploy Instructions</a></h3> \n<p>Competition is an open-source <a href=\"http://rubyonrails.org/\">Ruby on Rails</a> application that must be deployed to a server which supports the RoR framework. We highly recommend <a href=\"http://www.heroku.com/\">Heroku</a> as the server of choice because it offers a free base server and makes deploying RoR apps much easier. You should also have a basic understanding of <a href=\"http://git-scm.com/\">Git</a> and a local version of RoR running for development purposes.</p> \n<p>If all that sounds good: check out the basic deploy instructions on <a href=\"https://github.com/soundcloud/soundcloud-competition/wiki/How-to-Deploy\">Github</a>.</p> \n<p>If everything I said above went over your head: <strong>don’t sweat!</strong> Drop me a line at <a href=\"mailto:lee@soundcloud.com\">lee@soundcloud.com</a> about your competition and we’ll let you know when we launch a turn-key version of Competition.</p> \n<p>&nbsp;</p> \n<h3>Thanks</h3> \n<p>If you end up deploying the app yourself or have a feature request, please send me an email <a href=\"mailto:lee@soundcloud.com\">lee@soundcloud.com</a> or contact me on Twitter <a href=\"https://twitter.com/leemartin\">@leemartin</a>.</p> \n<p>If you find any bugs, let me know on the Github <a href=\"https://github.com/soundcloud/soundcloud-competition/issues\">issues portal</a>.</p>","descriptionType":"html","publishedDate":"Mon, 14 Nov 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/0cf3edd86f936113ae3447faaf202966/2cf63/competition.png","linkMd5":"b733a1edefe5ee8fd8cd6bb8a58e817d","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn90@2020_5/2020/08/25/00-49-37-185_3e8eea38fb2f57a0.webp","destWidth":550,"destHeight":317,"sourceBytes":44279,"destBytes":28346,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/0cf3edd86f936113ae3447faaf202966/2cf63/competition.png":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn90@2020_5/2020/08/25/00-49-37-185_3e8eea38fb2f57a0.webp"},"publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Prometheus: Monitoring at SoundCloud","link":"https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud","description":"<p>In <a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith\">previous</a> <a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-2-breaking-the-monolith\">blog</a> <a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-3-microservices-in-scala-and-finagle\">posts</a>, we discussed how SoundCloud has been moving towards a microservice architecture. Soon we had hundreds of services, with many thousand instances running and changing at the same time. With our existing monitoring set-up, mostly based on StatsD and Graphite, we ran into a number of serious limitations. What we really needed was a system with the following features:</p> \n<ul> \n <li>A <strong>multi-dimensional</strong> data model, so that data can be sliced and diced at will, along dimensions like instance, service, endpoint, and method.</li> \n <li><strong>Operational simplicity</strong>, so that you can spin up a monitoring server where and when you want, even on your local workstation, without setting up a distributed storage backend or reconfiguring the world.</li> \n <li><strong>Scalable data collection</strong> and decentralized architecture, so that you can reliably monitor the many instances of your services, and independent teams can set up independent monitoring servers.</li> \n <li>Finally, a <strong>powerful query language</strong> that leverages the data model for meaningful alerting (including easy silencing) and graphing (for dashboards and for ad-hoc exploration).</li> \n</ul> \n<p>All of these features existed in various systems. However, we could not identify a system that combined them all until a colleague started an ambitious pet project in 2012 that aimed to do so. Shortly thereafter, we decided to develop it into SoundCloud’s monitoring system: <a href=\"http://prometheus.io\">Prometheus</a> was born.</p> \n<!-- more --> \n<p>Prometheus is written in <a href=\"http://golang.org/\">Go</a> and has been <a href=\"https://github.com/prometheus\">open source from the beginning</a>. Despite being intentionally quiet about it, we gained a few committed external users and contributors, most notably from <a href=\"https://www.docker.com/\">Docker</a> and <a href=\"http://www.boxever.com/\">Boxever</a>. Since then, Prometheus has become the standard monitoring solution at SoundCloud. With the level of maturity reached, we would like to tell you more about it.</p> \n<p>Our friends from Boxever and Docker are also publishing blog posts simultaneously about their usage of Prometheus:</p> \n<ul> \n <li><a href=\"http://www.boxever.com/prometheus-a-next-generation-monitoring-system\">Prometheus: A Next-Generation Monitoring System</a></li> \n <li><a href=\"http://5pi.de/2015/01/26/monitor-docker-containers-with-prometheus\">Monitor Docker Containers with Prometheus</a></li> \n</ul> \n<h2>Architecture</h2> \n<p>This diagram illustrates the overall architecture of Prometheus and some of its ecosystem components:</p> \n<p><img src=\"https://developers.soundcloud.com/blog/6ad4784882b3758430eea84a3c25486b/prometheus_architecture.svg\" alt=\"Prometheus architecture\" /></p> \n<p>Prometheus servers scrape metrics from instrumented jobs, either directly or via an intermediary push gateway for short-lived jobs. They store all scraped samples locally and run rules over this data to either record new timeseries from existing data or generate alerts. PromDash (a web-based dashboard builder) or other API consumers can be used to visualize the collected data.</p> \n<p>Prometheus’s main features are:</p> \n<ul> \n <li>A multi-dimensional data model.</li> \n <li>A flexible query language to leverage this dimensionality.</li> \n <li>No reliance on distributed storage; single server nodes are autonomous.</li> \n <li>Time series collection happens via a pull model over HTTP.</li> \n <li>Pushing time series is supported via an intermediary gateway.</li> \n <li>Targets are discovered via service discovery or static configuration.</li> \n <li>Multiple modes of graphing and dashboarding support.</li> \n</ul> \n<p>See also the <a href=\"http://prometheus.io/docs/introduction/overview/\">Overview section</a> of the documentation.</p> \n<h2>Data model</h2> \n<p>Prometheus fundamentally stores all data as time series: streams of timestamped values belonging to the same metric and the same set of labeled dimensions. Timestamps have a millisecond resolution, while values are always 64-bit floats.</p> \n<p>The metric name specifies the general feature of a system that is measured. For example, a metric to count the total number of HTTP requests received by an API server might be called <code class=\"language-text\">api_http_requests_total</code>. Adding labels (key/value pairs) to this metric enables Prometheus’s dimensional data model: any given combination of labels for the same metric name results in a separate time series. One example time series for this metric might represent all the received HTTP requests that used the method <code class=\"language-text\">GET</code> for querying the endpoint <code class=\"language-text\">/api/tracks</code> and resulted in a <code class=\"language-text\">200</code> HTTP status code. For naming a time series like that, we use this notation:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">api_http_requests_total{method=\"GET\", endpoint=\"/api/tracks\", status=\"200\"}</code></pre> \n</div> \n<p>The query language then allows filtering and aggregation based on these dimensions. Prometheus’s label-based data model is fundamentally the same as the one of <a href=\"http://opentsdb.net/\">OpenTSDB</a> and even has a similar syntax.</p> \n<p>Metrics in Prometheus have a type to indicate their meaning and usage. Prometheus currently supports three metric types:</p> \n<ul> \n <li>A <strong>counter</strong> is a cumulative metric that represents a value that only ever goes up, like a request count.</li> \n <li>A <strong>gauge</strong> is a metric that represents a value that can arbitrarily go up and down, like a temperature or a queue length.</li> \n <li>A <strong>summary</strong> is a client-side calculated histogram of observations, usually used to measure request durations or sizes.</li> \n</ul> \n<p>For more information on Prometheus’s data model, see the <a href=\"http://prometheus.io/docs/concepts/data_model/\">Data model</a> and <a href=\"http://prometheus.io/docs/concepts/metric_types/\">Metric types</a> sections in the documentation.</p> \n<h2>Query language</h2> \n<p>The Prometheus query language allows you to slice and dice the dimensional data for ad-hoc exploration, graphing, and alerting. We’ll talk about the use of the query language for dashboards and alerting in the next two sections. Your first steps with the query language are best done using the <a href=\"http://prometheus.io/docs/visualization/browser/\">expression browser</a> offered by each Prometheus server.</p> \n<p>As an example, we have instrumented Bazooka, our internal Heroku-style deployment system, with Prometheus. This provides us with per-instance metrics about memory usage, memory limits, CPU usage, out-of-memory failures, instance restarts, and so on. Each of these metrics is labeled by application, process type, Git revision, environment, and instance ID. This has frequently been useful for debugging both single-instance problems, as well as for doing cluster-wide resource usage analysis. For instance, badly-configured Bazooka applications might set large container memory limits, yet not use a lot of the reserved memory. This screenshot shows a query for the worst RAM wasters across a Bazooka cluster (click the image to view a full-sized version):</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/5938801e9e8897edc802c48ebde57744/c2b5a/prometheus_bazooka_memory_wasters.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9klEQVQoz5WQwW6EIBCGeZu2B3APvmGPfY9e+hpN+hBqso1NNFJAEIUFxA7u1jSbrJt+pxkm//w/g7LskOc5JpgQnJEsIwmM8dMuD48JVNd1VVVlUZRFWZXVRlGk/pfUbcPP4/H59f3l7QNZH6wL3rm4/AMTllNYkJSyo3QY1DiO8zzHlT9FvEIIPk1TWhAjgkpwzhjnXFhr1sebwLSXPdhAAQZIa00pZYwJIZz3e9JVLJWcjLmIB6Wapuk6yE6Nue/MBR+0vojhz18rsEIp5Zw73QamtOv6vncryblt27OztTbeiw230Zsz3Pks/mbM+7Cb+lr8A2K3EEUZTHVDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Bazooka memory wasters\" title=\"Bazooka memory wasters\" src=\"https://developers.soundcloud.com/blog/static/5938801e9e8897edc802c48ebde57744/8ff1e/prometheus_bazooka_memory_wasters.png\" srcset=\"/blog/static/5938801e9e8897edc802c48ebde57744/9ec3c/prometheus_bazooka_memory_wasters.png 200w,\n/blog/static/5938801e9e8897edc802c48ebde57744/c7805/prometheus_bazooka_memory_wasters.png 400w,\n/blog/static/5938801e9e8897edc802c48ebde57744/8ff1e/prometheus_bazooka_memory_wasters.png 800w,\n/blog/static/5938801e9e8897edc802c48ebde57744/c2b5a/prometheus_bazooka_memory_wasters.png 982w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Similar queries allow us to identify potentially misconfigured applications and reach out to their developers.</p> \n<p>As another related example, we might want to graph the top three CPU users on a Bazooka cluster as measured over the last five minutes, grouped by application and process type:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/d16372095651eb4c86d6556e9a4ebf14/1c938/prometheus_bazooka_cpu_top3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 65.20112254443406%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABmElEQVQoz21SO04DMRDd4yDxERGJICeAA0CZGyBRQAlFDoCg4xQpkeigpqamhWxCyH5sj+fjMN4PWT5P1uzs2DNv3tjJ/sH+cDjsR+wN+v3BQE2/1+vt/oT+b27tbGxud4PJx3z+/j59m05ns9k8Ypam0zRNF4tF2YF35v759e7hpTTGOVsjIUQH6FFCi1WFrlP7ariJNUiYGRCItISzzhCRiGjQV0BEADDWajCESCAt1I/JBSyBDbIjARSoDq2Zv9FEwrqdhJgyMMCk7BSCI7BUsGA8GVYkLLGWaAILo5BnJEFmqpNZXd1Xi8KetQHOfZlDnkG2jLZdLiuwMGhKrwM0TdsqsW6ltc3kKk4VsJLGl66EmFxL/5b0V+qvrdBUrwamSiH79Hls0OvKlgF9JCJkgEDUzmjNuGbWtrts6pM1VBbknKAnU7IpdALsLGq8yFGX7tpKswd/fXtzeXU5Ho/PLy6eHh+1BMVJxAvTL+sLAtB7R2OqX31VNjYVkz2enZ2enByPRqPDw6PJZBJvpR7h6h/93R6/AFcgvQqBjszAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Bazooka top CPU users\" title=\"Bazooka top CPU users\" src=\"https://developers.soundcloud.com/blog/static/d16372095651eb4c86d6556e9a4ebf14/8ff1e/prometheus_bazooka_cpu_top3.png\" srcset=\"/blog/static/d16372095651eb4c86d6556e9a4ebf14/9ec3c/prometheus_bazooka_cpu_top3.png 200w,\n/blog/static/d16372095651eb4c86d6556e9a4ebf14/c7805/prometheus_bazooka_cpu_top3.png 400w,\n/blog/static/d16372095651eb4c86d6556e9a4ebf14/8ff1e/prometheus_bazooka_cpu_top3.png 800w,\n/blog/static/d16372095651eb4c86d6556e9a4ebf14/1c938/prometheus_bazooka_cpu_top3.png 1069w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>For intense queries that take a long time to evaluate, you can configure Prometheus to precompute them in the background. Precomputed expressions are called <em>rules</em>. They have a name, which is used like the name of a metric in other expressions.</p> \n<p>For more details about the query language, see the <a href=\"http://prometheus.io/docs/querying/basics/\">documentation</a>.</p> \n<h2>Dashboards</h2> \n<p>The one-stop solution for the fanciest dashboards is <a href=\"http://prometheus.io/docs/visualization/promdash/\">PromDash</a>, a GUI-based dashboard builder with a SQL backend. It talks to any number of Prometheus servers via an HTTP API and graphs their data in highly configurable dashboards. Even Graphite graphs can be included.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/a2ecbeb647062fed5ab2e252546b74b3/40872/promdash_event_processor.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 64.19545071609099%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC5klEQVQ4y5WT3YsbZRTGh14Iu6mbZPIxM5nvmcxMZiZpks1Hk2VTdd20a4uWpbZS2e4WC1akRaRW96IIIlK9EJReiWBFUC9sBcH/7+eZrC4I3njxcHgP7/s85zzvOYrv+7iuS7WqCqpYlkWr1VpF27b/NxRDHmdZRhxHhGFIkiSkaYd6vc7a2hqlUon19fVV/Bckt/4fUFRVxZZqdF0/hWG0UNUqpbNn2djYoFqpotZUKpWyoEK5XKapNVfnQrTAiagQ6lqDSKoqqiug65pYYNE712fQ75N3u9S1OrbpkKdd8iwl7SRYpkuzZqBrutjTwtANKhs1lLnt8Vo3xbBMTNtiO/S5NZ1y9fIldnaXvH5xl6XfZnsRMdnqYRkegRcwnHhcfWuA57sYTY+w7dMbWULohNyP5wxE0XVccvmgtqhWX1hDOXOGvKZzMxzz6NMePz8/z6tXfN79IOPZn1v8/secz74aMtp2ePztiC++7KOM8w7vXVlyezjjjdGQvdmQ5XTA5VmXHT/m+oVN9l+e8+Fum1/u9nn6aMxPH2/yw1GX727k/HhvwNPPJ/z2ySYPd0PxsBaStRdM8gnTdE7uL+gGFxhnC14ZzRmn2/jWlJek1UM34h2x5NALuWZG3HASjvyIO1HIgZuwI3eU4hN6vZ6MTQc/CGUG9b9hUm8amKZFo1HHEiuiNCdox3hhRJLlkvNQG5rc06lphkRN5lDGJEszEjE1bgcE8tC2bKIwwPcckriNJp76jkMUBCJgrvJZEtL2Pblrohs6oe/g2iZKXdTj2KKsapRebOIGLlk3WP16papRkXyrZQiphllskBC6jn06s7Z04MqG+K4tnTRQ9i+ZPH9yjjtvd7h1PeLXb/o8ezLg+8c99pYhH91N+Po4lkqEVGatIGzJ4BuGcYpABIrYbDZRdsYBxwcL3n9zzsODGff3z3N7b4sHN+c8OJxyfDTj3rXNVZXFjp9s0glRcS7iP7mC8C/TvYE2Kq4UZQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"PromDash screenshot\" title=\"PromDash screenshot\" src=\"https://developers.soundcloud.com/blog/static/a2ecbeb647062fed5ab2e252546b74b3/8ff1e/promdash_event_processor.png\" srcset=\"/blog/static/a2ecbeb647062fed5ab2e252546b74b3/9ec3c/promdash_event_processor.png 200w,\n/blog/static/a2ecbeb647062fed5ab2e252546b74b3/c7805/promdash_event_processor.png 400w,\n/blog/static/a2ecbeb647062fed5ab2e252546b74b3/8ff1e/promdash_event_processor.png 800w,\n/blog/static/a2ecbeb647062fed5ab2e252546b74b3/40872/promdash_event_processor.png 1187w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>If you want to serve simple dashboards from the Prometheus server directly (without the need of a separate application with SQL backend), have a look at <a href=\"http://prometheus.io/docs/visualization/consoles/\">console templates</a>. SoundCloud uses PromDash as its main way for visualizing Prometheus data.</p> \n<h2>Alerting</h2> \n<p>Alerts are defined using the same powerful query language described above. A separate binary, the <a href=\"https://github.com/prometheus/alertmanager\">Alertmanager</a>, handles alert notifications and aggregations and enables silencing by any label set. If an alert fires, Alertmanager can send an email or page you through an external alerting service like <a href=\"http://www.pagerduty.com/\">PagerDuty</a>.</p> \n<p>We also offer a <a href=\"https://github.com/prometheus/nagios_plugins\">Nagios plugin</a> as a bridge from the parts that are already monitored by Prometheus to the existing Nagios alerting set-up that many companies have in place. In fact, SoundCloud uses exactly that configuration for production alerting, which is why the Alertmanager is still less mature than the rest of the Prometheus ecosystem. We plan to move to fully native Prometheus alerting soon.</p> \n<p>For more information, see the documentation about <a href=\"http://prometheus.io/docs/querying/rules/#alerting-rules\">configuring alerting rules</a> and <a href=\"http://prometheus.io/docs/practices/alerting/\">alerting best practices</a>.</p> \n<h2>Storage</h2> \n<p>One of our goals was to run a Prometheus server with millions of time series and tens of thousands of samples ingested per second on a single server using its local disk. You might think everything should be distributed-something nowadays, but distributed systems demand payment in complexity and operational burdens. How many of you would love to run OpenTSDB but shy away from maintaining a whole Hadoop cluster just for that? With Prometheus, you shard servers by function and run multiple replicas of the same shard for redundancy. Cross-server queries are not possible, but we are working on a hierarchical federation scheme where a higher-level Prometheus server collects selected metrics from subordinated Prometheus servers.</p> \n<p>Designing the local time series database for Prometheus was an adventure of its own. We explored and compared many existing local storage implementations. Based on our research, we decided to use <a href=\"https://github.com/syndtr/goleveldb\">LevelDB</a> for indices and our own design for storing the actual sample values and timestamps.</p> \n<p>The disk storage of a server is naturally limited (depending on the rate of incoming samples, we usually keep several weeks or months around, without any downsampling), and the disk can fail permanently (resulting in data loss, at least on that one replica). Whoever requires true durability of samples will need some kind of distributed storage. Prometheus already has experimental support for streaming collected samples to OpenTSDB as a permanent storage, turning the Prometheus ecosystem into a collection machinery for OpenTSDB. One day, we would like to support the complete round-trip, i.e. Prometheus queries can read data back from OpenTSDB. Other time series databases might get support too, but the differences in the data model are a challenge.</p> \n<h2>Getting your service ready for Prometheus</h2> \n<p>Prometheus-style monitoring relies on instrumenting your own code directly. This is very different from traditional strategies to monitor applications, where the monitored application is often completely ignorant of the monitoring system, which uses plugins or agents to talk to the application in its own language. The high-quality service-based monitoring you get from your handwritten instrumentation is usually worth the price.</p> \n<p>To instrument code, we offer client libraries for <a href=\"https://github.com/prometheus/client_golang\">Go</a>, <a href=\"https://github.com/prometheus/client_java\">Java</a>, and <a href=\"https://github.com/prometheus/client_ruby\">Ruby</a>. As the Java client library is usable from any JVM language, this completely covers the needs of SoundCloud. A Python client is also under development. These client libraries allow you to track and expose metrics over HTTP. The default exposition format is <a href=\"https://developers.google.com/protocol-buffers/\">protocol buffers</a>, but we also support a very simple text-based format, which can be used for easy “library-less” exposition of metrics even from shell scripts.</p> \n<p>To mimic the ways of traditional monitoring approaches, there are a number of <a href=\"http://prometheus.io/docs/instrumenting/exporters/\">exporters</a> for certain types of servers, like the <a href=\"https://github.com/prometheus/haproxy_exporter/\">HAProxy Exporter</a> to <a href=\"http://www.boxever.com/haproxy-monitoring-with-prometheus\">export metrics of an HAProxy</a> or the <a href=\"https://github.com/prometheus/node_exporter\">Node Exporter</a> to export varius node attributes.</p> \n<p>Finally, if you have short-lived jobs like cronjobs that cannot wait for Prometheus to scrape them, there is the <a href=\"https://github.com/prometheus/pushgateway\">Pushgateway</a>, to which you can push metrics. The Pushgateway will then present these metrics permanently to Prometheus for scraping.</p> \n<h2>Conclusion</h2> \n<p>Prometheus has proven to be very useful at SoundCloud. It drives our internal monitoring, facilitates firefighting during outages and provides further insight into them for postmortems. We run Prometheus as an open-source project because we believe it can benefit the infrastructure community as a whole. If you are interested in getting involved, check out the <a href=\"http://prometheus.io/community/\">Prometheus community</a>.</p> \n<p><em>Special thanks to <a href=\"http://matttproud.com\">Matt T. Proud</a>, who initially started the Prometheus project.</em></p>","descriptionType":"html","publishedDate":"Mon, 26 Jan 2015 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/6ad4784882b3758430eea84a3c25486b/prometheus_architecture.svg","linkMd5":"f97e1f94d709bd0c92f56241478cd401","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn84@2020_4/2020/08/25/00-49-37-671_b9f090eee9ffe3f9.svg","destWidth":0,"destHeight":0,"sourceBytes":26266,"destBytes":26266,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/6ad4784882b3758430eea84a3c25486b/prometheus_architecture.svg":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn84@2020_4/2020/08/25/00-49-37-671_b9f090eee9ffe3f9.svg","https://developers.soundcloud.com/blog/static/5938801e9e8897edc802c48ebde57744/8ff1e/prometheus_bazooka_memory_wasters.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn12@2020_1/2020/08/25/00-51-40-862_a7417631e8b2ecea.webp","https://developers.soundcloud.com/blog/static/d16372095651eb4c86d6556e9a4ebf14/8ff1e/prometheus_bazooka_cpu_top3.png":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn3@2020_5/2020/08/25/00-51-44-196_baffd473ec2ce6f0.webp","https://developers.soundcloud.com/blog/static/a2ecbeb647062fed5ab2e252546b74b3/8ff1e/promdash_event_processor.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn43@2020_5/2020/08/25/00-51-40-889_51664a87f5d3a132.webp"},"publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"New Sharing Interface","link":"https://developers.soundcloud.com/blog/new-sharing-interface","description":"<p>Today we announce a better way to share sounds in SoundCloud via the API.</p> \n<p>The new interface resembles the way sharing happens on the website. You can retrieve, create, update and delete sharings to other users on SoundCloud based on user_id or email address for your tracks and playlists.</p> \n<!-- more --> \n<p>The following new resource are available:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">GET                    /tracks/{id}/shared-to\nGET, POST, PUT, DELETE /tracks/{id}/shared-to/users\nGET, POST, PUT, DELETE /tracks/{id}/shared-to/emails\n\nGET                    /playlists/{id}/shared-to\nGET, POST, PUT, DELETE /playlists/{id}/shared-to/users\nGET, POST, PUT, DELETE /playlists/{id}/shared-to/emails</code></pre>\n</div> \n<p>Also you can set the sharing state when you create or update a track/playlist.</p> \n<p>Find the docs here for &lt;%= link<em>to(‘tracks’, ’<a href=\"https://developers.soundcloud.com/docs/api/tracks#sharing'\">https://developers.soundcloud.com/docs/api/tracks#sharing’</a>) %&gt; and &lt;%= link</em>to(‘playlists’, ’<a href=\"https://developers.soundcloud.com/docs/api/playlists#sharing'\">https://developers.soundcloud.com/docs/api/playlists#sharing’</a>) %&gt;.</p> \n<p>This change deprecates the <code class=\"language-text\">/tracks/{id}/permissions</code> and <code class=\"language-text\">POST /tracks/{id}/shared-to</code> resources. Both still work, but are not recommended anymore.</p>","descriptionType":"html","publishedDate":"Wed, 20 Jul 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"1ae3b45fb36a6a451b61aa93f70803ff","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Periskop: Exception Monitoring Service","link":"https://developers.soundcloud.com/blog/periskop-exception-monitoring-service","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/9c5bfa834e6000084deb32d75236402a/c2c5c/periskop_logo.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 15.032679738562091%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAiElEQVQI1zXOv6vBURjA4e8iGXyL/CiKcJVIBpkUpZTFZFRSBsvNqHSXOzEZ/LOsHvU69ZwznLdPb/K6pQ9mDDlRYMuRBgMWrMnzS5NyzO0pxf9/4vojZcrueU2zET5QZU6FDTXu5BjTi0UmEVx9gp3E8bZYRrxNnyJ1fj7DseGIbkQvnMl8O2/fd2bNZGX/AQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Periskop\" title=\"Periskop\" src=\"https://developers.soundcloud.com/blog/static/9c5bfa834e6000084deb32d75236402a/8ff1e/periskop_logo.png\" srcset=\"/blog/static/9c5bfa834e6000084deb32d75236402a/9ec3c/periskop_logo.png 200w,\n/blog/static/9c5bfa834e6000084deb32d75236402a/c7805/periskop_logo.png 400w,\n/blog/static/9c5bfa834e6000084deb32d75236402a/8ff1e/periskop_logo.png 800w,\n/blog/static/9c5bfa834e6000084deb32d75236402a/6ff5e/periskop_logo.png 1200w,\n/blog/static/9c5bfa834e6000084deb32d75236402a/2f950/periskop_logo.png 1600w,\n/blog/static/9c5bfa834e6000084deb32d75236402a/c2c5c/periskop_logo.png 3060w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p><a href=\"https://github.com/soundcloud/periskop\">Periskop</a> is an exception monitoring service that we built here at SoundCloud. It was designed with microservice environments in mind, but it’s also useful for long-running services in general. It has been architected for scale and is heavily influenced by <a href=\"https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud\">what we’ve learned</a> with <a href=\"https://prometheus.io/\">Prometheus</a>. It uses a pull-based model to efficiently aggregate exceptions in clients, after which point a server component collects exceptions and further aggregates them across instances.</p> \n<h2>Why Yet Another Exception Aggregation System?</h2> \n<p>In the past, SoundCloud relied on <a href=\"https://airbrake.io/\">Airbrake</a> to help troubleshoot and identify problems happening in production. As traffic increased and our services started receiving requests in the tens of thousands per second, small hiccups would send huge bursts of exception reports, in turn depleting our entire monthly budget in just a few minutes, and causing loss of information. <code class=\"language-text\">grep</code>ping or indexing the logs was not an option given the huge volume generated by our services.</p> \n<p>Considering the increasing amount of services SoundCloud runs, we needed a solution that would easily discover and scrape services with the minimum amount of manual effort.</p> \n<p>Since SoundCloud employees <a href=\"https://developers.soundcloud.com/blog/a-happy-new-employee\">are given the opportunity to use up to 20 percent of time to experiment</a> with new ideas (known here as self-allocated time), this was a perfect opportunity for a <a href=\"https://github.com/soundcloud/periskop/blob/master/AUTHORS\">group of engineers</a> to get together and build something fun and useful to improve tooling at SoundCloud, and hopefully, for the entire open source community.</p> \n<h2>How Does It Work?</h2> \n<p>Periskop is composed of both a <strong>client</strong> library component and a <strong>server</strong> component.</p> \n<p>The client library provides an exception collector. Every time an exception is handled, it can be added to the collector. Unhandled exceptions can be added to the collector by a top-level exception handler. Once an exception is added:</p> \n<ol> \n <li>The collector builds a unique key with the exception’s message and a hash of the stack trace. This key represents a concrete exception type.</li> \n <li>The collector aggregates the exception using the unique key and stores the aggregate using an in-memory data structure.</li> \n <li>The concrete exception occurrence is added to the aggregate’s list of recent exceptions for inspection. A queue data structure is used to implement a moving window of the most recent exceptions with a configurable size.</li> \n</ol> \n<p>Collected exception aggregates are exported via an HTTP endpoint using a <a href=\"https://github.com/soundcloud/periskop/blob/master/representation/errors.proto\">well-known schema</a>.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 721px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/245a03d81fec8969a61e4ca6d88ce189/b13b6/periskop_design.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 44.66019417475728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACIElEQVQoz2PYdfqW3rEbL/NO3nmbeejKk6jHP/4zMQDBsq2HGaCAUVeCiZEBD1AXBctD1AANaQIa8v/m2///j9548d/NJ0gaJP7//38Gbk52xs2dsSzdL/4zvu9VEf7cLqTxpZVX5XMrn+SXFh75z52iil/6FRQv/f/PeHhDN7OYMB8jw64zt412n7lTBsQF+y8+SNTQ0RcAmsdnZGyM4ap/xQz83zqFpb61cAl+7xKW/pXLIHYE5jIY2Hz4ktKBSw8DDl996rvn7B0nkMuAgBmI+W2N1DgfbOsJfLyzL+bpnkkJt3bOUkHW++DhSdUPz4/Ffnp2MObl3d1BEztLWEFebnz07f//66///D94+fF/G0c3BaBaDiDm0lGR1nu9f/L/53sm/v9/a/n/K2tbekEGpYU7i4LoW+fXdfz/e/X//y/n/r+4u+v3g6ub+Rj2nLtrfeDSo24gbgW6tHjhhr0sUAfwGmnKC77cN6n18pqWKY929M19tnuCE0ji7bmlYDXPbu1w/vDkwOz3j/dPeXVvd/OW1RM4GLYeuyp54tZrm7MPPloCDTVUVFEHuY6fk4ODDVuMTq6IAaeCiqIEbDHPyAD0ZiMslg9eevTfysFVHiYrIsDDuG1KEfOCphSW7VOLWIA02DAZCWGw/JwptUxnDi5mObZnHsveLdOZzU10GBj2nb/vsffc3dV7zt5dAjS8d82eU6wgxYlZRQzkAADhzgS6+14byAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Periskop Design\" title=\"Periskop Design\" src=\"https://developers.soundcloud.com/blog/static/245a03d81fec8969a61e4ca6d88ce189/b13b6/periskop_design.png\" srcset=\"/blog/static/245a03d81fec8969a61e4ca6d88ce189/9ec3c/periskop_design.png 200w,\n/blog/static/245a03d81fec8969a61e4ca6d88ce189/c7805/periskop_design.png 400w,\n/blog/static/245a03d81fec8969a61e4ca6d88ce189/b13b6/periskop_design.png 721w\" sizes=\"(max-width: 721px) 100vw, 721px\" loading=\"lazy\" /> </a> </span></p> \n<p>The server component uses service discovery to find all instances of a service. It then scrapes and further aggregates exported exceptions across instances. A simple UI allows navigating and inspecting exceptions as they occur.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/a987b/periskop_ui.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 49.21875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABFElEQVQoz52Re0vDMBTF+30FmQMn/jHcpHS06DcUW5Y225pCH8n6oI9j7tqKulV0gR8nuWkP9+QazsMMzuIW1v0c5t0NnuYzLB6XWK5MPFs2VuYG61+ge3PjwLJfsLZfYSj2jqP3hjpw0Wpy5iJNU1RVhWuWsQ04tnw3sIe/2yOKIpRlhaZp/kzbtqjrGobv++hh8BkDDwIIbSilvK7DQBuMkDGp63rwPA+HQ4gsy05P8BWqjYxnUiFEbzgakXLO9Z4jDAWUOuroJYqi+AbVLqGUumzYv2H577hd100bJkmio0hkcuAUsdc8z8+6Jqh+bqg1jmOk+keaGk3vc5rDnmrUDekIneluskPqhD6aivYTWmT8ASlL6E7lhNsXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Periskop UI\" title=\"Periskop UI\" src=\"https://developers.soundcloud.com/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/8ff1e/periskop_ui.png\" srcset=\"/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/9ec3c/periskop_ui.png 200w,\n/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/c7805/periskop_ui.png 400w,\n/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/8ff1e/periskop_ui.png 800w,\n/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/6ff5e/periskop_ui.png 1200w,\n/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/2f950/periskop_ui.png 1600w,\n/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/a987b/periskop_ui.png 1920w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h2>Design Tradeoffs</h2> \n<p>Every design decision comes with a set of tradeoffs that are important to be aware of. In the case of Periskop, we opted for a pull model for collecting exceptions as opposed to the usual push model of similar tools like <a href=\"https://sentry.io/welcome/\">Sentry</a>. This is advantageous because the pull model scales well with the number of exceptions and instances, and it provides interesting capabilities with little effort, specifically:</p> \n<ul> \n <li>Memory used by the client library is bounded by the number of different types of exceptions occurring instead of the total number of exceptions overall. Memory on the server side is similarly bounded, as it uses the same aggregation logic.</li> \n <li>If the server component needs to scrape a large amount of service instances, it might end up skipping scrape cycles, thereby reducing the freshness of the data, but it does not require additional resources. In practice, this means that Periskop can handle large numbers of services and instances with few resources.</li> \n <li>Creating hierarchies of Periskop instances (known as <a href=\"https://prometheus.io/docs/prometheus/latest/federation/\">federation</a>) becomes trivial. A primary Periskop instance could aggregate exceptions collected by secondary, data center-specific instances, thus providing a global view of the entire service stack across data centers.</li> \n</ul> \n<p>This model also has some disadvantages when compared to the push model, namely:</p> \n<ul> \n <li>If a fatal exception occurs and the process dies, the exception won’t be collected. However, this can be mitigated by the reporting capabilities of orchestration services like Kubernetes or other forms of logging.</li> \n <li>The pull model is not well suited for short-lived processes like scheduled jobs. This could be solved by the use of a push-based event gateway, although we haven’t yet had the need at SoundCloud, as it is usually more convenient to use logs to inspect failed jobs.</li> \n</ul> \n<h2>What Is Coming Next</h2> \n<p>Periskop is in its early stages and lacks some capabilities. Some of the ideas for improving and extending it that are on the roadmap include:</p> \n<ul> \n <li>Server-side persistence of exception occurrences over time</li> \n <li>UI filtering and sorting</li> \n <li>Federation (hierarchical Periskop servers)</li> \n <li>Pluggable service discovery mechanisms</li> \n <li>Connectors to other error monitoring services like Sentry</li> \n</ul> \n<p>In addition, high-level libraries for widely used web frameworks and client libraries for more programming languages need to be developed for Periskop to realize its full potential.</p> \n<p>Periskop is <a href=\"https://github.com/soundcloud/periskop\">open source</a> and we are happy to accept external contributions! If you find this project useful, we would love to hear from you. Please drop us a line at <a href=\"mailto:periskop-maintainers@soundcloud.com\">periskop-maintainers@soundcloud.com</a>.</p>","descriptionType":"html","publishedDate":"Mon, 16 Mar 2020 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/9c5bfa834e6000084deb32d75236402a/8ff1e/periskop_logo.png","linkMd5":"e085cd07fe339b684f0b334a598e1bfd","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn26@2020_4/2020/08/25/00-49-38-857_7e94ad4990086e1b.webp","destWidth":800,"destHeight":120,"sourceBytes":4659,"destBytes":9982,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/9c5bfa834e6000084deb32d75236402a/8ff1e/periskop_logo.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn26@2020_4/2020/08/25/00-49-38-857_7e94ad4990086e1b.webp","https://developers.soundcloud.com/blog/static/245a03d81fec8969a61e4ca6d88ce189/b13b6/periskop_design.png":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn77@2020_3/2020/08/25/00-51-43-203_b9f950d5e2dd95f5.webp","https://developers.soundcloud.com/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/8ff1e/periskop_ui.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn90@2020_1/2020/08/25/00-51-42-299_e7034bdf0b2741ff.webp"},"publishedOrCreatedDate":1598316569969},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Recording and Sharing Phone Calls","link":"https://developers.soundcloud.com/blog/recording-and-sharing-phone-calls","description":"<p>A few weeks ago, I attended <a href=\"http://newshackdaysf.tumblr.com/\">News Hack Day</a> in San Francisco. News Hack Days are events that bring together journalists, developers and designers for multi day creative coding and brainstorming sessions.</p> \n<p>I really like the idea of hack days that bring together people from different backgrounds. After chatting with a few journalists, it became obvious to me that recording interviews on the phone is a real pain. I saw this as an opportunity to build a fun app that would make this easier for people.</p> \n<!-- more --> \n<p>I spent most of my time during the two hacking days building <a href=\"http://phonerecord.us\">Phone Recorder</a>. It’s a simple <a href=\"http://nodejs.org/\">node.js</a> application that uses <a href=\"http://www.twilio.com/\">Twilio</a> and SoundCloud to record conference calls and upload them to the user’s SoundCloud account as either public or private sounds. You can give it a whirl <a href=\"http://phonerecord.us\">here</a> or <a href=\"https://github.com/paulosman/phonerecord.us\">check out the source code on GitHub</a>. I demoed the application at the end of the event and got some really good feedback.</p> \n<p>The idea is pretty simple. A user signs into the app using their SoundCloud account and creates a new call. They’re given a number to call, and two sets of codes: one for the moderator and another for participants. When they call the number, they’re prompted to enter a code. Once the call is finished (the moderator hangs up), the audio recording of the call is downloaded from Twilio and uploaded to the moderator’s SoundCloud account.</p> \n<p>One tricky bit was associating the moderator’s SoundCloud account (and access token) with a specific call. I decided to use <a href=\"http://redis.io\">Redis</a> for this. You could use any server-side data store, Redis is just nice and simple, which is great when you’re at a hack day rushing to get something done.</p> \n<p>Once that bit was solved, the code that uploads to SoundCloud was simple to write:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">postTrack</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">file<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> sharing<span class=\"token punctuation\">,</span> token<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> stat <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">statSync</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> mime <span class=\"token operator\">=</span> <span class=\"token string\">'application/octet-stream'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">var</span> req <span class=\"token operator\">=</span> rest<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://api.soundcloud.com/me/tracks.json'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    multipart<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">'track[title]'</span><span class=\"token punctuation\">:</span> title<span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'track[sharing]'</span><span class=\"token punctuation\">:</span> sharing<span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'track[asset_data]'</span><span class=\"token punctuation\">:</span> rest<span class=\"token punctuation\">.</span><span class=\"token function\">file</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> stat<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> mime<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'oauth_token'</span><span class=\"token punctuation\">:</span> token\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'complete'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// download the audio recording from Twilio and post to SoundCloud</span>\n<span class=\"token keyword\">return</span> util<span class=\"token punctuation\">.</span><span class=\"token function\">downloadFile</span><span class=\"token punctuation\">(</span>recordingUrl<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">file</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> scope <span class=\"token operator\">=</span> call<span class=\"token punctuation\">.</span>private <span class=\"token operator\">?</span> <span class=\"token string\">\"private\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"public\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> soundcloud<span class=\"token punctuation\">.</span><span class=\"token function\">postTrack</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> scope<span class=\"token punctuation\">,</span> token<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Posted: \"</span> <span class=\"token operator\">+</span> r<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>Attending the Hack Day was a good opportunity to build something useful that uses sound on the web in a new, interesting way.</p> \n<p>Built an awesome hack using our API? Let me know about it in the comments.</p>","descriptionType":"html","publishedDate":"Thu, 12 Jul 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"658ded4f2a3495454b9132af8c0c2a37","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Open-sourcing LightCycle for Android","link":"https://developers.soundcloud.com/blog/Open-sourcing-LightCycle-for-Android","description":"<p>Last week, we open-sourced LightCycle, an Android library that helps break logic out of <code class=\"language-text\">Activity</code> and <code class=\"language-text\">Fragment</code> classes into small, self-contained components called LightCycles.</p> \n<p>Components that typically need to be aware of <code class=\"language-text\">Activity</code> and <code class=\"language-text\">Fragment</code> lifecycle events include presenters, UI tracking code, input processors and more. We’ve been using LightCycle extensively in the <a href=\"https://play.google.com/store/apps/details?id=com.soundcloud.android\">SoundCloud Music &amp; Audio</a> and <a href=\"https://play.google.com/store/apps/details?id=com.soundcloud.creators\">SoundCloud Pulse</a> apps over the last year.</p> \n<!-- more --> \n<h2>Motivation</h2> \n<p>LightCycle lets self-contained classes respond to Android’s lifecycle events. This encourages composition over inheritance and promotes components that follow the single responsibility principle. We believe it helps us write more readable, maintainable and testable code.</p> \n<p>If this sounds familiar, RoboGuice has a similar concept called <a href=\"https://github.com/roboguice/roboguice/wiki/Using-Events-in-your-RoboGuice-application\">Events</a>. However, LightCycle is a small, standalone solution that works well with all dependency injection frameworks.</p> \n<h2>Usage</h2> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">public class MyActivity extends LightCycleAppCompatActivity&lt;MyBaseActivity&gt; {\n\n    @LightCycle MyController controller = new MyController();\n\n    @Override\n    protected void setActivityContentView() {\n        setContentView(R.layout.main);\n    }\n}\n\npublic class MyController extends DefaultActivityLightCycle&lt;MyActivity&gt; {\n\n    @Override\n    public void onPause(MyActivity activity) {\n        // MyActivity was paused\n    }\n}</code></pre>\n</div> \n<p>The <code class=\"language-text\">Activitiy</code> and <code class=\"language-text\">Fragment</code> classes are responsible for configuring Android specifics and declaring LightCycles. LightCycles themselves can focus on business or presentation logic. Not being tightly coupled to the framework makes these components simpler to unit test (even without <a href=\"http://robolectric.org\">Robolectric</a>).</p> \n<h2>Get it</h2> \n<p>The code and documentation is available <a href=\"https://github.com/soundcloud/lightcycle\">on GitHub</a>.</p> \n<p><strong>Acknowledgements</strong>. Huge thanks to all the contributors: <a href=\"https://github.com/brianegan\">Brian Egan</a>, <a href=\"https://github.com/android10\">Fernando Cejas</a>, <a href=\"https://github.com/jdamcd\">Jamie McDonald</a>, <a href=\"https://github.com/jonschmidt\">Jon Schmidt</a>, <a href=\"https://github.com/iluu\">Karolina Kafel</a>, <a href=\"https://github.com/mttkay\">Matthias Käppler</a>, <a href=\"https://github.com/lopespm\">Pedro Lopes</a>.</p>","descriptionType":"html","publishedDate":"Mon, 21 Mar 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"ea75407dfb7490dd5a8ee6c1e9d5fd34","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569978},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Real-Time Counts with Stitch","link":"https://developers.soundcloud.com/blog/real-time-counts-with-stitch","description":"<p>Here at SoundCloud, in order to provide counts and a time series of counts in real time, we created something called Stitch.</p> \n<p>Stitch was initially developed to provide timelines and counts for our <a href=\"https://blog.soundcloud.com/2014/03/04/new-soundcloud-stats/\">stats pages</a>, which are where users can see which of their tracks are played and when.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/9e68a73a9b66c964410db209cf4ee787/d6590/soundcloud_stats_screenshot.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.0289990645463%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAG7ZVHGTq//xAAbEAABBAMAAAAAAAAAAAAAAAADAAECBBMkM//aAAgBAQABBQIY2k2GKIQgyV+astsf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHRAAAgIBBQAAAAAAAAAAAAAAAQIAIRARMWGBkf/aAAgBAQAGPwLUk7ymb2MqmuZ2cPP/xAAeEAACAQMFAAAAAAAAAAAAAAAAAREhMUFRYYGx8P/aAAgBAQABPyFnn5ZeopKDkILwe92L/qo8iHIlddI//9oADAMBAAIAAwAAABB8H//EABcRAAMBAAAAAAAAAAAAAAAAAAABEVH/2gAIAQMBAT8QcKsP/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERUf/aAAgBAgEBPxBUj0//xAAdEAEAAwABBQAAAAAAAAAAAAABABExQVFhcdHw/9oACAEBAAE/ELtQdBFFDIWnaj3RdM1W0Dz5nyOqYhrU6JL/2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"SoundCloud Stats Screenshot\" title=\"SoundCloud Stats Screenshot\" src=\"https://developers.soundcloud.com/blog/static/9e68a73a9b66c964410db209cf4ee787/a296c/soundcloud_stats_screenshot.jpg\" srcset=\"/blog/static/9e68a73a9b66c964410db209cf4ee787/f544b/soundcloud_stats_screenshot.jpg 200w,\n/blog/static/9e68a73a9b66c964410db209cf4ee787/41689/soundcloud_stats_screenshot.jpg 400w,\n/blog/static/9e68a73a9b66c964410db209cf4ee787/a296c/soundcloud_stats_screenshot.jpg 800w,\n/blog/static/9e68a73a9b66c964410db209cf4ee787/c35de/soundcloud_stats_screenshot.jpg 1200w,\n/blog/static/9e68a73a9b66c964410db209cf4ee787/8179c/soundcloud_stats_screenshot.jpg 1600w,\n/blog/static/9e68a73a9b66c964410db209cf4ee787/d6590/soundcloud_stats_screenshot.jpg 2138w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Stitch is a wrapper around a Cassandra database. It has a web application that provides read access to the counts through an HTTP API. The counts are written to Cassandra in two distinct ways, and it’s possible to use either one or both of them:</p> \n<dl> \n <dt>\n   Real Time \n </dt> \n <dd>\n   For real-time updates, Stitch has a processor application that handles a stream of events coming from a broker and increments the appropriate counts in Cassandra. \n </dd> \n <dt>\n   Batch \n </dt> \n <dd>\n   The batch part is a MapReduce job running on [Hadoop] that reads event logs and calculates the overall totals, and then bulk loads this into Cassandra. \n </dd> \n <dl> \n  <h2>The Problem</h2> \n  <p>The difficulty with real-time counts is that incrementing is a non-idempotent operation, which means that if you apply the same increment twice, you get a different value than if you would only apply it once. That said, if an incident affects our data pipeline and the counts are wrong, we can’t fix it by simply re-feeding the day’s events through the processors; if we did, we would risk double counting.</p> \n  <h2>Our First Solution</h2> \n  <p>Initially, Stitch only supported real-time updates and addressed this problem with a MapReduce job, <code class=\"language-text\">The Restorator</code>, which performed the following actions:</p> \n  <ol> \n   <li>Calculated the expected totals.</li> \n   <li>Queried Cassandra to get the values it had for each counter.</li> \n   <li>Calculated the increments needed to apply to fix the counters.</li> \n   <li>Applied the increments.<p></p></li> \n  </ol> \n  <p>Meanwhile, to stop the sand shifting under its feet, <code class=\"language-text\">The Restorator</code> needed to coordinate a locking system between itself and the real-time processors. This was so that the processors didn’t try to simultaneously apply increments to the same counter, which would result in a race condition. To deal with this, <code class=\"language-text\">The Restorator</code> used <a href=\"https://zookeeper.apache.org/\">ZooKeeper</a>.</p> \n  <p>As you can probably tell, this setup was quite complex, and it often took a long time to run. But despite this, it worked.</p> \n  <h2>Our Second Solution</h2> \n  <p>Luckily, a new use case emerged: a team wanted to run Stitch purely in batch. This is when we added the batch layer, and we used this as an opportunity to revisit the way Stitch was dealing with the non-idempotent increments problem. We evolved to a <a href=\"http://lambda-architecture.net/\">Lambda Architecture</a>-style approach, where we combined a fast real-time layer for a possibly inaccurate but immediate count with a batch slow layer for an accurate but delayed count. The two sets of counts are kept separately and updated independently, possibly even living on different database clusters, and it is up to the reading web application to return the correct version when queried. At its most naive, it returns the batch counts instead of the real-time counts, whenever they exist.</p> \n  <h2>Conclusion</h2> \n  <p>To find out how Stitch has evolved over the years, you can read this updated post, <a href=\"https://developers.soundcloud.com/blog/keeping-counts-in-sync\">Keeping Counts In Sync</a>.</p> \n  <p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 649px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/49e8022a8f73567d4a3dc2659c4ff0f8/548e0/stitch_diagram.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 89.06009244992296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAASABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMCBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAA//aAAwDAQACEAMQAAAB7NAtsEnczQ0v/8QAGxAAAgIDAQAAAAAAAAAAAAAAABEBEAIDITH/2gAIAQEAAQUCw4Q6cCEa/a//xAAVEQEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAwEBPwFj/8QAFxEAAwEAAAAAAAAAAAAAAAAAAQMQMv/aAAgBAgEBPwEReZ//xAAaEAACAwEBAAAAAAAAAAAAAAAAARARMQJR/9oACAEBAAY/Amm7Mijw06n/xAAeEAACAQMFAAAAAAAAAAAAAAAAAREQIVFhcYGRof/aAAgBAQABPyGT9CGZuYYvSSxps2cBah6K/wD/2gAMAwEAAgADAAAAEOTQwP/EABcRAQEBAQAAAAAAAAAAAAAAAAEQETH/2gAIAQMBAT8QSusez//EABYRAQEBAAAAAAAAAAAAAAAAAAERIP/aAAgBAgEBPxCAhg//xAAcEAEBAAICAwAAAAAAAAAAAAABEQAxEFEhcYH/2gAIAQEAAT8Q8wi00mGEo9l4WsA1cEiAXe2KG/3gLQpPzn//2Q=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Stitch Diagram\" title=\"Stitch Diagram\" src=\"https://developers.soundcloud.com/blog/static/49e8022a8f73567d4a3dc2659c4ff0f8/548e0/stitch_diagram.jpg\" srcset=\"/blog/static/49e8022a8f73567d4a3dc2659c4ff0f8/f544b/stitch_diagram.jpg 200w,\n/blog/static/49e8022a8f73567d4a3dc2659c4ff0f8/41689/stitch_diagram.jpg 400w,\n/blog/static/49e8022a8f73567d4a3dc2659c4ff0f8/548e0/stitch_diagram.jpg 649w\" sizes=\"(max-width: 649px) 100vw, 649px\" loading=\"lazy\" /> </a> </span></p> \n  <p>Thanks go to <a href=\"https://github.com/kim\">Kim Altintop</a> and <a href=\"https://github.com/omidaladini\">Omid Aladini</a>, who created Stitch, and <a href=\"https://github.com/johnglover\">John Glover</a>, who continues to work on it with me.</p> \n  <p>If this sounds like the sort of thing you’d like to work on too, check out our <a href=\"https://soundcloud.com/jobs\">jobs page</a>.</p> \n </dl> \n</dl>","descriptionType":"html","publishedDate":"Thu, 03 Jul 2014 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/9e68a73a9b66c964410db209cf4ee787/a296c/soundcloud_stats_screenshot.jpg","linkMd5":"95f32efbd2ba084266d03a2e8d0bb67c","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn22@2020_1/2020/08/25/00-49-37-649_a662495e3f4d48a0.webp","destWidth":800,"destHeight":408,"sourceBytes":20906,"destBytes":19408,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/9e68a73a9b66c964410db209cf4ee787/a296c/soundcloud_stats_screenshot.jpg":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn22@2020_1/2020/08/25/00-49-37-649_a662495e3f4d48a0.webp","https://developers.soundcloud.com/blog/static/49e8022a8f73567d4a3dc2659c4ff0f8/548e0/stitch_diagram.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn92@2020_4/2020/08/25/00-51-44-845_ae9f598c3206243d.webp"},"publishedOrCreatedDate":1598316569979},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Say hello to Sketchy the spam fighter","link":"https://developers.soundcloud.com/blog/say-hello-to-sketchy-the-spam-fighter","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 300px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/d6dcc23daced4d6498c1619edd6e8036/135ae/no-spam.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEyklEQVQ4y3VVC0yTVxS+1S2AATU8I1IZtBRseVWKsIEt0wwX1jFfc1mGxphlIdtUHDMssgFjOLcxYck06sZ8oGPiNiZm6gCTZYszPgalhYqgIlJfUUsBQUb//vfbvZc2Mcu8ycl//ptzv/+cc7/v/MSuNxC+rpjNpD0ofBr3ATxli01YZQmd22AJm9tvnad2W6PVHkt41KAlJPIn2zOaAue+ugAee574Tes1LVZw3568QGCR3ueXkMYpl9hTDGZ2sLs/LRPO97bAdeh7DLe0Yri1Da6GI3B+sBUDmYtgCVdes6nmv+49Ri4ZMgQoufqymRzxbtrU2oq+mAQ4qz6F+8F9iWXKTWZGHzNJGhmRnDtqMaDPQHei/msfaG/OYkLaZ0aIMm1x2vJBbSqGT5+WvUCUejyUStLU0+dLHg7Kl+fWtu1S/6wIdOv0uzjGOTJtKkt7anpeT3QcHpw6xcFkeXIS7slJ6na7GY6HIVMwHxIzKssi07sH69EZE09vVFRK/akLwXq+lngvYHpHWJRtYsdX8GYGb2lPXJNNTRiIT6QjrKc8Uw/rsyVC6bhVWjqTdETHLXNkZKP16FHPu0VF9OSJE9TlcqGurg61tbW4cOEC+PuunTtRf/gwHjofYO/y5agpKMD1O3fo3m++RePhQ5LDuATWKNVbpCdKdbD3jbUIjAiXopXzKEuacjCFQgE/Pz+oVSrs3r0bvBhufVeuQJueLvzyj8pEfGxysjRSWQVGqePkslJ92Vr5CYiCyEUbN9I9e/agubkZgYGBKCkpQVJSEtasWYOwsDAEBQWhpaUFxuxsAZiXl4fpCgU15Jjk8RMnGZWi+khnZMzDcRZUVFoqvlZZWQm73S6yCwgIgFqthtlshsFgEOA1NTUwmUwIDg5GaGgo5kRE0IUmEx07dx7WGM0ksSlVY/eafsGxtja6ft06Dorq6mqRzWurV8PhcGDlypXQaDRQKpXYvHkzjEYj9Ho9IiMjkZqcLADHzwtAN+9h36XPvgCjkFy0YQPlQEWbNomSDtTXi1tNSUmBv7+/2MvPz0diYiJyc3Oh0+mQYzTS+LQF8qNTv/GSr5KOkMhDrvdLWMlbpcAZMyjrD/397FnotFo0egGzsrJQVVWF4uJirFixAi+x3pWVlaGwsJBuKS6mrxQUSKPbtvNL+ZV0RmtWDaRnAUxOd+/dYxQGHfm5CRcTdBhqaxWAj8bHBbG5TUxMCPO+M+F48OjhqOTIeYHRJvZtRmzpaUbsS/ertguSOht+QHvIHOo8OJUdU8aT+E2ZqsWZ4e/2c2LfHix8Z7ZQS5dGt+xasgGDZRUeq2q+fP+AAKNcZlx2/zG2LVMuTx4z3t0lDej06IpPelOA/R0QLIZDd9KCz68xod8sr/Dwr4roxwfDYwPCNxw42O2MRbBGx+3nGH8Qxubepbm+6cNBq68zoTu/rIFndPT/xpeYRPI/E9IQk9wNlhkD2+c7fznLODVtep59TuHb7IrTvsqG59UbmUa4tn6IMcbRsTNnmP2FsebjcJV/jEGmW9azm6zM9b5zPZnZ3tGVliaefS8uJRf9Z4vyh+oPBFjnxa21hMz9kf0CujujYoc6lbHDzO9hv4VjfAg4irfM4rF/sjJ9mdkT9eRfv5KqM1u0PZcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Sketchy the spam fighter\" title=\"Sketchy the spam fighter\" src=\"https://developers.soundcloud.com/blog/static/d6dcc23daced4d6498c1619edd6e8036/135ae/no-spam.png\" srcset=\"/blog/static/d6dcc23daced4d6498c1619edd6e8036/9ec3c/no-spam.png 200w,\n/blog/static/d6dcc23daced4d6498c1619edd6e8036/135ae/no-spam.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" loading=\"lazy\" /> </a> </span>Sketchy is a spam-fighting, open-source software framework developed by SoundCloud engineers <a href=\"https://github.com/mweiden\">Matt Weiden</a>, <a href=\"https://github.com/purzelrakete\">Rany Keddo</a>, and Michael Brückner. Sketchy reduces malicious user activity on web applications. You can use it to address several common issues:</p> \n<ul> \n <li>Detect when a user submits text that contains spam content.</li> \n <li>Detect when a user submits multiple texts that are nearly identical.</li> \n <li>Rate-limit malicious actions that users perform repeatedly.</li> \n <li>Check user signatures such as IP addresses against external blacklist APIs.</li> \n <li>Collect and consolidate reports of spam from users.</li> \n</ul> \n<p>We created Sketchy so that we could fight spam around the clock.&nbsp;Any startup that reaches the scale of SoundCloud has to deal with spammers on a daily basis. We decided to release Sketchy as open-source software so other companies don’t have to reinvent the wheel. Since we’ve released it,&nbsp;<a href=\"http://gigaom.com/2013/10/07/soundcloud-open-sources-sketchy-to-help-other-big-web-firms-fight-spammy-behavior/\">Sketchy has been featured on GigaOM</a>.</p> \n<p><i>Sketchy has been deprecated and is no longer in use. It worked well for many years but has since been replaced by other services.</i></p>","descriptionType":"html","publishedDate":"Mon, 07 Oct 2013 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/d6dcc23daced4d6498c1619edd6e8036/135ae/no-spam.png","linkMd5":"0f1105e6627ad57621f0807bef866e63","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn58@2020_4/2020/08/25/00-49-38-432_0f0df79b6758b11c.webp","destWidth":300,"destHeight":300,"sourceBytes":7949,"destBytes":13992,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/d6dcc23daced4d6498c1619edd6e8036/135ae/no-spam.png":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn58@2020_4/2020/08/25/00-49-38-432_0f0df79b6758b11c.webp"},"publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Music Hack Day Coming to Toronto!","link":"https://developers.soundcloud.com/blog/music-hack-day-toronto","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/48a11/toronto.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 49.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABxWV5hgoP/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAEQERL/2gAIAQEAAQUCw5Gsjn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8CKv8A/8QAGBAAAgMAAAAAAAAAAAAAAAAAAREAECH/2gAIAQEAAT8hEKgg2MJiiwV//9oADAMBAAIAAwAAABDUL//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EGf/xAAaEAEBAQADAQAAAAAAAAAAAAABEQAhMWGR/9oACAEBAAE/ELpUL7nkU9rSYqmfG47ydj91u//Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Toronto\" title=\"Toronto\" src=\"https://developers.soundcloud.com/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/48a11/toronto.jpg\" srcset=\"/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/f544b/toronto.jpg 200w,\n/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/41689/toronto.jpg 400w,\n/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/48a11/toronto.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<p>The first Music Hack Day — organized by our very own Dave Haynes — was held in July 2009 in London, UK. Since then there have been over 30 Music Hack Day events all over the world in cities like San Francisco, New York, Paris, Barcelona and Reykjavik.</p> \n<p>Music Hack Day events gather programmers, designers and artists to conceptualize, build and demo the future of music. Software, hardware, mobile, web, instruments, art — anything goes as long as it’s music related.</p> \n<p>I’m happy to announce that SoundCloud is teaming up with <a href=\"http://rdio.com\">Rdio</a>, <a href=\"http://unspace.ca\">Unspace</a> and <a href=\"http://echonest.com/\">The Echo Nest</a> to organize the first ever Music Hack Day in Toronto. <a href=\"http://toronto.musichackday.org\">MHD Toronto</a> happens on August 10th and 11th 2013.</p> \n<p>If you are a Toronto developer, designer, or artist, come out and join us for what is sure to be an amazing event.</p> \n<p>For more details and to register for the event, go to <a href=\"http://toronto.musichackday.org\">http://toronto.musichackday.org</a>.</p>","descriptionType":"html","publishedDate":"Tue, 09 Jul 2013 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/48a11/toronto.jpg","linkMd5":"503c93fee35923263b057332fcef1561","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn1@2020_5/2020/08/25/00-49-37-667_d343b8ea63b061df.webp","destWidth":500,"destHeight":247,"sourceBytes":8639,"destBytes":11906,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/48a11/toronto.jpg":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn1@2020_5/2020/08/25/00-49-37-667_d343b8ea63b061df.webp"},"publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"DeveloperBridge: SoundCloud’s Program for Training People from Diverse Backgrounds to Become Engineers","link":"https://developers.soundcloud.com/blog/developerbridge-training-program","description":"<p>DeveloperBridge is a year-long, full-time, paid traineeship program where participants learn from and work with engineering teams at SoundCloud. <a href=\"https://developers.soundcloud.com/blog/insights-from-the-developerbridge-programme\">The DeveloperBridge program</a> was launched in 2017 with the goal of further supporting diversity and inclusion at SoundCloud and giving back to the tech community. Now it’s 2020, and we just kicked off the second edition of the initiative.</p> \n<p>The program is designed to:</p> \n<ul> \n <li>Give back to the community and support the Berlin tech scene by creating junior engineering roles that require no previous experience.</li> \n <li>Provide an opportunity to people passionate about engineering and who haven’t yet had a chance to kickstart their careers.</li> \n <li>Support underrepresented groups and people from marginalized communities.</li> \n <li>Promote junior talent.</li> \n <li>Improve diversity in the organization and create a more inclusive environment.</li> \n <li>Benefit from fresh perspectives and be reflective of our diverse user base.</li> \n <li>Give our engineers an opportunity to mentor and coach.</li> \n <li>Hire trainees to full-time positions at the end of the program.</li> \n</ul> \n<p>Organizing such a program is a logistical challenge that requires cross-team effort and collaboration. We started recruitment in January 2020, and in the job description, we were transparent about our offering, process, and timeline. To create a diverse pipeline and attract our target audience, we promoted the program on different platforms and at various organizations, such as <a href=\"https://www.redi-school.org/\">ReDI School of Digital Integration</a>, <a href=\"https://www.womentech.net/en-de\">WomenTech</a>, <a href=\"https://www.womenwhocode.com/\">Women Who Code</a>, and the <a href=\"https://www.meetup.com/women-who-go-berlin/\">Women Who Go</a> course, which SoundCloud hosted in the past.</p> \n<p>After one month, we received an astonishing number of applications — 400 to be exact. Together with volunteers from Engineering, we screened the CVs and filtered out applicants who were already professional or full-time developers. The next step was a technical one, consisting of two take-home programming tasks. Since our participants are not experienced engineers, we didn’t require them to actually complete the tasks. Instead, we focused on their thought processes and problem-solving skills.</p> \n<p>At the end of this, we invited the 21 highest scorers to the final onsite day. During the day, the applicants learned about SoundCloud, took part in introduction sessions with engineering leadership and DeveloperBridge 2017 alumni, and met members of the SoundCloud team for informal lunches. They also had two short interview sessions: pair programming and barkeeper (barkeepers are senior engineers who represent the technical excellency, culture, and mindset of SoundCloud).</p> \n<p>Organizing the onsite day was a huge logistical task that required support from volunteers across the whole organization. In the end, 37 people supported the onsite day by interviewing, conducting introductory sessions, chaperoning, and hanging out with the participants during lunch. It was great to receive this support from the engineering team.</p> \n<p>Best of all, the onsite day was successful: We made eight offers instead of the seven we had initially planned for, and all of them were accepted!</p> \n<p>Here is what one of the finalists, Kaylee, thought of the recruitment process: “From the beginning until now, it has been an exciting, challenging, fair, and rewarding experience. The programming challenges brought an extensive range of brain stimulation, while the personal interview session at SoundCloud was welcoming and relaxing. Live coding with the senior developer was also fun and interesting.”</p> \n<p>The next step was finding projects and teams for the trainees. We wanted this process to be as inclusive and interactive as possible, in order to cater to the interests of the trainees. We came up with the idea of a “Pitch Day,” which is where engineering managers would pitch their teams and projects to the trainees. That way, the new joiners could also meet their future colleagues and learn more about the actual tasks and projects. Neslihan, one of the participants said: “I am impressed with the genuine interest in finding us the project that we would be passionate about.”</p> \n<p>The preparations didn’t stop there. Volunteers from Engineering started working on the training program to onboard the new joiners to all things SoundCloud: tech stack and systems, ways of working, internal policies and processes, and career progressions. In addition to the training program, the new joiners will have mentors and buddies who are also volunteers from the engineering team.</p> \n<p>In addition to the benefits for the new joiners, DeveloperBridge has already had huge positive effects on the company. For example, the training coordination group is planning on scaling its training program into a regular onboarding, junior colleagues had the chance to participate in a recruiting process, and colleagues were excited about running the program — this is something they drew additional motivation from in their day-to-day work.</p> \n<p>Organizing and executing DeveloperBridge has been a great learning experience for the recruitment team. It is also extremely rewarding to give back to the community by supporting junior talent and giving opportunities to people passionate about programming. We so excited for our eight trainees — Ekaterina, Kaylee, Margaret, Tristan, Oscar, Matan, Neslihan, and Evgenija — to start their SoundCloud journeys.</p>","descriptionType":"html","publishedDate":"Fri, 17 Jul 2020 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"677abb47d65a06554c054401f54f427d","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569967},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Win a trip to the Barcelona Ruby Conference","link":"https://developers.soundcloud.com/blog/win-a-trip-to-the-barcelona-ruby-conference","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 300px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/5b1831d72dc2c2b0299a8d3b3445a0f3/135ae/barcelona-ruby-conference-sept-MMXIII.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAFUElEQVQ4y1VVaVBTVxh9gILSUgVHtFTHaa1QNzYFDNCAYEISlrAlARIIhFUgKDvagBSJxBAgrIKirYiiLFOXVooLVkXRsYJUa+vU6kydLmOr1LYuxOSevgRh9Pvz3Xfv+84733LPoyjarn07YnQUACp1c7kF9cro5xnXR28sPdJ7grn/YJ/f0OWrTvSe1dS5f1iyhTHGaGfPXaTGvrv5Jhht5q/WDkVlGmW0NO/Whog03TqOFP78VNAAep4w827uFlX9+OM/naaAJ579Y2b0Fy5doV4HM1l7R7eMHZk27uQjhKOvEGxBJvw4UiKKzyULV7LpPQE8uElgBidNqOp2l0zF6Z5Pgr7BTNO4b5s3/bJveBrCaGZiP4E+nyMm2SwRyQwUEHmAgGQFSw38sGSdb0QafHgy5JdWt79WIopKylZYTDLrSXZmxsCDl6hPCJXpC4LiwPYJJ4vXCYmNpxiz3WOxwD2SfOwZTHLZsZDxpAb/qHSdF1uKCnXLdiPGElee+RTye5zojL9dWBLEchL0+VwxbJ1DCMUrI1abezCr+gqo+lFQZYOgRFpi7RxG0jaIkBgkMfhHZxA6fYzeGFszXTe6ATvc6S/xI9N1RRyJCcwsfhesG0dh+dUfmN81AlGyAmlxeXDachiUvBtWznyyiRWLeGGmbl1oCmTZikPTo8EX59w21i2Nm6APZIQRiltKLFtv452BB4irasMXbr64b+uAJht7uHHSMSPrAKhIFdzWhpDckERDIN24DRGpf9FY9hRN9cMAfoqOyU9BXlAcWegeQczyj8G+dQilvBjcW+iIe/M/gGhlABbtOAHZradYTHuz1AOw8U4gOXSj2PwUg29oMj7r7GVS3X1fMj3Z8QgXZZMcdgyxdo8BpR6GIiAKL+Ytw8+LlsN/FRtuB0dR/AtB6MmfMG/jLljm9cHMLwupzAgSGZWh9wiSoqq2TUwd7jnu50UPbkB4mmk8Zq+Jg7nyPDpXM/Cj3SIw6dnzPTIG5e+Ab9NpLPeOxZycRlg3XAfFSEWqfyQJ4Cbq3VjxUNftllA379xx9GaJXy6wWYX8QBGx9xQS84wOrPaIghcrBQFHf8DnjwFG81mk269Aea4Ctpf/g5ViAHMYEnqEYshSW2e9m080Oo+eXG9simVMnPxOjJ0LChh8A9NPQKj1uYSS7UHg4G9of/AcK2sHIHBl4fu35yKotA0zOu6CEtbClRFOCv0FRDx3FQShsnEa611Tp3OVDZpQx/VgzXPRbeZKYOMaTixitJib0wH74i68penHiu4R+BS1wKHqFCzops1yjyJyngTsJd4v2Q5eyCis7J2ew+fQvc8JlT2Vycugzq8wZAUKMduFT6iQcszM7aPrNYKZWrpmlUOg4ppg4RxOkgKEqJEriELdYuDQ17B/8IK3CSzplVxpd3fKVfX7oG7Z/1K1qcywJSQBa924xM5TRCw8E2HuIaWZR5HVzmySRzMzgjXsPTRRt6sT6oa9tUaMFUyh+ZQ4mJSibEdDbcmn9ajf1wXtzmZdo1xhUMZuJEUhElLIE5PSyGTSkLXVsLO0Wre9vp0olM3YWlHXM5Xpk8cPJxf/Pnk0nb6ypi2vQKGe2K7dizJNG0or6oha02pQqpoMZ06fM3Qd7UfWJ9WgNRHlquadU3EXhoYn5ev8xWGTf/HsyTTTk6cGl5WU1zRnF1Tezy6pQuGnWhRX1KNC04qC0upfi7fVdPQe658Wg4uXrpjivj7zDUXdGLtJDV+9Nq1n4ZJNr/8CbA71HHep1LRyaYkKVmn3rBl/9NBu6vwjRoQ59M9M6wEajL7G1P89PeL40SDKOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Barcelona Ruby Conference September MMX111\" title=\"Barcelona Ruby Conference September MMX111\" src=\"https://developers.soundcloud.com/blog/static/5b1831d72dc2c2b0299a8d3b3445a0f3/135ae/barcelona-ruby-conference-sept-MMXIII.png\" srcset=\"/blog/static/5b1831d72dc2c2b0299a8d3b3445a0f3/9ec3c/barcelona-ruby-conference-sept-MMXIII.png 200w,\n/blog/static/5b1831d72dc2c2b0299a8d3b3445a0f3/135ae/barcelona-ruby-conference-sept-MMXIII.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" loading=\"lazy\" /> </a> </span></p> \n<p>The lineup for <a href=\"http://www.baruco.org/\">BaRuCo 2013</a>&nbsp;looks amazing, with speakers such as&nbsp;Aaron Patterson, Katrina Owen, Sandi Metz, and Ruby’s inventor Yukihiro Matsumoto. The conference is currently <strong>SOLD OUT</strong>, but we have one extra ticket… and it could be yours!</p> \n<p>If you win the ticket, SoundCloud will fly you from anywhere in the world to Barcelona, Spain and put you up in a nice Catalonian hotel.</p> \n<p>How do you enter to win?</p> \n<p>It’s simple. Just create a command-line interface in Ruby that uses the SoundCloud API. You can use the&nbsp;<a href=\"https://github.com/soundcloud/soundcloud-ruby\" title=\"SoundCloud Ruby SDK\">SoundCloud Ruby SDK</a>, but this is not a requirement. The only constraints are that it is:</p> \n<ol> \n <li>a command-line interface,</li> \n <li>written in Ruby,</li> \n <li>integrated with SoundCloud,</li> \n <li>and&nbsp;totally awesome!</li> \n</ol> \n<p>The author of the most creative CLI that uses SoundCloud will win the BaRuCo ticket.</p> \n<p>To submit an entry, push your code to GitHub and send an email that includes a link to the repo to&nbsp;<a href=\"mailto:e@soundcloud.com\">e@soundcloud.com</a> by 12:59:59 UTC&nbsp;on August 26th, 2013. We will announce the winner on August 30th.</p> \n<p>You must be at least 18 years old to enter and allowed to travel to Spain (sorry Edward Snowden).</p> \n<p>Entries will be judged by a team of SoundCloud staff. If you have any questions, <a href=\"mailto:e@soundcloud.com\">email me</a>.</p>","descriptionType":"html","publishedDate":"Fri, 09 Aug 2013 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/5b1831d72dc2c2b0299a8d3b3445a0f3/135ae/barcelona-ruby-conference-sept-MMXIII.png","linkMd5":"55295123821f40e618d03e08c381b819","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn39@2020_4/2020/08/25/00-49-38-729_357ba22d988d4a83.webp","destWidth":300,"destHeight":300,"sourceBytes":13612,"destBytes":22146,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/5b1831d72dc2c2b0299a8d3b3445a0f3/135ae/barcelona-ruby-conference-sept-MMXIII.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn39@2020_4/2020/08/25/00-49-38-729_357ba22d988d4a83.webp"},"publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"The Power of Types for Errors","link":"https://developers.soundcloud.com/blog/power-of-types-for-errors","description":"<p>At <a href=\"https://kotlinconf.com/\">KotlinConf 2019</a>, I talked about the <a href=\"https://www.youtube.com/watch?v=t3DBzaeid74\">power of types</a>. In essence, I discussed limiting the number of primitives we use in our code in favor of using custom types instead. In this way, we as developers will not only reduce the possibility of bugs by using the compiler, but we will also achieve more readable and self-documented types.</p> \n<p>Today I ran into a situation which reminded me of the things I said in this talk.</p> \n<p><a href=\"https://www.youtube.com/watch?v=t3DBzaeid74\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAABw2LaQWSb/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAIDMgEREv/aAAgBAQABBQLliKzW3khFRT//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEv/aAAgBAwEBPwFL/8QAFREBAQAAAAAAAAAAAAAAAAAAABL/2gAIAQIBAT8BU//EABgQAQADAQAAAAAAAAAAAAAAAAABETFR/9oACAEBAAY/Al8TetSx/8QAHBAAAwACAwEAAAAAAAAAAAAAAAERIUExYXGB/9oACAEBAAE/IUxWKfDm9CW/ZmGKVBs90Np3c//aAAwDAQACAAMAAAAQgO//xAAXEQEAAwAAAAAAAAAAAAAAAAAAAREh/9oACAEDAQE/EF51/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERIf/aAAgBAgEBPxBSMf/EABsQAQEBAAMBAQAAAAAAAAAAAAERACExYUFR/9oACAEBAAE/EBAqBFemLAFgWS3KU02ol8fuPwx1eMwQwAfRQykC0crv/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"kotlinconf\" title=\"kotlinconf\" src=\"https://developers.soundcloud.com/blog/static/e5327b0c4755d511915d1650fcebe88b/a296c/kotlinconf.jpg\" srcset=\"/blog/static/e5327b0c4755d511915d1650fcebe88b/f544b/kotlinconf.jpg 200w,\n/blog/static/e5327b0c4755d511915d1650fcebe88b/41689/kotlinconf.jpg 400w,\n/blog/static/e5327b0c4755d511915d1650fcebe88b/a296c/kotlinconf.jpg 800w,\n/blog/static/e5327b0c4755d511915d1650fcebe88b/c35de/kotlinconf.jpg 1200w,\n/blog/static/e5327b0c4755d511915d1650fcebe88b/6c315/kotlinconf.jpg 1280w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </span></a></p> \n<h2>Where It All Started</h2> \n<p>I was working on some tracking code that’s part of the signup flow of our Android app. The goal was to improve the insights from the error states that users might run into. These could be local UX flaws, but they could also be issues that arise when trying to log in via third parties.</p> \n<p>My initial code looked like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">fun</span> <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span>type<span class=\"token operator\">:</span> ErrorType<span class=\"token punctuation\">,</span> details<span class=\"token operator\">:</span> String<span class=\"token operator\">?</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>The <code class=\"language-text\">ErrorType</code> is an enum that specifies the exact error type:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">enum</span> <span class=\"token keyword\">class</span> ErrorType <span class=\"token punctuation\">{</span>\n   IO<span class=\"token punctuation\">,</span>\n   PASSWORD_INVALID<span class=\"token punctuation\">,</span>\n   RECAPTCHA_FAILED\n<span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>The additional parameter details are for extra information some errors might need. But let’s take a closer look at the method signature we had:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">fun</span> <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span>type<span class=\"token operator\">:</span> ErrorType<span class=\"token punctuation\">,</span> details<span class=\"token operator\">:</span> String<span class=\"token operator\">?</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>I’d say these two parameters belong together, as the details describe the error. This means they have a very tight coupling, but they still don’t share any relationship! Rather, they are just two independent parameters.</p> \n<h2>Let’s Express This Relationship</h2> \n<p>The first idea for improving this situation is to wrap both parameters into one type:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">data</span> <span class=\"token keyword\">class</span> <span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">val</span> type<span class=\"token operator\">:</span> ErrorType<span class=\"token punctuation\">,</span> <span class=\"token keyword\">val</span> details<span class=\"token operator\">:</span> String<span class=\"token operator\">?</span><span class=\"token punctuation\">)</span>\nOur tracking method now looks much nicer<span class=\"token operator\">:</span>\n<span class=\"token keyword\">fun</span> <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span>error<span class=\"token operator\">:</span> Error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>Once we do this, there will only be one parameter in our method, making it clear to the reader what to pass:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">fun</span> <span class=\"token function\">onError</span><span class=\"token punctuation\">(</span>error<span class=\"token operator\">:</span> Error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>And they can’t pass in something wrong, as was possible when we had two independent parameters.</p> \n<p>This only confirms the quote I shared in my talk from the late Robin Milner, a British computer scientist who <a href=\"https://www.sciencedirect.com/science/article/pii/0022000078900144?via%3Dihub\">once said</a>:</p> \n<blockquote> \n <p>Well-typed expressions cannot “go wrong.”</p> \n</blockquote> \n<h2>We Can Do Better</h2> \n<p>But we should not stop here! The method is now saved, but the two parameters have simply been moved to the <code class=\"language-text\">Error</code> class, so there is still a hidden relationship!</p> \n<p>So, we should express this. We should not let the developer guess when to pass what and when or what not to! </p> \n<p>An enum type could not hold these individual details, as enum values are simply constants, which are by definition immutable. However, with sealed classes, we can model this more precisely:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">sealed</span> <span class=\"token keyword\">class</span> Error <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">object</span> InvalidPassword <span class=\"token operator\">:</span> <span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">object</span> RecaptchaFailed <span class=\"token operator\">:</span> <span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">class</span> <span class=\"token function\">IOError</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">val</span> details<span class=\"token operator\">:</span> String<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<h2>The Next Step</h2> \n<p>Another thing that enums do not support is a hierarchy. Enum values are flat on one level of abstraction.</p> \n<p>To compensate, we normally express this via the name:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">enum</span> <span class=\"token keyword\">class</span> ErrorType <span class=\"token punctuation\">{</span>\n   IO<span class=\"token punctuation\">,</span>\n   EMAIL_DENIED<span class=\"token punctuation\">,</span>\n   EMAIL_EXISTING<span class=\"token punctuation\">,</span>\n   EMAIL_INVALID<span class=\"token punctuation\">,</span>\n   PASSWORD_INVALID<span class=\"token punctuation\">,</span>\n   RECAPTCHA_FAILED\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>But as I mentioned in my talk:</p> \n<blockquote> \n <p>Don’t put in a name what can be in a type.</p> \n</blockquote> \n<p>Now, once we get rid of the enum, it’s easy to introduce a hierarchy:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">sealed</span> <span class=\"token keyword\">class</span> Error <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">sealed</span> <span class=\"token keyword\">class</span> SignInError <span class=\"token punctuation\">{</span>\n     <span class=\"token keyword\">sealed</span> <span class=\"token keyword\">class</span> EmailError <span class=\"token operator\">:</span> <span class=\"token function\">SignInError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">object</span> Denied <span class=\"token operator\">:</span> <span class=\"token function\">EmailError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">object</span> Invalid <span class=\"token operator\">:</span> <span class=\"token function\">EmailError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">object</span> Existing <span class=\"token operator\">:</span> <span class=\"token function\">EmailError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n     <span class=\"token punctuation\">}</span>\n     <span class=\"token keyword\">class</span> <span class=\"token function\">IOError</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">val</span> message<span class=\"token operator\">:</span> String<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token function\">SignInError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>As you might have noticed, we could even restrict the email-related errors to sign-in use cases. This way, we could handle all errors related to one use case at one point simply by using types.</p> \n<h2>And Then I Saw…</h2> \n<p>There was another area of the code that wasn’t using the full power of types. When trying to log in via social networks, the code normally first handles third-party library calls and then proceeds with the login flow to your own system with those results. On the other hand, when you log in directly via an email, you won’t have this first step.</p> \n<p>The code had something like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token comment\">// An error on Facebook/Google appeared.</span>\n<span class=\"token keyword\">fun</span> <span class=\"token function\">onAuthenticationError</span><span class=\"token punctuation\">(</span>method<span class=\"token operator\">:</span> Method<span class=\"token punctuation\">,</span> error<span class=\"token operator\">:</span> Error<span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>Here, <code class=\"language-text\">Method</code> is another enum:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">enum</span> <span class=\"token keyword\">class</span> Method <span class=\"token punctuation\">{</span>\n   FACEBOOK<span class=\"token punctuation\">,</span> GOOGLE<span class=\"token punctuation\">,</span> EMAIL\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>But as the code comment says, <code class=\"language-text\">onAuthenticationError()</code> is meant only for Google and Facebook. A developer should not even be able to call it with <code class=\"language-text\">Method.EMAIL</code>. But nothing prevents us from doing this. We could add an assertion and crash on invalid input, but both runtime crashes and hidden code comments are not ideal. The ideal scenario would be that the compiler could check this upfront.</p> \n<p>Thanks to our new error hierarchy, this can be solved very easily with types:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">fun</span> <span class=\"token function\">onAuthenticationError</span><span class=\"token punctuation\">(</span>error<span class=\"token operator\">:</span> Error<span class=\"token punctuation\">.</span>SocialError<span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>Here, <code class=\"language-text\">SocialError</code> is just another specialty in our sealed <code class=\"language-text\">Error</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"kotlin\">\n <pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token keyword\">sealed</span> <span class=\"token keyword\">class</span> Error <span class=\"token punctuation\">{</span>\n <span class=\"token keyword\">sealed</span> <span class=\"token keyword\">class</span> SignInError <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">sealed</span> <span class=\"token keyword\">class</span> <span class=\"token function\">SocialError</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">val</span> message<span class=\"token operator\">:</span> String<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">SignInError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token keyword\">class</span> <span class=\"token function\">GoogleError</span><span class=\"token punctuation\">(</span>message<span class=\"token operator\">:</span> String<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">SocialError</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span>\n       <span class=\"token keyword\">class</span> <span class=\"token function\">FacebookError</span><span class=\"token punctuation\">(</span>message<span class=\"token operator\">:</span> String<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token function\">SocialError</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span>\n   <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ...</span>\n <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<h2>Conclusion</h2> \n<p>In summary, types are very powerful. With the changes mentioned above, our code became easier to read and more expressive, and a new developer will know how to use the tracking methods simply by the types they need as arguments.</p> \n<p>Here are a few key takeaways from this blog post to keep in mind:</p> \n<ul> \n <li>If you see parameters that belong together but are treated separately, check if there is a hidden type.</li> \n <li>If you see classes with fields that are only used in certain cases, maybe there is a hidden type hierarchy.</li> \n <li>If you see methods that only allow a certain combination, secure them with a type.</li> \n</ul> \n<p>And, of course, if you’re interested in learning more about this, you’ll find more examples in my <a href=\"https://speakerdeck.com/dpreussler/the-power-of-types-kotlinconf-2019\">slides</a> and by watching the <a href=\"https://www.youtube.com/watch?v=t3DBzaeid74\">recording</a> of the talk.</p>","descriptionType":"html","publishedDate":"Mon, 20 Jan 2020 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/e5327b0c4755d511915d1650fcebe88b/a296c/kotlinconf.jpg","linkMd5":"b4480d630156dd2a3f8a1c928fe9fd82","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn71@2020_3/2020/08/25/00-49-39-420_76a66df06e4f0c89.webp","destWidth":800,"destHeight":450,"sourceBytes":21705,"destBytes":22518,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/e5327b0c4755d511915d1650fcebe88b/a296c/kotlinconf.jpg":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn71@2020_3/2020/08/25/00-49-39-420_76a66df06e4f0c89.webp"},"publishedOrCreatedDate":1598316569971},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Playback on Web at SoundCloud","link":"https://developers.soundcloud.com/blog/playback-on-web-at-soundcloud","description":"<p>Maestro is a library we have developed to handle all playback across SoundCloud web applications. It successfully handles tens of millions of plays per day across <a href=\"https://soundcloud.com/\">soundcloud.com</a>, our mobile site, our <a href=\"https://soundcloud.com/pages/embed\">widget</a>, Chromecast, and our <a href=\"https://developers.soundcloud.com/blog/garbage-collection-in-redux-applications\">Xbox application</a>. We are considering open sourcing it, and this blog post is a technical overview of what we’ve achieved thus far with Maestro.</p> \n<!-- more --> \n<h2>What We Support</h2> \n<p>At SoundCloud, we aim to support all modern web browsers, mobile browsers, and IE 11. Our goal is to provide the best possible playback experience using the functionality provided by your browser.</p> \n<h2>What We Stream</h2> \n<p>We currently stream three codecs:</p> \n<ul> \n <li>mp3</li> \n <li>opus</li> \n <li>aac</li> \n</ul> \n<p>Our primary protocol is HLS (HTTP Live Streaming). This means the contents of a track are split up into short segments, and we have a separate file (playlist), which contains URLs to all of the segments, along with their corresponding times in the track. You can find more information about HLS <a href=\"https://developer.apple.com/documentation/http_live_streaming/example_playlists_for_http_live_streaming/video_on_demand_playlist_construction\">here</a>.</p> \n<h2>What the Browser Provides</h2> \n<p>We make use of the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement\"><code class=\"language-text\">&lt;audio /&gt;</code></a> element, <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Media_Source_Extensions_API\">Media Source Extensions (MSE)</a>, and the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API\">Web Audio API</a>.</p> \n<p>The minimum support we require is the <code class=\"language-text\">&lt;audio /&gt;</code> element and the ability to play one of our codecs. MSE and the Web Audio API are required for the best experience.</p> \n<p>We are able to gracefully degrade when either the Web Audio API or MSE is missing or there are errors during playback.</p> \n<p>We’ll cover what we use MSE and the Web Audio API for in a bit, but first, let’s see what the <code class=\"language-text\">&lt;audio /&gt;</code> element alone does for us.</p> \n<h3><code class=\"language-text\">&lt;audio /&gt;</code></h3> \n<p>This is able to take a URL of an audio file and play it back if the codec is supported by the browser. It is informed of the codec in the <code class=\"language-text\">content-type</code> header on the response, and it provides an API, which can be used to control playback and to determine if the browser supports the codec:</p> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> audio <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\naudio<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> <span class=\"token string\">'http://example.invalid/something.mp3'</span><span class=\"token punctuation\">;</span>\n\naudio<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<h3>Media Source Extensions</h3> \n<p>With the <code class=\"language-text\">&lt;audio /&gt;</code> element alone, the browser does all the work behind the scenes, and you don’t have access to the underlying buffer.</p> \n<p>With MSE, we are able to create a buffer for a codec that is supported by the browser. We are then able to handle both downloading the media ourselves and appending it to the buffer. This means we can make optimizations, such as preloading, which is where we download the first few seconds of tracks we think you will play before you click the play button and store them in memory. And then when you click play, we can append this data straight from memory into the buffer instead of having to go to the network:</p> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> audio <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> mse <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MediaSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">createObjectURL</span><span class=\"token punctuation\">(</span>mse<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\naudio<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> url<span class=\"token punctuation\">;</span>\naudio<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmse<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sourceopen'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 'audio/mpeg' for mp3</span>\n  <span class=\"token keyword\">const</span> buffer <span class=\"token operator\">=</span> mse<span class=\"token punctuation\">.</span><span class=\"token function\">addSourceBuffer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio/mpeg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  buffer<span class=\"token punctuation\">.</span>mode <span class=\"token operator\">=</span> <span class=\"token string\">'sequence'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Request</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://example.invalid/segment0.mp3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=&gt;</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">arrayBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      buffer<span class=\"token punctuation\">.</span><span class=\"token function\">appendBuffer</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<h3>Web Audio API</h3> \n<p>The Web Audio API is the newest of the APIs mentioned here. We use a small portion of this API to perform a quick fade in and out when you play, pause, or seek. This makes seeking feel snappier, and playing/pausing is less abrupt:</p> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> audio <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'audio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> context <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AudioContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> sourceNode <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">createMediaElementSource</span><span class=\"token punctuation\">(</span>audio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gainNode <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">createGain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsourceNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>gainNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ngainNode<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>destination<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\naudio<span class=\"token punctuation\">.</span>src <span class=\"token operator\">=</span> <span class=\"token string\">'http://example.invalid/something.mp3'</span><span class=\"token punctuation\">;</span>\naudio<span class=\"token punctuation\">.</span><span class=\"token function\">play</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Schedule fade out.</span>\ngainNode<span class=\"token punctuation\">.</span>gain<span class=\"token punctuation\">.</span><span class=\"token function\">linearRampToValueAtTime</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">.</span>currentTime <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<h2>Goals of Maestro</h2> \n<ul> \n <li>Simple API</li> \n <li>Plugin architecture</li> \n <li>Easy feature detection</li> \n <li>Type safety</li> \n <li>Support all major browsers</li> \n <li>Handle bugs/differences in browser implementations</li> \n <li> <p>Great performance</p> \n  <ul> \n   <li>Ability to preload</li> \n   <li>As responsive as possible</li> \n  </ul> </li> \n <li> <p>Configurable buffer length and cache size</p> \n  <ul> \n   <li>Should be able to work on devices with constrained memory, such as Chromecast</li> \n  </ul> </li> \n <li> <p>Metrics</p> \n  <ul> \n   <li>Provide error and performance data, which can be monitored to detect bugs and make more improvements</li> \n  </ul> </li> \n</ul> \n<h2>Tech Stack</h2> \n<ul> \n <li><a href=\"https://github.com/Microsoft/TypeScript\">TypeScript</a></li> \n <li><a href=\"https://github.com/lerna/lerna\">Lerna</a></li> \n <li><a href=\"https://github.com/yarnpkg/yarn\">Yarn</a></li> \n <li><a href=\"https://github.com/webpack\">webpack</a></li> \n</ul> \n<h2>The API</h2> \n<p>Maestro consists of many packages. The core package provides an abstract <code class=\"language-text\">BasePlayer</code> class, which provides the player API. It delegates tasks to specific implementations, but external communication happens through <code class=\"language-text\">BasePlayer</code>. Up-to-date state can be retrieved through player methods, and the user is also notified of any changes.</p> \n<p>For example, the <code class=\"language-text\">play()</code> method returns a <code class=\"language-text\">Promise</code> which may resolve or reject. The <code class=\"language-text\">BasePlayer</code> will inform the implementation when it should play or pause, and the implementation will inform the <code class=\"language-text\">BasePlayer</code> when it is actually playing. Each player implementation is decoupled from the actual <code class=\"language-text\">play()</code> method. This also means the <code class=\"language-text\">isPlaying()</code> method and corresponding updates can be handled completely by <code class=\"language-text\">BasePlayer</code>. Another example is <code class=\"language-text\">getPosition()</code>, which will normally ask the implementation for the current time, except for when a seek is in progress, in which case <code class=\"language-text\">BasePlayer</code> will return the requested position. This means the time from <code class=\"language-text\">getPosition()</code> always makes sense and users don’t need to override it when seeking to ensure it doesn’t jump around.</p> \n<p>Player implementations are contained in separate packages, and they all extend <code class=\"language-text\">BasePlayer</code>. We currently have the following players:</p> \n<ul> \n <li><code class=\"language-text\">HTML5Player</code> — This is the simplest player. It takes a URL and a MIME type, which are passed directly to a media element.</li> \n <li><code class=\"language-text\">HLSMSEPlayer</code> — This extends <code class=\"language-text\">HTML5Player</code>, and it takes a <code class=\"language-text\">Playlist</code> object, which is responsible for providing segment data. This player uses MSE.</li> \n <li><code class=\"language-text\">ChromecastPlayer</code> — This player is a proxy to controlling a Chromecast.</li> \n <li><code class=\"language-text\">ProxyPlayer</code> — This player can control another player, which can be switched on the fly. It also has some configuration related to the direction to sync when a new player is provided. One of the benefits of this player is that it can be provided to apps synchronously, even when the real player isn’t available yet. Then, once the real player is available, its state will be synced to match the proxy. Some other use cases of this are switching between playback on a Chromecast and locally, or switching qualities. The app only has to interact with one player, and the switch can happen behind the scenes.</li> \n</ul> \n<h2>State Management and Events</h2> \n<p>There is a lot of playback state to manage, and in Maestro, most of this is contained inside <code class=\"language-text\">BasePlayer</code>. Users also want to know when parts of the state change and will sometimes react to changes by performing other player actions. This introduces some complexities when we are running on a single thread. Sometimes we also want to update several parts of the state atomically (across multiple functions). An example is: If the user seeks to the end of the media, we also want to update the <code class=\"language-text\">ended</code> flag to <code class=\"language-text\">true</code>. The logic concerned with updating the <code class=\"language-text\">ended</code> flag is not tied to the seeking logic in code, but the update of the seeking state and the ended state should happen together in the API.</p> \n<p>To achieve this, we built a component called <code class=\"language-text\">StateManager</code>, which enables us to:</p> \n<ul> \n <li>Update multiple parts of the state across functions before calling out to inform the user of the changes.</li> \n <li>Notify the user of state changes at the end of the player call stack so that any future interactions they have with the player are not interleaved in the call stack as a result. (For example, do the work and then fire the event, instead of firing the event and then doing the work.)</li> \n</ul> \n<h3><code class=\"language-text\">StateManager</code></h3> \n<p>The state manager maintains a state object. All changes to this object are made using an <code class=\"language-text\">update()</code> method, and a callback can be provided, which is then notified of any state changes that happened inside the last <code class=\"language-text\">update()</code>. These calls can be nested:</p> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> ChangesCallback<span class=\"token operator\">&lt;</span>State<span class=\"token operator\">&gt;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">changes<span class=\"token punctuation\">:</span> Readonly<span class=\"token operator\">&lt;</span>Partial<span class=\"token operator\">&lt;</span>State<span class=\"token operator\">&gt;&gt;</span><span class=\"token punctuation\">,</span>\n  state<span class=\"token punctuation\">:</span> Readonly<span class=\"token operator\">&lt;</span>State<span class=\"token operator\">&gt;</span></span>\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> Control <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">remove</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> Subscriber<span class=\"token operator\">&lt;</span>State<span class=\"token operator\">&gt;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  callback<span class=\"token punctuation\">:</span> ChangesCallback<span class=\"token operator\">&lt;</span>State<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">;</span>\n  localState<span class=\"token punctuation\">:</span> State<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">StateManager</span><span class=\"token operator\">&lt;</span>State <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> Object <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token operator\">&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> _state<span class=\"token punctuation\">:</span> State<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> _subscribers<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Array</span><span class=\"token operator\">&lt;</span>Subscriber<span class=\"token operator\">&lt;</span>State<span class=\"token operator\">&gt;&gt;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> _updating <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">initialState<span class=\"token punctuation\">:</span> State</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_state <span class=\"token operator\">=</span> <span class=\"token function\">clone</span><span class=\"token punctuation\">(</span>initialState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token function-variable function\">callback</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">:</span> State</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> wasUpdating <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_updating<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_updating <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// error handling...</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>wasUpdating<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_updating <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_afterUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">:</span> ChangesCallback<span class=\"token operator\">&lt;</span>State<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">,</span> skipPast <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Control <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">_afterUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_subscribers<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">subscriber</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> diff <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_calculateDiff</span><span class=\"token punctuation\">(</span>subscriber<span class=\"token punctuation\">.</span>localState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// We always recalculate the diff just before calling a subscriber,</span>\n      <span class=\"token comment\">// which means that the state is always up to date at the point when</span>\n      <span class=\"token comment\">// the subscriber is called.</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>diff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        subscriber<span class=\"token punctuation\">.</span>localState <span class=\"token operator\">=</span> <span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">deferException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> subscriber<span class=\"token punctuation\">.</span><span class=\"token function\">callback</span><span class=\"token punctuation\">(</span>diff<span class=\"token punctuation\">,</span> subscriber<span class=\"token punctuation\">.</span>localState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">_calculateDiff</span><span class=\"token punctuation\">(</span>compare<span class=\"token punctuation\">:</span> State<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Readonly<span class=\"token operator\">&lt;</span>Partial<span class=\"token operator\">&lt;</span>State<span class=\"token operator\">&gt;&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<h4>Example Usage</h4> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> OurState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> a<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span> b<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span> c<span class=\"token punctuation\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span> d<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> stateManager <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StateManager</span><span class=\"token operator\">&lt;</span>OurState<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  a<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  b<span class=\"token punctuation\">:</span> <span class=\"token string\">'something'</span><span class=\"token punctuation\">,</span>\n  c<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  d<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nstateManager<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// On first execution:</span>\n  <span class=\"token comment\">// a === 2</span>\n  <span class=\"token comment\">// b === 'something else'</span>\n  <span class=\"token comment\">// c === false</span>\n  <span class=\"token comment\">// d === undefined</span>\n\n  <span class=\"token comment\">// On second execution:</span>\n  <span class=\"token comment\">// a === undefined</span>\n  <span class=\"token comment\">// b === undefined</span>\n  <span class=\"token comment\">// c === undefined</span>\n  <span class=\"token comment\">// d === 3</span>\n  <span class=\"token function\">updateD</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nstateManager<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">,</span> d <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// a === 2</span>\n  <span class=\"token comment\">// b === 'something else'</span>\n  <span class=\"token comment\">// c === false</span>\n  <span class=\"token comment\">// d === 3</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  stateManager<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    state<span class=\"token punctuation\">.</span>a <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">updateB</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    state<span class=\"token punctuation\">.</span>c <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">updateB</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  stateManager<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    state<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> <span class=\"token string\">'something else'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">updateD</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  stateManager<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    state<span class=\"token punctuation\">.</span>d <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>Note that the first subscribe callback will be executed twice, but the second will only be executed once, and only with the latest state (i.e. <code class=\"language-text\">d === 3</code>).</p> \n<p>Also note that we don’t get nested call stacks, because the callbacks are only executed once the work is finished.</p> \n<h2>Browser Limitations</h2> \n<p>Unfortunately, different browsers have different codec support (which can also depend on the OS) and different container requirements.</p> \n<p>Chrome, for example, supports a raw MP3 file in MSE, but Firefox requires the MP3 to be in an MP4 container. This means that in Firefox, we need to package the MP3 that we download into an MP4 in the browser. Other codecs have similar complexities.</p> \n<p>It’s also inevitable that there are bugs. Supporting a media processing pipeline that can handle a huge variety of media, without breaking backward compatibility, in a secure way, and in a web browser, is a huge task! Luckily, Maestro is able to handle workarounds for various bugs in different browsers, some which differ under the hood between versions.</p> \n<p>Autoplay policies also differ between browsers, and this means we currently have to share media elements between players. This adds complexity because when the source of an element is changed, there are still events emitted for the previous source for a short time after, meaning we have to wait for the “emptied” event before attempting to use it, and we have to keep track of everything that was requested in the meantime. Maestro’s <code class=\"language-text\">HTML5Player</code> makes this simple with <code class=\"language-text\">provideMediaElement(mediaEl)</code> and <code class=\"language-text\">revokeMediaElement()</code>. This allows you to move a media element between players at runtime. When a player doesn’t have a media element, the player is simply stalled.</p> \n<h2>Testing</h2> \n<p>The <code class=\"language-text\">BasePlayer</code> and player implementations are covered by unit tests and integration tests: We use <a href=\"https://github.com/mochajs/mocha\">Mocha</a>, <a href=\"https://github.com/sinonjs/sinon\">Sinon</a>, and <a href=\"https://github.com/karma-runner/karma\">Karma</a>, along with <a href=\"https://github.com/schnittstabil/mocha-screencast-reporter\">mocha-screencast-reporter</a>. The latter is great for viewing the progress of tests running remotely.</p> \n<p>The <code class=\"language-text\">BasePlayer</code> alone currently has more than 700 tests, which ensures that the API behaves correctly. One test, for example, checks that the <code class=\"language-text\">play()</code> promise is resolved when the implementation reports it is playing. Another checks that <code class=\"language-text\">play()</code> is rejected with the correct error if the player is killed before the play request completes. There are also tests that check that the player errors if an inconsistency is detected — such as a player implementation reporting that a seek request could not be completed when the <code class=\"language-text\">BasePlayer</code> never requested a seek operation.</p> \n<p>We also run all the tests on a variety of browsers and browser versions (including Chrome and Firefox beta) using <a href=\"https://saucelabs.com/\">SauceLabs</a>. This takes several hours to complete, and so we test the major browsers for pull requests, and then we test everything just before a release. We also run all the tests weekly to ensure that there are no issues arising with new browser versions. Doing so once highlighted a bug with Web Audio in Firefox beta which would cause playback to freeze after the first few seconds.</p> \n<h2>Progressive Streaming (with the <code class=\"language-text\">fetch()</code> API)</h2> \n<p>We recently added support for progressive streaming (in supported browsers). This means that instead of having to wait for an entire segment to be downloaded before we process it and append it to the buffer, we’re able to process the data as it arrives, meaning we’re able to start playback before the segment download has finished.</p> \n<p>This was made possible with the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\"><code class=\"language-text\">fetch()</code></a> API (and <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequestResponseType\"><code class=\"language-text\">moz-chunked-arraybuffer</code></a> in Firefox), which provides small parts of the data while it is still being downloaded:</p> \n<div class=\"gatsby-highlight\" data-language=\"typescript\">\n <pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Request</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> body <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> body<span class=\"token punctuation\">.</span><span class=\"token function\">pipeTo</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">WritableStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function-variable function\">write</span><span class=\"token punctuation\">:</span> <span class=\"token parameter\">chunk</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Got part'</span><span class=\"token punctuation\">,</span> chunk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">abort</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Aborted'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">close</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Got everything'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>Before we added progressive streaming, if a download failed, we would just retry it, and this logic was pretty self-contained. With progressive streaming, it is more complex because, if a download fails part-way through, the entire pipeline has already started working on the data. We decided to retry the request on an error and discard all bytes that we have already seen. If the retry fails, then we are able to signal the error down the pipeline.</p> \n<p>This also brings about more complexity. Before, we knew that each segment contained a complete number of valid units of audio, meaning the different parts of the pipeline could make certain assumptions. Now each part of data can contain fractions of units of audio, so we need to be able to detect when this happens and keep a buffer that waits for a complete unit to arrive.</p> \n<h2>What’s Next?</h2> \n<p>We have run Maestro in production since June 2017, and we’ve have had minimal reports of playback issues. We are able to monitor the performance and errors in real time, and in cases where errors occur, we are able to retrieve playback logs, which help with debugging.</p> \n<p>We are looking for where to take Maestro next, and that’s where you come in: Let us know how you would use it and what you would like to see :D</p> \n<p>If you have any questions regarding this post, or you notice any playback problems on <a href=\"https://soundcloud.com/rick-astley-official/never-gonna-give-you-up\">soundcloud.com</a> ;), please get in touch!</p>","descriptionType":"html","publishedDate":"Fri, 03 May 2019 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"dbfcb2a82648d9d38e6f807ed14a9376","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569989},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Sponsoring CocoaPods","link":"https://developers.soundcloud.com/blog/sponsoring-cocoapods","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 278px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/c2a2b9555b3a32361e0c47d898c26c87/e14eb/logos-small.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.76258992805756%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByklEQVQoz5WS30uTURjHd50R0nU3XXaRVwUR9RfURXZTeV8XSaRBc0ZdGGRh0FuWlFZsOeYPdI0G1SoklYWir6vm2PANQxnkNqbbTJ1z7/bpeU+oCGp04Jzvc748z/c8X55jK5fL/M8yTROrplQqbcF1HZt1JOJx3ricfPJ6edfl4WNfH/7OV3Lv563Ho3jvi+f8mp1RRTs1YfFKMNDbQ83RIzhqLnDl9Cns58+puK76DPVnq6kXvCb49HYTzvst+N2ddD1upb+jne62Jwz4fCykUpsdDvhe03TpIlqDnQf26zxqdKiC5trLtN5o5JkIBT8E6Gi+g/uhhlvTaKm7Stutm2iOBl7eu8ucuNwQfN/TzQGbjROV+6gSPFaxh0OCx/dWcFjw5P5KDgr6XS5VlE4kWM3nWV5aYnVlRcVbLGfTab59CaIPDfE1GGRieFjh+PgIobFRQnLXBweZTyZ3HdiG4FqxyKK8pqYoZNEs/c0YMWAmxe9iAWsMpkw0m82SyWRISxPWzuVyiisUCpuW89Lyz+lpjKkpdF1n8nuYeHKORWeAhc8hfsRnCQlvGAaTkQjRaFTlRSSOxWKEw2ElrAR3/Ifl7S39y/IfL9ZlarEYFjIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Cocoapods\" title=\"Cocoapods\" src=\"https://developers.soundcloud.com/blog/static/c2a2b9555b3a32361e0c47d898c26c87/e14eb/logos-small.png\" srcset=\"/blog/static/c2a2b9555b3a32361e0c47d898c26c87/9ec3c/logos-small.png 200w,\n/blog/static/c2a2b9555b3a32361e0c47d898c26c87/e14eb/logos-small.png 278w\" sizes=\"(max-width: 278px) 100vw, 278px\" loading=\"lazy\" /> </a> </span>I’m excited to announce that SoundCloud is sponsoring the development of&nbsp;<a href=\"http://cocoapods.org/\" title=\"CocoaPods\">CocoaPods</a> through a <a href=\"http://foundation.travis-ci.org/\" title=\"Travis Foundation\">Travis Foundation</a> grant. CocoaPods is an open-source&nbsp;dependency manager for Objective-C&nbsp;projects. Travis Foundation is a non-profit that pairs corporate sponsors with open-source projects to make open source even better.</p> \n<p>At SoundCloud, our&nbsp;iOS team uses CocoaPods every day to manage the dependencies of our mobile apps. We hope that this sponsorship will lead to improvements that benefit the entire Mac and iOS developer ecosystem.</p> \n<p>Watch for updates in the coming weeks on the&nbsp;<a href=\"http://foundation.travis-ci.org/blog/\" title=\"Travis Foundation blog\">Travis Foundation blog</a>&nbsp;and <a href=\"http://blog.cocoapods.org/\" title=\"CocoaPods Blog\">CocoaPods blog</a>.</p>","descriptionType":"html","publishedDate":"Sat, 08 Mar 2014 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/c2a2b9555b3a32361e0c47d898c26c87/e14eb/logos-small.png","linkMd5":"357e63de037c09a5678a197bd61f26ca","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn51@2020_3/2020/08/25/00-49-37-700_483cd99d9b633c8a.webp","destWidth":278,"destHeight":130,"sourceBytes":3252,"destBytes":5294,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/c2a2b9555b3a32361e0c47d898c26c87/e14eb/logos-small.png":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn51@2020_3/2020/08/25/00-49-37-700_483cd99d9b633c8a.webp"},"publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Hello developers!","link":"https://developers.soundcloud.com/blog/developers-soundcloud-com","description":"<p> We are happy to introduce you to our new developer portal developers.soundcloud.com. Here we are bundling up all the SoundCloud platform and developer related products and resources. It will give you the best starting point to dig into our API and all things related! Let us know what you think about it!</p>","descriptionType":"html","publishedDate":"Mon, 04 Apr 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"6c7280709c9412ef0ba31b3b8e10530b","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"New playlist representations","link":"https://developers.soundcloud.com/blog/new_playlist_representations","description":"<p>Requests for playlists have always included the full track objects contained within. This representation may be convenient for playlists with ten or twenty tracks but can cause problems for playlists that contain hundreds or thousands of tracks. Requesting such large playlists could result in requests that take a long time to respond and that eventually timeout.</p> \n<p>Today, we introduce two new representations for the <code class=\"language-text\">/playlists</code> resource: <code class=\"language-text\">compact</code> and <code class=\"language-text\">id</code>.</p> \n<p>If you add <code class=\"language-text\">representation=compact</code> to a playlist request, the request will return only the playlist itself, without any of the tracks it contains. This representation may be useful if you’re purely interested in data about the playlist itself and not the tracks contained within.</p> \n<p>Alternatively, if you set the <code class=\"language-text\">representation=id</code> parameter, it will return the playlist along with IDs of the tracks contained within, without all the associated track meta data (artist, artwork, duration, etc.) If necessary, you can then individually fetch additional information about each track by filling those IDs into the <code class=\"language-text\">/tracks</code> resource. This allows for greater parallelization and can help make your application more responsive when working with large playlists.</p> \n<p>By default, requests for playlists will continue to include all the contained tracks. There is no need to update your application but we encourage you to take advantage of these new, more efficient representations of playlists.</p>","descriptionType":"html","publishedDate":"Mon, 08 Jun 2015 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"c85ea588ac46bfc818627ae87a348324","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569978},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Breaking Loose from Third-Party Lock-In with Custom Refactoring Tools","link":"https://developers.soundcloud.com/blog/breaking-loose-from-third-party-lock-in-with-custom-refactoring-tools","description":"<p>Code refactoring is an essential part of the job of software developers. As time goes on, technology evolves, product requirements change, and new features are built into a codebase. These things have the potential to negatively impact both the codebase’s quality and its capacity to be extended to retain its value for as long as possible. In addition to refactoring, it’s also part of our job to timely detect when changes in our code are necessary, so as to avoid code becoming too complex or growing to unmanageable levels.</p> \n<p>However, even though it’s essential, refactoring can at times be intimidating, and introducing improvements to a codebase without affecting its behavior can impose huge challenges on software developers.</p> \n<h2>Deprecating Specta</h2> \n<p>At SoundCloud, we create all our new features in our iOS app using Swift, but since our codebase was started several years ago, we still have a significant amount of Objective-C code to maintain (including third-party libraries). Years ago, before adopting Swift, we decided to use <a href=\"https://github.com/specta/specta\">Specta</a>, “A light-weight TDD / BDD framework for Objective-C,” to write our unit tests. It brought us a lot of value for a long time, but around two years ago, after experiencing issues like not being able to run a single test without the entire test suite being run, and being unhappy with Xcode’s support for Specta, we decided to deprecate it.</p> \n<p>From the moment of deprecation onward, we decided to write all our new tests using plain <code class=\"language-text\">XCTest</code>s, but we were still locked in to using Specta, as we had more than 900 spec files in our codebase.</p> \n<p>The number of specs in our project was not negligible, and manually transforming those specs into <code class=\"language-text\">XCTest</code>s was a very tedious, error-prone, and time-consuming task; even though we would have loved to transform all the specs into <code class=\"language-text\">XCTest</code> at once, it would have taken too much time to be viable. Given this interesting challenge, I decided to take advantage of one of the <a href=\"https://developers.soundcloud.com/blog/a-happy-new-employee\">benefits of working at SoundCloud</a> and set out to find a way to automate the transformation of these specs during my self-allocated time (SAT). Luckily, the project succeeded and Specta is no longer part of our codebase. So in this post, I’ll cover how it was done.</p> \n<h2>Specta vs. XCTest</h2> \n<p>Let’s start by comparing how tests are structured in both <code class=\"language-text\">Specta</code> and <code class=\"language-text\">XCTest</code>. Due to Specta’s domain-specific language (DSL), you can structure your tests in complex ways. This can be a blessing if you’re trying to avoid duplication and a curse if it’s taken too far, as it makes specs hard to navigate with all the nesting. For the sake of this blog post, we’ll use a rather simple spec to demonstrate the work done.</p> \n<p>The image below shows how testing the same simple <code class=\"language-text\">User</code> class is done using both formats:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/27134d3f37ae0be10d5b2522f4f96095/8013a/specta-vs-xctest.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 61.62962962962963%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABrklEQVQoz3VT27KjIBD0azYqyh0Eb8mp3fP/n9TbYEw82dqHqVEYerqbofHO45Eysg4Yeo22U+iY36HQyhmbj3jEjGgTRh3RDRbdP7UajZQR2m8YWChGh/4J2pZcisq3mpH0gmRWjGGFsBmdMO+6kp/RWL8gph3aTJDs3LPzlWX7BLTcX9Kj1txa+ar5VNRoP8Owo+SP4Kb4kFAPEFCpiBgWWJehCDpQzWfjQzI77/tvepSwhYxQ/OHG7cqAgIbrIWwVrD+9vUg9a5tReqzzHTltcIWBSZAyVAZvwIWAE3LcUSxqhT0uZXBHXBmOyrNrgGQu4OXb2Kky+QQsYDqy8UTPaVNPG0qcF3RIJkAgM0dApz00mf26jTVecvQBWECkmyGZBVW0hd3ofwIWVtv6VSWHuMLZXFmW9auHgUDr+gfT/RvT/o0wf8GkOyTPCKr5Aego0XJRKgKRqTbxMP/s/GToKVkRQDPMtMFy3CTViWqPqTPblDEQNPiUWGbsjJfkOocJkf6ZzIthGCqy+Q41rfVRnLKbwkT85xmdknsytGSo1HF5R4RqjagP4T3ofwEPe3Y8Zbh+IgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"specta vs xctest\" title=\"specta vs xctest\" src=\"https://developers.soundcloud.com/blog/static/27134d3f37ae0be10d5b2522f4f96095/8ff1e/specta-vs-xctest.png\" srcset=\"/blog/static/27134d3f37ae0be10d5b2522f4f96095/9ec3c/specta-vs-xctest.png 200w,\n/blog/static/27134d3f37ae0be10d5b2522f4f96095/c7805/specta-vs-xctest.png 400w,\n/blog/static/27134d3f37ae0be10d5b2522f4f96095/8ff1e/specta-vs-xctest.png 800w,\n/blog/static/27134d3f37ae0be10d5b2522f4f96095/6ff5e/specta-vs-xctest.png 1200w,\n/blog/static/27134d3f37ae0be10d5b2522f4f96095/8013a/specta-vs-xctest.png 1350w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h3>Test Declaration</h3> \n<p>In <code class=\"language-text\">Specta</code>, tests are declared with the use of the <code class=\"language-text\">SpecBegin</code> and <code class=\"language-text\">SpecEnd</code> macros, while in <code class=\"language-text\">XCTest</code>, tests are classes that inherit from the <code class=\"language-text\">XCTestCase</code> class.</p> \n<h3>Scope of Variables and Properties</h3> \n<p>In Specta, the scope of variables is determined by the enclosing scope they’re declared in. The <code class=\"language-text\">Specta</code> DSL works by using functions that get passed blocks, where every block defines a new context. To make variables mutable from within blocks nested at a deeper level, they need to be declared with the <a href=\"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Blocks/Articles/bxVariables.html\">__block</a> keyword. In <code class=\"language-text\">XCTest</code>, member properties or ivars are declared to make them accessible by methods, just like a regular Objective-C class.</p> \n<h3>Setup and Teardown</h3> \n<p>When writing tests, we need to prepare the initial state before our tests run and clean it up after they complete. In <code class=\"language-text\">XCTest</code>, <code class=\"language-text\">XCTestCase</code> provides class and instance methods that can be overridden to set and clean the state. In <code class=\"language-text\">Specta</code>, the <code class=\"language-text\">before</code> and <code class=\"language-text\">after</code> methods serve the same purpose.</p> \n<h3>Test Methods</h3> \n<p>In <code class=\"language-text\">XCTest</code>, test methods need to comply with a set of conventions in order for Xcode to find and execute them. As per <a href=\"https://developer.apple.com/documentation/xctest/defining_test_cases_and_test_methods\">Apple documentation</a>, “a test method is an instance method on an <code class=\"language-text\">XCTestCase subclass</code>, with no parameters, no return value, and a name that begins with the lowercase word <code class=\"language-text\">test</code>.” When using <code class=\"language-text\">Specta</code>, we call the <code class=\"language-text\">it</code> function and pass the block that contains the assertions for our test (specs are processed at runtime to dynamically generate test classes that comply with these conventions, which makes it possible for Xcode to execute them).</p> \n<h2>From Specta to XCTest</h2> \n<p>Knowing how these two ways of writing tests differ, I figured that to systematically transform a <code class=\"language-text\">Specta</code> spec into an <code class=\"language-text\">XCTestCase</code> class, we needed to do the following:</p> \n<ul> \n <li>Find top-level calls to the <code class=\"language-text\">before</code> and <code class=\"language-text\">after</code> methods and use them to generate <code class=\"language-text\">setUp</code> and <code class=\"language-text\">tearDown</code> methods.</li> \n <li>Find calls to the <code class=\"language-text\">it</code> method and generate test methods from them.</li> \n <li>Find calls to the <code class=\"language-text\">before</code> method that are within a context and generate setup methods from them that can be called from test methods to set the initial state as needed.</li> \n</ul> \n<p>In order to generate intuitive names for our test methods, the context names needed to be extracted from calls to the <code class=\"language-text\">describe</code> and <code class=\"language-text\">context</code> functions and then processed to make them valid Objective-C method names. In the same manner, calls to <code class=\"language-text\">before</code> and <code class=\"language-text\">after</code> methods from within the associated contexts needed to be detected to make sure the state was being prepared accordingly before the tests were run. If this sounds confusing, the image below might give you a better idea of how elements from the spec were translated into <code class=\"language-text\">XCTest</code> test methods.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/01b8f840504e9c517d2ac908a65d39c6/1589a/specta-vs-xctest-method-names.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 64.81191222570533%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAAB9klEQVQ4y22SaZabMBCEOY3HBoOEdsRmx868yf0PVKkWxh5P8qOfABVfVy+VMxZrCMjaQ517HGuF01toHI4dlJlxCR7ZBHjt0LS23J1+6KtORdh4QWsHHJu+iI4SJ4kXsDMr7u6KIVCbRD/iRL1oXnqNqncZPi7QfURvErrOPUH7+UHgmQ57HWGYuD6b8u1d93CoKRBRU/fFSRHW/wIbApObkIYLtIlQyqMheNfs+qqjq3m5sz8ZtzRhDiM69uf4EL0cLvA2w4YZLas4twb1o+Q3oFyO+YLoBjjGEPlDs5X0E+j6hORndHR3+Gg3mPTwEaItQE+QhGIfNR3n8QrnR7qwT2Br1wLUboSmS8Wz1Qm1DqhVeA6okmyaHzuujGIZurOlNzIgAYpoBxoBsuyeyTSHKRtS01Dd+W89JHCarkhxQk4zxmEtk5YBtYTLvUyvtQvbwqFMN6T1Ez03o2WCE93VPHdoKTn6jExgYi8dhzIyQeazTF+cSvlp+YPrfMfIAVreW97bvJZThQkNqyxAcSArIKf87HlpWc4W20pJUjPcMecrJrpL62849jlMvxDmG0xaoPyEmi2qjN16dfjYdlBC1kG+CUgSybMAJwLX6yfmR6y3L1zuX4gjXXI3i0NFq/9b0O/vksBEOpEh8Fn0cu4G9pB//gJgLJoCEiq+gQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"specta vs xctest\" title=\"specta vs xctest\" src=\"https://developers.soundcloud.com/blog/static/01b8f840504e9c517d2ac908a65d39c6/8ff1e/specta-vs-xctest-method-names.png\" srcset=\"/blog/static/01b8f840504e9c517d2ac908a65d39c6/9ec3c/specta-vs-xctest-method-names.png 200w,\n/blog/static/01b8f840504e9c517d2ac908a65d39c6/c7805/specta-vs-xctest-method-names.png 400w,\n/blog/static/01b8f840504e9c517d2ac908a65d39c6/8ff1e/specta-vs-xctest-method-names.png 800w,\n/blog/static/01b8f840504e9c517d2ac908a65d39c6/6ff5e/specta-vs-xctest-method-names.png 1200w,\n/blog/static/01b8f840504e9c517d2ac908a65d39c6/1589a/specta-vs-xctest-method-names.png 1276w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Code transformations can be done in multiple ways, and depending on the problem, one tool might be better than another. Some of the options I considered were:</p> \n<ul> \n <li>Text replacement using regular expressions.</li> \n <li>Refactoring features available in Xcode.</li> \n <li>Low-level libraries that operate on the abstract syntax tree (AST).</li> \n</ul> \n<p>While possible, using regular expressions to perform the type of source transformations described above would have been incredibly cumbersome and error-prone. The available Xcode features for refactoring were also not advanced enough for the task at hand, so I was left with option three. I started investigating different alternatives that allowed me to operate on the AST. Fortunately, I found <code class=\"language-text\">LibTooling</code>, which provides a way to conveniently analyze the abstract syntax tree using a set of high-level abstractions to match against sections of the code you’re interested in. In the following sections, I’ll expand on what LibTooling is and how I used it.</p> \n<h2>LLVM’s LibTooling</h2> \n<p>LibTooling is a library you can use to create your own standalone tools based on the Clang compiler. The LLVM compiler takes our code through three different stages to create the executable:</p> \n<ul> \n <li>The frontend stage takes the code through the lexical, syntactic, and semantic analysis phases to generate the IR (intermediate representation) that is used as an input for the subsequent phases.</li> \n <li>The middle-end stage applies target-independent optimizations — like the removal of useless or unreachable code — on the IR.</li> \n <li>Finally, the backend stage converts the IR into machine code to generate the target program.</li> \n</ul> \n<p>In order to efficiently perform a source transformation, we need to be able to operate on the AST, which means we need to somehow be able to tap into the compiler’s frontend to have it generate the AST for our source and later be able to analyze it. Fortunately, this is exactly what LibTooling’s frontend actions do!</p> \n<h3>ASTMatchFinder</h3> \n<p><code class=\"language-text\">ASTMatchFinder</code> is a frontend action class that can be used to match against the AST. To better explain what is meant by “matching against the AST,” I’ll provide a concrete example.</p> \n<p>Consider the following function:</p> \n<div class=\"gatsby-highlight\" data-language=\"cpp\"> \n <pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">int</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">/</span> <span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Now let’s see what its AST looks like:</p> \n<div class=\"gatsby-highlight\" data-language=\"cpp\"> \n <pre class=\"language-cpp\"><code class=\"language-cpp\">`<span class=\"token operator\">-</span>FunctionDecl <span class=\"token number\">0x5aeab50</span> <span class=\"token operator\">&lt;</span>test<span class=\"token punctuation\">.</span>cc<span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> line<span class=\"token operator\">:</span><span class=\"token number\">4</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token operator\">&gt;</span> f <span class=\"token string\">'int (int)'</span>\n  <span class=\"token operator\">|</span><span class=\"token operator\">-</span>ParmVarDecl <span class=\"token number\">0x5aeaa90</span> <span class=\"token operator\">&lt;</span>line<span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> col<span class=\"token operator\">:</span><span class=\"token number\">11</span><span class=\"token operator\">&gt;</span> x <span class=\"token string\">'int'</span>\n  `<span class=\"token operator\">-</span>CompoundStmt <span class=\"token number\">0x5aead88</span> <span class=\"token operator\">&lt;</span>col<span class=\"token operator\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span> line<span class=\"token operator\">:</span><span class=\"token number\">4</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">|</span><span class=\"token operator\">-</span>DeclStmt <span class=\"token number\">0x5aead10</span> <span class=\"token operator\">&lt;</span>line<span class=\"token operator\">:</span><span class=\"token number\">2</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> col<span class=\"token operator\">:</span><span class=\"token number\">24</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">|</span> `<span class=\"token operator\">-</span>VarDecl <span class=\"token number\">0x5aeac10</span> <span class=\"token operator\">&lt;</span>col<span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> col<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token operator\">&gt;</span> result <span class=\"token string\">'int'</span>\n    <span class=\"token operator\">|</span>   `<span class=\"token operator\">-</span>ParenExpr <span class=\"token number\">0x5aeacf0</span> <span class=\"token operator\">&lt;</span>col<span class=\"token operator\">:</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> col<span class=\"token operator\">:</span><span class=\"token number\">23</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'int'</span>\n    <span class=\"token operator\">|</span>     `<span class=\"token operator\">-</span>BinaryOperator <span class=\"token number\">0x5aeacc8</span> <span class=\"token operator\">&lt;</span>col<span class=\"token operator\">:</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span> col<span class=\"token operator\">:</span><span class=\"token number\">21</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'int'</span> <span class=\"token string\">'/'</span>\n    <span class=\"token operator\">|</span>       <span class=\"token operator\">|</span><span class=\"token operator\">-</span>ImplicitCastExpr <span class=\"token number\">0x5aeacb0</span> <span class=\"token operator\">&lt;</span>col<span class=\"token operator\">:</span><span class=\"token number\">17</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'int'</span> <span class=\"token operator\">&lt;</span>LValueToRValue<span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">|</span>       <span class=\"token operator\">|</span> `<span class=\"token operator\">-</span>DeclRefExpr <span class=\"token number\">0x5aeac68</span> <span class=\"token operator\">&lt;</span>col<span class=\"token operator\">:</span><span class=\"token number\">17</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'int'</span> lvalue ParmVar <span class=\"token number\">0x5aeaa90</span> <span class=\"token string\">'x'</span> <span class=\"token string\">'int'</span>\n    <span class=\"token operator\">|</span>       `<span class=\"token operator\">-</span>IntegerLiteral <span class=\"token number\">0x5aeac90</span> <span class=\"token operator\">&lt;</span>col<span class=\"token operator\">:</span><span class=\"token number\">21</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'int'</span> <span class=\"token number\">42</span>\n    `<span class=\"token operator\">-</span>ReturnStmt <span class=\"token number\">0x5aead68</span> <span class=\"token operator\">&lt;</span>line<span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> col<span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token operator\">&gt;</span>\n      `<span class=\"token operator\">-</span>ImplicitCastExpr <span class=\"token number\">0x5aead50</span> <span class=\"token operator\">&lt;</span>col<span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'int'</span> <span class=\"token operator\">&lt;</span>LValueToRValue<span class=\"token operator\">&gt;</span>\n        `<span class=\"token operator\">-</span>DeclRefExpr <span class=\"token number\">0x5aead28</span> <span class=\"token operator\">&lt;</span>col<span class=\"token operator\">:</span><span class=\"token number\">10</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'int'</span> lvalue Var <span class=\"token number\">0x5aeac10</span> <span class=\"token string\">'result'</span> <span class=\"token string\">'int'</span></code></pre> \n</div> \n<p>The AST shows what type of nodes are generated when compiling the function above. With <code class=\"language-text\">MatchFinder</code>, you can attach instances of <code class=\"language-text\">AstMatcher</code> to selectively match nodes of this AST. Some of the matchers we can use are <code class=\"language-text\">callExpr</code>, <code class=\"language-text\">declStmt</code>, <code class=\"language-text\">functionDecl</code>, and <code class=\"language-text\">CompoundStmt</code>. For more matchers, have a look at the <a href=\"https://clang.llvm.org/docs/LibASTMatchersReference.html\">reference site</a>.</p> \n<h3>Refactoring with ASTMatchers</h3> \n<p>As described in the section above, <code class=\"language-text\">ASTMatcher</code>s help us easily identify the presence of specific nodes in our source code. Once we’ve identified the nodes, we can also find out their specific locations. This allows us to analyze our spec source code and extract the sections we’re interested in. Once extracted, we can use the output to build a new source — in this case, our <code class=\"language-text\">XCTestCase</code> class. Let’s look at some of the <code class=\"language-text\">ASTMatcher</code>s I created for matching against parts of a Specta spec. The matcher used to match against the <code class=\"language-text\">it</code> functions looks as follows:</p> \n<div class=\"gatsby-highlight\" data-language=\"cpp\"> \n <pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">const</span> <span class=\"token keyword\">auto</span> ItExprMatcher <span class=\"token operator\">=</span> <span class=\"token function\">callExpr</span><span class=\"token punctuation\">(</span><span class=\"token function\">callee</span><span class=\"token punctuation\">(</span><span class=\"token function\">functionDecl</span><span class=\"token punctuation\">(</span><span class=\"token function\">hasName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"it\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                    <span class=\"token function\">hasArgument</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">hasDescendant</span><span class=\"token punctuation\">(</span><span class=\"token function\">stringLiteral</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testName\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                    <span class=\"token function\">hasArgument</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token function\">blockExpr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"block\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"itExpr\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre> \n</div> \n<p>We can see how the DSL allows us to express in a very natural way that we want to find a call expression, where the callee is a function with the name <code class=\"language-text\">it</code>. The function should have two arguments — the first one being of type string literal, and the second being a block expression. Also, notice the calls to the <code class=\"language-text\">bind</code> function; as we’ll see in a moment, calling this function allows us to refer to specific nodes via the names that are passed to it. Let’s look at a more complex example to better illustrate what <code class=\"language-text\">ASTMatcher</code>s can do:</p> \n<div class=\"gatsby-highlight\" data-language=\"cpp\"> \n <pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">const</span> <span class=\"token keyword\">auto</span> TopLevelBeforeExpr <span class=\"token operator\">=</span> <span class=\"token function\">callExpr</span><span class=\"token punctuation\">(</span>\n                                         <span class=\"token function\">callee</span><span class=\"token punctuation\">(</span><span class=\"token function\">functionDecl</span><span class=\"token punctuation\">(</span><span class=\"token function\">hasName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"before\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                         <span class=\"token function\">hasArgument</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">blockExpr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"beforeExpr\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                         <span class=\"token function\">unless</span><span class=\"token punctuation\">(</span><span class=\"token function\">hasAncestor</span><span class=\"token punctuation\">(</span><span class=\"token function\">callExpr</span><span class=\"token punctuation\">(</span><span class=\"token function\">callee</span><span class=\"token punctuation\">(</span><span class=\"token function\">functionDecl</span><span class=\"token punctuation\">(</span><span class=\"token function\">anyOf</span><span class=\"token punctuation\">(</span><span class=\"token function\">hasName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"describe\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  <span class=\"token function\">hasName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"context\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                                         <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"topLevelBeforeExpr\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre> \n</div> \n<p>As mentioned before, we need to distinguish between calls to <code class=\"language-text\">before</code> that are within a context and those that are top-level ones. This is necessary in order to produce setup methods that will set the initial state according to our tests. To identify top-level <code class=\"language-text\">before</code> calls, we can add a condition to our matcher where it’ll accept calls to functions with the name “before” that take a block expression as the first argument <em>as long as</em> they have an ancestor within a <code class=\"language-text\">context</code> or <code class=\"language-text\">describe</code> expression.</p> \n<h3>Handling Matches</h3> \n<p>Every time we register a matcher in our <code class=\"language-text\">MatchFinder</code>, we also need to pass an object that implements the <code class=\"language-text\">MatchCallback</code> abstract class. This class declares the following methods:</p> \n<div class=\"gatsby-highlight\" data-language=\"cpp\"> \n <pre class=\"language-cpp\"><code class=\"language-cpp\">  <span class=\"token keyword\">class</span> <span class=\"token class-name\">MatchCallback</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    <span class=\"token keyword\">virtual</span> <span class=\"token operator\">~</span><span class=\"token function\">MatchCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> MatchResult <span class=\"token operator\">&amp;</span>Result<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onStartOfTranslationUnit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">virtual</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onEndOfTranslationUnit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre> \n</div> \n<p>As their names suggest, the <code class=\"language-text\">StartOfTranslationUnit</code> and <code class=\"language-text\">onEndOfTranslationUnit</code> methods are called at the start and end of processing a translation unit (source file). More importantly, the <code class=\"language-text\">run</code> method is the one that will be called whenever a match is detected. In order to know what type we need to process, we can check every result for nodes we’re trying to match using the type of node and the string we passed to the <code class=\"language-text\">bind</code> function, like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"cpp\"> \n <pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> ASTHandler<span class=\"token operator\">::</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> MatchFinder<span class=\"token operator\">::</span>MatchResult <span class=\"token operator\">&amp;</span>Result<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Result<span class=\"token punctuation\">.</span>Nodes<span class=\"token punctuation\">.</span>getNodeAs<span class=\"token operator\">&lt;</span>clang<span class=\"token operator\">::</span>Expr<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"itExpr\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n         <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Here we’re checking if the result we got contains a node of type <code class=\"language-text\">Expr</code> that’s bound to the <code class=\"language-text\">itExpr</code> identifier. Once we have identified the type of result, we can get more details from it — for instance, when we match a call to the <code class=\"language-text\">it</code> function, we want to be able to extract the first parameter in order to use it to generate our <code class=\"language-text\">XCTestCase</code> method. We can extract this string as follows:</p> \n<div class=\"gatsby-highlight\" data-language=\"cpp\"> \n <pre class=\"language-cpp\"><code class=\"language-cpp\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Result<span class=\"token punctuation\">.</span>Nodes<span class=\"token punctuation\">.</span>getNodeAs<span class=\"token operator\">&lt;</span>clang<span class=\"token operator\">::</span>Expr<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"itExprWrapper\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token keyword\">auto</span> itText <span class=\"token operator\">=</span> Result<span class=\"token punctuation\">.</span>Nodes<span class=\"token punctuation\">.</span>getNodeAs<span class=\"token operator\">&lt;</span>clang<span class=\"token operator\">::</span>StringLiteral<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testName\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">str</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code></pre> \n</div> \n<h3>Unique Identifiers</h3> \n<p>In order to identify sibling nodes after extracting the code from the AST, I needed to mark nodes in a way that allowed me to identify the ones that shared the same parent. For this, I created a helper function that generates a unique ID based on the beginning and end location of a node:</p> \n<div class=\"gatsby-highlight\" data-language=\"cpp\"> \n <pre class=\"language-cpp\"><code class=\"language-cpp\">string Utils<span class=\"token operator\">::</span><span class=\"token function\">getIdForNode</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> std<span class=\"token operator\">::</span>string key<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> MatchFinder<span class=\"token operator\">::</span>MatchResult Result<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> clang<span class=\"token operator\">::</span>Stmt <span class=\"token operator\">*</span>node <span class=\"token operator\">=</span> Result<span class=\"token punctuation\">.</span>Nodes<span class=\"token punctuation\">.</span>getNodeAs<span class=\"token operator\">&lt;</span>clang<span class=\"token operator\">::</span>Stmt<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token keyword\">auto</span> beginLoc <span class=\"token operator\">=</span> node<span class=\"token operator\">-&gt;</span><span class=\"token function\">getBeginLoc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token keyword\">auto</span> endLoc <span class=\"token operator\">=</span> node<span class=\"token operator\">-&gt;</span><span class=\"token function\">getEndLoc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>std<span class=\"token operator\">::</span><span class=\"token function\">to_string</span><span class=\"token punctuation\">(</span>Result<span class=\"token punctuation\">.</span>SourceManager<span class=\"token operator\">-&gt;</span><span class=\"token function\">getFileOffset</span><span class=\"token punctuation\">(</span>beginLoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> std<span class=\"token operator\">::</span><span class=\"token function\">to_string</span><span class=\"token punctuation\">(</span>Result<span class=\"token punctuation\">.</span>SourceManager<span class=\"token operator\">-&gt;</span><span class=\"token function\">getFileOffset</span><span class=\"token punctuation\">(</span>endLoc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<h3>Matching Preprocessors</h3> \n<p>In addition to matching nodes in the AST, I also needed to handle preprocessors in order to find inclusion directives that needed to be copied over to the <code class=\"language-text\">XCTest</code> output file. LibTooling provides the <code class=\"language-text\">PreprocessOnlyAction</code> class, which allows us to attach preprocess actions capable of matching against preprocessors like inclusion and pragma directives, among others.</p> \n<h3>Collecting Results</h3> \n<p>To make things simpler for me given my limited C++ experience, I decided to parse the match results into JSON and do the rest of the work to generate the <code class=\"language-text\">XCTest</code> source using a different set of tools. The example below shows the resulting JSON for the previously presented <code class=\"language-text\">User</code> sample spec:</p> \n<details open=\"\"> \n <summary>Sample json result</summary> \n <div class=\"gatsby-highlight\" data-language=\"json\"> \n  <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"afters\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\\n  subject = nil;\\n\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"314:341\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"befores\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\\n  subject = [[User alloc] init];\\n\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"266:310\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\\n      subject.hasConfirmedEmail = NO;\\n    \"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"424:477\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"parentId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"389:579\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\\n      subject.hasConfirmedEmail = YES;\\n    \"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"629:683\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"parentId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"585:787\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"contexts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"389:579\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"isSharedExample\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"email confirmed\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"parentId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"345:794\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"585:787\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"isSharedExample\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"email not confirmed\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"parentId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"345:794\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"345:794\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"isSharedExample\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"-canSubscribeToNewsletter\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"includes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"its\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\\n      NSAssertTrue([subject canSubscribeToNewsletter]);\\n    \"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"489:568\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"is true\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"parentId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"389:579\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\\n      NSAssertFalse([subject canSubscribeToNewsletter]);\\n    \"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"695:776\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"is false\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"parentId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"585:787\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"spec-name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UserSpec\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"vars\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"body\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"__block User *subject\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0:263\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre> \n </div> \n</details> \n<h2>Interpreting JSON Results</h2> \n<p>To correctly generate an <code class=\"language-text\">XCTest</code> test from a spec, we needed to perform multiple tasks on matched nodes in order to get valid Objective-C code that Xcode would be able to execute. For the sake of convenience, I decided to do the rest of the work in Ruby, given the vast number of gems — like <a href=\"https://github.com/erikhuda/thor\">Thor</a> and <a href=\"https://rubygems.org/gems/activesupport/versions/5.0.0.1\">activesupport</a> — available to create command-line tools and easily manipulate strings.</p> \n<h2>Generating an XCTestCase Class</h2> \n<p>It’d make for an excessively long post to go over all the tasks involved in the transformation process whose main purpose is to replicate the flow of control of a spec. So instead, here’s a list of the most relevant ones I had to perform on the resulting JSON file to generate the <code class=\"language-text\">XCTestCase</code> class:</p> \n<ul> \n <li>Generate the <code class=\"language-text\">XCTestCase</code> skeleton class.</li> \n <li>Copy over the inclusion directives.</li> \n <li>Copy the variable declarations and handle potential duplicates coming from different contexts of the same spec.</li> \n <li>Generate a main setup method that overrides <code class=\"language-text\">XCTestCase</code>’s <code class=\"language-text\">setUp</code> method and other setup methods specific to every test from the elements inside <code class=\"language-text\">befores</code> in the JSON file.</li> \n <li>Generate a teardown method from the spec’s <code class=\"language-text\">after</code> calls.</li> \n <li>Generate test methods with names computed according to the context they’re in and insert calls to the corresponding setup methods to configure the state before running the validations.</li> \n <li>Format the output using <code class=\"language-text\">clang-format</code>.</li> \n</ul> \n<p>To take care of these requirements, I created multiple parsers for processing the JSON and outputting different parts of the <code class=\"language-text\">XCTest</code> test. The resulting tool is a Ruby gem that:</p> \n<ul> \n <li>Executes the parser based on LibTooling that generates the JSON file.</li> \n <li>Calls all different parsers to generate the <code class=\"language-text\">XCTestCase</code> class and merges their results together.</li> \n <li>Formats the resulting <code class=\"language-text\">XCTestCase</code> class using <code class=\"language-text\">clang-format</code>.</li> \n</ul> \n<h3>Results</h3> \n<p>Once the tool was created, transforming a spec into <code class=\"language-text\">XCTest</code> went from taking hours to taking only a couple of minutes. This allowed us to transform our 900+ specs with confidence and ease. The last spec was recently transformed and we were consequently able to remove Specta from our codebase and free ourselves from this third-party coupling, making the project a total success! 🎉</p> \n<p>But as is the case with everything, it wasn’t all perfect. So here are some points to keep in mind if you are considering building a refactoring tool with LibTooling:</p> \n<ul> \n <li>Poor documentation — The documentation on how to create these tools is limited, and on top of that, the documentation available is often outdated since the C++ API offers no API stability guarantees.</li> \n <li>Edge cases — Even after having created the <code class=\"language-text\">ASTMatcher</code>s to match the specs, we had to go back to and expand them to support edge cases we hadn’t detected before. This is natural when refactoring so many different sources — especially when they’re written in a language that allows for equivalent expressions to be written in several different ways.</li> \n <li>Missing matchers — Despite the large number of matchers <a href=\"https://clang.llvm.org/docs/LibASTMatchersReference.html\">available</a>, sometimes you might want to match something a matcher is not available for, forcing you to write your own custom matcher.</li> \n <li>Working on C++ — It depends on your level of writing and reading C++, but if, like me, you’re used to working with more high-level languages, using C++ to write a refactoring tool might feel like adding complexity to a task that can, by itself, be quite daunting.</li> \n</ul> \n<h2>Conclusion</h2> \n<p>Creating your own refactoring tools requires an upfront work investment, and whether or not this investment is justified depends on each case. For the right situations, building a refactoring tool that is tailored to your problem can prove to be a high-return investment. For us, we went from needing hours of tedious work to transform a spec to being able to just run a command and get the output instantly! This type of automation results in freed-up resources for other tasks like building new features, which is a huge benefit for companies dealing with large amounts of legacy code.</p> \n<h3>Further Reading</h3> \n<ul> \n <li><a href=\"https://clang.llvm.org/docs/LibASTMatchersTutorial.html\">Tutorial for building tools using LibTooling and LibASTMatchers</a></li> \n <li><a href=\"https://clang.llvm.org/docs/LibASTMatchers.html\">Matching the Clang AST</a></li> \n <li><a href=\"https://eli.thegreenplace.net/2014/05/01/modern-source-to-source-transformation-with-clang-and-libtooling\">Modern source-to-source transformation with Clang and libTooling</a></li> \n</ul>","descriptionType":"html","publishedDate":"Fri, 10 Jul 2020 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/27134d3f37ae0be10d5b2522f4f96095/8ff1e/specta-vs-xctest.png","linkMd5":"393197fc917d015bdfd2ffa5e014d1f4","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn38@2020_5/2020/08/25/00-49-38-341_3f5fe2b0ecf9dce6.webp","destWidth":800,"destHeight":493,"sourceBytes":41988,"destBytes":31890,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/27134d3f37ae0be10d5b2522f4f96095/8ff1e/specta-vs-xctest.png":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn38@2020_5/2020/08/25/00-49-38-341_3f5fe2b0ecf9dce6.webp","https://developers.soundcloud.com/blog/static/01b8f840504e9c517d2ac908a65d39c6/8ff1e/specta-vs-xctest-method-names.png":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn81@2020_5/2020/08/25/00-51-45-664_bfda1be8f948fa16.webp"},"publishedOrCreatedDate":1598316569971},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Welcome to SoundCloud's redesigned developer site","link":"https://developers.soundcloud.com/blog/new-developer-site","description":"<p>We’ve taken some time to bring all our developer resources together into a single site. In doing so, we’ve reorganized the layout to make things easier to find and also given the site a fresh new look.</p> \n<p>We hope you like it!</p> \n<p>If you have any feedback about the new design, <a href=\"https://twitter.com/SoundCloudDev\">follow @SoundCloudDev on Twitter</a> and let us know.</p>","descriptionType":"html","publishedDate":"Fri, 11 Apr 2014 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"6d360812bdd3780134484d255db993b4","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Using Kubernetes Pod Metadata to Improve Zipkin Traces","link":"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 791px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/acad98c939f74b77be82c164bfe3ab9d/bf224/1-dependency-graph.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.776232616940575%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABFElEQVQoz1WSCW7FIAxEuf9Js5csELK6PLfz1UayggE/jycJVp/zPG0cR4++761pGluWxWPbNiul2HEcfu+6Lg9yIudsz/PYfd+gLJAA2PfdL6R6oW1bG4bBYoy2rqtfVhEBkCYEa86o5SzQAaCUsInS+BU9B/r3ed/X39yjVnnaUmWkH4WooBAoY/ZdZ10NcprllP8pJACllHyfR6MHEpTMFUgX4EBQiQ14ChiIPNTYQNgDBJwmQWNM0/TpCEz+sAZIIc2YgGnKXnyfNXXscz/IAw4pAIQq1hjN6Lz1IWQPucN/vf58ZQHneXY1UgUEtQCllgBIQ+zgT9Co8jboP6SbDhkff8gpllc00QSoXKoI1cjbb9znuzpaVoVYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"SoundCloud microservice dependency graph zoomed out\" title=\"SoundCloud microservice dependency graph zoomed out\" src=\"https://developers.soundcloud.com/blog/static/acad98c939f74b77be82c164bfe3ab9d/bf224/1-dependency-graph.png\" srcset=\"/blog/static/acad98c939f74b77be82c164bfe3ab9d/9ec3c/1-dependency-graph.png 200w,\n/blog/static/acad98c939f74b77be82c164bfe3ab9d/c7805/1-dependency-graph.png 400w,\n/blog/static/acad98c939f74b77be82c164bfe3ab9d/bf224/1-dependency-graph.png 791w\" sizes=\"(max-width: 791px) 100vw, 791px\" loading=\"lazy\" /> </a> </span></p> \n<p>SoundCloud is built on hundreds of <a href=\"https://developers.soundcloud.com/blog/category/microservices\">microservices</a>. This creates many challenges, among them debugging latency issues across the services engaged in the completion of a single request. As such, it’s natural that we were early adopters of <a href=\"https://zipkin.io/\">Zipkin</a>, a distributed tracing tool that emerged from Twitter, which was built in part to help engineers tackle these sorts of problems.</p> \n<p><a href=\"https://www.slideshare.net/grobie/moving-to-kubernetes-tales-from-soundcloud\">In recent years</a>, we’ve switched to using <a href=\"https://kubernetes.io/\">Kubernetes</a> as our container deployment platform. Kubernetes makes it easy to break a microservice down into narrowly focused operational responsibilities, which often correspond to different workloads the service must handle and are typically expressed in Kubernetes as distinct <a href=\"https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/#pod-templates\">pod templates</a>.</p> \n<p>Because each <a href=\"https://kubernetes.io/docs/concepts/workloads/pods/pod/\">Kubernetes pod</a> is assigned its own IP address, and because each pod has a well-defined responsibility, it’s possible to make higher-level assumptions about an IP address given the easy access to data that Kubernetes accumulates across deploys. This is in contrast to the pre-Kubernetes era at SoundCloud, when an IP address referring to a “bare-metal” machine would likely have hosted several very different services.</p> \n<p>The BEEP team<sup><a href=\"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces#f1\">1</a></sup> here at SoundCloud recently revisited our Zipkin setup, primarily to make two improvements: to <strong>increase the quality and accuracy of service names in Zipkin</strong>, and to <strong>enhance Zipkin span data</strong>.</p> \n<p>Updating Zipkin service names across our hundreds of services in concert with a constantly evolving backend architecture has been a particular challenge. This is because Zipkin uses service names to represent how one service relates to another, and without <strong>good, consistent service names</strong>, the value of Zipkin as a visualization or debugging tool is greatly reduced.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/3fb52692a62f8b4268450e8a9320ca5f/6e3c3/2-zipkin-trace-overview.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 33.17422434367542%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABJklEQVQoz21RW07DMBDMneB6nKScgX++kCohwU+lilcolaqUtiGUNGndJI5je5jYDiqIsUb78o686wiEtbY3MLTaWBc7nh5/Bbak/+RzLnYMRSIaxAb7C3vyi8x7yzYSW/ofPme31uVdPaNtgqAJYtPlJ65nKTqGRmsUmcBBNFAKqGuFfSGgtEELAyk18vIA2bBoKK7YJHtB+DF7XL1tcD4aYzRJXCyaBvNVhsdFivfdEbu6RUnhVhl0nYGaGuhhwjC2e6EOwf1DgbPLMS5uYoi2+9nMLEnxuso5kUGz5O07324XtCbI+WUicmFFb86VxR1u1znyqsWRgrLTTrCSCrmQXp37sxOu6ZkPSSz+/kFk13Ri6xf8D04/a/h5hyX5Qqowbkh/A+kXH3sP5F18AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Overview of a Zipkin trace\" title=\"Overview of a Zipkin trace\" src=\"https://developers.soundcloud.com/blog/static/3fb52692a62f8b4268450e8a9320ca5f/8ff1e/2-zipkin-trace-overview.png\" srcset=\"/blog/static/3fb52692a62f8b4268450e8a9320ca5f/9ec3c/2-zipkin-trace-overview.png 200w,\n/blog/static/3fb52692a62f8b4268450e8a9320ca5f/c7805/2-zipkin-trace-overview.png 400w,\n/blog/static/3fb52692a62f8b4268450e8a9320ca5f/8ff1e/2-zipkin-trace-overview.png 800w,\n/blog/static/3fb52692a62f8b4268450e8a9320ca5f/6e3c3/2-zipkin-trace-overview.png 838w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p><em> \n  <div style=\"text-align: center;\">\n    As microservices combine to process a single overall request, they may (on a sampling basis) also report trace data to Zipkin. A trace identifier is established for an overall request and propagated as one microservice calls out to others. The caller microservice sends the remote service name, endpoint name, call timing, and trace ID to Zipkin, which Zipkin turns into a span. Spans with the same trace ID are woven together to form a Zipkin trace. See also \n   <a href=\"https://zipkin.io/pages/instrumenting.html\">Zipkin: Instrumenting a library</a>. \n  </div></em></p> \n<h2>Defining Zipkin Service Names in One Central Place</h2> \n<p>In a service-to-service interaction, the caller service reports the IP address of the callee service’s pod as part of the <a href=\"https://zipkin.io/pages/instrumenting.html\">span</a> data it sends to Zipkin. After brainstorming, we realized we could customize the Zipkin <a href=\"https://zipkin.io/pages/architecture.html\">collector</a> to transform the span on the fly, performing a quick reverse IP lookup of the Kubernetes pod metadata and <strong>replacing the caller’s version of the Zipkin service name with one assembled from the callee’s <a href=\"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/\">pod labeling</a></strong>:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/6e3c3/3-zipkin-span-transformation.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75.65632458233891%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACYUlEQVQ4y42U6XKiUBCFff+3mZr5MUvpJE5Ks4yJJkENihAXQIlRWS/rNxcTjaZma+pCA5fTfbpPU0GauXRp9Qxu+gat7ojBxGG9XqPrOkNNI/A9eqMZl4M5X5v3fDxpUe/o3D0+E4mkhKAoiu21Il0WK5+OOqanm7QUDXVsE8cJvufhuh5RGKJPFzTvDU6uuny/VKhfP9AdL4mT9Bhw55SWJTGB57JZrQiDkH/a67cHEG+Atm3T7nToyHX58wp9bBDIzPI830b/7dqDFXvQPeBAVamfnqLcdxGOgA3EIiZN3yj9be32VHbO6vkZyzJZWHNiJyJ1EhIJ+JLH/7B/V8MsL4iSnPHMRptMiCTVMIqwTAtDMZipU8a6fC4EQRSz8UM2QYQfCvLDDHc3bhBz1hlSvVD4XG9x1taY2g7OfMFclas/x7EcdMPg4nZA7VyhKiV0fqeRZvkx5SzLSJJkK5VE1my1WrNx3T/SE17M0/0S/zEgCgSvbXmh7MkPRyMdRVFo37TRhhrmzJRi9kmlxsrGiEhs/X15ZAI9ub+n9lg7awqjIDMysjCjMlAHNBpNHvp9TNsiiMNttPzgSIsUIcRR8TvtNtVvJ6jXQ+JuDLoM5EjAEqhWrdG8aDDtz1hcO+RTqT0TUhk1n+TbjSIWe8pltqZlEZoRhV8cU/YltTCM8OS8JqGMJGXnPW3wn2QNhaTiS9qyYSXNfQ2FeC8aJJGXppSnchpK2/gB9sqVPwKDB32M4wZ4kTjS2qGIi/xwaopjYZf2aC359KPNl8YtX6UsPtSuGM2c7bv8YGDfAx/aL5iNfHbf6q1SAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Adding information to a Zipkin span at the point of collection\" title=\"Adding information to a Zipkin span at the point of collection\" src=\"https://developers.soundcloud.com/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/8ff1e/3-zipkin-span-transformation.png\" srcset=\"/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/9ec3c/3-zipkin-span-transformation.png 200w,\n/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/c7805/3-zipkin-span-transformation.png 400w,\n/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/8ff1e/3-zipkin-span-transformation.png 800w,\n/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/6e3c3/3-zipkin-span-transformation.png 838w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p><em> \n  <div style=\"text-align: center;\">\n    Assembling a Zipkin service name based on Kubernetes pod metadata. \n  </div></em></p> \n<p>The result was an across-the-board improvement in both Zipkin service names and dependency graph quality.</p> \n<p>As a side effect of this approach, control over how a node is represented in Zipkin switched from the caller services to the callee service:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/b6d66454c23a905f52ebc848fcfefd0f/6e3c3/4-divergent-service-names.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 31.861575178997615%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAA6klEQVQY04WRyW7CQBBE/f+/lBMSUhZFIcDB2IkwXhLG+w7xeHkZJ/HBRIKSWtWXej2l0VAahoFbahqJEIKtcWC5MnjYvHH6kkz5iaFNS98PfEQFO1tgOr5yHxGX1HVFGIbEcUxVlfhxjr73OHxGNLK9AlRuHROeNiYrfc+rYeP6KWVRIP+CtzSytMsLbdcTJDkiSkmLiq7rZiEpJZZl4XkejjuOi207ZFk2f+Hkx7hguX5n8WKq6gFZmhAEoape/wLbjiTLqU5ntbc/B8fp+34OvPY5rQrmeY7rOjyud9zdb1k861Tn5l/lb70czvKyUXTuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Service names in Zipkin that are unfortunately divergent\" title=\"Service names in Zipkin that are unfortunately divergent\" src=\"https://developers.soundcloud.com/blog/static/b6d66454c23a905f52ebc848fcfefd0f/8ff1e/4-divergent-service-names.png\" srcset=\"/blog/static/b6d66454c23a905f52ebc848fcfefd0f/9ec3c/4-divergent-service-names.png 200w,\n/blog/static/b6d66454c23a905f52ebc848fcfefd0f/c7805/4-divergent-service-names.png 400w,\n/blog/static/b6d66454c23a905f52ebc848fcfefd0f/8ff1e/4-divergent-service-names.png 800w,\n/blog/static/b6d66454c23a905f52ebc848fcfefd0f/6e3c3/4-divergent-service-names.png 838w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p><em> \n  <div style=\"text-align: center;\">\n    When callers control naming, the same callee may end up represented as several different services. \n  </div></em></p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/ef773003a9241036a26a9c57fb301aff/6e3c3/5-improved-service-names.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 18.37708830548926%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAxElEQVQY042Q0W6CUAxA+f9PcntwmOHmdAFkCtvVCOqFO5HAnSh7OuvuF9jk5DRN2rT1Jos1vjCeJfjzFZNFytPbCv89JYi+0JXh2vfcG9728E1RncnLmp0+Oee6drV91XC9DXRti9aaoshRe8NycyQRPrbasVQH4Sg9Dd7/VNNYdN1S1p0gPrXO5twxDL9Ya91ApRRxtmMapswSxUuU8Rp/OoIwYyPLeba/MZ6vGQUhD0HEo3j0LPk0dq/QpeFy+bn75D+4lif3bJzkdQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Service names in Zipkin improved using Kubernetes data\" title=\"Service names in Zipkin improved using Kubernetes data\" src=\"https://developers.soundcloud.com/blog/static/ef773003a9241036a26a9c57fb301aff/8ff1e/5-improved-service-names.png\" srcset=\"/blog/static/ef773003a9241036a26a9c57fb301aff/9ec3c/5-improved-service-names.png 200w,\n/blog/static/ef773003a9241036a26a9c57fb301aff/c7805/5-improved-service-names.png 400w,\n/blog/static/ef773003a9241036a26a9c57fb301aff/8ff1e/5-improved-service-names.png 800w,\n/blog/static/ef773003a9241036a26a9c57fb301aff/6e3c3/5-improved-service-names.png 838w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p><em> \n  <div style=\"text-align: center;\">\n    An alternative: all names come from reverse IP lookup against a centralized index. \n  </div></em></p> \n<p>The team that owns the locale-info service makes the decision, for all teams, how that service is named, thus removing the need for multiple teams to coordinate on establishing or changing the service name. And the original Zipkin service name given by the caller is not lost — we add it as a <a href=\"https://zipkin.io/pages/instrumenting.html\">span annotation</a>.</p> \n<h2>Useful Span Annotations from Pod Metadata</h2> \n<p>Zipkin span collection generates significant reverse-lookup load, but our integration hits a simple, very fast Kubernetes metadata caching service written by the SoundCloud Production Engineering team. Responses from this service contain a <strong>rich set of pod metadata</strong> that goes beyond what’s merely necessary to assemble a good Zipkin service name, and we add all of this data as <strong>extra annotations on the Zipkin span</strong>.</p> \n<p>The result is that when looking into a latency problem, we can not only see basic Zipkin information about how long a service took to respond, but we also know details like the Git revision of the service code that was running on the particular pod, because we consistently set that as a Kubernetes label on all pods. This is a level up in an engineer’s ability to efficiently pinpoint production problems.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 593px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0f57e386c97d73671a034e0ab0f2b9ad/fe994/6-zipkin-span-annotations-k8s-enhanced.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 76.55986509274874%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAB1ElEQVQ4y3WU15LqQAxE9/8/jyfwXZxwzoGctDqiTPmuWaqE7ZFG6ulu+0v093g8JIoi8f1APM+T7fdW2raVcRwlyzKJo1jCMLR1x/lnteT6vrcYhkGezyet5Is/HsqilDRJpet6ORwOcrlcdNBd6rqWsqzkfD7Lfr+3OJ1Ocrvd5Hq9vuO/hiCkGZMpPh6PtpFrrgjLspTT+bVOMJD8/LpomCSJxHEsRVFYUxAReZ4bau5pRu5TLBqCznM92Ww2sttF72OnaWoIb/e7Nf3UjPVFQ9AlcSJt0yjaVMkeDFGWZoYeLruuWxz7zyMjCkhMjOfDiIb4Xo9b5IWp3TatormYwjT9U5S7HicMQnE2jqxWK9vMJqaD3HEcCYKXpYIA+3yrjXaWxzLULhBCPpt3WlipTRjCeqMUxMpvluUyDqNMNiPHCagjFghp5LquNHVjE+GL6YgSqOFBTXOMTI6Y7rkuEEJ6qgLUVWWTWaOIYoZB/DSc3O9YIIQfd+vKer02cUBHYCe4JQfaCf302n189YxD5Yh3Fq4mhSkCOXbiec7Z71ggRBACtXudyBHHcTAP+r7/VnNCNI+Fyq+PQ2EbURtjN/q1YVClnCIKXpy8h1fnMffhD2i1f+WXfzDhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Additional span annotations using Kubernetes pod metadata\" title=\"Additional span annotations using Kubernetes pod metadata\" src=\"https://developers.soundcloud.com/blog/static/0f57e386c97d73671a034e0ab0f2b9ad/fe994/6-zipkin-span-annotations-k8s-enhanced.png\" srcset=\"/blog/static/0f57e386c97d73671a034e0ab0f2b9ad/9ec3c/6-zipkin-span-annotations-k8s-enhanced.png 200w,\n/blog/static/0f57e386c97d73671a034e0ab0f2b9ad/c7805/6-zipkin-span-annotations-k8s-enhanced.png 400w,\n/blog/static/0f57e386c97d73671a034e0ab0f2b9ad/fe994/6-zipkin-span-annotations-k8s-enhanced.png 593w\" sizes=\"(max-width: 593px) 100vw, 593px\" loading=\"lazy\" /> </a> </span></p> \n<p><em> \n  <div style=\"text-align: center;\">\n    An example Zipkin span with Kubernetes-derived annotations. \n  </div></em></p> \n<p>Our approach involves inserting a small amount of logic into the Zipkin collector and then leveraging our internal Kubernetes pod labeling scheme to improve span data. The result is normalized and modernized service names, along with greatly enhanced details embedded in Zipkin traces that engineers can use to troubleshoot production issues.</p> \n<p><strong>Value-added span transformation</strong> ideas are getting more attention in the Zipkin community. The <a href=\"https://github.com/openzipkin\">OpenZipkin team</a> has a <a href=\"https://github.com/openzipkin/zipkin/pull/2072\">collector extension framework in the works</a>, and we’re excited to see what other Zipkin “mashups” come out of the Zipkin community. If you’re interested, please join the <a href=\"https://gitter.im/openzipkin/zipkin\">OpenZipkin gitter discussion</a>.</p> \n<h1>Thank You</h1> \n<ul> \n <li>Benjamin Debeerst, SoundCloud Backend Engineering Productivity Team</li> \n <li>Kristof Adriaenssens, Engineering Manager, SoundCloud Content Team</li> \n <li>René Treffer, SoundCloud Production Engineering Team</li> \n <li>Tobias Schmidt, SoundCloud Production Engineering Team</li> \n <li>Adrian Cole, Pivotal Spring Cloud Team and prominent Zipkin contributor</li> \n</ul> \n<h1>Additional Reading</h1> \n<ul> \n <li><a href=\"https://github.com/honeycombio/examples/tree/master/kubernetes-envoy-tracing\">Kubernetes Envoy Tracing</a></li> \n <li><a href=\"https://kubernetes.io/blog/2017/05/managing-microservices-with-istio-service-mesh/\">Istio service mesh + Zipkin integration</a></li> \n <li><a href=\"https://linkerd.io/1/features/distributed-tracing-and-instrumentation/\">Linkerd Zipkin integration</a></li> \n</ul> \n<p><a name=\"f1\">1</a>: The <strong>Backend Engineering Productivity team</strong>’s mission is to help solve common, cross-cutting engineering problems that our product-focused engineers face. We also build and maintain many of SoundCloud’s “core” services.</p>","descriptionType":"html","publishedDate":"Wed, 19 Sep 2018 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/acad98c939f74b77be82c164bfe3ab9d/bf224/1-dependency-graph.png","linkMd5":"f81a65c15e531e43f8a25732890970aa","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn69@2020_1/2020/08/25/00-49-38-779_0e4f40c78768cf74.webp","destWidth":791,"destHeight":370,"sourceBytes":42534,"destBytes":35432,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/acad98c939f74b77be82c164bfe3ab9d/bf224/1-dependency-graph.png":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn69@2020_1/2020/08/25/00-49-38-779_0e4f40c78768cf74.webp","https://developers.soundcloud.com/blog/static/3fb52692a62f8b4268450e8a9320ca5f/8ff1e/2-zipkin-trace-overview.png":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn5@2020_6/2020/08/25/00-51-41-991_c794357f2a3ae54d.webp","https://developers.soundcloud.com/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/8ff1e/3-zipkin-span-transformation.png":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn47@2020_3/2020/08/25/00-51-44-161_b35ede955a3698db.webp","https://developers.soundcloud.com/blog/static/b6d66454c23a905f52ebc848fcfefd0f/8ff1e/4-divergent-service-names.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn56@2020_5/2020/08/25/00-51-40-787_cee225c2501639c0.webp","https://developers.soundcloud.com/blog/static/ef773003a9241036a26a9c57fb301aff/8ff1e/5-improved-service-names.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn44@2020_2/2020/08/25/00-51-41-995_38d560ad8988e9be.webp","https://developers.soundcloud.com/blog/static/0f57e386c97d73671a034e0ab0f2b9ad/fe994/6-zipkin-span-annotations-k8s-enhanced.png":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn43@2020_5/2020/08/25/00-51-44-116_3cb2933fa6aaaf1d.webp"},"publishedOrCreatedDate":1598316569974},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Doing the right thing","link":"https://developers.soundcloud.com/blog/doing-the-right-thing","description":"<p>The recent <a href=\"https://status.soundcloud.com/post/9332254589/outage-update-august-23rd\">outage of SoundCloud</a> was the result of everybody doing the right thing. This totally jives with <a href=\"http://www.slideshare.net/jallspaw/advanced-postmortem-fu-and-human-error-101-velocity-2011\">John Allspaw’s message</a> that looking for a root cause will lead to you finding smart people simply doing their jobs.</p> \n<p>This is what happened.</p> \n<h3>The technologies at play</h3> \n<p>The number of interactions that escalated to the outage should be interesting for other Rails/MySQL shops out there. We’re using many idiomatic patterns within Rails that ended up having devastating consequences.</p> \n<h3>Cache keys that avoid invalidation</h3> \n<p>It’s best practice to form your cache keys in a way that doesn’t require you to issue cache key deletions, and rather let normal evictions reclaim garbage keys. To do this we use the ‘updated_at’ column on some of our models in the cache key so that if the model updates, we know we’ll get a new key.</p> \n<h3>ActiveRecord::Timestamp#touch</h3> \n<p>There is an innocuous method called ‘touch’ that will simply bump the updated_at and save that record. This is quite convenient to call on containers of has_many things like a forum topic is to its posts. With a recent ‘updated_at’ and consistent way to keep that recent via ‘touch’, there is a clean decoupling of cache strategy from business modeling when you intend to communicate the container’s version is as recent as the most recent addition.</p> \n<h3>ActiveRecord::Associations::BelongsToAssociation :counter_cache</h3> \n<p>In the absence of indexed expressions and multi index merges that some databases have, MySQL and InnoDB leaves it to the application to keep lookups of counts efficient. When dealing with tables of multiple millions of rows, a simple query like:</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> things</code></pre>\n</div> \n<p>Could take tens of seconds as InnoDB actually needs to traverse all primary keys and literally count the rows that exist which are visible in the current transaction.</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\">\n <pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Foo</span> belongs_to <span class=\"token symbol\">:things</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:counter_cache</span> <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token keyword\">true</span> <span class=\"token keyword\">end</span></code></pre>\n</div> \n<p>Is a simple and convenient workaround to avoid the ‘count(*)’ overhead where when a new Foo is created on a thing, that thing’s ‘foos_count’ would get a database increment by one. When it’s removed, the ‘foos_count’ would be decremented by one.</p> \n<h3>ActiveRecord::Associations::Association :dependent =&gt; :destroy</h3> \n<p>What better way to maintain all the business rules on deletion than to make sure your model’s callbacks fire when a container is destroyed. When your business consistency is maintained in the ORM, this is also the best place to ensure proper business rules on removal.</p> \n<p>This simply does the following for every association:</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\">\n <pre class=\"language-ruby\"><code class=\"language-ruby\">thing<span class=\"token punctuation\">.</span>foos<span class=\"token punctuation\">.</span><span class=\"token keyword\">each</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token symbol\">:destroy</span><span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>Before:</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\">\n <pre class=\"language-ruby\"><code class=\"language-ruby\">thing<span class=\"token punctuation\">.</span>destroy</code></pre>\n</div> \n<p>It’s best to have the behavior declared where the association is declared and let the framework make sure it’s not forgotten when actually performing the destruction.</p> \n<h3>More than 140 characters</h3> \n<p>Some of the features of SoundCloud deserve more than 140 characters to do them justice. Even more than 255 characters. The tools that Rails gives you out of the box when you need more than 255 characters on a string in your data layer are limited; you’re left with the ‘text’ type in your schema definition. In MySQL this translates to a “TEXT” column.</p> \n<p><code class=\"language-text\">A TEXT column with a maximum length of 65,535 (216 - 1) characters.</code></p> \n<p>Well, in most cases we wouldn’t need more than 1000 characters for much on our site, but in the spirit of “deployed or it didn’t happen”, our early database schemas were mostly driven by the simplest option that ActiveRecord::Schema offered. (We also have way too many NULLable columns)</p> \n<h3>Trade space for time or time for space</h3> \n<p>The early days, SoundCloud ran on 3 servers. CPU was precious so for some of the HTML conversion tasks we traded space for time and are storing a cached version of the HTML for some of the longer text fields in the same row as the record. This was the right choice at the time for the request load and available CPU.</p> \n<p>(time is usually easier to scale than space)</p> \n<h3>Tune your DBs for your workload</h3> \n<p>We separate reads from writes on our data layer, and we also have slightly different tunings on the DB slaves that accept reads. We also have experienced statement-based asynchronous slave replication breaking the replication thread due to these different tunings on different hardware.</p> \n<p>We use row-based (actually mixed) replication between our masters and slaves because it’s as close as you’ll get to the storage engines speaking directly to each other, minimizing the risk of differences in hardware/tuning interfering with the replication thread.</p> \n<h3>Alert on disk space thresholds</h3> \n<p>We have a massive amount of Nagios checks on all our systems, including host-based partition %free checks. When any partition on a host reaches a threshold of free space, an alert is sent.</p> \n<h3>Separate data and write ahead log physical devices</h3> \n<p>Most OLTP databases have data that is bound by random read/writes, whereas binary logs are fundamentally sequential writes. You want these workloads on different spindles when using rotating disks because a transaction cannot complete without first being written to the binary log. If you need to move the drive head for your binlog, you’ve just added milliseconds to all your transactions.</p> \n<h3>Clean up after yourself</h3> \n<p>Periodically there are administrative tasks that need to be performed on the site like mass takedowns of inappropriate content. The Rails console is amazing when you need to work directly with your business domain. Fire it up, get it done. For one-off maintenance tasks this is a life saver.</p> \n<h1>Add Spam, Mix, Bake and we’ve been Served</h1> \n<p>This all adds up, reviewing the good parts:</p> \n<ul> \n <li>Abstract away bookkeeping in your domain model</li> \n <li>Leverage existing patterns to get the job done quickly</li> \n <li>Tune and monitor your DBs</li> \n <li>Hand administer your site via your domain model</li> \n</ul> \n<p>If you haven’t noticed yet, there have been some incorrigible entrepreneurs using some groups to advertise their pharmaceuticals distribution businesses. They have very thorough descriptions (5-50KB worth), and unprecedented activity with tens to thousands of posts in their own groups.</p> \n<p>At 1:00pm yesterday, we were working through our cleanups, and cranked open a console with a large list of confirmed groups to remove. With Rails this is as simple as:</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\">\n <pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token constant\">Group</span><span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>ids<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">each</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token symbol\">:destroy</span><span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p>Looks innocent enough.</p> \n<h3>What the database sees</h3> \n<p>From the database perspective all of the automated bookkeeping and business domain extraction of individual destroys creates statements, this ended up looking something like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"sql\">\n <pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">DELETE</span> post\n<span class=\"token keyword\">UPDATE</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">SET</span> posts_count <span class=\"token operator\">=</span> posts_count <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">UPDATE</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">SET</span> updated_at <span class=\"token operator\">=</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> x <span class=\"token number\">1</span><span class=\"token operator\">-</span><span class=\"token number\">5000</span>\n<span class=\"token keyword\">DELETE</span> track_group_contribution\n<span class=\"token keyword\">UPDATE</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">SET</span> tracks_count <span class=\"token operator\">=</span> tracks_count <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">UPDATE</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">SET</span> updated_at <span class=\"token operator\">=</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> x <span class=\"token number\">1</span><span class=\"token operator\">-</span><span class=\"token number\">5000</span>\n<span class=\"token keyword\">DELETE</span> user_group_membership\n<span class=\"token keyword\">UPDATE</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">SET</span> members_count <span class=\"token operator\">=</span> members_count <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">UPDATE</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">SET</span> updated_at <span class=\"token operator\">=</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> x <span class=\"token number\">1</span><span class=\"token operator\">-</span><span class=\"token number\">5000</span></code></pre>\n</div> \n<p>So we’re seeing 2N+1 number of updates on a group where N is the sum of associated objects.</p> \n<h3>What replication sees</h3> \n<p>When using row-based replication, any change to a row gets that entire row added to the binary log. Some of these groups had over 100k worth of text columns and hundreds of associated posts. When parsing a given binlog, these group updates were taking over 90% of the replication events being sent to the slaves.</p> \n<h3>What the binlog partition sees</h3> \n<p>This is what finally brought us down. We were producing over 3GB/min of binlogs to be replicated to our slaves from these many group updates. Our binlog partition filled up from 10GB to 100GB in a matter of 30 minutes.</p> \n<p>The MySQL docs are clear about what happens with a full data partition. When data cannot be written, MySQL just waits. The behavior around the binlog partition wasn’t as clear. That last binlog event had a partial write. When the disk filled, the binlog corrupted. When that last event in the last binlog was attempted to be sent to the slaves, it failed and the slaves stopped replicating.</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">Got fatal error 1236 from master when reading data from binary log: 'log event entry exceeded max_allowed_packet; Increase max_allowed_packet on master'</code></pre>\n</div> \n<p>Our max_allowed_packet is big enough for any of our rows.</p> \n<h1>How we recovered</h1> \n<p>We had a master with live queries that were not coming back from a ‘killed’ state. We scaled the binlog LVM partition so that it could accommodate new writes now, but the DB was not budging. We had no idea how to get it to start writing again so we began a failover process.</p> \n<p>All our slaves were at the same position just before the corrupted event, so we grabbed one, confirmed the tuning was good and then promoted it. We went through the many other slaves and reconfigured them and we were good, consistent to the last event. All we lost were the few processes that were waiting to write to the full partition.</p> \n<p>Ironically, 2 of our team members are currently in the datacenter recabling some of our racks. We also have 4 swanky new DB class machines powered on, but we were a day or two away from getting them networked and integrated. We were just short of having that excess capacity to accept the spike in load from return visitors after the tweet “We’re back!”.</p> \n<h1>Forensics</h1> \n<p>We tried to understand the cause of the sudden binlog growth so we could safely enable the site without a replay of what just had happened. We expanded out some of the logs with ‘mysqlbinlog –verbose’ to show that it was filled with group spam. To confirm that it was group activity, we compared the replication data volume per table of a well sized binlog file with an abnormally large with the following awk program:</p> \n<div class=\"gatsby-highlight\" data-language=\"shell\">\n <pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">log</span> <span class=\"token keyword\">in</span> mysql-bin.03980<span class=\"token punctuation\">{</span><span class=\"token number\">5</span><span class=\"token punctuation\">..</span><span class=\"token number\">7</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n  mysqlbinlog <span class=\"token variable\">$log</span> <span class=\"token operator\">|</span><span class=\"token punctuation\">\\</span>\n  <span class=\"token function\">awk</span> <span class=\"token string\">'\n    /Table_map/ { name = <span class=\"token variable\">$9</span> }\n    /BINLOG/ { bytes = 0; col = 1 }\n    { if (col) bytes += length(<span class=\"token variable\">$0</span>) }\n    /\\*!\\*/ { if (col) sizes[name] += bytes; col = 0 }\n    END { for (i in sizes) print sizes[i], i }\n  '</span> <span class=\"token operator\">|</span><span class=\"token punctuation\">\\</span>\n  <span class=\"token function\">sort</span> -n <span class=\"token operator\">|</span><span class=\"token punctuation\">\\</span>\n  <span class=\"token function\">tee</span> /tmp/<span class=\"token variable\">$log</span>.sizes <span class=\"token operator\">&amp;</span>\n<span class=\"token keyword\">done</span></code></pre>\n</div> \n<p>This created a list of byte sizes of base64 encoded row data to table name. Groups took 820MB compared to the next largest table at 30MB.</p> \n<p>Put this script in your toolbox, it’s also great to use for getting an idea of which tables are your hottest under normal operations.</p> \n<p>We also used our recently finished HDFS-based log aggregation system to run map reduce jobs over our web and app logs to identify any possible abuse vectors around groups that were coming from the outside.</p> \n<h1>What we learned</h1> \n<p>When maintenance around abusive usage is also a part of your business, think about the data and impact on your running system for all maintenance work.</p> \n<p>Cut your losses early and resist the temptation to find the “root cause” during an outage incident. Failforward. Save what you can for forensics after you’re back up.</p> \n<p>Uncleared acknowledged alerts are alertable offenses. A big question during the incident was, “where were the alerts?”. It turned out that the host-based disk space check was previously acknowledged because we had an unrelated partition fill on the same host within expectation. This acknowledgment wasn’t cleared before the binlog partition filled so we didn’t get the 20 minutes of lead time we could have had.</p> \n<p>In the heat of the moment, put your heads together, make a plan for the next X minutes, execute, and repeat until you’re back up. All the engineers were at battle stations during this outage. This incident blindsided us and all kinds of theories were thrown around. When we focused on do X within Y minutes we got down to time boxing research to be able to take our next action. This worked very well.</p> \n<p>Pay off your technical debt. In the past, we took a loan on the future for trading space for time. Paying off these kinds of debts is easy to defer, until the collector comes to visit. Keep a list of the debts chosen, and the debts discovered. Even without an estimated cost to fix, your debt is a learning tool for others for where and when measured choices towards the road of delivery are made.</p> \n<p>Be as specific as you can with your expected data types. We never expected group descriptions to be larger than 2KB. We should have encoded that expectation loud and clear in the data and business layers.</p> \n<h1>Doing the right thing</h1> \n<p>We are all working with the best practices in mind, yet the combination of all that we were doing correctly ended up with this outage nobody expected. Yesterday was an incredible learning experience for everyone at SoundCloud, and the entire team joined together with a positive spirit and heartfelt passion to restore service as quickly as possible. I’m quite proud to work with everyone here.</p>","descriptionType":"html","publishedDate":"Wed, 24 Aug 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"4da2170abab033aa4b4a95cdf1b7afd0","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Removal of Groups endpoints","link":"https://developers.soundcloud.com/blog/removal-of-groups-endpoints","description":"<p>As well as adding new features and updates, we review existing features to see if they’re still beneficial to the community.</p> \n<p>As we dug into the best ways for curators to connect with artists and fans, we found that Groups aren’t working as well as reposts and curated playlists.</p> \n<p>With that in mind, we’ve decided to phase out Groups on Monday, August 22nd to make room for future updates.</p> \n<p>From this date, all Groups-related GET requests will no longer return results, and PUT requests will not persist any changes.</p> \n<p><strong>If your application relies on Groups, please update it by August 22nd, 2016.</strong></p>","descriptionType":"html","publishedDate":"Mon, 01 Aug 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"2c0193e21ac11dbc67869f627f490eb5","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569976},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Music Hack Day Boston 2011","link":"https://developers.soundcloud.com/blog/music-hack-day-boston-2011","description":"<p>Last weekend was another successful <a href=\"http://boston.musichackday.org/2011/\">Music Hack Day Boston</a> jam-packed with cool hacks, and hackers alike. We are always excited to get involved, meet new and interesting people, and of course hack!</p> \n<!-- more --> \n<p><img src=\"http://farm7.static.flickr.com/6098/6315685375_04f9b28079_z.jpg\" alt=\"MHD Boston 2011 // Photo by Thomas Bonte\"> <em>Photo by <a href=\"http://www.flickr.com/photos/thomasbonte/\" target=\"_blank\">Thomas Bonte</a>, see more <a href=\"http://www.flickr.com/photos/thomasbonte/sets/72157627935709883/\" target=\"_blank\">here</a>!</em></img></p> \n<p>For those who do not know of Music Hack Day, it’s a great weekend-long event aimed at music and sound hackers. Anyone can attend the event for free, and their goal is to conceptualize and develop innovative hacks of either software or hardware. Below are just a few of the cool hacks that were demoed last weekend.</p> \n<p><strong>Hacks:</strong></p> \n<ul> \n <li><a href=\"http://wiki.musichackday.org/index.php?title=Soundcloud_for_Rapportive\" target=\"_blank\">SoundCloud for Rapportive</a>: A plugin for Rapportive that finds out what your contacts have streaming on Soundcloud, and displays this info while browsing your e-mail, with the ability to play tracks right in your gmail. <em>Currently in development.</em> </li> \n <li><a href=\"http://wiki.musichackday.org/index.php?title=RECordinates\" target=\"_blank\">RECordinates</a>: Listen to sounds from around the world, and add your own directly to the map. Streaming, authentication, recording, and uploading is all handled by our new <a href=\"https://developers.soundcloud.com/docs/javascript-sdk\" target=\"_blank\">JS SDK</a>. Lots more for this app coming soon, via <a href=\"https://twitter.com/chriscaselas\" target=\"_blank\">yours truly</a>. Check it out in its early stages <a href=\"http://recordinates.herokuapp.com/\" target=\"_blank\">here</a>! </li> \n <li><a href=\"http://wiki.musichackday.org/index.php?title=Mustachiness\" target=\"_blank\">Mustachiness</a>: A visualization hack just in time for Movember. Using the waveform of a track, this hack creates a mustache based off of several factors specific to each song, such as loudness, hotness, danceability, and more. Check out the <a href=\"http://mustachiness.ex.fm/artist/foo%20fighters\" target=\"_blank\">mustachiness</a> of your favorite songs! </li> \n</ul> \n<p>Those are just a few. You can see all 56 hacks at the <a href=\"http://wiki.musichackday.org/index.php?title=Boston_2011_Hacks\" target=\"_blank\">Music Hack Day Wiki</a>.</p> \n<p><object width=\"100%\" height=\"450\"> <param name=\"flashvars\" value=\"offsite=true&amp;lang=en-us&amp;page_show_url=%2Fphotos%2Fthomasbonte%2Fsets%2F72157627935709883%2Fshow%2F&amp;page_show_back_url=%2Fphotos%2Fthomasbonte%2Fsets%2F72157627935709883%2F&amp;set_id=72157627935709883&amp;jump_to=\"> <param name=\"movie\" value=\"http://www.flickr.com/apps/slideshow/show.swf?v=109615\"> <param name=\"allowFullScreen\" value=\"true\"><embed type=\"application/x-shockwave-flash\" src=\"http://www.flickr.com/apps/slideshow/show.swf?v=109615\" allowfullscreen=\"true\" flashvars=\"offsite=true&amp;lang=en-us&amp;page_show_url=%2Fphotos%2Fthomasbonte%2Fsets%2F72157627935709883%2Fshow%2F&amp;page_show_back_url=%2Fphotos%2Fthomasbonte%2Fsets%2F72157627935709883%2F&amp;set_id=72157627935709883&amp;jump_to=\" width=\"100%\" height=\"450\" /></param></param></param></object></p> \n<p>To find out about upcoming events, check <a href=\"http://musichackday.org\" target=\"_blank\">MusicHackDay.org</a> and follow <a href=\"https://twitter.com/musichackday\" target=\"_blank\">@musichackday</a> on Twitter. The next planned Music Hack Day is to be held in <a href=\"http://london.musichackday.org/2011/\" target=\"_blank\">London</a> on December 3rd &amp; 4th.</p>","descriptionType":"html","publishedDate":"Fri, 11 Nov 2011 00:00:00 +0000","feedId":10291,"bgimg":"http://farm7.static.flickr.com/6098/6315685375_04f9b28079_z.jpg","linkMd5":"a489b9ea33afa90e83f88ed56c7c84d1","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn62@2020_2/2020/08/25/00-49-37-483_e3ce2fd1270d2229.webp","destWidth":640,"destHeight":425,"sourceBytes":89870,"destBytes":45660,"author":"","articleImgCdnMap":{"http://farm7.static.flickr.com/6098/6315685375_04f9b28079_z.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn62@2020_2/2020/08/25/00-49-37-483_e3ce2fd1270d2229.webp"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud mobile – Proxies","link":"https://developers.soundcloud.com/blog/soundcloud-mobile-proxies","description":"<h3>The Problem</h3> \n<p>The mobile version of SoundCloud is a consumer of our own API dog food. That decision was made with the intention to deploy a self-sufficient client application that depends only on a static provider. Our early experiements showed that the attempt we made had some downsides. For example, the implementation of <a href=\"http://code.google.com/p/chromium/issues/detail?id=70257\">redirects in CORS is not behaving properly</a> and therefore can’t be used with many of the endpoints in our API where we rely on the correct handling. Also classic XHR communication with the API is not an option due to the <a href=\"http://en.wikipedia.org/wiki/Same_origin_policy\">same origin policy</a> implications that apply even on subdomains.</p> \n<h3>The Idea</h3> \n<p>In another internal project we handled that problem with an iFrame hack for all non GET/HEAD HTTP methods. This makes sense when you’re not directly dependent on an immediate response, but it is not a feasible way to handle direct actions like commenting or favoriting. At this point we looked into different approaches to make the API accessible to the mobile app, without reimplementing any application logic from the mothership. The one we agreed on was a paradigm that we called mountable proxy. Basically, it means that we reserve a namespace in our routes that is exclusive to our API communication and can be treated like api.soundcloud.com. In our case we reserved /_api. Our frontend application is hitting that endpoint with a well-formed request that would originally go to the API subdomain. To get the correct response the proxy is applying basic rewrite rules and proxies the request to the API and returns the reponse again with some basic rewrite rules to the frontend. Thus the frontend code can be written in a way that it not has to deal with extra layers like CORS or any rewrite logic. Normal rules for XHR requests behaviors for example the handling of redirects still apply.</p> \n<h3>The Nginx Solution</h3> \n<p>With Nginx being one of the most important tiers in our http stack, it was natural to lean in that direction first. Nginx serves most of our subdomains and also the static content of the mobile site. The software itself ships with a good amount of powerful modules one of it is the proxy module. It allows one to redirect and alter some of the important bits like Location header. The following snippet is what we had in production when we first went live with m.soundcloud.com:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\"># Only apply redirects to a specific route\nlocation /_api/ {\n  # Clean the prefix\n  rewrite ^/_api(.*)$ $1 break;\n\n  # Override the default we want the host of the proxy here\n  proxy_set_header Host $proxy_host;\n\n  # the actucal redirect\n  proxy_pass https://api.soundcloud.com/v1/;\n\n  # Rewrite Location header\n  proxy_redirect https://api.soundcloud.com http://$host/_api/;\n}</code></pre>\n</div> \n<p>You can find all in-depth documentation for the used directives in the <a href=\"http://wiki.nginx.org/HttpProxyModule#proxy_pass\">proxy module</a> wiki page.</p> \n<h3>The Node Solution</h3> \n<p>The second iteration of the mobile app included features that are exclusive to authenticated users like the Dashboard, own Tracks, and Favorites. It also brings some more requirements like traffic over HTTPS and storage of credentials. We handle authentication against our API with <a href=\"http://oauth.net/2/\">OAuth2</a>. To see in detail how it works, check out the developers documentation for authentication.</p> \n<p>In our case we wanted to avoid exposing the client secret used to get the access token for authenticated communication with the API. For that reason we decided we want to add that secret inside of the proxy for the token endpoint. Really early in the development we started to use a server written in <a href=\"http://nodejs.org/\">nodejs</a> to provide an environment comparable to our live setup. It enabled all developers to equally contribute to the component that drives the local development. Because of that fact we looked into possible options to extend this server code to match the new requirements. The nginx part changed to use a pool of servers combined in one <a href=\"http://wiki.nginx.org/HttpUpstreamModule\">upstream directive</a> and looks like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">upstream mobile {\n  server xx.xx.xx.xx:xxxx weight-10 fails-5 fail_timeout-10s;\n}\n\nlocation / {\n  # Avoid double encoding for requests coming from the API\n  proxy_set_header Accept-Encoding  \"\";\n\n  proxy_pass http://mobile$request_uri;\n}</code></pre>\n</div> \n<p>We’re using <a href=\"http://senchalabs.github.com/connect/\">Connect</a> for a standard set of server functionalities and mounting the <a href=\"https://gist.github.com/1162848\">proxy</a> into the /_api endpoint like we did before with nginx. The recently introduced <a href=\"http://nodejs.org/docs/v0.4.8/api/streams.html#stream.pipe\">pipe method</a> on <a href=\"http://nodejs.org/docs/v0.4.8/api/streams.html\">Streams</a> helps to keep the code really small and readable. All modifications on top of that was moved to the app layer.</p> \n<p>Through our external monitoring we observed partial downtimes after the move to the node backed cluster. Why they happened wasn’t fully clear as Nginx lacks good introspection about the up and down states of its upstream servers. As a follow-up we mirrored what we already had for our other multi-instance endpoints and put <a href=\"http://haproxy.1wt.eu/\">HAProxy</a> in front of the node processes. This right away got us way better metrics and visibility. Nginx still is part of the stack as it fronts the HAProxy tier.</p> \n<p>During that time Github released <a href=\"https://github.com/blog/900-nodeload2-downloads-reloaded\">a blog post</a> regarding how their nodeload component got optimized. One important fact is the way how nginx handles bodies and only supports HTTP/1.0. We also turned off <a href=\"http://wiki.nginx.org/HttpProxyModule#proxy_buffering\">proxy_buffering</a> in nginx to let data being passed synchronously to the node processes.</p> \n<p>Afer this fundamental setup change we saw a new problem. When communicating to the proxy endpoint over HTTPS and getting a 304 response from the API the socket hang up unexpectedly and HAProxy returned a 502 for this request. We synthesized the problem and isolated it to another finding from the Github blog article about the event handling of end/close on Streams and modules that inherent from Stream. As we use pipe to get the body unaltered from the response coming from the API to the response going to the client we saw that end() was called prematurely. This led to what HAProxy understands as protocol violation and we saw a lot of 502s with the reason SH, that is explained in the <a href=\"http://haproxy.1wt.eu/download/1.4/doc/configuration.txt#8.5.\">HAProxy documentation</a>. This behavior is not necessarily a bug and is not yet changed in node itself. We applied a small workaround mentioned in this <a href=\"https://github.com/joyent/node/issues/728\">issue</a>.</p> \n<h3>The Conclusion</h3> \n<p>Even though the decision to mount the API seems like a violation of the idea to have a shippable independent client-side application, it helped to move fast and focus on the actual implementation of the authenticated areas instead of handling hacks and work around them. Both solutions — nginx and node — have worked quite well so far. With both technologies following the same paradigms in implementation they both fit well when it comes to proxy traffic with simple alterations.</p>","descriptionType":"html","publishedDate":"Mon, 22 Aug 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"b834689c476e5baaa6869a4b873e1fcc","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Running Android UI Test Suites on Firebase Test Lab","link":"https://developers.soundcloud.com/blog/running-android-ui-test-suites-on-firebase-test-lab","description":"<p>Testing mobile applications is not always an easy feat. In addition to defining what to test and determining how to write those tests, actually running tests can also be problematic — in particular, UI test suites running on real mobile devices or emulators sometimes run for an extensive amount of time.</p> \n<!-- more --> \n<p>This post talks about both how we at SoundCloud initially handled our Android UI tests with internal tooling and our migration to Firebase Test Lab for running all of our UI tests.</p> \n<p>In the CI builds running on our <a href=\"https://play.google.com/store/apps/details?id=com.soundcloud.android\">Android listener application</a>, the time it took to run the UI tests was always a bottleneck for the overall runtime of a build. So in order to not just rely on one single device or emulator, we developed tooling and services to allow us to run our UI tests on an internal device farm using 30 Nexus 5 devices in parallel. This made it so we could run our tests in about 15 minutes, as opposed to the three hours it would take if we ran them all on a single device.</p> \n<p>Unfortunately, after years of working successfully, this system started showing signs of its age, causing multiple problems in our day-to-day development. Initially, it had a great feature set with rich UI test results and reports, video recordings of failed tests, reports of the most frequently failing tests over time, and more. But eventually, it started to slow us down. We frequently saw long build queues and failures due to infrastructure issues, and soon it became clear that we had to either fully commit to maintaining and updating the system, or else start thinking about alternatives.</p> \n<p>We began investigating different platforms and cloud providers offering real devices and emulators in different configurations, and in the process, we realized two problems we would face.</p> \n<ol> \n <li>Our test suite was tailored to running on physical Nexus 5 devices, and due to shared state, many tests had to be run in isolation to work correctly. Additionally, our custom test services made sure every test ran in isolation without sharing any state with other tests. However, cloud providers for running Android tests offer a variety of devices in different sizes and usually run all tests one after another, often with shared state between tests. This difference, along with the age of our test suite, resulted in multiple issues for us.</li> \n <li>The size and runtime of our test suite meant that running our UI tests using a cloud provider to spin up a single device or emulator would degrade our test feedback times to multiple hours.</li> \n</ol> \n<h2>Making Our Test Suite More Robust</h2> \n<p>It was clear that in order to run our tests on other device/emulator farm setups, we would have to make our testing more robust. For example, some tests expected to run on the exact screen dimensions of a Nexus 5 and started failing if the screen size differed slightly. Others couldn’t handle the state other tests left behind.</p> \n<p>Around the same time that we were looking at different solutions and experimenting with ways to improve the stability of our test suite, Google released the first versions of the <a href=\"https://developer.android.com/training/testing/junit-runner.html#using-android-test-orchestrator\">Android Test Orchestrator</a>, which wraps the test instrumentation to allow each single test to run in its own Instrumentation. The result is that tests do not share a lot of state, and each one runs more in their own sandbox. Additionally, if one test happens to crash, the other tests can still run and report their correct states; the test suite will not be interrupted immediately due to a crash.</p> \n<p>Using the Android Test Orchestrator is as easy as adding a few lines to your project’s <code class=\"language-text\">build.gradle</code> file, and doing so can help stabilize a test suite quite a bit. This, of course, depends greatly on the test suite itself:</p> \n<div class=\"gatsby-highlight\" data-language=\"groovy\">\n <pre class=\"language-groovy\"><code class=\"language-groovy\">android <span class=\"token punctuation\">{</span>\n  defaultConfig <span class=\"token punctuation\">{</span>\n   <span class=\"token punctuation\">...</span>\n   testInstrumentationRunner <span class=\"token string gstring\">\"android.support.test.runner.AndroidJUnitRunner\"</span>\n <span class=\"token punctuation\">}</span>\n\n  testOptions <span class=\"token punctuation\">{</span>\n    execution <span class=\"token string\">'ANDROID_TEST_ORCHESTRATOR'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\ndependencies <span class=\"token punctuation\">{</span>\n  androidTestImplementation <span class=\"token string gstring\">\"com.android.support.test:runner:&lt;latest_version&gt;\"</span>\n  androidTestUtil <span class=\"token string gstring\">\"com.android.support.test:orchestrator:&lt;latest_version&gt;\"</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>After adding this piece of setup every time tests from the <code class=\"language-text\">androidTest</code> configuration are run they will run with the Android Test Orchestrator.</p> \n<h2>Firebase Test Lab</h2> \n<p><a href=\"https://firebase.google.com/\">Firebase</a> is Google’s suite of many services for building great mobile applications. One part of it is the <a href=\"https://firebase.google.com/docs/test-lab/\">Firebase Test Lab</a> — this enables developers to easily create and launch a test run on a real device or Android emulator hosted in a Google data center and run a set suite of tests on it. After the tests have finished running, the Firebase web UI will then display the results of each test — in addition to information such as a video recording of the test run, the full Logcat, and screenshots taken with the help of the <a href=\"https://firebase.google.com/docs/test-lab/test-screenshots\">Firebase Test Lab Screenshotter Library</a>.</p> \n<p>Tests can also be run on Firebase Test Lab through Android Studio. Simply sign into Android Studio with the Google account linked to your application’s Firebase project. When you run a test, select the “Cloud Testing” tab, choose the Firebase project, and configure the devices/emulators you want to run your tests on.</p> \n<p>For our use case, which was wanting to test our Android application, the choice to go with Firebase — which will always allow us to test on the latest Android versions and use the newest test tooling such as the Android Test Orchestrator — was an easy one.</p> \n<p>However, the main use case of Firebase Test Lab is one that allows users to upload the application APK and a test APK. Firebase Test Lab then runs all the tests contained in the test APK — or a subset of them depending on the configuration — on one device/emulator or a matrix of different ones. However, every device and/or emulator will run the same set of tests. For a test suite of our size, this would result in huge test durations.</p> \n<h2>Massively Sharding Tests</h2> \n<p>Firebase Test Lab currently does not offer splitting a test suite into multiple parts and executing smaller parts of the suite on multiple emulators in parallel to bring down testing times. However, the open source community (namely Walmart Labs) has come up with a solution for this.</p> \n<p><a href=\"https://github.com/TestArmada/flank\">Flank</a> is a tool that allows for massively sharding an Android UI Test suite across many devices/emulators on Firebase Test Lab, at the same time, in parallel. In other words, instead of running all tests on a single emulator, it allows for scheduling a smaller amount of tests on multiple devices/emulators. Each of these shards will then execute in parallel, massively reducing the time it takes to run all tests in the process.</p> \n<p>Flank is configured with a small file defining the device or emulator that should be used, the Android OS version, and how long each shard should run for. Flank keeps a record of the duration of each test so that it can group them together to ensure a fairly constant runtime. Additionally, as Firebase bills Test Lab usage by the minute, Flank tries to intelligently group tests together so that they use the minimal overall billable time on the devices, thereby saving costs.</p> \n<p>By using Flank, we were able to reduce our overall test suite runtimes when compared to our previous internal systems. And in case our test suite grows larger, Flank will help us schedule our tests on more emulators, enabling us to continue to have our current test durations.</p> \n<p>Our previous in-house testing solution gave us many features we got used to and loved, which we lost when we started using Flank. For example, after a test run, we would receive a test report in rich HTML with links to Logcat and video recordings of the test run for failing tests. Additionally, filtering tests by annotations was a way for us to easily configure different suites of tests to run, depending on the current task. However, as part of our work to migrate our UI test suite to Firebase Test Lab, we built these features into Flank and contributed them back into the main repository so that other users of Flank can enjoy them as well.</p> \n<p>Overall, running our tests in Firebase Test Lab with Flank has helped us modernize our UI testing stack, stabilize our test suite, and even speed up test runtimes in the process, which leads to happier and more productive developers.</p>","descriptionType":"html","publishedDate":"Fri, 04 May 2018 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"d6639e053e37874dc111128b29e75930","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569991},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Building the SoundCloud mobile site using backbone.js","link":"https://developers.soundcloud.com/blog/building-the-soundcloud-mobile-site-using-backbone.js","description":"<p><img src=\"https://img.skitch.com/20110722-qf2wmir75es6ag338k2xdkpksg.png\" /></p> \n<p>Until early this year, there was a gap. A gap between the desktop-targeted main SoundCloud site, what we call the ‘mothership’, and the native iOS (iPhone, iPod touch) and Android applications. A common and frustrating use-case was mobile Twitter: Someone would share a new <a href=\"https://twitter.com/#!/ericw/status/93440751215718400\">favorite</a> or <a href=\"https://twitter.com/#!/ianwhooper/status/89517272762286080\">upload</a> on Twitter, you tap on it, and it tried to load the regular site on your tiny smartphone screen. Pushing the whole desktop site over a mobile connection would be a waste of precious&nbsp;bandwidth, if you&nbsp;only want to check out a track. Alternatively we could try to redirect to our native apps, but there’s no guarantee that the user has it installed and the mobile vendors don’t offer any APIs for verifying that in advance.</p> \n<p>With that in mind, back in December 2010, we set off to build <a href=\"https://m.soundcloud.com\">SoundCloud Mobile</a>, targeting the mobile browsers of iOS and Android. The analytics of the existing site told us that these two platforms make up the overwhelming majority of our users, so we started there. As a mid-term goal, we decided to expand our support to devices, as long as they have a browser capable of streaming audio.</p> \n<p>For the architecture of the site we decided to make it a <a href=\"https://developers.soundcloud.com/docs\">SoundCloud API</a> client, eating our own dogfood just like the native iOS and Android apps already do. With that in mind, we considered the option of building a single-page web application (vs classic serverside rendered pages). To figure out how viable that option is, we spent a week building a prototype based on <a href=\"http://jquerymobile.com/\">jQuery Mobile</a>. The prototype included a start page with hot tracks, a basic search, people and track pages and basic audio streaming. The lists used the theme provided by jQuery Mobile, everything else was barely styled HTML. This prototype helped a lot in making several important decisions:</p> \n<ul> \n <li>Building a single-page app was feasible, with the client side application as the direct API client. Later we had to back away a bit from that, introducing a proxy to decorate the API (and work around WebKit <a href=\"http://code.google.com/p/chromium/issues/detail?id=70257\">bugs</a>), but overall most of the action is still happening on the client.</li> \n <li>jQuery Mobile works great for a fixed number of preloaded and infinite number of server-generated pages, but not for our usecase of generating all pages on the fly based on API results. We needed much more flexible routing with HTML5 <a href=\"https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history\">history.pushState</a> support, so that we could support the theme URL sets as the main site.</li> \n <li>On a similar note, jQuery Mobile’s theming system allowed us to build a pretty prototype in no time, but wasn’t a good fit for the completely customized UI that we wanted.</li> \n <li>Audio streaming on mobile is still very immature. Even with support for only iOS and Android, plenty of workarounds are required for a somewhat consistent experience.</li> \n</ul> \n<p>After throwing away the first prototype, we moved on to create our own basic framework. It described the domain classes like ‘track’ and ‘user’ as global singleton objects. Our ‘router’ object was responsible of passing on the model data onto the responsible controller method. Soon we could see that the approach wouldn’t scale that well, especially when simultaneous instances of a class were required on the same page.</p> \n<p>After dismissing a <a href=\"http://www.sencha.com/products/touch/\">few</a> <a href=\"http://javascriptmvc.com/\">bigger</a> client-side <a href=\"http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller\">MVC</a> frameworks, we’ve stumbled upon <a href=\"http://documentcloud.github.com/backbone/\">Backbone.js</a>, which was compact, easily extendable and depended only on <a href=\"http://documentcloud.github.com/underscore/\">Underscore.js</a>. Backbone sets up only the application structure plus it offers a multitude of convenient methods that can be used while building your app. It doesn’t dictate how the application UX works nor describes how the templates have to be structured. While that still left a lot of open questions for us to answer, it also didn’t impose too much unwanted structure.</p> \n<p><a href=\"http://documentcloud.github.com/backbone/\">Backbone.js</a> let’s you choose your own templating engine, and we went with the <a href=\"http://api.jquery.com/jquery.tmpl/\">jquery-tmpl</a> plugin. We restricted our template usage to output and iteration within the template, both to give us the option of switching to another template engine (e.g. <a href=\"http://www.handlebarsjs.com/\">handlebars.js</a>) and to keep our sanity. To implement the remaining presentation logic, we used the route suggested by Backbone.js, preparing the data for output in the Model’s <a href=\"http://documentcloud.github.com/backbone/#Model-toJSON\">toJSON</a> method. This also has the advantage of keeping the model itself clean, making it easy to update the model and send it back to the server. In addition to that we added a decoration step, modifying the template output before inserting it into the DOM. This includes adding additional classes or removing empty nodes.</p> \n<p>When we started using Backbone.js, it supported only hash-based history (what Twitter does today when it redirects twitter.com/ericw to twitter.com/#!/ericw). We wanted support for <a href=\"http://dev.w3.org/html5/spec-author-view/history.html\">history.pushState</a> to map URLs from soundcloud.com to m.soundcloud.com by only prepending the ‘m.’. We extended Backbone.history for that, while also triggering a custom event. The latter can be used by the Google Analytics tracker or any other component that has to get an update on the current page state.</p> \n<p>We also extended regular Backbone.sync method, used by all Models and Collections to exchange data with the server, to add a client side cache, backed by the HTML5 <a href=\"http://dev.w3.org/html5/webstorage/\">sessionStorage</a>. That way we didn’t have to keep any pages in memory, but can instead rerender them from scratch in milliseconds, as the underlying data is still available in the cache.</p> \n<p><img src=\"https://img.skitch.com/20110722-1r2ynrxuyeqbm47rbmgh6bwce5.png\" /></p> \n<p>With those components in place, a click (or rather, tap) on any internal link caused the following actions:</p> \n<ul> \n <li>Handling the click/tap event, preventing the default browser action, and using history.pushState instead to update the current address. At some point telling the Backbone.router that the page changed.</li> \n <li>Backbone.router maps the URL to a controller method, which creates the model for that URL, e.g. initializing the User model with the username parsed from the URL. It then creates the view and passes the model to that view.</li> \n <li>The view tells the model to fetch its data. Once done, with data loaded from the server or from the client side cache, it passes the model to a template, decorates the result and inserts it into the DOM.</li> \n <li>The view also initializes event handlers (via event delegation) to handle all interactions within that view, e.g. a click event on the ‘Play’ button to start streaming audio.</li> \n</ul> \n<p>This turned out to be a very solid application architecture which we continued to fine-tune after the first public launch of the mobile site in March, when we redirected iOS and Android traffic from the <a href=\"https://soundcloud.com/\">main site</a>. Since then we continued to add features and improve the site, watching the traffic almost doubling every month.</p> \n<p>Along with this new client side architecture we also experimented with alternatives for development and production. The <a href=\"http://nodejs.org\">node.js</a>-based development and production server, including the API-proxy is <a href=\"https://backstage.soundcloud.com/2011/08/soundcloud-mobile-proxies/\" title=\"SoundCloud mobile – Proxies\">covered in detail</a> by our node ninja&nbsp;<a href=\"https://twitter.com/goldjunge\">Alexander Simmerl</a>. In the upcoming post we’ll also talk about our approach to testing with <a href=\"http://docs.jquery.com/Qunit\">QUnit</a> and <a href=\"http://www.phantomjs.org\">PhantomJS</a>.</p>","descriptionType":"html","publishedDate":"Tue, 02 Aug 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://img.skitch.com/20110722-qf2wmir75es6ag338k2xdkpksg.png","linkMd5":"b88be870659c0391f1ec17a620f8046d","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn5@2020_3/2020/08/25/00-49-39-187_6b7b77e6f7dcab50.jpg","destWidth":0,"destHeight":0,"sourceBytes":52870,"destBytes":52870,"author":"","articleImgCdnMap":{"https://img.skitch.com/20110722-qf2wmir75es6ag338k2xdkpksg.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn5@2020_3/2020/08/25/00-49-39-187_6b7b77e6f7dcab50.jpg","https://img.skitch.com/20110722-1r2ynrxuyeqbm47rbmgh6bwce5.png":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn28@2020_2/2020/08/25/00-51-42-971_e2a8c0fc69d50de0.jpg"},"publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Radical Candor: An Experience Report","link":"https://developers.soundcloud.com/blog/radical-candor-an-experience-report","description":"<p>Although it can be easy to know if you’ve messed up badly as a manager, it’s not always as easy to know if you’re doing a good job. In particular, the power dynamics at play can make it hard for people on your team to feel confident letting you know what’s working well and what’s working not so well.</p> \n<p>I’ve been managing managers for a while now, and through the years, I’ve tried a few ways to help close this gap. In this article, I’m going to talk about an approach I started using in the last few years that seems to strike the best balance of getting the input managers need while still promoting a healthy culture of direct feedback.</p> \n<h2>The Approach</h2> \n<p>Back when I was working at Sky, I came across a post by Kim Scott entitled “<a href=\"https://firstround.com/review/radical-candor-the-surprising-secret-to-being-a-good-boss/\">Radical Candor — The Surprising Secret to Being a Good Boss</a>.” The title was intriguing enough to get me reading, but what I discovered was an approach to management that was genuinely refreshing. The following diagram is a great summary of the core concept and some of the terms she uses:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 640px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/1e36bb105d9a2786ae2026815a271763/e2288/radical-candor.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 109.84375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAWABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAAB9iawHVC7hUCf/8QAGhAAAwADAQAAAAAAAAAAAAAAAAERAhASIf/aAAgBAQABBQJ5R9ejLBEJr//EABURAQEAAAAAAAAAAAAAAAAAADEg/9oACAEDAQE/ARj/xAAVEQEBAAAAAAAAAAAAAAAAAAAxIP/aAAgBAgEBPwFI/8QAGBAAAgMAAAAAAAAAAAAAAAAAABEQIDH/2gAIAQEABj8CQp2v/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAERITEQof/aAAgBAQABPyFAKSaI1o0a/BKOK8//2gAMAwEAAgADAAAAEOvPAP/EABkRAAEFAAAAAAAAAAAAAAAAABEAARAhMf/aAAgBAwEBPxBrHElf/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAgEBPxBVpqH/xAAbEAEAAwADAQAAAAAAAAAAAAABABEhMUFRYf/aAAgBAQABPxAinXjGUsNOYxWXMaZfVRIIK3GW6Zf2ZLf2Cabk/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Radical Candor Chart\" title=\"Radical Candor Chart\" src=\"https://developers.soundcloud.com/blog/static/1e36bb105d9a2786ae2026815a271763/e2288/radical-candor.jpg\" srcset=\"/blog/static/1e36bb105d9a2786ae2026815a271763/f544b/radical-candor.jpg 200w,\n/blog/static/1e36bb105d9a2786ae2026815a271763/41689/radical-candor.jpg 400w,\n/blog/static/1e36bb105d9a2786ae2026815a271763/e2288/radical-candor.jpg 640w\" sizes=\"(max-width: 640px) 100vw, 640px\" loading=\"lazy\" /> </a> </span></p> \n<p>I loved the concept, especially since it challenged some of my own tendencies toward “Ruinous Empathy” — caring personally for my coworkers but failing to challenge them directly — and gave me a path to provide more meaningful support for my team.</p> \n<p>The book that followed (see <a href=\"https://www.radicalcandor.com/\">radicalcandor.com</a>) is a treasure trove of tools on how to put these ideas into practice, and it contains a section dedicated to the Manager Guidance concept introduced in Kim’s original post.</p> \n<p>One aspect of this concept is a skip-level meeting, which is generally defined as a meeting held between a manager’s manager and their direct reports, thereby skipping the level between them. Generally speaking, Kim’s Manager Guidance process follows these steps:</p> \n<ol> \n <li>A skip-level meeting is held specifically to ask people how their boss could become a better manager. During this meeting, notes are collected and then shared with the manager after the session.</li> \n <li>A follow-up discussion takes place between the manager and their manager to provide additional context about the feedback and answer any questions.</li> \n <li>The manager then speaks to their team about what they learned from the feedback and what changes they intend to take in addressing it.</li> \n</ol> \n<p>The specific topics people raise in the skip-level meeting are interesting and useful, but most importantly, we want to learn whether people feel good about the feedback culture between themselves and their manager.</p> \n<p>My first attempts in using the process at Sky revealed a lot, but for this article, I’m going to focus on how it worked here at SoundCloud, as I was able to put into practice some of what I learned from the first time around. I’ll explain more about how I prepared for the sessions, how I ran them, and how they were received by the teams and their managers. I’ll also cover some of the ways in which they could go wrong and how to address these potential issues.</p> \n<h2>Preparation</h2> \n<p>First off, any manager having this process run on their behalf needs to be bought in. They should at least read Kim’s blog post, but better yet, they should read the relevant chapter in <em>Radical Candor</em>, and ideally, the entire book! If, after all of that, they aren’t excited, then it’s better to find a different approach for their guidance.</p> \n<p>When teams are invited to a manager guidance session, I provide them with key information. An example invite might read:</p> \n<blockquote> \n <p>This session is to gather feedback to help [your manager] be a better manager. It’s based on a framework Kim Scott talks about in her book <em><a href=\"https://www.radicalcandor.com/\">Radical Candor</a></em>, and when I used it (both for me and by me) in a previous company, I found it to be a really helpful exercise.</p> \n</blockquote> \n<blockquote> \n <p>I recommend reading the entire article here, but the TL;DR about this session can be found in the section starting “<a href=\"https://firstround.com/review/radical-candor-the-surprising-secret-to-being-a-good-boss/\">Make it easier to speak truth to power</a>.”</p> \n</blockquote> \n<blockquote> \n <p>There’s no need for you to prepare anything; I’ll capture notes and ask questions to help keep the conversation on track. [xxx] and I want you to feel confident about being completely open.</p> \n</blockquote> \n<h2>Running the Session</h2> \n<h3>Structure and Process</h3> \n<p>In the <em>Radical Candor</em> book, Kim recommends a very specific structure for the meetings, which I mostly followed, as it works well. Here’s how I interpreted it for my use:</p> \n<ul> \n <li>Short introduction (c. 5 minutes)</li> \n <li>Open discussion (c. 40 minutes)</li> \n <li>Reviewing notes together (c. 15 minutes)</li> \n</ul> \n<p>As the moderator, I capture notes and I display them on a screen behind me so people can see my terrible note-taking skills in real time and tell me when I capture their points inaccurately.</p> \n<h3>Introduction</h3> \n<p>On rereading Kim’s book recently, I realized I had forgotten to apply one piece of advice, which was to get the managers to explain the purpose of the meeting to their teams ahead of time. This meant that a very small percentage of people attending the meeting knew what to expect.</p> \n<p>I was anticipating this, so I included time at the top of the session to run through the purpose and set some ground rules. Some of the key points I called out are:</p> \n<ul> \n <li>This is about helping the manager learn and grow.</li> \n <li>The session shouldn’t focus exclusively on either positive or negative points, as it’s all about getting balanced feedback.</li> \n <li>It’s also about checking in on the flow of feedback between the team and their manager.</li> \n <li>Everyone’s voice needs to be heard.</li> \n <li>The notes are not attributed to individuals, but people still have to be comfortable with them being shared directly.</li> \n</ul> \n<h3>Topics</h3> \n<p>I wanted to have some consistency in approach across the sessions (I have five managers reporting to me), so I came up with a loose structure as follows: For Me, For My Team, For the Company. In each section, I explained the overall topic and then used simple starter questions to get the conversation going.</p> \n<p>I tend to go with somewhat neutral and uncontroversial questions so as not to push the conversation in a particular direction, but rather see where it gets taken by the group, and I then dig deeper when something interesting emerges. However, sometimes if I know there’s been a particular theme that’s affected a team (e.g. confusing priorities or a visible conflict), I might ask specific questions about how their manager handled it.</p> \n<p>The questions you ask can reveal a lot about what you expect from managers on your team, and that’s not a bad thing! At SoundCloud, we recently completed an exercise to define expectations for Engineering Managers, and I expect I’ll start using some of these expectations as a basis for sessions in the future.</p> \n<h4>For Me</h4> \n<p>This section gives the attendees the opportunity to talk about how their manager supports their specific needs as an individual. Some example starter questions I used:</p> \n<ul> \n <li>How often do you get together 1 on 1? Is that the right cadence for you?</li> \n <li>Who controls the agenda for those sessions? Do you get to talk about everything you want to? Do you ever talk about your career plans/aspirations?</li> \n <li>How available is your manager to you outside of those sessions?</li> \n <li>Does your manager actively seek out opportunities for you that align with your aspirations?</li> \n <li>Does your manager ask you for feedback? When did you last give them critical feedback? How did they take it?</li> \n <li>Do you feel that you’re learning from your manager? Do you have any specifics?</li> \n</ul> \n<h4>For My Team</h4> \n<p>This section is all about the health of the team as a unit and the manager’s contribution to that. Some example questions are:</p> \n<ul> \n <li>Do your team meetings run smoothly? E.g. clear purpose, kept on track, actions logged, everyone is heard.</li> \n <li>Is collaboration encouraged? Does your manager seek to avoid silo-ing of knowledge/skills?</li> \n <li>Do you have social events as a team that everyone can engage with?</li> \n <li>Do conflicts within the team get resolved?</li> \n</ul> \n<h4>For the Company</h4> \n<p>This section is about how the manager contributes to the success of the relationship between their team and the rest of the business. Here is an example of some of the questions:</p> \n<ul> \n <li>Is it clear the role your team plays in the company’s success? Do you think you’re working on things that contribute to that?</li> \n <li>Do you feel that the successes of your team are known about in the rest of the company? Are you well represented in key meetings, e.g. All Hands?</li> \n <li>Does your manager advocate for you as a team when you raise topics that need assistance from outside of the team?</li> \n <li>Do you get clear information about changes to company priorities or policies from your manager? Do they manage to answer all your questions, or at least point you in the right direction?</li> \n</ul> \n<h2>After the Session</h2> \n<p>Once the session is complete, I plan a note review session with each manager, and I share the notes with them the evening before. This gives them enough time to digest the information and have questions prepared, but not so long that they stew on any negative points.</p> \n<p>The session itself is around 30 minutes long, and I set expectations around the next steps, which start with the manager summarizing the key learnings from the notes and what changes they plan to make. They should then talk through these ideas with their team to reinforce the message that the feedback is being heard and acted upon.</p> \n<h2>How Did It Go?</h2> \n<h3>How Was It for the Teams?</h3> \n<p>Probably the most common piece of feedback I received was along the lines of: “That wasn’t as bad as I was expecting!” It can be stressful to think about giving feedback to your manager, so a process that normalizes and encourages it can bring relief to many people.</p> \n<p>Here is an explicit piece of written feedback I received:</p> \n<p>“…I found that session really really nice. I was very apprehensive going into it, but in the end I think it was one of the most comfortable feedback-collecting formats I’ve been a part of. It was so nice to be able to talk and have someone else write it down, to be able to hear what other people had to say and triangulate, and to frame the whole thing as guidance and direction rather than feedback…”</p> \n<p>The other realization I often see dawning on people during the sessions is how difficult it is for a manager to tailor their approach to a group of diverse individuals.</p> \n<h3>What Feedback Was Given? How Did the Managers React?</h3> \n<p>Thankfully, there were no major surprises in the feedback for any of the managers in my team, but there were plenty of items they were able to take forward and work with. I had universally positive responses from them, and when we talked about the approach with other managers outside of my group, it was great to hear them advocating for the process and the value it brought them.</p> \n<p>For some managers, people on their teams were asking for more critical feedback on their work, as they wanted to understand more deeply how they could grow. Other managers who had focused attention on that already heard that they should also apply the same rigor to giving positive feedback, which is a theme in Kim’s book too.</p> \n<h3>What Did I Learn?</h3> \n<p>One piece of advice I didn’t follow from Kim’s book, as mentioned above, is to get the managers to explain the process to their team in advance, which would definitely have saved some time in the sessions. Some people weren’t sure whether their manager would be there and even whether they would be on their own in the session.</p> \n<p>The other thing that is clear is the time in the feedback sessions passes very quickly, so it’s important to be very structured about moving through the topics and try to avoid getting stuck on any particular point for too long.</p> \n<h2>What Could Go Wrong and How to Address It</h2> \n<h3>Gripe Session</h3> \n<p>If one or more people in the group choose to use the session to moan about their boss, it can be quite detrimental to team morale. Also, as Kim points out in her book, there’s a danger that the moderator can appear to presume that the boss is guilty, or — just as bad — try to defend them against the criticism. Having said that, the complaints are a window into a problem within the team that benefits from being revealed.</p> \n<p>The moderator can steer the conversation to avoid getting stuck on a topic that might only have relevance for a small subset of the group, e.g. “[xxx], does this affect you as much as it affects [yyy]?”</p> \n<h3>No One Talks</h3> \n<p>One of the reasons I like to be prepared with a set of questions is that sometimes it can be hard to get the feedback flowing with certain teams. I tend to think that’s not a great sign about the feedback culture, but it can also just mean people are reserved and need help exploring the topic. This is also why I like to start with neutral/factual questions that everyone can feel good about answering, like “How often do you have 1:1s?”</p> \n<h3>Only a Subset of People Talk</h3> \n<p>Often, teams contain natural leaders aside from their manager, which can lead to interesting dynamics wherein those people can try to steer the conversation on the moderator’s behalf. Reminding the group that the guidance needs to be based on feedback from the whole team can help keep these people from dominating the conversation.</p> \n<h3>The Group Is Too Big/Too Small</h3> \n<p>So far at SoundCloud, I’ve run this process for five managers, and the groups attending the sessions have varied in size from three people to seven people. That’s probably a good range, as with only two people, it’s very obvious when collecting the feedback that it’s going to be directly attributable. I would consider 1:1 interviews in such a case.</p> \n<p>With a larger group, it’s more difficult to manage the collection of the feedback and make sure every voice is heard. Running multiple sessions to cover the full group is a good alternative in this case. This can happen naturally if the team structure already implies a way to split the group — for example, backend and frontend engineers.</p> \n<h3>The Process Blocks Direct Feedback</h3> \n<p>One risk that a previous team member of mine called out is the possibility that people lean on this process as a way to avoid giving direct feedback to their manager. This is valid, and it’s one of the reasons why Kim recommends not running the process too frequently. In the <em>Radical Candor</em> book, she suggests once a year, but I personally think twice a year will be fine for us, since we have rather dynamic teams and the managers on my team are keen to have more frequent check-ins.</p> \n<p>I haven’t personally run a follow-up session with a team before, but a key part will be to discuss how successful the manager’s attempts to address the previous feedback have been. Additionally, I would want to find out if there is any change in how confident people feel about giving direct feedback to their manager.</p> \n<h3>Some People Can’t Make It</h3> \n<p>It can be difficult to schedule the sessions so everyone can make it along, and there are always going to be situations, like sick days, that mean the whole team can’t get together at the same time. When this has happened for sessions that I’ve run, I have shared the notes with the people who couldn’t make it and asked them if they had anything to add. If they did, I asked them if they either wanted to provide those as written notes, or if we should meet face to face to discuss. I also make sure this is all completed ahead of the review session with the manager.</p> \n<h3>Bad Notes</h3> \n<p>The notes are a key output of the process, so the time taken during the session to review them is critical. Whenever I’ve run these sessions, we’ve found ambiguities or confusing language that we’ve been able to correct as a group. It really makes a big difference to how much the manager can get from the process if they can refer back to these notes and get a clear reminder of what they need to address.</p> \n<h2>Conclusion</h2> \n<p>A few years ago, Google published some amazing research on the key dynamics that set successful teams apart from other teams at Google. By far, the most important element of this was <a href=\"https://medium.com/@marcvollebregt/why-psychological-safety-is-essential-for-your-teams-success-fa9d43903a39\">Psychological Safety</a>, which they defined as: “Team members feel safe to take risks and be vulnerable in front of each other.”</p> \n<p>A healthy feedback culture is fundamental to establishing this Psychological Safety, and my experience with using Kim Scott’s Manager Guidance approach is that it can really make a positive difference in that culture. If you’re a manager, why not ask your manager to run this process for you? I’m really looking forward to hearing the feedback that comes from mine!</p>","descriptionType":"html","publishedDate":"Fri, 15 Feb 2019 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/1e36bb105d9a2786ae2026815a271763/e2288/radical-candor.jpg","linkMd5":"ee2a8acede8ba9fdc374f89c5d30736e","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn34@2020_2/2020/08/25/00-49-38-253_b49d72e489cab77e.webp","destWidth":640,"destHeight":703,"sourceBytes":19284,"destBytes":21610,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/1e36bb105d9a2786ae2026815a271763/e2288/radical-candor.jpg":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn34@2020_2/2020/08/25/00-49-38-253_b49d72e489cab77e.webp"},"publishedOrCreatedDate":1598316569973},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Integration Testing for Memory Leaks","link":"https://developers.soundcloud.com/blog/integration-testing-for-memory-leaks","description":"<p>We write a lot of unit tests while working on the SoundCloud iOS application. Unit tests are obviously great. They’re short, they’re (hopefully) easy to read, and they give us confidence that the code we ship works as expected. But unit tests — as their name suggests — only tend to cover a single unit of code, most often a function or class. So how do we catch the bugs that exist in the interactions between classes — bugs like memory leaks?</p> \n<h2>Memory Leaks</h2> \n<p>Memory leaks in Swift can be tricky to catch. There’s the more obvious case of a non-weak delegate reference, but then there are those that are slightly more difficult to spot. Is it obvious, for example, that the following code could contain a memory leak?</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\">\n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UseCase</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">weak</span> <span class=\"token keyword\">var</span> delegate<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UseCaseDelegate</span><span class=\"token operator\">?</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> service<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Service</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>service<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Service</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>service <span class=\"token operator\">=</span> service\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        service<span class=\"token punctuation\">.</span><span class=\"token function\">makeRequest</span><span class=\"token punctuation\">(</span>handleResponse<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">handleResponse</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">:</span> <span class=\"token builtin\">ServiceResponse</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// some business logic and then...</span>\n        delegate<span class=\"token punctuation\">.</span><span class=\"token function\">operationDidComplete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>Since the <code class=\"language-text\">Service</code> is injected, there are no guarantees about how it behaves. By passing in the private <code class=\"language-text\">handleResponse</code> function, which, although it isn’t necessarily immediately obvious, captures <code class=\"language-text\">self</code>, we are providing the <code class=\"language-text\">Service</code> with a strong reference to the <code class=\"language-text\">UseCase</code>. If the <code class=\"language-text\">Service</code> chooses to hold that reference — and we have no guarantee that it won’t — then we have a memory leak. But it’s not obvious from scanning the code that this could happen.</p> \n<p>There’s already <a href=\"https://www.swiftbysundell.com/posts/using-unit-tests-to-identify-avoid-memory-leaks-in-swift\">a great post by John Sundell</a> on using unit tests to catch memory leaks in a single class. But with examples like the one above, which are so easy to miss, it’s not always clear that you need to write such a unit test. (We’re certainly not speaking from experience here. 😬)</p> \n<p>Moreover, one of the signs of a good test suite is achieving the most valuable amount of coverage with as few – short! it doesn’t count if you put all your asserts in one giant test – tests as possible.</p> \n<p>As Guilherme wrote in <a href=\"https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture\">his recent post</a>, new features in the SoundCloud iOS application are written following “clean architectural patterns” — most commonly some variation of VIPER. Most of these VIPER modules are constructed using what we call a <code class=\"language-text\">ModuleFactory</code>. This <code class=\"language-text\">ModuleFactory</code> takes some inputs — injected dependencies and configuration — and produces a <code class=\"language-text\">UIViewController</code>, which is already hooked up to the rest of the module and can be put onto the navigation stack.</p> \n<p>Within a given VIPER module, there can be multiple delegates, observers, and escaping closures, each of which has the potential to cause the entire screen to stick around in memory after it’s been removed from the navigation stack. As this happens, the memory footprint will grow, and the operating system may well decide to terminate the application.</p> \n<p>So is it possible to cover as many of these potential leaks as we can while writing as few unit tests as we can? If not, this entire setup has been a huge waste of time.</p> \n<h2>Integration Tests</h2> \n<p>The answer, as the title of this post might have suggested already, is yes. And we do this with integration testing. The goal of an integration test is to check how objects within a group interact with each other. Certainly our VIPER modules are groups of objects, and memory leaks are one form of interaction we definitely want to avoid.</p> \n<p>Our plan is simple: We’re going to use our <code class=\"language-text\">ModuleFactory</code> to instantiate the entire VIPER module. We’ll then drop the reference to the <code class=\"language-text\">UIViewController</code> and make sure that all of the important parts of the module are destroyed alongside it.</p> \n<p>The first problem we have is that, by design, we can’t easily access any part of our VIPER module aside from the <code class=\"language-text\">UIViewController</code>. The only <code class=\"language-text\">public</code> function on our <code class=\"language-text\">ModuleFactory</code> is <code class=\"language-text\">func make() -&gt; UIViewController</code>. But what if we added another entry point just for our tests? This new method would be declared <code class=\"language-text\">internal</code>, so we’d only be able to access it by <code class=\"language-text\">@testable import</code>-ing the framework our <code class=\"language-text\">ModuleFactory</code> lives in. It would return references to all of the most important parts of the VIPER module, which we could then hold weak references to in our test. That ends up looking like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\">\n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ModuleFactory</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Some properties &amp; init code, and then...</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function\">make</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">UIViewController</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">makeAndExpose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>view\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">typealias</span> <span class=\"token builtin\">ModuleComponents</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n        view<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span><span class=\"token punctuation\">,</span>\n        presenter<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Presenter</span><span class=\"token punctuation\">,</span>\n        <span class=\"token builtin\">Interactor</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Interactor</span>\n    <span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">makeAndExpose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">ModuleComponents</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Set up code, and then...</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n          view<span class=\"token punctuation\">:</span> viewController<span class=\"token punctuation\">,</span>\n          presenter<span class=\"token punctuation\">:</span> presenter<span class=\"token punctuation\">,</span>\n          interactor<span class=\"token punctuation\">:</span> interactor\n      <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>This solves the problem of not being able to directly access these objects. Obviously, this might not be perfect, but it suits our needs, so let’s move on to actually writing the test. Something like the following should work:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\">\n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ModuleMemoryLeakTests</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">XCTestCase</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// We need a strong reference to the view. Otherwise, the entire</span>\n    <span class=\"token comment\">// module will be destroyed immediately.</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> view<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span><span class=\"token operator\">?</span>\n    <span class=\"token comment\">// However, we want to hold weak references to the</span>\n    <span class=\"token comment\">// other parts of the stack, so as to mimic the behavior</span>\n    <span class=\"token comment\">// of UIKit presenting our UIViewController onscreen.</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">weak</span> <span class=\"token keyword\">var</span> presenter<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Presenter</span><span class=\"token operator\">?</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">weak</span> <span class=\"token keyword\">var</span> interactor<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Interactor</span><span class=\"token operator\">?</span>\n\n    <span class=\"token comment\">// In the setUp method, we instantiate the ModuleFactory and</span>\n    <span class=\"token comment\">// call our makeAndExpose method. We need to make sure we</span>\n    <span class=\"token comment\">// don't accidentally hold on to the returned ModuleComponents</span>\n    <span class=\"token comment\">// tuple, as it contains strong references to all parts of the stack.</span>\n    <span class=\"token comment\">// Doing so would clearly interfere negatively with the test.</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">setUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">setUp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> moduleFactory <span class=\"token operator\">=</span> <span class=\"token function\">ModuleFactory</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* mocked dependencies &amp; config */</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> components <span class=\"token operator\">=</span> moduleFactory<span class=\"token punctuation\">.</span><span class=\"token function\">makeAndExpose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        view <span class=\"token operator\">=</span> components<span class=\"token punctuation\">.</span>view\n        presenter <span class=\"token operator\">=</span> components<span class=\"token punctuation\">.</span>presenter\n        interactor <span class=\"token operator\">=</span> components<span class=\"token punctuation\">.</span>interactor\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// If the test passes, this tearDown step won't actually be necessary,</span>\n    <span class=\"token comment\">// but we should definitely be covered in case the test fails, in order to stop</span>\n    <span class=\"token comment\">// the tests themselves from leaking memory.</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">tearDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        view <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span>\n        presenter <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span>\n        interactor <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">tearDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">test_module_doesNotLeakMemory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// We start by ensuring all of the references are non-nil.</span>\n        <span class=\"token comment\">// This is required to diagnose false positives, e.g.</span>\n        <span class=\"token comment\">// if we failed to correctly assign the variables in the setUp stage.</span>\n        <span class=\"token function\">XCTAssertNotNil</span><span class=\"token punctuation\">(</span>presenter<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">XCTAssertNotNil</span><span class=\"token punctuation\">(</span>interactor<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\">// Now we remove our strong reference to the view.</span>\n        <span class=\"token comment\">// If everything is set up correctly, this is the only</span>\n        <span class=\"token comment\">// strong reference to the entire stack, so everything</span>\n        <span class=\"token comment\">// else should disappear alongside it.</span>\n        view <span class=\"token operator\">=</span> <span class=\"token constant\">nil</span>\n\n        <span class=\"token comment\">// Finally, we check that the weak references to the</span>\n        <span class=\"token comment\">// Presenter and Interactor instances are now nil.</span>\n        <span class=\"token comment\">// This ensures that these components, and any of their</span>\n        <span class=\"token comment\">// own subcomponents, are free of memory leaks.</span>\n        <span class=\"token function\">XCTAssertNil</span><span class=\"token punctuation\">(</span>presenter<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">XCTAssertNil</span><span class=\"token punctuation\">(</span>interactor<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>So there we have it, a simple way to catch memory leaks throughout an entire VIPER module. It’s by no means perfect, and it requires some custom work for each new module we want to test, but it’s certainly a lot less work than writing individual unit tests for every possible memory leak. It also helps catch memory leaks you might not even realize are possible. In fact, after writing a few of these tests, we found we had one that we just couldn’t make pass, and after some investigation, we discovered a small memory leak in the module. (It bears repeating: 😬.)</p> \n<p>This also gives us a starting point for writing a more general suite of integration tests for the module. After all, if we simply keep a strong reference to the <code class=\"language-text\">Presenter</code> and replace the <code class=\"language-text\">UIViewController</code> with a mock, then we can fake user input by calling methods on the presenter and make assertions on output by checking the mocked <code class=\"language-text\">View</code>. Maybe we’ll have more on that in a future post.</p> \n<p>For now, let’s all celebrate this step toward a memory-leak-free future. 🙌</p> \n<p>(n.b. This post was written while listening to <em>Whatever You Love, You Are</em> by Dirty Three, <a href=\"https://soundcloud.com/dirty-three/sets/whatever-you-love-you-are-1\">which you can listen to on SoundCloud</a>.)</p>","descriptionType":"html","publishedDate":"Fri, 23 Nov 2018 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"f2169931152a22967b758762563626f8","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569974},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Introducing the CloudSeeder Devkit","link":"https://developers.soundcloud.com/blog/introducing-the-cloudseeder-devkit","description":"<p><em>Today we’re featuring a guest post from our friends at <a href=\"http://retronyms.com/\">Retronyms</a>. They’ve built some amazing community features into their app <a href=\"http://itunes.apple.com/us/app/tabletop/id436080882?mt=8\">Tabletop</a> using the SoundCloud API and have open sourced their CloudSeeder Devkit. This post was written for us by David Shu. David is a software engineer at the Retronyms and has worked on a number of iOS apps, including Tabletop and Dokobots. He currently resides in San Francisco, CA.</em></p> \n<p>We recently built a SoundCloud-powered community into our app <a href=\"http://itunes.apple.com/us/app/tabletop/id436080882?mt=8\">Tabletop</a>, a modular audio environment for the iPad, using the <a href=\"https://github.com/soundcloud/CocoaSoundCloudAPI\">CocoaSoundCloudAPI</a>. The project, CloudSeeder, lets users browse, stream, favorite, and comment on Tabletop tracks without ever leaving the app.</p> \n<p>As developers, we discovered tons of talented users in our Tabletop community. At the same time, our users found inspiration from each other and a new showcase for their creations. To share in the excitement of community creation with all developers, today we’re releasing the CloudSeeder Devkit as open source on <a href=\"http://code.google.com/p/cloudseeder/\">Google Code</a>.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 560px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/26291617b09e9b7665fb652c80924386/02744/cloudseeder.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABiElEQVQoz51RPU/CUBR1djBx9se4+B/0L+hgcHDQQWUycdBodDDRxInoosKCxEkiMRoDCqYSQkoMpWBpH699ny0g3kKMoi2DJ+e9vI977r3vvDEWBMFZryM/2rLrCWBbcsn537CxnxtKmSu4bjlzsfxSophSGvcVc+FCmY3lKwaGKwgIFUNyTKhlk0RBn4ymx9duJjbSU5uZ3XTFIXRUZdrvtuXQ+XNl8fJ1+ig3c5xbviqXDbvXlTzodb/b9iQvaOjkTl3P4rgmDSYRFYwGOjMsFn2Cvtd1KeepmnwwRIf7UvALUvM+AsRwhgir2X4sDMKYahHVJD1PwFuAbcGwbRPHx5AYCpqEXetiv+w+mxwaPat6B4+N+JOmI+c0q8WymlJtIssyTRNj/C2GUmBI3WYpXW6X3K2ie6h60Rexk3mLxIuRRHE1WVpJlvZuK3XkuELQwLZryAG+I1w1sdFy9CbSDKtu2apFgTr2/4KHGzZwlg4W3P88fwanwD/C+Ci3w8C/+B9xGD4B22nKjRJ46SYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"CloudSeeder\" title=\"CloudSeeder\" src=\"https://developers.soundcloud.com/blog/static/26291617b09e9b7665fb652c80924386/02744/cloudseeder.png\" srcset=\"/blog/static/26291617b09e9b7665fb652c80924386/9ec3c/cloudseeder.png 200w,\n/blog/static/26291617b09e9b7665fb652c80924386/c7805/cloudseeder.png 400w,\n/blog/static/26291617b09e9b7665fb652c80924386/02744/cloudseeder.png 560w\" sizes=\"(max-width: 560px) 100vw, 560px\" loading=\"lazy\" /> </a> </span></p> \n<!-- more --> \n<h2>What does CloudSeeder do?</h2> \n<p>Let’s run through a typical scenario using Tabletop as an example. When you start up an app with CloudSeeder integrated, you’ll get an at-a-glance view of the latest community happenings including app news, latest track posted, and likes and comments on tracks you’ve uploaded. When someone makes a cool new track, everyone who launches the app gets notified immediately in their feed.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 514px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/315aa8eedac07b15f8d8b8145399d2c0/a5a7c/cloudseeder_headline.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 74.90272373540856%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAAC5UlEQVQoz2WSz2sTQRTHZ38ku2l+zG6yP5JsNjHpbn42yWY3uzZtkzYxrWma2GJSBKEiKF7sRQ9S8FLb3lRUWqltERTEg+BNEW8i1YN3K+j/YRA9OCGkUhw+83jMvMf3zZsHKpVKu92enZ1ttVrNZvNsc2GuuYDs/EJrob1YnqlVJ2umZRqWURovjf9bfR+EQiFVVWVZjkQi0WgsJonRABcJ8BE/HwuKPta2Xr315sJr3sPZbKSDommKOgYoipLL5crlcrVaLWQzqbUXE9uf6w/e1++9RTa3/SXfuNRVGgGnCAAgAIYDcAxAspIkjY6OKooqS8HQ3Eps+Ubi/Gqicz3eWZU7N2PmlJ3sR5IYRpwEIM1ut4sevLS01Ol0KlbByqhWNjmglE2Mm4bH5caQ7P/J8XjcMIx8Pq9pmq7ryXRGiSfVRDKmqEMUB0Xhw+QTZXNeloEeLwsDfoHzeUmSQIc4hkGPG12gKwa6Rxz0UA2EZTmJVjyuKgpgxQgXjHFSTJAVZJ2sn3L7aMhDQWbEMAIKYYZhjpWTCdUs6oau6YU8MDa/mVsDjoqbR9rm99xGH33jCFG489XY+uFXzf6bcYLE8XQqYZl60dBMQwPTe72ZvV5tv1c/6J056Jk7vwo7v42d31O7vfKT3tTuz8r+n0B6EgyTM+mkZRnFYsE0dcBkm1xh0TeEL5zzZufZsQbMzMNMw5NpoAAhIA+6bSOIsXTS1DJ6LpUfSwGJh6eCPjXilzhIAYAYxIled4CHfs7j5yBqqh0HdgKjSSynaaWLV63llfbla8BO0XaKslH9De1OSLnpERftYRxu1GgvZH1uhhUF3kFgIzbcZcNzpjW5dn956/G7D4dAFEU03uFwOBqNsixL4DhJknanSwwEQyE08nIwKIk8qopAMHbMrEw37z678uj5x8NPAH2DIAg8z4uigHw07qgWyuWBXo5H54Lg43jJj6TJPjRxulafWN9v3H749OWrv1oOmlg+D9mqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"CloudSeeder Headline view\" title=\"CloudSeeder Headline view\" src=\"https://developers.soundcloud.com/blog/static/315aa8eedac07b15f8d8b8145399d2c0/a5a7c/cloudseeder_headline.png\" srcset=\"/blog/static/315aa8eedac07b15f8d8b8145399d2c0/9ec3c/cloudseeder_headline.png 200w,\n/blog/static/315aa8eedac07b15f8d8b8145399d2c0/c7805/cloudseeder_headline.png 400w,\n/blog/static/315aa8eedac07b15f8d8b8145399d2c0/a5a7c/cloudseeder_headline.png 514w\" sizes=\"(max-width: 514px) 100vw, 514px\" loading=\"lazy\" /> </a> </span> <em>Tabletop displaying the Headline view in the upper left hand corner. All the headline items are cycled through with a nice animation and you can size this view to suit your UI.</em></p> \n<p>Tapping on the Headline will bring you to the CloudSeeder community. The Main view will slide up, showing you News, Featured Tracks, Popular Tracks, Latest Tracks, My Uploads, My Activity, and Following. CloudSeeder filters all the tracks for you (using the <code class=\"language-text\">\"created_with\"</code> property, for those of you familiar with the SoundCloud API), so all the tracks and activities you see will be specific to your application.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 512px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/b8afee81a2778887287217fac298be28/c5a17/cloudseeder_main.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD2ElEQVQ4yz2UfUxVZRzHT7hBvL/LICJBIYcXGOF8CampyeUiFCrTPzDXhivXgpZQWBNnaKu1Gk56waWYuOZWrdVmEEVrbRpbZZQzc4HA5cLlwuW+v5x77tun5xzMZ+e3Z/udPd/n+/v9vt9H0unKKVmTR0FuJgU5qdRUb6WhoQF9bS3Nzc20t7fT2tpKW9tLtItQc3q9HoPBQF2dGnr0hkZajg6wvrwaKSu/hNzHnyW5rAlpTT2fff0jXo+LaaMJ84IFj9tNKBTizxu/MTo8gs/vR5ZlFEVBDigQVhie9NB5PUhh5RNIDz26heIDn1B68CIxO/v4/IebRIJ+XL4AshIkEomgLrfHw+T0LNblZfwC0OfzifCKC2SWHW4ccoTqmu1IaWkZrHskj7UFeUiSxLm+9/G6XSzZXThdHkJBARqNEpD9GM02bEuLuGzLzJlM/HPXyF+zNm5PTrNgsbBjx1NISSnpbNigo6hoLTGrVtH9Zi8zpiVcAtThdOL1ejWG18dv0dF/mb6Rn3m+7yIj18bAMUt4/g5R09/gt1Nbt1swTElBp9PxcH4eMQ9I9Jx6B6NpAbvbh93pweVZAbxwdZRNnac5/s0oLX2XOPvpIPLQB5gudTP74RHk369iaNyLlFmyjcLCImKTs7WSBy6cE71x4nTYCHjsAkrRAK8Mj5Kz/0Wu/HKDJ4+e5I3BIY79AS/8FEA/FOL8XdjXKBhmVTaRk5FK2/YsSvMT2dPRx/EhF698q3DwSz8tX/g4MgwdH39H+uZaDvWcIa5qFyfPf0WvqPT0mJvuax6+n4c9jQ1IcQnJVBYXMNKxDkNVOqVPv01Vl5GKHi+ZHU7i2hxIhx2cHV7i1p1/+XX8JmPjt0WfzYJ3VHxRopGwVsXuegGYkJRKRZmOqo0byc7K5KP+AUxmBxNGK2aLA6vVLQakEApHsZjNOGw27XBQaDMoFKBqNKCEtFxjQ+MKYG5hMZVbthGfvpr+3vcI+d1CgwIkFBQMwlpEBIuZu5NYhNhVUa9EUNt9geAKoL5WyCYxicM16znWVM1zW4sYfPctFk3zWIVY7U6XGJBfO6gKfGZqCuuSVbALauyiolx1yfcY7tMLHWakpfHyY8lcPrSJ1zencebUCWaMc8IZXs0dqg610sJh7ItGnE47gUBAyylaFaH7gPsNu5BiY+OJSUihfu8BMaEkujpfxTQ7h0dW8AeU+4dUQLfVIlzk1qz3f//CIq8EV4bSXCcYPhifqA2joryMnNXZnOh6jamJCZZsTuFbG4pgo9pP3WXh38C9h0EDUy8KhrR/6nqmdif/AS8teLQXeIFOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"CloudSeeder Main view\" title=\"CloudSeeder Main view\" src=\"https://developers.soundcloud.com/blog/static/b8afee81a2778887287217fac298be28/c5a17/cloudseeder_main.png\" srcset=\"/blog/static/b8afee81a2778887287217fac298be28/9ec3c/cloudseeder_main.png 200w,\n/blog/static/b8afee81a2778887287217fac298be28/c7805/cloudseeder_main.png 400w,\n/blog/static/b8afee81a2778887287217fac298be28/c5a17/cloudseeder_main.png 512w\" sizes=\"(max-width: 512px) 100vw, 512px\" loading=\"lazy\" /> </a> </span> <em>The CloudSeeder Main view showing the Featured Tracks tab.</em></p> \n<p>Curating Featured Tracks can be done in the app. When you point CloudSeeder to a SoundCloud user in the config file, all you have to do is “like” a track as that user and it automatically shows up in the Featured Tracks list! If you’re a user, nothing feels better than when the app creator features your track!</p> \n<h2>Integrating CloudSeeder into your app</h2> \n<p>If you’re ready to poke around CloudSeeder, you can head to the <a href=\"http://code.google.com/p/cloudseeder/\">Google Code project</a>. We had fast integration and easy customization in mind when developing CloudSeeder, so the repo contains source code and images for UI (including Retina!) that you can just drop into Xcode. You should be ready to go after adding <a href=\"https://github.com/soundcloud/CocoaSoundCloudAPI\">CocoaSoundCloudAPI</a>, filling out the config header file with a few SoundCloud details, and adding the CloudSeeder resources to your project.</p> \n<p>We also added a couple new features to the upload process. If you register for the upload notification, you can add tags, description, and BPM to the track metadata. For example:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\"> \n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token comment\">// Register for the share notification</span>\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>NSNotificationCenter defaultCenter<span class=\"token punctuation\">]</span>\n    addObserver<span class=\"token punctuation\">:</span><span class=\"token keyword\">self</span>\n       selector<span class=\"token punctuation\">:</span><span class=\"token keyword\">@selector</span><span class=\"token punctuation\">(</span>soundCloudShareWillShow<span class=\"token punctuation\">:</span><span class=\"token punctuation\">)</span>\n           name<span class=\"token punctuation\">:</span>kCSShareViewControllerWillShowNotification\n         object<span class=\"token punctuation\">:</span>nil<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n<span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>soundCloudShareWillShow<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span>NSNotification <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>notification <span class=\"token punctuation\">{</span>\n    CSShareViewController <span class=\"token operator\">*</span>shareVC <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>CSShareViewController <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>notification object<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Add tags, description, bpm to track metadata</span>\n    <span class=\"token punctuation\">[</span>shareVC setTags<span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span>NSArray arrayWithObjects<span class=\"token punctuation\">:</span><span class=\"token string\">@\"TABLETOP\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">@\"CloudSeeder\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">@\"bunnies\"</span><span class=\"token punctuation\">,</span> nil<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">[</span>shareVC setDescription<span class=\"token punctuation\">:</span><span class=\"token string\">@\"Created with Tabletop for iPad\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">[</span>shareVC setBPM<span class=\"token punctuation\">:</span><span class=\"token function\">getTempo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<h2>Be a part of CloudSeeder Select</h2> \n<p>CloudSeeder has one more trick up its sleeve to benefit developers: cross promotion. Apps that are a part of CloudSeeder Select get featured across all other CloudSeeder Select apps. When users check out their Featured Tracks list, one track out of that list will be a featured track from another fellow CloudSeeder app. Tapping on that track will show the usual track view, along with a section promoting that app.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 512px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/f714bfe686c46edd22b8be909f62f905/c5a17/cloudseeder_select.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADvUlEQVQ4y02TeWxUVRSHH1HRbtMWSqstFiwUNUxpao0LljY12ukyQwWnhqohJDXxL0oVAyJRCi7Fpv9ANKKGIppqpEI0xgYbqhhbJNFGRQqWLmCn6+wzb/Z58z7vexOqJzl5995373d/59xzJGPJBopX51N413IK8zLZ9NijNJgtmEwmmpqstLW10dLSQmtrq+5Wq5Xa2lrq6upobKhlc30NjRYLL+49zv2lG5Fy7n2Ygk07MJRYkIrNfNLzNXOTY8zanczOzbGwME8ikWBgYICT3d3IsozT6SQUCtH5q5/2IS+vD3o4ellhY0UV0krTHtY1H8O4/Ti31hzhzLk/UcMy/lCUcDRGPB5HMw1+aeSqDtKgwWCQ4WmZIVuIwes+/nYrVFZVI2Xmr2PtqnzWFOYjSRJHuzrwej3Y3X7cXr8OUBMKcjjKyLyMy2nHIRTabFP8MzrC1PQsM+NXcM9NUf34EwJoMLDeWELRmrUsEcB93d9x3gG/3PAw4VdxRVTCCkxPz3Dio5OcOd3Ht198xYXBi9iCMOoIcdURxhND5LYOKS0jC6NxPYV3r9QVdvb08YcXhm84mPLF8EUUwiLk7/vPY654kq5DnRzZv5cTX37Dgd+h5ZyPzX1+eibhKXMDkiFrGfcUFbE0Y7kALqGr/SC2sTGcHh8ul5uEkszhpaEfONRSx+kPOnjv5ef5vPcU+3+D3T96sPZ5+WwctloEMCU9k7xlWeysLuC+AgMH3z6Mw+FADoaIxRXxwooOHP65n9e2VdDZ2sSBbZWc6u2l8zJ0XPTzxgWZ/lnYYjEj3ZaSQVnxKs7uLqWmLI9dr+xjYnISt08mGkuq08zv93Fl/DqTo39x7do15ufnxaoqHiyhP5pmDfUCmJZuoLTESPmD5eTmruCd9jeZts3g9QeIiLJRVVUvHUUcdNsX8Hm9xBRVzFW9PrX/4WjyYotoCOn2O1IpKCqm7JEKUrJzOPb+xwTkIAFRJnElIUSIw4oiwo/jd8wRCshEIhEddNMjsaRCs6kGKTsrmxcqjby6pZLnylfz08BZEQjYnW5Rhz4dpinRVDpcLgKB4CJIW9dcy7VmT5tEHRrS02l9IJdPt1ex56E7+bDrXewOF26Pl3A4om/UFcZiYh7Wx7qp6uI3pkUizKoBU1LTuSXNQP3WZ5CWpvBW+2HRDR7RepHFm3UVAnjTVP4zXW0iCWxuFDlMFcDcnBxKN5SQuyKHl3btZGJiQoTsET0b0DdHo1GiIm9xAU16/H/jmPgX1YE7nm3mX4GMiUaAr9BeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"CloudSeeder Select\" title=\"CloudSeeder Select\" src=\"https://developers.soundcloud.com/blog/static/f714bfe686c46edd22b8be909f62f905/c5a17/cloudseeder_select.png\" srcset=\"/blog/static/f714bfe686c46edd22b8be909f62f905/9ec3c/cloudseeder_select.png 200w,\n/blog/static/f714bfe686c46edd22b8be909f62f905/c7805/cloudseeder_select.png 400w,\n/blog/static/f714bfe686c46edd22b8be909f62f905/c5a17/cloudseeder_select.png 512w\" sizes=\"(max-width: 512px) 100vw, 512px\" loading=\"lazy\" /> </a> </span> <em>CloudSeeder Select: Cross promote your app to users in other CloudSeeder apps! A banner on top of the Track view shows the cross promoted app’s details.</em></p> \n<p>A simple email with an icon image and some information on your app will get you in and ready for cross promotion. Find out the details in the <a href=\"http://code.google.com/p/cloudseeder/\">documentation</a>.</p> \n<h2>Get CloudSeeder!</h2> \n<p>So if you’re the proud developer of an iPad audio app, get the devkit from the <a href=\"http://code.google.com/p/cloudseeder/\">Google Code project</a>, see CloudSeeder in action with <a href=\"http://itunes.apple.com/us/app/tabletop/id436080882?mt=8\">Tabletop</a>, and check out the <a href=\"https://soundcloud.com/groups/cloudseeder\">CloudSeeder SoundCloud group</a>. Thanks!</p>","descriptionType":"html","publishedDate":"Mon, 13 Aug 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/26291617b09e9b7665fb652c80924386/02744/cloudseeder.png","linkMd5":"b3608559289da9cd03cfefee1a744b37","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn41@2020_2/2020/08/25/00-49-38-528_4d5af186b6679960.webp","destWidth":560,"destHeight":372,"sourceBytes":6717,"destBytes":12870,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/26291617b09e9b7665fb652c80924386/02744/cloudseeder.png":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn41@2020_2/2020/08/25/00-49-38-528_4d5af186b6679960.webp","https://developers.soundcloud.com/blog/static/315aa8eedac07b15f8d8b8145399d2c0/a5a7c/cloudseeder_headline.png":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn77@2020_2/2020/08/25/00-51-40-777_9762769d154d4982.webp","https://developers.soundcloud.com/blog/static/b8afee81a2778887287217fac298be28/c5a17/cloudseeder_main.png":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn19@2020_5/2020/08/25/00-51-44-973_600c18ece2f1779d.webp","https://developers.soundcloud.com/blog/static/f714bfe686c46edd22b8be909f62f905/c5a17/cloudseeder_select.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn2@2020_2/2020/08/25/00-51-42-963_f30dcdccdd556a55.webp"},"publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Technical Interview Reform, Part 1: Rethinking the Backend Engineering Interview Take-Home Challenge","link":"https://developers.soundcloud.com/blog/rethinking-the-backend-code-challenge","description":"<p>Most SoundCloud backend engineers have good feelings about the old backend engineering take-home challenge. It’s commonly been characterized as a fun, thought-provoking coding problem.</p> \n<p>However, most of us took a significant amount of time to complete it. In fact, reports of having worked on it for 12 hours or more, over a timespan of two or more weeks, are not uncommon to hear. Candidates coming through the hiring process reported in feedback to their recruiters that they were straining under the time burden, and we clearly saw this reflected in the form of a significant dropoff at this stage in our hiring pipeline data.</p> \n<p>This makes intuitive sense: Many great candidates have good jobs and busy personal lives. We want to talk to as many qualified candidates as possible, but to do that, we need to minimize the chances that our interview process itself gets in the way.</p> \n<p>As a result, engineering management challenged engineers and recruiters to improve the situation. We set out to patch the obvious problems, but we ended up comprehensively rethinking the backend engineering take-home challenge.</p> \n<h2>The Tryout</h2> \n<p>The ability to compose, change, and critique programs is only one dimension of an engineer’s job — but it’s an essential one. Similar to an orchestra or acting audition, we use the take-home test to get an initial sense of how a candidate performs. We judge the performance with respect to what we believe it takes to be successful as an engineer in this organization.</p> \n<p>The form a “code tryout” should take is a hotly debated topic, in our view, partly because contextual factors heavily constrain the format possibilities. It’s clear to us that there’s no one ideal answer that fits all engineering organizations.</p> \n<p>The <strong>take-home challenge format</strong> has historically been a natural fit for SoundCloud for a couple of key reasons:</p> \n<ul> \n <li>We hire engineers from all over the world, so the decision to bring a candidate onsite means there’s a significant time investment to be made by both the candidate and SoundCloud. While the onsite is certainly no guarantee of an offer, a key goal is to maximize the odds that candidates brought onsite will excel and get an offer.</li> \n <li>This format presents a unique opportunity — and in the very first stage of a candidacy — to eliminate unwanted bias in evaluating candidate performance. We treat the take-home challenge as a kind of <a href=\"https://en.wikipedia.org/wiki/Blind_audition\">anonymous audition</a>, and we do our best to ensure reviewers do not have any knowledge of irrelevant personal attributes of a candidate when judging submissions.</li> \n</ul> \n<p>In addition:</p> \n<ul> \n <li>We want our initial evaluation of a candidate to be based on what they can do given more ideal conditions than short onsite coding interviews allow for.<sup id=\"fnref-1\"><a href=\"https://developers.soundcloud.com/blog/rethinking-the-backend-code-challenge#fn-1\" class=\"footnote-ref\">1</a></sup> This means having enough time to really concentrate and produce work they’re proud of. Candidates often report that this is a refreshing change when compared to industry norms.</li> \n <li>SoundCloud engineers who review submissions are more confident in their ability to be fair and consistent if they are able to compare and contrast work that is technically consistent from candidate to candidate over time. In part because the programming problems are consistent, experienced reviewers can productively “train up” those who are new to the review process.</li> \n</ul> \n<h2>Same Coding Problem, but Faster to Complete and Review</h2> \n<p>After much discussion, we guessed we could take the same problem, change the format a little, put some modest constraints on how the solution could be solved, and still get as good of an indication of a candidate’s likelihood to succeed in the onsite interview as we did with the old challenge.</p> \n<p>Here’s what we changed:</p> \n<ul> \n <li>Instead of building from scratch, it’s now a refactoring challenge plus a small feature extension. It comes complete with a tester program that passes “out of the box.” The candidate’s first goal is to keep that tester passing while making the code a lot better.</li> \n <li>Partly as a consequence, we offer the choice of selecting from six languages to solve the problem, with an emphasis on languages that are popular in the industry and academia. In the past, candidates could choose any language they wanted, but with a refactoring exercise, this is no longer possible.</li> \n <li>We decided to restrict solutions to using only the standard library for the chosen language.</li> \n <li>We revised instructions and READMEs to be more thorough and clearer in what our expectations are.</li> \n</ul> \n<p>This plan was motivated by a goal to reduce the burden on the candidate. But we quickly realized that reducing the burden on reviewers is almost as important. Efficient and consistent review means we can get back to candidates with a response more quickly — but it also opens up opportunities for us to be fairer.</p> \n<p>Each submission is evaluated by two people independently. They then meet up and file a “consensus review” signed off by both of them. But code review is a human activity, and reviewers will often end up in disagreement over a submission. When reviews are quick, it’s easy to pull in tiebreaker reviewers and still promptly get back to the candidate with a response.</p> \n<h2>Adding Pull Request Review</h2> \n<p>Inspired by Slack engineering’s <a href=\"https://slack.engineering/refactoring-backend-engineering-hiring-at-slack-b53b1e0e7a3c\">pull request-based challenge</a>, we decided to add a small PR challenge of our own to the backend engineering take-home challenge.</p> \n<p>PR review allows us to get some insight into how candidates give critique, and the additional code problem allows us to probe a couple other technical areas. In exchange for a modest amount of extra time to complete the code challenge, candidates get an important new channel through which they can show reviewers how they approach these important aspects of the day-to-day work in engineering.</p> \n<h2>Results</h2> \n<p>Please see <a href=\"https://developers.soundcloud.com/blog/backend-code-challenge-recruiting-perspective-and-results\">part 2</a> of this series for the recruiting take on the coding challenge reform, along with a report on both quantitative and qualitative results.</p> \n<h2>Further Reading</h2> \n<h3>General</h3> \n<ul> \n <li><a href=\"https://www.lihaoyi.com/post/HowtoconductagoodProgrammingInterview.html\">How to Conduct a Good Programming Interview</a></li> \n <li><a href=\"https://www.joelonsoftware.com/2006/10/25/the-guerrilla-guide-to-interviewing-version-30/\">The Guerrilla Guide to Interviewing</a></li> \n <li><a href=\"https://www.nytimes.com/2013/06/20/business/in-head-hunting-big-data-may-not-be-such-a-big-deal.html\">In Head-Hunting, Big Data May Not Be Such a Big Deal</a></li> \n</ul> \n<h3>Slack Engineering</h3> \n<p>We found the series of posts on technical interviewing from Slack Engineering to be particularly helpful:</p> \n<ul> \n <li><a href=\"https://slack.engineering/a-walkthrough-guide-to-finding-an-engineering-job-at-slack-dc07dd7b0144?gi=b349f6001b69\">A Walkthrough Guide to Finding an Engineering Job at Slack</a></li> \n <li><a href=\"https://slack.engineering/refactoring-backend-engineering-hiring-at-slack-b53b1e0e7a3c\">Refactoring Backend Engineering Hiring at Slack</a></li> \n <li><a href=\"https://slack.engineering/how-about-code-reviews-2695fb10d034\">How About Code Reviews?</a></li> \n</ul> \n<p>These prompted us to create our own form of a PR-based challenge.</p> \n<h3>SoundCloud History</h3> \n<ul> \n <li>Phil Calçado’s post, <a href=\"https://philcalcado.com/2016/03/15/on_asking_job_candidates_to_code.html\">On Asking Job Candidates to Code</a>, contains an excellent history of the SoundCloud coding challenge.</li> \n <li>Peter Vida described our <a href=\"https://developers.soundcloud.com/blog/engineering-levels\">engineering level system</a> in a past Backstage Blog post.</li> \n</ul> \n<h2>Thank You</h2> \n<p>Much of SoundCloud engineering, recruiting, and management contributed to this in some way. Big thanks go out to:</p> \n<ul> \n <li>Anya Voronova</li> \n <li>Ben Stahl</li> \n <li>Matthias Käppler</li> \n</ul> \n<p>We would also like to thank Slack Engineering for their time and advice as we built our version of the PR challenge, in particular:</p> \n<ul> \n <li>Chase Rutherford-Jenkins</li> \n <li>Maude Lemaire</li> \n <li>Will Kimeria</li> \n</ul> \n<div class=\"footnotes\"> \n <hr> \n  <ol> \n   <li id=\"fn-1\"> <p>You know the drill: You have 60 minutes, a web browser coding environment or whiteboard, the problem is straight out of an Algorithms and Data Structures class, and the interviewer mostly sits there in awkward silence. Some companies see such high-pressure conditions as a good thing. We don’t.</p> <a href=\"https://developers.soundcloud.com/blog/rethinking-the-backend-code-challenge#fnref-1\" class=\"footnote-backref\">↩</a> </li> \n  </ol> \n </hr> \n</div>","descriptionType":"html","publishedDate":"Thu, 25 Jun 2020 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"ddbc6d27c454862bda84be25b67d5189","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569968},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Shoot yourself in the foot with iptables and kmod auto-loading","link":"https://developers.soundcloud.com/blog/shoot-yourself-in-the-foot-with-iptables-and-kmod-auto-loading","description":"<p>As some of you might know, we had an outage yesterday. We believe that in every mistake there is something to learn from, so after each outage we are writing post-mortems. Usually we do this internally because the issues we run into are very specific to our infrastructure.</p> \n<p>This time we ran into a quite nasty issue which could affect everyone running a linux system with a lot sessions on it and we thought you might be interested to know about that pitfall.</p> \n<h2>What happened?</h2> \n<p>At 4:40pm CEST, we got reports about&nbsp;<code class=\"language-text\">Yikes</code>&nbsp;(503/504 errors) on SoundCloud. Around the same time, our monitoring alerted for a high amount of 503s at our caching layer and right after that one of our L7 routing nginx instances was reported down.</p> \n<p>We were still able to log into that system. dmesg showed:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">Aug 13 14:46:52 ams-mid006.int.s-cloud.net kernel: [8623919.136122] nf_conntrack: table full, dropping packet.\nAug 13 14:46:52 ams-mid006.int.s-cloud.net kernel: [8623919.136138] nf_conntrack: table full, dropping packet.</code></pre>\n</div> \n<p><em>N.B.: Our systems are set to UTC timezone</em></p> \n<p>That wasn’t expected. The first thought was: “Someone must have changed the sysctl tunings for that”. Then we realized that this system has no need for connection tracking, so&nbsp;<code class=\"language-text\">nf_conntrack</code> shouldn’t be loaded at all. As a quick contermeasure we raised <code class=\"language-text\">net.ipv4.netfilter.ip_conntrack_max</code>. This fixed that situation and brought the service back up.</p> \n<h2>Why did it happen?</h2> \n<p>After bringing the site back up, we investigated what caused the kernel to enable connection tracking. Doing a&nbsp;<code class=\"language-text\">lsmod</code>&nbsp;showed that connection tracking and iptables modules were actually loaded. Another look into dmesg revealed that right before the outage the&nbsp;<code class=\"language-text\">ip_tables</code>&nbsp;netfilter module was loaded:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">Aug 13 14:38:27 ams-mid006.int.s-cloud.net kernel: [8623415.007818] ip_tables: (C) 2000-2006 Netfilter Core Team\nAug 13 14:38:35 ams-mid006.int.s-cloud.net kernel: [8623422.444931] nf_conntrack version 0.5.0 (16384 buckets, 65536 max)</code></pre>\n</div> \n<p>So what happened? One of our enginners was doing some preparations for scaling that layer of our infrastructure. To verify we don’t use any specific iptable rules on that system, he did:</p> \n<p><code class=\"language-text\">iptables -L iptables -t nat -L</code></p> \n<p>Those commands themself are pretty harmless. They will just list configured iptables rules. The first one rules in the&nbsp;<code class=\"language-text\">filter</code>&nbsp;table, the second one in the&nbsp;<code class=\"language-text\">nat</code>&nbsp;table. Nothing which should change any system configuration, right? Nope. Let’s try to reproduce it. Just boot up some system (I’ve tried it on my Ubuntu Laptop). No iptables module should be loaded:</p> \n<p><code class=\"language-text\">root@apollon:~# lsmod|grep ipt</code></p> \n<p>Now just list your iptable rules:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">iptables -L\nChain INPUT (policy ACCEPT)\ntarget prot opt source destination\n\nChain FORWARD (policy ACCEPT)\ntarget prot opt source destination\n\nChain OUTPUT (policy ACCEPT)\ntarget prot opt source destination</code></pre>\n</div> \n<p>And check again for loaded modules:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">root@apollon:~# lsmod|grep ipt\niptable_filter 12810 0\nip_tables &nbsp; &nbsp; &nbsp;27473 1 iptable_filter\nx_tables &nbsp; &nbsp; &nbsp; 29846 2 iptable_filter,ip_tables</code></pre>\n</div> \n<p>Okay, that loaded some iptables module to make it possible to add filter rules via&nbsp;<code class=\"language-text\">iptables</code>. This shouldn’t cause any problems, since without any actual rules the impact on the kernel is negligible. But now check your nat table:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">root@apollon:~# iptables -t nat -L\nChain PREROUTING (policy ACCEPT)\ntarget prot opt source destination\n\nChain INPUT (policy ACCEPT)\ntarget prot opt source destination\n\nChain OUTPUT (policy ACCEPT)\ntarget prot opt source destination\n\nChain POSTROUTING (policy ACCEPT)\ntarget prot opt source destination</code></pre>\n</div> \n<p>Completely empty as well. But now look at your kernel modules:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\"> root@apollon:~# lsmod|grep ipt\n iptable_nat 13229 0\n nf_nat 25891 1 iptable_nat\n nf_conntrack_ipv4 19716 3 iptable_nat,nf_nat\n nf_conntrack 81926 3 iptable_nat,nf_nat,nf_conntrack_ipv4\n iptable_filter 12810 0\n ip_tables 27473 2 iptable_nat,iptable_filter\n x_tables 29846 3 iptable_nat,iptable_filter,ip_tables</code></pre>\n</div> \n<p>By just listing your iptable rules for the nat table, the kernel loaded&nbsp;<code class=\"language-text\">nf_conntrack</code>&nbsp;which enabled connection tracking. See dmesg:</p> \n<p><code class=\"language-text\">[75024.007681] nf_conntrack version 0.5.0 (16384 buckets, 65536 max</code></p> \n<p>On your Laptop you probably don’t care – it’s even quite convenient. On a production server that handles a large number of connections the fairly small default&nbsp;<code class=\"language-text\">nf_conntrack</code>&nbsp;table will overflow quite fast and cause dropped connections.</p> \n<h1>How do we prevent it?</h1> \n<p><code class=\"language-text\">iptables</code>&nbsp;doesn’t load the&nbsp;<code class=\"language-text\">nf_conntrack</code>&nbsp;itself, it only loads&nbsp;<code class=\"language-text\">ip_tables</code>&nbsp;which again loads modules it depends on via the kernel’s&nbsp;<code class=\"language-text\">kmod</code>&nbsp;facility.</p> \n<p>But since that module loader uses the modprobe user-space helpers like modprobe, the auto-loading process will honour&nbsp;<code class=\"language-text\">modprobe.d/</code>&nbsp;settings. Unfortunatelly there is no easy way to disable loading of a module altogether, but there is a workaround for that.</p> \n<p>Since we don’t need iptables at all on that system, we’ve created a /etc/modprobe.d/netfilter.conf like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\"> alias ip_tables off\n alias iptable off\n alias iptable_nat off\n alias iptable_filter off\n alias x_tables off\n alias nf_nat off\n alias nf_conntrack_ipv4 off\n alias nf_conntrack off</code></pre>\n</div> \n<p>This will make&nbsp;<code class=\"language-text\">modprobe</code>&nbsp;load&nbsp;<code class=\"language-text\">off</code>&nbsp;instead of the actual kernel module.</p> \n<p>Trying to run any iptables command now, should now give you now:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\">\n <pre class=\"language-text\"><code class=\"language-text\">iptables -t nat -L\nFATAL: Module off not found. iptables v1.4.12: can't initialize iptables table `nat': Table does not exist (do you need to insmod?) Perhaps iptables or your kernel needs to be upgraded.</code></pre>\n</div>","descriptionType":"html","publishedDate":"Tue, 14 Aug 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"54f2a9deb96e3b5289ebc0a5422260e0","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Desktop Sharing Kits for OS X and Windows","link":"https://developers.soundcloud.com/blog/desktop-sharing-kits","description":"<p>Last week we <a href=\"https://blog.soundcloud.com/2012/04/02/soundcloud-and-ableton/\">announced</a> a new integration with Ableton Live 8, that lets you easily share your sounds from within Ableton Live to SoundCloud. Today we’re making the technology behind that integration available to everyone through our new Desktop Sharing Kits.</p> \n<p><img src=\"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/mac-sharing-small.png\" alt=\"Mac Desktop Sharing Kit\" /></p> \n<!-- more --> \n<p>Similar to our iOS &amp; Android Sharing Kits, our Desktop Sharing Kits let you easily add “Share to SoundCloud” functionality to your Windows and OS X applications.</p> \n<p>They come as seperate executables for Microsoft Windows and Mac OS that you include in your application and invoke to let users share a sound to SoundCloud. The sharing kits take care of everything from there by providing a nice UI and handling the entire upload process.</p> \n<p>The kits are open sourced and available for download on GitHub (<a href=\"https://github.com/soundcloud/soundcloud-win-sharing\">Windows</a> and <a href=\"https://github.com/soundcloud/soundcloud-mac-sharing\">Mac</a>. We hope to enable some great integrations with this. Let us know what you think!</p>","descriptionType":"html","publishedDate":"Tue, 10 Apr 2012 00:00:00 +0000","feedId":10291,"bgimg":"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/mac-sharing-small.png","linkMd5":"a6e37251568015a3d74d9dafa4811dfa","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"author":"","articleImgCdnMap":{"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/mac-sharing-small.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg"},"publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Writing your own Karma adapter","link":"https://developers.soundcloud.com/blog/writing-your-own-karma-adapter","description":"<p><strong>Background</strong></p> \n<p>When we started to work on the new version of our mobile web app, we knew we wanted&nbsp;to run unit tests on a wide variety of clients, mobile devices, PhantomJS, and on Chrome when running locally. Because we practice continuous integration, we knew we also wanted Git hooks and proper results formatting.</p> \n<p>We chose Karma runner, which is a project from the <a href=\"http://angularjs.org\" title=\"Angular JS\">Angular JS</a> team that provides developers&nbsp;with a “productive testing environment”. One of the advantages that Karma runner offers&nbsp;over other similar projects is its ability to use any testing framework. At SoundCloud,&nbsp;we aim to have the same toolset across various JavaScript projects, and our&nbsp;unit test framework of choice is <a href=\"https://github.com/spadgos/tyrtle\">Tyrtle</a>.</p> \n<p><strong>Using Tyrtle</strong></p> \n<p>You can write your own Karma adapter by using the Tyrtle example that follows. The idea is to tie your tests to the Karma API. The pieces of information that you need are the number of tests, test suites or modules, the results of each test (with possible assertion or execution errors, or both), and a hook to let Karma know that the runner ran all of the tests.</p> \n<p>You also need to provide a start function that configures the unit test framework, loads the test files, and starts the tests.</p> \n<p>The basic template for an adapter is as follows:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">win</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token comment\">/**\n * Returned function is used to kick off tests\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createStartFn</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">karma</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Returned function is used for logging by Karma\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createDumpFn</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">karma<span class=\"token punctuation\">,</span> serialize</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// inside you could use a custom `serialize` function</span>\n  <span class=\"token comment\">// to modify or attach messages or hook into logging</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    karma<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dump<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nwin<span class=\"token punctuation\">.</span>__karma__<span class=\"token punctuation\">.</span>start <span class=\"token operator\">=</span> <span class=\"token function\">createStartFn</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>__karma__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwin<span class=\"token punctuation\">.</span>dump <span class=\"token operator\">=</span> <span class=\"token function\">createDumpFn</span><span class=\"token punctuation\">(</span>win<span class=\"token punctuation\">.</span>__karma__<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> value<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>Next, create a renderer/reporter for the unit test framework that will pass the data to Karma. Tyrtle has a renderer that can render HTML, XML for CI, or print to any other type of output.</p> \n<p>To pass the data to Karma, implement the methods that follow:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * Tyrtle renderer\n * @interface\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Renderer</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token class-name\">Renderer</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">beforeRun</span> <span class=\"token function-variable function\"> </span><span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">tyrtle</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Renderer</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">afterRun</span> <span class=\"token function-variable function\">  </span><span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">tyrtle</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Renderer</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">afterTest</span> <span class=\"token function-variable function\"> </span><span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">test<span class=\"token punctuation\">,</span> module</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>The <code class=\"language-text\">createStartFn</code> function creates a renderer object, with a Karma runner instance available within the start-function’s scope.</p> \n<p>Create a parameter named <code class=\"language-text\">karma</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">TyrtleKarmaRenderer</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">karma</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>karma <span class=\"token operator\">=</span> karma<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>Tell <code class=\"language-text\">karma</code> what the total number of tests is:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * Invoked before all tests are run; reports complete number of tests\n * @param  {Object} tyrtle Instance of Tyrtle unit tests runner\n */</span>\n<span class=\"token class-name\">TyrtleKarmaRenderer</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">beforeRun</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">tyrtle</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>karma<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// count number of tests in each of the modules</span>\n    total<span class=\"token punctuation\">:</span> tyrtle<span class=\"token punctuation\">.</span>modules<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">memo<span class=\"token punctuation\">,</span> currentModule</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> memo <span class=\"token operator\">+</span> currentModule<span class=\"token punctuation\">.</span>tests<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>After each test, pass the resulting data to Karma:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * Invoked after each test, used to provide Karma with feedback\n * for each of the tests\n * @param  {Object} test current test object\n * @param  {Object} module instance of Tyrtle module\n *                  to which this test belongs\n */</span>\n<span class=\"token class-name\">TyrtleKarmaRenderer</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">afterTest</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">test<span class=\"token punctuation\">,</span> module</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>karma<span class=\"token punctuation\">.</span><span class=\"token function\">result</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    description<span class=\"token punctuation\">:</span> test<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n    suite<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>module<span class=\"token punctuation\">.</span>name <span class=\"token operator\">+</span> <span class=\"token string\">\"#\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    success<span class=\"token punctuation\">:</span> test<span class=\"token punctuation\">.</span>status <span class=\"token operator\">===</span> Tyrtle<span class=\"token punctuation\">.</span><span class=\"token constant\">PASS</span><span class=\"token punctuation\">,</span>\n    log<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>test<span class=\"token punctuation\">.</span>statusMessage<span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    time<span class=\"token punctuation\">:</span> test<span class=\"token punctuation\">.</span>runTime\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>Next, inform Karma that the tests have all finished running:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * Invoked after all the tests are finished running\n * with unit tests runner as a first parameter.\n * `window.__coverage__` is provided by Karma.\n * This function notifies Karma that the unit tests runner is done.\n */</span>\n<span class=\"token class-name\">TyrtleKarmaRenderer</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">afterRun</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token comment\">/* tyrtle */</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>karma<span class=\"token punctuation\">.</span><span class=\"token function\">complete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    coverage<span class=\"token punctuation\">:</span> window<span class=\"token punctuation\">.</span>__coverage__\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>You now have a renderer constructor. Next, turn your attention to the <code class=\"language-text\">createStartFn</code> function. You need to configure and initialize the unit test framework that returns a function, which requires a list of test files that are served from the Karma server and starts the actual runner.</p> \n<p>Karma serves the files that are required for testing from a path that Karma creates and timestamps the files to avoid caching issues in browsers. Karma makes each path available as a key in a hash named <code class=\"language-text\">__karma__.files</code>. This makes Karma a bit tricky to configure when using an AMD-loader such as <code class=\"language-text\">require.js</code>. To understand how to use AMD with Karma, go to:</p> \n<p><a href=\"http://karma-runner.github.io/0.8/plus/RequireJS.html\">http://karma-runner.github.io/0.8/plus/RequireJS.html</a></p> \n<p>Here is the final <code class=\"language-text\">createStartFn</code> function:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * Creates instance of Tyrtle to run the tests.\n *\n * Returned start function is invoked by Karma runner when Karma is\n * ready (connected with a browser and loaded all the required files)\n *\n * When invoked, the start function will AMD require the list of test\n * files (saved by Karma in window.__karma__.files) and set them\n * as test modules for Tyrtle and then invoke Tyrtle runner to kick\n * off tests.\n *\n * @param  {Object} karma Karma runner instance\n * @return {Function}     start function\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createStartFn</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">karma</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> runner <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Tyrtle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  Tyrtle<span class=\"token punctuation\">.</span><span class=\"token function\">setRenderer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">TyrtleKarmaRenderer</span><span class=\"token punctuation\">(</span>karma<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> testFiles <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>__karma__<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">file</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token regex\">/-test\\.js$/</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">testFile</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> testFile<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/base/public/'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">require</span><span class=\"token punctuation\">(</span>testFiles<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">testModules</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// test files can return a single module, or an array of them.</span>\n      testFiles<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">testFile</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> testModule <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span>testFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>testModule<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          testModule <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>testModule<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        testModule<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">aModule<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          aModule<span class=\"token punctuation\">.</span><span class=\"token function\">setAMDName</span><span class=\"token punctuation\">(</span>testFile<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          runner<span class=\"token punctuation\">.</span><span class=\"token function\">module</span><span class=\"token punctuation\">(</span>aModule<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      runner<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</div> \n<p>To find more examples of how this all fits together, see the scripts <a href=\"https://gist.github.com/gryzzly/6497759\"><code class=\"language-text\">test-main.js</code></a> (the RequireJS configuration to work with Karma) and <a href=\"https://gist.github.com/gryzzly/6497671\"><code class=\"language-text\">karma.conf.js</code></a>. Also, there are many adapter implementations such as <a href=\"https://github.com/karma-runner/karma-mocha\">Mocha</a>, <a href=\"https://github.com/karma-runner/karma-nodeunit\">NodeUnit</a>, and <a href=\"https://github.com/karma-runner/karma-qunit\">QUnit</a> on the <a href=\"https://github.com/karma-runner\">Karma GitHub page</a>.</p> \n<p><em>Ursula Kallio contributed to the writing of this post.</em></p>","descriptionType":"html","publishedDate":"Mon, 09 Sep 2013 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"41b015add71e0f8184097a42cfc9e8b9","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569993},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud Hits the Road","link":"https://developers.soundcloud.com/blog/soundcloud-hits-the-road","description":"<p>A quick virtual heads-up for developers, hackers and coding enthusiasts in the Berlin-area: SoundCloud is very happy to support the upcoming Hack and Tell event at the C-base bar on Tuesday, August 30. The Hack and Tell is a monthly meet up where participants have the chance to get on stage for five minutes present their personal or professional projects. For those not presenting, it’s a great evening to mix it up with Berlin-based hackers, meet some members of the SoundCloud development team and eat copious amounts of pizza. You can get a full rundown of the event <a href=\"http://www.meetup.com/Berlin-Hack-and-Tell/events/29729371/\">here</a>.</p> \n<p>Berlin’s too far or you don’t like pizza? Here are a handful of the coming non-pizza-centric events where you can catch SoundCloud engineers offline:</p> \n<p><a href=\"http://visionsoundmusic.com/\">Vision Sound Music</a> London, September 2-4</p> \n<p><a href=\"http://www.sfmusictech.com/\">SF MusicTech</a> San Francisco, September 12</p> \n<p><a href=\"http://mobiletechcon.de/\">Mobile TechCon</a> Mainz, Germany, September 12-14</p> \n<p><a href=\"http://gogaruco.com/\">Golden Gate Ruby Conference</a> San Francisco, September 16-17</p> \n<p><a href=\"http://jsconf.eu/2011/\">JSConf.eu</a> Berlin, October 1-2</p> \n<p><a href=\"http://gotocon.com/aarhus-2011/\">Goto Aarhus</a> Aarhus, Denmark, October 13-14</p> \n<p><a href=\"http://www.paris-web.fr/\">Paris Web</a> Paris, October 13-15</p> \n<p><a href=\"http://velocityconf.com/velocityeu/\">Velocity</a> Berlin, November 8-9</p>","descriptionType":"html","publishedDate":"Sun, 28 Aug 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"d36080a47530582c91350168a65cb6e2","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Introducing SoundCloud JavaScript SDK 3.0.0","link":"https://developers.soundcloud.com/blog/introducing-javascript-sdk-3-0-0","description":"<p>We are happy to announce version 3.0.0 of our SoundCloud JavaScript SDK.</p> \n<p>The new SDK improves stream security and content uploading functionality, and modernizes the technology stack.</p> \n<p>Version 3 of the SoundCloud JavaScript SDK is a major update and is not backwards compatible. That said, the changes that you need to make your web app work with the new SDK are easy to implement. Please refer to <a href=\"https://developers.soundcloud.com/blog/docs/api/migrating-to-javascript-sdk-3\">Migrating to JavaScript SDK 3.0.0</a> to upgrade.</p> \n<h2>ECMAScript 2015 and CommonJS</h2> \n<p>The original version of the SDK was written in CoffeeScript, which is no longer a core technology at SoundCloud. This update provided us the opportunity to migrate our source code from CoffeeScript to ECMAScript 2015.</p> \n<p>The new SDK is now using the <a href=\"https://babeljs.io/\">Babel</a> compiler for ES2015 support, and <a href=\"http://webpack.github.io/\">webpack</a> as our bundler. This has the additional benefit of making the SoundCloud JavaScript SDK 3.0.0 compliant with CommonJS.</p> \n<p>Because of this, we can now take advantage of the variety of packages that are available via <a href=\"https://www.npmjs.com/\">npm</a>, and users can install the SDK via npm as well. Please refer to the <a href=\"https://www.npmjs.com/package/soundcloud\">npm page</a> for details.</p> \n<h2>JavaScript Promises</h2> \n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\">Promises</a> have become a core part of JavaScript with the new ES2015 specification, and they allow for better composability and a easier control flow. Internally, we work with Promises a lot and wanted to give external developers the ability to benefit from an easier API.</p> \n<h2>Web Audio API</h2> \n<p>The previous SDK neither provided a way to record sounds from Web Audio applications nor a way to upload Web Audio recordings. It shipped with a Flash component that handled recording and uploading of recordings. There was no way to specify an external file for uploading.</p> \n<p>The new SDK ships with a <a href=\"https://developers.soundcloud.com/blog/docs/api/sdks#recording\">recorder component</a> that uses Web Audio and <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Navigator/getUserMedia\"><code class=\"language-text\">getUserMedia</code></a> instead of Flash, and the component allows you to pass in arbitrary AudioNodes that will be recorded. This makes it much easier to integrate the SoundCloud JavaScript SDK 3.0.0 into creator applications that rely on Web Audio. The SDK provides a <a href=\"https://developers.soundcloud.com/blog/docs/api/sdks#uploading\">dedicated method</a> to publish recordings directly from your web app.</p> \n<h2>Secure streaming</h2> \n<p>The new SDK now includes a new player component. This component improves security for creator content and provides the improved playback stability.</p> \n<h2>Documentation</h2> \n<p>We also took the time to all of rewrite our <a href=\"https://developers.soundcloud.com/blog/docs/api/sdks\">documentation</a> and <a href=\"https://developers.soundcloud.com/blog/docs/api/guide\">code examples</a> so that you can start with the new SDK immediately.</p>","descriptionType":"html","publishedDate":"Thu, 01 Oct 2015 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"ac85e36ebd6d3cc94a5fc4866704b1c7","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569991},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Release Quality and Mobile Trains","link":"https://developers.soundcloud.com/blog/quality-mobile-trains","description":"<p>Once every two weeks, we prepare new versions of our mobile apps to be published to the app stores. Being confident about releasing software at that scale — with as many features and code contributions as we have and while targeting a wide range of devices like we do at SoundCloud — is no easy task. So, over the last few years, we have introduced many tools and practices in our release process to aid us.</p> \n<p>In this blog post, I’ll cover some of the techniques we use to guarantee we’re always releasing quality Android applications at SoundCloud.</p> \n<!-- more --> \n<h2>All Aboard!</h2> \n<p>Maintaining high quality is about more than just hitting deadlines; it’s a continuous job. As such, we’re constantly keeping an eye on our code and asset changes to make sure we get the best out of our engineering efforts. In addition to human code reviews, our repositories’ pull requests go through an automated pipeline of tests for every single changeset. This pipeline makes use of industry standard tools for both static analysis and unit, integration, and UI testing.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/b0c15442b3e61d6b97a050f20b2689a1/60bac/github-comment.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 33.20659062103929%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABK0lEQVQoz01RCXKEMAzj/09sO912CTcLCeFIuFTLbLdlRmPikWXLTm6dgx9GmKJC0/Yo6xaP3imaR4+wbljihhCveGF9veewYloirGgEySfVOGOTIusGuMFjmgMGPymmeYEfJ4XzI4aR+RHjNCuX+Si1rGGTdduRQL5T0DYNnHN8ous61HWDdV1hjEGaGlRVhbZt0QjPWouiLPEQ3r5vwq2Fu+E8TyQUY7fb1x29dZiXgFzsZ3mpE6RZjkrEyduPE4cUXREK1pLLqIKcaPAen1/fuKeZWkpNrnaJu8l0N7TGfcYnfv/ZlFa1yXFcgtzf2/uHHMIqyeQFFlm2l11lRakF8Z/YC5K3zusQ5Kggx6RN2l1C1Gk4PnN8s1l4XvWKf6AoD8RjcYe7CP4A2i8cUw2vM8gAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"An automatically generated GitHub comment with statistics about the code changes\" title=\"An automatically generated GitHub comment with statistics about the code changes\" src=\"https://developers.soundcloud.com/blog/static/b0c15442b3e61d6b97a050f20b2689a1/8ff1e/github-comment.png\" srcset=\"/blog/static/b0c15442b3e61d6b97a050f20b2689a1/9ec3c/github-comment.png 200w,\n/blog/static/b0c15442b3e61d6b97a050f20b2689a1/c7805/github-comment.png 400w,\n/blog/static/b0c15442b3e61d6b97a050f20b2689a1/8ff1e/github-comment.png 800w,\n/blog/static/b0c15442b3e61d6b97a050f20b2689a1/6ff5e/github-comment.png 1200w,\n/blog/static/b0c15442b3e61d6b97a050f20b2689a1/60bac/github-comment.png 1578w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p align=\"center\">An automatically generated GitHub comment with statistics about the code changes</p> \n<br /> \n<p>We’ve also built tools that highlight other potential issues early on during the code review cycle. By integrating them with other pieces of our day-to-day routine, such as GitHub (above) and Slack (below), we ensure our developers have a more transparent understanding of their applied diffs.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/5686bfe2d61df3b995d97dfddfa7b051/aa1b0/slack-message.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.42339832869081%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA0ElEQVQY03WNWVLDQAxEfX44BlyI5IOAoGK8EXviLfYsHsd+jBOKP7rqSerqkhQ9pg88vz2RS85u/4KIUFaKs1JorTHG4Jy7zdbagGEK3jl781u+de89KxCJfUfOghyEg3zyut+RfAh106KqKqCo65qyLKnCnGQ5xfeJvDih1P3xxjgMbIq2Yi6GJE3IVUc7WP6TnReSxpAF0kCjPXpa0H5hcDO9nu4H264ljmOyquFY9hT1QDc65uvCuq5/XJew7DxfKuRh2UwzY/AXM9H/8gMiqDAKL81eKQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"A Slack message sent to the author of the pull request after tests are run\" title=\"A Slack message sent to the author of the pull request after tests are run\" src=\"https://developers.soundcloud.com/blog/static/5686bfe2d61df3b995d97dfddfa7b051/8ff1e/slack-message.png\" srcset=\"/blog/static/5686bfe2d61df3b995d97dfddfa7b051/9ec3c/slack-message.png 200w,\n/blog/static/5686bfe2d61df3b995d97dfddfa7b051/c7805/slack-message.png 400w,\n/blog/static/5686bfe2d61df3b995d97dfddfa7b051/8ff1e/slack-message.png 800w,\n/blog/static/5686bfe2d61df3b995d97dfddfa7b051/6ff5e/slack-message.png 1200w,\n/blog/static/5686bfe2d61df3b995d97dfddfa7b051/aa1b0/slack-message.png 1436w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p align=\"center\">A Slack message sent to the author of the pull request after tests are run</p> \n<br /> \n<p>Even so, it’s still a challenge to foresee how an application with our scale will behave in the wild, with the variety of devices, locales, and use cases we support. For that reason, we are also big believers in having a remote feature-toggling system. Not only does it give us a way of preventing issues from spreading once they are detected, but we also use these toggles to enable early internal testing of our new features via our alpha and beta builds and to decouple app releases from feature releases.</p> \n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 465px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0e15abc6ffdc2c555cd20df1ec4c69f2/925b5/feature-flag.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.10752688172043%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACTElEQVQ4y5WUyW7bMBCGfS8KFOgDtEkk2ZIta6VEarHkRXaaFwjie9D2/YG2rmVO/6HkIF0uPXye4Yj8yRkOPZml5Rsryh5vgvh4F4qnD4v4+NFPDFaYHa2lON6xH8Cyj5gTy9c8jfYRvJvchKnjiZoi1ZGfN5Q2HcX1BmzJyyqaFy35GBtbtrSQK5omiqZpATsC30EMggKCie2l1XcIal+1veweerE+9Gm77+d53fv1tl82Xb9c7foAPs9xYtXbUQ4rr1zACSQT7GYj5VMotyTKTzpWex3KnRbNXmftXnui1Omm0Xm30VHTaLFrtZNIDcErF8CnOxtB/Nis7mY1zWWjAQ2saIE0F6o1vl+uMV4bf0hXEepPM2zIY4j+LjgVJbl5rT0s8CDIGxjylcExdYMA6srWQe1mosKcSjsvgiqZ2KOgSbm610l5MBfEl1N0DyS395RvDiRBvj5QiFNHRUH5qqJAFeSnhZZ5SV6izrdRnkxug8z2svI0S7B7pPQsxkkiSTOcCPUzlpnD57FJNZEYK3JTzI2lnifGni1O+S4StpuUpwWnplbalTXSKtk3eEyBEqAU/G0BuFWsMOc0GW0Ndqjhi6BquN802oMCpu1oCYJmR9HmnjjOxCjFzPScuVlGj3YQvA2ESTlSWKi22hXl2KTquuB6kpFhfI3/JYinZLlp8c0T1cXL6rPL5CNZdUZbnMd0Bkb/Vezn2OQ/BsEgm+JFcD+Z/jK99Sei/Hf81Xfz/GKZ8Ut5iz+BZ+z8FYHP4Mt/cl3zDN7/AsgYkEc34XEVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"feature flag\" title=\"feature flag\" src=\"https://developers.soundcloud.com/blog/static/0e15abc6ffdc2c555cd20df1ec4c69f2/925b5/feature-flag.png\" srcset=\"/blog/static/0e15abc6ffdc2c555cd20df1ec4c69f2/9ec3c/feature-flag.png 200w,\n/blog/static/0e15abc6ffdc2c555cd20df1ec4c69f2/c7805/feature-flag.png 400w,\n/blog/static/0e15abc6ffdc2c555cd20df1ec4c69f2/925b5/feature-flag.png 465w\" sizes=\"(max-width: 465px) 100vw, 465px\" loading=\"lazy\"> </img></a> </span> \n<p>By using continuous integration tools, we ensure that our master branch is always deployable. This is accomplished by scheduling time-based jobs to be run — either nightly, weekly, or bi-weekly — or via triggered jobs (for example, when a pull request is merged into our master or release branches). With these CI jobs, we can guarantee our obfuscated and shrinked release builds are all set after the passes of tools like ProGuard or R8; update to the latest localized translations for all the languages we support; and automate other repetitive tasks.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/975510f5992ad5dd42726e017b5e1b32/2d15a/outdated-pr.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 17.92929292929293%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAm0lEQVQY042NWw7CIBBFu//tuQG/qhaYAcpTIFeg1pj4I8nJfWRmWK5skfMTuwsTHyJ8TEi5ID//J3VCzFguD4LzAet9w3rbIBVDscHu4xwYjA9OPf2Rzy7DhQQ2Oxb050PAJgSMMdBag4gghIS1FlLKnrmrArOefswR8/RHR1CKpp8Hnff9kEFrDaVWlFJQu9Z3rh/al//txv4LxjY17Ft/JMIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"GitHub comment pointing to an outdated pull request\" title=\"GitHub comment pointing to an outdated pull request\" src=\"https://developers.soundcloud.com/blog/static/975510f5992ad5dd42726e017b5e1b32/8ff1e/outdated-pr.png\" srcset=\"/blog/static/975510f5992ad5dd42726e017b5e1b32/9ec3c/outdated-pr.png 200w,\n/blog/static/975510f5992ad5dd42726e017b5e1b32/c7805/outdated-pr.png 400w,\n/blog/static/975510f5992ad5dd42726e017b5e1b32/8ff1e/outdated-pr.png 800w,\n/blog/static/975510f5992ad5dd42726e017b5e1b32/6ff5e/outdated-pr.png 1200w,\n/blog/static/975510f5992ad5dd42726e017b5e1b32/2d15a/outdated-pr.png 1584w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<h2>Release Train Model</h2> \n<p>We have a two-week interval between each of our releases because we follow the <a href=\"https://www.scaledagileframework.com/agile-release-train/\">Release Train model</a>, in which, similarly to a train that departs a station on a specified schedule, we have specified a day for what we refer to as Code Freeze, which is when two members of the engineering collective (previously selected from a rotation of all members) “cut the master branch” into the release branch. We refer to them as release captains, but people familiar with release trains call them <a href=\"https://www.scaledagileframework.com/release-train-engineer-and-solution-train-engineer/\">Release Train Engineers (RTE)</a>.</p> \n<p>Pragmatically, this means that once master gets cut, no new code gets into the changeset that the release captains are responsible for publishing (with the exception of emergency hotfixes, which are then merged back to the master branch).</p> \n<p>Following a release train not only helps in limiting the ownership of each pair of release captains, but it also gives everyone a sense of predictability over when changes will be rolled out to the public.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/3e706dce4a12259168f3785b55a52c0b/b5cbf/release-calendar.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.406676783004556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACD0lEQVQoz5WR60/TYBjF+zdj/IAxMXHcLzKViCgxUYbAAG9Rg+gEnaACw2y4G2zIvezKOrqt69r+fFqiiQl88ElOTs9z3pz2PVWchoFZ1bHqDUy9hqXXMbQqVq3uaVv2jYqGUzdo6vpf7XJN06hqp5SKeY8No4HSO+PHN97D4JSf0bn7+AI9dAR6GQreYWTmnud1TfTTGejj4bNROif66BbdITwfesHGyhIrnxYIh95SyB2jLGU2WFPTxHJZ1g9TvE+t8u7nV5azUZL5Pb4fJYmoW6wL4uoOH5KrLKYjLMS/UapVcceybVqWjW07KFw0LedfbV/iS4AtYYZh4AhbEqp0hx5zc36M4XCQ2WiIW18mGQw/5cHaS9RyDk36Oj5RqQp/3o4wKL4/PIV/eZps6dDLNU0Tx3HOvzB/WkQt5MiXi9SbUrQL02X5KS1T3mphC6xWi0bT8PZ100A3zn03yJ3zQPuSK//n/CnIzVYOsltk4jH2tpPsC/a2EuwkNznIpNiVZ1dnEzHP291OsC/7jOiDbJqddJxMapNELEImGZV6yijtwQGuBfvpfj7M0KtR2sY7aHviwzd7m7uvx2if7uPG3BDXZwYYefOIq4Eu2id7uSLnFtc+8iudIL75g+jGKpVTCSzqGrpt0rBblA0dVStxVC5QOKt4uzOriS6oyZmadKdWSpxoZY6lc+uC6/8GBHzPGYfLHxEAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"The dates for each code freeze are displayed for the entire company in a shared calendar\" title=\"The dates for each code freeze are displayed for the entire company in a shared calendar\" src=\"https://developers.soundcloud.com/blog/static/3e706dce4a12259168f3785b55a52c0b/8ff1e/release-calendar.png\" srcset=\"/blog/static/3e706dce4a12259168f3785b55a52c0b/9ec3c/release-calendar.png 200w,\n/blog/static/3e706dce4a12259168f3785b55a52c0b/c7805/release-calendar.png 400w,\n/blog/static/3e706dce4a12259168f3785b55a52c0b/8ff1e/release-calendar.png 800w,\n/blog/static/3e706dce4a12259168f3785b55a52c0b/6ff5e/release-calendar.png 1200w,\n/blog/static/3e706dce4a12259168f3785b55a52c0b/b5cbf/release-calendar.png 1318w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p align=\"center\">The dates for each code freeze are displayed for the entire company in a shared calendar</p> \n<br /> \n<p>As a result, our design and data analysis teams can estimate when their help will be needed for defining and delivering specifications for feature development; product managers know when their experiments and product launches will go live; and the backend and frontend engineering teams are able to plan their work to aim for certain code freeze dates.</p> \n<p>Code freeze is just one of the steps described in a detailed checklist for the captains (generated via our CI jobs). Additional steps include naming the new build for internal reference (we follow alphabetical order and always pick from a pop culture character set — we’re currently using Marvel superheroes as inspiration!) and updating documents, links, and Slack channels for the visibility of the outgoing train.</p> \n<p>The release captains are then responsible for performing a set of manual regression tests that cover the main use cases of the application and some of the scenarios we could not automate (yet). Once all is verified and the captains feel confident with their release, they are free to start the staged rollout process by deploying the build to the beta channel and subsequently rolling out to percentages of the production user base.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/5841d/ci-pipeline.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20.251572327044023%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAyklEQVQY022QWXPCMAyE+f9/rweTB45CCGmCDY0P+ZCzyKZ9q16+2R1pR9LGOQfvPXIpCCGgFEZKCeu6whgDIoJWqnnzNMFaK1ojiK/E58ytr1ad2VzHEbv9AWox2LoeY7yjc5fGN3PEEBQ+3RnXqPFuvnChG7a+F1/jw5+wkEUkWUTCWuD3rLA/9bhbwpR+sGSPWWiEgRMSZ1COiJUckUrVoWkvzMwoXFrYK/CmcTgPeMjpHb0262jAHB5YE4NlIKf8L/mXfy+q9QR/TzSDRUNf9wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Continuous integration pipeline with staged rollout steps\" title=\"Continuous integration pipeline with staged rollout steps\" src=\"https://developers.soundcloud.com/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/8ff1e/ci-pipeline.png\" srcset=\"/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/9ec3c/ci-pipeline.png 200w,\n/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/c7805/ci-pipeline.png 400w,\n/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/8ff1e/ci-pipeline.png 800w,\n/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/6ff5e/ci-pipeline.png 1200w,\n/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/2f950/ci-pipeline.png 1600w,\n/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/5841d/ci-pipeline.png 2385w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p align=\"center\">Continuous integration pipeline with staged rollout steps</p> \n<br /> \n<h2>The Train Has Departed the Station</h2> \n<p>During the two-week period of staged rollout, it’s the release captains’ job to monitor data, metrics, and dashboards for user reports, reviews, and crashes that might have ended up in production. After evaluating the impact of each of these issues, it is their call whether to request new changes to be applied in their train, which is done by pinging the involved engineers and working toward fixes.</p> \n<p>We aim to always be attentive to feedback, but the sooner issues get reported, the sooner we can act to fix them. On that note, I’d like to <a href=\"https://play.google.com/apps/testing/com.soundcloud.android\">encourage you to join the beta</a> to get early access to new exciting features, in addition to supporting us by being part of this direct channel of communication.</p> \n<p>Just before the end of their two-week “shift,” the captains might decide to hold a <a href=\"https://landing.google.com/sre/sre-book/chapters/postmortem-culture/\">“post-mortem meeting,”</a> in which incidents are discussed and their root causes understood and documented so that the entire platform collective can come up with preventive actions to reduce the likelihood of reoccurrence. The idea is that these are blameless, with the sole goal being that of improving systems and processes and spreading the knowledge across the entire team.</p> \n<h2>End of the Line</h2> \n<p>Overall, ensuring a good standard of what we publish to our users is a product of many factors. Not only do we need, use, and build tooling and automation to facilitate our daily work, but more importantly, at SoundCloud, we are always attentive to supporting the processes the team puts around building a quality-driven culture.</p>","descriptionType":"html","publishedDate":"Wed, 03 Apr 2019 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/b0c15442b3e61d6b97a050f20b2689a1/8ff1e/github-comment.png","linkMd5":"655377572ca618cedb5c80aefa47a904","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn91@2020_3/2020/08/25/00-49-37-209_19018e61ae3dc55a.webp","destWidth":800,"destHeight":266,"sourceBytes":13990,"destBytes":14880,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/b0c15442b3e61d6b97a050f20b2689a1/8ff1e/github-comment.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn91@2020_3/2020/08/25/00-49-37-209_19018e61ae3dc55a.webp","https://developers.soundcloud.com/blog/static/5686bfe2d61df3b995d97dfddfa7b051/8ff1e/slack-message.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn77@2020_1/2020/08/25/00-51-45-436_db24d088ebc761dd.webp","https://developers.soundcloud.com/blog/static/0e15abc6ffdc2c555cd20df1ec4c69f2/925b5/feature-flag.png":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn36@2020_3/2020/08/25/00-51-41-864_802ecfd683b26a0d.webp","https://developers.soundcloud.com/blog/static/975510f5992ad5dd42726e017b5e1b32/8ff1e/outdated-pr.png":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn39@2020_2/2020/08/25/00-51-44-145_7a73d812faa9d89a.webp","https://developers.soundcloud.com/blog/static/3e706dce4a12259168f3785b55a52c0b/8ff1e/release-calendar.png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn35@2020_3/2020/08/25/00-51-45-265_a8e0a8d73ea4877d.webp","https://developers.soundcloud.com/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/8ff1e/ci-pipeline.png":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn67@2020_4/2020/08/25/00-51-40-691_7089da2b43259564.webp"},"publishedOrCreatedDate":1598316569972},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Stream and Download","link":"https://developers.soundcloud.com/blog/stream-and-download","description":"<p><em>UPDATE: Check out our guide on <a href=\"https://developers.soundcloud.com/blog/docs/api/guide#playing\">Playing Sounds</a> for the most up to date information.</em></p> \n<p>This is an introduction to how you can power your app or website with sounds hosted on SoundCloud. Via our API, you get access to millions of different sounds, and in addition to streaming and downloading tracks, you can access meta data and social features like comments and followings.</p> \n<!-- more --> \n<p>These are some typical ways apps are using SoundCloud for this:</p> \n<ul> \n <li>Let users search, browse and stream tracks in an app, e.g. <a href=\"https://soundcloud.com/apps/soundcloud-desktop\">SoundCloud for Mac</a></li> \n <li>Let users connect to SoundCloud and make their tracks available for streaming on a personalized page, e.g. <a href=\"https://soundcloud.com/apps/bandpage\">Rootmusic</a></li> \n <li>Filter out tracks uploaded by a certain app, and make them available for other users in the same app, e.g. <a href=\"https://soundcloud.com/apps/ielectribe\">iELECTRIBE</a></li> \n <li>Build a website for music exploration, e.g. <a href=\"https://soundcloud.com/apps/citysounds-fm\">CitySounds</a></li> \n <li>Make it possible to import sounds and samples for music creation, e.g. <a href=\"https://soundcloud.com/apps/myna\">Aviary Myna</a></li> \n</ul> \n<p><strong>Streams &amp; Downloads using the API</strong></p> \n<p>For all uploaded files, we provide a 128 kbps MP3 stream version alongside with the original audio file. The access to these files can be restricted depending on the track settings for streamable and downloadable. Have a look at the <a href=\"https://developers.soundcloud.com/blog/docs/api\">API Introduction</a> and the <a href=\"https://developers.soundcloud.com/blog/docs/api/tracks\">/tracks documentation</a> to find out how to access the stream and download for a track.</p> \n<p><strong>Playing Streams in websites</strong></p> \n<p>If you want to play SoundCloud tracks in a website have a look at:</p> \n<ul> \n <li><a href=\"https://developers.soundcloud.com/blog/docs/oembed\">oEmbed</a> to get the embed code of our standard player widgets.</li> \n <li><a href=\"https://developers.soundcloud.com/blog/docs/html5-widget\">Widget JS API</a> to control and customize our player widget using JavaScript.</li> \n <li><a href=\"https://developers.soundcloud.com/blog/docs/custom-player\">JS Custom Player</a> to build your own HTML5 audio player.</li> \n</ul>","descriptionType":"html","publishedDate":"Wed, 06 Apr 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"880f1c3f5d987356f156a42068c84f8d","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Solving Remote Build Cache Misses by Annoying Your Colleagues","link":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2","description":"<p>This is part two in a series about solving Gradle remote build cache misses. Solving build cache misses is important to both avoid work that has already been compiled and improve build speeds. For more information, check out part one <a href=\"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses\">here</a>.</p> \n<p>To understand how these cache misses happen, it is important to understand how we seed our build cache. <a href=\"https://docs.gradle.org/current/userguide/build_cache.html#sec:build_cache_configure_use_cases\">Gradle recommends</a> that your CI system populates the build cache from clean builds and that developers only load from it. At SoundCloud, we also pull from the build cache on CI in order to make our CI builds faster. This is a diagram of what our remote build cache setup looks like.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/5029c683c9dcd142b5276343646200ed/c70a2/image3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.05196182396607%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB60lEQVQoz41T22oTURTd50yS1okpvXorlsRSQ3qBjLe2Yh8qij73F/yAgih9FYQ+WBGlTdKSUGqspraIlmpEpKBQBJ/8AMEf8FEapsNkL/dctGJNcMNiz9nsvc46mzVEf8YKlJdiC7XTlIObqbA99oLt9DO2rQ225byrSgDl+b7fn2eDmsb0e+0TbiFJS8DJVWBiExheB8ZfAiPPmY2yR4hHfn8RTQlVmKPq6q0pWsReyxI7lzfZmRRc22IntYqakEAV+IHfOfM58i8i/dd5kLqS4zT3/UK0hGxfuW4NrbHV94StZNm1aBkWXbk5IX3xRspSguuCUcEpUjoj+UTz3chrlHFGcqsgIejaF2bEIqQjsZA4LTgn/aN0uKc3Kq/rvvdV967U9fHHrDvK0DS9/WtvLQKP9KxgUoSY+/dlp0wyO4cpcSRN8c6kVEYE/Y31GcG+j2XayOzI/q7f/hTsVK482kbUHRL9X6TGfFJ4rghUhrHgvKGHu9s0z68p536kAu769Ys3NAEHifJMNO8E3zl3Vtzwju58+0JzPz7I7CvPS2ivAJeqgF7zTbsTDippOEgotUSJfXWqgJ30W2BQPHpe5hOeR2WwZhbZ7X/KdvAXoBoONiSMF4M/igpcHdgAhir1vew6u4eKqP0E5R7LNTfN02kAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Seeding cache setup\" title=\"Seeding cache setup\" src=\"https://developers.soundcloud.com/blog/static/5029c683c9dcd142b5276343646200ed/8ff1e/image3.png\" srcset=\"/blog/static/5029c683c9dcd142b5276343646200ed/9ec3c/image3.png 200w,\n/blog/static/5029c683c9dcd142b5276343646200ed/c7805/image3.png 400w,\n/blog/static/5029c683c9dcd142b5276343646200ed/8ff1e/image3.png 800w,\n/blog/static/5029c683c9dcd142b5276343646200ed/c70a2/image3.png 943w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>For the same task, differences in the list of inputs when the task is running on the CI system vs. on the local machine causes these build cache misses.</p> \n<h2>Blocking Slow Builds</h2> \n<p>So now on to the explanation of the title. Part of a build engineer’s role is to speed up builds. Improving build performance and avoiding work with caching is one way to achieve this, but another tool in the build engineer’s belt is that of disallowing slow builds. Sometimes, there are two paths that produce the same outcome. Let’s call them the slow path and the fast path. If we can always take the fast path, we can improve our build speed.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 419px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/70603488e2cd0a1203e737d7a5ddd23e/1b142/image1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 106.44391408114558%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAAC80lEQVQ4y2NggIK95+6xgOjtJ66vvfD4y/9jN178BuJ/IHz85ss/5x5++r/z1M3jMPWrdp1gwAtO33vPDKJP3Hq96uTtN/9X7z75Y+PBC783HDj3e/m2Iz+Bhv4/fffdEZh6oMX4DTxy7RnYhfsu3N9+9+P//0euP/9/+t47kCH/j1x7/v/667//D15+fBmmfsPB8/gNXL//HCOIXrHjmCXQa5FnH3z02XX6dsje8/eCtxy9En7s5ssgoDedYOrnrNrOQBAsWL+HEYnrDcRMULYWEPuCGCJiEowMxIBNhy6C6S///zNmFFWxsXNwhHv4h3L+B/I9/EI4eXj5rIFYA6SGkZGRgY2dnYEUIAbEMlA2sotABqqTYhBMsyKSgehyIEPVsFiGF+gBMSseeV0gliPFUCMifGEKxPzEGCaI5CV8AJRuDbBJgGwRhRoEwvJQjM07PEAsBcTcQCwAdaUQuoFC0JgDuUoFiBWQDVSVkGAo9vaGGczLwsSkzc7CAgo/DW52dkNmJiYFsHOZmHCGJSh2ZUEMLnZ2FEXANMmErpaTjU0YxMhxc2PM9/BACWiYYmkkFzJICQpyzElLU12clQXO64GmprxdUVGgoGFoDAmZtKG4WJpQ7MlAvc1gpwHOGEyTExKcDjc0zL3a3V1+s7d36aMpU65f6+lZ/mrmzP+3+/vXH6yr6+2IjFQEWsCJzWAuINaBcUp9fMRPNDVV35806cPDyZP/n21r+3+xo+P/5a6u/4fq6v6+nzPn/7Np0/7vr6lZmO3mhtO1hsCAZ4Oy2Vbk5sYCDdhxo7f3zZOpU//f6uv793jKlP9AF/++M2HCDyC+u7WsLLYpNFQXl7cVYBETbmnJCYxlXhC7Jzo6flV+/vYHkyZtBLo0GWjBui2lpYr7amoyzJSV8eUsBnb03GKuogJKd2rxdnYSQEOVQGLWamrwMJsQF8cEjDy8OQFUQHCAGHycnCDvm3vo63PBJN/MmgWuMnZXVTG9nT0bnpwAgOMUC/vt0SQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Blocking slow paths\" title=\"Blocking slow paths\" src=\"https://developers.soundcloud.com/blog/static/70603488e2cd0a1203e737d7a5ddd23e/1b142/image1.png\" srcset=\"/blog/static/70603488e2cd0a1203e737d7a5ddd23e/9ec3c/image1.png 200w,\n/blog/static/70603488e2cd0a1203e737d7a5ddd23e/c7805/image1.png 400w,\n/blog/static/70603488e2cd0a1203e737d7a5ddd23e/1b142/image1.png 419w\" sizes=\"(max-width: 419px) 100vw, 419px\" loading=\"lazy\" /> </a> </span></p> \n<p>Often it isn’t obvious which path is the “slow path” and which path is the “fast path.” When confronted with two paths in real life, we usually ask Google Maps which path has the most traffic so that we can avoid it. With Android Builds, there may be limited guidance from Google. So, it is the build engineer’s role to investigate and disallow the slow paths in order to make engineers happy and productive.</p> \n<h3>Instant Run</h3> \n<p>One of the slow paths we discovered at SoundCloud was <a href=\"https://developer.android.com/studio/run#instant-run\">Instant Run</a>. At first, we didn’t realize that it was causing problems; we only saw that some of our build scans showed that some of our developers were building with the Gradle build cache disabled. Since we have <code class=\"language-text\">org.gradle.caching=true</code> checked in to our repository in the root <code class=\"language-text\">gradle.properties</code>, we were puzzled as to how it could happen. We paired with developers to troubleshoot these slow builds, and we quickly realized that they were being built with Instant Run.</p> \n<p>Instant Run was a tool designed to allow developers to deploy changes to devices faster, but it didn’t always work in large projects. One big limitation is that it disabled the build cache. This sometimes led to painfully slow builds, as everything had to be recompiled. Additionally, this meant that when building with Instant Run, both the local and remote build cache were disabled. We did a performance analysis of Instant Run in different scenarios, and it showed that in our codebase, Instant Run performed either equally as fast as a build without it, or slower — sometimes significantly slower.</p> \n<p>We already had a page in our internal wiki recommending our team disable Instant Run for faster builds, but nobody reads documentation! So how could we disable Instant Run for our team and save everyone from slow builds?</p> \n<p>Here is a Groovy snippet for Gradle which does exactly that:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">def instantRun = project.getProperties().get(\"android.optional.compilation\")?.contains(\"INSTANT_DEV\")\nif (instantRun) {\n throw new IllegalStateException(\"Disable Instant Run: Android Studio -&gt; Preferences -&gt; Build, Execution, Deployment -&gt; Instant Run\")\n}</code></pre> \n</div> \n<p>The snippet checks the project for a specific property, which Android Studio injects into Gradle whenever Instant Run is enabled. When a build is run with Instant Run, the build fails and a helpful error message is displayed guiding the developer to disable Instant Run. This might be slightly annoying to colleagues, but it is all for the team’s benefit: A 10-second settings change is rewarded many times over with faster builds.</p> \n<p>Learn more about how <a href=\"https://medium.com/@runningcode/is-building-from-the-terminal-faster-than-android-studio-175ead7dc2ca\">injected properties in Android Studio work here</a>.</p> \n<p><em>Instant Run was removed in Android Gradle plugin 3.5.0.</em></p> \n<h3>Empty Directories</h3> \n<p>Another slow path we had at SoundCloud was that of empty directories. Empty directories in Gradle create a slow path compilation, which we should disallow. But how and why does this happen? Well, let’s suppose you have the following directory structure on your local machine:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">src/main/java/com/soundcloud/Player.java\nsrc/main/java/com/soundcloud/Artwork.java\nsrc/main/java/com/soundcloud/audio/</code></pre> \n</div> \n<p>And let’s assume you have the following on CI:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">src/main/java/com/soundcloud/Player.java\nsrc/main/java/com/soundcloud/Artwork.java</code></pre> \n</div> \n<p>If audio is an empty folder, are the inputs to the task the same or not? The Java compiler itself ignores empty source directories. Gradle, however, does not. Empty directories are treated as different input properties. Well, that is, <a href=\"https://github.com/gradle/gradle/issues/2463\">until this issue is resolved</a>.</p> \n<p>How can we push out a change to delete all empty directories on all our local project workspaces? If we take a cue from the previous section, we can fail the build if we find any empty source directories. This ensures that the directory structure, as Gradle sees it, is the same locally as it is on CI:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">allprojects {\n tasks.withType(SourceTask).configureEach { t -&gt;\n  t.doFirst {\n    t.source.visit { FileVisitDetails d -&gt;\n      if (d.file.directory &amp;&amp; d.file.listFiles().size() == 0) {\n        throw new IllegalStateException(\"Found an empty source directory. Remove it: \\nrmdir \" + d.file.absolutePath)\n      }\n    }\n  }\n }\n}</code></pre> \n</div> \n<p>The above snippet, which should be placed in the root <code class=\"language-text\">build.gradle</code>, looks at all <code class=\"language-text\">SourceTask</code>s in the project. It traverses the source directory structure to find any empty directories. When it finds a source directory, it prints a helpful error message to the console telling you how to delete that directory. It performs this check before any source task is run.</p> \n<p>You can also remove all empty directories by running the following command:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">find . -empty -type d -delete</code></pre> \n</div> \n<p>One thing to note is that if the root directory is empty, this does not fail the build.</p> \n<p>So, before adding this to our codebase, we needed to be sure this didn’t impact our build times. In this case, every single module in our project took less than 5 milliseconds to run this check, except one particularly large legacy module, which took 89&nbsp;milliseconds to run.</p> \n<p>Is it worth it? We decided it was. Almost all of our developers were experiencing build cache misses while having a clean local Git state compared to master. After pushing the change, many developers started getting a little frustrated when they would have several build failures in a row because of nested empty directories. It is quite common to have these lying around after refactoring code or changing branches, since Git ignores empty directories. However, after the initial change, these failures became quite rare and we eventually increased our remote build cache hits.</p> \n<h3>CompileDebugAIDL</h3> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/8d0ff/image5.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 24.861111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA1klEQVQY012QDW7DIAyFe/+T7RZrp3VqkwD5A2NieDOOtKqL8uUFnm3ZvjBvCOEDYb5ji4RSyh/Mp4rIG8ch5pnPr9juXWoVuPCtOLsMy4qYElIiEJHeMf4/tTb18kl+aa1VC2pVNH1b1Y9g31ds22JkStoNI+ekkJ2Ze6Lm9KQ36llQeIbkEQdNqhN2Hd0PV/jxCjd8qt6wuC+s8w8oDig0Qthp/IiSBoPj085VWAtqh5P3uD+euscZXv+TjXxy6H5aazZB195N35lzzvy+lpSixfUOfwFBK4UFqtvPIgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"CompileDebugAIDL\" title=\"CompileDebugAIDL\" src=\"https://developers.soundcloud.com/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/8ff1e/image5.png\" srcset=\"/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/9ec3c/image5.png 200w,\n/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/c7805/image5.png 400w,\n/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/8ff1e/image5.png 800w,\n/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/6ff5e/image5.png 1200w,\n/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/8d0ff/image5.png 1440w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Next, we saw a build cache miss for a generated class called <code class=\"language-text\">InAppBillingService.java</code>. This class is generated by the <code class=\"language-text\">compileDebugAidl</code> task that is part of the Android Gradle plugin. It looks for any source files ending in <code class=\"language-text\">.aidl</code>, and for each one, it generates a Java file before the <code class=\"language-text\">JavaCompile</code> task runs in your AIDL source directory. It then adds these generated Java files to the source directory of the <code class=\"language-text\">JavaCompile</code> task. We opened the generated Java source file to find this comment:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">/**\n * This file is auto-generated. DO NOT MODIFY.\n * Original file /Users/no/workspace/soundcloud/android/libs/src/main/java/com/soundcloud/android/InAppBillingService.aidl\n */</code></pre> \n</div> \n<p>This file is always going to generate a remote cache miss, because the absolute path is different on every machine. We used the power of Gradle to solve this one as well:</p> \n<div class=\"gatsby-highlight\" data-language=\"text\"> \n <pre class=\"language-text\"><code class=\"language-text\">tasks.named(\"compileDebugAidl\").configure {\n  doLast {\n    outputs.files.forEach { directory -&gt;\n      directory.traverse(type: FILES) { file -&gt;\n        file.setText((file as String[]).findAll {\n          !it.contains('Original file:')\n        }.join(‚\\n'), 'utf-8')\n      }\n    }\n  }\n}</code></pre> \n</div> \n<p>The above code snippet finds the <code class=\"language-text\">compileDebugAidl</code> task and adds a <code class=\"language-text\">doLast</code> action, which iterates through each of its lines and rewrites it as is, skipping the line that contains “Original file.” The file is now the same on every machine. That solved the build cache miss for us, but we want to make the world a better place, so we <a href=\"https://issuetracker.google.com/issues/121251997\">filed a bug against Google</a>.</p> \n<p>While examining this task, we also noticed that the <code class=\"language-text\">CompileAidl</code> task would take 1.3&nbsp;seconds to perform an up-to-date check — something which should typically be done in less than 10&nbsp;milliseconds. The reason it took longer is because the check filters the entire source tree. <a href=\"https://github.com/gradle/gradle/issues/8559\">A Gradle engineer opened an issue about this for us</a>, but in the meantime, as a workaround, we moved this AIDL file into its own module, reducing the run time to .003&nbsp;seconds.</p> \n<h2>The Result</h2> \n<p>There are, of course, a couple more build cache misses we fixed here and there that aren’t mentioned in this article. One fun thing to note: Make sure your annotation processors generate the same code locally as on CI. And when annotation processors generate lists, make sure they are ordered or sorted, as code may be processed in different orders on CI.</p> \n<p>The end result of all this work was quite noticeable when looking at build times because speed gains from modularization are multiplied by improving cache hits. In the week before this work started, our build times were 49.55&nbsp;seconds on average.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/76cb8e39479ca79c859eeccb79c9d418/8d0ff/image4.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.916666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAwklEQVQY02VQ2QrCQAzs/3+eL+KLIIK1as+9ulfHzEqp2oGQbCbHZKsQI3wIyHkBsSybj8KFL1u5lDKcm2GshXVObP7UhoiqHydoIb4HEVk8Cyeli7GRi4kgvusHvNoez1eHfpjKW0ldxc35b9ga55wRUyrbGdMI5rjAWIdJa2hjimLvAyomtbHlpB+F0jwqBaXNjmtFzeF4wvlyxe3+QH1vYGQGhxaFPG32fveHRlS4ecuvHBvr5om2Gz5XxFS+gQrf+WiHFbX5pX4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Before build times\" title=\"Before build times\" src=\"https://developers.soundcloud.com/blog/static/76cb8e39479ca79c859eeccb79c9d418/8ff1e/image4.png\" srcset=\"/blog/static/76cb8e39479ca79c859eeccb79c9d418/9ec3c/image4.png 200w,\n/blog/static/76cb8e39479ca79c859eeccb79c9d418/c7805/image4.png 400w,\n/blog/static/76cb8e39479ca79c859eeccb79c9d418/8ff1e/image4.png 800w,\n/blog/static/76cb8e39479ca79c859eeccb79c9d418/6ff5e/image4.png 1200w,\n/blog/static/76cb8e39479ca79c859eeccb79c9d418/8d0ff/image4.png 1440w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span><br /><br /></p> \n<p>Even accounting for four months of increased codebase size, after the majority of this work was done, our average build speed dropped to 36.84 seconds on average. You can also note the increased remote and local build cache usage.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/80c61460f17ee696ff909c16ef038f4a/8d0ff/image2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.63888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAAuklEQVQY012Q2QrCMBRE8//f5osi4rsgLmCbfW3HzNUWbSBMkjs5d1ExJaScMc8zuH611IqUMnIu4pmmSWJU6zy0sRi1EQ0xIsYENcolrZAFyE8E+RDgae6Ja2urjyDu1zAK0BiHYdRQrZu21S1nQhlfPEu81gZjnSSjEhRCRC4FyveDcU7a+4USpq2F9b4D/mNsb386Y3c44nK94f54wnYwoVIhyVugzPD7vu2g9WRSmdZ9LJ/5k8PEb7uQhyl/NWlhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"After build times\" title=\"After build times\" src=\"https://developers.soundcloud.com/blog/static/80c61460f17ee696ff909c16ef038f4a/8ff1e/image2.png\" srcset=\"/blog/static/80c61460f17ee696ff909c16ef038f4a/9ec3c/image2.png 200w,\n/blog/static/80c61460f17ee696ff909c16ef038f4a/c7805/image2.png 400w,\n/blog/static/80c61460f17ee696ff909c16ef038f4a/8ff1e/image2.png 800w,\n/blog/static/80c61460f17ee696ff909c16ef038f4a/6ff5e/image2.png 1200w,\n/blog/static/80c61460f17ee696ff909c16ef038f4a/8d0ff/image2.png 1440w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span><br /><br /></p> \n<p>From 49.55 to 36.84 seconds per build on average is a huge change in the day-to-day lives of developers, as our team averages around 40 builds per developer per day. It doesn’t just mean that developers are faster at writing code. Having faster build speeds means that developers have more time to explore the realm of possibilities when building new features. More explored possibilities leads to more maintainable code, increased app stability, and fewer bugs.</p> \n<p>If you’d like to learn more, check out “Remote Build Cache Misses” from <a href=\"https://www.meetup.com/berlindroid/events/259762503/\">BerlinDroid Gradle Night</a>. You can <a href=\"https://youtu.be/2frfDMJwvf4?t=384\">watch the talk</a> or <a href=\"https://speakerdeck.com/runningcode/remote-build-cache-misses-and-how-to-solve-them-by-annoying-your-colleagues\">browse the slides</a>.</p>","descriptionType":"html","publishedDate":"Tue, 01 Oct 2019 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/5029c683c9dcd142b5276343646200ed/8ff1e/image3.png","linkMd5":"2a094ed2b890cb88dd022b4f84947b7c","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn50@2020_3/2020/08/25/00-49-37-637_07dc701f6525d285.webp","destWidth":800,"destHeight":456,"sourceBytes":9731,"destBytes":31630,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/5029c683c9dcd142b5276343646200ed/8ff1e/image3.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn50@2020_3/2020/08/25/00-49-37-637_07dc701f6525d285.webp","https://developers.soundcloud.com/blog/static/70603488e2cd0a1203e737d7a5ddd23e/1b142/image1.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn28@2020_2/2020/08/25/00-51-45-317_6d23fcfcbaf04eab.webp","https://developers.soundcloud.com/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/8ff1e/image5.png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn19@2020_6/2020/08/25/00-51-44-193_f16ddd47f1b8594c.webp","https://developers.soundcloud.com/blog/static/76cb8e39479ca79c859eeccb79c9d418/8ff1e/image4.png":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn27@2020_3/2020/08/25/00-51-40-373_2b57a3fd127df466.webp","https://developers.soundcloud.com/blog/static/80c61460f17ee696ff909c16ef038f4a/8ff1e/image2.png":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn7@2020_2/2020/08/25/00-51-40-709_02d9235eda88299a.webp"},"publishedOrCreatedDate":1598316569971},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Introducing the Android Sharing Kit","link":"https://developers.soundcloud.com/blog/introducing-the-android-sharing-kit","description":"<p>Are you an Android developer and want to integrate SoundCloud in your own app? With the new Android Sharing Kit this has become very easy.</p> \n<!-- more --> \n<p>The first music app to make use of this is the <a href=\"https://soundcloud.com/apps/rd3-groovebox\">RD3 Groovebox</a> by fellow Berlin-based company <a href=\"http://www.mikrosonic.com/\">Mikrosonic</a> - create some loops on the go and share them on SoundCloud immediately afterwards.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/0e63600ee724b585ba9430793db4d27f/c7805/soundcloud_rd3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAARlAAAEZQAGA43XUAAACWUlEQVQoz3VSy28SYRD/YGHf7AK7++17gXYfDbZFja0xJiZaE62JiV48+gd48tqLVy5VemprrAQq8joQjJ7khhCJtZawqcaE+PhPHOjFmPjL7GT2m5lv5jffIAsTti4qScJUBaxqlmnKsmzbtq7rpmmqqhqPxyORSDQaJYgoQshQ+VvXvLsb/lrBRprMKlICKzKGT5YhWlEUluNommEYlqIZiqLIvwQOsCwuudjURISxaluGbZv5/LkgCKDm6uoKTcbR/0GSlCCmSIpBuoZvb1zQdUwQMZ7nwLd5/fLrg52D3afl/Wcvd7fLe9v1ym6jul+v7DWqz1+92Lm6tuL5QSqZRJah3NlYMy0HmgaSDMs/eng//Ngb9t59eP8GZNB7Ow0//fx6/Ovb8e/v4x/h6OaVgmZYqVQSAUnfzYmiADVhLKATPBssZhxDXXAMEMcAejKWRI6KsSRBEohlaMhiWRZlMhnf9wVBgGHSFBGPRQVB1DRTVnAylYaJpNKSghVBYOHeOEkmOBIahhSY5ywZ5sTz/MwXjcwqi7y3bOm6YVmWYRiSJGFFymV0eI/HDzY/P7m3smDlFj2e4xC48/k8XAEGcAblem7h4vLSHFDB8zzQEOMHwfr51RvrlxZzOQilaRqd7UOpVJpOp2EYjsfjo6OjySScTCaDwaDf78PhzB4OR6PRl5OT8PS0XC5ns9kZZ0h2HGdra6vb7TYajXq9XqvV2u12q9U6PDysVqtndqVSgd9ms9npdIrFouu6HLQtz18IetY0DcOWzQE80+m0NEd6jn9s0LB5fwBUMZ9DL3u8ywAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"SoundCloud+RD3\" title=\"SoundCloud+RD3\" src=\"https://developers.soundcloud.com/blog/static/0e63600ee724b585ba9430793db4d27f/c7805/soundcloud_rd3.png\" srcset=\"/blog/static/0e63600ee724b585ba9430793db4d27f/9ec3c/soundcloud_rd3.png 200w,\n/blog/static/0e63600ee724b585ba9430793db4d27f/c7805/soundcloud_rd3.png 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" loading=\"lazy\" /> </a> </span></p> \n<p>Since the integration is based on the standard Android intent model you only need to add a few lines of code to share sounds from your application - all the hard work is done by our <a href=\"https://play.google.com/store/apps/details?id=com.soundcloud.android\">Android app</a>. Check out the <a href=\"https://github.com/soundcloud/android-intent-sharing/wiki\">Android Sharing Kit</a> page for more documentation and code samples.</p> \n<p><span><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 128px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/627ca2cefc8e46c624bf881c0041f3f2/6b190/android_share_logo.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZ0lEQVQ4y31U20tUQRxeraCXsoyiB7UIIirNtJ05u6aI0EPQP9BjUBGBD0UQURBEV5Seinpwdc/eXHXVLuZ2UVn3XNb1mlZ0oetDQemLRELs7dc3Z8+ul9UOfMzMmfl98/u+38xYLAs+l8oNpPus2KPZS4y+wrbg/w5ZsW4WY49etVNWrVuXxliWki1sX327n+cMV15rCu1+gX+/ZYXF0c42hfb0t4TLL68Ut2gHtypZEJgv+gg62zl+iNQvZ8ilWcmtSSSrFRT+XE/d40cIxPVmfD7UZFQt3gE/VpvENa0jjPzROno2dSoOqeRSJXIqFRScPB4PjB4md+QAwRKrWC8bpDxXbnas8DttozYQHJhzDJbGMB+DjzG3wmPNg2UxWDHXPm7HJvyWWO/VpPyFGeaZpOuBQaARuILJKNoBt2oLuRUWcqo85NBtIRfG2HBAVtkw5i8BXmAIKMhkZ7Lzmp4P1WLX70BEZOhROaRBatRGbZAd7Csjn87gKaeOcRs85c9B/icwaWRbtZSwun3MJiY+AJp3WCLHkJQI9FWkeh+XpqacJanZhg2p180lqRZdinvFWoX1gvSXJ8LR5zyHsGPCLiY+yRrXAwqj3s69ybF72+nt7SL6en0rzVwopOmLhfSusSjRM1BJLREpCNJpX1QSidhyJKcJ2ZeWISnS83Q/TTRsS07dKKHXV4vp83kQnthI0ycLafZYQWKwq5Sahm1BV5hNtw5Ly0vueGl48VFI9mGRd8Ca9D+rpLanldT5aD89bi8z8KC7POEfMTwUGc74hiShTPqfh7qQAelJp85JAPKoOWoC3vpHDQ+DqPZPj86XJcxU+YfIsFX4orAkQFmEszAyxLpeYK7rVZXoZwkz57BAnDvgJtBuZpsARJvClUyJ1hzHDb9V7kyfWe7D7Vq78k1R+cNA2s+EbJK4cfbE+ZNFpiDsnDQK2JrzwCy4y3lYvMrs3zU8VFksnRHDfWZ/jSuYzjZuVrbBuMsKWzP/2mg85wmCwWvR3wXC6MO3B0XgDQQVoj3q1g3JgrzOE87aZTEfifl0HVpZjnyQPO95Xy0qeNqcKzc9nHNp0qbFRWW5DywCjRZEmZ31/u+1guCcObaLYnjSWRZnrEo/fZJl2W8JYT3wBthnjtcBTwCXX6/NW66g/wCVr7kga+yH3QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"SoundCloud+RD3\" title=\"SoundCloud+RD3\" src=\"https://developers.soundcloud.com/blog/static/627ca2cefc8e46c624bf881c0041f3f2/6b190/android_share_logo.png\" srcset=\"/blog/static/627ca2cefc8e46c624bf881c0041f3f2/6b190/android_share_logo.png 128w\" sizes=\"(max-width: 128px) 100vw, 128px\" loading=\"lazy\" /> </a> </span></span></p> \n<p>Happy coding on Android!</p>","descriptionType":"html","publishedDate":"Wed, 07 Sep 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/0e63600ee724b585ba9430793db4d27f/c7805/soundcloud_rd3.png","linkMd5":"ac3bc732414f0a55c1817f5e2c37e352","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn73@2020_3/2020/08/25/00-49-38-769_a177b50ceb1713e7.webp","destWidth":400,"destHeight":240,"sourceBytes":12624,"destBytes":10408,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/0e63600ee724b585ba9430793db4d27f/c7805/soundcloud_rd3.png":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn73@2020_3/2020/08/25/00-49-38-769_a177b50ceb1713e7.webp","https://developers.soundcloud.com/blog/static/627ca2cefc8e46c624bf881c0041f3f2/6b190/android_share_logo.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn13@2020_2/2020/08/25/00-51-42-029_2f40b1fce0ff3ed2.webp"},"publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Waveforms, Let's Talk About Them","link":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","description":"<p><img src=\"http://img.svbtle.com/inline_leemartin_24131769094098_raw.png\" alt=\"Waveforms\" /></p> \n<p>I’ve worked at <a href=\"https://soundcloud.com\">SoundCloud</a> for over two years now, and if there’s one thing I do a lot, it’s color <strong>waveforms</strong>. Tons of them. And, I’ve done it <em>several</em> different ways. Today, <a href=\"https://twitter.com/johanneswagener\">Johannes</a> and <a href=\"https://twitter.com/leemartin\">I</a> are <strong>pumped</strong> to announce a new JavaScript library called <a href=\"http://www.waveformjs.org\">Waveform.js</a> that will assist you in your coloring efforts. But first, let’s take some time to look back and learn from past techniques.</p> \n<!-- more --> \n<h2>Element Stacking</h2> \n<p>If you’ve used our <a href=\"https://dev.soundcloud.com\">API</a> before, you’ll know that each track resource contains a <code class=\"language-text\">waveform_url</code> that points to a 1800 x 280 pixel <a href=\"https://w1.sndcdn.com/cWHNerOLlkUq_m.png\">PNG</a> of that particular sound. The classic way of coloring this image was to <em>not color it at all</em>. Instead, you would simply <em>stack</em> it on top of two or three absolutely positioned DIVs whose size was adjusted given the <strong>loading</strong> or <strong>playing</strong> state of that sound.</p> \n<p><img src=\"http://img.svbtle.com/inline_leemartin_24131748089754_raw.png\" alt=\"Stack\" /></p> \n<p>So, what’s wrong with this technique? Well, you can’t adjust the <strong>outer color</strong> of the waveform image. So unless the area <em>around</em> the waveform is <strong>#E5E5E5</strong>, things are going to look subpar.</p> \n<h2>Webkit Mask</h2> \n<blockquote> \n <p>I saw the future, and it was Webkit</p> \n</blockquote> \n<p>Webkit browsers can overcome the outer color issue with a new css function called <a href=\"https://developer.mozilla.org/en/CSS/-webkit-mask-box-image\">webkit-mask-box-image</a>. This function colors a div to the shape of a provided mask. In this case, our <strong>waveform image</strong>. Check out the example below:</p> \n<div class=\"gatsby-highlight\" data-language=\"css\">\n <pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.waveform</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">-webkit-mask-box-image</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>https://w1.sndcdn.com/cWHNerOLlkUq_m.png<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> #81D8D0<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 500px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n&lt;div class=<span class=\"token string\">\"waveform\"</span>&lt;/div&gt;</code></pre>\n</div> \n<p><img src=\"http://img.svbtle.com/inline_leemartin_24131758138488_raw.png\" alt=\"Webkit Mask Box Image\" /></p> \n<p>It’s simple to code and damn powerful. You can combine this function with the <strong>element stacking</strong> technique above to generate nice waveforms in most environments. But what about <em>non-webkit</em> browsers? <strong>HTML 5</strong> to the rescue!</p> \n<h2>Canvas</h2> \n<p><a href=\"http://en.wikipedia.org/wiki/Canvas_element\">Canvas</a> adoption is rapidly increasing and for good reason - it fucking rules. With <code class=\"language-text\">canvas</code> we can dynamically manipulate an area of pixels with basic JavaScript. By placing the <strong>waveform image</strong> mask onto the canvas and looping through each pixel, we can adjust the <strong>outer color</strong> accordingly by simply asking <strong>“Is this pixel non-transparent?”</strong> and changing it to a specified color.</p> \n<p>However, there is one <strong>caveat</strong>: the <a href=\"http://en.wikipedia.org/wiki/Same_origin_policy\">Cross-Domain Origin Policy</a>. If you’ve developed with <code class=\"language-text\">canvas</code> before, you know that accessing and manipulating images from different domains or origins is prohibited. [1] But, we can get around this by accessing the image via the server, and I wrote a service that does exactly that.</p> \n<p><a href=\"http://wave64.it\">Wave64</a> exists as an endpoint you pass a SoundCloud <code class=\"language-text\">waveform_url</code> to from the client. It will then read that image on the server and return a <strong>Base64</strong> encoded text blob [2] which can be manipulated by <code class=\"language-text\">canvas</code>. I combined this endpoint with some jQuery and wrote the <a href=\"http://wave64.it/#plugin\">$.wave64</a> plugin which takes a waveform url, height, width, and color and returns the colored waveform.</p> \n<p>Problem solved? <strong>Never.</strong> Programming is a math problem you can only make harder on yourself, and as such Johannes and I sought out to simplify this even more.</p> \n<h2>Waveform.js</h2> \n<blockquote> \n <p>Damn Good Waveforms - Eric Wahlforss, CTO of SoundCloud</p> \n</blockquote> \n<p><a href=\"https://twitter.com/johanneswagener\">Johannes</a> had the bright idea to analyze the waveform image’s <strong>peaks</strong> and store their values in an array of floating points. <strong>HUH..?</strong> Take a look at the image below:</p> \n<p><img src=\"http://img.svbtle.com/inline_leemartin_24131771379756_raw.png\" alt=\"Peaks\" /></p> \n<p>If every column was considered a <strong>point</strong>, it’s value would be a floating decimal from 0 to 1 depending on it’s height. So, we wrote a basic server-side script using <a href=\"http://rmagick.rubyforge.org/\">RMagick</a> to analyze the columns, convert them into 1800 floating points, and cache the result.</p> \n<p><strong>Don’t believe me?</strong> Here’s <a href=\"http://www.waveformjs.org/w?url=https://w1.sndcdn.com/cWHNerOLlkUq_m.png&amp;callback=?\" target=\"_blank\">Forss - Flickermood</a>.</p> \n<p>In addition, Johannes also wrote the <strong>new</strong> <a href=\"http://www.waveformjs.org\">Waveform.js</a> JavaScript library to convert this data into a <code class=\"language-text\">canvas</code> generated (and interpolated) waveform. Simply provide the <strong>container</strong> where it will live, an <strong>innerColor</strong> &amp;&amp;|| <strong>outerColor</strong>, and the provided <strong>waveform data</strong> array. Like so:</p> \n<div class=\"gatsby-highlight\" data-language=\"javascript\">\n <pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">Waveform</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  container<span class=\"token punctuation\">:</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"waveform\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  innerColor<span class=\"token punctuation\">:</span> <span class=\"token string\">\"#81D8D0\"</span><span class=\"token punctuation\">,</span>\n  data<span class=\"token punctuation\">:</span> <span class=\"token constant\">WAVEFORM_DATA</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre>\n</div> \n<p><img src=\"http://img.svbtle.com/inline_leemartin_24132127653036_raw.png\" alt=\"Waveform.js\" /></p> \n<p>Psyched? Yeh, me too. And, not only can you pass <em>colors</em> to the <strong>inner</strong> and <strong>outer</strong> color, you can also provide <strong>functions</strong>. Check out a few <a href=\"http://www.waveformjs.org/#examples\">examples</a> of this technique on <a href=\"http://www.waveformjs.org\">waveformjs.org</a>, including the ability to render both the <strong>loading</strong> and <strong>playing</strong> progress right into a single Waveform.</p> \n<p>Waveform.js is open-sourced <a href=\"https://github.com/soundcloud/waveform.js\">on Github</a> so go ahead and push, pull, and <strong>fork</strong> the hell out of it. You can report bugs and discuss features on the <a href=\"https://github.com/soundcloud/waveform.js/issues\">Github issues page</a>.</p> \n<h2>The End?</h2> \n<p><strong>Probably not.</strong> It would rock if the SoundCloud API provided the waveform array data right from the API so we wouldn’t even need the endpoint. I’ll keep complaining internally until this happens.</p> \n<h2>One More Thing</h2> \n<p>Johannes and I would like to thank our fellow co-workers <a href=\"https://twitter.com/tsenart\">Tomas</a> and <a href=\"https://twitter.com/ceterum_censeo\">Robb</a> for their wisdom when building <a href=\"http://www.waveformjs.org\">Waveform.js</a>. Make sure to throw some virtual <strong>high-fives</strong> their way.</p> \n<hr> \n <p>[1] However, there are a few <a href=\"http://en.wikipedia.org/wiki/Same_origin_policy#Workarounds\">workarounds</a>.</p> \n <p>[2] Thanks to <a href=\"https://twitter.com/maxnovakovic\">Max Novakovic</a> for the technique.</p>\n</hr>","descriptionType":"html","publishedDate":"Tue, 26 Jun 2012 00:00:00 +0000","feedId":10291,"bgimg":"http://img.svbtle.com/inline_leemartin_24131769094098_raw.png","linkMd5":"4b5f66442890e7eaea847ce0dd601b18","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"author":"","articleImgCdnMap":{"http://img.svbtle.com/inline_leemartin_24131769094098_raw.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","http://img.svbtle.com/inline_leemartin_24131748089754_raw.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","http://img.svbtle.com/inline_leemartin_24131758138488_raw.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","http://img.svbtle.com/inline_leemartin_24131771379756_raw.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","http://img.svbtle.com/inline_leemartin_24132127653036_raw.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg"},"publishedOrCreatedDate":1598316569983},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Experiment 01: Puzzle To Unlock","link":"https://developers.soundcloud.com/blog/marbleo.us","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 505px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/8939e/original3-1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75.04950495049505%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAAB9klEQVQ4y32U227iQBBE+f9/gweEwOaOAdvcbAxCCdJ6eus0HrTJKnkoeZjprq6+0VssFu1iPg+z2SzkeREOh4O+eSjL8kdg8y+Ox2PY7/dhuVyG3nA4DIPBwEajkaVJYmma2mq1Mhna6XSy8/lsl8tF34ufuROBidgU2Ha7nWXZxpIktX6/b73JZBISEaFwvV4HGUhF4VFFEKqqCnVdh+v16mfuYhZZlrkqiQgdT+iNx2MnVOoYeFTUAZSJzERmTdOYCP0OhaAoCsNHpJ6ZuF4KpY40UedEOFYiKoryTR4Bib8L/MZHmZGhietFOJ/PbbPZkIbXCEWAOkU1gDeAahRzxke+BocTkrfSRXogOoW/3W6OsmsMQA0kHx+fCtb4O7YxbTgo3S+E9/8IH4+HPZ9PJ7zf7z8Tfk8ZJU1ze49OHBUaAumvCmNTGBkNpztSo7q+uvH3ppxO53fnscXnSw0hnE6n3uXtduuNIDJdfA32pRuXbmR0V1W1n7HFh0WAwwnjHCpCIBIRUQIpKkiNegHO3PGGTVQX0/U5hJAD087U0xz2kp2N2yI1ry3RV6r9DZu4KVLnmwKXp4zUbv1cPlEZWNKhUbmU5DrvM5DZTr/jhsSBjoDwjxa7lUKHDFr+gUT8BWtBBO1KUAPdRspa+bdS1kqQ4y9bbk3P7ejZHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"original3 1\" title=\"original3 1\" src=\"https://developers.soundcloud.com/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/8939e/original3-1.png\" srcset=\"/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/9ec3c/original3-1.png 200w,\n/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/c7805/original3-1.png 400w,\n/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/8939e/original3-1.png 505w\" sizes=\"(max-width: 505px) 100vw, 505px\" loading=\"lazy\" /> </a> </span></p> \n<p>This “Puzzle to Unlock” concept came to me straight from Manchester Orchestra’s wonderful label/management team, and we were able to pull it together very quickly with <a href=\"https://soundcloud.com/developers\">SoundCloud</a>, <a href=\"http://jquery.com\">jQuery</a>, and <a href=\"http://www.schillmania.com/projects/soundmanager2/\">SoundManager2</a>.</p> \n<p>The band wanted to build a bit of excitement around the premiere of their new single “Simple Math.” So we developed a way to tease the song with dialogue from the artist and actual clips of audio released as “pieces” to a puzzle that will&nbsp;<em>unlock</em> both the album cover and track. Cool, right?</p> \n<p>Interaction was created using these basic jQuery commands: draggable and droppable.</p> \n<p>Every time you drag the puzzle piece from it’s container at the bottom a hidden droppable div moves to the right pixel location where the piece will fit. If you find that location, the piece will glow and dropping it will lock the piece into place.</p> \n<p>A successful drop will queue up a SoundManager2 powered / SoundCloud hosted track and morph the piece’s container into a nice little play/pause button for replaying purposes.</p> \n<p>Once all of these pieces are released and placed correctly, you’ll be able to hear the full version of “Simple Math,” and trust me – it’s worth building a puzzle for. Enjoy!</p>","descriptionType":"html","publishedDate":"Tue, 01 Mar 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/8939e/original3-1.png","linkMd5":"4a05e8fd6978c0c26c70489b4245773f","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn9@2020_4/2020/08/25/00-49-37-182_2fb9318516e541e5.webp","destWidth":505,"destHeight":379,"sourceBytes":24390,"destBytes":10638,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/8939e/original3-1.png":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn9@2020_4/2020/08/25/00-49-37-182_2fb9318516e541e5.webp"},"publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Experiment 02: Destroying SoundCloud & Instagram","link":"https://developers.soundcloud.com/blog/experiment-02-destroying-soundcloud-instagram","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 505px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/1b03927c03fc6c6558164d1b0bad3897/8939e/destroyed.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75.04950495049505%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAADLUlEQVQ4y5VTW09TWRQ+/6NieIDwICHhEghQoIVCIW2hQGkLLUgyLZcXH9RJjPPizzBRo8Y7QVuMwQdKKy3USSbRiENb4EFoixRlWsNgUqBnfa69iagxMXEnX9bZ6/Jlr7W+o8TjcTWRSJBAKpWira0tadPp9G9hY2ODOVZJyeVyfNlEJpPB3t4e+I79/X387snnD7C7uwtlaWmJfH4/ZmefUzgSplAoRIFAgO0LikQiEsFgkMLhMM3Pz9PCwgJFo1Fp5+bmTnBcEyKlt7eXBgcH4Rx0ksPhgM1mg31gAHa7Xdqenh60tbWB86DX62GxWGRMp9Ohlf1GYyeamprQ0NCA9vYOKENDQ+R0OtHX10eCbIBJrFxsE9ZqlclGo1Givr4eLS0taG1tRV1dHRobG5moka0WXV1dcLncUEwmE4mEy39dIr//MWb8PoSDQYQCAfh9T3D37m1cu34VkcUIoktRcOvgMWBxcVF+//3yJaamptDRYeQH9ELhdkin0+PW7Rt0/8FNaLUNuOIdwTmXHd1WC6an7+HNm1e/XEgymYR7eBjDIyNQDAYDiRn5fE/o9et/8OjRHTx7Oo3Zxw/x/Jkfb/9dxubmJg4ODnB4eCiRTqXx/v229ImzsrICt9sNh8P5jXDm6Qxls/+xfLawth7D2loMOzvbSKWSbHdYSp+Ry2aRSqYYafanwZrF/3v7WF5+K5dmMpmPCfU8Q7F6ob/V1Ti2t9P48DHDL3snyTKM78/R0REKhQKIju/r6+u8EBeESo4JWQ5CR4lEHLHYCj59yjJyiMVjMlm8Mp/PS6KvZIXC0UnL/LdJQoGTlodcLhIOj8cDr9eDsbExtl542Xo8f2BychITExPSPz4+LiG+z5+/gIsX/5QzlIRiy4KwubmZBLRa7Q8Qvs7OTurvt5HZYiGdXk8sYhljHRLrksxmM/VYreRwOkmpqqoiBqqrqyVqamp+ghgJk0pxGwzt0LLYa2trZUzUiPrKykqWnBaKRnOqUFFRoZ4pP6OWlpaqJSUlqkajkSgqOq32u86qDtewOjo6qnZ3d8t4WVkZx4pkTnl5uSrqhb+4uFj9AvWbLalJwr7bAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"destroyed\" title=\"destroyed\" src=\"https://developers.soundcloud.com/blog/static/1b03927c03fc6c6558164d1b0bad3897/8939e/destroyed.png\" srcset=\"/blog/static/1b03927c03fc6c6558164d1b0bad3897/9ec3c/destroyed.png 200w,\n/blog/static/1b03927c03fc6c6558164d1b0bad3897/c7805/destroyed.png 400w,\n/blog/static/1b03927c03fc6c6558164d1b0bad3897/8939e/destroyed.png 505w\" sizes=\"(max-width: 505px) 100vw, 505px\" loading=\"lazy\" /> </a> </span></p> \n<p>I was fortunate enough to be given the opportunity to help Moby premiere his new record via SoundCloud. I didn’t know what to expect from <a href=\"https://twitter.com/thelittleidiot\">@TheLittleIdiot</a>‘s latest piece of work. However, I soon learned he had created a phenomenal album with a perfectly crafted and inspiring theme: <a href=\"http://destroyed.moby.com\">Destroyed</a></p> \n<blockquote>\n  i don’t sleep very well when i travel. and as a result, i tend to be awake in cities when everyone else is asleep. that’s where this album, and the pictures that accompany it come from. it was primarily written late at night in cities when i felt like i was the only person awake (or alive), a soundtrack for empty cities at 2 a.m, at least that’s how i hear it. the pictures were taken on tour while i was writing the album. i wanted to show a different side of touring and traveling. a side that is often mundane, disconcerting, and occasionally beautiful. \n</blockquote> \n<p>ME == PUMPED</p> \n<p>I immediately started on a very simple idea: Adding Moby’s photos to a map which users could explore while experiencing the record. A good digital marketing theme cannot stand on it’s own without a firm technical foundation, so I combined three of my favorites: <a href=\"http://polymaps.org/\">Polymaps</a>, <a href=\"http://instagr.am/\">Instagram</a>, and of course <a href=\"https://soundcloud.com/\">SoundCloud</a>.</p> \n<p>Using <a href=\"http://rubyonrails.org/\">Rails</a> as a base, I developed a very simple and clean map/player interface using <a href=\"http://jquery.com/\">jQuery </a>, CSS3, and PolyMaps. A photo model was then created and <a href=\"https://twitter.com/tomdef\">Tom Packer</a> &amp; I added each of Moby’s photos including his captions. Then I built a basic custom SoundCloud player into the header area which pulls the Destroyed set right from Moby’s account via <a href=\"https://developers.soundcloud.com/\">our api</a>.</p> \n<p>Finally, we added some interaction by allowing fans to submit their own photos via Instagram. New photos tagged #destroyed are pulled in hourly via the <a href=\"http://instagram.com/developer/\">Instagram API</a>. And this layer of content creation is interesting because users are more likely to revisit their past photos than say a status update, constantly reminding them of the record.</p>","descriptionType":"html","publishedDate":"Wed, 11 May 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/1b03927c03fc6c6558164d1b0bad3897/8939e/destroyed.png","linkMd5":"9fdc4321c8110441beb066136d226f81","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn81@2020_3/2020/08/25/00-49-37-866_8d1852442313f12b.webp","destWidth":505,"destHeight":379,"sourceBytes":23955,"destBytes":16200,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/1b03927c03fc6c6558164d1b0bad3897/8939e/destroyed.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn81@2020_3/2020/08/25/00-49-37-866_8d1852442313f12b.webp"},"publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Implementing Dark Mode Using the Observer Pattern","link":"https://developers.soundcloud.com/blog/dark-mode-observer-pattern","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/9f2bb119f1570b22f3d0f703746adc51/cc43b/banner.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeUzsIwf/8QAGhABAAEFAAAAAAAAAAAAAAAAAQIAAxAiMf/aAAgBAQABBQJoiubG0nv/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAEBAAMBAAAAAAAAAAAAAAABAAIQIdH/2gAIAQEABj8Cvdpl0Cb/xAAbEAADAAIDAAAAAAAAAAAAAAAAASERMRBBof/aAAgBAQABPyFpB/In3GeHsVIGgTuKeo//2gAMAwEAAgADAAAAECDv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QWf/EABwQAQACAgMBAAAAAAAAAAAAAAEAESExUWFxgf/aAAgBAQABPxDZtY54qAhBFFp4WLTNnkJBibToHUIAFAsfZ//Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"banner\" title=\"banner\" src=\"https://developers.soundcloud.com/blog/static/9f2bb119f1570b22f3d0f703746adc51/a296c/banner.jpg\" srcset=\"/blog/static/9f2bb119f1570b22f3d0f703746adc51/f544b/banner.jpg 200w,\n/blog/static/9f2bb119f1570b22f3d0f703746adc51/41689/banner.jpg 400w,\n/blog/static/9f2bb119f1570b22f3d0f703746adc51/a296c/banner.jpg 800w,\n/blog/static/9f2bb119f1570b22f3d0f703746adc51/c35de/banner.jpg 1200w,\n/blog/static/9f2bb119f1570b22f3d0f703746adc51/8179c/banner.jpg 1600w,\n/blog/static/9f2bb119f1570b22f3d0f703746adc51/cc43b/banner.jpg 4000w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Last week’s update to the SoundCloud iOS app includes support for Dark Mode. This took several months of work and collaboration between design and engineering teams across the company, so we wanted to share our approach to implementing Dark Mode and some of the obstacles we encountered along the way.</p> \n<p>Apple did an excellent job implementing Dark Mode in iOS 13, but because it’s important for us to support compatibility with previous versions of iOS, we decided to build our own implementation of themes. To achieve this, we built a fast, type-safe, and powerful observer pattern in Swift.</p> \n<h2>Observer Pattern</h2> \n<p>The observer pattern is a one-to-many relationship between objects, meaning that when one object changes its state, all of its dependent objects are notified and updated with the new state. Looking at this design in another way, the observer pattern can be seen as a delegation pattern with one-to-many delegates. We can think of it as the foundation of reactive programming.</p> \n<p>The key objects in this pattern are the <em>subject</em> and the <em>observers</em>. A subject may have any number of dependent observers, and all observers are notified whenever the subject undergoes a change in state. It’s important to note that the observers do not access the state directly, because this can lead to dangerous race conditions.</p> \n<p>How? It could be that while an observer is accessing the subject’s state, the state is changed from another thread. But the possible combinations of things that can go wrong here are exponential, so it’s a requirement that the subject informs the observers about state changes and never the other way around.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 491px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/502e61b8f647e521bd358d44e2668cf5/3bb78/uml.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 42.973523421588595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABN0lEQVQoz3WSy46CUAyGef93YuXOyAIXJioQRZEgVy8gKNDJ1+QQnMw0aZrTy9/277Fer5ecz2fZ7XZSVZU8n0+5Xq9S17W0bStGPp+PjOP4pcaHGGsNwyB5nito0zQKVBSFJtxuNwUty1Iej4fEcSxJkqhN01R9pukEuFqtxHEcwa7XawVEka7rtEkURWqPx6M2PhwOaue5E+BisRDbtmW5XOpEBOg8l/v9Lvv9XjzPm+z7/dY8k2tosOAMJ53gk2LsXCjOskzXhQ4Uvqnr+/4r15o/zNjwCihAFBheoYAYPuLwiOVNLsNZvy+HkEQQnk6nk/i+r6sCzFTwicUHn8TZYLvd/j0hhSRcLhcFRVkXOuAZJc6xiIVhqAO4rvs/IBc1B+CP8j1YDVC+URAEGmcqcpHNZiM/BbGv0I5sW8gAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"uml\" title=\"uml\" src=\"https://developers.soundcloud.com/blog/static/502e61b8f647e521bd358d44e2668cf5/3bb78/uml.png\" srcset=\"/blog/static/502e61b8f647e521bd358d44e2668cf5/9ec3c/uml.png 200w,\n/blog/static/502e61b8f647e521bd358d44e2668cf5/c7805/uml.png 400w,\n/blog/static/502e61b8f647e521bd358d44e2668cf5/3bb78/uml.png 491w\" sizes=\"(max-width: 491px) 100vw, 491px\" loading=\"lazy\" /> </a> </span></p> \n<h2>State to Be Notified</h2> \n<p>But first we need something to notify the observers of, which is the state that we want to spread across X number of observers. In our case: We want to notify the observers when a color theme changes across the app.</p> \n<p>Let’s start by defining an abstract <code class=\"language-text\">Theme</code> as our state:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">protocol</span> <span class=\"token builtin\">Theme</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> main<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIColor</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">get</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Now we can define, for example, a concrete <code class=\"language-text\">DarkTheme</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DarkTheme</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Theme</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> main<span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIColor</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>black\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<h2>Observers</h2> \n<p>In our case, an observer is going to be a <code class=\"language-text\">View</code> or a <code class=\"language-text\">ViewController</code> that is interested in using colors. Following the “<a href=\"https://stackoverflow.com/questions/383947/what-does-it-mean-to-program-to-an-interface/384067#384067\">program to an interface</a>” philosophy, let’s first define an observer as a protocol:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">protocol</span> <span class=\"token builtin\">ThemeObserver</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>theme<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Theme</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Now we can implement a concrete observer — for example, in a <code class=\"language-text\">LoginViewController</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ThemeObserver</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>theme<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Theme</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        backgroundColor <span class=\"token operator\">=</span> theme<span class=\"token punctuation\">.</span>main\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>That’s great! Now our <code class=\"language-text\">LoginView</code> is an observer that can be notified about <code class=\"language-text\">Theme</code> updates.</p> \n<h2>Subject</h2> \n<p>Here is when things get really interesting. We need to define an object that will allow observers to subscribe to state changes by providing an interface for attaching and detaching observers. In addition, the subject will provide an interface to reach observer objects when its internal state changes. In response to a state change, the subject will broadcast the new state to all subscribed observers.</p> \n<h3>Abstract Subject</h3> \n<p>Following the interface segregation principle, let’s start defining the interface for a subject that allows observers to subscribe to and detach from it. This interface is going to be visible from any observer that wants to subscribe to notifications, however, the interface will make it impossible to access the state directly, thereby preventing race conditions or undesirable state updates from the clients:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">protocol</span> <span class=\"token builtin\">Subject</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Themable</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">detach</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Themable</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<h3>Concrete Subject</h3> \n<h4>Internal Data Structure</h4> \n<p>We want to be able to keep a reference to each observer, but without taking care of the memory management of these objects. In essence, we need to find a data structure that holds objects weakly, in order to prevent memory leaks.</p> \n<p>First and foremost, we want to keep one (and only one) reference to each object to prevent a double subscription of the same observer. The main reason is that multiple subscriptions of the same observer can result in multiple notifications of new states.</p> \n<p>In addition, we need to provide a fast and cheap way to subscribe new observers.</p> \n<p>If you’re thinking this sounds like a <code class=\"language-text\">Set</code> data structure, you’re correct! We needed to build a <code class=\"language-text\">Set</code> that can only hold objects weakly. So after some research, we found a Foundation class called <code class=\"language-text\">NSHashTable&lt;ObjectType&gt;</code> that can reference objects weakly and add and access objects in constant time, O(1):</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> observers <span class=\"token operator\">=</span> <span class=\"token builtin\">NSHashTable</span><span class=\"token operator\">&lt;</span>T<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">.</span><span class=\"token function\">weakObjects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre> \n</div> \n<p>To make the data structure more useful, we can extend it and create a reusable generic <code class=\"language-text\">WeakSet</code> class:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">import</span> <span class=\"token builtin\">Foundation</span>\n\n<span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">WeakSet</span><span class=\"token operator\">&lt;</span>T<span class=\"token punctuation\">:</span> <span class=\"token builtin\">AnyObject</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Sequence</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ExpressibleByArrayLiteral</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> objects <span class=\"token operator\">=</span> <span class=\"token builtin\">NSHashTable</span><span class=\"token operator\">&lt;</span>T<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">.</span><span class=\"token function\">weakObjects</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> objects<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>T<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> object <span class=\"token keyword\">in</span> objects <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">insert</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">required</span> <span class=\"token keyword\">convenience</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>arrayLiteral elements<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>elements<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">var</span> allObjects<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>T<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> objects<span class=\"token punctuation\">.</span>allObjects\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">var</span> <span class=\"token builtin\">count</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Int</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> objects<span class=\"token punctuation\">.</span><span class=\"token builtin\">count</span> <span class=\"token comment\">// Note that this count may be an overestimate, as entries are not necessarily purged from the `NSHashTable` immediately.</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> object<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">Bool</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> objects<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function\">insert</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> object<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        objects<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token number\">_</span> object<span class=\"token punctuation\">:</span> T<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        objects<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function\">makeIterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">&gt;</span> <span class=\"token builtin\">AnyIterator</span><span class=\"token operator\">&lt;</span>T<span class=\"token operator\">&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> iterator <span class=\"token operator\">=</span> objects<span class=\"token punctuation\">.</span><span class=\"token function\">objectEnumerator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> <span class=\"token builtin\">AnyIterator</span> <span class=\"token punctuation\">{</span>\n            iterator<span class=\"token punctuation\">.</span><span class=\"token function\">nextObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span><span class=\"token operator\">?</span> T\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<h3>Unit Test</h3> \n<p>And of course, <a href=\"https://gist.github.com/matiasvillaverde/5d3b895fcc77bd9d6ef0749b56258427\">let’s unit test it</a>!</p> \n<h3>Concrete Subject</h3> \n<p>Now that we have a solid data structure to work with, we can define a concrete subject:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token builtin\">ThemeSubject</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Subject</span>  <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> observers<span class=\"token punctuation\">:</span> <span class=\"token builtin\">WeakSet</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">ThemeObserver</span><span class=\"token operator\">&gt;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">:</span> <span class=\"token builtin\">ThemeObserver</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        observers<span class=\"token punctuation\">.</span><span class=\"token function\">insert</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">detach</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">:</span> <span class=\"token builtin\">ThemeObserver</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        observers<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<h2>Now Let’s Bring Everything Together</h2> \n<p>Sweet! So far, we have created a <code class=\"language-text\">ThemeObserver</code> and our <code class=\"language-text\">ThemeSubject</code>. Now let’s provide a default way to subscribe our observers to the subject. We can do this as a protocol extension of <code class=\"language-text\">ThemeObserver</code>. We will define a subscribe method that will access a shared instance of <code class=\"language-text\">ThemeSubject</code> to subscribe our view to the subject:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">extension</span> <span class=\"token builtin\">ThemeObserver</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">func</span> <span class=\"token function\">subscribeForThemeUpdates</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">ThemeSubject</span><span class=\"token punctuation\">.</span>shared<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">:</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Now we can add a state to our <code class=\"language-text\">ThemeSubject</code>. In our example, this will be <code class=\"language-text\">Theme</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token builtin\">ThemeSubject</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Subject</span>  <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> observers<span class=\"token punctuation\">:</span> <span class=\"token builtin\">WeakSet</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">ThemeObserver</span><span class=\"token operator\">&gt;</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">:</span> <span class=\"token builtin\">ThemeObserver</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        observers<span class=\"token punctuation\">.</span><span class=\"token function\">insert</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">detach</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">:</span> <span class=\"token builtin\">ThemeObserver</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        observers<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>observer<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">var</span> state<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Theme</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">didSet</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Theme</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> state\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function\">notify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        observers<span class=\"token punctuation\">.</span>compactMap <span class=\"token punctuation\">{</span> observer <span class=\"token keyword\">in</span>\n            observer<span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>theme<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>That’s awesome! Now every time we set a new state to <code class=\"language-text\">ThemeSubject</code>, all our observers’ views will receive the notification with the new theme. The code below shows how we can use this:</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginViewController</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">UIViewController</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">ThemeObserver</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function\">viewDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">viewDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">subscribeForThemeUpdates</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function\">apply</span><span class=\"token punctuation\">(</span>theme<span class=\"token punctuation\">:</span> <span class=\"token builtin\">Theme</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        backgroundColor <span class=\"token operator\">=</span> theme<span class=\"token punctuation\">.</span>main\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Remember that adding new views as theme observers will be in constant time, and changing the theme across our app will be linear. Quite powerful, right?</p> \n<h2>Obstacles We Encountered along the Way</h2> \n<p>While implementing themes on the iOS app, the major problem we encountered was the inconsistency of <code class=\"language-text\">UIColor</code> use. This is because some parts of the app set colors on Storyboards or XIB files, while in other parts, the colors were used as global variables. This led to us putting a large amount of effort into refactoring the UI layers in order to conform to the <code class=\"language-text\">ThemeObservable</code> protocol.</p> \n<p>Another problem we discovered was the inconsistency and lack of UI components. For example, we found eight different implementations of the loading spinner. We thought this was a good opportunity to unify several views into common UI components.</p> \n<h2>When We Should Apply the Observer Pattern</h2> \n<p>The observer pattern is a powerful tool that we should all have in our toolset. So I’d like to share some tips on how to identify opportunities to apply it:</p> \n<ul> \n <li>When an abstraction has two aspects, one depends on the other. Encapsulating these aspects in separate objects lets you vary and reuse them independently.</li> \n <li>When a change in one object requires changing others and we don’t know how many objects need to be changed.</li> \n <li>When an object should be able to notify other objects without making assumptions about what these objects are. Or, put another way, when you don’t want these objects tightly coupled.</li> \n <li>When there are a lot of layers between the subject and observer so that the delegate pattern is not practical.</li> \n</ul> \n<h2>Benefits</h2> \n<p>There are a handful of benefits that come from making use of the observer pattern. They include:</p> \n<ul> \n <li>Abstract coupling between the subject and the observers. All a subject knows is that it has a list of observers, each conforming to a simple interface of the abstract <code class=\"language-text\">Observer</code> protocol. The subject doesn’t know the concrete class of any observer. As a result, the coupling between a subject and observers is abstract and minimal. Consequently, the observers can belong to different layers of abstraction in a system.</li> \n <li>Support for broadcast communication. The notification is automatically broadcast to all interested objects that have subscribed to it.</li> \n <li>Benefits from reactive programming, without a huge third-party dependency.</li> \n <li>Compared to <code class=\"language-text\">NotificationCenter</code>, the type-safe approach that we propose can prevent runtime crashes.</li> \n</ul> \n<h2>Conclusion</h2> \n<p>This post details how we created a dark mode for the SoundCloud iOS app using the observer pattern. But the pattern is not just limited to this kind of scenario. In fact, here are other real-world examples of where you can apply the observer pattern:</p> \n<ul> \n <li>A music player that wants to notify different architectural layers of the app that playback has started.</li> \n <li>When views need to observe and react to changes on a database.</li> \n <li>When sending notification about the app lifecycle, e.g. when the app is in the background, foreground, etc.</li> \n</ul> \n<p>Do you have more ideas of other problems that can be solved with this pattern?</p> \n<div class=\"gatsby-highlight\" data-language=\"swift\"> \n <pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">for</span> question <span class=\"token keyword\">in</span> questions <span class=\"token punctuation\">{</span>\n    question<span class=\"token punctuation\">.</span><span class=\"token function\">ask</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">!</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div>","descriptionType":"html","publishedDate":"Fri, 08 Nov 2019 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/9f2bb119f1570b22f3d0f703746adc51/a296c/banner.jpg","linkMd5":"e8916382f7641a2823b21fd1cca4773a","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn55@2020_4/2020/08/25/00-49-37-163_e078dc9f25bf9803.webp","destWidth":800,"destHeight":418,"sourceBytes":18325,"destBytes":21332,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/9f2bb119f1570b22f3d0f703746adc51/a296c/banner.jpg":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn55@2020_4/2020/08/25/00-49-37-163_e078dc9f25bf9803.webp","https://developers.soundcloud.com/blog/static/502e61b8f647e521bd358d44e2668cf5/3bb78/uml.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn30@2020_4/2020/08/25/00-51-41-627_1aa1133197a665b7.webp"},"publishedOrCreatedDate":1598316569971},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Introducing Rate Limits","link":"https://developers.soundcloud.com/blog/introducing_rate_limits","description":"<p>At SoundCloud, we’re building an ecosystem where creativity thrives. Developers are an important part of that ecosystem. We’re continually inspired by how you use the SoundCloud API to support creators and listeners in innovative ways.</p> \n<p>But as the ecosystem has grown, we’re dealing with an increasing number of applications that abuse creator content by violating our <a href=\"https://developers.soundcloud.com/docs/api/terms-of-use\">developer Terms of Use</a>. To help control this type of behaviour, we’re introducing a daily rate limit on API play requests.</p> \n<p>Beginning July 1, client applications will be limited to 15,000 play requests per 24 hour period. These limits are applied to developer applications using the SoundCloud API, and have no impact on the SoundCloud embedded player.</p> \n<p>Only a small number of developers will be affected by this change, and we’ve contacted them via email to ensure a smooth transition.</p> \n<p>What this means for you:</p> \n<ol> \n <li>You should review our <a href=\"https://developers.soundcloud.com/docs/api/rate-limits\">developer documentation on rate limiting</a>. Limiting API access is common for API providers. If you’re unfamiliar with rate limits or how they work, <a href=\"https://developers.soundcloud.com/support\">we’re here to help</a>.</li> \n <li>You should monitor your play requests.</li> \n <li>Make sure the email account associated with your app is up-to-date, and keep an eye out for communication from our team.</li> \n</ol> \n<p><strong>This change does not affect the SoundCloud embedded player, and if you have not heard from us, your app is unaffected.</strong></p> \n<p>In the coming months we’ll be introducing an application process for developers who’d like additional access.</p> \n<p>This change is an opportunity for us to refocus our efforts and renew our commitment to developers. You’re an integral part of the SoundCloud community, and we look forward to seeing what you build next.</p>","descriptionType":"html","publishedDate":"Tue, 16 Jun 2015 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"0972cf06ca410e1b45efdf5b6f53f3a0","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569978},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Responsive Android applications with sane code","link":"https://developers.soundcloud.com/blog/responsive-android-applications-with-sane-code","description":"<p>A common problem in Android development is that you need to jump off the main UI thread to retrieve data from an IO-based source. At SoundCloud, we use Netflix’s <a href=\"https://github.com/Netflix/RxJava\">RxJava</a> to simplify asynchronous flows in Android. In an interview given for the Google Developers series “root access Berlin”, &nbsp;<a href=\"https://github.com/mustafasezgin\">Mustafa Sezgin</a>—who heads up our Mobile Team—explains why we chose RxJava, what it gives us, and he walks through an example-usage pattern:</p> \n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.2%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\"> \n <iframe src=\"http://www.youtube.com/embed/DA0ZAnxUKDk?feature=oembed\" frameborder=\"0\" allowfullscreen=\"\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> \n</div> \n<p>If you are interested in more details, be sure to catch <a href=\"http://mttkay.github.io/\">Matthias Käppler</a>—from our Android Team—give an in-depth talk at <a href=\"http://uk.droidcon.com/2013/\">Droidcon London</a>, October 24-27, 2013.</p>","descriptionType":"html","publishedDate":"Mon, 12 Aug 2013 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"86e1b89a5f1e27f3cb6955d8a0d48190","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Changing the Interview Process during Remote Working","link":"https://developers.soundcloud.com/blog/changing-interview-process-during-remote-working","description":"<p><em>Please also see <a href=\"https://developers.soundcloud.com/blog/rethinking-the-backend-code-challenge\">Part 1: Rethinking the Backend Engineering Interview Take-Home Challenge</a> and <a href=\"https://developers.soundcloud.com/blog/backend-code-challenge-recruiting-perspective-and-results\">Part 2: The Recruiting Perspective and Results</a>.</em></p> \n<p>In the last two blog posts, we talked about how we rethought our backend engineering challenge as a way of improving numbers for recruitment. In the same vein, this post talks about how we changed our hiring strategies to adapt to hiring remotely during COVID-19.</p> \n<p>Onsite engineering interviews at SoundCloud include whiteboarding, pair programming, barkeeper,<sup id=\"fnref-1\"><a href=\"https://developers.soundcloud.com/blog/changing-interview-process-during-remote-working#fn-1\" class=\"footnote-ref\">1</a></sup> product manager, and engineering manager interviews. Because of COVID-19, SoundCloud switched to working completely remotely in March of 2020. However, we didn’t let this new setup put a stop to our recruiting efforts.</p> \n<h2>Scheduling Interviews</h2> \n<p>In the past, we had all of a candidate’s interviews scheduled onsite for the same day at our SoundCloud office space. As we moved to a full remote work environment, we made all the interviews virtual. Virtual interviews made us more flexible, as we could spread the interviews across multiple days to better accommodate the availability of the candidates and interviewers.</p> \n<h2>Video Calls for Interviews</h2> \n<p>Out of the five aforementioned interview types, the latter three types were the simplest to make work in a remote setup because they mostly consist of a verbal dialogue. To carry out these interviews, we set up video calls between the interviewers and the candidates. The candidates were given details about this in advance so that they could try out the setup and make sure they had good audio and video connectivity.</p> \n<p>When doing this, we discovered we could get similar signals about a candidate’s proficiency through a video call as we would in an in-person interview. The interviewers also found it was easier to take notes during the call without it being awkward. And the candidates seemed more comfortable taking part in the interview in spaces they were familiar with.</p> \n<p>We used Slack to coordinate with one another internally when someone finished an interview to make sure we allowed enough time for the candidate to take a quick break and refresh before the next interview began. This was also a helpful tool for communicating with recruiters — for example, if the candidate couldn’t join on time or had to drop off the call because of any connectivity issues. There was even an instance where we sent the incorrect VC link to the candidate, and having a running conversation on Slack helped us quickly communicate with the recruiter and thereby the candidate.</p> \n<h2>Tools for Whiteboard and Pairing Interviews</h2> \n<p>Whiteboard and pairing interviews were a bit more challenging to adapt to a remote setting, as a big portion of our technical assessment happens over these sessions. Running these interviews in a remote context forced us to invest in better tools, familiarize the interviewers with them, and send out material to candidates in advance to allow them to also understand the tools.</p> \n<p>For the system design interview, we used Miro as a whiteboard tool. The candidates could use it to sketch out the system design and walk through their ideas. The first time, we ran into unanticipated permission issues that had to be resolved just before the call. We quickly learned from this and started setting up the Miro board and sharing it with candidates in advance. These virtual boards also made it easier for interviewers to go back and review the work if necessary before filling out the feedback for candidates.</p> \n<p>For the code pairing session, we opted to use video conferencing along with screen sharing. This allowed candidates to use the IDE of their choice. However, the interviewer missed out on being able to contribute or point to specific lines of code. It was also difficult when candidates paused and explained before or while making their code changes. As a result, the interviewers needed to be explicit about asking probing questions and clarifying things to be able to keep up with a candidate’s train of thought.</p> \n<h2>Feedback</h2> \n<p>In addition to us learning directly through this experience, we tailored our post-interview feedback forms from the candidates to get their feedback on the interviewing experience. We also collected feedback from the interviewers to make possible improvements and reevaluate the tools.</p> \n<h2>Ongoing Challenges</h2> \n<p>The entire experience of running interviews has been an ongoing learning process for us and we are still trying to find optimal solutions to some of the challenges. For example, we haven’t found a good replacement for the casual lunch session we had in our onsite interview day. We tried having a casual video call as an alternative, but we haven’t found it to be as equally informal as having lunch together.</p> \n<p>Another challenge has been to find a best practice for sharing access to our remote interview tools with the candidates within a reasonable timeframe and in a way that makes it clear how to set up and use them.</p> \n<h2>Results</h2> \n<p>When initially faced with the challenges of moving our interviews to a remote setting, it seemed like the overhead of setting up tools and video conferencing in advance would be a lot of work on our part. However, through feedback and iteration, this became a seamless part of our hiring flow. As a result, we were able to continue to hit our hiring goals, even in the midst of a global pandemic.</p> \n<p>Overall, running our full onsite interview days in a completely remote setup has been a huge learning experience. It allowed us to be more flexible, empathetic, and inclusive, and we will continue to use these learnings to improve our hiring moving forward.</p> \n<div class=\"footnotes\"> \n <hr> \n  <ol> \n   <li id=\"fn-1\"> <p>Barkeepers bring an outside perspective to the hiring team. They represent the technical excellency, culture, and mindset of SoundCloud. They have a history of hiring effective engineers, experience running interviews, and technical depth in multiple areas.</p> <a href=\"https://developers.soundcloud.com/blog/changing-interview-process-during-remote-working#fnref-1\" class=\"footnote-backref\">↩</a> </li> \n  </ol> \n </hr> \n</div>","descriptionType":"html","publishedDate":"Tue, 30 Jun 2020 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"178bcfd9ea5f673cc761665246aaf1a5","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569968},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Security update: Heartbleed vulnerability in OpenSSL","link":"https://developers.soundcloud.com/blog/heartbleed","description":"<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 341px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/cbfbd52b0009558a2ef89e02d1aad58b/f570f/heartbleed.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 121.11436950146629%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsSAAALEgHS3X78AAADT0lEQVQ4y42Vz08TQRTHp11KgBCDASQY5KqRk5ELGgqJFxIuelAT/wFPcpEDXMSjdxU9GIOhARVjwEDpFtpSyg8D6AUSow2JmBSCFZEAYven37cz024LJGzyZV9n3nzmvTdvFqYy5mV4QoydCvt8HdCwqijRcHHx83BR0TVW8GDMj7kn8InA/gD/+2BU0pxkEaxR9XjWphmzI0JTUBQKK8rwOGMVQcbKYL+Wc9KP1mDtBhh+CavEQIqcPjY1ZdYDAT0dDBrJnh4tUlFhzNACRVmBPpM9WV5ufuvu1n6OjRnrg4PGQmtrJsqh24jwLEPInQkMLPj9/2z+WEL237U1a76xUZ8kEDTT0KDvJ5NWod+ntrYMRQrWQwIOU+jrAwM6ORgHB5al67aZyTgLjL09O15fb0arqoxMOu2AaI58yJd+b46MGDGK0utVGf7ECJgeHzdokhwtiwdhappj/J6etn6Fw5Z7jHwsw3DM7bk5Y4qnnaAI31ENUn19ToTuBc6bL8qzsxvquvNzY2iIR6goQYYWuBenGra0aDwf03J2FxJjebCsDIPXsL1dIwZYXZTyaSgVxsCP3l6zMC03JC86XmM71d9vqvKUvd5ap3Vg3InxQZPqdahWBRHLuZ2lJWuipERP8HTvcpjH43Q3mvYthY3e03aXl+3CehbALLSPHaup0QiGG9MnAvPQdSkSDf5oXlFsCj9aXW3urqxIaPZQ5Ab7q6v2VF0dr5vPFwkw5hFXLwfE+zGgGnabjfBIzT+Li9n0JQwbWbHaWglLjDFWknePXcBeaBPQm0h/G3fXmigtNbYikezNQL/RRoa4FVEXTBHvQ8At6Dago5NInyKFbeImUGNTrfQoh428FxG5YYXAp9AOdB2KA5QE4EWcn76FU8yI05yVnzLXp4/DsoXk7/NQM3QFmoe+OuOK8iAhPmU4xe9Y/FL4+w7BCqHCJugslIRKRWt1QP1Y/AZjAZmqegxMfhdl6s2w50IcWBbK+Z2DVOiVu3bHPq7iXqUaQl8oLRfwAmw15IrwpMAbEP2fOIPFHjV3mlTjUejZSYEekfol2JeF7Q3lgI1QF0V9ZO2OekKuwwnlIpbAJqjzRNHJ45dQVyu52+oidEtmc1yE/wEmGTOQxTdLegAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Heartbleed\" title=\"Heartbleed\" src=\"https://developers.soundcloud.com/blog/static/cbfbd52b0009558a2ef89e02d1aad58b/f570f/heartbleed.png\" srcset=\"/blog/static/cbfbd52b0009558a2ef89e02d1aad58b/9ec3c/heartbleed.png 200w,\n/blog/static/cbfbd52b0009558a2ef89e02d1aad58b/f570f/heartbleed.png 341w\" sizes=\"(max-width: 341px) 100vw, 341px\" loading=\"lazy\"> </img></a> </span> \n<p>On Monday, April 7th, 2014, a major security vulnerability in OpenSSL was made public. The vulnerability was filed as <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160\">CVE-2014-0160</a> and later dubbed “<a href=\"http://heartbleed.com/\">Heartbleed</a>”, because the bug lies within OpenSSL’s heartbeat extension, which is used for keepalive monitoring. As a result of the bug, process memory can be read out remotely by an attacker—potentially including certificates, keys, credentials, tokens, or other sensitive data processed by the server.</p> \n<p>OpenSSL works as a cryptographic library that allows for authenticity and confidentiality across the entire Internet. Because the reported Heartbleed bug affects a vast number of internet services using OpenSSL to secure their services (such as HTTPS, SMTP, IMAPS, and POP3), a patched OpenSSL version was <a href=\"https://www.openssl.org/news/secadv_20140407.txt\">released</a> by the maintainers within hours. Linux and UNIX distributions, which depend on the OpenSSL implementation, received patches by their respective upstream maintainers.</p> \n<p>SoundCloud too uses OpenSSL in many of our services to increase the security and privacy of our users. We therefore moved quickly to patch the vulnerability, and did so within hours of the patch being made available. We’ve also been in close communications with our vendors and service providers, to ensure that they have applied the appropriate fixes as well. We have confirmed that our implementations of OpenSSL are no longer vulnerable to this bug.</p> \n<p>Because we consider our users’ security and privacy of the utmost importance, we have further taken the precautionary measures to rotate SSL certificates and keys, and expire authentication tokens, such as session cookies, remember tokens, and OAuth access and refresh tokens. This means that users will be signed out of their SoundCloud accounts. Along with top security researchers and responsible companies, we have also recommended to our users that they change their passwords on all accounts (not just SoundCloud) that they have signed-in with in the past week. Developers of API clients that check our SSL fingerprints will need to update them.</p> \n<p>While the Heartbleed bug marks a sad day for the Internet as a whole, with SoundCloud’s rollout of Perfect Forward Secrecy (PFS) support last year, we ensured that the impact of an attack with the purpose of stealing private keys and reading previously encrypted traffic is minimized. In the same spirit we will also strive to find more such opportunities in the future and preemptively provide our users with the highest possible level of safety.</p> \n<p>For more details about this bug, go to <a href=\"http://heartbleed.com\">heartbleed.com</a>. To use tools to check your services, go to <a href=\"http://filippo.io/Heartbleed/\">Filippo.io</a> or <a href=\"https://github.com/FiloSottile/Heartbleed\">FiloSottile/Heartbleed</a> on GitHub.</p>","descriptionType":"html","publishedDate":"Fri, 11 Apr 2014 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/cbfbd52b0009558a2ef89e02d1aad58b/f570f/heartbleed.png","linkMd5":"3f7b77d5ab0c5c6bf947ff7a32fab64e","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn33@2020_4/2020/08/25/00-49-37-652_b994b91a1b6d69db.webp","destWidth":341,"destHeight":413,"sourceBytes":3454,"destBytes":7598,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/cbfbd52b0009558a2ef89e02d1aad58b/f570f/heartbleed.png":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn33@2020_4/2020/08/25/00-49-37-652_b994b91a1b6d69db.webp"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Managing Unplanned and Support Tasks","link":"https://developers.soundcloud.com/blog/managing-unplanned-and-support-tasks","description":"<p>One challenge engineering teams often face is dealing with work that doesn’t revolve around developing new features but that still requires the team’s attention and time. The Content Engineering Team here at SoundCloud is no exception, so we iterated on a process to deal with unplanned and support tasks to end up with fewer interruptions and more time to spend on implementing planned features.</p> \n<!-- more --> \n<p>We define unplanned and support tasks in the following way:</p> \n<ul> \n <li>Unplanned tasks — work that unexpectedly appears and needs immediate action. An example of this is a severe bug that impacts our users.</li> \n <li>Support tasks — work that doesn’t need immediate action and can be planned but still needs engineering support. Reasons for these tasks can be lack of automation, lack of visibility into the systems we build, work caused by infrastructure changes, or non-critical bugs we introduced ourselves.</li> \n</ul> \n<p>There are several reasons why it is important that we come up with an approach to dealing with unplanned and support tasks. For one, these tasks take up time we would normally spend on delivering features, so naturally we want to minimize the number of them. Secondly, we want to make this kind of work visible; it is often invisible outside of the team, which can give the impression the team is slow and dysfunctional. Finally, these unexpected and often urgent tasks cause extra stress and context switching for the team — in addition to the fact that support tasks are often not very interesting, due to their manual and repetitive nature.</p> \n<h2>The Request Process</h2> \n<p>Initially, my team had a very open way of dealing with requests from stakeholders that resulted in unplanned and support tasks: People who had requests could leave them in our Slack channel, and a team member in a single point of contact (SPOC) role was supposed to address them.</p> \n<p>Some team members liked taking on this role because they liked helping out our stakeholders. Others didn’t like it as much because they didn’t want to be interrupted, and as a result, were slower in responding to requests.</p> \n<p>And even though this idea resulted in a designated person responsible for addressing incoming requests at any given time, all the other team members still saw them. As a result, they were often distracted, and some people started discussing the requests even when they were not urgent. It got to the point where the distractions and unclear priority of the requests began popping up as a recurring topic in our team retrospectives.</p> \n<p>This led us to try another approach. We got rid of the SPOC role and instead tried asking stakeholders to reach out using our team Slack channel or via direct messages, but only for urgent requests. We defined an urgent request as something that impacts our users, disrupts a key feature, or blocks employees from doing their work. For all other requests, we specified an email address that reached the team Engineering Manager (EM) and Product Manager (PM).</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 544px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/6c314/request_process.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 30.698529411764707%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABHElEQVQY042QS0rEUBBFszEX4yLcgkvQNTjpkaMoOgo4aDEJodGOSSedT8f8Xn4v6ZDP7bwSQRDFCw+Keodbt0ra7/cwDAOWZWGz2VDNOYeQFrW4fT/i8p5B9XtULIGm6dB1nTjbtrHdbpFlGfHzPEMyTROyLENRFIJc10WafgKPToWr5wbnNwx3ry0wddg5LjGe59Hgvu8xDAOZkWHTNItBSo8xhi/N+K7hR+c3SUmSoCgKxHFMpkEQQJyh61qwboJfjXjacST1iKYq4PsBoigiRrCiFmnDMITwksSHqqpYr9d0E9E8HKIlVI/VW4mLhwpn1zlWGsfAGV5UnXjHceh2Yqs8z1GWJeq6hvRX/Gkcl01HfLAW/Dj8a+UTsffCREnPo3YAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"The Request Process\" title=\"The Request Process\" src=\"https://developers.soundcloud.com/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/6c314/request_process.png\" srcset=\"/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/9ec3c/request_process.png 200w,\n/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/c7805/request_process.png 400w,\n/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/6c314/request_process.png 544w\" sizes=\"(max-width: 544px) 100vw, 544px\" loading=\"lazy\" /> </a> </span></p> \n<p>We had no difficulties convincing stakeholders to try this approach, and as a result, the number of requests in Slack dropped almost immediately.</p> \n<p>This is the support request process we still use today.</p> \n<h2>Planning the Work</h2> \n<p>We have two-week iterations in our team, and if a non-urgent support request comes up, we add it to the next iteration. The next iteration rule is important because we want to avoid building up a backlog of issues that never get worked on.</p> \n<p>Initially, we went over the support task tickets during our planning session so that everyone was aware of them. Then we let the team self-organize with the goal of finishing the tasks by the end of the iteration. This resulted in a situation where it was often the same team members tackling the support tickets while other team members focused on feature work the entire length of the iteration. However, this wasn’t necessarily fair, so after the issue came up in one-on-one meetings and retrospectives, we addressed it and found a new solution.</p> \n<p>Our new way of handling these tasks was to assign support tickets to team members in a round-robin fashion, thereby ensuring everyone got a fair share of support tickets. This not only improved team morale, but it made it so that the work was divided more equally and fairly, which also resulted in increased knowledge sharing.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 752px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/379b53659c14f82127c31d4fc648625c/f6afc/planning_simpler_version.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 46.409574468085104%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABtUlEQVQoz3WSz07bQBDG/XhtUSUkHiFwqNQn6L3qFYkH6KEcUA9cUDlRxAGpFUVUKSlJiON17CV/sFPh1HZs726+zo6TCCox0mg860+/2ZlZB2SLxYJdKYUoiiClxGg04jgej1HM56h1tVZrzflsNoMQgrXGGD5zrIDF5EVRIM9zpGlaxyyD0gbK2GIaK+3KrCYIAvi+z3AGMswoTMQ3qGJek5fW+/0LonuD1tkxyiLls4yKfD74xN1YflmWDLP58oYGZTXH7ekRrv0+vrdOUOZT/im65xDuD5xeXcC7DhHJBOksxeHHL3hSmWzdcpJkGAzu4Tab6Ml73HhtPPwZIwyH8EQbk2iAXhzDv5Xod3x4noDfGSFJkrW7rkv6kKEE9NDvH8IPPmAa7UOVba40mYTk7voGCxhkecbzLaqcxlQv0kKqquJF2dyRchfd7gb5KxruJobDt7iTJ4jjA9rwO4pf8TcVsB1prXhmWhs8Z45SJW03IPdouD8Juo3LyxdotV6j09mi+BLT6Sa1drx8Ohqrp/b4ya1y5zHd3iCO92hOOwRv0EYbBHtDsPf03V4CzBPY//YPnLOkiVJTzPIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"The Planning Process\" title=\"The Planning Process\" src=\"https://developers.soundcloud.com/blog/static/379b53659c14f82127c31d4fc648625c/f6afc/planning_simpler_version.png\" srcset=\"/blog/static/379b53659c14f82127c31d4fc648625c/9ec3c/planning_simpler_version.png 200w,\n/blog/static/379b53659c14f82127c31d4fc648625c/c7805/planning_simpler_version.png 400w,\n/blog/static/379b53659c14f82127c31d4fc648625c/f6afc/planning_simpler_version.png 752w\" sizes=\"(max-width: 752px) 100vw, 752px\" loading=\"lazy\" /> </a> </span></p> \n<p>Another variant we started trying out recently is having one day in the iteration when the team works together to finish the support tickets. This has the additional advantage that more pairing takes place, which is better for knowledge sharing. It is also nice that everyone shares the work together at the same time as a team effort.</p> \n<h2>Tracking the Work</h2> \n<p>As part of the overall process, we also think it’s important to track the work done on these tasks. We do this by creating a JIRA issue for every request that comes in, even when the request can be answered by the Engineering Manager or Product Manager. Once an issue is created, we also share it with the stakeholder who initiated the work so they can follow up on the progress.</p> \n<p>Every request JIRA issue is labeled. Urgent requests get the “unplanned” label, and non-urgent requests get the “support” label. Then, once we are done working on an issue, we log the estimated amount of time we spent working on the issue using JIRA’s Log Work functionality.</p> \n<h2>Measure, Learn, and Act</h2> \n<p>Keeping track of the work in this way allows us to measure it, learn from it, and act on it.</p> \n<p>More specifically, about once every two months, we query all the finished unplanned and support issues of the past iterations in JIRA. We then group them in categories and add up the time spent on them. An example of this from earlier this year is shown below.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/864b39d8ea729317de2b128c1f9d0ba3/34e8a/managing_unplanned_support_tasks_hours_spent_chart.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 61.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAAByklEQVQoz6VSzUsbQRTfP8GDh156EXuq9F6oZy8eSqGHJhdTRKySowja3gr9sOhNLYFeYi96K2pIi0SUxNUQbUlod6Goh3xsPnb2e7OzuzPjy64iJrn5mIHfe29+b37z5nEYY4SQCqbpCmxdB9eyLE3TkGo0ZQ0pqm3bkICIYRjVhoqx5/s+pZSDTQhh/WwhcT42Vzz4owImhIbBluYZpm2ZJvCB3Ald1Nrff0l7BQSeT2hYbeLDv4cvc6ljmQXB3uqc6/qM0Z0j+cGLbPT9X8A3KTq5JAxH+fRJh+wBO7A75LDkzzyCc9PLotX2NzP1rf0GgKkv4lCEhxQcwB7pvZuDkiF56BX/ZlmsIfzkdR4WAHAhmA7I/WUHZAraHkX52RVRQs5o/PRZ/FSSnZkVcTjCZ87Q/4qV2K4URK3zGNoje4dHg89zEx+FuuKOxPKPY3kA4A6MZ3Mlbe1HlXuaefftsksCB31g1DsTGm+/FpO757Wm+ikpfN4Q6y19I3WxuF4SLtHhb2l+tZjKlYF75+ZACXXapm00XcdQVQU1y7oimYbOqMuYQwiMBIaWEYK7msZdf0ugh3aGgchIackonJzbf+s3RRy7h10BrhuCLbDl0f4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Visualizing the time spent\" title=\"Visualizing the time spent\" src=\"https://developers.soundcloud.com/blog/static/864b39d8ea729317de2b128c1f9d0ba3/34e8a/managing_unplanned_support_tasks_hours_spent_chart.png\" srcset=\"/blog/static/864b39d8ea729317de2b128c1f9d0ba3/9ec3c/managing_unplanned_support_tasks_hours_spent_chart.png 200w,\n/blog/static/864b39d8ea729317de2b128c1f9d0ba3/c7805/managing_unplanned_support_tasks_hours_spent_chart.png 400w,\n/blog/static/864b39d8ea729317de2b128c1f9d0ba3/34e8a/managing_unplanned_support_tasks_hours_spent_chart.png 600w\" sizes=\"(max-width: 600px) 100vw, 600px\" loading=\"lazy\" /> </a> </span></p> \n<p>Based on the categories and the time spent, we come up with actions. Some examples of actions we’ve come up with so far include:</p> \n<ul> \n <li>We found out that we spent quite a lot of time supporting our operations team because we were missing some automation to perform a specific task. This led us to prioritize the work required to automate the missing step, which not only got rid of the repetitive and boring tasks for our engineers, but also removed the dependency and waiting time for our operations team.</li> \n <li>We spent a considerable amount of time working on fixing our deployment pipelines because of infrastructural changes that were outside of our control (e.g. updated base Docker images). This led to the decision to inform the infrastructure team and ask them to consider if the benefits of their changes outweighed the additional workload for the engineering teams. We also improved our deployment pipelines so that they get triggered automatically when a new dependent Docker image has been updated. By doing this, we get notified of breaking changes immediately instead of being caught by surprise when we make a code change.</li> \n <li>When we introduced a bug in one of our systems, it required a lot of time to recover from the bug. We found out it took so much time because the system generated derived data / intermediate state. And because we couldn’t reprocess all the input data, it meant that all the derived data needed to get fixed/patched manually. This motivated us to come up with a plan to improve the system design.</li> \n <li>We found out that some of the bugs we introduced were caused by not having good enough validation criteria for our stories/epics. This resulted in us becoming better at defining validation criteria together with our PM.</li> \n</ul> \n<p>Measuring, learning, and coming up with action points is important, because having tangible numbers about the time spent on unplanned and support work makes it easier to prioritize work for fixing structural issues. This is good for both the team and for SoundCloud, as engineers are interrupted less and can spend more time on impactful work.</p> \n<p>If you are interested in learning more about our processes, you should also read the blog post <a href=\"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime\">Deliver Software Faster by Managing Work in Progress, Not by Adding Overtime</a>.</p>","descriptionType":"html","publishedDate":"Mon, 26 Mar 2018 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/6c314/request_process.png","linkMd5":"ab6b8f60b8531d732d1420a3c4a8c8cc","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn72@2020_4/2020/08/25/00-49-37-151_33cb495219527a46.webp","destWidth":544,"destHeight":167,"sourceBytes":6509,"destBytes":11460,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/6c314/request_process.png":"https://cdn.jsdelivr.net/gh/myreaderx/cdn72@2020_4/2020/08/25/00-49-37-151_33cb495219527a46.webp","https://developers.soundcloud.com/blog/static/379b53659c14f82127c31d4fc648625c/f6afc/planning_simpler_version.png":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn25@2020_1/2020/08/25/00-51-43-440_7642665659be2810.webp","https://developers.soundcloud.com/blog/static/864b39d8ea729317de2b128c1f9d0ba3/34e8a/managing_unplanned_support_tasks_hours_spent_chart.png":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn39@2020_1/2020/08/25/00-51-41-952_28e01bf0d3befefc.webp"},"publishedOrCreatedDate":1598316569975},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Create rich media experiences using timed comments","link":"https://developers.soundcloud.com/blog/rich-media-using-timed-comments","description":"<p>In the last weeks we got pretty excited about the idea of using timed comments to create and script rich media experiences. Imagine being able to trigger all kinds of visualizations &amp; interactions for a timed comment while playing a track.</p> \n<p><img src=\"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/timedcomment2.jpg\" alt=\"Timed Comments with Media\" /></p> \n<!-- more --> \n<p>We’ve already built a few experiments around this concept:</p> \n<ul> \n <li>The <a href=\"http://ontimed.co\">onTimedComments hack</a> is a simple example showing off the full power of this idea. It takes any kind of link in the comments and translates it into a rich media embed using <a href=\"http://embed.ly\">Embed.ly</a>.</li> \n <li><a href=\"http://waveraid.com\">WaveRaid</a> lets you literally play a track. Collect all the timed comments using the play button as your space ship.</li> \n <li>With <a href=\"http://storywheel.cc\">StoryWheel</a> you can create a slideshow from your <a href=\"http://instagr.am\">Instagram</a> pictures and record your story around them. It’s using the timed comments to store where each picture has to show up. Alex &amp; Eric used this to tell the <a href=\"http://storywheel.cc/alex-eric/soundcloud-story\">story of SoundCloud</a>.</li> \n</ul> \n<p>With the latest version of our <a href=\"https://developers.soundcloud.com/docs/javascript-sdk\">Javascript SDK</a> we’ve made it very simple for everyone to use this technique using the new <code class=\"language-text\">ontimedcomments</code> event. Here is a basic example (press play to try it):</p> \n<iframe style=\"width: 100%; height: 310px\" src=\"http://jsfiddle.net/johannes/BaGSc/embedded/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"></iframe> \n<p>We are looking forward to all the innovative apps &amp; hacks you can come up with using this! As always, we are happy to hear your ideas &amp; thoughts about this.</p>","descriptionType":"html","publishedDate":"Wed, 11 Apr 2012 00:00:00 +0000","feedId":10291,"bgimg":"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/timedcomment2.jpg","linkMd5":"a6004534db173619f1f08181f03ef8ad","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"author":"","articleImgCdnMap":{"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/timedcomment2.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg"},"publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Playlist search returns only compact representations as of July 15, 2016","link":"https://developers.soundcloud.com/blog/compact-playlist-search","description":"<p>We previously introduced <a href=\"https://dev.soundcloud.com/blog/representations\">new playlist representations</a>. The compact representation returns only the playlist itself without any of the tracks. For most users, this is preferable – the compact representation significantly reduces the size of the JSON payload for large playlists and provides faster API response times.</p> \n<p>Beginning July 15, 2016, all queries using the <code class=\"language-text\">q</code> parameter will only return this compact representation for playlists. Other playlist representations will no longer be available when using the <code class=\"language-text\">q</code> parameter. </p> \n<p>To fetch the track listings for one of the returned playlists, you can make an additional request to the <code class=\"language-text\">/playlists/{id}</code> resource by using the corresponding playlist ID.</p> \n<p><strong>If your application expects track listings from playlist search results, update your application by July 15, 2016.</strong></p>","descriptionType":"html","publishedDate":"Fri, 13 May 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"f78faf10bf7d194a3626ac41c48fc945","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569977},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Sharing Sounds","link":"https://developers.soundcloud.com/blog/sharing-sounds","description":"<p><em>UPDATE: Check out our guides on <a href=\"https://developers.soundcloud.com/blog/docs/api/guide#authentication\">Authentication</a> and <a href=\"https://developers.soundcloud.com/blog/docs/api/guide#sharing-sounds\">Sharing Sounds</a> for the most recent information.</em></p> \n<p>If you build an app or web service that generates any type of sound, it’s easy to connect it to SoundCloud and enable your users to share their creations across the web. Allowing users to share what they create to their existing social networks and the SoundCloud community brings great value in a variety of use cases. If you have an app for beat making, you can let your users post their creations to a dedicated group on SoundCloud. For aspiring music makers, it’s valuable and fun to get feedback from friends on Facebook. And for someone recording an interview with their phone, it’s super handy to be able to post the audio directly to a blog. In addition, a sharing feature is obviously practical for sending files to collaborators or moving audio between devices.</p> \n<!-- more --> \n<p>Letting users share tracks is also a great way of virally promoting your app. Uploaded tracks will automatically be tagged as uploaded with [your app], so when a user shares a track on Facebook, their friends will see what app the track was created with.</p> \n<p>Some examples of apps using SoundCloud for sharing:</p> \n<ul> \n <li><a href=\"https://soundcloud.com/apps/voicejam\">VoiceJam</a></li> \n <li><a href=\"https://soundcloud.com/apps/ujam\">UJAM</a></li> \n <li><a href=\"https://soundcloud.com/apps/wave-editor\">Wave Editor</a></li> \n</ul> \n<p>You’ll find more examples in our <a href=\"https://soundcloud.com/apps\">App Gallery</a>.</p> \n<p><strong>Authentication</strong></p> \n<p>To be able to upload tracks, the user must connect the app to their SoundCloud account. For this connection, we use OAuth; “An open protocol to allow secure API authorization in a simple and standard method from desktop and web applications.”</p> \n<p><img src=\"http://oauth.net/images/oauth-2-sm.png\" alt=\"OAuth2\" /></p> \n<p>The idea behind OAuth is to make it possible for the user to hand out a “key” to their account, without giving away their email and password to the third-party app. In our case, an app with a key can access the user’s tracks, delete tracks, upload new tracks, make comments on tracks, see who the user is following, etc. In other words, the key gives full access to the user’s account, except the email address, credit card information, and other sensitive data.</p> \n<p>This is how the connection flow looks for the user…</p> \n<p>The app can store the key so that the user doesn’t have to log in the next time they want to upload a track. The key will work until the user revokes the access in their SoundCloud account settings.</p> \n<p>To try the connection flow, check out the following apps: Connect with SoundCloud demo on the web SoundCloud for iPhone SoundCloud for Android</p> \n<p>To implement Connect with SoundCloud: Read the API documentation about authentication with OAuth 2.0 See if there’s an SDK for your framework which will simplify the implementation</p> \n<p><strong>Uploading Audio</strong></p> \n<p>Once the app is connected you can upload with a POST request to /tracks. The only meta data required when uploading an audio file is the track title. You can specify other meta data as well, or edit the data once the track is uploaded. If you don’t set the track to public, it is set to private by default. When the file upload is finished, you get back a track object including the track id and URL. Once you have the track ID, you can read and access all the meta data. The full list of meta data is available here.</p> \n<p><strong>Sharing a Track on SoundCloud</strong></p> \n<p>Tracks can be shared to other SoundCloud users. You can either share to specific users by id or to email addresses. If the email address is not yet registered with SoundCloud, they will receive an email invitation to the track.</p> \n<p><strong>Sharing to Social Networks</strong></p> \n<p>An uploaded track can also be shared to Facebook, Twitter, MySpace and Foursquare. Instead of connecting your app to the different networks, we handle the connections and share the track once it’s uploaded and finished processing. Users can enable automatic sharing of new tracks to social networks in their SoundCloud settings. If you want, you can make these options available in the app as well.</p> \n<p>This is how the sharing screen looks in our iPhone app: <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 300px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/4b4afa2ba8edef2b8a25de084981fd7b/135ae/iphone-sharing.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 150%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFsElEQVRIx3VWWW9TRxS+AgmFovCAEAQSG4W0Wb1f32vHjh3vjrPgOBtZGgUlJQ6Q3U6i5LUqT/0nrVSkLuoLUiWqUiFQRYsQioSgFWrZ2j9QZr6eM7kXhaUPn86dmTPfnG3OXO36g39e/fDrI/HTrdvi59t3xPW7f4ob95+JJ89fiMdPX4qHT56Ka99+L7649rX449nf4tFfzwkvxO+0/nD3pbj7y2Nx4+Zt8d2db+RXN7/8V7u0uiWurFawvLKKxeUVrKxvoLq1gyUaX15cRnVzS83PXSzjytIKltfWaW2N1pawRrrrlU2s0Nzi2jKW1peF5nTUC0dDPRwNDdLpcMhTdXVyZGRYzl+8KMdGR+XoyIj8ZG5OTkyM0/yIml8ol+UorTmdDtnQUC8dtM/pcMLZ4HylffDBEVF79Chqa2slgSVOnz6NM2fOKJw8efL1uL6eDnY44HQ60dzcjMOHD9uQlhRad3e3mJ+fx9TUlBwfH0e5XMbQ0BDa29vhdrvh8/ng8XjU2OVyoaOjQ6GtrQ1er9eGZB3SFVoulxNra2tYWFiQs7OzWF1dxczMDHRdRyQSQTgchmmaMAzjHQSDQRsyFovx3B7heqVKAV6XqxTc6sYmZi5cgD+gI5PNoafQi2wuT8omzQUQeA/ocDk4OMhSaNFIpyj29eBcb14SUOwvIJ9OwAx4YFgwA16FYFDfb9UbFrJHJIXm9QdFky+OJn+3JJCM4yzJD/U0mo0MWs0MWgitRgpur5/i6VYxfQsqhn6/X2jNkaLQFn6Ddvm+1Mr3ULf1AJ5Pd+H/bBc1y/egzdPapfvQ5m5BTw4iGYsgHu8mxPdDslSErmBMnMhUcCK7IQk4ld/ARwObaC1uoaGwiZO5TdTlt1CXXYfRlUIsGkE02kWI7odkqesBoYVDpkhEgoiHAzJm+hAL+dEV1tFp+BHW3TC8bTAJhq8dAb+PrXgfJEtKkNA6OyMilc4gmUpLAkuV1UQyhQhZwtkOBA0E9KAqpaD+ZmJ4jrNsSaExa4AGVBKSi9guZD5R19/Nqo/m7YJmXat0pKUvNJ+rQ5SuVFEYm5SjQyVMT08rpNPp16R7m3Q1NswQusn6LkpMQDcwNjbGkBa50MgFETSp6g1DhkNhdTO6urrQ2dkJKy528YI94dhSvBE1/Sq+QeVqUBEqC3ViTWbP0ak5GSJiJrKvG189zh6PdXLX0H1ojI7BWaBK6K/gVHoJbj+FweclQstlj8clZpeuYnp2SQ4WBzAxMQlqTeCrxM2CmoaSOiXG8LbjSP/nOLH9EMGru9Bmf0Q42YtMKiG5lFQd8oX2udvhdbskB5xN54D7reCzu6FQaK8h0NVzh5JoCvXirNGDZjNHFWAiZJrSSprQ/F6PyI5cQPrciEwnE0hRMrLZLFKplJLsOpMGreREwyZ60t3oy6cIaWQyaY655CQqwgC5HJ+6hHhpQhayGQyWSspl6s4KHD87KWx1hGI6WBpCiXrm1MfTKst0sCwUCnuEhmkKV2sz3B1t0kUN1W6gDK5HuxZtyaS8xg13n57kZqwIqQtTxy5jYnJS9vf3Y3h4GMViUSWFY7e/bJiMs87rrHf+/HmUyKNMJqP2KkJu2729vcjn8yoOvMDjnp4elQibzC5wPoSasoovE7Or1K1lIpHYI6SgC6uA1X20rx/PcUJsMBFL230mt/XsvYqQgi6sjEo+ma0kF8AnsqX8nUwmlVX8zevkjbKQvxmkK62KEBqdLHiSNqkmyY8NkzEJvYjqe79kUr5NfD1Zx4Lqh+rVo5gJK25yYGBAxY4t+D/wOuux9QzrW/b19XH8hUYni2q1CoJ6Rjn9ra2t6t19Gy0tLSpu/Hbv7OygUqlgcXER29vbkp9i8lRox44dE/wXQMqysbERhw4dwoEDB3Dw4MF3wPM1NTVoampSB/A+/iYp+bDjx4+L/wA33yYGx6OxDgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"SoundCloud iPhone Sharing\" title=\"SoundCloud iPhone Sharing\" src=\"https://developers.soundcloud.com/blog/static/4b4afa2ba8edef2b8a25de084981fd7b/135ae/iphone-sharing.png\" srcset=\"/blog/static/4b4afa2ba8edef2b8a25de084981fd7b/9ec3c/iphone-sharing.png 200w,\n/blog/static/4b4afa2ba8edef2b8a25de084981fd7b/135ae/iphone-sharing.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" loading=\"lazy\" /> </a> </span></p> \n<p>For Cocoa apps, there is a specific guide <a href=\"https://developers.soundcloud.com/blog/blog/ios-sharing\">here</a>.</p> \n<p>If you have further questions about how your app can be integrated with SoundCloud, please contact <a href=\"mailto:api@soundcloud.com\">api@soundcloud.com</a> and we’re happy to help.</p>","descriptionType":"html","publishedDate":"Tue, 05 Apr 2011 00:00:00 +0000","feedId":10291,"bgimg":"http://oauth.net/images/oauth-2-sm.png","linkMd5":"64bb3b1d574d8ffd7416368292865e77","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn2@2020_1/2020/08/25/00-49-37-389_612e86863fc14120.webp","destWidth":124,"destHeight":123,"sourceBytes":13391,"destBytes":5198,"author":"","articleImgCdnMap":{"http://oauth.net/images/oauth-2-sm.png":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn2@2020_1/2020/08/25/00-49-37-389_612e86863fc14120.webp","https://developers.soundcloud.com/blog/static/4b4afa2ba8edef2b8a25de084981fd7b/135ae/iphone-sharing.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn86@2020_5/2020/08/25/00-51-42-243_a7822afab02b9d5c.webp"},"publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Getting a Team Back on Track","link":"https://developers.soundcloud.com/blog/getting-a-team-back-on-track","description":"<p>Sometimes, an important team that’s part of an otherwise healthy company culture starts tanking and the people on the team get frustrated and even quit.</p> \n<p>In this article, I want to share what I learned when I started to manage a team — referred to as the R Team from here on out — that had huge problems when I took over as Engineering Manager, as well as explain how I got it back on track.</p> \n<!-- more --> \n<p>I hope this post raises your awareness of some of the issues that can affect a team and that you will be able to apply them too — whether you’re a manager, an individual contributor, or just observing a team from the outside.</p> \n<h2>The TL;DR</h2> \n<ul> \n <li>Operating at the throughput limit of a team will tear it apart.</li> \n <li>Technical challenges and business pressure are not the problem. The problem is a lack of focus and collaboration.</li> \n <li>Limiting parallel work streams will increase productivity, team happiness, and stakeholder trust.</li> \n</ul> \n<h2>The Beginning</h2> \n<p>The R Team was always under a lot of pressure but somehow coped with it. But then, all of a sudden, the team seriously tanked. In a very short time, one of the engineers quit and the team’s Engineering Manager went on a break and later left the company. In the meantime, two of the team’s five engineers handed in their notices. This left the team with only two engineers, and one of them was also entertaining the thought of moving on.</p> \n<p>On the product management side, it was similar. One Product Manager left, and the next one stayed for only one month. The team was behind on everything, and the backlog was infinite. Work was no fun.</p> \n<h2>What Was Broken?</h2> \n<p>Most of the time, issues piling up is what can turn a team of great and motivated engineers into a frustrated bunch of individuals. But in order to understand the full picture and to come up with a plan to recover, it is important to put everything on the table. Within the R Team, there were a few very obvious problems that we identified right away:</p> \n<ul> \n <li>A huge amount of tech debt</li> \n <li>A large group of stakeholders, each of them asking the team to work on equally high-priority tasks</li> \n <li>A high amount of domain complexity</li> \n</ul> \n<p>To put this into perspective, the amount of tech debt and domain complexity made onboarding new team members — a process that should normally take no longer than a month — a long and intense three-month journey. And because of being pressed for time, there was never time to clean up tech debt. For instance, the oldest of the team’s data pipelines was still in production alongside two generations of rewrites. The same was true for other systems that had multiple generations of rewrites in production. The backlog stretched for years.</p> \n<p>It was a lot to deal with, but even under such arduous circumstances, a motivated team could take all this as a challenge and work hard to catch up. So why didn’t this team do this? Why did the members instead feel like giving up? To find out the answer to this, I had to do some digging.</p> \n<p>After continued talks and investigation, mostly in one-on-ones, more and more issues became clear. One was that in order to cope with the competing high-priority deliverables, the team parallelized workstreams, which made the members function more like a group of specialists working on separate things as opposed to a <a href=\"https://hbr.org/2005/07/the-discipline-of-teams\">team with a shared goal</a>. For example, the team often had more than one epic per person in the sprint as a way of keeping all high-priority tasks going. As a side effect, this pretty much prevented effective knowledge sharing. Indeed, in order to get a complete overview of the tech stack, all team members, each with individual special knowledge, were needed to give their input.</p> \n<p>The parallelization also delayed shipping, which then eroded trust from stakeholders. To make matters worse, the business expert who was needed to clarify technical specifications during implementation was overwhelmed by repetitive, manual work. This not only made his job tedious and labor-intensive, but it also made the feedback cycle on technical questions very long.</p> \n<p>In the middle of all of this, there was a big change in the organizational structure sitting above the team, and the manager of the team’s new group started up a parallel workstream to review alternative approaches to reducing the tech debt, ultimately replacing the team’s existing technical vision.</p> \n<p>Although this was done in collaboration with the team and one member of the team was seconded into the workstream, it couldn’t help but feel like the team wasn’t trusted to solve its own problems.</p> \n<p>All these issues considered, it’s fair to say that the team members had the collective feeling of not being heard, understood, or supported by the rest of the company.</p> \n<h2>Fixing Things</h2> \n<h3>Call for Support</h3> \n<p>The R Team is absolutely critical for our business, but the team was falling apart. Engineers wanting to leave a team or even the company is a very clear signal that a fundamental change is needed and things can’t continue in the same way. It was also a signal that we failed to take action on earlier signs. To deal with this, we knew the situation needed to be escalated through the whole company. And we escalated the hell out of it: within stakeholders meetings, in executive updates, and with whoever asked about the team.</p> \n<p>For starters, we began to look for people internally, and thankfully, we found great people to join the team. Both senior and junior engineers stepped up and wanted to help. And in an effort to bring the team back to its old capacity, we opened a job ad.</p> \n<p>We also got first-hand support from a Senior Principal Engineer who joined the team for more than a quarter. He kick-started migrating to a new tech stack, helped with forming a new tech vision, and provided guidance. All of this aided in relieving some of the pressure on the team. In addition to that, we found an amazing Product Manager whose tasks were to clearly prioritize projects and chase down simplifications. The situation of the team was being addressed, and the members felt like they were being listened to by the rest of the company. Support had arrived.</p> \n<p>When scaling the team, we also made it more diverse. We now have a team in which three out of seven engineers are women and the ratio of junior engineers to senior engineers is also balanced. This change automatically brought in new, differing, and fresh perspectives. It also helped the team in discussing problems more holistically; no questions remained unasked. This increased knowledge sharing and collaboration, and this alone already began shifting the team’s mood.</p> \n<h3>New Trust</h3> \n<p>In my opinion, the most important asset of a team is a shared goal in form of team vision, and the vision must come from within the team. The team members are the experts, and only the experts will be able to come up with the right plan. And as a bonus, because the entire team is involved in forming the plan, each team member naturally buys into it from the very beginning.</p> \n<p>But before a team can start discussing great plans, it needs be able to discuss effectively. So let’s get back to forming the vision later and instead focus on communication.</p> \n<p>The foundation of team discussions in which everyone speaks up and all options are being brought up is <a href=\"https://www.tablegroup.com/teamwork\">trust</a>. This is not only a must in order to come up with a long-term team vision, but it’s also absolutely necessary to effectively discuss small design decisions ad hoc. The fascinating simple mechanic here is: Get people to open up and share their story, and see how mutual understanding and trust grows. There are plenty of exercises to foster trust within a group, and a lot of them work. For us, two exercises did the trick: “Paint a picture about yourself,” in which we explained where we’re coming from; and “Ways of working,” in which we discussed how we worked — more specifically when we’re the most productive, what’s most important to us, and what’s most frustrating to us individually.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/8179c/back-on-track-paint.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECA//EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAGm1GJIf//EABcQAAMBAAAAAAAAAAAAAAAAAAIQMQP/2gAIAQEAAQUCqOrS/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAgMAAAAAAAAAAAAAAAAAEQEhQXGx/9oACAEBAAE/IUFCd0SpowiDif/aAAwDAQACAAMAAAAQmx//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgMAAwAAAAAAAAAAAAABABEhMUFRYcH/2gAIAQEAAT8QaOh6guppkthXDh+mAZfO47svTTBZrgJ//9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"back on track paint\" title=\"back on track paint\" src=\"https://developers.soundcloud.com/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/a296c/back-on-track-paint.jpg\" srcset=\"/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/f544b/back-on-track-paint.jpg 200w,\n/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/41689/back-on-track-paint.jpg 400w,\n/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/a296c/back-on-track-paint.jpg 800w,\n/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/c35de/back-on-track-paint.jpg 1200w,\n/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/8179c/back-on-track-paint.jpg 1600w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>And of course, offsites were instrumental in building togetherness within the team. Taking time away from project work to have full-day offsite meetings, which are primarily focused on vague trust building, might first seem like a big investment, but these paid off immediately. Everyone got to know their teammates better, and as a result, both communication and collaboration improved almost instantaneously.</p> \n<h3>Defining a Vision</h3> \n<p>In a couple of workshops, we discussed the biggest pain points the team was facing. We started to put together a “Most Wanted” list of the worst kind of tech debt. In separate sessions, we discussed an ideal solution to our domain challenges and came to similar conclusions, albeit from differing angles. We decided we would weigh work in planning sessions to determine if it would bring us closer to our tech vision or help eliminate painful tech debt like slow, flaky, or tedious manual processes.</p> \n<p>But how do we cover what we actually need to deliver to our business? It turned out that just two metrics needed to be visualized to measure our progress: First, a view of how well we were doing in hitting monthly deadlines to generate data outputs (pictured). And second, the number of completed deliverables versus the total number of deliverables. This made our progress and our targets very clear.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/39e8c349e19c63ba7707287e28c46895/92869/back-on-track-kpi.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 60.08733624454149%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACWklEQVQoz22SyU8UURDG5++TC2KEYYZhSQYE0YMBvHIgBq4cTEwwGi9EORCIzMosCJOJMS4RBkJA5GAMMWGZBbqZ7tfvZ/XCOBpfUl1VXfW+el9Vher1OicnDaoXdWzbwj1aa/fbEs8PpN32fe8GtnWN4ziEXHdiAqo1DwvL9nXjElZWoenXwNE+PH+V8o9taU5+nlGrVQm5ieOjFpVPBlybEja4Ojd5dN+k65bJYcX9Z6JNA3VlYl+KbRjiB1pYKQFpNAyazSYhpRyG4xAJKxo1xXpGcW9Y0XNXEYs69McUz57aOLYSYMWTGUX13Le1/NNCs/2EXNTZ2V903YGDAxga0nR2Qm9E0z+gPN3RAcfHmsNDh8FBzUXVJetgCVW3bzrorSteD8vld8zNfRMATSQqYL3yYgFaWvogBSymps4YEKCeHojF4PS0/U3BoIJhepS3NjfZKCQYHanTF7F58fwLI/FLEm83ePXyM9l0jvGxqheLRS0eT1qcn1ok15qYht0C8wBdypsCmM1kWV4uE48bJNY2ePP6PZlMQYqlyefWSaeK9PUpurshHHZ4+EDTdRsuvH7qYIsCyltbJdblUqGQZ0D6trJSplQSoEKBXK5ILp8nLzIz80NAhXoYolHF6JjJ5KTshUEL1AMsFoskk0lSqSzT099ZXc3L61Kk0xnRGdFpT3K5JIuLJRYWPkpOgUQiy/z8Dqap/vTQpby/v0+lUmF3d1fsHU//TyoVN74t2/CVvT03b4ejo22UstuHov4ZvR+wLFlYidm23bJ9cXBX7yb/Zg1v7v4GYmNKvbg3X9EAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"back on track kpi\" title=\"back on track kpi\" src=\"https://developers.soundcloud.com/blog/static/39e8c349e19c63ba7707287e28c46895/8ff1e/back-on-track-kpi.png\" srcset=\"/blog/static/39e8c349e19c63ba7707287e28c46895/9ec3c/back-on-track-kpi.png 200w,\n/blog/static/39e8c349e19c63ba7707287e28c46895/c7805/back-on-track-kpi.png 400w,\n/blog/static/39e8c349e19c63ba7707287e28c46895/8ff1e/back-on-track-kpi.png 800w,\n/blog/static/39e8c349e19c63ba7707287e28c46895/6ff5e/back-on-track-kpi.png 1200w,\n/blog/static/39e8c349e19c63ba7707287e28c46895/2f950/back-on-track-kpi.png 1600w,\n/blog/static/39e8c349e19c63ba7707287e28c46895/92869/back-on-track-kpi.png 2290w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Another tool that turned out to be super useful was a complete system diagram, which functioned not only as a snapshot in time, but also as a living document we would actively maintain. We would even color components we wanted to get rid of in red. And in order to visualize progress we made, we cloned snapshots of the drawing every quarter. We also linked all the components to repositories or other resources. If anything was unclear or missing, we often discussed this in the comments of the diagram.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/d151cac99d8b4f51d1e43e9726691bcd/7ac7b/back-on-track-system.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 79.20858484238767%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADYUlEQVQ4yy2U527bSBSF+f4vtYuF7USyKpvY6wyb2NTclOTLlbE/LihQmHNP4xhtGaGzgM/K5Fr7zIXFkNvclMVchYyFy7Xccxo7uvmd/nRDtwPVcZLfbxznG/P5RlFWFNURoysD2tSSQzsuxY4ptzhlG07JkiY7UBcRU2Ezdpq4vVK0M+10ox0vqG7meJYlAu4fQvTxhKGyiCaxKeID53zLEP5kDp8Yvf+4JAumbMc5WzP3DdV4RjdH6uP4zbAZzt8sh9OFrNTCfMTQRUKduNxKk3dhWcc70t2/nKNnumjNFC/5XcqSoaUWgLYf5GCPkulkQSvTzRfsWGGG6iE5+pY8lQvmckmehFSxxb3aMJQubSJ25BuRXNOdPuTwlaaf6GRaYanEz0HepbkiSkuMXjwc0y06ekVFK+poQxcuOR2euIYv9JlJG23p6oK6P8mMNPNEPY6o41H8nBnO8r4TS7oWYy4dCWMroDsq16S0t7TBiqv/wk3kTtmWOd2QZzZ5qQhLH7+xCRsXV2wKGoewPRB3PtHxgPFLpH2pBfd8waf9zJf3wlf+gzlbiXSbOX7lLXlCiXxVNcQqIa9LyrqSp5aqaHJVUGhNVCcYb3otgK98KmEpbEepyDV85eS+MiQbeuVJN10B8LDyBL9KKKtSQBSlgGQyqpIONg1Rm2F8CCCVsBDAJC/w44xJPL3nP7mKj+/xgj+iQrc2G+noPjeljylm4mDJ+LlDUPnkTUncRBiThNA70j93y+RKTQ5bmt0zzeofqtULw/4Z1JKqtfD6PVZps04UyzBlEaRs7B2u3nKUgFSbYzz6N8YP43f/P/ffX8oU/KBxn9HOkjrzCFOPvbQgbA7oh3dNQaIikjLBUw6pjglrCeW9srlUB67a4SRzrgLetMlv8fVerFBZSJgpbMdjGyzxawf9CEKnRNoTP3MJJyWpYrzKwvis9hKEI32TRJO1fC1ruRhM8XQvYa25iIKHily7OM1eknRFvqIQEL+2pUIWByHlaBtbC+Bd9D/Kq0LzG/AzE99UyPC4ZdIFKg1EcoAXWFhqQ1zHxMIuFImWnLPyNbYstOWW2hemAEop77XJWV7+liS/ZOt74/EhXt1l+y+ZP/J/00txe09kJRJCiasyglTY9kpuGelllwlbl7/UM4w5cSPB9AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"back on track system\" title=\"back on track system\" src=\"https://developers.soundcloud.com/blog/static/d151cac99d8b4f51d1e43e9726691bcd/8ff1e/back-on-track-system.png\" srcset=\"/blog/static/d151cac99d8b4f51d1e43e9726691bcd/9ec3c/back-on-track-system.png 200w,\n/blog/static/d151cac99d8b4f51d1e43e9726691bcd/c7805/back-on-track-system.png 400w,\n/blog/static/d151cac99d8b4f51d1e43e9726691bcd/8ff1e/back-on-track-system.png 800w,\n/blog/static/d151cac99d8b4f51d1e43e9726691bcd/6ff5e/back-on-track-system.png 1200w,\n/blog/static/d151cac99d8b4f51d1e43e9726691bcd/7ac7b/back-on-track-system.png 1491w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>Now we had a go-to visualization that everyone could use to help in understanding the big picture. And we still use this diagram today — for example, during sprint planning, in order to discuss upcoming epics and their dependencies and changes in relation to the rest of our infrastructure.</p> \n<h3>Automate All the Things!</h3> \n<p>The productivity of the R Team relies upon a responsive business expert to clarify all kinds of questions, but as mentioned earlier, the expert was often too busy with manual tasks, like creating reports, to respond to requests. He was even trying to help the team by manually delivering tasks, but this almost led to a deadlock situation. He was a <a href=\"https://en.wikipedia.org/wiki/Theory_of_constraints\">constraint in the team’s value chain</a>.</p> \n<p>Automating the tasks on his plate unblocked us and freed up more than 30 hours of his time each month. In addition, it also increased quality and decreased the total time of the related business processes. Computers were invented for the purpose of automating repetitive tasks, and doing so in this situation made work on the business side much more meaningful. Together with business, we now tightly collaborate on the epic at hand. With the shorter feedback cycle, we’re much faster. Additionally, the business side now has more bandwidth to talk to external partners directly and manage their relationships.</p> \n<h3>Ruthless Prioritization</h3> \n<p>Even if determining top priorities may seem impossible at times, it can always be done. It must always be done. Depending upon your team size, you also need to limit the amount of work streams. As a rule of thumb, the number of team members divided by two is the maximum number of work streams that should be in progress.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/89046fde0dff8d7fb8593feec03e0863/04090/back-on-track-max.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 15.45138888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAi0lEQVQI111PQQrEIAzs/x9WihUKbVHBg0cPxQoWpIo6i2G7lB0YEjJJJhnwRWvtF0spqLXijafuvYe1luJ1XTjPE8dxwDmHlBKG+74xjiOklDDGQCkFxhj2fce6rqRprWmwL9m2DdM0QQiBeZ6JnHMsy0L60J1jjMg5E7vLk3ezR+sX/zOEQP3vrz6yGOL2UVf0JAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"back on track max\" title=\"back on track max\" src=\"https://developers.soundcloud.com/blog/static/89046fde0dff8d7fb8593feec03e0863/8ff1e/back-on-track-max.png\" srcset=\"/blog/static/89046fde0dff8d7fb8593feec03e0863/9ec3c/back-on-track-max.png 200w,\n/blog/static/89046fde0dff8d7fb8593feec03e0863/c7805/back-on-track-max.png 400w,\n/blog/static/89046fde0dff8d7fb8593feec03e0863/8ff1e/back-on-track-max.png 800w,\n/blog/static/89046fde0dff8d7fb8593feec03e0863/04090/back-on-track-max.png 1152w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>There is a long list of reasons why this is absolutely necessary:</p> \n<ul> \n <li>For individuals, working sequentially is faster because it reduces context switching.</li> \n <li>Collaboration is the most effective knowledge sharing. Ignoring that leads to self-imposed fires because any individual team member may eventually go on vacation, go on parental leave or sick leave, or leave the team altogether. Ideally, you actually want at least three engineers to have enough context to work on each task.</li> \n <li>It has a direct impact on team happiness. It allows people to support each other by discussing and solving problems together and to ultimately feel like they’re part of a great team.</li> \n <li>Wrapping up work-in-progress as quickly as possible helps with managing stakeholder expectations and gives the team a sense of accomplishment and progress.</li> \n</ul> \n<p>Of course, this all may sound like common sense. However, it’s really easy to fall into the trap of committing to too many things when we are under pressure, both individually and as teams. Taking on more work when there’s already too much is neither healthy nor effective.</p> \n<p>Stakeholder conversations can be tough because you need to push for the exact order of the top priorities and the team must only work on a few of them at a time. This might be quite a shock for the stakeholders. But by doing so, the team will actually start to ship efficiently again. And by showing you can complete work efficiently, you regain trust with your stakeholders. In short, building trust with stakeholders is fascinatingly simple: Be very clear with the progress of all your projects and deliver them one by one.</p> \n<h2>Conclusion</h2> \n<p>With the right approach, the R Team’s morale was recovered in a very short time. And after only four months, the team was back on track delivering on business requirements while chipping away at tech debt. And none of this was magic.</p> \n<p>As stated in the beginning, operating at the throughput limit of a team will tear it apart. A team with 99 percent utilization will actually be slower than a team with some breathing room. And as tech debt piles up and knowledge silos develop further, the team will start to struggle.</p> \n<p>Technical challenges and business pressure are also not the problem. We all want to work on important and challenging problems and make a great impact. The problem is a lack of focus and collaboration.</p>","descriptionType":"html","publishedDate":"Wed, 25 Jul 2018 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/a296c/back-on-track-paint.jpg","linkMd5":"58efd0c426cab9f547e717054f187f59","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn65@2020_3/2020/08/25/00-49-38-928_b563abceaf9d6b94.webp","destWidth":800,"destHeight":600,"sourceBytes":27213,"destBytes":30436,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/a296c/back-on-track-paint.jpg":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn65@2020_3/2020/08/25/00-49-38-928_b563abceaf9d6b94.webp","https://developers.soundcloud.com/blog/static/39e8c349e19c63ba7707287e28c46895/8ff1e/back-on-track-kpi.png":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn69@2020_2/2020/08/25/00-51-44-452_25ba7d56d596d6e3.webp","https://developers.soundcloud.com/blog/static/d151cac99d8b4f51d1e43e9726691bcd/8ff1e/back-on-track-system.png":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn23@2020_3/2020/08/25/00-51-45-414_b1e56e4b412257cb.webp","https://developers.soundcloud.com/blog/static/89046fde0dff8d7fb8593feec03e0863/8ff1e/back-on-track-max.png":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn77@2020_1/2020/08/25/00-51-42-245_d76814c76d84a84b.webp"},"publishedOrCreatedDate":1598316569975},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Congratulations, you have a lot of code!\"Congratulations, you have a lot of code!\" Remedying Android’s method limit - Part 1","link":"https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-1","description":"<p>At SoundCloud we have been building for the Android platform since 2010. Much has changed since then: the team has grown, the list of features has grown, and our audience has grown. Today, eight engineers are working full time on the official SoundCloud app, across various areas, with contributions pouring in from other parts of the organization. Due to the growing complexity and number of contributions, the app’s size has grown substantially. Currently the app consists of approximately 1200 Java source files, not counting tests, containing approximately 86000 lines of code. This doesn’t include native code, such as our playback or recording stacks.</p> \n<p>We’re not the first to run into Android’s limits in terms of build tools. An internal limitation of Dalvik’s byte code format (DEX), which I will explain in more detail, can leave you unable to build after your codebase reaches a certain size. If you fail to anticipate this, it might happen during the most inconvenient time, such as when you are preparing for a release. Part of our job in Core Engineering at SoundCloud is to make sure our developers are happy and productive; not being able to build our app anymore makes for neither happy nor productive developers.</p> \n<p>While there are a number of posts on this topic, I would like to describe in more detail what we have done to combat Android’s method limit, what things worked well and what didn’t work so well, what it actually means to use the <code class=\"language-text\">dx</code> tool’s <code class=\"language-text\">--multi-dex</code> switch and what you can do to improve application health with regards to size.</p> \n<!-- more --> \n<p>The article is in two parts: part one lays out the basic problem and describes a number of options that you have to stay under the method limit. Part two focuses on Android’s MultiDex mode, which you can use to grow your app beyond the method limit.</p> \n<h2>The DEX Method limit</h2> \n<p>Android’s DEX format dates back to a time when applications were a lot smaller and devices were more resource constrained. To accommodate for this, the size of a DEX file’s method index is <a href=\"https://source.android.com/devices/tech/dalvik/dalvik-bytecode.html\">limited to 16 bits</a>, which means if your application references more than 65,536 (2^16) methods in total, the dx tool will refuse to build your app. That number includes <a href=\"https://developer.android.com/tools/building/multidex.html\">“Android framework methods, library methods, and methods in your own code”</a>. 65k might sound like a lot, but when Android’s own support libraries account for about a third of that, and if on top of that you’re using one or two large libraries like Guava or Jackson, you rapidly approach that limit. To find out where you’re at, there are <a href=\"https://github.com/mihaip/dex-method-counts\">convenient tools</a> to count the number of methods in your app’s DEX file.</p> \n<p>To address a common point of confusion, the method limit described above is unrelated to “jumbo mode”, but it has a similar cause. Jumbo mode pertains to the number of strings that can be referenced in a DEX file, which by default are indexed using 16 bit wide integers. Therefore, if your application encodes more than 2^16 strings, the dx tool will fail as well. For string references however, there is a remedy: DEX supports <a href=\"https://source.android.com/devices/tech/dalvik/dalvik-bytecode.html\">“jumbo opcodes”</a> which allow for 32 bit wide string references. The <code class=\"language-text\">jumboMode</code> flag in an Android Gradle build script enables this mode, allowing up to 2^32 strings to be referenced. However no equivalent switch exists for method references, so jumbo mode does nothing for you when your DEX file exceeds the number of methods allowed.</p> \n<p>The following sections will outline attempts we made to address the method limit imposed on an application.</p> \n<h2>Overcoming the method limit</h2> \n<p>It looks like we’ve hit a wall–not being able to assemble an APK anymore is not where you want to be. There are a number of options to overcome the limit, each with drawbacks and benefits. Let’s touch on the most obvious one first: putting your app on a diet!</p> \n<h3>Trimming dependencies</h3> \n<p>When we first hit the DEX method limit, we made the mistake of taking shortcuts to dodge it, such as staying on outdated but smaller versions of libraries like the Play services. Don’t do that!</p> \n<p>Sure, old dependencies wil buy you time for the short term if you’re stuck with a broken build. However, do invest effort into making sure you don’t immediately hit the limit again. Since removing dependencies from your app isn’t something you do in an afternoon and since MultiDex sounded scary and was something we initially considered a last resort, we opted for a hack: trimming down libraries using ProGuard and use those in debug versions of the app.</p> \n<p>If the release build is healthy in terms of method count, but the debug build isn’t, it means we’re dragging around a lot of unused stuff, so why not get rid of it in the first place? Thus was born: The Repacker!</p> \n<p>The idea is simple: have a Gradle task that performs a debug build with a special ProGuard config that only removes, neither optimizing nor obfuscating, finds all surviving classes for a particular library we’re targeting, rolls them into a new JAR and deploys it to our artifact repository under a new version. Then change the app to depend on the trimmed down version of the library which contains only the methods it actually needs. We’ve done this successfully for Guava, Jackson and the Facebook SDK, but it works best for libraries that change infrequently.</p> \n<p>This has several drawbacks. First, if you do this with a library like Guava, where you don’t know in advance what parts of the library you want to use, you will have to keep repacking the library as you need different parts. Second, since ProGuard sometimes accidentally removes parts that are actually in use, one might have to repack multiple times with different configurations to achieve the desired result. Lastly, we lost support for source JARs and JavaDocs, although we could have brought them back with further workarounds. While it sounded good on paper, we found this solution difficult to work with in the end, and it will not help at all if you’re exceeding the method count even after ProGuard strips away classes.</p> \n<h3>Losing dependencies</h3> \n<p>Cutting down the number of dependencies might sound obvious, but there are a few things worth pointing out.</p> \n<p>First, we as developers are not always conscious enough of the possible repercussions of our lasting choices. Here’s an example: choosing your building blocks. Take <a href=\"https://github.com/google/guava\">Guava</a> for instance. If you’re not familiar with the library, it contains a wealth of utilities that aim to close many of the gaps in Java’s language library, especially when you’re stuck with Java 6 (which you are unless you’re targeting KitKat and above). Unfortunately, the library is massive; it’s a single JAR clocking in at roughly 5MB and leaves a substantial footprint on your method allowance. It’s easy to just drop that dependency in your build script and unlock all the niceties it offers, but since it operates at a foundational level, it is bound to appear everywhere. Libraries like these are very difficult to rip out of your application later on, making these choices expensive to revisit. Moreover, you’d be surprised how much stuff a single method you use can drag on board along with it. Guava in particular is highly self-referential, so using one part of it will most likely make you unknowingly use a good chunk of its other—superficially unrelated—parts.</p> \n<p>We didn’t have this foresight and used Guava extensively; fortunately, it was one of those 80/20 things where in the majority of our code, we’d use a minority of the library. We took two weeks to remove Guava from our code base and salvage those high-value parts that we were using frequently into a utility library that is now fully owned and maintained by us. The great thing is that in the process we shed a lot of unnecessary code, such as Guava’s workarounds for GWT and older Java versions, which are all meaningless on Android. This made the code easier to read, test, and understand. Jackson is another offender in terms of method count. Because we didn’t encapsulate it sufficiently behind APIs we own, we haven’t yet been able to replace it. In summary: before you bake something you have little or no control over into the foundations of your app, think twice. The safest decisions are those that are reversible. Especially in <a href=\"https://www.facebook.com/notes/kent-beck/taming-complexity-with-reversibility/1000330413333156\">phases of rapid growth and uncertainty which are inherent to software start-ups</a>.</p> \n<p>In the <a href=\"https://developers.soundcloud.com/blog/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2\">next and final part</a>, we will turn to MultiDex and what you should know about when and how to use it.</p>","descriptionType":"html","publishedDate":"Mon, 21 Sep 2015 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"171933f0a91a3a99caad2cdccd98d7c3","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569978},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Evolution of SoundCloud’s Architecture","link":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","description":"<p>This is a story of how we adapted our architecture over time to accomodate growth.</p> \n<p>Scaling is a luxury problem and surprisingly has more to do with organization than implementation. For each change we addressed the next order of magnitude of users we needed to support, starting in the thousands and now we’re designing for the hundreds of millions. &nbsp;We identify our bottlenecks and addressed them as simply as possible by introducing clear integration points in our infrastructure to divide and conquer each problem individually.</p> \n<p>By identifying and extracting points of scale into smaller problems and having well defined integration points when the time arrived, we are able to grow organically.</p> \n<h2><a href=\"https://gist.github.com/6f734306b06a68ae5c74#product-conception\">Product conception</a></h2> \n<p>From day one, we had the simple need of getting each idea out of our heads and in front of eyeballs as quickly as possible. During this phase, we used a very simple setup:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/54e54/e1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 5.172413793103449%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAAPklEQVQI1z3HMRLAIAgEwPz/hbECihgRexia06Gw2GKfv39gZpgZRAREVJat+6ETU8c5o7X3XJGZcPcSEdcGpyJKrIHwepoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"e1\" title=\"e1\" src=\"https://developers.soundcloud.com/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/54e54/e1.png\" srcset=\"/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/9ec3c/e1.png 200w,\n/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/c7805/e1.png 400w,\n/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/54e54/e1.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<p>Apache was serving our image/style/behavior resources, and Rails backed by MySQL provided an environment where almost all of our product could be modeled, routed and rendered quickly. Most of our team understood this model and could work well together, delivering a product that is very similar to what we have today.</p> \n<p>We consciously chose not to implement high availability at this point, knowing what it would take when that time hopefully arrived. At this point we left our private beta, revealing SoundCloud to the public.</p> \n<p>Our primary cost optimization was for opportunity, and anything that got in the way of us developing the concepts behind SoundCloud were avoided. For example, when a new comment was posted, we blocked until all followers were notified knowing that we could make that asynchronous later.</p> \n<p>In the early stages we were conscious to ensure we were not only building a product, but also a platform. Our&nbsp;<a href=\"https://developer.soundcloud.com/\">Public API</a>&nbsp;was developed alongside our website from the very beginning. We’re now&nbsp;<a href=\"https://backstage.soundcloud.com/2012/06/building-the-next-soundcloud/\">driving the website</a>&nbsp;with the same API we were offering to 3rd party integrations.</p> \n<h2>Growing out of Apache</h2> \n<p>Apache served us well, but we were running Rails app servers on multiple hosts, and the routing and virtual host configuration in Apache was cumbersome to keep in sync between development and production.</p> \n<p>The Web tier’s primary responsibility is to manage and dispatch incoming web requests, as well as buffering outbound responses so to free up an application server for the next request as quickly as possible. This meant the better connection pooling and content based routing configuration we had, the stronger this tier would be.</p> \n<p>At this point we replaced Apache with Nginx and reduced our web tier’s configuration complexity, but our architecture didn’t change.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/4ffdf00e28a16c6f91cf7b6bff99bf4a/54e54/e2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 5.172413793103449%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAANklEQVQI133HwQkAMAgEwfRfpYKeoAWorwukgDwWZk/AKSKsKqrqszvemxkDYGZyd9ndnJlvF9K4S+EUQzZmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"e2\" title=\"e2\" src=\"https://developers.soundcloud.com/blog/static/4ffdf00e28a16c6f91cf7b6bff99bf4a/54e54/e2.png\" srcset=\"/blog/static/4ffdf00e28a16c6f91cf7b6bff99bf4a/9ec3c/e2.png 200w,\n/blog/static/4ffdf00e28a16c6f91cf7b6bff99bf4a/c7805/e2.png 400w,\n/blog/static/4ffdf00e28a16c6f91cf7b6bff99bf4a/54e54/e2.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<h2><a href=\"https://gist.github.com/6f734306b06a68ae5c74#load-distribution-and-a-little-queue-theory\">Load distribution and a little queue theory</a></h2> \n<p>Nginx worked great, but as we were growing, we found that some workloads took significantly more time compared to others (in the order of hundreds of milliseconds).</p> \n<p>When you’re working on a slow request when a fast request arrives, the fast request will have to wait until the slow request finishes, called “<a href=\"http://en.wikipedia.org/wiki/Head-of-line_blocking\">head of the line</a>&nbsp;blocking problem”. When we had multiple applications servers each with its own listen socket backlog, analogous to a grocery store, where you inevitably stand at one register and watch all the other registers move faster than your own.</p> \n<p>Around 2008 when we first developed the architecture, concurrent request processing in Rails and ActiveRecord was fairly immature. Even though we felt confident that we could audit and prepare our code for concurrent request processing, we did not want to invest the time to audit our dependencies. So we stuck with the model of a single concurrency per application server process and ran multiple processes per host.</p> \n<p>In&nbsp;<a href=\"http://en.wikipedia.org/wiki/Kendall's_notation\">Kendall’s notation</a>&nbsp;once we’ve sent a request from the web server to the application server, the request processing can be modeled by a&nbsp;<a href=\"http://en.wikipedia.org/wiki/M/M/1_queue\">M/M/1</a>&nbsp;queue. The response time of such a queue depends on all prior requests, so if we drastically increase the average work time of one request the average response time also drastically increases.</p> \n<p>Of course, the right thing to do is to make sure our work times are consistently low for any web request, but we were still in the period of optimizing for opportunity, so we decided to continue with product development and solve this problem with better request dispatching.</p> \n<p>We looked at the Phusion passenger approach of using multiple child processes per host but felt that we could easily fill each child with long-running requests. This is like having many queues with a few workers on each queue, simulating concurrent request processing on a single listen socket.</p> \n<p>This changed the queue model from&nbsp;<a href=\"http://en.wikipedia.org/wiki/M/M/1_queue\">M/M/1</a>&nbsp;to&nbsp;<a href=\"http://en.wikipedia.org/wiki/M/M/c_queue\">M/M/c</a>&nbsp;where&nbsp;<code class=\"language-text\">c</code>&nbsp;is the number of child processes for every dispatched request. This is like the queue system found in a post office, or a “take a number, the next available worker will help you” kind of queue. This model reduces the response time by a factor of&nbsp;<code class=\"language-text\">c</code>&nbsp;for any job that was waiting in the queue which is better, but assuming we had 5 children, we would just be able to accept an average of 5 times as many slow requests. We were already seeing a factor of 10 growth in the upcoming months, and had limited capacity per host, so adding only 5 to 10 workers was not enough address the head of the line blocking problem.</p> \n<p>We wanted a system that never queued, but if it did queue, the wait time in the queue was minimal. Taking the&nbsp;<a href=\"http://en.wikipedia.org/wiki/M/M/c_queue\">M/M/c</a>&nbsp;model to the extreme, we asked ourselves “how can we make&nbsp;<code class=\"language-text\">c</code>&nbsp;as large as possible?”</p> \n<p>To do this, we needed to make sure that a single Rails application server never received more than one request at a time. This ruled out TCP load balancing because TCP has no notion of an HTTP request/response. We also needed to make sure that if all application servers were busy, the request would be queued for the next available application server. This meant we must maintain complete statelessness between our servers. We had the latter, but didn’t have former.</p> \n<p>We added&nbsp;<a href=\"http://haproxy.1wt.eu/\">HAProxy</a>&nbsp;into our infrastructure, configuring each backend with a maximum connection count of 1 and added our backend processes across all hosts, to get that wonderful&nbsp;<a href=\"http://en.wikipedia.org/wiki/M/M/c_queue\">M/M/c</a>&nbsp;reduction in resident wait time by queuing the HTTP request until any backend process on any host becomes available. HAProxy entered as our queuing load balancer that would buffer any temporary back-pressure by queuing requests from the application or dependent backend services so we could defer designing sophisticated queuing in other components in our request pipeline.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/4339503b67abd7892be39a5ffe110d4a/54e54/e3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 31.379310344827587%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAAhUlEQVQY06WOvQ7DIAyEef+nayM1A1PTDIFG0Ahj8TdcA1KjrKTD+WxL/nwixgi1LJieE4gIdQ4hNL8iUYv3HttnO2B/AXPOWNc3lNKo/Q92FSpSSu2YmVFKORKe1fNAMHtIKTE+Rlhr27I+OXtPWkHOYbjfdg14zTMcOWitYYxpXpP3QL/eXdCJnPobGAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"e3\" title=\"e3\" src=\"https://developers.soundcloud.com/blog/static/4339503b67abd7892be39a5ffe110d4a/54e54/e3.png\" srcset=\"/blog/static/4339503b67abd7892be39a5ffe110d4a/9ec3c/e3.png 200w,\n/blog/static/4339503b67abd7892be39a5ffe110d4a/c7805/e3.png 400w,\n/blog/static/4339503b67abd7892be39a5ffe110d4a/54e54/e3.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<p>I heartily recommend&nbsp;<a href=\"http://en.wikipedia.org/wiki/Neil_J._Gunther\">Neil J. Gunther’s</a>&nbsp;work&nbsp;<a href=\"http://www.perfdynamics.com/iBook/ppa_new.html\">Analyzing Computer System Performance with Perl::PDQ</a>&nbsp;to brush up on queue theory and strengthen your intuition on how to model and measure queuing systems from HTTP requests all the way down to your disk controllers.</p> \n<h2><a href=\"https://gist.github.com/6f734306b06a68ae5c74#going-asynchronous\">Going asynchronous</a></h2> \n<p>One class of request that took a long time was the fan-out of notifications from social activity. For example, when you upload a sound to SoundCloud, everyone that follows you will be notified. For people with many followers, if we were to do this synchronously, the request times would exceed the tens of seconds. We needed to queue a job that would be handled later.</p> \n<p>Around the same time we were considering how to manage our storage growth for sounds and images, and had chosen to offload storage to&nbsp;<a href=\"http://aws.amazon.com/s3/\">Amazon S3</a>&nbsp;keeping transcoding compute in&nbsp;<a href=\"http://aws.amazon.com/ec2/\">Amazon EC2</a>.</p> \n<p>Coordinating these subsystems, we needed some middleware that would reliably queue, acknowledge and re-deliver job tickets on failure. We went through a few systems, but in the end settled on AMQP because of having a programmable topology, implemented by&nbsp;<a href=\"http://www.rabbitmq.com/\">RabbitMQ</a>.</p> \n<p>To keep the same domain logic that we had in the website, we loaded up the Rails environment and built a lightweight dispatcher class with one queue per concern. &nbsp;The queues had a namespace that describes estimated work times. This created a priority system in our asynchronous workers without requiring adding the complexity of message priorities to the broker by starting one dispatcher process for each class of work that bound to multiple queues in that work class. Most of our queues for asynchronous work performed by the application are namespaced with either “interactive” (under 250ms work time) or “batch” (any work time). Other namespaces were used specific to each application.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/5c33e0ea39caa8b298ce951793d378d5/54e54/e4.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.03448275862069%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAA3ElEQVQoz6WSyQqDMBiE8/6vJ7S3upu4VMUENXqYZgJKKVi0PQwhaL6ZfxFKSsRRhGHQsHbGNE2Y5/lnCWMMuq7zF8L+BjZNAykVlmXZge/ajE4Dx3EEUxJorfXiB96vwjywqkrc7zfXwwF933vR5OmS0+hywt71T7rBaK1R17UXgUoW3oSJr5QviiJHEARIswzaJSKMkHVdd9j285mkoixLxHEMnqN7QOCmowF9AwumYK+M0cjSBEmSeAOlFLgBYfhA5PaUm/BZ/uGUt4Hkee6gKdq23af9rjMlvwBNGwUTQPqa3wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"e4\" title=\"e4\" src=\"https://developers.soundcloud.com/blog/static/5c33e0ea39caa8b298ce951793d378d5/54e54/e4.png\" srcset=\"/blog/static/5c33e0ea39caa8b298ce951793d378d5/9ec3c/e4.png 200w,\n/blog/static/5c33e0ea39caa8b298ce951793d378d5/c7805/e4.png 400w,\n/blog/static/5c33e0ea39caa8b298ce951793d378d5/54e54/e4.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<h2><a href=\"https://gist.github.com/6f734306b06a68ae5c74#caching\">Caching</a></h2> \n<p>When we approached the hundreds of thousands user mark, we saw we were burning too much CPU in the application tier, mostly spent in the rendering engine and Ruby runtime.</p> \n<p>Instead of introducing&nbsp;<a href=\"http://memcached.org/\">Memcached</a>&nbsp;to alleviate IO contention in the database like most applications, we aggressively cached partial DOM fragments and full pages. This turned into an invalidation problem which we solved by maintaining the reverse index of cache keys that also needed invalidation on model changes in memcached.</p> \n<p>Our highest volume request was one specific endpoint that was delivering data for the widget. We created a special route for that endpoint in nginx and added proxy caching to that stack, but wanted to generalize caching to the point where any end point could produce proper HTTP/1.1 cache control headers and would be treated well by an intermediary we control. Now our&nbsp;<a href=\"https://blog.soundcloud.com/2012/01/26/html5-widget/\">widget content</a>&nbsp;is served entirely from our public API.</p> \n<p>We added&nbsp;<a href=\"http://memcached.org/\">Memcached</a>&nbsp;and much later&nbsp;<a href=\"https://www.varnish-cache.org/\">Varnish</a>&nbsp;to our stack to handle backend partially rendered template caching and mostly read-only API responses.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/6f3af3d0fe190ec925393aeb5f0fa3c1/54e54/e5.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 60.862068965517246%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAA/UlEQVQoz52S3W6FIBCEef9H9KInCv4rVlEBvZjD0HMak6atejGSYPh2dmeF7ns8Hh/QWsN7D2stnHPf51UJY0yEWfsFeesuVNRVhTxXQTmklFBKwczzfSAdZlmGdV2xLEvU0eFVqCBoGIY4v+OPu22LcRxRluUP2G/6r4jI0hRJkqAPabP1aZpQ1xWapsG2bdG557n5U47Fvu+g+JAwYwisY0gMrCgKpKGoDMX0azR/OmzC47ZtMYdkOUuGwqA4ChMK8OQ9NZ9IX3QBRiAhdEjgcY6x5ZdOtcwPXXwGB0rJuItcdLbImTrnr4XCtSGw61qoMDcuNp2+A7m6Nk8jJp9bLHXiJAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"e5\" title=\"e5\" src=\"https://developers.soundcloud.com/blog/static/6f3af3d0fe190ec925393aeb5f0fa3c1/54e54/e5.png\" srcset=\"/blog/static/6f3af3d0fe190ec925393aeb5f0fa3c1/9ec3c/e5.png 200w,\n/blog/static/6f3af3d0fe190ec925393aeb5f0fa3c1/c7805/e5.png 400w,\n/blog/static/6f3af3d0fe190ec925393aeb5f0fa3c1/54e54/e5.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<h2><a href=\"https://gist.github.com/6f734306b06a68ae5c74#generalization\">Generalization</a></h2> \n<p>Our worker pools grew, handling more asynchronous tasks. The programming model was similar for all of them: take a domain model and schedule a continuation with that model state to be processed at a later state.</p> \n<p>Generalizing this pattern, we leveraged the after-save hooks in ActiveRecord models in a way we call&nbsp;<em>ModelBroadcast</em>. The principle is that when the business domain changes, events are dropped on the AMQP bus with that change for any asynchronous client that is interested in that class of change. This technique of decoupling the write path from the readers enables the next evolution of growth by accommodating integrations we hadn’t foreseen.</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\"> \n <pre class=\"language-ruby\"><code class=\"language-ruby\">after_create <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>r<span class=\"token operator\">|</span>\n  broker<span class=\"token punctuation\">.</span>publish<span class=\"token punctuation\">(</span><span class=\"token string\">\"models\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"create.<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>r<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span>name<span class=\"token delimiter tag\">}</span></span>\"</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>attributes<span class=\"token punctuation\">.</span>to_json<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span>\n\nafter_save <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>r<span class=\"token operator\">|</span>\n  broker<span class=\"token punctuation\">.</span>publish<span class=\"token punctuation\">(</span><span class=\"token string\">\"models\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"save.<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>r<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span>name<span class=\"token delimiter tag\">}</span></span>\"</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>changes<span class=\"token punctuation\">.</span>to_json<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span>\n\nafter_destroy <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>r<span class=\"token operator\">|</span>\n  broker<span class=\"token punctuation\">.</span>publish<span class=\"token punctuation\">(</span><span class=\"token string\">\"models\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"destroy.<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>r<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span>name<span class=\"token delimiter tag\">}</span></span>\"</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">.</span>attributes<span class=\"token punctuation\">.</span>to_json<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span></code></pre> \n</div> \n<p>This isn’t perfect, but it added a much needed non-disruptive, generalized, out-of-app integration point in the course of a day.</p> \n<h2><a href=\"https://gist.github.com/6f734306b06a68ae5c74#dashboard\">Dashboard</a></h2> \n<p>Our most rapid data growth was the result of our Dashboard. The Dashboard is a personalized materialized index of activities inside of your social graph and the primary place to personalize your incoming sounds from the people you follow.</p> \n<p>We have always had a storage and access problem with this component. Looking at the read and write paths separately, the read path needs to be optimized for sequential access per user over a time range. The write path needs to be optimized for random access where one event may affect millions of users’ indexes.</p> \n<p>The solution required a system that could reorder writes from random to sequential and store in sequential format for read that could be grown to multiple hosts. Sorted string tables are a perfect fit for the persistence format, and add the promise of free partitioning and scaling in the mix, we chose&nbsp;<a href=\"http://cassandra.apache.org/\">Cassandra</a>&nbsp;as the storage system for the Dashboard index.</p> \n<p>The intermediary steps started with the model broadcast and used RabbitMQ as a queue for staged processing, in three major steps: fan-out, personalization, and serialization of foreign key references to our domain models.</p> \n<ul> \n <li>Fan-out finds the areas of the social graph where an activity should propagate.</li> \n <li>Personalization looks at the relationship between the originator and destination users as well as other signals to annotate or filter the index entry.</li> \n <li>Serialization persists the index entry in Cassandra for later lookup and joining against our domain models for display or API representations.</li> \n</ul> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/679c7f38401cb7471c9614369c03c6e6/54e54/e6.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 80.51724137931035%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAABZklEQVQ4y6WU65KCMAyF+/6PyCguUOTSglzkzkzMiVZ3Z90d0R+h0w79kpwTUGVR0OHgU1mWNE0TDcMgMY7jW6HathWYO/gEJsAsTSnWmlJeHfDjCsMwpL7v77Dv0K1wBdDpdPql39vAuq4pSZIfh59UqsIgIM/zqGC30XrTNJRlKeV5TvO8bK5SLctCCLQMWNsCmFEcx1z5URI5OV4C5nzZGEPn81m07LqOYBSkuCZot7VsGQYgLgIAoAPAsM0t44FqUJ2OIgqDkPeNzKbv77ny7qlRf4WMDQD4BDHccBzVruvKpswvgx7AridrLbuakb/3KWDXkcDedAUUpmB1gb0zc0bczqVl0Yqh0M+YXMDDMNJ+tyOtY3Zbi+OQ4HhM+ExTxu9gxJAc+5jfi1iuiqVTD0GvWa8S1JRy6wBFES5+cSJzdx9rVVUSbhqwdnxXPdNBPkf+A+EvBDmsNWLOzK1O/wQKuwCEUdIifDjPqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"e6\" title=\"e6\" src=\"https://developers.soundcloud.com/blog/static/679c7f38401cb7471c9614369c03c6e6/54e54/e6.png\" srcset=\"/blog/static/679c7f38401cb7471c9614369c03c6e6/9ec3c/e6.png 200w,\n/blog/static/679c7f38401cb7471c9614369c03c6e6/c7805/e6.png 400w,\n/blog/static/679c7f38401cb7471c9614369c03c6e6/54e54/e6.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<h2><a href=\"https://gist.github.com/6f734306b06a68ae5c74#search\">Search</a></h2> \n<p>Our search is conceptually a back-end service that exposes a subset of data store operations over an HTTP interface for queries. Updating of the index is handled similarly to the dashboard via ModelBroadcast with some enhancement from database replicas with index storage managed by&nbsp;<a href=\"http://www.elasticsearch.org/\">Elastic Search</a>.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/db26cd209c79194cff637894ff4bbc53/54e54/e7.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 87.06896551724138%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAABeklEQVQ4y6WU6Y6CQBCEef+3c+NmAV2PQe7hxgtjartmg8GV6Ko/OjBD+KaqusHKswzL5QJ5nuN4PGK/35s6HA4vldU0jYH1G+/ADDCOIvibDSK59sC3FSqlsNvtLrAh9Fm4RVBRFDf5vQysqgphGF5tvqPUUus1Zq6LTLpN61Vdg7kmSYKu60YPuHeYNaTXAmslU61T06Q0iWUCCnSnE05SPGBYY8ovQGbILMuyFFgIz/PgieJUa9krTCxUzUql4jgeV8im9B2uK1HYtgbK2UzTFMyYZUCyZjQs3o8CPU/B9315qQZHqLdDi+fz2Shn/bV71zKzq6pfq2EQoBZwJBaVWqPdbu825kbhVl7IdAYtFpjbarUylnvrz36SJkMq5E+C1tldwgjgYcx1+BU9ghsglRTSBM4hO5sXJVzHhuO4CPzA2GZm19AHCqmGxTWvHA0tI8N1I8//a/8CZDM+p1OZr8R0e/E9h/1lw7YdzOczfEwmckD28J/5A5jiHk4BTY9BAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"e7\" title=\"e7\" src=\"https://developers.soundcloud.com/blog/static/db26cd209c79194cff637894ff4bbc53/54e54/e7.png\" srcset=\"/blog/static/db26cd209c79194cff637894ff4bbc53/9ec3c/e7.png 200w,\n/blog/static/db26cd209c79194cff637894ff4bbc53/c7805/e7.png 400w,\n/blog/static/db26cd209c79194cff637894ff4bbc53/54e54/e7.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<h2><a href=\"https://gist.github.com/6f734306b06a68ae5c74#notifications-and-stats\">Notifications and Stats</a></h2> \n<p>To make sure users are properly notified when their dashboard updates, whether this is over iOS/Android push notifications, email or other social networks we simply added another stage in the Dashboard workflow that receives messages when a dashboard index is updated. Agents can get that completion event routed to their own AMQP queues via the message bus to initiate their own logic. Reliable messages at the completion of persistence is part of the eventual consistency we work with throughout our system.</p> \n<p>Our statistics offered to logged in users at&nbsp;<a href=\"https://soundcloud.com/you/stats\">https://soundcloud.com/you/stats</a>&nbsp;also integrates via the broker, but instead of using ModelBroadcast, we emit special domain events that are queued up in a log then&nbsp;<a href=\"https://developers.soundcloud.com/blog/assets/posts/mysql-stats-ol\">rolled up</a>&nbsp;into a separate database cluster for fast access across the various time ranges.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/f77332c890943a3818b91ff2bf690bab/54e54/e8.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 129.65517241379308%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsSAAALEgHS3X78AAACIklEQVRIx6VV23aCMBDM//9htXIJELwCAVTUc9zuLA2NFVpsH/YACUxmZ3YXVRwOFAYBFUVBl8uFzuezRNd1fwrVNI2AuYX/gAngZr2mLE1pzVcH+G+GWms6nU4DmA/6KrgCUFmW1H3T78+A1lrK8/xh0Qd7FVjpOKbFYkEHdhup27om6Lrdbul6vT4AzwFX/oO1NbWs6X6/F5N2DFoUpQDfbrcnsDFg5TZQg9CyqiphmLLzSaKZ6Y5qlgUHPEoxwdBPpeZ027Zl4EJYIm0cYvkQAB6Px6EaJhmCmQuwg0lINcsyapq2P4ALP00TClYriqL4x3pVuTG02WzlQwT0AjiuzhQX7uAfTamqkgE30n7O3UaM2fE60jxNOj1pCrQDsOE0YUbNgCgj1Cd0e6UlpVOgHUwwJmdQIwfc73cJvxZntx4AwSiKIhHf1g1FYUDv7ysunVQk6LrLfIYNA+BlpIcyAcMs6ycQ9hFjrTgWA0MYsnh7k9RlAsURBUHoMZwGeQJEuVg2BXWGVgNT9HjGeuIeL34vp/7+q4ad1j3DEhrupc3gtOHaFM34BexD35gZo9jDMJTAMzTXOuEsEloul1J6AojuwL8FmkE/BLR04GA5RPsZx8dAlsCSXoZGrnSwiWf8FtBFYP3KkFV+S/mtFgQrYYqxNceMwZSxxX42WrmOzcFfGT6NftbCmEw01ToWfeaCqql/CVyXmciDwx8QvwF+AIqp1K5IUhrZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"e8\" title=\"e8\" src=\"https://developers.soundcloud.com/blog/static/f77332c890943a3818b91ff2bf690bab/54e54/e8.png\" srcset=\"/blog/static/f77332c890943a3818b91ff2bf690bab/9ec3c/e8.png 200w,\n/blog/static/f77332c890943a3818b91ff2bf690bab/c7805/e8.png 400w,\n/blog/static/f77332c890943a3818b91ff2bf690bab/54e54/e8.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<h2><a href=\"https://gist.github.com/6f734306b06a68ae5c74#whats-next\">What’s next</a></h2> \n<p>We have established some clear integration points in the broker for asynchronous write paths and in the application for synchronous read and write paths to backend services.</p> \n<p>Over time, the application server’s codebase has collected both integration and functional responsibilities. As the product development settles, we have much more confidence now to decouple the function from the integration to be moved into backend services that can be consumed à la carte by not only the application but by other backend services, each with a private namespace in the persistence layer.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/a493ebb0d86ca96b889cb2a345706cee/54e54/e9.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 136.20689655172413%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsSAAALEgHS3X78AAACG0lEQVRIx6WV23KCQBBE+f/PMy+JSURRrsttuQkYazI9ZA0JVWGND1sqsmd7enrAybOMXHdHeZ7TMAx0Pp9l9X3/r+XUdS0wc+ERmADjKCL/dKKIPw3wYYWe51HXdTfYHHov3AGoKIqFf/8Gaq0pDMMfFx9R6niHA71ut5Rxt1G6riqCr0mS0DiOiwPW4M78R8Wwhj1NUyVNSpJY7AD4crlYKXXMycPQy+ayLAV24s4fWXGiFGk9XbNWaG6AwrpuqOBcpmkqZc8PsQLOvdGlFuhUcihR6vg/AH3ftwPCn2EcJDaAYSmVSMn+14qimAI/oKZp14EwXqmUEPCyKEUVvhs4YoVPqOxsFE5eKdkEvwDAhrZpBNz3k3osqy6Ldwwpy4LL8qVUwIMgoP3e5TKbxYz/qRAlopyMlWJi4BWA1+uVPnjNw209ywCmnDfXdel49CQ6OABRQUPatrWGChBxgV8YP2QPB7zxOLruXr7fDayrmqFT2QC3fE0xGAoVK58D13x0uraTpiiOz9NmQzGDAN2+PNP7Dq+GQqI08izb+OmY3EEh1KBkRAmbzENXy+iFpHiC1hXyJsliHMt4AYiF94zWlcSmqrTcA4+tgGYSMHLGJ0QIyk2oUa51yVAxTcJwu9k04/fT20qhAX6vnifFlzzaPlgXJVfoNKvCPMMvPGXgJXy7K4e4CcA8z6STMTfH5A9ZDNjL+TyvAT8Bn9Eji6XsHUAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"e9\" title=\"e9\" src=\"https://developers.soundcloud.com/blog/static/a493ebb0d86ca96b889cb2a345706cee/54e54/e9.png\" srcset=\"/blog/static/a493ebb0d86ca96b889cb2a345706cee/9ec3c/e9.png 200w,\n/blog/static/a493ebb0d86ca96b889cb2a345706cee/c7805/e9.png 400w,\n/blog/static/a493ebb0d86ca96b889cb2a345706cee/54e54/e9.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<p>The way we develop SoundCloud is to identify the points of scale then isolate and optimize the read and write paths individually, in anticipation of the next magnitude of growth.</p> \n<p>At the beginning of the product, our read and write scaling limitations were consumer eyeballs and developer hours. Today, we’re engineering for the realities of limited IO, network and CPU. We have the integration points set up in our architecture, all ready for&nbsp;<a href=\"https://soundcloud.com/jobs\">the continued evolution of SoundCloud</a>!</p>","descriptionType":"html","publishedDate":"Thu, 30 Aug 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/54e54/e1.png","linkMd5":"617d6d78a6d4ea6c18a0ca90fa588e57","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn45@2020_1/2020/08/25/00-49-37-157_c93d9435c88d45ae.webp","destWidth":580,"destHeight":30,"sourceBytes":2017,"destBytes":3344,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/54e54/e1.png":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn45@2020_1/2020/08/25/00-49-37-157_c93d9435c88d45ae.webp","https://developers.soundcloud.com/blog/static/4ffdf00e28a16c6f91cf7b6bff99bf4a/54e54/e2.png":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn54@2020_6/2020/08/25/00-51-42-967_eb1e349f26efcb4c.webp","https://developers.soundcloud.com/blog/static/4339503b67abd7892be39a5ffe110d4a/54e54/e3.png":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn27@2020_6/2020/08/25/00-51-40-775_6dec13d91b489066.webp","https://developers.soundcloud.com/blog/static/5c33e0ea39caa8b298ce951793d378d5/54e54/e4.png":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn97@2020_3/2020/08/25/00-51-41-586_187d7275f1fad972.webp","https://developers.soundcloud.com/blog/static/6f3af3d0fe190ec925393aeb5f0fa3c1/54e54/e5.png":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn57@2020_4/2020/08/25/00-51-43-007_cca1397978b1ee7f.webp","https://developers.soundcloud.com/blog/static/679c7f38401cb7471c9614369c03c6e6/54e54/e6.png":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn55@2020_6/2020/08/25/00-51-40-371_976309458fe2b95e.webp","https://developers.soundcloud.com/blog/static/db26cd209c79194cff637894ff4bbc53/54e54/e7.png":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn12@2020_3/2020/08/25/00-51-44-244_e5127e5dc8b281dd.webp","https://developers.soundcloud.com/blog/static/f77332c890943a3818b91ff2bf690bab/54e54/e8.png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn32@2020_3/2020/08/25/00-51-44-294_eb475160e70a4d7e.webp","https://developers.soundcloud.com/blog/static/a493ebb0d86ca96b889cb2a345706cee/54e54/e9.png":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn36@2020_5/2020/08/25/00-51-42-301_cecf15fb6d1a07af.webp"},"publishedOrCreatedDate":1598316569982},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Congratulations, you have a lot of code!\"Congratulations, you have a lot of code!\" Remedying Android’s method limit - Part 2","link":"https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2","description":"<p>In <a href=\"https://developers.soundcloud.com/blog/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-1\">part one</a> we described how running into Android’s method limit may leave you unable to build, and offered strategies you can employ to make your app fit into a single DEX file. In this part we share an alternative option: using multiple DEX files.</p> \n<!-- more --> \n<h2>MultiDex</h2> \n<p>If you have exhausted your options for slimming down your DEX, then there is really only one option left: <a href=\"https://developer.android.com/tools/building/multidex.html\">MultiDex</a>. Enabling MultiDex mode is a simple switch in your build scripts, and it allows you to grow your app beyond the 65k method limit by letting extra code spill over into additional DEX files. This sounds like a great option, but it has a number of repercussions you should be aware of, especially when using it in production and targeting pre-Lollipop versions of Android. The <a href=\"https://developer.android.com/tools/building/multidex.html#limitations\">official documentation</a> has more information about these problems.</p> \n<p>In a nutshell, multidexing means chopping up your code into multiple DEX files, where normally just one DEX file is created. ART—Android’s new runtime—deals with this effortlessly, since any number of DEX files will be compiled into a single ELF binary before your application loads. However, if you’re aiming at a <code class=\"language-text\">minSdkLevel</code> below 21 (Lollipop) and need to run on devices that use Dalvik, the tool chain must perform some extra bookkeeping for this to work. This comes with some strings attached:</p> \n<ul> \n <li>You must include the <a href=\"https://developer.android.com/tools/support-library/features.html#multidex\">MultiDex support library</a> and modify your application to either inherit from <code class=\"language-text\">MultiDexApplication</code> or invoke the MultiDex loader manually. This is because Dalvik cannot natively deal with multiple DEX files. Luckily, this is safe to do even if you don’t use MultiDex in production builds.</li> \n <li>Your build times will increase, since the tool chain will employ ProGuard internally to split out your main application components and their direct dependencies into a primary DEX file, while moving all remaining code to a minimum number of additional DEX files. According to Android SDK lead Xavier Ducrohet, the Android Tools Team is “more than aware than this is a huge problem right now and we’re working on fixing this, but it’s going to be a while.” (quoted from a Slack conversation)</li> \n <li>The <code class=\"language-text\">preDexLibaries</code> flag will become inoperable, because the above step cannot be carried out without taking into account all class files, including those from external dependencies. This means that whenever you change a single line of code, the tools need to completely re-dex your app, including all library dependencies. ART does not have this limitation, as all DEX files (one for each runtime library plus those containing your app code) will be embedded in a single OAT file when being compiled down to machine code. Libraries can still be pre-dexed at build time, because they don’t need to be combined at build time.</li> \n <li>To use libraries which need to be aware of the full class graph, like Dagger, make sure that additional DEX files are loaded before you create your object graph. That means you cannot create your object graph in your application constructor anymore; instead, you can override <code class=\"language-text\">attachBaseContext</code> and create it after calling through to <code class=\"language-text\">super</code>.</li> \n</ul> \n<p>A workaround we adopted to get back some of the lost build performance is to create a product flavor which specifies <code class=\"language-text\">minSdkLevel</code> 21. The toolchain can assume ART as the sole runtime at this API level, and <a href=\"https://developer.android.com/tools/building/multidex.html#dev-build\">using this product flavor during development</a> is a fair compromise. Keep in mind though that this will affect things like the lint tool, which checks for misuse of platform APIs taking into account your range of API levels. That said, with the workaround in place your build server should still build product flavors that specify the shipping API levels.</p> \n<p>To get an idea of just how much build times would be improved by applying the suggested workaround, we ran a few tests and timed different kinds of builds both on the CLI and in Android Studio using MultiDex. What we measured were 4 things:</p> \n<ul> \n <li>time to test (TTT) using gradle-aware make: time it takes for the test results window to appear in the IDE when running a unit test, i.e. actual test run time is not accounted for</li> \n <li>TTT using Android Studio’s default IntelliJ style make</li> \n <li>time to launcher (TTL): time it takes for the launcher window to appear in the IDE when building/running the app,</li> \n <li>building on the CLI using the <code class=\"language-text\">assemble[Flavor]Debug</code> task.</li> \n</ul> \n<p>All of those were run in three variations: after a <code class=\"language-text\">clean</code>, after no changes, and after a single source file had changed.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 671px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/19234e7e3b35bc10753e8bfd33a724b4/ef3f5/build_times_min14.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.642324888226526%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABm0lEQVQoz12S304TURDG+2A+gi/hK3Cj3DYpXqASbjThhnBBNIEQ0JhQCNUAkQTBNooSFgLLhuLGlrR1/7V7/vw85+wuGudizpn5dr6dM9/UtNZYk1Li+z6e5xEEAWEYYqEK/99svsBdROVr9jIej0nTlCRJiKLInTYuS1FKI5VCSIWWwsSqJLWn4OZOcNkdmoQsCPM8dyT3f3de0WznDM824WK5RKQpL6zbS4mz4svk2ueq02EUxwWhfa4ldZ2Yu5LCFT9ZGnC9twA/Glz0Yb/Tg2DdYBGzqz2+fulAfxeGl4RnB/z8dVcQTiYTIsNe9ZaXvrEac9NeMR0+p3WimV+/hcNHkAa8eJtxctiEz1OuKk1GpFlWPVm4Wex++82HvXMItxzl4/lzTusP4WqWjyb9rLEBKw8M0mfmzYCjxRk4nkL9MyhHKIREi4wjb8T26w2iT3PkZuDvm6d8fzWNDPfxB7CztEay/dSUjmkddGm/rJN47xyhFcgqXyvlQjn9rZqCeFKtiyazIxF/O5BUqyIMrdkQUSR0uUp/AIIcV+rgj4eGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"MultiDex build times (minSdkLevel 14)\" title=\"MultiDex build times (minSdkLevel 14)\" src=\"https://developers.soundcloud.com/blog/static/19234e7e3b35bc10753e8bfd33a724b4/ef3f5/build_times_min14.png\" srcset=\"/blog/static/19234e7e3b35bc10753e8bfd33a724b4/9ec3c/build_times_min14.png 200w,\n/blog/static/19234e7e3b35bc10753e8bfd33a724b4/c7805/build_times_min14.png 400w,\n/blog/static/19234e7e3b35bc10753e8bfd33a724b4/ef3f5/build_times_min14.png 671w\" sizes=\"(max-width: 671px) 100vw, 671px\" loading=\"lazy\" /> </a> </span></p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 671px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/ba8c16495806d8ea168036311e941d56/ef3f5/build_times_min21.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.642324888226526%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABmElEQVQoz1WSbUsVQRSA76/qB/R//BxUHzQlokCMwOib0ZcbqAgRSfTmCxkaKFmK7lV379Va1xa77OzrzOzTzOx2tYHdOefMOc/MeenUdY1dSil838fzPIIgIAxDri/rp1vfdrsmt3bzdaxQFAVZlpGmKUmSuL3Ic06jnKJUJkiPgpTSTheZpKyUs5/GkuOzP0ZUDbCqKgf5/1YYnzthcG7tmjAuOOgLi3RnjxcG7B4NnSz8gJOdHYZCNECbroVqXTtZK+kcJ+aO6EeN/Gk75slCf3Tpo67Pt17SKPEe4eEXfkVxAyzLkkSIUVqV+0smuzGD3hb8Xmb1e8GzN5GxX9gIpud/shuYF1bnrr5ZmpCZMrUpS4fZ2BesrR1AtOKQt2Y89u/ehN4UHz14OLUEL2846P3uJVuzd2BzDM1VYxxQSlN4mfPVG/L2xTzJ+jSVKfzr5T1+PL2NCj/jX8L754uk7x6Y0IIPG2dsz94jPXzlgLZR9qWdf11oRsLU0HRKmJxr3ei5TVBevUCNmiYN1kyIbAx1O1p/AeYHWbph1OQNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"MultiDex build times (minSdkLevel 21)\" title=\"MultiDex build times (minSdkLevel 21)\" src=\"https://developers.soundcloud.com/blog/static/ba8c16495806d8ea168036311e941d56/ef3f5/build_times_min21.png\" srcset=\"/blog/static/ba8c16495806d8ea168036311e941d56/9ec3c/build_times_min21.png 200w,\n/blog/static/ba8c16495806d8ea168036311e941d56/c7805/build_times_min21.png 400w,\n/blog/static/ba8c16495806d8ea168036311e941d56/ef3f5/build_times_min21.png 671w\" sizes=\"(max-width: 671px) 100vw, 671px\" loading=\"lazy\" /> </a> </span></p> \n<p>Here, time is measured in seconds, so lower is better. From the graphs, looking at the orange bars, you can see that incremental build times have improved drastically when targeting 21 in development, since library pre-dexing is functional again, both in the IDE and on the command line. Another interesting find here is to leverage what in IntelliJ/AndroidStudio is referred to as “Gradle-aware Make”, which consistently outperforms the default setup when running tests. In the configuration of your IntelliJ runners you can specify which jobs will be executed before launching a test or the app. The default is to use “Make”, which apparently will undermine some of the sophistication we get out of a Gradle based build in terms of incremental builds. By changing this step to <code class=\"language-text\">app:assemble[Flavor]DebugUnitTest</code> you can shave off unnecessary time from your test runs.</p> \n<h2>Moving to native</h2> \n<p>Just to look at the problem from multiple angles, another way to sidestep the DEX method problem is to simply not make code end up in the DEX file to begin with. Pushing code down to the native layer has the benefit that it can live in separate binary modules that can be side loaded at runtime, thus not adding to your overall method count during build time. The decision of whether this is a sensible step to make for you depends largely on your product, organization and team expertise and shouldn’t be made lightly, so we’re merely pointing this out for the sake of completeness.</p> \n<h2>Method count visibility</h2> \n<p>So far we focused on means to solve the DEX count issue. In order to not have it happen at the most inopportune time, it would be desirable to raise awareness around the current method count and notify developers when approaching the method limit. At SoundCloud we have started to monitor application size by plotting the DEX method count trend to a Jenkins graph using the <a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Plot+Plugin\">Plot plugin</a>:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/55086764b356e07e99a979d16552e9f4/b9fb9/method_plot.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 60.107095046854084%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABZElEQVQoz62TSXOCQBSE5///LysHD4ogcYEBxKVwYcAKGBbp9OASqZTJwRy+6jdvmkfN0IhwsUB0OCBVCsf1GsfN5k7C9WwwwHu/D6PXg/X2hmS3Q0yv2u+hWKvtFiqKoOjXPWGOx4gnE9SOg1RKHH2/Qx6GyEi+XCIjn/Q19NXSI/Ib10XJF4nZdIoZp8uyhA/8wLsim+ai9MnTCR7Vq6oWWddwuK+owpnPESUJKppBE2j4jZIPfZzPyKkdrntiwuPGPHtDU8GBf1GR+gl6T9i2jR0v98yBJRuv0hlYFMX/DNzrI/NSK97Dq4glo7Bllk78clmW3cnzvOWx94ybT6s4MNSWZWE0Gt0xTbNF18ZwiCExDKPVAYOu0eubt/VxvVqtLgMX/FuCIGi51T5DrQkY6pBMmQbd9zzv0mctGWiXgXYYdq0R/xgRxzEUE54wi5pOTSIabYbfpLrMbJKmHe8jetYXBA6M/frEqEMAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Plotting DEX method counts\" title=\"Plotting DEX method counts\" src=\"https://developers.soundcloud.com/blog/static/55086764b356e07e99a979d16552e9f4/8ff1e/method_plot.png\" srcset=\"/blog/static/55086764b356e07e99a979d16552e9f4/9ec3c/method_plot.png 200w,\n/blog/static/55086764b356e07e99a979d16552e9f4/c7805/method_plot.png 400w,\n/blog/static/55086764b356e07e99a979d16552e9f4/8ff1e/method_plot.png 800w,\n/blog/static/55086764b356e07e99a979d16552e9f4/6ff5e/method_plot.png 1200w,\n/blog/static/55086764b356e07e99a979d16552e9f4/b9fb9/method_plot.png 1494w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>We leverage a <a href=\"https://github.com/KeepSafe/dexcount-gradle-plugin\">Gradle plugin</a> to collect the method counts for different build types and store them for every build. Once we go past a certain threshold, we will mark the build as unstable and inform the developers via email. This will hopefully give us enough leeway to address the issue before maneuvering ourselves into a corner again.</p> \n<h2>Conclusion</h2> \n<p>Working in a fast moving environment is challenging, and being able to keep delivering product updates is essential to the business. To prevent worst case scenarios like the inability to build, developing both more sensitivity around the cost of third party libraries and getting deeper insights into application health can help. Make sure you understand the impact of leaning on external libraries: how much hidden complexity are you dragging into your app by using it? In case of hitting the limit, know your options: trimming down dependencies and MultiDex is what we ended up leaning on. Last but not least, visibility is king: raising awareness around application size and the looming method limit will allow you to take action ahead of time.</p> \n<p><em>If you’d like to join the Android team, check out our <a href=\"https://soundcloud.com/jobs/2015-05-22-android-engineer-berlin-germany\">current openings here</a></em></p>","descriptionType":"html","publishedDate":"Tue, 06 Oct 2015 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/19234e7e3b35bc10753e8bfd33a724b4/ef3f5/build_times_min14.png","linkMd5":"489725aa8909e81e9deac29a1b50c82b","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn29@2020_4/2020/08/25/00-49-38-718_c3e731b42e56b98f.webp","destWidth":671,"destHeight":266,"sourceBytes":2371,"destBytes":9778,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/19234e7e3b35bc10753e8bfd33a724b4/ef3f5/build_times_min14.png":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn29@2020_4/2020/08/25/00-49-38-718_c3e731b42e56b98f.webp","https://developers.soundcloud.com/blog/static/ba8c16495806d8ea168036311e941d56/ef3f5/build_times_min21.png":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn58@2020_3/2020/08/25/00-51-41-914_f0a0ae30e081d46c.webp","https://developers.soundcloud.com/blog/static/55086764b356e07e99a979d16552e9f4/8ff1e/method_plot.png":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn47@2020_1/2020/08/25/00-51-42-205_dfdf182db53ade18.webp"},"publishedOrCreatedDate":1598316569978},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Taking Our Bug Bounty Program Public","link":"https://developers.soundcloud.com/blog/taking-our-bug-bounty-program-public","description":"<p>We’re excited to announce the launch of our <a href=\"https://bugcrowd.com/soundcloud\">public bug bounty program</a> with Bugcrowd — the #1 crowdsourced security platform. This public program is open to Bugcrowd’s full crowd of top, trusted whitehat hackers, and we will award up to $1,500 per vulnerability identified on our website, API, and mobile apps.</p> \n<!-- more --> \n<p>Security is a top priority at SoundCloud, and we’re committed to keeping the community and its content safe. And, as a leading audio streaming platform, we’re prepared to handle an extremely unique set of security issues. These span from processing, transcoding, and formatting user-generated content without risking remote code executions, to detecting and blocking malware distribution and preventing illegitimate downloads and streaming access. Additionally, since the platform offers a highly social streaming experience with user-generated content and integration, we have to be mindful of potential XSS and CSRF attacks.</p> \n<p>As part of our commitment to our users, we’re focused on building state-of-the-art security monitoring and protection solutions for our platform. In order to balance that focus with the team’s operational work, we’re always looking for ways to improve our efficiency. And one of those ways is to have additional support for handling top-of-funnel security work for vulnerability reports. Examples of this work include triaging, reproducing, prioritizing, and resolving duplicates.</p> \n<p>This is where Bugcrowd comes in. Bugcrowd’s community-driven vulnerability testing is a key tool for us to receive external testing on our services and platform, along with explicit pentesting by security agencies and our various internal automated tests and peer reviews. With Bugcrowd, the quantity and quality of vulnerability reports is higher than ever before. Many of Bugcrowd’s security testers follow the same news and read the same forums as malicious users, so they help us react to new attack vectors much faster.</p> \n<p>Since using Bugcrowd, we’ve seen several benefits, including:</p> \n<ul> \n <li>A significantly lowered barrier to reporting security vulnerabilities and increased quality in security vulnerability reports</li> \n <li>Additional dedicated time to focus on building services specific to our needs</li> \n <li>Having a known platform with clear processes, taxonomy, and rules that attracts more professional researchers with more expertise</li> \n <li>Increased confidence that critical issues are continuously being probed, identified, and addressed</li> \n</ul> \n<p>We’re excited to take this next step in our crowdsourced security journey: making our bug bounty program public. To engage in our program, take a look at our program brief: <a href=\"https://bugcrowd.com/soundcloud\">https://bugcrowd.com/soundcloud</a>.</p>","descriptionType":"html","publishedDate":"Thu, 18 Apr 2019 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"521f8ad22884b9fdc98a33aced03ccbb","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569972},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Linked partitioning to replace offset-based pagination","link":"https://developers.soundcloud.com/blog/offset-pagination-deprecated","description":"<p>The SoundCloud API will be dropping support for offset-based pagination on March 2, 2015, in favor of linked partitioning.</p> \n<p>To page through a JSON response, pass the <code>linked_partitioning=1</code> parameter along with your request and it will return a collection, along with a <code>next_href</code> property if there are additional results. To fetch the next page of results, simply follow that URI. If the response does not contain a <code>next_href</code> property, you have reached the end of the results.</p> \n<p>You can read more about linked partitioning in the <a href=\"https://developers.soundcloud.com/docs/api/guide#pagination\">Pagination section of our HTTP API Guide</a>, including code examples in JavaScript, PHP, Python, and Ruby.</p> \n<p>The <code>limit</code> parameter continues to be supported with linked partitioning. The default <code>limit</code> is 50 with a maximum value of 200.</p> \n<p>Please update your code to replace the <code>offset</code> parameter with <code>linked_partitioning</code>. If you have any questions about this update, <a href=\"mailto:api@soundcloud.com\">please notify us via email</a>.</p>","descriptionType":"html","publishedDate":"Mon, 02 Feb 2015 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"c556c4ba644479f7ea401238d3b33c78","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569979},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Coding for GOOD - SoundCloud API","link":"https://developers.soundcloud.com/blog/coding-for-good","description":"<p>The web has come a long way. We have APIs that allow developers to create amazing applications quickly, and browser technologies have advanced to the point where JavaScript / HTML and CSS are necessary tools for creating apps. Despite this, there’s still a skills gap and companies are having an increasingly hard time hiring for technical positions.</p> \n<p>This is the main reason the folks at <a href=\"http://www.good.is\">GOOD</a> teamed up with the <a href=\"http://www.apollogrp.edu/\">Apollo Group</a> to launch <a href=\"http://cfg.good.is/\">Coding for GOOD</a>. A series of coding lessons and final project. Participants with the top three submissions will be flown to Los Angeles to participate in a hackathon. The best of the three hacks may be offered a job at GOOD.</p> \n<p>We were excited when GOOD approached us about contributing a lesson on the SoundCloud API, so I sat down with them in their New York office and did a quick walkthrough on using the <a href=\"https://developers.soundcloud.com/docs/api/sdks#javascript\">JavaScript SDK</a> to create a simple SoundCloud app. Check it out, and if you know of anyone new to using web APIs, have them take a look too.</p> \n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\"> \n <p> <iframe src=\"http://www.youtube.com/embed/8TuqjGxosrc\" frameborder=\"0\" allowfullscreen=\"\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </p> \n</div>","descriptionType":"html","publishedDate":"Fri, 02 Nov 2012 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"7775b75d5be2f935f337046b58fd0588","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Story Hack Boston Recap","link":"https://developers.soundcloud.com/blog/story-hack-recap","description":"<p>On Saturday, we hosted <a href=\"http://storyhack.splashthat.com\">Story Hack Boston</a> along with <a href=\"http://p2pu.org\">P2PU</a> and <a href=\"http://www.mashery.org\">Mashery</a> at the <a href=\"http://www.media.mit.edu\">MIT Media Lab</a>. About 50 people from content and technical backgrounds joined us to create new story telling experiences. The crowd was pretty evenly split, which made for a lot of awesome collaboration.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 450px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/2f758e7aa3dba16714272b363425b8f9/df2c7/storyhack.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDAQX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgD/2gAMAwEAAhADEAAAAd9vH0GxIiu0mJAv/8QAGhAAAwEBAQEAAAAAAAAAAAAAAAERAgMSE//aAAgBAQABBQLldjQ7c9dZPXWfRGCjSv8A/8QAFhEAAwAAAAAAAAAAAAAAAAAAABAh/9oACAEDAQE/ASP/xAAXEQADAQAAAAAAAAAAAAAAAAAAAREQ/9oACAECAQE/AYR7/8QAHBAAAQMFAAAAAAAAAAAAAAAAAAERMQISICFB/9oACAEBAAY/ApJJG6XK7G6lw//EABoQAAIDAQEAAAAAAAAAAAAAAAABESFRQXH/2gAIAQEAAT8hV0NFQ3JgE/J0opM0E3q8H8HJWcw//9oADAMBAAIAAwAAABDUKH7/xAAWEQEBAQAAAAAAAAAAAAAAAAAQASH/2gAIAQMBAT8QwU//xAAWEQEBAQAAAAAAAAAAAAAAAAABEDH/2gAIAQIBAT8QYHZ//8QAHBABAQEBAAIDAAAAAAAAAAAAAREAITGBQVFh/9oACAEBAAE/EKFXVnPvFJD0YlA3oxAdYZObwtkRxYeefuPXvPidGMo+ZmnCYSmf/9k='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"StoryHackers\" title=\"StoryHackers\" src=\"https://developers.soundcloud.com/blog/static/2f758e7aa3dba16714272b363425b8f9/df2c7/storyhack.jpg\" srcset=\"/blog/static/2f758e7aa3dba16714272b363425b8f9/f544b/storyhack.jpg 200w,\n/blog/static/2f758e7aa3dba16714272b363425b8f9/41689/storyhack.jpg 400w,\n/blog/static/2f758e7aa3dba16714272b363425b8f9/df2c7/storyhack.jpg 450w\" sizes=\"(max-width: 450px) 100vw, 450px\" loading=\"lazy\" /> </a> </span></p> \n<!-- more --> \n<p>This event was the first of it’s kind for us, and therefore a bit of an experiment. Hack days that bring together people from a variety of disciplines around a specific topic can be really interesting and present their own set of challenges. Judging from the tone of the day and the outcome, I think it turned out really well.</p> \n<p>There were 10 hacks demo’d in total. A couple of my favorites:</p> \n<ul> \n <li>SoundStep - An iOS application that uses geolocation to tell you about stories that have been recorded in your hood! Amazing to see a working iOS app built and demo’d in a single day.</li> \n <li>Story Prompter - A web application that pulls headlines from <a href=\"http://www.usatoday.com/\">USA Today</a> using Mashery’s API and asks you to record a story about the headline.</li> \n</ul> \n<p>We had some really great content hacks as well. See the full list on <a href=\"https://www.hackerleague.org/hackathons/story-hack-boston/hacks\">Hacker League</a>.</p> \n<p>Some reports on the day from happy hackers:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/e410f309650f3a2fbf30fb6f1a5fc543/c7805/shbtweet1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 35.75000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABQUlEQVQoz31RSU7DMBTNPTgCB+Eq7Niw4wBwDS7AsEcs2LFASAVKZidxnKFtbJK4marmYUcCFVF40pP+t/9/fzJmz084Pz3G/c0lOOeQUkJjHMd/qdH2A16zEp5PkCQMfd/DuL2+wtHhAS7OTmA5DojvY72W2G63e4V30XQ97IzDVzlBEKDrOhhJkuDx4Q5vs9kUNAyD+uh/iO1C+5vNBn/BaNsWQgjkeYo4prBtE4R4yo5gvs/BWKx8Atd14XkeKKUqNodpmrAsa/IZY9/Fja4b4HgpPJKrXeSwnRQv8xiOmyEIl0okQBSFCMNwEtCj6QJxHEM3o6l39zWJ0bQD0rwCFxIhFYoci2U9vbG0wmolUJbVdDDNuq5RFAWapvk17tQh/2hAE46qlsgWNSKmEkWJZSFBaKHsCuum37uvfQf7BO00D7uT/XArAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Happy Hackers\" title=\"Happy Hackers\" src=\"https://developers.soundcloud.com/blog/static/e410f309650f3a2fbf30fb6f1a5fc543/c7805/shbtweet1.png\" srcset=\"/blog/static/e410f309650f3a2fbf30fb6f1a5fc543/9ec3c/shbtweet1.png 200w,\n/blog/static/e410f309650f3a2fbf30fb6f1a5fc543/c7805/shbtweet1.png 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" loading=\"lazy\" /> </a> </span> <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/fc5db5fe313e9740c6968941f213570a/c7805/shbtweet2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 33.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABHUlEQVQoz51ROU7EQBD0FwgRL96MAImAlGCfAOIFzti1wOysx9f4Xt92gGTZRfcILKQFAloqlbqnu/oY43qzwcPjE8ZxRNM0qOsaZVmiKArM8wy2ZVlW/gJ5yMd3yKxClibo+17nG5cXV7i9uUPoezBNc4VlWZim6UyIMX8K+tWAvVSwds+Ioki/Gdv7LV52e53wfZr/mBbsulavxx1UGCImDomzLNMoTicopdacJEng+z48z4NLEMcjAvKrqtKixoECthCQQaD5zXEgKUFRYZymCCjODVzXhaB3FuJ7dV2nuW1bDMOwnsdIKKnmDlIitW3kdLuaikryB5qKJ+QC/jBJMZ7wz5URx6C2gHQAcQDsV2IB0OTI818LfwLbB4MgDiJ3pSoUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"More Happy\" title=\"More Happy\" src=\"https://developers.soundcloud.com/blog/static/fc5db5fe313e9740c6968941f213570a/c7805/shbtweet2.png\" srcset=\"/blog/static/fc5db5fe313e9740c6968941f213570a/9ec3c/shbtweet2.png 200w,\n/blog/static/fc5db5fe313e9740c6968941f213570a/c7805/shbtweet2.png 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" loading=\"lazy\" /> </a> </span> <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 400px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/992fd35bf993a2574229d3d02c0fdc0d/c7805/shbtweet3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABiUlEQVQoz32SW27TUBCGvSv2glgEm+CJF1aA2AESQhXllTygINFEuHF8v8fX2rGJb22Sj+MDFVWQGGk0M0fz//OP5ihe5PPh6j3rzTe6vqfveqqqoq5ruq7jfD4z2xyf5rPdPxxJ20H2t23L8XhEufpyzfMXz3j15iXrWxX1h8pyuWSxWLBarWTTI9mjn/4QNv3IVy9ndfMdTdMYxxFFtyzevnvNp88fmdvGafoNOp0k2f9tRpz+VgKnTMPAoT1QFQVpHJHEIUkUEgY+URTJdTzPI0kTGcuyZLfbEYahHHppStMP6HHGNsxQg5QbJ8ZI7jDDHbZQPwM938eybRzHwRZxs9nI9yRJ2O/3ZFlGLgT14gbKYbrHyvc4dx1G3mCXPzGLlq0b4FimAAZSbSBIZ4VzbRiGzJ8qnl0SNmKC7zoCbGBuNQH08IOArW6gWw6W63Grm6R5QZSkuKKO4xhLqC+Eqn9WniU7rothmmhilbobMJsHHOFaNaGWA+tyZCOiWU/0F3e6/AG/AO3/VV3RWrZAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Even More Happy\" title=\"Even More Happy\" src=\"https://developers.soundcloud.com/blog/static/992fd35bf993a2574229d3d02c0fdc0d/c7805/shbtweet3.png\" srcset=\"/blog/static/992fd35bf993a2574229d3d02c0fdc0d/9ec3c/shbtweet3.png 200w,\n/blog/static/992fd35bf993a2574229d3d02c0fdc0d/c7805/shbtweet3.png 400w\" sizes=\"(max-width: 400px) 100vw, 400px\" loading=\"lazy\" /> </a> </span></p> \n<p>A huge thanks to our sponsors, <a href=\"http://p2pu.org\">P2PU</a> and <a href=\"http://mashery.com\">Mashery</a> for making this event possible.</p> \n<p>P2PU did a <a href=\"http://info.p2pu.org/2012/10/01/the-hackathon-revamped-recs-for-mixing-hackers-storytellers/\">great write-up</a> about lessons learned during Story Hack Day. We also got some nice coverage in <a href=\"http://bostinno.com\">BostInno</a> <a href=\"http://bostinno.com/2012/09/28/story-hack-boston-mit-media-lab/\">before</a> and <a href=\"http://bostinno.com/2012/09/30/storytellers-technologists-merge-at-the-mit-media-lab-to-hack-a-new-kind-of-narrative/\">after</a> the event.</p>","descriptionType":"html","publishedDate":"Tue, 02 Oct 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/2f758e7aa3dba16714272b363425b8f9/df2c7/storyhack.jpg","linkMd5":"35e86c48165c154a7a06561e317253f9","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn87@2020_1/2020/08/25/00-49-37-715_4022cb46be3cee60.webp","destWidth":450,"destHeight":450,"sourceBytes":18230,"destBytes":22532,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/2f758e7aa3dba16714272b363425b8f9/df2c7/storyhack.jpg":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn87@2020_1/2020/08/25/00-49-37-715_4022cb46be3cee60.webp","https://developers.soundcloud.com/blog/static/e410f309650f3a2fbf30fb6f1a5fc543/c7805/shbtweet1.png":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn13@2020_3/2020/08/25/00-51-43-220_bc6604b627784da0.webp","https://developers.soundcloud.com/blog/static/fc5db5fe313e9740c6968941f213570a/c7805/shbtweet2.png":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn82@2020_2/2020/08/25/00-51-45-637_da255d4d448a6666.webp","https://developers.soundcloud.com/blog/static/992fd35bf993a2574229d3d02c0fdc0d/c7805/shbtweet3.png":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn25@2020_5/2020/08/25/00-51-41-839_2900537a1dcb8328.webp"},"publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud's Data Science Process","link":"https://developers.soundcloud.com/blog/soundclouds-data-science-process","description":"<p>Here at SoundCloud, we’ve been working on helping our Data Scientists be more effective, happy, and productive. We <a href=\"https://medium.com/@_eleftherios/https-medium-com-eleftherios-above-the-clouds-5-years-of-data-at-soundcloud-part-1-8803e2059fa\">revamped</a> our organizational structure, clearly defined the role of a Data Scientist and a Data Engineer, introduced working groups to solve common problems (like this), and positioned ourselves to do incredible work! Most recently, we started thinking about the work that a Data Scientist does, and how best to describe and share the process that we use to work on a business problem. Based on the experiences of our Data Scientists, we distilled a set of steps, tips and general guidance representing the best practices that we collectively know of and agree to as a community of practitioners.</p> \n<!-- more --> \n<p>The process represents an informal agreement amongst the team on how we accomplish data science objectives, and it serves as a basis with which to reflect on how to improve ourselves and our work. When we work on tasks, we use the process to bring higher levels of quality to our work and to improve our ability to communicate with our peers on progress, successes, and failures. The process itself is iterated on and adapted as we see systematic failures appearing in our work, or ways in which we can improve on our work.</p> \n<p>One thing worth highlighting is the iterative nature of our work here at SoundCloud. We work daily with Product Managers, Designers, and Engineers and we do so in a highly collaborative and iterative way. As such, we have designed our process to not only allow for iterative work, but to embrace it as a fundamental principle. We aim to deliver high-value work on a regular basis to our stakeholders and to adapt to a rapidly changing environment and available information. Think of it as a Bayesian process — we’re constantly updating our prior!</p> \n<p>When you see the steps below, you should keep in mind that these are logical steps of the work process and that the actual workflow contains loops and iterations — an outcome of one step might require revisiting previous steps. In most cases, we expect first iterations to be as small in scope as possible and that completing steps is more important than adding complexity to steps so that we are able to deliver incremental value earlier. As such, following the process in practice should end up looking like the following diagram, as opposed to a single pass through each step once and only once.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/bd6dc01f8d572a606882bc87996bfe14/d19c0/ds_process_example.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8klEQVQ4y4VSS2saURidZKzRGNPoTNUxTh1LY0x22fTxA4r7bFIodBNCSKBQaPoD+ge6LdKlm/Y3dDaS2PhCEUURfIGCD1y7teeGM2WQmFw43Psdz5zzffcqzWaz761W62+pVPrT6/VuptNpejKZ/Gw0Grf5fN7sdDq34H6A+wXuGjqz3+9fo06Nx+Pf1Wr1plwum91ut4j6m1QsFt/ncrmvpml+rlQqV8ApPjhpt9uXOJ9BeDkajY6hO89ms1dCB4MvhULhI/gPzWbzolarnQ0Gg08wfCfZVkR6fDmA3QcV0WhUNQxD8/v9CV3XI/F4XEkmk+7FYrGeyWTk+Xwup1IpRywWC0SwFEVJQB9GrabTaQeuTK7X6/JwOJTR8brwfAps2/YtwLmUuwbsENs2rN3XpBvwAiHAx7HuM3QBfupE+MYqwwCTfUwNst5gmJNdazTycQ+sMnRRfASEgU0aW1yIGsHpNs656l2eUficLx2iscXp1ER4tniVQS7bNE8k25hxjiHGUWi8zw+95HbJ+Qgvw1/ymsR0kofCN+xii6bi/Jaje8jFgFcM8xJ7wGtybutRooDBccKEnQsxwFjSaTbOuoa7NkVxSJGHyUJ0QLNNdvgCSJDzcJo9ckHe5f//lsZuVe4WF1zSWJzKx9L4m8DOPx8xpkdWOnIzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Iterative example\" title=\"Iterative example\" src=\"https://developers.soundcloud.com/blog/static/bd6dc01f8d572a606882bc87996bfe14/d19c0/ds_process_example.png\" srcset=\"/blog/static/bd6dc01f8d572a606882bc87996bfe14/9ec3c/ds_process_example.png 200w,\n/blog/static/bd6dc01f8d572a606882bc87996bfe14/c7805/ds_process_example.png 400w,\n/blog/static/bd6dc01f8d572a606882bc87996bfe14/d19c0/ds_process_example.png 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<p>Speaking of iterative work, this is our first iteration on capturing our data science process. We’re happy with and proud of what we have collected here, and we’re looking forward to figuring out the next steps. We want to see where the process does not fit and what changes we should make to it. There might be practices that we should add or some that we should remove. We’d also like to introduce a set of values and principles that we can use to guide our decision-making as Data Scientists.</p> \n<p>We look forward to learning, adapting and iterating as we gain more experience as a group. Below you will find a condensed version of our Data Science process and we’d love to know what you think about it. How do you work on a Data Science task or problem? Have we forgotten any stages or important attributes of each stage? Is this something you’d like to adopt for your work? Let us know what you think, and join us in the conversation!</p> \n<hr> \n <h1>Data Science Process</h1> \n <p><strong>Authors</strong>: <a href=\"mailto:demir@soundcloud.com\">Özgür Demir</a>, <a href=\"mailto:josh@soundcloud.com\">Josh Devins</a>, <a href=\"mailto:max.jakob@soundcloud.com\">Max Jakob</a>, <a href=\"mailto:janette.lehmann@soundcloud.com\">Janette Lehmann</a>, <a href=\"mailto:christoph@soundcloud.com\">Christoph Sawade</a>, <a href=\"mailto:warren.winter@soundcloud.com\">Warren Winter</a></p> \n <h2>Problem Definition</h2> \n <p>At the outset, we collaboratively make a <strong>definition of the objective</strong>, ensuring that all stakeholders are on the same page about what problem we’re trying to solve. To accompany this we define the <strong>metrics to measure success</strong>, to make sure that we agree on when we are successful. This is similar to the definition of done in agile engineering practices.</p> \n <ul> \n  <li>Understand the business need (in collaboration with stakeholders)</li> \n  <li>Challenge and validate assumptions about the business needs</li> \n  <li>Identify and prioritize subproblems, including metrics</li> \n  <li>Narrow the scope to minimal size, in order to achieve the business goal</li> \n </ul> \n <h2>Preparation</h2> \n <p>Before diving into a potential solution, we take some time to first prepare ourselves and the data. We build some <strong>intuition and knowledge of the problem domain</strong>, with the support of domain experts and research. We spend some time exploring our data and finding the <strong>relevant variables or attributes of the datasets</strong> available to us. We finally <strong>define our solution space</strong> by narrowing down from all possible solutions into the general area. An example would be understanding if a supervised, binary classification is a suitable approach, or if we need a multi-label or multi-class classifier.</p> \n <ul> \n  <li>Collect all available data, understand if it is sufficient and representative</li> \n  <li>Exploratory data analysis, including any manual labeling</li> \n  <li>Get peer feedback on the solution space and any conclusions drawn</li> \n </ul> \n <h2>Solution Development</h2> \n <p>Solution development is where we really dig into solving the problem at hand. We create a <strong>ranked list of candidate approaches</strong> for solving the problem, and after obtaining a simple baseline, we implement one or more <strong>prototype(s)</strong>. As we go, we make sure that we have <strong>documentation of the decision-making process</strong> (e.g. in a journal of decisions), which serves as a kind of story-line supporting our chosen approaches and solutions, problems or edge-cases that we encountered, quirks with the data or a library, and so forth.</p> \n <ul> \n  <li>Review prior art, literature, existing implementations, etc.</li> \n  <li>Establish a baseline, through simple means</li> \n  <li>Consider trade-offs such as between the goodness of fit, ease of use, complexity, maintenance, community, etc.</li> \n  <li>Prototype solution(s), evaluating the models (e.g. accuracy, precision/recall) and operational performance (e.g. scalability, runtime performance)</li> \n  <li>Challenge and validate assumptions that the solution solves the business problem</li> \n  <li>Get peer feedback on solutions, implementation ideas, and evaluation procedures</li> \n </ul> \n <h2>Production-Ready Deployment</h2> \n <p>Once a solution has been validated through offline evaluation (where possible), we prepare and deploy a <strong>production-grade implementation</strong>. Where possible, this will be deployed as an A/B test first, or launched in “dark mode” on a subset of traffic in order to observe the effects and provide further validation of the solution.</p> \n <ul> \n  <li>Understand how the solution fits into existing infrastructure</li> \n  <li>Ensure quality standards are met for runtime performance (e.g. with SLAs/SLOs), automation, testing, documentation, code reviews, etc.</li> \n  <li>Document how the approach has been validated in production</li> \n  <li>Monitor quality (semantic and operational)</li> \n  <li>Communicate results to stakeholders and broader audience (e.g. with a demo)</li> \n </ul> \n <h2>Validation and Maintenance</h2> \n <p>Once a solution is in production, we need to keep an eye on things and <strong>evaluate the metrics</strong> that we started with. We <strong>analyze A/B test results</strong> and regularly monitor the solution to ensure that over time, it keeps on meeting our expectations and solving our stated business problem.</p> \n <ul> \n  <li>Monitor performance</li> \n  <li>Correlate A/B test results with offline evaluation</li> \n  <li>Regular re-training of models (understand freshness requirements)</li> \n  <li>Cycle back to the problem statement (e.g. the problem is solved or partially solved, the problem statement needs reformulation)</li> \n </ul> \n</hr>","descriptionType":"html","publishedDate":"Wed, 04 Oct 2017 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/bd6dc01f8d572a606882bc87996bfe14/d19c0/ds_process_example.png","linkMd5":"cf758bfefb0e4362070df577ccd6ac19","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn93@2020_6/2020/08/25/00-49-37-665_8bc486d10e00ddec.webp","destWidth":500,"destHeight":352,"sourceBytes":4623,"destBytes":14904,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/bd6dc01f8d572a606882bc87996bfe14/d19c0/ds_process_example.png":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn93@2020_6/2020/08/25/00-49-37-665_8bc486d10e00ddec.webp"},"publishedOrCreatedDate":1598316569991},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"A Happy New Employee","link":"https://developers.soundcloud.com/blog/a-happy-new-employee","description":"<p>My first six months at SoundCloud as an iOS engineer on the Recommendations team have just finished. In that time, I’ve already contributed to around 15-20 repositories. I have made a couple of changes to our frontend and backend, ranging from a minor improvement in tooling to a newly baked feature. I feel I contribute to the team and grow every day. And I’m happy.</p> \n<p>Is this because I’m smart and hardworking? Well, this is just one part of it. 😉 But there’s something about the culture and practices here that enable me to succeed. So I decided to take some time to articulate exactly what these things are.</p> \n<h2>Engineering Practices That Make the Onboarding Experience Better</h2> \n<p>If you are new to a company, it likely means you have a myriad of random questions every day, perhaps every hour. But I’m an introvert — maybe you can relate. I don’t want to bother people, especially for things I don’t necessarily <em>need</em> to know. And I don’t want to ask questions without knowing how to ask them. Would I go to someone and say “I’m curious about this. I have no idea how it works or what it is for. Could you explain this to me?” No, never.</p> \n<p>Even so, I’ve found that something like this is possible at SoundCloud because people here are very supportive. However, what really helped me were the engineering practices in place that allowed me to explore the code base, documentation, and infrastructure on my own, following my curiosity and learning what I could until I needed someone’s help.</p> \n<p>So, here’s a collection of random things that I found useful for quickly onboarding. Some of them may be widely known practices in the context of SRE and microservices. Some of them may be so common that no one bothers to mention them. Nevertheless, I’d like to share them while I still maintain an outsider’s view.</p> \n<h3>Standardized Technology Stack</h3> \n<p>SoundCloud is a distributed system built on top of a gazillion microservices, as explained in <a href=\"https://developers.soundcloud.com/blog/category/microservices\">many previous posts</a>. These microservices enable product teams to work autonomously, but doesn’t it mean that individual services grow so differently that I need to start over whenever I look into a new project? Well that’s not what’s happening at SoundCloud. Instead, I see common patterns appear in many places, again and again.</p> \n<p>What do I mean by this? Well, we have shared frameworks, with which one can get many things for free. We have shared scripts that package and deploy applications. Most importantly, we have a dedicated team that continuously applies the latest practices to different services so that none of them falls behind too much and ends up confusing engineers with outdated information.</p> \n<p>This means that once I learn one thing, I can transfer it to other projects, and the learning curve is not just linear.</p> \n<h3>Example Applications as a Showcase of Best Practices</h3> \n<p>In addition to the above, we have internal example applications that capture our best practices. These allow us to understand the essentials of how individual apps are configured, deployed, and monitored without being distracted by subtleties.</p> \n<p>We can also quickly and easily start a new project using the example applications as templates. For the simplest application, we could start it in a day just by copying an example application and making the relevant tweaks to it.</p> \n<h3>Practical Hands-On Working</h3> \n<p>No matter how good the documentation is, we sometimes still need to mess up things in order to know what we don’t know. But how can we do that without causing havoc?</p> \n<p>Here at SoundCloud, we have a hands-on program that everyone can try. This program allows developers to provision a new machine, deploy the aforementioned example application to it, and set up monitoring for it in the same way our production services do.</p> \n<h3>First Responder</h3> \n<p>As a new hire, you may have questions, some of which seem too basic that you are almost ashamed of asking. In fact, you might not even know where to ask them. So you finally work up the courage to post the question in a chat room that looks relevant. You keep coming back to the thread, hoping your question made sense and someone eventually replies to you, but no one responds in the end. Everyone knows this feeling. Understandably, people are often too busy to spend time clarifying what you want to ask, or maybe they expect someone else who knows the subject better will answer it.</p> \n<p>At SoundCloud, many teams have a “first responder.” This is a person designated on a rotational basis to answer all the questions asked while they are in charge. Having someone like this greatly reduces the mental cost of asking questions because we know who we can bother, and there’s at least one person responsible for answering any questions.</p> \n<h3>Content Management Tool Open to Everyone</h3> \n<p>If your company operates with a fairly big number of users, you probably have an internal admin tool where you can manage users and their contents. What I experienced in the past was that it was open only to operational teams.</p> \n<p>At SoundCloud, everyone can access this tool, though its capabilities are limited by the permissions set for the individual user. When selecting an account, one can quickly tell which experimental features it is getting, what its contents are, when it was created, which program it subscribes to, and so on. This information often explains why a problem happens only to specific users, and it helps facilitate communication with other teams while debugging.</p> \n<h3>Infrastructure as Code and a Code Search Tool</h3> \n<p>It’s common for new people to face permission issues, and if you need to talk to different people whenever you have these problems in order to gain access to something and solve the problem, it will likely discourage you from exploring new things.</p> \n<p>Here at SoundCloud, in most cases, the way systems are provisioned can be found as code in a single place. Along with an internal code search tool, which enables fast cross-repository search, we can easily identify what we’re looking for by searching with an error message or our account name and fixing it ourselves by updating the relevant configuration.</p> \n<h3>Monitoring with User-Friendly Metadata</h3> \n<p>When you start in a new company, it’s a great opportunity to find issues that many people have gotten used to and ignore. However, if you can’t narrow them down, your report probably won’t help. Imagine that you are a mobile engineer and find a 500 error that happens intermittently. If you report it ambiguously like “I got a 500 error when I opened screen X and it never happens again,” it probably just adds another ticket that no one ever looks into.</p> \n<p>We have been making a rigorous effort to make debugging information useful and user friendly. For example, you can find an improvement we made to the tracing metadata in the <a href=\"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces\">Using Kubernetes Pod Metadata to Improve Zipkin Traces</a> blog post. In a scenario like this, I can check the trace and tell exactly where things go wrong and who is in charge of the issue. With this information, I can rewrite the occasional 500 error report with more specific information, which can be like “An upstream service X timeouts when requesting information of user Y.”</p> \n<h3>SAT (Self-Allocated Time)</h3> \n<p>Allowing people to work on side projects in working hours has been a popular concept since Google shared more about its 20-percent time policy, but it easily becomes a window dressing, and people don’t do it for many reasons. For example, they can’t find a suitable project or people to work with, or they can’t find time for it because project deadlines are always tight. And once the majority of people stop doing it, it’s hard for other people to justify continuing.</p> \n<p>We have this same concept here at SoundCloud, but we refer to it as SAT, or self-allocated time. And I’m happy to report that I see many people actually taking time on Fridays for this. I myself use this time to work on the things I know the least about. It also gives me a chance to collaborate with people whom I don’t usually work with. It often pays off because it adds a new tool to one’s toolbox, which, sooner or later, becomes useful in regular projects too.</p> \n<h3>Documentation</h3> \n<p>I put this at the end of the list because this looks fundamental, but it works as collective knowledge only if the subject can be accessed and tested by everyone, and if it’s supported by the things I mentioned above.</p> \n<p>What I like about how we update the documentation at SoundCloud is that it’s not authoritative. Although people ask other’s reviews for things they are not too sure about or when they think that other people should be aware of a change, the documentation can always be updated straight away. This removes the mental cost of updating documents and encourages more people to do so, which, in the end, also allows for minor errors which might be introduced by this non-authoritative model to be quickly fixed.</p> \n<h2>Conclusion</h2> \n<p>As engineers, we’re all familiar with the idea of being driven by our curiosity so profoundly that we forget to sleep or feel like we can work forever (which of course is untrue). And while smarter people often perform well, there are many high performers who do so because they’re the ones most excited about learning and putting that learning into practice.</p> \n<p>What I’d like to emphasize with this post is that you and your company can leverage those people by having good engineering practices in place and allowing people to explore things freely without barriers to learning.</p> \n<p>Or, more simply put, let good people do their jobs.</p>","descriptionType":"html","publishedDate":"Fri, 07 Feb 2020 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"84f82a354b33f3d729ec6543594ab4b6","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569969},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Technical Interview Reform, Part 2: The Recruiting Perspective and Results","link":"https://developers.soundcloud.com/blog/backend-code-challenge-recruiting-perspective-and-results","description":"<p><em>Please also see <a href=\"https://developers.soundcloud.com/blog/rethinking-the-backend-code-challenge\">Part 1: Rethinking the Backend Engineering Interview Take-Home Challenge</a></em></p> \n<p>Among the engineering groups at SoundCloud, backend engineering has always had the highest number of open roles — at times reaching 10 positions. To fulfill headcount plans in the current fast-paced market, recruitment needs to move quickly and put efficient processes in place.</p> \n<p>At SoundCloud, we have designed a three-step process to enable us to move candidates through the pipeline quickly: recruitment screening, challenge, and final onsite round. Each step has to provide a clear signal as to if the candidate is a good match for the role we’re trying to fill.</p> \n<p>However, in the past, we’d experienced challenges with high dropout and time-to-hire rates, as well as with the low ratio of challenges passed to offers made. Having analyzed the data, we identified the code challenge step as the bottleneck from the recruitment perspective.</p> \n<p>According to the candidate feedback, it took anywhere from 10 to 20 hours to complete the backend code challenge task. The turnaround between a candidate receiving the test and sending it back was three weeks on average, and it took around a week for engineers to review a submission.</p> \n<p>This is a big time investment to ask from candidates, and it is hard for them to commit to such a time-consuming task while having a full-time job. It is even less inclusive of people with families and kids or more junior candidates. As a result, the dropout rates during the challenge steps were high. All these factors contributed to the lengthy process and not always the best candidate experience.</p> \n<p>On a positive note, people who invested the time to complete the challenge were definitely motivated to join SoundCloud. :)</p> \n<h2>Process Changes</h2> \n<p>To initiate the change in the process, the recruitment team worked closely with the members of the leadership and engineering teams. We analyzed the data, proposed a possible solution, and issued an internal RFC (“request for comments”). Recruitment and engineering collaborated on developing an efficient process and constantly iterating based on the candidate feedback.</p> \n<p>To onboard challenge reviewers and interviewers, we introduced challenge review squads. A squad consists of more experienced and less experienced reviewers who pair and learn from each other. The squads change every 6–8 weeks so that everyone can participate and get onboarded to become reviewers of the new challenge.</p> \n<p>In addition, engineers are able to better manage their time with this process in place: they commit for 6–8 weeks, and when that time has passed, they can be free of the challenge reviews for the rest of the year if they want to.</p> \n<h2>Results</h2> \n<p>The new backend challenge was implemented in October 2019, and the candidate feedback has been great: The time commitment is now 5–6 hours. The new PR review tasks received a positive response as well: Candidates often find this part of the challenge interesting, and they consider it a refreshing change from the norms they encounter in technical interviewing.</p> \n<p>The turnaround time between the candidate receiving the challenge and sending back the solution went down to an average of seven days (a decrease of 60 percent). The new challenge also provides stronger signals: Conversion rates (challenge completed/offer made) increased from 35 percent to 50 percent.</p> \n<p>As an interesting side effect, the new backend code challenge positively contributed to the company’s focus on diversity in hiring: Since implementing it in October 2019, 30 percent of the offers we’ve made have been to non-male engineers.</p> \n<p>After seeing such significant positive results of the new backend challenge process, we are now working on making similar changes in other engineering coding interviews.</p> \n<h2>What about COVID-19?</h2> \n<p>An upcoming bonus post will outline changes we’ve had to make and challenges we’ve faced adjusting our technical interviewing process in the COVID-19 era.</p>","descriptionType":"html","publishedDate":"Fri, 26 Jun 2020 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"6ad1f5ad914b68319d30da65a82b1e18","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569967},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Post Mortem on API Outage May 5th 2011","link":"https://developers.soundcloud.com/blog/post-mortem-on-api-outage-may-5th-2011","description":"<p>On Thursday May 5th 2011 we had an API outage from ~9:00 UTC to ~14:00 UTC. This was caused by a deploy that included a migration with unexpected behavior and a bug in the application code. The migration ran on tables related to API applications and made these tables unavailable for the time of the migration. When the deploy was finished, a bug causing huge memory consumption brought our app servers down. We recovered by rolling back the faulty code and migrating the database down.</p> \n<p>After the API was running again, we discovered that there was an inconsistency in the OAuth 2 token data. This caused all tokens to be invalid. It took us until ~00:00 UTC to restore the correct state of the tokens. During this time it was possible to create new valid tokens, so even though some users where confused that they had to log-in new in apps, the API was fully functional. No data was lost during these events.</p> \n<p>We apologize for the outage. In the future we will test migrations more thoroughly and take an extra effort to make sure that they do not conflict with API operations.</p>","descriptionType":"html","publishedDate":"Wed, 11 May 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"503f86680c5c775a32a9406cf5812f0a","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"iOS Sharing Guide","link":"https://developers.soundcloud.com/blog/ios-sharing","description":"<p>So you are familiar with the <a href=\"https://github.com/soundcloud/cocoa-api-wrapper\">SoundCloud API Wrapper</a> and want to use it to share the sounds you upload? And you want to use the <a href=\"https://soundcloud.com/settings/connections\">existing connections on SoundCloud</a> or make new ones? Awesome. Here’s how to do it.</p> \n<!-- more --> \n<p>In a nutshell, SoundCloud takes care of making the connections and authenticating to various social networks for you. Your app can just use those connections. There is no need to exchange and store tokens once you are authorized to SoundCloud.</p> \n<p>If you don’t use connections at all when uploading a track, then the default connection settings on the website will be used automatically. The purpose of the connection API is to change the sharing options on a per-file basis and to establish new connections.</p> \n<p>Currently the following Services are supported:</p> \n<ul> \n <li>Twitter</li> \n <li>Facebook (Profiles and Pages)</li> \n <li>Foursquare</li> \n <li>Myspace</li> \n</ul> \n<p>Here’s what you need to do for sharing:</p> \n<ul> \n <li>Getting the users connections</li> \n <li>Provide UI for choosing connections (public sharing) or mail addresses (private sharing)</li> \n <li>Upload the file</li> \n <li>Establish new connections (optional)</li> \n</ul> \n<p>Depending on the privacy settings of your upload, the task is a little bit different: You want to share public tracks on social networks, and private uploads via mail.</p> \n<h3>Getting the users connections</h3> \n<p>For getting the user’s connections, use the connections resource at <a href=\"https://github.com/soundcloud/api/wiki/10.7-Resources%3A-connections\"><code class=\"language-text\">/me/connections.json</code></a>. With the API Wrapper, it looks like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span>api performMethod<span class=\"token punctuation\">:</span><span class=\"token string\">@\"GET\"</span>\n        onResource<span class=\"token punctuation\">:</span><span class=\"token string\">@\"me/connections.json\"</span>\n    withParameters<span class=\"token punctuation\">:</span>nil\n           context<span class=\"token punctuation\">:</span>nil\n          userInfo<span class=\"token punctuation\">:</span>nil<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>What this returns is a JSON array of connections which looks like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"json\">\n <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span><span class=\"token number\">12345</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"created_at\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"2010/12/02 11:45:07 +0000\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"display_name\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Joe Test\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"post_publish\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"post_favorite\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"service\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"twitter\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"uri\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"https://api.soundcloud.com/connections/12345\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> …<span class=\"token punctuation\">]</span></code></pre>\n</div> \n<p>Use a <a href=\"http://code.google.com/p/json-framework/\">JSON library</a> to transform this into Ojbective-C structures. We recommend to do this as soon as possible, preferrably directly after the start of the App, so the user does not have to wait for connections to load. You might even want to store this info, but make sure to update it it on use, because not only your app might change it!</p> \n<h3>Provide a UI for the User’s connections</h3> \n<p>In your upload screen for <em>public</em> files, we recommend using a table to display the connections. You can use <code class=\"language-text\">UISwitch</code> controls as AccessoryViews of your <code class=\"language-text\">UITableCell</code>s.</p> \n<p>When publishing a file, it is important to respect the default sharing settings that have been made on the SoundCloud website. The <code class=\"language-text\">post_publish</code> field represents this and should be used as the default setting for the switch.</p> \n<p>The <em>Foursquare</em> sharing needs special treatment, though: If the user has not chosen a foursquare venue, this connection should be deactivated. If your app doesn’t integrate Foursquare locations, this connection should be omitted.</p> \n<p>When the user is done entering metadata and setting the sharing options, you should end up with an array of connections that the user has chosen.</p> \n<p>In case of <em>private</em> sharing, provide a way to specify an array of email adresses. SoundCloud will take care of sending the mail, and shares internally if the user already has a SoundCloud account!</p> \n<h3>Upload the file</h3> \n<p>One all the metadata is in place, the file can be uploaded. For this, we use the API wrapper again:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span>api performMethod<span class=\"token punctuation\">:</span><span class=\"token string\">@\"POST\"</span> onResource<span class=\"token punctuation\">:</span><span class=\"token string\">@\"tracks\"</span> withParameters<span class=\"token punctuation\">:</span>parameters context<span class=\"token punctuation\">:</span>nil userInfo<span class=\"token punctuation\">:</span>nil<span class=\"token punctuation\">]</span></code></pre>\n</div> \n<p>You can get more info about this call and its parameters from the <a href=\"https://github.com/soundcloud/api/wiki/10.2-Resources%3A-tracks\">API documentation for tracks</a>. One parameter is the <em>sharing note</em> (the text that get’s displayed in a tweet, for example), so you should read it.</p> \n<p>The parameters dictionary can look something like this:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span>NSDictionary dictionaryWithObjectsAndKeys<span class=\"token punctuation\">:</span>\n    fileURL<span class=\"token punctuation\">,</span> track<span class=\"token punctuation\">[</span>assetdata<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//a file URL</span>\n    title<span class=\"token punctuation\">,</span> track<span class=\"token punctuation\">[</span>title<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span>private<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">@\"private\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">@\"public\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">@\"track[sharing]\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//a BOOL</span>\n    <span class=\"token string\">@\"recording\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">@\"track[type]\"</span><span class=\"token punctuation\">,</span>\n    sharingConnections<span class=\"token punctuation\">,</span> <span class=\"token string\">@\"track[post_to][][id]\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//array of id strings</span>\n    tags<span class=\"token punctuation\">,</span> track<span class=\"token punctuation\">[</span>tag_list<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//also an array of strings</span>\n    …\n    nil<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>If you don’t supply a <code class=\"language-text\">track[post_to][][id]</code> parameter, SoundCloud will use the default settings on the website. So to share to nobody, use this:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span>NSDictionary dictionaryWithObjectsAndKeys<span class=\"token punctuation\">:</span>\n    …\n    <span class=\"token string\">@\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">@\"track[post_to][]\"</span><span class=\"token punctuation\">,</span>\n    …\n    nil<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>But how to supply geo coordinates and how to set the Foursquare venue ID? For this we use machine tags that get into the array you send with <code class=\"language-text\">track[tag_list]</code>. The following tags are currently supported:</p> \n<ul> \n <li><code class=\"language-text\">geo:lat=12.34567</code></li> \n <li><code class=\"language-text\">geo:lon=56.67890</code></li> \n <li><code class=\"language-text\">foursquare:venue=1234567</code></li> \n</ul> \n<p>As with any upload you should put them somewhere in your app where the user can see them, cancel them, they should continue when the app is sent to the background, etc.</p> \n<p>When sharing <strong>private</strong>, you don’t want to supply sharing connections, share to mail instead:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span>NSDictionary dictionaryWithObjectsAndKeys<span class=\"token punctuation\">:</span>\n    …\n    arrayOfStringMailAddresses<span class=\"token punctuation\">,</span> <span class=\"token string\">@\"track[shared_to][emails][][address]\"</span><span class=\"token punctuation\">,</span>\n    …\n    nil<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<h3>Bonus: Making new connections</h3> \n<p>So what about users that have not yet connected their favorite services to SoundCloud? Can they do it from within your app? Yes, they can, and it’s quite easy.</p> \n<p>You just need to send a <code class=\"language-text\">POST</code> with the service type of the connection and you get back an URL:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\">\n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span>api performMethod<span class=\"token punctuation\">:</span><span class=\"token string\">@\"POST\"</span>\n        onResource<span class=\"token punctuation\">:</span><span class=\"token string\">@\"connections\"</span>\n    withParameters<span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">[</span>NSDictionary dictionaryWithObjectsAndKeys<span class=\"token punctuation\">:</span>\n        service<span class=\"token punctuation\">,</span> <span class=\"token string\">@\"service\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">@\"x-myapplicationsurlscheme://connection\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">@\"redirect_uri\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">//optional, forces services to use the mobile auth page if available</span>\n        <span class=\"token string\">@\"touch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">@\"display\"</span><span class=\"token punctuation\">,</span>\n        nil\n     <span class=\"token punctuation\">]</span>\n           context<span class=\"token punctuation\">:</span>nil\n          userInfo<span class=\"token punctuation\">:</span>nil<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre>\n</div> \n<p>The services that are currently supported are:</p> \n<ul> \n <li><code class=\"language-text\">twitter</code></li> \n <li><code class=\"language-text\">facebook_profile</code> (this will also connect Facebook pages!)</li> \n <li><code class=\"language-text\">foursquare</code></li> \n <li><code class=\"language-text\">myspace</code></li> \n</ul> \n<p>The URL you get back in the JSON should be opened in a WebView. Listen for your callback URL in <code class=\"language-text\">-webView:shouldStartLoadWithRequest:navigationType:</code>. If you get it, close the webView and reload the connections. Voilà, your new connections are there and ready to use!</p> \n<p>That’s it! And when you’re done, don’t forget to promote your app in the <a href=\"https://soundcloud.com/apps\">SoundCloud App Gallery</a>!</p>","descriptionType":"html","publishedDate":"Sat, 01 Jan 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"6067495c6c1351cd1dede072cdbe7fed","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Custom Players","link":"https://developers.soundcloud.com/blog/custom-players","description":"<p><em>UPDATE: Check out our guide on <a href=\"https://developers.soundcloud.com/blog/docs/api/guide#playing\">Playing Sounds</a> for the most up to date information.</em></p> \n<p>We think the default audio widget from SoundCloud already is one of the sexiest on the web. But maybe you need something a bit simpler or complex and want to tailor the player to your needs. This is where the idea of “custom players” comes into play.</p> \n<!-- more --> \n<p>Here’s a few examples of custom players in the wild:</p> \n<ul> \n <li><a href=\"http://stream.bandofhorses.com/\">Band of Horses</a></li> \n <li><a href=\"http://stratus.heroku.com/\">Stratus</a></li> \n <li><a href=\"http://whitelies.heroku.com/\">White Lies</a></li> \n <li><a href=\"http://thebeatles.com/core/love/album/\">The Beatles</a></li> \n <li><a href=\"http://simplemath.heroku.com/\">Manchester Orchestra</a></li> \n</ul> \n<p>We’ve provided a few javascript libraries to get you started:</p> \n<p><strong><em>Widget-JS-API</em></strong></p> \n<p>The official <a href=\"https://developers.soundcloud.com/blog/docs/html5-widget\">SoundCloud Widget Javascript API</a> allows you to interact with our standard widgets via JavaScript. You can load tracks and sets, control playback and trigger events when something changes in the player.</p> \n<p><strong><em>SoundCloud-Custom-Player</em></strong></p> \n<p><a href=\"https://developers.soundcloud.com/blog/docs/custom-player\">SoundCloud-Custom-Player</a> is a jQuery plugin that allows you to easily create customizable, HTML/CSS/JS based audio players. It even includes automagic support for the &lt;audio&gt; tag and therefore also works on iOS, Android and Palm.</p> \n<p><strong><em>SoundManager2</em></strong></p> \n<p>Another great way to create custom players is to use any javascript audio library like <a href=\"http://www.schillmania.com/projects/soundmanager2/\">SoundManager2</a>.</p> \n<p>Pumped? Yeh, us too. Let us know what you create, we’ll be waiting api@soundcloud.</p>","descriptionType":"html","publishedDate":"Wed, 06 Apr 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"d0c966c21a4957c008a5afee440bb448","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"How we do… Retrospectives","link":"https://developers.soundcloud.com/blog/how-we-do-retrospectives","description":"<p>SoundCloud started its agile journey with Scrum and eventually moved to an approach based on Kanban (more on that in one of the next blog posts). Regardless of the methodology we follow, though, we strongly believe that the most important tools an agile team can use to practice continuous improvement are retrospectives. You might ask why we consider the retrospective to be the most important one? We think it is key to constantly learn and to improve based on our experiences. The best way to achieve this is to look back at our work in regular intervals and to give every team member the opportunity to give input on the past work – and to make sure we have actually improved something. This is done by reviewing action items from the last retrospective as the first step.</p> \n<h2>What kind of retrospectives?</h2> \n<p>The most frequent retrospective meeting is done after each iteration – in our context this means every two weeks. Every three months we do a big retrospective meeting with all of the engineers in one room to find common patterns in our development department. One major result of these big retrospectives is our “hacker time” project – see <a href=\"https://backstage.soundcloud.com/2011/12/stop-hacker-time/\" title=\"here\">here</a> for more details. The length of the retrospective depends on the size of the team and the time between retrospectives. We usually schedule 30 minutes for the short one after each iteration and 90 minutes for big ones.</p> \n<h2>How is the retrospective done?</h2> \n<p>Pre-requisites:</p> \n<p>You need only a few things to do a good retrospective – you can even do one only with Google Docs – but it works best with the following things:</p> \n<ol> \n <li>Post-its in 3 different colors (optimal is green, red, yellow)</li> \n <li>Enough pens so everybody has one – rather use big pens than ball pens so the content is short and everybody in the room can read it</li> \n <li>A big wall to put the post-its on, a whiteboard will do</li> \n <li>And someone to facilitate the retrospective, in Scrum it should be the Scrum Master. Really experienced teams do not necessarily need a facilitator. The facilitator keeps track of the time and leads the grouping of items.</li> \n</ol> \n<h2>The procedure</h2> \n<ol> \n <li>You put three columns on the wall with the title: less – same – more. Ideally you label each columns with one of the three differently colored post-it’s (red= less, green=same, yellow=more).</li> \n</ol> \n<p>So, all items put under “less” are things which either should be done less or should be stopped completely. “Same” is obvious, and “more” are items which should be done more or should be started.</p> \n<p><em>Why?</em> This scheme avoids the bad/good categories often used and allows an open communication where putting a sticker somewhere does not mean something is “bad” – it allows a more nuanced conversation.</p> \n<ol start=\"2\"> \n <li>Collecting items: everybody gets around 5-10 minutes to write down their points. During that time no discussions are allowed, it is only about collecting items.</li> \n</ol> \n<p><em>Why?</em> Everybody can give their input, often some people tend to dominate a discussion and the other people are not heard as much. This approach enables everybody to give their input.</p> \n<p>People are free to put post-it’s on the wall (on the three columns) anytime. Latest after 10 minutes or when nobody is writing anymore the next phase starts.</p> \n<ol start=\"3\"> \n <li>Group items</li> \n</ol> \n<p>The facilitator starts grouping items into clusters to find common themes. Usually there always are topics which a lot of people mention. Every item is read out to the group and if everybody agrees put to a cluster.</p> \n<ol start=\"4\"> \n <li>Find good names for the clusters</li> \n</ol> \n<p>This is the final test if the grouping made sense – if you cannot agree on a name the cluster has too many different items and has to be split.</p> \n<p><a href=\"https://backstage.soundcloud.com/?attachment_id=540\"><img src=\"https://backstage.soundcloud.com/wp-content/uploads/2012/03/retrospective_big-505x377.jpg\" title=\"retrospective_big\" /></a></p> \n<ol start=\"5\"> \n <li>Vote</li> \n</ol> \n<p>To identify the most pressing issues (number of post-its in a cluster is also a pretty meaningful indicator) everybody gets three votes and can give one vote to three different clusters. The top three items should be addressed during the next iteration.</p> \n<ol start=\"6\"> \n <li>Discuss</li> \n</ol> \n<p>If there is time left start discussing the clusters starting with the one which got the most votes. Try to get action items out of it.</p> \n<ol start=\"7\"> \n <li>Action-items</li> \n</ol> \n<p>A retrospective tends to be useless if it is “just talk” and no actions follow. So the key ending of a retrospective is to to collect action-items to work on at least the top voted clusters. The next retrospective starts then with a review of the action-items from the last retrospective.</p> \n<p>We have been doing it that way for the last 8 months with pretty good results. There are around 8 engineering teams at SoundCloud and 45 engineers overall. The key challenge is here to continue doing retrospectives and to follow up on the action items.</p>","descriptionType":"html","publishedDate":"Sun, 04 Mar 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://backstage.soundcloud.com/wp-content/uploads/2012/03/retrospective_big-505x377.jpg","linkMd5":"02a36ba61b526be9e01abde68cfc481d","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"author":"","articleImgCdnMap":{"https://backstage.soundcloud.com/wp-content/uploads/2012/03/retrospective_big-505x377.jpg":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"SoundCloud Is Playing the Oboe","link":"https://developers.soundcloud.com/blog/soundcloud-is-playing-the-oboe","description":"<p>Media and playback are at the core of SoundCloud’s experience. For that reason, we have established and grown an engineering team that is specialized in providing the best possible streaming experience to our users across multiple platforms.</p> \n<p>To do this, we combine the industry’s best-fitting solutions with our own custom technologies, libraries, and tools. In this article, let’s dive into how we improved latency in our Android application by leveraging a new engine for our player’s audio sink.</p> \n<!-- more --> \n<p><a href=\"https://developers.soundcloud.com/blog/playback-on-web-at-soundcloud\">Maestro powers our web applications</a>, but for the ones that are compiled with native code, we created Flipper, a lightweight cross-platform audio streaming engine written in C++. Flipper drives tens of millions of plays per day in our Android and iOS mobile apps, and it is designed with SoundCloud’s use cases in mind, which provides the flexibility we need for innovation and fast delivery.</p> \n<h2>Flipper</h2> \n<p>As is the case with many other media players, Flipper is designed as a pipeline of components, each of which is responsible for one step of the streaming technology. Having multiple discrete steps — or <em>stages</em> — allows for parallel processing of a continuously flowing stream of data. Think of it like a car manufacturing plant: While one group of workers is focused on constructing the engine of the car, someone else is assembling the tires.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/bd853f55bc860bb07babfcec150f122d/4d248/player_arch.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 26.9183922046285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABN0lEQVQY02O4detW48OHD588evTInwEJPHjwgPno0aNMyGIXL15kvXbtGiMDJkCIPX78OOLp06dbgAodT506pfb////QDx8+OMDkgWynb9++BQPVKSEZwPT27Vs7oNrg06dPG+7cucsdSGt9/PhRFMUaoEvnfv78+f+rV69uAF2XDbSg4uXLl3eBGkFic86cOdOzadOmSKBSDqD4LZD4ixcvZp49e3bK/fv3fz158uQFw/r165lWr17NCzIQKDgNaMv/169fXzhx4kQk0IvpQA1Xf/z48R+oeMrJkyfLgGp9gErZgWou/v379z/QB727du2yBvpwHTD46hju3bvnBXTZya1bt4oBbZIFWmoHVGSA5GXD79+/2z579kwCOczevHmj++fPHyegpbzA4Mj48uXLf6CrdwEAXkbZ4AF9+WkAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Generic media streaming pipeline\" title=\"Generic media streaming pipeline\" src=\"https://developers.soundcloud.com/blog/static/bd853f55bc860bb07babfcec150f122d/8ff1e/player_arch.png\" srcset=\"/blog/static/bd853f55bc860bb07babfcec150f122d/9ec3c/player_arch.png 200w,\n/blog/static/bd853f55bc860bb07babfcec150f122d/c7805/player_arch.png 400w,\n/blog/static/bd853f55bc860bb07babfcec150f122d/8ff1e/player_arch.png 800w,\n/blog/static/bd853f55bc860bb07babfcec150f122d/4d248/player_arch.png 821w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>For the scope of this article, let’s focus on one single component: the <strong>sink</strong>. This is the last stage in the pipeline, and the sink’s responsibility is to offload the decoded audio samples to the underlying hardware abstraction layer (HAL) of the operating system in which the application is running. It is critical for this to <a href=\"https://medium.com/@juliozynger/your-app-and-low-latency-audio-output-d21d7b672305\">happen in a timely manner</a>, so as to avoid unwanted audio artifacts (crackling or popping).</p> \n<p>Having the sink as a component abstraction is very useful when building Flipper, since it enables portability of the code. As a result, we can unify the exposed API to the rest of the stages in the pipeline, regardless of the specific platform it runs on. On iOS, these specificities are in <a href=\"https://developer.apple.com/library/archive/documentation/MusicAudio/Conceptual/CoreAudioOverview/WhatisCoreAudio/WhatisCoreAudio.html\">Core Audio’s APIs</a>, while on Android, the samples are processed with other bindings.</p> \n<h2>Android Audio APIs</h2> \n<p>The Android OS has evolved over the years, and along with it, so has its audio functionality. As a result, there are now a few sets of audio APIs. In Android Gingerbread, the Open Sound Library for Embedded Systems (<a href=\"https://developer.android.com/ndk/guides/audio/opensl/opensl-for-android\">OpenSL ES</a>), a C library built with portability (and mobile) in mind, graduated to be the recommended interface to the audio hardware. Both the application-level player (MediaPlayer) and third-party developers have access to OpenSL ES APIs via the <a href=\"https://developer.android.com/ndk\">Android NDK</a>.</p> \n<p>Even though OpenSL was able to support Android’s use cases for a considerable amount of time, it started showing signs of being outdated as applications evolved to require higher performance. Beginning with Android Oreo, however, Google integrated a new C library with a simpler API surface to target these low-latency scenarios: <a href=\"https://developer.android.com/ndk/guides/audio/aaudio/aaudio\">AAudio</a>.</p> \n<p>Since then, Google has been advising developers to use AAudio for building audio applications, but the API availability becomes an issue when targeting a large audience of users, as fragmentation becomes more evident. Developers still have to maintain code for OpenSL ES bindings if they want to provide audio capabilities on older versions of the operating system. On top of that, manufacturers also apply changes to the behavior of the APIs, deviating from the official documentation Google provides and forcing all sorts of workarounds and device-specific hacks.</p> \n<p>Enter <a href=\"https://github.com/google/oboe\">Oboe</a>, a C++ wrapper built on top of OpenSL ES and AAudio, that exposes an “AAudio-like” interface, includes fixes (or workarounds) for known manufacturer-specific issues, and automatically picks the most suitable audio API based on a device’s capabilities. If you’re already familiar with Android development, this is the same idea behind the <a href=\"https://developer.android.com/topic/libraries/support-library\">Support Libraries</a>, in that it provides a compatibility layer between the application and platform code.</p> \n<h2>SoundCloud and Oboe</h2> \n<p>The cost of maintaining two implementations for our Flipper sink on Android and the risk of replacing a critical part of our already battle-tested core library for playback were among the reasons we postponed the integration of our player with AAudio, but the release, and later, <a href=\"https://android-developers.googleblog.com/2018/10/introducing-oboe-c-library-for-low.html\">stable graduation</a>, of Oboe motivated the work on a prototype integration.</p> \n<p>Following our <a href=\"https://developers.soundcloud.com/blog/quality-mobile-trains\">usual rollout process</a>, we started by deploying Oboe to a controlled subgroup of our userbase by using a remote feature toggle, and as we got more confident with the performance in production, we extended its availability.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 668px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/c6d1a929204d97718690da3a644d8452/cc651/oboe_branching.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 39.07185628742515%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAACIElEQVQoz52P3WtSARiHj5oIW2yUJESji1G2Pqig/oJ1UzGshjFowrxwTT2sZhflZdC6CulSChr0YUsztePONuZQp/Pz+HFOetR0HufKoJIyN+bnetNiF1Hd9Lt93+f5vS+C/CU220Kf0754Q+QC3trUZUnxxSiUDFfhwzPJlfY8b77JuXN7EtE+0rL/gCGo6GhgcnMDQ5caVhRvaDp2ewlqIBwKJmYysC/3cPD6V4MS1o0obJhkyjbzsR9hbfOZCr0nvR4/kSxRxyKffD2IXt3fUzKMVZMPpFB+qWgmtBdO/lboRI8ALr/XtI5pYF52WAfw8yqapifjsfiTBWLOEs6FwJvywCxpAqTwdIhftSg2v+jlULMoa++M6OkwzZwrrDFi1Wyzs6wfPt96N7ppVlAbuotn3FnCFMr5ngd8ftEbKoYSjP+aL+OxBRm/xUZbHyPgGOFuzYyKwT4h+W6WiIoxXOgPBEmP25XHqeLRb7ohVdM6AYCroGocHp8jl3LumCOP/G8Alx2vv5ZrapjiPry6dIgsJtH458hINBJVUyS1GM4Rdz0pd9D31uNyZuZxBMyDnQ3dgPjUAb6gd2+3gLcD2dXydLVl0v3/Lsoy2bOpREoaXiWmg9kALNOurZawgjBZTECR01M8HlfY2utjs1lCLpe78xfWjTQxJauB3WI3MTWnbpayUuUCm0xHOdti73tH12o9fXClkuhdXrHzfwCY/CTVrriWWAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Flipper sink branching\" title=\"Flipper sink branching\" src=\"https://developers.soundcloud.com/blog/static/c6d1a929204d97718690da3a644d8452/cc651/oboe_branching.png\" srcset=\"/blog/static/c6d1a929204d97718690da3a644d8452/9ec3c/oboe_branching.png 200w,\n/blog/static/c6d1a929204d97718690da3a644d8452/c7805/oboe_branching.png 400w,\n/blog/static/c6d1a929204d97718690da3a644d8452/cc651/oboe_branching.png 668w\" sizes=\"(max-width: 668px) 100vw, 668px\" loading=\"lazy\" /> </a> </span></p> \n<p>It’s been a few months since we began measuring Oboe’s integration with Flipper in production, and while it is still a rather new tool, it has proven to be beneficial to us in many ways.</p> \n<p>For one, the global community united around improving Oboe introduces new concepts and capabilities faster than what we could do internally. It also provides us with access to the experts behind the platform APIs, along with the possibility to contribute back to the upstream repository, due to its open-source nature. Finally, the combination of Oboe and AAudio gives us richer insights into the system’s HAL and its performance — for example, the number of <a href=\"https://en.wikipedia.org/wiki/Buffer_underrun\">buffer underruns</a>, which allows for additional optimizations.</p> \n<p>Most importantly, our users also gained: We have been able to provide a better experience for playback, latency-wise, as our telemetry systems show that AAudio contributed to an approximate 10 percent decrease in overall latency in comparison to the same sampling size with OpenSL ES.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/63d2a157e4f4f9948d127e5eaa684460/79d86/latency_improvement.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 68.00976800976801%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAClElEQVQ4y11TW2sTQRjdnyBNNpts2yR7mdnrbGYvybb2Yh8qlj6IFquCVpC2glpsQbFURMSHKvgmCv7b4zezSVr7cDhnznxz8mVmP8PsdNGxelA8023TwtLyAJ7P0R84GDqehuP62uvZS/Pam2eNmXkdKnAwdDGe1EhFhqKsiEcQmUQ1rvWeqpmFXT9rqA0Fq9sj2DCtLqyerQtvLbTQMjtYaJkarXajm3r7ql7raWAYxvBZANOktk3qrmVp1mhTsWWj0+np/Q55at1ud+c1V7pL2oIx+6WBPwQTDG7sIpAcYRFoVl4yjpCuxIjIi8qQPB9BHiCtY8gNoTkkX9UYrssQRBFG6xnKLYnRWoZ8U0ISJ3UKuZoirtQBQpVQeIKIOF8T2vOEChKo79C52ykMe3GZ7qmLiDrr9YdwvAES0hu1j2LkYFx4cH0HZe6iIr2/E2B94qGuPGxvMDza4Sili3ub9E8SBwYPEsgswMVxiuMnCc6PUnw/G+HPJ4kfZxl+vpf48lrg8l2GX+cSl6cjfDvJ8PVtpvnvZ4nfF41/+oI6XKBLDfwlfDwS+HAo8HI/whEFK7x5luDkIMGrpzGeP4ywtxtia4NjdzvA0/sR7m5Rt6sMD3ZCHD6OcbAX0R16jF6Zo6oYgSPPfeQFR0EoS0bfIHkFI5/RmmMymfq0P6b6qmz8gmok1dArL6Lf72NlwrBScwLD6pSbNUc93dOsdYP/1lM2HMeH63mQI+pMNhertFQ6HqDIVRchREoPQ59NWQZzrX1x5WfCpUBPBTJ65RTqI7dtG3EsEEUJlunVOY9ojn2akM58ptXEDIbNbDfa1VpNkOFzjjgROpDxAL431OsgjJCkggJcPW6zGZ/NsGIVdtP/B9GRoZsSecQVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Latency improvement graph\" title=\"Latency improvement graph\" src=\"https://developers.soundcloud.com/blog/static/63d2a157e4f4f9948d127e5eaa684460/8ff1e/latency_improvement.png\" srcset=\"/blog/static/63d2a157e4f4f9948d127e5eaa684460/9ec3c/latency_improvement.png 200w,\n/blog/static/63d2a157e4f4f9948d127e5eaa684460/c7805/latency_improvement.png 400w,\n/blog/static/63d2a157e4f4f9948d127e5eaa684460/8ff1e/latency_improvement.png 800w,\n/blog/static/63d2a157e4f4f9948d127e5eaa684460/79d86/latency_improvement.png 819w\" sizes=\"(max-width: 800px) 100vw, 800px\" loading=\"lazy\" /> </a> </span></p> \n<p>All in all, we are happy with the results of what started as a prototype implementation, and we’re aiming to make the new audio sink available to our entire userbase in the near future, while still keeping an eye open for further improvements to latency and the playback experience in general.</p> \n<p>If you’re interested in media streaming, Android, large-scale challenges, and what we do at SoundCloud, <a href=\"https://jobs.soundcloud.com/\">make sure to check out our jobs page</a>!</p>","descriptionType":"html","publishedDate":"Fri, 21 Jun 2019 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/bd853f55bc860bb07babfcec150f122d/8ff1e/player_arch.png","linkMd5":"9f6d17fdcbfb0db6422e7549b392ad30","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn98@2020_3/2020/08/25/00-49-38-834_6878bc3d9a83b2d8.webp","destWidth":800,"destHeight":215,"sourceBytes":13061,"destBytes":26616,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/bd853f55bc860bb07babfcec150f122d/8ff1e/player_arch.png":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn98@2020_3/2020/08/25/00-49-38-834_6878bc3d9a83b2d8.webp","https://developers.soundcloud.com/blog/static/c6d1a929204d97718690da3a644d8452/cc651/oboe_branching.png":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn51@2020_1/2020/08/25/00-51-44-322_f740f423f75fbec3.webp","https://developers.soundcloud.com/blog/static/63d2a157e4f4f9948d127e5eaa684460/8ff1e/latency_improvement.png":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn52@2020_3/2020/08/25/00-51-40-886_5f1c96f0235990f1.webp"},"publishedOrCreatedDate":1598316569972},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"React Native at SoundCloud","link":"https://developers.soundcloud.com/blog/react-native-at-soundcloud","description":"<p>About a year ago we faced an interesting question at SoundCloud: can we build SoundCloud Pulse — our app for creators — with React Native? Is a five-month-old technology mature enough to become part of SoundCloud’s tech stack?</p> \n<!-- more --> \n<p>A couple of months prior to this question, we started to design our second set of native apps for Android and iOS. We focused on iOS first because that is where the majority of the creators were. Finding iOS engineers proved harder than we thought, which is a situation likely familiar to you. For Android, we partnered with <a href=\"https://www.novoda.com/\">Novoda</a>. We did not want to have many months between the iOS and Android releases. Meanwhile and independently, the design team was running user-testing sessions with React Native-based prototypes and we also had capacity from very eager web engineers.</p> \n<h2>Warming up</h2> \n<p>We had two main goals at the start. Including all teams whose input was valuable for this project and convincing ourselves of React Native. Input from our iOS team with many years of mobile app development experience was very valuable and reassuring. At the same time we were able to give them context as to why we were investigating React Native. Openly talking about the project in the company and including people in the decision making process helped us a lot in learning what React Native could and couldn’t do:</p> \n<ul> \n <li>Which elements can and should be written natively?</li> \n <li>Which elements can and should be written in JavaScript?</li> \n <li>Can it compete with native apps in a way that users won’t notice it is “different”?</li> \n <li>Does React Native support the native share dialogue?</li> \n <li>Does it support deep linking?</li> \n <li>Does it support securely storing access tokens?</li> \n <li>Does it support Facebook &amp; Google sign-in SDKs?</li> \n</ul> \n<p>We also had questions about how well it would integrate with our existing native libraries:</p> \n<ul> \n <li>Can we run acceptance tests with our existing iOS tooling?</li> \n <li>How can we implement internationalization?</li> \n <li>Can we integrate it into our continuous-integration pipeline?</li> \n <li>What does the performance look like for long lists? In general?</li> \n <li>Does it have a negative effect on battery life?</li> \n</ul> \n<p>During a two-week <a href=\"https://en.wikipedia.org/wiki/Spike_(software_development)\">spike</a>, we built a prototype of the SoundCloud Pulse app to have a better understanding of React Native in practice. After the first week, we had already fleshed out most screens of the app and were surprised how quickly we were progressing. During the second week, we wanted to focus on the unanswered questions and write some native code. It was easy to bridge our existing iOS libraries with our React Native prototype. We completed the prototype with support from our iOS engineers and concluded that we had enough confidence in React Native to go ahead with the project full time.</p> \n<h2>The journey</h2> \n<p>We started working on the app with two JavaScript engineers and one iOS engineer. There were no designs for the iOS app yet but we knew that we needed to reach feature parity with the Android app and so we used the Android app as a blueprint for the iOS version.</p> \n<p>It turned out to be a great idea to have an iOS developer working side by side with the JavaScript developers. There was a lot of knowledge sharing in the initial couple of weeks and we were able to keep up the fast pace from the spike sprint. We finished entire screens in single days and even built more features into the app than we had on Android in the beginning (e.g. 1Password integration).</p> \n<p>In contrast to the spike sprint we focused more on achieving high test coverage. Coming from a mostly web background we were used to be able to deploy hot fixes within a couple of minutes in case of a runtime error. On mobile this is not possible and so we had to test more thoroughly before shipping a new version of our app. We thought about using services like <a href=\"https://microsoft.github.io/code-push/\">CodePush</a> that allow you to push an updated version of your app without needing to wait for the app store review process. However, all those services were not stable enough in the beginning and we decided not to use them to reduce the amount of sources of errors.</p> \n<p>Development of the app started mid-October 2015 and we shipped the first version mid-February. It took us four months to write the app with three developers. Four months from a spike code base to a unit-tested, component-tested, and integration-tested application. We estimated that it would take us six months to finish the app but we underestimated how fast React Native allowed us to be.</p> \n<h2>Things we’ve learned along the way</h2> \n<h3>Native libraries</h3> \n<p>For many popular native libraries / APIs / SDKs someone probably has written a bridge to React Native already. Of course the <a href=\"https://github.com/facebook/react-native-fbsdk\">Facebook SDK</a> is one of them, so is <a href=\"https://github.com/devfd/react-native-google-signin\">Google Signin</a> but also things like <a href=\"https://github.com/Appboy/appboy-react-sdk\">Appboy</a>, access to the <a href=\"https://github.com/oblador/react-native-keychain\">iOS Keychain</a> and many more.</p> \n<p>If your biggest fear of jumping on the React Native bandwagon is that you have already amassed many great Objective-C libraries that you don’t want to lose, don’t worry, it is very easy to use them. React Native’s <a href=\"http://facebook.github.io/react-native/docs/native-modules-ios.html\">native modules</a> are well equipped to bridge anything you have over to be accessed by JavaScript, and they are really quick to implement. It helps having someone with Objective-C knowledge in your team or someone who can help out, but the API is very understandable even for non iOS developers.</p> \n<p>A perfect example of this was our event-logging library. It was battle tested in our listener app, it had support for batch sending events, so it would be lighter on the network traffic, and it could handle offline / bad connectivity. We were able to extract it from the listener application without too much effort. The rest was as simple as bringing a few methods like <code class=\"language-text\">initialize</code>, <code class=\"language-text\">pageView</code> and <code class=\"language-text\">click</code> to JavaScript. \\o/</p> \n<h3>Native infrastructure</h3> \n<p>We didn’t need to reinvent the wheel when it came to building and testing our application either. Since React Native applications are built pretty much like any other iOS app (not counting the extra step of compiling JavaScript of course ;)) our iOS and testing teams were able to set up a CI environment very similar to the current structure within a couple of days. The acceptance tests were written in the same style as our iOS developers benefiting a lot from their experience and it making it easier to set up.</p> \n<p>Another great help was knowledge around how to distribute an application to the app store and the process that revolves around that. Since we were mostly web developers and did not have any experience with that process, setting it up on the CI saved us a considerable amount of time running builds manually and uploading them to the app store by hand.</p> \n<h3>Web libraries</h3> \n<p>We could reuse a lot of our internal web modules with little to no modification. One good example is the way we handle internationalization. We are using the same library that we are using on all of our web-based applications, so we only needed to adapt our string parsing slightly.</p> \n<p>Another example is a library for defining API endpoints in a centralized way. We were able to use it straight up, no changes necessary, by passing React Native’s <code class=\"language-text\">fetch</code> function as the transport layer. These were just two examples but there were many more small utilities / helpers that we were able to just drop in.</p> \n<h3>React Native Gotchas</h3> \n<p>Of course no technology is perfect and so React Native comes with its own set of small gotchas. None of them are deal breakers for us, but you should still know about them before starting a React Native project.</p> \n<p>The biggest one by far is the fact that React Native is evolving very quickly, which of course is great, but it does incur a cost. There is a new version every two weeks (along with a release candidate of the next version) and the “Breaking Changes” section is often extensive. If you update on a regular basis you’ll be mostly fine; the bigger potential issues come from the third party libraries you use. As an example, now you import <code class=\"language-text\">React</code> from <code class=\"language-text\">react</code> instead of from <code class=\"language-text\">react-native</code> which is a problem if the third party libraries have not been updated to do the same. On top of that, Facebook definitely values pushing forward more than safely updating which was most apparent in an update to Babel 6 that <a href=\"https://github.com/facebook/react-native/issues/4062\">broke many libraries</a> and took weeks for everyone to catch up. All of this basically means you need to put a little more time aside for keeping up-to-date than with more mature frameworks.</p> \n<p>The other little pain point is documentation. It is not as extensive as we wish and there are still some completely undocumented features / components, but this is getting better and you can see a <a href=\"https://twitter.com/reactjs/status/743937815705059330\">big investment</a> happening in this area.</p> \n<h2>Why React Native worked well for us</h2> \n<p>The main driver for us at SoundCloud to use React Native was the lack of enough mobile engineers to start development on a new mobile app. This is probably one of the main arguments for React Native if you are in a similar position of having more web engineers than mobile engineers. While this situation still holds true for us to some extent we have come to appreciate React Native for many more reasons than its JavaScript roots.</p> \n<p>It is quite obvious that a better developer experience was a top priority for Facebook when creating React Native and it really shows. Automatically live reloading your app when your code changes massively shortens the feedback loop and using Chrome to debug your application feels very much at home to any web developer. If you also happen to use Redux and a logger middleware, knowing what is going on in your app at any point is very straightforward. It is a very comforting feeling to know the tools are there for you when you need them and its effect on developer happiness, development speed and confidence can not be understated. If you need one reason to give it a try, this is it. Happy developers and a faster turnaround are hard to beat. Product managers, decision makers &amp; designers listen up, I’m talking to you here :)</p> \n<p>But there’s more: the open source community provides many ready-to-use libraries and components and is very responsive to React Native’s changes, questions and improvement suggestions. It feels good to be part of this positive community.</p> \n<p>Another huge benefit that we only recently started to explore is the cross platform nature of React Native. Facebook mentions <a href=\"https://code.facebook.com/posts/1189117404435352/react-native-for-android-how-we-built-the-first-cross-platform-react-native-app/\">about 85 percent code reuse</a> between their iOS and Android implementation of Ads Manager, and with the right app structure that number is very realistic to expect. This means that once you have the structure there, building a new feature for your app on both platforms will only have an additional cost of 10 - 20 percent instead of 100 percent. That’s huge.</p> \n<p>The ability to update your application on the fly, as mentioned earlier, also allows immediate bug fixes, a/b tests and the warm, cozy feeling that you can push an update whenever you want: a dream come true in the mobile development space (as long as Google and Apple allow it, which is always a little hard to predict).</p> \n<h2>What’s next</h2> \n<p>Based on the great experience we had with React Native, we plan on using it in more places at SoundCloud. Right now there is a team of designers working on a replacement for our prototyping / user-testing application written in React Native. Our designers found it much simpler to work on a React-based application than on a native application and are capable of building the application by themselves without frequent developer input. They are also working on bringing this application to Android to increase the pool of users that we can test with and to test Android-specific features.</p> \n<p>Speaking of Android, we have spent some time to prepare the app for running on Android and got a stripped-down version of the app working in just a couple of <a href=\"https://developers.soundcloud.com/blog/stop-hacker-time\">hacker time</a> sessions. We are currently investigating further steps in that direction, such as replacing the current Android Pulse app with the React Native version. Another area we are looking into is integrating React Native views inside our native applications. We’re looking forward to these experiments and hope they go as well as this one.</p> \n<p>Get in touch with us</p> \n<p>Jan Monschke <a href=\"https://twitter.com/thedeftone\">@thedeftone</a><br> Peter Minarik <a href=\"https://twitter.com/pietropizzi\">@pietropizzi</a></br></p>","descriptionType":"html","publishedDate":"Wed, 03 Aug 2016 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"109058f6b47a8b5e4c1ba9a1e04f26ac","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569977},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Introducing the Large Hadron Migrator","link":"https://developers.soundcloud.com/blog/introducing-the-large-hadron-migrator-3","description":"<p>Rails style database migrations are a useful way to evolve your data schema in an agile manner. Most Rails projects start like this, and at first, making changes is fast and easy.</p> \n<p>That is until your tables grow to millions of records. At this point, the locking nature of <code class=\"language-text\">ALTER TABLE</code> may take your site down for an hour our more while critical tables are migrated. In order to avoid this, developers begin to design around the problem by introducing join tables or moving the data into another layer. Development gets less and less agile as tables grow and grow. To make the problem worse, adding or changing indices to optimize data access becomes just as difficult.</p> \n<blockquote> \n <p>Side effects may include black holes and universe implosion.</p> \n</blockquote> \n<p>There are few things that can be done at the server or engine level. It is possible to change default values in an <code class=\"language-text\">ALTER TABLE</code> without locking the table. The InnoDB Plugin provides facilities for online index creation, which is great if you are using this engine, but only solves half the problem.</p> \n<p>At SoundCloud we started having migration pains quite a while ago, and after looking around for third party solutions [0]&nbsp;<a href=\"https://github.com/soundcloud/large-hadron-migrator\">2</a>, we decided to create our own. We called it <a href=\"https://github.com/soundcloud/large-hadron-migrator\">Large Hadron Migrator</a>, and it is a gem for online ActiveRecord migrations.</p> \n<p><img src=\"http://farm4.static.flickr.com/3093/2844971993_17f2ddf2a8_z.jpg\" alt=\"LHC\"> <a href=\"http://en.wikipedia.org/wiki/Large_Hadron_Collider\">The Large Hadron collider at CERN</a></img></p> \n<h2>The idea</h2> \n<p>The basic idea is to perform the migration online while the system is live, without locking the table. Similar to OAK (online alter table) <a href=\"https://github.com/soundcloud/large-hadron-migrator\">2</a> and the facebook tool [0], we use a copy table, triggers and a journal table.</p> \n<p>We copy successive ranges of data from the original table to a copy table and then rename both at the end. Since UPDATE, DELETE and CREATE statements continue to hit the original table while doing this, we add triggers to capture these changes into a journal table.</p> \n<p>At the end of the copying process, the journal table is replayed so that none of these intervening mutations are lost.</p> \n<p>The <a href=\"https://github.com/soundcloud/large-hadron-migrator\">Large Hadron</a> is a test driven Ruby solution which can easily be dropped into an ActiveRecord migration. It presumes a single auto incremented numerical primary key called id as per the Rails convention. Unlike the twitter solution [1], it does not require the presence of an indexed updated_at column.</p> \n<h2>Usage</h2> \n<p><a href=\"https://github.com/soundcloud/large-hadron-migrator\">Large Hadron Migrator</a> is currently implemented as a Rails ActiveRecord Migration.</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\"> \n <pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">AddIndexToEmails</span> <span class=\"token operator\">&lt;</span> <span class=\"token constant\">LargeHadronMigration</span>\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">up</span></span>\n    large_hadron_migrate <span class=\"token symbol\">:emails</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:wait</span> <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token number\">0.2</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>table_name<span class=\"token operator\">|</span>\n      execute <span class=\"token string\">%Q{\n        alter table %s\n          add index index_emails_on_hashed_address (hashed_address)\n      }</span> <span class=\"token operator\">%</span> table_name\n    <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre> \n</div> \n<h2>Migration phases</h2> \n<p>LHM runs through the following phases during a migration.</p> \n<h3>1. Get the maximum primary key value for the table</h3> \n<p>When starting the migration, we remember the last insert id on the original table. When the original table is copied into the new table, we stop at this id. The rest of the records will be found in the journal table – see below.</p> \n<h3>2. Create new table and journal table</h3> \n<p>The two tables are cloned using <code class=\"language-text\">SHOW CREATE TABLE</code>. The journal table has an extra action field (update, delete, insert).</p> \n<h3>3. Activate journalling with triggers</h3> \n<p>Triggers are created for each of the action types ‘create’, ‘update’ and ‘delete’. Triggers are responsible for filling the journal table.</p> \n<p>Because the journal table has the same primary key as the original table, there can only ever be one version of the record in the journal table.</p> \n<p>If the journalling trigger hits an already persisted record, it will be replaced with the latest data and action. <code class=\"language-text\">ON DUPLICATE KEY</code> comes in handy here. This insures that all journal records will be consistent with the original table.</p> \n<h3>4. Perform alter statement on new table</h3> \n<p>The user supplied <code class=\"language-text\">ALTER TABLE</code> statement(s) or index changes are applied to the new table. Our tests using InnodDB showed this to be faster than adding the indexes at the end of the copying process.</p> \n<h3>5. Copy in chunks up to max primary key value to new table</h3> \n<p>Currently InnoDB aquires a read lock on the source rows in <code class=\"language-text\">INSERT INTO... SELECT</code>. LHM reads 35K ranges and pauses for a specified number of milliseconds so that contention can be minimized.</p> \n<h3>6. Switch new and original table names and remove triggers</h3> \n<p>The orignal and copy table are now atomically switched with <code class=\"language-text\">RENAME TABLE original</code> TO <code class=\"language-text\">archive_original</code>, <code class=\"language-text\">copy_table</code> TO <code class=\"language-text\">original</code>. The triggers are removed so that journalling stops and all mutations and reads now go against the original table.</p> \n<h3>7. Replay journal: insert, update, deletes</h3> \n<p>Because the chunked copy stops at the intial maximum id, we can simply replay all inserts in the journal table without worrying about collisions.</p> \n<p>Updates and deletes are then replayed.</p> \n<h2>Potential issues</h2> \n<p>Locks could be avoided during the copy phase by loading records into an outfile and then reading them back into the copy table. The facebook solution does this and reads in 500000 rows and is faster for this reason. We plan to add this optimization to LHM.</p> \n<p>Data is eventually consistent while replaying the journal, so there may be delays while the journal is replayed. The journal is replayed in a single pass, so this will be quite short compared to the copy phase. The inconsistency during replay is similar in effect to a slave which is slightly behind master.</p> \n<p>There is also caveat with the current journalling scheme; stale journal ‘update’ entries are still replayed. Imagine an update to the a record in the migrated table while the journal is replaying. The journal may already contain an update for this record, which becomes stale now. When it is replayed, the second change will be lost. So if a record is updated twice, once before and once during the replay window, the second update will be lost.</p> \n<p>There are several ways this edge case could be resolved. One way would be to add an UPDATE trigger to the main table, and delete corresponding records from the journal while replaying. This would ensure that the journal does not contain stale update entries.</p> \n<h2>Near disaster at the collider</h2> \n<p>Having scratched our itch, we went ahead and got ready to roll schema and index changes that would impact hundreds of millions of records across many tables. There was a backlog of changes we rolled out in one go.</p> \n<p>At the time, our MySQL slaves were regularly struggling with their replication thread. They were often far behind master. Some of the changes were designed to relieve this situation. Because of the slave lag, we configured the LHM to add a bit more wait time between chunks, which made the total migration time quite long. After running some rehersals, we agreed on the settings and rolled out to live, expecting 5 – 7 hours to complete the migrations.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/e8a883f8e52683da109209f5341d150c/48a11/958035425_abb70e79b1.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBQH/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAcu+U9TPWjkiqxH/xAAbEAACAwADAAAAAAAAAAAAAAABAgADERASMf/aAAgBAQABBQJE7FqcGSlgCiLSD6JvH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABsQAAIBBQAAAAAAAAAAAAAAAAERAAIQEiAi/9oACAEBAAY/AowjerrJ6//EABkQAQEBAQEBAAAAAAAAAAAAAAERACExEP/aAAgBAQABPyFZBkVIcY2Z63Z+OQfLAkyMWV8//9oADAMBAAIAAwAAABC88H//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QI//EABsQAQEBAQEAAwAAAAAAAAAAAAERACExQVFh/9oACAEBAAE/ECly+YwKuFT6Z5lIm9zginpeY+WIkAtr+5iTMPHIOuq/O//Z'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"958035425 abb70e79b1\" title=\"958035425 abb70e79b1\" src=\"https://developers.soundcloud.com/blog/static/e8a883f8e52683da109209f5341d150c/48a11/958035425_abb70e79b1.jpg\" srcset=\"/blog/static/e8a883f8e52683da109209f5341d150c/f544b/958035425_abb70e79b1.jpg 200w,\n/blog/static/e8a883f8e52683da109209f5341d150c/41689/958035425_abb70e79b1.jpg 400w,\n/blog/static/e8a883f8e52683da109209f5341d150c/48a11/958035425_abb70e79b1.jpg 500w\" sizes=\"(max-width: 500px) 100vw, 500px\" loading=\"lazy\" /> </a> </span></p> \n<p>Several hours into the migration, a critical fix had to be deployed to the site. We rolled out the fix and restarted the app servers in mid migration. This was not a good idea.</p> \n<p>The lesson: never restart during migrations when removing columns with large hadron. You can restart while adding migrations as long as active record reads column definitions from the slave.</p> \n<p>The information below is only relevant if you want to restart your app servers while migrating in a master slave setup.</p> \n<p>If you anticipate the need to restart your application servers while migrating, then check the comments in <code class=\"language-text\">large_hadron_migrator.rb</code> for detailed instructions on how to do this.</p> \n<h2>Future work</h2> \n<p>The following improvements should be made at some point:</p> \n<ul> \n <li>Loading data into outfile instead of <code class=\"language-text\">INSERT INTO... SELECT</code>. Avoid contention and increase speed.</li> \n <li>Handle invalidation of ‘update’ entries in journal while replaying. Avoid stale update replays.</li> \n</ul> \n<p>Some other optimizations:</p> \n<ul> \n <li>Deletions create gaps in the primary key id integer column. LHM has no problems with this, but the chunked copy could be sped up by factoring this in. Currently a copy range may be completely empty, but there will still be a <code class=\"language-text\">INSERT INTO... SELECT</code>.</li> \n <li>Records inserted after the last insert id is retrieved and before the triggers are created are currently lost. The table should be briefly locked while id is read and triggers are applied.</li> \n</ul> \n<p>Footnotes [0] <a href=\"http://www.facebook.com/note.php?note_id=430801045932\">Facebook Online Schema Change</a> [1] <a href=\"https://github.com/freels/table/_migrator\">Twitter Table Migrator</a> <a href=\"https://github.com/soundcloud/large-hadron-migrator\">2</a> <a href=\"http://openarkkit.googlecode.com/svn/trunk/openarkkit/doc/html/oak-online-alter-table.html\">OAK online alter table</a> <a href=\"https://github.com/soundcloud/large-hadron-migrator\">The Large Hadron Migrator on Github</a></p>","descriptionType":"html","publishedDate":"Wed, 04 May 2011 00:00:00 +0000","feedId":10291,"bgimg":"http://farm4.static.flickr.com/3093/2844971993_17f2ddf2a8_z.jpg","linkMd5":"e84dc40486af1771d74c7ce37e8a6a2c","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn21@2020_1/2020/08/25/00-49-38-831_57ef335b361b09fa.webp","destWidth":639,"destHeight":395,"sourceBytes":125076,"destBytes":79358,"author":"","articleImgCdnMap":{"http://farm4.static.flickr.com/3093/2844971993_17f2ddf2a8_z.jpg":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn21@2020_1/2020/08/25/00-49-38-831_57ef335b361b09fa.webp","https://developers.soundcloud.com/blog/static/e8a883f8e52683da109209f5341d150c/48a11/958035425_abb70e79b1.jpg":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn30@2020_2/2020/08/25/00-51-47-886_529b2d0c61375608.webp"},"publishedOrCreatedDate":1598316569986},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Removing 'hotness' parameterhotness","link":"https://developers.soundcloud.com/blog/removing-hotness-param","description":"<p>The <code class=\"language-text\">/tracks</code> endpoint has traditionally accepted an <code class=\"language-text\">order</code> parameter for ordering results by either creation date or ‘hotness’. The method for calculating a tracks ‘hotness’ has never been clearly explained, but generally speaking is based on the number of likes and listens a track receives.</p> \n<p>Recently we started to experience problems with the query that returns tracks ordered by hotness. In the past weeks, these problems started to effect and even cause outages for API users.</p> \n<p>We have decided that the best way forward is to remove this parameter. Starting soon, <code class=\"language-text\">GET</code> requests to the <code class=\"language-text\">/tracks</code> endpoint will ignore the <code class=\"language-text\">order</code> parameter and default to ordering by creation date.</p> \n<p>In the future, we look forward to releasing support for more stable and idiomatic search and order parameters. In the meantime, it is still possible to approximate the result sets previously returned by specifying <code class=\"language-text\">order=hotness</code> by manually sorting the returned tracks by a combination of <code class=\"language-text\">favoritings\\_count</code> and <code class=\"language-text\">playback\\_count</code>.</p>","descriptionType":"html","publishedDate":"Tue, 16 Apr 2013 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"0962fec93695a39cd012270d3e40c574","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569981},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"HTML5 Widget API","link":"https://developers.soundcloud.com/blog/html5-widget-api","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 520px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/e0f4c43c1c010b26b98e338381deec51/249e6/html5-api.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 31.923076923076927%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAABAElEQVQY032PS0vDQBSF8/cFcZFAd1lod+LaGKQ7Y0QNBlqYmTzIE5PMpJlOqgh5jN4kIHXjtzjce+A+jkIpFUIwxmi9Z43ISyY+vrg4jvL7H/q+77pOSZIkz/OiolVMamS/v20+011fp1mAn19eAcdxXNfFGCOELMvKsqxpmrIs27ZVoijabbfID8OnO+9+HW/W7cNV+Xhze315dn6haZqqqqvVyjAMXdehME0Tdtm2HQSBkqYpIcQDfB8R3wvCw0HwPasoresaLhRFAa+xGXCmgJSCAzoNxwtRBEIwPrbtKOWSahgGKKSU48zSDjNTZsgQ/wV2c86bE/gJvyZ88QMw4D6JucbFMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"HTML5 Widget API\" title=\"HTML5 Widget API\" src=\"https://developers.soundcloud.com/blog/static/e0f4c43c1c010b26b98e338381deec51/249e6/html5-api.png\" srcset=\"/blog/static/e0f4c43c1c010b26b98e338381deec51/9ec3c/html5-api.png 200w,\n/blog/static/e0f4c43c1c010b26b98e338381deec51/c7805/html5-api.png 400w,\n/blog/static/e0f4c43c1c010b26b98e338381deec51/249e6/html5-api.png 520w\" sizes=\"(max-width: 520px) 100vw, 520px\" loading=\"lazy\" /> </a> </span></p> \n<p>Today we’re officially announcing our JavaScript API for the new HTML5 SoundCloud Widget. To use it, just insert the script tag on a page where you’re using our HTML5 Widget.</p> \n<div class=\"gatsby-highlight\" data-language=\"html\"> \n <pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://w.soundcloud.com/player/api.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre> \n</div> \n<h2>What does it permit?</h2> \n<h3>Access and control the properties of HTML5 Widget</h3> \n<div class=\"gatsby-highlight\" data-language=\"html\"> \n <pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>iframe</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sc-widget<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://w.soundcloud.com/player/?url=https://api.soundcloud.com/users/1539950/favorites<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>465<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">scrolling</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>no<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">frameborder</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>no<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>iframe</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://w.soundcloud.com/player/api.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> widgetIframe <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sc-widget'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        widget       <span class=\"token operator\">=</span> <span class=\"token constant\">SC</span><span class=\"token punctuation\">.</span><span class=\"token function\">Widget</span><span class=\"token punctuation\">(</span>widgetIframe<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">widget</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SC</span><span class=\"token punctuation\">.</span>Widget<span class=\"token punctuation\">.</span>Events<span class=\"token punctuation\">.</span><span class=\"token constant\">READY</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">widget</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SC</span><span class=\"token punctuation\">.</span>Widget<span class=\"token punctuation\">.</span>Events<span class=\"token punctuation\">.</span><span class=\"token constant\">PLAY</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// get information about currently playing sound</span>\n        widget<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrentSound</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">currentSound</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sound '</span> <span class=\"token operator\">+</span> currentSound<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'began to play'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// get current level of volume</span>\n      widget<span class=\"token punctuation\">.</span><span class=\"token function\">getVolume</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">volume</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'current volume value is '</span> <span class=\"token operator\">+</span> volume<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// set new volume level</span>\n      widget<span class=\"token punctuation\">.</span><span class=\"token function\">setVolume</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// get the value of the current position</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre> \n</div> \n<h3>Load widgets</h3> \n<div class=\"gatsby-highlight\" data-language=\"html\"> \n <pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>iframe</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sc-widget<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>100%<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>166<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">scrolling</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>no<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">frameborder</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>no<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F1848538&amp;show_artwork=true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>iframe</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://w.soundcloud.com/player/api.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> widgetIframe <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sc-widget'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        widget       <span class=\"token operator\">=</span> <span class=\"token constant\">SC</span><span class=\"token punctuation\">.</span><span class=\"token function\">Widget</span><span class=\"token punctuation\">(</span>widgetIframe<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        newSoundUrl <span class=\"token operator\">=</span> <span class=\"token string\">'https://api.soundcloud.com/tracks/13692671'</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">widget</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SC</span><span class=\"token punctuation\">.</span>Widget<span class=\"token punctuation\">.</span>Events<span class=\"token punctuation\">.</span><span class=\"token constant\">READY</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// load new widget</span>\n      <span class=\"token function\">widget</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SC</span><span class=\"token punctuation\">.</span>Widget<span class=\"token punctuation\">.</span>Events<span class=\"token punctuation\">.</span><span class=\"token constant\">FINISH</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        widget<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span>newSoundUrl<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n          show_artwork<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">&gt;</span></span></code></pre> \n</div> \n<h2>Resources</h2> \n<ul> \n <li>take a look at our <a href=\"https://developers.soundcloud.com/blog/docs/html5-widget\">documentation</a> for more details and technical descriptions</li> \n <li>check out our <a href=\"https://w.soundcloud.com/player/api_playground.html\">playground</a> to get an overview of functionalities provided by the API</li> \n</ul> \n<h2>Feedback</h2> \n<p>If you’ve got a suggestion, found a bug, please let us know by leaving a comment below.</p>","descriptionType":"html","publishedDate":"Thu, 22 Mar 2012 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/e0f4c43c1c010b26b98e338381deec51/249e6/html5-api.png","linkMd5":"135be9f48e10eca6259aac5fa67126da","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn67@2020_5/2020/08/25/00-49-39-301_147c7fc9418c1c13.webp","destWidth":520,"destHeight":166,"sourceBytes":12169,"destBytes":9016,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/e0f4c43c1c010b26b98e338381deec51/249e6/html5-api.png":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn67@2020_5/2020/08/25/00-49-39-301_147c7fc9418c1c13.webp"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Building Products at SoundCloud—Part II: Breaking the Monolith","link":"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-2-breaking-the-monolith","description":"<p><a href=\"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith\">In the previous post</a>, we talked about how we enabled our teams to build microservices in <a href=\"https://developers.soundcloud.com/blog/category/scala\">Scala</a>, <a href=\"https://developers.soundcloud.com/blog/category/clojure\">Clojure</a>, and <a href=\"https://developers.soundcloud.com/blog/category/ruby\">JRuby</a> without coupling them with our legacy monolithic Rails system. After the architecture changes were made, our teams were free to build their new features and enhancements in a much more flexible environment. An important question remained, though: how do we extract the features from the monolithic Rails application called <em>Mothership</em>?</p> \n<p>Splitting a legacy application is never easy, but luckily there are plenty of industry and academic publications to help you out.</p> \n<p>The first step in any activity like this is to identify and apply the criteria used to define the <em>units</em> to be extracted. At SoundCloud, we have decided to use <a href=\"http://www.amazon.com/gp/product/0321125215/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0321125215&amp;linkCode=as2&amp;tag=fragmental-20&amp;linkId=ZQCEXWYXNZ5AA2WS\">the work of Eric Evans and Martin Fowler in what is called a <em>Bounded Context</em></a>. An obvious example of Bounded Context in our domain was user-to-user messages. This was a well-contained feature set, highly cohesive, and not too coupled with the rest of the domain, as it just needs to hold references to users.</p> \n<p>After we identified the Bounded Context, the next task was to find a way to extract it. Unfortunately, Rails’ ActiveRecord framework often leads to a very coupled design. The code dealing with such messages was as follows:</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\">\n <pre class=\"language-ruby\"><code class=\"language-ruby\"> <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">index</span></span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">InboxItem</span> <span class=\"token operator\">===</span> item<span class=\"token punctuation\">)</span>\n    respond mailbox_items_in_collection<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">.</span>paginate<span class=\"token punctuation\">(</span><span class=\"token symbol\">:page</span> <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> params<span class=\"token punctuation\">[</span><span class=\"token symbol\">:page</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">else</span>\n    respond mailbox_items_in_collection<span class=\"token punctuation\">.</span>paginate<span class=\"token punctuation\">(</span>\n      <span class=\"token symbol\">:joins</span> <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">\"INNER JOIN messages ON <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>safe_collection<span class=\"token delimiter tag\">}</span></span>_items.message_id = messages.id\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token symbol\">:page</span>  <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> params<span class=\"token punctuation\">[</span><span class=\"token symbol\">:page</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token symbol\">:order</span> <span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token string\">'messages.created_at DESC'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre>\n</div> \n<p>Because we wanted to extract the messages’ Bounded Context into a separate microservice, we needed the code above to be more flexible. The first step we took was to refactor this code into <a href=\"http://www.amazon.com/gp/product/0131177052/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0131177052&amp;linkCode=as2&amp;tag=fragmental-20&amp;linkId=5KPGXJ7FUWPGJR3K\">what Michael Feathers describes as a <em>seam</em></a>:</p> \n<blockquote>\n  A seam is a place where you can alter behavior in your program without editing in that place. \n</blockquote> \n<p>So we changed our code a little bit:</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\">\n <pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">index</span></span>\n  conversations <span class=\"token operator\">=</span> cursor_for <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>cursor<span class=\"token operator\">|</span>\n    conversations_service<span class=\"token punctuation\">.</span>conversations_for<span class=\"token punctuation\">(</span>\n    current_user<span class=\"token punctuation\">,</span>\n    cursor<span class=\"token punctuation\">[</span><span class=\"token symbol\">:offset</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    cursor<span class=\"token punctuation\">[</span><span class=\"token symbol\">:limit</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n\n  respond collection_for<span class=\"token punctuation\">(</span>conversations<span class=\"token punctuation\">,</span> <span class=\"token symbol\">:conversations</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span></code></pre>\n</div> \n<p>The first version of the <code class=\"language-text\">conversations_service#conversations_for</code> method was not that different from the previous code; it performed the exact same ActiveRecord calls.</p> \n<p>We were ready to extract this logic into a microservice without having to refactor lots of controllers and other Presentation Layer code. We first replaced the implementation of <code class=\"language-text\">conversations_service#conversations_for</code> with a call to the service:</p> \n<div class=\"gatsby-highlight\" data-language=\"ruby\">\n <pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">conversations_for</span></span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span> offset <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> limit <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n  response <span class=\"token operator\">=</span> <span class=\"token variable\">@http_client</span><span class=\"token punctuation\">.</span>do_get<span class=\"token punctuation\">(</span>service_path<span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> pagination<span class=\"token punctuation\">(</span>offset<span class=\"token punctuation\">,</span> limit<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  parse_response<span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span></code></pre>\n</div> \n<p>We avoided big-bang refactorings as much as we could, and this required us to have the microservices working together with the old Mothership code for as long as it took to completely extract the logic into the new microservice.</p> \n<p>As described before, we did not want to use the Mothership’s database as the integration point for microservices. That database is an <a href=\"http://martinfowler.com/bliki/ApplicationDatabase.html\"><em>Application Database</em></a>, and making it an <a href=\"http://martinfowler.com/bliki/IntegrationDatabase.html\"><em>Integration Database</em></a> would cause problems because we would have to synchronize any change in the database across many different microservices that would now be coupled to it.</p> \n<p>Although using the database as the integration point between systems was not planned, we had the new microservices accessing the Mothership’s database during the transition period.</p> \n<p>This brought up two important issues. During the whole transition period, the new microservices could not change the relational model in MySQL—or, even worse, use a different storage engine. For extreme cases, like user-to-user messages where a threaded-based model was replaced by a chat-like one, we had <code class=\"language-text\">cronjobs</code> keep different databases synchronized.</p> \n<p>The other issue was related to the Semantic Events system described in Part I. The way our architecture and infrastructure was designed requires events to be emitted where the state change happened, and this ought to be a single system. Because we could not have both the Mothership and the new microservice emitting events, we had to implement only the read-path endpoints until we were ready to make the full switch from the Mothership to the new microservice. This was less problematic than what we first thought, but nevertheless it did impact product prioritization because features to be delivered were constrained by this strategy.</p> \n<p>By applying these principles we were able to extract most services from the Mothership. Currently we have only the most coupled part of our domain there, and products like <a href=\"https://blog.soundcloud.com/2014/01/13/hear-whats-happening-new-messaging/\">the new user-to-user messaging system</a> were built completely decoupled from the monolith.</p> \n<p>In the next part, we will look at how we use Scala and <a href=\"http://twitter.github.io/finagle/\">Finagle</a> to build our microservices.</p>","descriptionType":"html","publishedDate":"Thu, 12 Jun 2014 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"f5ccb590d6b6ba11d8474f0ab4e61225","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569980},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Sharing to Facebook, Twitter etc","link":"https://developers.soundcloud.com/blog/sharing-to-facebook-twitter-etc","description":"<p>It is now possible to share all public <a href=\"https://developers.soundcloud.com/blog/docs/api/tracks#social-sharing\">tracks</a> and <a href=\"https://developers.soundcloud.com/blog/docs/api/playlists#social-sharing\">playlists</a> to the connections of the authenticated user. So if a user is already connected e.g. with Facebook on SoundCloud, this connection can be used from your app to share a track.</p> \n<!-- more --> \n<p>The general flow for sharing looks like this:</p> \n<ol> \n <li> <p>Get the connections of the user</p> \n  <div class=\"gatsby-highlight\" data-language=\"text\"> \n   <pre class=\"language-text\"><code class=\"language-text\">$ curl -H \"Authorization: OAuth {access_token}\" \"https://api.soundcloud.com/me/connections\"\n\n[\n  {\n    \"id\": 1234,\n    \"created_at\": \"2010/12/14 22:02:07 +0000\",\n    \"display_name\": \"My Facebook Name\",\n    ...\n    \"service\": \"facebook_profile\",\n  },\n]</code></pre> \n  </div> </li> \n <li> <p>Choose connections</p> <p>Display the connections to the user and let her choose to which social networks she wants to post to. Remember the ids of the connections for the next step. You can also enable the user to connect to new social networks. This is explained further in the <a href=\"https://developers.soundcloud.com/blog/docs/api/me-connections\">connections</a> documentation. Furthermore the user can enter a custom sharing message.</p> </li> \n <li> <p>Post to connections</p> <p>In this example we will post the track with the id 321 with the message “I love this track” to the Facebook profile 1234:</p> \n  <div class=\"gatsby-highlight\" data-language=\"text\"> \n   <pre class=\"language-text\"><code class=\"language-text\">$ curl -H \"Authorization: OAuth {access_token}\" \"https://api.soundcloud.com/tracks/321/shared-to/connections\" \\\n  -d connections[][id]=1234 \\\n  -d sharing_note=I+love+this+track</code></pre> \n  </div> </li> \n</ol> \n<p>You can both post your own and other peoples track via this resource. If you want to know more, read the documentation for track <a href=\"https://developers.soundcloud.com/blog/docs/api/tracks/#social-sharing\">here</a> and for playlists <a href=\"https://developers.soundcloud.com/blog/docs/api/playlists#social-sharing\">here</a>.</p>","descriptionType":"html","publishedDate":"Tue, 26 Jul 2011 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"34b68cce2734061914291b3d5498c8e8","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Connect & Record with the new JavaScript SDK","link":"https://developers.soundcloud.com/blog/javascript-sdk","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 519px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/6c7832499ba160d91a482087ca6c54f3/96300/record-example.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 25.240847784200387%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAA1UlEQVQY03WOTU7DMBCFe82KS1R0gYTYV6xY9BScoAfgGrSy04ak9oxT+beuPQk2AcSGt3iLp/fNm8VUNI7FUnDmbXdDOSdf2SSFYIy1H3LQ5K9jSmn6o0U1otKE7ROslvL5kUaa8Xoxpb7vCnxgkvG+61qntQcZEJw233Ad2Tyo9R2+3BPlXziEIIS8DEqbiBcC5a3RChGEvMVYYco55uwAht2rbQ8xU/55ryw3TcM4O57O/AioTGG899Y6IqrwNQTOmURVHjgD7t/3xtgZdq6Wpn/0CafUGZHyVa+QAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Connect and Record\" title=\"Connect and Record\" src=\"https://developers.soundcloud.com/blog/static/6c7832499ba160d91a482087ca6c54f3/96300/record-example.png\" srcset=\"/blog/static/6c7832499ba160d91a482087ca6c54f3/9ec3c/record-example.png 200w,\n/blog/static/6c7832499ba160d91a482087ca6c54f3/c7805/record-example.png 400w,\n/blog/static/6c7832499ba160d91a482087ca6c54f3/96300/record-example.png 519w\" sizes=\"(max-width: 519px) 100vw, 519px\" loading=\"lazy\" /> </a> </span></p> \n<p>Today we’re excited to announce a big update to our JavaScript SDK. Aside from improving the existing functionality like authentication, API read requests and oEmbed, we’ve added some sweet new features:</p> \n<ul> \n <li> <p><strong>API write support:</strong></p> <p>Create comments, follow users, like sounds and update user profiles</p> </li> \n <li> <p><strong>Audio Streaming:</strong></p> <p>Build your own player powered by SoundCloud</p> </li> \n <li> <p><strong>Audio recording and uploading:</strong></p> <p>Let your users record and upload sounds to SoundCloud from your website.</p> </li> \n</ul> \n<p>All of these features can be added to your website with only a few lines of JavaScript saving you the pain of dealing with tricky things like cross domain communication, dependency loading and cross browser workarounds.</p> \n<p>Want to try it out yourself? Take a look at the <a href=\"https://connect.soundcloud.com/examples/basic.html\">examples</a> and check out the <a href=\"https://developers.soundcloud.com/docs/javascript-sdk\">docs</a> to get started.</p> \n<p>We’re excited to see what apps you can build on top of this! And let us know your thoughts on how we can continue to improve our developer resources.</p>","descriptionType":"html","publishedDate":"Mon, 14 Nov 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/6c7832499ba160d91a482087ca6c54f3/96300/record-example.png","linkMd5":"8b9eea25fd3ee1fa7956b603676601f8","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn60@2020_4/2020/08/25/00-49-37-641_0090f9e908078b19.webp","destWidth":519,"destHeight":131,"sourceBytes":6563,"destBytes":8100,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/6c7832499ba160d91a482087ca6c54f3/96300/record-example.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn60@2020_4/2020/08/25/00-49-37-641_0090f9e908078b19.webp"},"publishedOrCreatedDate":1598316569984},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Velocity Conference 2011 – Europe","link":"https://developers.soundcloud.com/blog/velocity-conference-2011-europe","description":"<p>The venerable O’Reilly <a href=\"http://velocityconf.com/velocityeu\" title=\"Velocity Conference - EU\"><strong>Velocity Conference</strong></a> is coming to Berlin on the 8th and 9th of November. SoundCloud is doing what we can to help organize the speaker program and want YOU to speak.</p> \n<ul> \n <li>Have you turned an operations challenge into a opportunity?</li> \n <li>Does web performance matter to you, and you’ve done something to prove it?</li> \n <li>Do you transform your running systems raw data into meaty information?</li> \n</ul> \n<p>This is an amazing opportunity to share your world class experience with European peers!</p> \n<p>Achtung! The call for proposals ends <strong>August 9th</strong> so hurry to <a href=\"http://velocityconf.com/velocityeu/public/cfp/177\" title=\"Velocity call for proposals\">send your proposals in to the official website</a>.</p> \n<p><img src=\"http://farm1.static.flickr.com/40/85477841_b3f1452719_z_d.jpg\" alt=\"http://www.flickr.com/photos/givingkittensaway/85477841/\" title=\"Some rights reserved cc-by-sa by Ben Cumming\" /></p>","descriptionType":"html","publishedDate":"Fri, 29 Jul 2011 00:00:00 +0000","feedId":10291,"bgimg":"http://farm1.static.flickr.com/40/85477841_b3f1452719_z_d.jpg","linkMd5":"2005f19320d0eefb8b44b98b5648e4ec","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn18@2020_4/2020/08/25/00-49-37-442_c8df2f4a33b7fcb0.webp","destWidth":640,"destHeight":422,"sourceBytes":152117,"destBytes":64494,"author":"","articleImgCdnMap":{"http://farm1.static.flickr.com/40/85477841_b3f1452719_z_d.jpg":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn18@2020_4/2020/08/25/00-49-37-442_c8df2f4a33b7fcb0.webp"},"publishedOrCreatedDate":1598316569985},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"We ♥ OAuth 2","link":"https://developers.soundcloud.com/blog/we-love-oauth-2","description":"<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 124px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/360a07bb16fbdc974215f53bb3cbd201/03fde/oauth-2-logo.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 99.19354838709678%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAEgklEQVQ4y01UaSimXxR/zCQNIikJkX37k33f18bYsydrdlJkyYtCypKSKJR6bfmC7CkfUJSy1DAaI1knJXvy4X3fnnv+51zzTnPrdp/73HN+55zfWYSqqiphY2NDoDU6OvpJ+LOODg81pqenvw4MDEiGhoak3d3d0qysrMbg4OBv+KyplDMwMOA6c3NzHz9QgZ/9/f2f6Wxvb1e9ubmpPzs7uzw5OYH393dYW1uD9fV1/o3y0NjYeB0UFCRBcTXS8fT05LpLS0sfoHV1dfxHZWWlxcLCwsHj4yPs7OxAW1ubqFAo5JOTkwraACBHQPH5+Rnu7++hpqbmO6pZk66TkxPHENLT07nLjo6OFrOzs3cYGqAB2fX1tbi6uso6OzpYdnY2JCcnQ35+PhscHGQILEokEhlSAT09PQ+obkMYOjo6fylTbW1tPbi6uoL5+XkZcgnNzc3M1taW4RtTUVEBPGnzu7u7O+vs7ISVlRUZggPm4YcyfL5iY2PrNzc34fT0VLa7uwuhoaFcUVVVFczNzSEhIQHi4+PB3t4edHV1ObCenh779euE8GQUvouLS7MSTwPdvjw8PISDgwMxIiKCg+nr6xMwXFxcgHKRYlxcHBgZGXFQZ2dnhokS6a23t/c3/tMSCgoKvs7MzMDx8bEolUoZesDMzMzA2toaMNMcKDc3F2pra/k3ZZ7e7OzsQE1NjU1NTXFO9/b2wNDQMFZALiT7+/uwtbUlLy4uZsbGxgwTBFgKMDY2RpZBW1sbrKys4Pb2Fl5fX8HPzw9cXV2BZJEOhv/kZCwzM7NFGBkZkXZ1dVF4CixazhOSDhgO2NjYgIODA1kGSgKt5eVl7p2/vz+QYfIWDSgmJiagvr5+Qujr65NiNklZkZaWxoF8fHz49vDw4ErDw8Mc7OjoCAIDA8Hb2xvIOBkmby0tLRWmpqaUvEkBa62RBLCF5EVFRSwgIICREgFGR0fD9vY2B6MOoYxT6NglEB4eTmA8ZAxdTobLy8tbhfPz82+4iGCRHrGAGYFRNu/u7jjY5eUlIPmwuLgI2LPckK+vLxU7S01NZerq6iI5gTLxAsprIvK1pqYmmJiYiJQYfGQZGRnw8vICT09P8Pb2BqLIqwMeHh54XUZGRrKysjKGHosaGhrUhrf4rM0LEftUQl5paWnJKLuFhYUsKiqKJSUlAfFKm1qP7lTg6CFLSUlhlGmsABl5i8Oj5W+nILJaQ0PDdwsLC8qqjMJFrxmOKxYTE8Po/mczKnyKwM3NjTiVE68VFRU/EeMLB8PpwhsaubRGkAfiJywsTIblI+bk5DAMhSENgEOEA+IbQ6Mieifz8vICbNtnjPA/wsBq+BgOWEN89GC32DQ1Nf3AcHlJYKgieYGACqRBgUbkOHHEkJAQ6l2q3Z9YexwMp8/H+CotLeXn+Pj4Z2X4+N3c0dHxGycQYMiAMlBSUgIERHcM+xY5b8GTh5mXl8d1ExMTBQHHvIAecFCch5/+4VULh2wsTusWbL8J9GSyurq6FWXjMbvaSjksG66D3gsoI/wPcdL7huWXdxcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"oauth 2 logo\" title=\"oauth 2 logo\" src=\"https://developers.soundcloud.com/blog/static/360a07bb16fbdc974215f53bb3cbd201/03fde/oauth-2-logo.png\" srcset=\"/blog/static/360a07bb16fbdc974215f53bb3cbd201/03fde/oauth-2-logo.png 124w\" sizes=\"(max-width: 124px) 100vw, 124px\" loading=\"lazy\" /> </a> </span></p> \n<p>From today on, we advise developers to use <a href=\"http://oauth.net/2/\">OAuth 2</a> as preferred way of API authentication. Our implementation of the <a href=\"http://tools.ietf.org/html/draft-ietf-oauth-v2-10\">Draft 10 OAuth 2</a> specification is in production for several months months now and we made good experiences with it. Thus we move it from beta to official recommendation.</p> \n<p>OAuth 2 makes it easier for developers to implement authentication for accessing private resources. The feedback we got from external app developers and our in-house API users has been very positive. This is what <a href=\"https://github.com/stigi\">Ullrich</a>, one of the developers of the SoundCloud iPhone app and Cocoa wrapper, has to say about OAuth2:</p> \n<blockquote> \n <p>We love OAuth 2! It takes away the hassle from the previous version and leaves the awesomeness.</p> \n</blockquote> \n<p>You can see OAuth 2 in action in our <a href=\"https://soundcloud.com/apps/iphone\">iPhone</a> and <a href=\"https://soundcloud.com/apps/soundcloud-desktop\">Mac</a> apps.</p> \n<p>How to use OAuth 2 with SoundCloud is described in detail in our <a href=\"https://github.com/soundcloud/api/wiki/02.1-OAuth-2\">API wiki</a>. It is so easy to implement, that you might not even require a wrapper/library. But if you prefer to use one: the <a href=\"https://github.com/soundcloud/cocoa-api-wrapper/\">Cocoa</a> and <a href=\"https://github.com/mptre/php-soundcloud\">PHP</a> wrappers have full OAuth 2 support. The <a href=\"http://code.google.com/p/soundcloudapi-java/\">Java</a> one has partial support. And more wrappers are in development …</p>","descriptionType":"html","publishedDate":"Wed, 19 Jan 2011 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/360a07bb16fbdc974215f53bb3cbd201/03fde/oauth-2-logo.png","linkMd5":"66c588af0e7568182e2630435ccfe00d","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn78@2020_3/2020/08/25/00-49-39-057_2e82ae6c2f7abc5a.webp","destWidth":124,"destHeight":123,"sourceBytes":5456,"destBytes":5452,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/360a07bb16fbdc974215f53bb3cbd201/03fde/oauth-2-logo.png":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn78@2020_3/2020/08/25/00-49-39-057_2e82ae6c2f7abc5a.webp"},"publishedOrCreatedDate":1598316569987},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Building the new SoundCloud iOS application — Part II: Waveform rendering","link":"https://developers.soundcloud.com/blog/ios-waveform-rendering","description":"<p>When we rebuilt our iOS app, the player was the core focus. The interactive waveform was at the center of the design. It was important both that the player be fast and look good.</p> \n<h2>Initial implementation</h2> \n<p>We iterated on the waveform view until it was as responsive as possible. The initial implementation focused on replicating the design, which heavily used CoreGraphics. A single custom view calculates the current bar offset based on its time property. It then draws each of the waveform samples that are in the current visible section of the waveform. Each sample is either rendered as a filled rectangle for unplayed samples, or by adding clip paths to the context then drawing a linear <code class=\"language-text\">CGGradient</code> for the played samples.</p> \n<p>To handle progress updates, we used the callback block on <code class=\"language-text\">AVPlayer</code>:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\"> \n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span>player addPeriodicTimeObserverForInterval<span class=\"token punctuation\">:</span><span class=\"token function\">CMTimeMake</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span>\n                                     queue<span class=\"token punctuation\">:</span><span class=\"token function\">dispatch_get_main_queue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                                usingBlock<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">(</span>CMTime time<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span>waveformView setPlaybackTime<span class=\"token punctuation\">:</span><span class=\"token function\">CMTimeGetSeconds</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre> \n</div> \n<p>This generates 60 callbacks per second to try and achieve the highest possible frame rate. This solution worked perfectly during testing on the simulator. Unfortunately, testing on an iPhone 4 did not produce similar results:</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 620px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/a5ed1/waveform_rendering_cpu.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 68.2258064516129%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAADbUlEQVQ4y6WR3U9bdRjHT1yiJmKMUS96tSV6A5JtaqZX3voPzBMTb7wx3ojJhllCsEYWDMs02XAvvLQLY1KqIhMwQGl7zmlPWwotfW/pG+VAC6WW0a4tG3075/f1R7lZjFf6JJ88z/N9nnx/v+RhPnj9/VMrS9Mfef0rnyQTqY83NlJsKpVi4/E4G6MkkknW5XKzAi+wwUCIDYcjrN/vZ6PRKBuLxdl4InG8ezEWi326uLj4JtN57t03FudmMk6rgFAoiNWVFay53bQOwePxwE1ru1vEjPEhDOICLMsCjEvG1iyZTIIaIZFIoFAoQKvV9jKnz5xRTU8/3OTMPDiOl3leUAyGJcVudygczytUU3gLrwg2QTFbzIqZ5xSj0UR1TuEF4WTO83WPx4vBwUE181bnh6qB73XSyJAJ45NeZexnH5madRGXf514IxLxUQLRbRJO7JJIMkvWN/ZIdDNHc5aEEjtU2yXBeKaR+auCyV+mvmFeefW06rPPx6Suy3+i6+t55Yuv5vHdwO+4dKUHX17qQdflHlzpvYrevmv4tv9H9A3cQP/1W+AcQbjDaSyJXmKwepsWZwgPdL+pmQsX3lP19WukH27+inGdUbk/Yca8wQrRsQJBdMJic0KwLoOzLIO3OsAJdpgFGyJxCVImj42tLElt7zX3i4eY0OnVTPvbHarxBxPSzOwcrDabYuIFuNyr8Pkd8PmsCAREeH0iPF6RHspGddp7BWxKMRwUynh0UCT7B8WmTIDZ2Tk18/ypF1WiuCxJW2lE1uPKzm4O29sZpNMSstkMcrksveA+ipST/KiVHz8uolwuo1Qqk1Kp1ASNhYUFNdPR0akycXbJtRZGMJJS1uNbyOULKJUPKU9QKJbx9KiGaq2Bo+qz1Cm1YwidtwyNJrOaOXvurMrmcEv+UALRZFrZyRVJqVI9XiKNpkLKlSfkqNYgdVrXG/IzKCcapdaQW4a8YFEz5985r7KIztTqGr2aL9LYTOfl0mFVrhw+lamRTH8qU3O5Wm/K9Jf/Ct2rHRuaOb6XaW9vVwXCyXyx0sBevoxq663/Fja74yrT1tb22rXrN27eHtJM3bo7OvnTnRH93aFR/fDwsF6j1eqHR0b0oxqNXqu9R/t7rfxPNBqtbuz++B/d3d0XGRrPUV6ivPw/aaO88DclODbMti3V8wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"CPU rendering instruments profile\" title=\"CPU rendering instruments profile\" src=\"https://developers.soundcloud.com/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/a5ed1/waveform_rendering_cpu.png\" srcset=\"/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/9ec3c/waveform_rendering_cpu.png 200w,\n/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/c7805/waveform_rendering_cpu.png 400w,\n/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/a5ed1/waveform_rendering_cpu.png 620w\" sizes=\"(max-width: 620px) 100vw, 620px\" loading=\"lazy\" /> </a> </span></p> \n<p>The preceding trace displays an initial frame rate of 17 FPS that drops to 10 FPS over time. As time progresses, there are more played waveform samples, which are expensive gradient fills and take more CPU time than unplayed samples. The CPU profiler displays that 90% of CPU time is spent in the <code class=\"language-text\">drawRect:</code> method of our waveform view.</p> \n<h2>Reducing waveform renders</h2> \n<p>We needed a new approach that did not require redrawing the entire waveform 60 times a second. The waveform samples never need to change in size, but only in tint color. This makes it possible to render the waveform once, and apply it as an alpha mask to a layer filled with a gradient on the left half, and white on the right half.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 620px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/2d22fc1fcea6920ee8508b5de7306304/a5ed1/waveform_rendering_mask.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 54.677419354838705%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACeElEQVQoz12Tz0tUURTH38gNKkLrD7BMKw1KM6uVumkRFVlNb3xjkwYamdnM2GiiUYtaZFAxv5pRQgi0cSG1U6ISsnIxGQwWmAX2axYSBtWgOMbk+3Tf00S98OF7zr2cL4d7z1VoFOhLoEkweX4emlaheyxwOQP9xzjGSvz+RTKZJJVKMT09zcqlzF0QzDmlmeSvjHEJXqmCN5ogXm3kFhLOdXweHmA49pZw6C7j4+OMjY0xOTlpmkxNTTExMUF/fz8KdbLI4NyC1guixwXd+wUvjwpiVgsD6noe93Zxtq6e1pYWenp6iEQiDA4OEovF8Pv9BAIBXC4XysgxwTvJ6yPS4JDsrEzQVSpQNwsu5QuuFijcLNmA+8wprDaNmupqKisraW5upqGhgba2NlpbW6mtrTX3FWeeoCpHUClxZAtO58zn5VmCE5sE9qw0HFvXoJUdxH7SgVZejqZpi9hsNhwOBxUVFaYqmiyyZsriFdg2zqNmpqFmrUY9fAC1XENV1WUYhoZarVbsdjtK4xaBW3bUsAQjdy2oOzsNd+4a3DVVuC565D05zbv6j9vtNnE6nXg8HhT/dsGdvOV4JUG5b5z589Lw56/Ff/0KwfYOAvIBgsGg+QgGPp9vMQ6FQijPCwXPdgmeFAj68uf10Q7Bbdl5OFdwb5uF+4XptN+4xi2vj2DAj9frJRwOmwadnZ10dHQsmiuUyFExKF5Axh+KBC92CkalxossfCzOYORpH5Heh0QedDM0NEQ0GmV0dJR4PG7mxggZo6Toe+VQL4F9gu+y45+7BSkj32NBL03nz6f3JHX49vWL+VNmZmaYnZ1d/CG6rpNIJPgHgFEOs9xpvk4AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Waveform mask with background colors\" title=\"Waveform mask with background colors\" src=\"https://developers.soundcloud.com/blog/static/2d22fc1fcea6920ee8508b5de7306304/a5ed1/waveform_rendering_mask.png\" srcset=\"/blog/static/2d22fc1fcea6920ee8508b5de7306304/9ec3c/waveform_rendering_mask.png 200w,\n/blog/static/2d22fc1fcea6920ee8508b5de7306304/c7805/waveform_rendering_mask.png 400w,\n/blog/static/2d22fc1fcea6920ee8508b5de7306304/a5ed1/waveform_rendering_mask.png 620w\" sizes=\"(max-width: 620px) 100vw, 620px\" loading=\"lazy\" /> </a> </span></p> \n<p>This increases the FPS to the maximum of 60 with approximately 50% GPU usage. The CPU usage dropped to approximately 10%.</p> \n<h2>Using system animations</h2> \n<p>We can now stop using the <code class=\"language-text\">AVPlayer</code> timer callback for waveform progress and use a standard <code class=\"language-text\">UIView</code> animation instead:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\"> \n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token punctuation\">[</span>UIView animateWithDuration<span class=\"token punctuation\">:</span><span class=\"token function\">CMTimeGetSeconds</span><span class=\"token punctuation\">(</span>player<span class=\"token punctuation\">.</span>currentItem<span class=\"token punctuation\">.</span>duration<span class=\"token punctuation\">)</span>\n                      delay<span class=\"token punctuation\">:</span><span class=\"token number\">0</span>\n                    options<span class=\"token punctuation\">:</span>UIViewAnimationOptionCurveLinear\n                 animations<span class=\"token punctuation\">:</span><span class=\"token operator\">^</span><span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>waveformView<span class=\"token punctuation\">.</span>progress <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                completion<span class=\"token punctuation\">:</span>nil<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre> \n</div> \n<p>This drops CPU usage down to approximately 0%, without noticeably increasing the GPU usage. This would seem to be an obvious win, unfortunately it introduces some visual glitches. Watching the animation on longer tracks shows an amplitude phasing effect on the waveform samples.</p> \n<table> \n <thead> \n  <tr> \n   <th>Pixel-aligned waveform rendering</th> \n   <th>Interpolated waveform rendering</th> \n  </tr> \n </thead> \n <tbody> \n  <tr> \n   <td><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 300px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/c2c3d7ad79a9249aa3e68e90dfb478dc/135ae/waveform_rendering_sharp.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 113.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsSAAALEgHS3X78AAAD/UlEQVQ4y32U62/bVBjG/Y8hhLpJgBiIAYKOaUhcduED4hsSIAErSEggLqPQ9bKubdrl3jZJL861aW5tEsdJmqxZm5sd23GcNOklbdJui1/e462M7sOko6PX9vmd57H9noey5RsW/pGVO7Hld8wVeG6YTgvL2csngwqsOR0PJFu+5U2EDVUw873TZyoOq/B0nZ6DRQl8Cuh5cMowL4KRB2pt1RiMLFm4h+GQzb7dMApg4R+bedUsgKEC/jrM4h0BbCIE68AfAW6HWzgk4gVhE8LoJ+abZDxjBgmMYs8sqK50xlzqrijgqYFbhuwe3N8D7gjmBHDJEGoAPiLKgTV6vtBKuIaS9J8Ie9moY0v2MWFPPBQUD3x1YFvAHUJuH0qHQFch0oBEixih1lcN/qgnHJzdnP8u7hm28CdZ+0A4aI35dMHAXETaR+epXVXsQLUDhTYRLLYhuQvhBlChsGNz7hth8j1x4p2s/WbMO5F1DKwFTPft36+7Rth6R+hA/kDFWenCdpu4qHWJBQJHgrP8VL889qp4921u+oo0/lbB+Hlu7uvc/LdbM1cTzV7rIS5VhSPCFA8BC1mDt/aBKuqvFfWfVcdeFycuFg3XayN9wsS7RcMN6e5Fbqq/KEsKwm2i/ASWOgRG59UuUNU7bxQM1+VRolzUX62NnK9MXSrf+1gZfqWsu8xLJeURwr3/YPEsfOEsfK4y9UGJwH2c7kNOKj8Hn1Uef7NguCGPvUZs66/VRs9XdP2le58oo+c43WVO4l4Eo2ZR/2ltuE8av0AEb7+M71yeuVIfeomffB9t1x9Dud1Dt8ox+U7I1LRCPgYKRfBXlac/wq+FHxmt5k1fPLB+xesubZm/3BYFvovtoebbT/sENcuHsKk1DMU6B6MrM9hb2GFR33Rq+XfGPYqtmlr6Le65Exd3UvsQ21GZFrYKRHfIf05qBc7UxsLPjHsk4/gxvfgL4xrO2m6mlv9IOIeyth/Y5Vus2MgeQKKpIontzTQhvQsZrdjY0+C4ZxxnTWos4/gpSd8iu9gHEvQgKyiZA1yqJjUm3iT6G1pB4FDIztJ/EeWlXxOu26jMOv+OeSfRDkMPrstHm21gWs/gtAYzmnnKnUqEg/OMe5h1/hMJWP1RPx5Sf9QXDtlXIs4V+STegvUdIohwrAmBOoGx8NaA8jEReiODYRIML+HZxDDwJqILOc6dStLpjFs4WpbJ6UMYjyFuhHkSqpMt3Ah7mYibZTA3VuIhD8sYRRJApkrPsa1YysdOWV2QCLBaJwGAVjFYliSgZcD7lCuVXsgJs+Uund0yCfAswAQSd5g+Fi33cDi0DMNisUq2IBmGuUmW8j0Ld/I/+DQ9+Rdd/gtroWNMv8niMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Waveform on pixel boundary\" title=\"Waveform on pixel boundary\" src=\"https://developers.soundcloud.com/blog/static/c2c3d7ad79a9249aa3e68e90dfb478dc/135ae/waveform_rendering_sharp.png\" srcset=\"/blog/static/c2c3d7ad79a9249aa3e68e90dfb478dc/9ec3c/waveform_rendering_sharp.png 200w,\n/blog/static/c2c3d7ad79a9249aa3e68e90dfb478dc/135ae/waveform_rendering_sharp.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" loading=\"lazy\" /> </a> </span></td> \n   <td><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 300px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/98f12e069c62b0789db0caa8b12b97ff/135ae/waveform_rendering_blurred.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 113.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAIAAACEf/j0AAAACXBIWXMAAAsSAAALEgHS3X78AAADzklEQVQ4y4WU2W8bVRTG/bchEFUogrJUvLQCRFsBz5VaXioEpVAkaKkEpNnbtN5t4n2364mdTOzxmtWN15nx2EntxLHjFjfx4buTRk3gAelq9N2Z8zvfmTtzjmbuactUeWmqDGyFZ8Ya/WsZjoXp9PZoaSJ82LlSsha7oSSnk8lYHR4/gxiaxVdxuio5ZAo3SVslT51sEumrpIlz1hj3F1LGOYut0NSLZKoeGKuHRpF0NYo0yYo7Is1JFN2i2j5ZRAo0WCLmHFNhvUSJ4GTSPwZzg3hokMiXy5uKPVj5FRad26GVXRL3WS44x7ZZFcx5PmazlPfTnnsZ9x1tnQIp3rbRCAnxIB/hpG6gSek2lbq0ukvVHrnrFN9md7gtwFFzdNHDLbg3zFeTgVFj7WDZ9l2cM/IRbSyij8l74S3YDoHV+1Tusio2u6yQecDcgmfN+k1l9kJ94uzK3Ld8eHZl7sbCE33e+WPCdTfZfF7rU7E7rPSo+QKCEi0mkIvBqLk2c16aOqeMj1RmL4rTH5Uef7FuubbsuLn58EJi+6A1QCiDG8+Z85HAdb1DmqLuy/KjT8XpD+sT7xR1V+BfnxjZ1H9Ve/AJbj5Vms0BQo/hHtVUgSOQ9kmjjJ+B1ZFzUXtZnjgrT50raS817r8lzpwv16XGSeceK/gIFlV45CQMZ3nyPcDK2Blx5uPSf+DaKXgC8CVp+gMFZWuv1CfflafeL2kvoyI4/w/cuP8m3hnVos7S48+Vsbfx8uVHnzVG30A5KLv5EgD7VDhkpAADgZOT+qQBuWa5hqMCsGa9Dh7Fr1mul2cvbuq/Xq83Kn0qdIYbe4zc6FBh79VR42tr0p7f+NADwfcH/jA+/DDlvZfy/Q6R9txN+kd5eSezi287XGpRpk24JlTBPyOhRZq8/QfB92fW+bMqRnOOWznnbYi87fuM6xdBbi93KN0aptq0vEO4plUBMttW4YR/DHE5x0+JwHjWeRuJ0CF5+0386oLcynco1RoKbcqDaTMeIqn64w9zpt13AMATxefst7BdCs0kglMp969xpb+6B+A1nD6RRePNZmKcBaFg0CThRHQxoossBrm468m8I6QM8J5YwrEhOpyJNgUbpAmklsDbCluxeVt0wY3GDgq8Y63iz2S86axP7LsU1gPwEdQUdpk1I5ZfhfmgsIjuh2dASADG9DGIQ0wVc6nvVYaIdsrMEEB2h00SbL0KGyYoe9m1WsIA9OTXDSK9HmAiG3eYPiZ17hmqZJfY9IAGhnnCZpi5MmCh1UNz5e/Tw5FNQjAnx6X+9PYfln9i8+rEZaoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Waveform inbetween pixels\" title=\"Waveform inbetween pixels\" src=\"https://developers.soundcloud.com/blog/static/98f12e069c62b0789db0caa8b12b97ff/135ae/waveform_rendering_blurred.png\" srcset=\"/blog/static/98f12e069c62b0789db0caa8b12b97ff/9ec3c/waveform_rendering_blurred.png 200w,\n/blog/static/98f12e069c62b0789db0caa8b12b97ff/135ae/waveform_rendering_blurred.png 300w\" sizes=\"(max-width: 300px) 100vw, 300px\" loading=\"lazy\" /> </a> </span></td> \n  </tr> \n </tbody> \n</table> \n<p>While the mask is animated across the waveform view, the animation will not only be drawn at integer pixel positions. When the mask is at a fractional pixel position, it causes the edges of the mask to be interpolated across each of the neighboring pixels. This reduces the alpha of the mask at the edge of each sample. This lower alpha reduces the amplitude of the visible waveform samples. The overall effect is that as the mask is translated across the view, the waveform samples animate between a sharp dark state and a lighter blurry state.</p> \n<p>We need a way to tell CoreAnimation to only move the mask to pixel-aligned positions. This is possible by using a keyframe animation that is set to discrete calculation mode, which does not interpolate between each keyframe.</p> \n<p>A high-level API was added for keyframe animations in iOS7, but the CoreAnimation interface in this case is a bit clearer:</p> \n<div class=\"gatsby-highlight\" data-language=\"objectivec\"> \n <pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>CAAnimation <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>keyframeAnimationFrom<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span>CGFloat<span class=\"token punctuation\">)</span>start to<span class=\"token punctuation\">:</span><span class=\"token punctuation\">(</span>CGFloat<span class=\"token punctuation\">)</span>end\n<span class=\"token punctuation\">{</span>\n    CAKeyframeAnimation <span class=\"token operator\">*</span>animation <span class=\"token operator\">=</span>\n    \t<span class=\"token punctuation\">[</span>CAKeyframeAnimation animationWithKeyPath<span class=\"token punctuation\">:</span><span class=\"token string\">@\"position.x\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    CGFloat scale <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>UIScreen mainScreen<span class=\"token punctuation\">]</span> scale<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    CGFloat increment <span class=\"token operator\">=</span> <span class=\"token function\">copysign</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> end <span class=\"token operator\">-</span> start<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> scale<span class=\"token punctuation\">;</span>\n    NSUInteger numberOfSteps <span class=\"token operator\">=</span> <span class=\"token function\">ABS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>end <span class=\"token operator\">-</span> start<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> increment<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    NSMutableArray <span class=\"token operator\">*</span>positions <span class=\"token operator\">=</span>\n    \t<span class=\"token punctuation\">[</span>NSMutableArray arrayWithCapacity<span class=\"token punctuation\">:</span>numberOfSteps<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>NSUInteger i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> numberOfSteps<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">[</span>positions addObject<span class=\"token punctuation\">:</span><span class=\"token operator\">@</span><span class=\"token punctuation\">(</span>start <span class=\"token operator\">+</span> i <span class=\"token operator\">*</span> increment<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    animation<span class=\"token punctuation\">.</span>values <span class=\"token operator\">=</span> positions<span class=\"token punctuation\">;</span>\n    animation<span class=\"token punctuation\">.</span>calculationMode <span class=\"token operator\">=</span> kCAAnimationDiscrete<span class=\"token punctuation\">;</span>\n    animation<span class=\"token punctuation\">.</span>removedOnCompletion <span class=\"token operator\">=</span> YES<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> animation<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre> \n</div> \n<p>Adding this animation to the mask layer produces the same animation, but only at pixel-aligned positions. This has a performance benefit; animating longer tracks produces animations with the FPS reduced to the maximum possible FPS for the number of animation keyframes, which reduces the device utilization accordingly. In this case, the distance of waveform animation is 680 pixels. If the played track is 10 minutes long, the FPS is 680 animation pixels over 600 seconds ≈ 1 pixel position per second. CoreAnimation schedules the animation frames intelligently, so that we only get a 1 FPS animation with correspondingly reduced 1% device utilization.</p> \n<h2>Increasing up-front cost for cheaper animations</h2> \n<p>The CPU performance is at an acceptable level, but 50% GPU usage is still high. Most of this is due to the high cost of masking, which requires a texture blend on the GPU. As we fetch a waveforms samples asynchronously for each track, initial render time for the view is less important than performance during playback. Instead of masking the waveform samples, they can be drawn twice: once in the unplayed state, once in the played state with gradient applied. That way, each waveform is contained in separate views that clip their subviews. To adjust the waveform position within these windows, the bounds origin can be adjusted for each subview to slide over its content, similar to how a <code class=\"language-text\">UIScrollView</code> works.</p> \n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 580px;\"> <a class=\"gatsby-resp-image-link\" href=\"https://developers.soundcloud.com/blog/static/5f083ab7c0db99633e5ab91acc120e20/54e54/waveform_rendering_clip.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\"> <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 72.41379310344827%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACqElEQVQoz4WSy08TURTG+W+MiUZ0SWLihriUBawUFkCicYELCQbxEUkgJBAQH00Ij9J5z/QNrZSSSB/TlloHC5RKEen0DjQqlhY6fU474+1QjHGh3z2Lu/h+ueee8zXIsuzz+VAUpWma+qdIktTr9ZlMWlYUSapANfwPJtUDRRMEwTDMcea0Wi5I5ZL0F0zWRalFUgRRv+AYg+tIHNMbTcdJvrqzUsqLNVhRFJZlEQRRG6u5GRwxo1M0gZEUbcDmVjX9zulhu3bcTKEeekpcHFH0faWDnYIk/4Z1DOwM0ozBhE673j6yzU3YZl+y4w/ifU3hF23c89b1wdsxbCS3pClZR3OJz2KxXId1CEoaTGefXJydjPXf3H5ya+tZ69eHN4SeJvC0BYzdFTS9wqrlZC8iRtayP79nxVyDIstenx/XTrteDQSHOrcGWmK9zQf3rh52NwqdjaDjCsAmBM87Yc0FPgYEzn+yty3yu6epo6wo1mBPIGjQjApdl4WOC0L7ReHOpUT7Nb7revx+8/7DloTHASLriXAQbHwQtkKnwpfc4a6YPsoXihCuugPBhckh0NO8/7gtPtzNv+6NawcT1FjC8oZf1oJPnoNNPwizPOfmOU82vlkAkXwmpcKK7GZ9FnQWLM3sryB7TiTqQHnn/O6SNryg3bTO8G7jhssWcC447VbP+5WTH8ly+luxWCiWSrWBeVkWRxGHgVikMT2JWyjMa5y30hhDEgaKsDGYkcbhHuAaTSbzcTpTqVbL5bIkSefT1ukIGAq1GLpWpLp0HCd0KAZ3oUOQsyCl02mYK0nNZz1hMCTQT+A4hqGI6oMstJrNJueyw+v1chwXi8WSySR8s3KuGuz3+3EcNxqNdrvd7XaHQqFoNAoASKVS+XwePgI9yrkqf+gXtqpwYEt+CTcAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span> <img class=\"gatsby-resp-image-image\" alt=\"Clip view hierarchy\" title=\"Clip view hierarchy\" src=\"https://developers.soundcloud.com/blog/static/5f083ab7c0db99633e5ab91acc120e20/54e54/waveform_rendering_clip.png\" srcset=\"/blog/static/5f083ab7c0db99633e5ab91acc120e20/9ec3c/waveform_rendering_clip.png 200w,\n/blog/static/5f083ab7c0db99633e5ab91acc120e20/c7805/waveform_rendering_clip.png 400w,\n/blog/static/5f083ab7c0db99633e5ab91acc120e20/54e54/waveform_rendering_clip.png 580w\" sizes=\"(max-width: 580px) 100vw, 580px\" loading=\"lazy\" /> </a> </span></p> \n<p>You can offset the bounds origin of the left clip view by its width. The result is a seamless view that looks exactly the same as the masking effect. Because we are only moving views around in the hierarchy, redrawing does not need to occur and the same keyframe animations can be applied to each of the clip views. After applying these changes, the GPU utilization drops to less than 20% for 60 FPS animation. This was considered fast enough, and is our final iteration of the waveform renderer.</p> \n<h2>Conclusion</h2> \n<p>Understanding the performance cost of drawing techniques on iOS can be tricky. The best way to achieve acceptable performance is to start simple, profile often, and iterate until you hit your target. We significantly improved performance by profiling and identifying the bottleneck at each step, and most of the drawing code from our initial naïve implementation survived to the final performant iteration.</p> \n<p>We obtained the biggest win by shifting work from the CPU to the GPU. Any CoreGraphics drawing done using <code class=\"language-text\">drawRect:</code> uses the CPU to fill the layers contents. This is often unavoidable, but if the content seldom changes, the layer contents can be cached and manipulated by CoreAnimation on the GPU. After the drawing reduces to manipulating <code class=\"language-text\">UIView</code> properties, nearly all of the work can be performed using animations, thereby reducing the amount of CPU view state updates.</p> \n<p>It is important to consider GPU usage, but this is harder to understand intuitively. Profiling with Instruments provides helpful insight, especially the OpenGL ES Driver template, which shows animation FPS and the percentage utilization of the GPU. The main tricks here are to reduce blending and masking, ideally using opaque layers wherever possible. The simulator option “Color Blended Layers” can be useful to identify where you have unnecessary overdraw. For more details see the <a href=\"https://developer.apple.com/library/mac/documentation/developertools/conceptual/instrumentsuserguide/MeasuringGraphicsPerformanceinYouriOSDevice/MeasuringGraphicsPerformanceinYouriOSDevice.html\">Apple documentation</a> and WWDC videos.</p>","descriptionType":"html","publishedDate":"Mon, 15 Sep 2014 00:00:00 +0000","feedId":10291,"bgimg":"https://developers.soundcloud.com/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/a5ed1/waveform_rendering_cpu.png","linkMd5":"8e813ef74b6373575f09190520cbac28","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn43@2020_3/2020/08/25/00-49-37-193_4690647b36b4ec80.webp","destWidth":620,"destHeight":423,"sourceBytes":32297,"destBytes":28404,"author":"","articleImgCdnMap":{"https://developers.soundcloud.com/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/a5ed1/waveform_rendering_cpu.png":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn43@2020_3/2020/08/25/00-49-37-193_4690647b36b4ec80.webp","https://developers.soundcloud.com/blog/static/2d22fc1fcea6920ee8508b5de7306304/a5ed1/waveform_rendering_mask.png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn50@2020_4/2020/08/25/00-51-45-353_aa2f6abc4674ae1b.webp","https://developers.soundcloud.com/blog/static/c2c3d7ad79a9249aa3e68e90dfb478dc/135ae/waveform_rendering_sharp.png":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn5@2020_6/2020/08/25/00-51-42-975_5d49a0a501475e8e.webp","https://developers.soundcloud.com/blog/static/98f12e069c62b0789db0caa8b12b97ff/135ae/waveform_rendering_blurred.png":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn61@2020_3/2020/08/25/00-51-41-941_3163f3301590e77a.webp","https://developers.soundcloud.com/blog/static/5f083ab7c0db99633e5ab91acc120e20/54e54/waveform_rendering_clip.png":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn31@2020_3/2020/08/25/00-51-40-335_0349cacda6b49344.webp"},"publishedOrCreatedDate":1598316569992},{"createdTime":"2020-08-25 08:49:29","updatedTime":"2020-08-25 08:49:29","title":"Insights from SoundCloud’s DeveloperBridge Trainee Program","link":"https://developers.soundcloud.com/blog/insights-from-the-developerbridge-programme","description":"<p>Back in 2016, the SoundCloud People Team collaborated with engineering management in an effort to bring more junior engineers into the company. The result was DeveloperBridge, a paid junior engineering program that ran for 12 months and was based out of our Berlin headquarters.</p> \n<p>Trainees gained hands-on experience under the guidance of our engineers, and by working on a variety of assignments in selected teams, they became familiar with different types of engineering tasks and technologies. This, in turn, helped them develop a feel for the areas they enjoyed working in the most. The overall aim of the program was to help the participants develop and then hire them afterward into full-time roles at SoundCloud, while improving diversity in Engineering at the same time.</p> \n<p>Now with their traineeship year coming to a close, we’ve asked the participants to reflect on the experience, what they learned, how they feel about their accomplishments, and where they see themselves headed next in their careers as software engineers.</p> \n<h2>Suzanne Wood</h2> \n<p>The DeveloperBridge program exposed me to different teams so I could both improve my programming skills and learn more about how SoundCloud enables users to share and discover music. I learned new programming languages and developed confidence in my ability to pick up more.</p> \n<p>Over the course of the year, I worked on web development and data processing projects. I created features for and improved the UX of an internal web app using React, Typescript, and JavaScript, and I made a web service using Ruby, JavaScript, Mustache, and regular expressions. I also created ETL (Extract, Transform, Load) processes using different methods to determine which was the most efficient, and I used Spark and SQL together with the Tableau analytics platform to enable the flexible display of data.</p> \n<p>During the program, I also learned new approaches to tackling problems. For example, it is good to make small iterative changes to code, because if you make too many changes at once, errors can become blockers. Through collaboration, we shared ideas and approaches, leading to a more maintainable and consistent codebase. I also really like the hardworking yet relaxed office atmosphere — especially the office dogs!</p> \n<p>I now have a feel for what programming is really about: It is abstract and creative, and it requires a lot of thought to design a system well. This appeals to me, so I will continue to pursue it as a career. In particular, I’d like to continue with frontend or full-stack web development roles — I like delivering something tangible that people can use and appreciate, with clear and consistent designs.</p> \n<p><em>Suzie has accepted a full-time position on the SoundCloud Payments Team.</em></p> \n<p>Find Suzie on the web <a href=\"https://www.linkedin.com/in/suzanne-wood-03\">here</a>.</p> \n<h2>Mike Smith</h2> \n<p>Some things about joining SoundCloud for the DeveloperBridge program met my expectations (ping pong tables! bean bags!), but many didn’t. I didn’t anticipate how much work goes into doing seemingly simple things. I had expected something more structured, but the refreshing reality was that I had the opportunity to pursue what I was interested in and motivated by, and I was allowed to develop at my own pace, which suits my working style completely.</p> \n<p>At first, Scala was a challenge. But the support I got and the freedom I was afforded led me to be surprised on a daily basis about how much I can understand.</p> \n<p>The people I worked with had years of experience, and they were well-versed in being productive in technology. Observing their behaviors and attitudes gave me insight into what it takes to work at a high level — something that is difficult to teach. I also found I learned most from those with more diverse backgrounds — who could sympathize with being the “odd one out” on the team — as opposed to the people who were the best technical coders. If the company is to continue developing junior talent, fostering diversity must be a key aspect.</p> \n<p>Extensive experience with the React/Redux/Typescript/Webpack stack has put me in the position where I’m able to advise other people on these technologies, allowing me to, in some way, pay forward all the help I’ve had from other people along the way. I now consider myself a professional software engineer, which is something I would not have believed a year ago. I’d love to continue developing my skills and eventually use my experience to teach others who want to take the same path I did.</p> \n<p><em>Mike has accepted a full-time position on the SoundCloud Core Clients Team.</em></p> \n<p>Find Mike on the web <a href=\"https://www.linkedin.com/in/entering-mike-smith-zone\">here</a>.</p> \n<h2>Lucy Clarke</h2> \n<p>A few people I knew who worked at SoundCloud told me I would be working with some of the kindest and smartest people they knew — and they were right. I was super excited about the position, having come from a music industry background and having used SoundCloud as a music discovery tool for years.</p> \n<p>For most of the year, I have been working on an RSS service for podcasters. This service is built in Scala and replaces an older service that was written in Clojure. I had no previous experience with Scala and had zero exposure to lisp languages. But along the way, I became competent in Scala and was able to work my way through Clojure code. Podcasting is a segment I care a lot about, and I am proud of the work I did on a useful service for podcasters that serves a lot of traffic.</p> \n<p>As the RSS service for podcasters was essentially a new project, I was able to be involved with all aspects of building the service — from coding, to integration with CI, Docker, and Kubernetes, to alerting monitoring and scaling traffic between the old and the new service for fast feedback. As the previous service had not been touched in some time, we were also able to reconsider previous decisions around logic. I know more about podcasting, XML, aggregators, and iTunes than I thought possible.</p> \n<p>Surprisingly, my pun game also really improved.</p> \n<p>I want to continue to develop my skills as a backend engineer. I would love to keep working on products that enable audio creators to do their best work.</p> \n<p><em>Lucy has accepted a full-time position on the SoundCloud Royalties and Reporting Team.</em></p> \n<p>Find Lucy on the web <a href=\"http://linkedin.com/in/llcclarke\">here</a>.</p> \n<h2>Thea Kupler</h2> \n<p>My “Rails Girls Summer of Code” placement was hosted by SoundCloud, and this was followed by an internship with SoundCloud, so I was already familiar with the company infrastructure and culture, and I was excited to have found an environment in which I felt comfortable and supported.</p> \n<p>I worked on several teams and on several projects during the program. I worked on building a web app to view and compare event data stored in Hadoop, rewrote Java components in Scala, added functionality to a React frontend, and contributed to a Ruby web app. For my final project, I am contributing to a web app written in Clojure. My work includes generating folders and files, zipping everything up, and pushing it to GitHub automatically. This also reminds me of another a thing I have learned and will always still be learning: git, git, and git.</p> \n<p>I am proud of everything I accomplished. I took the opportunity to give demos in front of the company. I got the support to share and celebrate my pride and work.</p> \n<p>I gained confidence in what I am capable of, which helps me focus on learning, improving, and tackling new challenges, rather than wasting my energy on feeling like an imposter. I still remember the moment when I suddenly started explaining and defending my code choices rather than just silently implementing what I was told to do differently.</p> \n<p>I’d love to shift my focus more toward backend web development — either building up the knowledge I already have, or learning something completely new, especially working for a non-profit organization or one in the field of sustainability. Long term, I want to foster my passions in a more balanced way: less coding and hacking, more coaching and healing.</p> \n<p><em>After 18 months of self-led training through internships and this program, Thea has chosen to leave SoundCloud to take some time to pursue other personal and professional options.</em></p> \n<p>Find Thea on the web <a href=\"http://www.linkedin.com/in/thea-kupler\">here</a> and <a href=\"https://twitter.com/froilainhaeckse\">here</a>.</p> \n<h2>Marina Mircheska</h2> \n<p>I saw the program as a perfect start to my career in this industry. My interests as a Computer Science major were scattered across a few areas, and I was delighted to have the opportunity to find out what fit best. Moreover, this was about to happen in a very cool Berlin startup with an international team of specialists.</p> \n<p>For the better part of this past year, I worked on deep learning for content-based music recommendations. Deep learning is a hot topic, and I got an exciting chance to work with real data and have all the computational power I need.</p> \n<p>The DeveloperBridge program was my first opportunity to apply an abstract concept from textbooks and research papers to real data, and the challenges I faced — surprisingly — were not only on the theoretical side. It took some long thinking about design and optimization, experimenting and testing every step and decision while laying the infrastructure of the project. It took a while before training the neural network and getting initial results, and then a different kind of challenge arose: how to debug a machine learning algorithm.</p> \n<p>I also worked on a real-time recommendation service, thereby improving my Go skills; built Tableau dashboards for analytics purposes; wrote ETLs using Scala and Spark; and did some exploratory data analysis using Python Notebooks.</p> \n<p>Furthermore, I learned how to be part of team meetings and participate in discussions efficiently, while at the same time keeping communication healthy, fair, and respectful. My supervisors and my mentors set an example for patience, generous teaching, and efficient collaboration, and because of that, I will definitely be a better team player in the future.</p> \n<p>During my master’s degree, I focused on Data Science and Algorithmics, and my time at SoundCloud helped me gain the experience of a junior data scientist. Considering my interests, I will try to build myself as a Machine Learning Engineer in the coming years.</p> \n<p><em>Marina has accepted a full-time position on the SoundCloud Discovery Team as a data scientist.</em></p> \n<p>Find Marina on the web <a href=\"https://www.linkedin.com/in/marina-mircheska\">here</a>.</p>","descriptionType":"html","publishedDate":"Thu, 18 Jan 2018 00:00:00 +0000","feedId":10291,"bgimg":"","linkMd5":"49a8720872bb0d6589c5afc67fad8fba","bgimgJsdelivr":"","metaImg":"","author":"","publishedOrCreatedDate":1598316569975}],"record":{"createdTime":"2020-08-25 08:49:30","updatedTime":"2020-08-25 08:49:30","feedId":10291,"fetchDate":"Tue, 25 Aug 2020 00:49:30 +0000","fetchMs":235,"handleMs":1316,"totalMs":259898,"newArticles":0,"totalArticles":166,"status":1,"type":0,"ip":"52.30.217.135","hostName":"europe-59.herokuapp.com","requestId":"0d174ef269374b6bb24844e9b6be6115_10291","contentType":"application/rss+xml","totalBytes":8444833,"bgimgsTotal":86,"bgimgsGithubTotal":85,"articlesImgsTotal":248,"articlesImgsGithubTotal":221,"successGithubMap":{"myreaderx8":9,"myreaderx14":8,"myreaderx7":6,"myreaderx15":7,"myreaderx6":8,"myreaderx16":6,"myreaderx32":9,"myreaderx10":9,"myreaderx4":7,"myreaderx11":9,"myreaderx33":5,"myreaderx3":8,"myreaderx12":8,"myreaderx2":9,"myreaderx13":8,"myreaderx1":8,"myreaderx30":7,"myreaderx31":6,"myreaderx18":8,"myreaderx19":7,"myreaderx":8,"myreaderx25":8,"myreaderx27":5,"myreaderx21":6,"myreaderx22":9,"myreaderx23":8,"myreaderx24":7,"myreaderx5oss":9,"myreaderx29":8},"failGithubMap":{}},"feed":{"createdTime":"2020-08-25 04:35:47","updatedTime":"2020-08-25 04:35:47","id":10291,"name":"SoundCloud Backstage Blog","url":"https://developers.soundcloud.com/blog.rss","subscriber":null,"website":null,"icon":"https://developers.soundcloud.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx62/cdn47@2020_4/2020/08/25/00-49-29-087_626efa89e23a3672.ico","description":"SoundCloud's developer blog.","weekly":null,"link":"https://developers.soundcloud.com"},"noPictureArticleList":[{"createdTime":"2020-08-25 08:53:48","updatedTime":"2020-08-25 08:53:48","id":null,"feedId":10291,"linkMd5":"234d9c7ffa6c94852e3918a79bfb52e2"}],"tmpCommonImgCdnBytes":1911726,"tmpBodyImgCdnBytes":6533107,"tmpBgImgCdnBytes":0,"extra4":{"start":1598316568286,"total":0,"statList":[{"spend":391,"msg":"获取xml内容"},{"spend":1316,"msg":"解释文章"},{"spend":122773,"msg":"上传封面图到cdn"},{"spend":0,"msg":"修正封面图上传失败重新上传"},{"spend":128007,"msg":"正文链接上传到cdn"}]},"extra5":248,"extra6":239,"extra7ImgCdnFailResultVector":[{"code":1,"isDone":false,"source":"https://backstage.soundcloud.com/wp-content/uploads/2012/03/retrospective_big-505x377.jpg","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":267,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:37","host":"europe-58*","referer":"https://developers.soundcloud.com/blog/how-we-do-retrospectives","linkMd5ListStr":"02a36ba61b526be9e01abde68cfc481d,02a36ba61b526be9e01abde68cfc481d","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24119721339192_raw.jpg","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":119,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:37","host":"us-020*","referer":"https://developers.soundcloud.com/blog/smashing-pumpkins-use-premiere-1-5-beta-to-debut-oceania","linkMd5ListStr":"d64d6ee96585661311bf713f2d9785ea,d64d6ee96585661311bf713f2d9785ea","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24119721339192_raw.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":91,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:37","host":"us-038*","referer":"https://developers.soundcloud.com/blog/smashing-pumpkins-use-premiere-1-5-beta-to-debut-oceania","linkMd5ListStr":"d64d6ee96585661311bf713f2d9785ea,d64d6ee96585661311bf713f2d9785ea","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://backstage.soundcloud.com/wp-content/uploads/2012/03/retrospective_big-505x377.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":806,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:37","host":"us-029*","referer":"https://developers.soundcloud.com/blog/how-we-do-retrospectives","linkMd5ListStr":"02a36ba61b526be9e01abde68cfc481d,02a36ba61b526be9e01abde68cfc481d","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131769094098_raw.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":105,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"us-022*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18,4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/timedcomment2.jpg","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":286,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"europe62*","referer":"https://developers.soundcloud.com/blog/rich-media-using-timed-comments","linkMd5ListStr":"a6004534db173619f1f08181f03ef8ad,a6004534db173619f1f08181f03ef8ad","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/search-infra1.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":81,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"europe-57*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca,a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/timedcomment2.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":262,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"europe64*","referer":"https://developers.soundcloud.com/blog/rich-media-using-timed-comments","linkMd5ListStr":"a6004534db173619f1f08181f03ef8ad,a6004534db173619f1f08181f03ef8ad","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/search-infra1.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":104,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"us-025*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca,a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-tiny.jpg","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":161,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"us-027*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630,f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131769094098_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":597,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"europe-25*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18,4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/mac-sharing-small.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":246,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:39","host":"us-004*","referer":"https://developers.soundcloud.com/blog/desktop-sharing-kits","linkMd5ListStr":"a6e37251568015a3d74d9dafa4811dfa,a6e37251568015a3d74d9dafa4811dfa","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-tiny.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":349,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:39","host":"us-028*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630,f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/mac-sharing-small.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":138,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:39","host":"us-024*","referer":"https://developers.soundcloud.com/blog/desktop-sharing-kits","linkMd5ListStr":"a6e37251568015a3d74d9dafa4811dfa,a6e37251568015a3d74d9dafa4811dfa","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://backstage.soundcloud.com/wp-content/uploads/2011/12/Retrospective-505x377.jpg","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":627,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:39","host":"us-53*","referer":"https://developers.soundcloud.com/blog/stop-hacker-time","linkMd5ListStr":"07deb1e57e3b99f2e3445ccdf5b3bc29,07deb1e57e3b99f2e3445ccdf5b3bc29","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://backstage.soundcloud.com/wp-content/uploads/2011/12/Retrospective-505x377.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":196,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:40","host":"europe67*","referer":"https://developers.soundcloud.com/blog/stop-hacker-time","linkMd5ListStr":"07deb1e57e3b99f2e3445ccdf5b3bc29,07deb1e57e3b99f2e3445ccdf5b3bc29","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},null,null,{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131758138488_raw.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":128,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:40","host":"us-010*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131758138488_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":95,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:40","host":"us-038*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-small.jpg","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":381,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:40","host":"us-022*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-small.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":338,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:40","host":"us-018*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/SearchTimings-505x378.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":52,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"europe63*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/SearchTimings-505x378.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":89,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"europe-56*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-large.jpg","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":54,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"europe-57*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-medium.jpg","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":144,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"us-54*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-large.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":101,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"us-030*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-medium.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":45,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"europe61*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131771379756_raw.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":135,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"us-019*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131771379756_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":94,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:42","host":"us-016*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/cool_disco.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":139,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:42","host":"us-53*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/cool_disco.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":90,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:42","host":"europe66*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/Selection_006-505x231.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":104,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:43","host":"us-028*","referer":"https://developers.soundcloud.com/blog/building-the-next-soundcloud","linkMd5ListStr":"e6bf24ccfd2d4d421302716717b1cfec","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/Selection_006-505x231.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":341,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:43","host":"us-006*","referer":"https://developers.soundcloud.com/blog/building-the-next-soundcloud","linkMd5ListStr":"e6bf24ccfd2d4d421302716717b1cfec","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24132127653036_raw.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":128,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:44","host":"us-040*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131748089754_raw.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":138,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:44","host":"us-024*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24132127653036_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":71,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:44","host":"us-035*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131748089754_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":60,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:44","host":"us-033*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/SuggesterTimings-505x378.png","sourceStatusCode":404,"sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":153,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:44","host":"europe-60*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/SuggesterTimings-505x378.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":76,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:45","host":"europe-22*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"extra10_invalidATagHrefValue":{"https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/9d66726967ac1ac4ac9244c609b0d002/26532/confirm-mitigated.png":"https://developers.soundcloud.com/blog/static/9d66726967ac1ac4ac9244c609b0d002/26532/confirm-mitigated.png","https://developers.soundcloud.com/blog/soundclouds-data-science-process_mailto:warren.winter@soundcloud.com":"mailto:warren.winter@soundcloud.com","https://developers.soundcloud.com/blog/sharing-sounds_/blog/static/4b4afa2ba8edef2b8a25de084981fd7b/135ae/iphone-sharing.png":"https://developers.soundcloud.com/blog/static/4b4afa2ba8edef2b8a25de084981fd7b/135ae/iphone-sharing.png","https://developers.soundcloud.com/blog/sharing-to-facebook-twitter-etc_/blog/docs/api/tracks#social-sharing":"https://developers.soundcloud.com/blog/docs/api/tracks#social-sharing","https://developers.soundcloud.com/blog/keeping-counts-in-sync_/blog/static/d55f08cc89ab80f46068e977d4213585/0901c/counts_stitch.png":"https://developers.soundcloud.com/blog/static/d55f08cc89ab80f46068e977d4213585/0901c/counts_stitch.png","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses_/blog/static/a78b43f8beffe810a9bf35527f8eb21d/1002f/image4.png":"https://developers.soundcloud.com/blog/static/a78b43f8beffe810a9bf35527f8eb21d/1002f/image4.png","https://developers.soundcloud.com/blog/front-end-javascript-bug-tracking_/blog/static/38c24f5d0a997a90e334c014ae8479e5/8939e/airbrake-report.png":"https://developers.soundcloud.com/blog/static/38c24f5d0a997a90e334c014ae8479e5/8939e/airbrake-report.png","https://developers.soundcloud.com/blog/getting-a-team-back-on-track_/blog/static/89046fde0dff8d7fb8593feec03e0863/04090/back-on-track-max.png":"https://developers.soundcloud.com/blog/static/89046fde0dff8d7fb8593feec03e0863/04090/back-on-track-max.png","https://developers.soundcloud.com/blog/heartbleed_/blog/static/cbfbd52b0009558a2ef89e02d1aad58b/f570f/heartbleed.png":"https://developers.soundcloud.com/blog/static/cbfbd52b0009558a2ef89e02d1aad58b/f570f/heartbleed.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/b766f1ac96e814c9391fd28fa8872d63/1da0e/two_engineers_two_tasks.png":"https://developers.soundcloud.com/blog/static/b766f1ac96e814c9391fd28fa8872d63/1da0e/two_engineers_two_tasks.png","https://developers.soundcloud.com/blog/front-end-javascript-bug-tracking_/blog/static/9cbc68dfac58d901f12708b3843f7601/8939e/google-analytics-report.png":"https://developers.soundcloud.com/blog/static/9cbc68dfac58d901f12708b3843f7601/8939e/google-analytics-report.png","https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud_/blog/static/5938801e9e8897edc802c48ebde57744/c2b5a/prometheus_bazooka_memory_wasters.png":"https://developers.soundcloud.com/blog/static/5938801e9e8897edc802c48ebde57744/c2b5a/prometheus_bazooka_memory_wasters.png","https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture_/blog/static/c5f5aa4717c62570e3f546578d9e3a88/1f853/contract.jpg":"https://developers.soundcloud.com/blog/static/c5f5aa4717c62570e3f546578d9e3a88/1f853/contract.jpg","https://developers.soundcloud.com/blog/sharing-sounds_mailto:api@soundcloud.com":"mailto:api@soundcloud.com","https://developers.soundcloud.com/blog/ios-waveform-rendering_/blog/static/c2c3d7ad79a9249aa3e68e90dfb478dc/135ae/waveform_rendering_sharp.png":"https://developers.soundcloud.com/blog/static/c2c3d7ad79a9249aa3e68e90dfb478dc/135ae/waveform_rendering_sharp.png","https://developers.soundcloud.com/blog/building-the-next-soundcloud_/blog/static/2623543bfa5746756f3fd0e5f1345b8e/ae69b/repost.png":"https://developers.soundcloud.com/blog/static/2623543bfa5746756f3fd0e5f1345b8e/ae69b/repost.png","https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-1_/blog/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2":"https://developers.soundcloud.com/blog/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2","https://developers.soundcloud.com/blog/creating-readable-spark-jobs_/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/f3ae4/creating-readable-spark-jobs-function-pipeline.png":"https://developers.soundcloud.com/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/f3ae4/creating-readable-spark-jobs-function-pipeline.png","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2_/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/8d0ff/image5.png":"https://developers.soundcloud.com/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/8d0ff/image5.png","https://developers.soundcloud.com/blog/leveraging-frameworks-to-speed-up-our-development-on-ios-part-1_/blog/static/602eee3352663d0b66444926a0aca01a/64b01/ios-playground.png":"https://developers.soundcloud.com/blog/static/602eee3352663d0b66444926a0aca01a/64b01/ios-playground.png","https://developers.soundcloud.com/blog/ios-waveform-rendering_/blog/static/5f083ab7c0db99633e5ab91acc120e20/54e54/waveform_rendering_clip.png":"https://developers.soundcloud.com/blog/static/5f083ab7c0db99633e5ab91acc120e20/54e54/waveform_rendering_clip.png","https://developers.soundcloud.com/blog/stratus-2-beta_/blog/static/32c3986a57ccc05df110971382a6512a/2cf63/stratus2-beta.png":"https://developers.soundcloud.com/blog/static/32c3986a57ccc05df110971382a6512a/2cf63/stratus2-beta.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/8906688cbf168a58b495068d43e3a767/1c938/pdkp_summary_dashboard.png":"https://developers.soundcloud.com/blog/static/8906688cbf168a58b495068d43e3a767/1c938/pdkp_summary_dashboard.png","https://developers.soundcloud.com/blog/contest-soundcloud-and-acapela-group_/blog/static/69ee5739e44097bf42f4e5fbb107cfc2/91578/isport-headphones.jpg":"https://developers.soundcloud.com/blog/static/69ee5739e44097bf42f4e5fbb107cfc2/91578/isport-headphones.jpg","https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/ea8c73f9856fe0af532ed2e8d841c2f4/26532/confirm-naive.png":"https://developers.soundcloud.com/blog/static/ea8c73f9856fe0af532ed2e8d841c2f4/26532/confirm-naive.png","https://developers.soundcloud.com/blog/introducing-the-cloudseeder-devkit_/blog/static/26291617b09e9b7665fb652c80924386/02744/cloudseeder.png":"https://developers.soundcloud.com/blog/static/26291617b09e9b7665fb652c80924386/02744/cloudseeder.png","https://developers.soundcloud.com/blog/hands-off-deployment-with-canary_/blog/static/b051382f9344df09700c36a57750a801/3eaf4/pipeline-original.png":"https://developers.soundcloud.com/blog/static/b051382f9344df09700c36a57750a801/3eaf4/pipeline-original.png","https://developers.soundcloud.com/blog/berlin-geekettes-hackathon-roundup_/blog/static/e84b60c281b7908661ad607382572430/48a11/bghack2.jpg":"https://developers.soundcloud.com/blog/static/e84b60c281b7908661ad607382572430/48a11/bghack2.jpg","https://developers.soundcloud.com/blog/stream-and-download_/blog/docs/api/tracks":"https://developers.soundcloud.com/blog/docs/api/tracks","https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2_/blog/static/19234e7e3b35bc10753e8bfd33a724b4/ef3f5/build_times_min14.png":"https://developers.soundcloud.com/blog/static/19234e7e3b35bc10753e8bfd33a724b4/ef3f5/build_times_min14.png","https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith_/blog/static/56bd8881dd8a35df5789994673747f9b/67d4f/product-engineering-diagram-3.jpg":"https://developers.soundcloud.com/blog/static/56bd8881dd8a35df5789994673747f9b/67d4f/product-engineering-diagram-3.jpg","https://developers.soundcloud.com/blog/a-better-model-of-data-ownership_/blog/static/4a306802f50ee060998f06283978e5ce/b1c25/dataset-encapsulation-fixed.png":"https://developers.soundcloud.com/blog/static/4a306802f50ee060998f06283978e5ce/b1c25/dataset-encapsulation-fixed.png","https://developers.soundcloud.com/blog/stream-and-download_/blog/docs/oembed":"https://developers.soundcloud.com/blog/docs/oembed","https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces_/blog/static/3fb52692a62f8b4268450e8a9320ca5f/6e3c3/2-zipkin-trace-overview.png":"https://developers.soundcloud.com/blog/static/3fb52692a62f8b4268450e8a9320ca5f/6e3c3/2-zipkin-trace-overview.png","https://developers.soundcloud.com/blog/ios-waveform-rendering_/blog/static/98f12e069c62b0789db0caa8b12b97ff/135ae/waveform_rendering_blurred.png":"https://developers.soundcloud.com/blog/static/98f12e069c62b0789db0caa8b12b97ff/135ae/waveform_rendering_blurred.png","https://developers.soundcloud.com/blog/a-better-model-of-data-ownership_/blog/static/d0bd698936a521b8e3e1f5e3087dd37f/60eaf/dataset-encapsulation.png":"https://developers.soundcloud.com/blog/static/d0bd698936a521b8e3e1f5e3087dd37f/60eaf/dataset-encapsulation.png","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_/blog/static/4339503b67abd7892be39a5ffe110d4a/54e54/e3.png":"https://developers.soundcloud.com/blog/static/4339503b67abd7892be39a5ffe110d4a/54e54/e3.png","https://developers.soundcloud.com/blog/soundcloud-is-playing-the-oboe_/blog/static/63d2a157e4f4f9948d127e5eaa684460/79d86/latency_improvement.png":"https://developers.soundcloud.com/blog/static/63d2a157e4f4f9948d127e5eaa684460/79d86/latency_improvement.png","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses_/blog/static/298e897fb464f06b1d46b431500d0140/a987b/image5.png":"https://developers.soundcloud.com/blog/static/298e897fb464f06b1d46b431500d0140/a987b/image5.png","https://developers.soundcloud.com/blog/a-better-model-of-data-ownership_/blog/static/96849b6e142dda28942baa092aceabf5/22492/dataset-semantics-fixed.png":"https://developers.soundcloud.com/blog/static/96849b6e142dda28942baa092aceabf5/22492/dataset-semantics-fixed.png","https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces_/blog/static/b6d66454c23a905f52ebc848fcfefd0f/6e3c3/4-divergent-service-names.png":"https://developers.soundcloud.com/blog/static/b6d66454c23a905f52ebc848fcfefd0f/6e3c3/4-divergent-service-names.png","https://developers.soundcloud.com/blog/offset-pagination-deprecated_mailto:api@soundcloud.com":"mailto:api@soundcloud.com","https://developers.soundcloud.com/blog/dagger-reflect_/blog/static/0d3dcbb4e7fae32e898feb5bf44864a6/45483/with-reflect.png":"https://developers.soundcloud.com/blog/static/0d3dcbb4e7fae32e898feb5bf44864a6/45483/with-reflect.png","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_/blog/static/679c7f38401cb7471c9614369c03c6e6/54e54/e6.png":"https://developers.soundcloud.com/blog/static/679c7f38401cb7471c9614369c03c6e6/54e54/e6.png","https://developers.soundcloud.com/blog/html5-widget-api_/blog/docs/html5-widget":"https://developers.soundcloud.com/blog/docs/html5-widget","https://developers.soundcloud.com/blog/rethinking-the-backend-code-challenge_#fnref-1":"https://developers.soundcloud.com/blog/rethinking-the-backend-code-challenge#fnref-1","https://developers.soundcloud.com/blog/tuist-project-generation_/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/da2f0/new-file-xcode.png":"https://developers.soundcloud.com/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/da2f0/new-file-xcode.png","https://developers.soundcloud.com/blog/tuist-project-generation_#fnref-1":"https://developers.soundcloud.com/blog/tuist-project-generation#fnref-1","https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/13f2004388594fcc16116f97e5302987/e11df/pairing-illustrations-0.png":"https://developers.soundcloud.com/blog/static/13f2004388594fcc16116f97e5302987/e11df/pairing-illustrations-0.png","https://developers.soundcloud.com/blog/how-not-to-build-datasets-and-consume-data-at-your-company_a-better-model-of-data-ownership":"https://developers.soundcloud.com/blog/a-better-model-of-data-ownership","https://developers.soundcloud.com/blog/win-a-trip-to-the-barcelona-ruby-conference_/blog/static/5b1831d72dc2c2b0299a8d3b3445a0f3/135ae/barcelona-ruby-conference-sept-MMXIII.png":"https://developers.soundcloud.com/blog/static/5b1831d72dc2c2b0299a8d3b3445a0f3/135ae/barcelona-ruby-conference-sept-MMXIII.png","https://developers.soundcloud.com/blog/quality-mobile-trains_/blog/static/0e15abc6ffdc2c555cd20df1ec4c69f2/925b5/feature-flag.png":"https://developers.soundcloud.com/blog/static/0e15abc6ffdc2c555cd20df1ec4c69f2/925b5/feature-flag.png","https://developers.soundcloud.com/blog/custom-players_/blog/docs/custom-player":"https://developers.soundcloud.com/blog/docs/custom-player","https://developers.soundcloud.com/blog/sharing-sounds_/blog/blog/ios-sharing":"https://developers.soundcloud.com/blog/blog/ios-sharing","https://developers.soundcloud.com/blog/say-hello-to-sketchy-the-spam-fighter_/blog/static/d6dcc23daced4d6498c1619edd6e8036/135ae/no-spam.png":"https://developers.soundcloud.com/blog/static/d6dcc23daced4d6498c1619edd6e8036/135ae/no-spam.png","https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/0f2e7215e4132593d5394400b04f1c38/26532/confirm-exploit.png":"https://developers.soundcloud.com/blog/static/0f2e7215e4132593d5394400b04f1c38/26532/confirm-exploit.png","https://developers.soundcloud.com/blog/introducing-javascript-sdk-3-0-0_/blog/docs/api/sdks":"https://developers.soundcloud.com/blog/docs/api/sdks","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2_/blog/static/76cb8e39479ca79c859eeccb79c9d418/8d0ff/image4.png":"https://developers.soundcloud.com/blog/static/76cb8e39479ca79c859eeccb79c9d418/8d0ff/image4.png","https://developers.soundcloud.com/blog/getting-a-team-back-on-track_/blog/static/39e8c349e19c63ba7707287e28c46895/92869/back-on-track-kpi.png":"https://developers.soundcloud.com/blog/static/39e8c349e19c63ba7707287e28c46895/92869/back-on-track-kpi.png","https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf_/blog/static/996aa0c3405802366ce3d8b0b66b6e47/d19c0/cloudbrowser.png":"https://developers.soundcloud.com/blog/static/996aa0c3405802366ce3d8b0b66b6e47/d19c0/cloudbrowser.png","https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture_/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/1f853/bridge.jpg":"https://developers.soundcloud.com/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/1f853/bridge.jpg","https://developers.soundcloud.com/blog/dagger-reflect_/blog/static/cb8c4a1333877c8e197c4ee9530641c5/e4566/annotation-3-mins.png":"https://developers.soundcloud.com/blog/static/cb8c4a1333877c8e197c4ee9530641c5/e4566/annotation-3-mins.png","https://developers.soundcloud.com/blog/stretch-opportunities-for-engineers_#fn-1":"https://developers.soundcloud.com/blog/stretch-opportunities-for-engineers#fn-1","https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf_/blog/static/3d521bf844e75ef5465b82c3980c3d08/48a11/lee-johannes-hacking.jpg":"https://developers.soundcloud.com/blog/static/3d521bf844e75ef5465b82c3980c3d08/48a11/lee-johannes-hacking.jpg","https://developers.soundcloud.com/blog/ios-waveform-rendering_/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/a5ed1/waveform_rendering_cpu.png":"https://developers.soundcloud.com/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/a5ed1/waveform_rendering_cpu.png","https://developers.soundcloud.com/blog/tuist-project-generation_#fn-1":"https://developers.soundcloud.com/blog/tuist-project-generation#fn-1","https://developers.soundcloud.com/blog/tuist-project-generation_/blog/static/0de7544370839f8d8fe966b24f23dd30/34106/search-project.png":"https://developers.soundcloud.com/blog/static/0de7544370839f8d8fe966b24f23dd30/34106/search-project.png","https://developers.soundcloud.com/blog/periskop-exception-monitoring-service_/blog/static/245a03d81fec8969a61e4ca6d88ce189/b13b6/periskop_design.png":"https://developers.soundcloud.com/blog/static/245a03d81fec8969a61e4ca6d88ce189/b13b6/periskop_design.png","https://developers.soundcloud.com/blog/story-hack-recap_/blog/static/e410f309650f3a2fbf30fb6f1a5fc543/c7805/shbtweet1.png":"https://developers.soundcloud.com/blog/static/e410f309650f3a2fbf30fb6f1a5fc543/c7805/shbtweet1.png","https://developers.soundcloud.com/blog/tuist-project-generation_/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/e49a9/jupiter_earth.png":"https://developers.soundcloud.com/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/e49a9/jupiter_earth.png","https://developers.soundcloud.com/blog/quality-mobile-trains_/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/5841d/ci-pipeline.png":"https://developers.soundcloud.com/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/5841d/ci-pipeline.png","https://developers.soundcloud.com/blog/front-end-javascript-bug-tracking_/blog/static/6adc22b6d275182f0745fe733a9b3d36/8939e/airbrake-report-cont.png":"https://developers.soundcloud.com/blog/static/6adc22b6d275182f0745fe733a9b3d36/8939e/airbrake-report-cont.png","https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2_/blog/static/ba8c16495806d8ea168036311e941d56/ef3f5/build_times_min21.png":"https://developers.soundcloud.com/blog/static/ba8c16495806d8ea168036311e941d56/ef3f5/build_times_min21.png","https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud_/blog/static/7c78f554adcf65b3c43aa5f7de99538a/473b4/indexing_before.png":"https://developers.soundcloud.com/blog/static/7c78f554adcf65b3c43aa5f7de99538a/473b4/indexing_before.png","https://developers.soundcloud.com/blog/xml-responses-deprecated_mailto:api@soundcloud.com":"mailto:api@soundcloud.com","https://developers.soundcloud.com/blog/changing-interview-process-during-remote-working_#fnref-1":"https://developers.soundcloud.com/blog/changing-interview-process-during-remote-working#fnref-1","https://developers.soundcloud.com/blog/competition-app_mailto:lee@soundcloud.com":"mailto:lee@soundcloud.com","https://developers.soundcloud.com/blog/introducing-javascript-sdk-version-2_mailto:api-support@soundcloud.com?subject=JavaScript SDK 2.0.0":"mailto:api-support@soundcloud.com?subject=JavaScript SDK 2.0.0","https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces_/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/6e3c3/3-zipkin-span-transformation.png":"https://developers.soundcloud.com/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/6e3c3/3-zipkin-span-transformation.png","https://developers.soundcloud.com/blog/hack-your-way-to-berlin_mailto:eliot@soundcloud.com":"mailto:eliot@soundcloud.com","https://developers.soundcloud.com/blog/building_radio_stations_at_soundcloud_/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/a66c8/suggestedStations.jpg":"https://developers.soundcloud.com/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/a66c8/suggestedStations.jpg","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses_/blog/static/8f009accc900f96648f1252ab248035a/640e4/image2.png":"https://developers.soundcloud.com/blog/static/8f009accc900f96648f1252ab248035a/640e4/image2.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_posts/pdkp_overview_dashboard.png":"https://developers.soundcloud.com/blog/posts/pdkp_overview_dashboard.png","https://developers.soundcloud.com/blog/introducing-the-android-sharing-kit_/blog/static/627ca2cefc8e46c624bf881c0041f3f2/6b190/android_share_logo.png":"https://developers.soundcloud.com/blog/static/627ca2cefc8e46c624bf881c0041f3f2/6b190/android_share_logo.png","https://developers.soundcloud.com/blog/real-time-counts-with-stitch_/blog/static/9e68a73a9b66c964410db209cf4ee787/d6590/soundcloud_stats_screenshot.jpg":"https://developers.soundcloud.com/blog/static/9e68a73a9b66c964410db209cf4ee787/d6590/soundcloud_stats_screenshot.jpg","https://developers.soundcloud.com/blog/tuist-project-generation_/blog/static/244c11997e85fd73d949a0252e476a7f/40805/tuist-helpers.png":"https://developers.soundcloud.com/blog/static/244c11997e85fd73d949a0252e476a7f/40805/tuist-helpers.png","https://developers.soundcloud.com/blog/soundclouds-data-science-process_mailto:janette.lehmann@soundcloud.com":"mailto:janette.lehmann@soundcloud.com","https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces_/blog/static/acad98c939f74b77be82c164bfe3ab9d/bf224/1-dependency-graph.png":"https://developers.soundcloud.com/blog/static/acad98c939f74b77be82c164bfe3ab9d/bf224/1-dependency-graph.png","https://developers.soundcloud.com/blog/soundcloud-is-playing-the-oboe_/blog/static/bd853f55bc860bb07babfcec150f122d/4d248/player_arch.png":"https://developers.soundcloud.com/blog/static/bd853f55bc860bb07babfcec150f122d/4d248/player_arch.png","https://developers.soundcloud.com/blog/we-love-oauth-2_/blog/static/360a07bb16fbdc974215f53bb3cbd201/03fde/oauth-2-logo.png":"https://developers.soundcloud.com/blog/static/360a07bb16fbdc974215f53bb3cbd201/03fde/oauth-2-logo.png","https://developers.soundcloud.com/blog/berlin-geekettes-hackathon-roundup_/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/48a11/bghack.jpg":"https://developers.soundcloud.com/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/48a11/bghack.jpg","https://developers.soundcloud.com/blog/introducing-javascript-sdk-3-0-0_/blog/docs/api/migrating-to-javascript-sdk-3":"https://developers.soundcloud.com/blog/docs/api/migrating-to-javascript-sdk-3","https://developers.soundcloud.com/blog/soundclouds-data-science-process_mailto:max.jakob@soundcloud.com":"mailto:max.jakob@soundcloud.com","https://developers.soundcloud.com/blog/breaking-loose-from-third-party-lock-in-with-custom-refactoring-tools_/blog/static/27134d3f37ae0be10d5b2522f4f96095/8013a/specta-vs-xctest.png":"https://developers.soundcloud.com/blog/static/27134d3f37ae0be10d5b2522f4f96095/8013a/specta-vs-xctest.png","https://developers.soundcloud.com/blog/ios-waveform-rendering_/blog/static/2d22fc1fcea6920ee8508b5de7306304/a5ed1/waveform_rendering_mask.png":"https://developers.soundcloud.com/blog/static/2d22fc1fcea6920ee8508b5de7306304/a5ed1/waveform_rendering_mask.png","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_/blog/static/4ffdf00e28a16c6f91cf7b6bff99bf4a/54e54/e2.png":"https://developers.soundcloud.com/blog/static/4ffdf00e28a16c6f91cf7b6bff99bf4a/54e54/e2.png","https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2_/blog/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-1":"https://developers.soundcloud.com/blog/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-1","https://developers.soundcloud.com/blog/radical-candor-an-experience-report_/blog/static/1e36bb105d9a2786ae2026815a271763/e2288/radical-candor.jpg":"https://developers.soundcloud.com/blog/static/1e36bb105d9a2786ae2026815a271763/e2288/radical-candor.jpg","https://developers.soundcloud.com/blog/wave-raid_/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/249e6/waveraid.png":"https://developers.soundcloud.com/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/249e6/waveraid.png","https://developers.soundcloud.com/blog/real-time-counts-with-stitch_/blog/static/49e8022a8f73567d4a3dc2659c4ff0f8/548e0/stitch_diagram.jpg":"https://developers.soundcloud.com/blog/static/49e8022a8f73567d4a3dc2659c4ff0f8/548e0/stitch_diagram.jpg","https://developers.soundcloud.com/blog/win-a-trip-to-the-barcelona-ruby-conference_mailto:e@soundcloud.com":"mailto:e@soundcloud.com","https://developers.soundcloud.com/blog/changing-interview-process-during-remote-working_#fn-1":"https://developers.soundcloud.com/blog/changing-interview-process-during-remote-working#fn-1","https://developers.soundcloud.com/blog/dagger-reflect_#fnref-1":"https://developers.soundcloud.com/blog/dagger-reflect#fnref-1","https://developers.soundcloud.com/blog/dagger-reflect_#fnref-2":"https://developers.soundcloud.com/blog/dagger-reflect#fnref-2","https://developers.soundcloud.com/blog/leveraging-frameworks-to-speed-up-our-development-on-ios-part-1_/blog/static/8036afa4de908d212e78fd25f6bbbadf/9bac8/ios-example-app.png":"https://developers.soundcloud.com/blog/static/8036afa4de908d212e78fd25f6bbbadf/9bac8/ios-example-app.png","https://developers.soundcloud.com/blog/dark-mode-observer-pattern_/blog/static/9f2bb119f1570b22f3d0f703746adc51/cc43b/banner.jpg":"https://developers.soundcloud.com/blog/static/9f2bb119f1570b22f3d0f703746adc51/cc43b/banner.jpg","https://developers.soundcloud.com/blog/dagger-reflect_#fnref-3":"https://developers.soundcloud.com/blog/dagger-reflect#fnref-3","https://developers.soundcloud.com/blog/dagger-reflect_#fnref-4":"https://developers.soundcloud.com/blog/dagger-reflect#fnref-4","https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf_/blog/static/8ab74287b4c087ff584c878847bb6439/48a11/hackers.jpg":"https://developers.soundcloud.com/blog/static/8ab74287b4c087ff584c878847bb6439/48a11/hackers.jpg","https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/74397e83677fe39912ec67eaa63c47df/e11df/pairing-illustrations-4.png":"https://developers.soundcloud.com/blog/static/74397e83677fe39912ec67eaa63c47df/e11df/pairing-illustrations-4.png","https://developers.soundcloud.com/blog/quality-mobile-trains_/blog/static/b0c15442b3e61d6b97a050f20b2689a1/60bac/github-comment.png":"https://developers.soundcloud.com/blog/static/b0c15442b3e61d6b97a050f20b2689a1/60bac/github-comment.png","https://developers.soundcloud.com/blog/pennapps-recap_/blog/static/917e9d55a63002b2f03ea66ef19b70d8/48a11/pennapps.jpg":"https://developers.soundcloud.com/blog/static/917e9d55a63002b2f03ea66ef19b70d8/48a11/pennapps.jpg","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/c6f5381bbfbad6246acf19130fa69aec/67148/artem_engineering_town_hall.png":"https://developers.soundcloud.com/blog/static/c6f5381bbfbad6246acf19130fa69aec/67148/artem_engineering_town_hall.png","https://developers.soundcloud.com/blog/sharing-sounds_/blog/docs/api/guide#sharing-sounds":"https://developers.soundcloud.com/blog/docs/api/guide#sharing-sounds","https://developers.soundcloud.com/blog/hands-off-deployment-with-canary_/blog/static/4f182e4d6e605f9894f241f2813e6bb2/23749/pipeline-manual-canary.png":"https://developers.soundcloud.com/blog/static/4f182e4d6e605f9894f241f2813e6bb2/23749/pipeline-manual-canary.png","https://developers.soundcloud.com/blog/building-the-next-soundcloud_/blog/static/4c740be23bd4eeba13011264809c5994/ae69b/playing.png":"https://developers.soundcloud.com/blog/static/4c740be23bd4eeba13011264809c5994/ae69b/playing.png","https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture_/blog/static/0cc85866837a1b7cfdaedc06ac43776f/1f853/viper.jpg":"https://developers.soundcloud.com/blog/static/0cc85866837a1b7cfdaedc06ac43776f/1f853/viper.jpg","https://developers.soundcloud.com/blog/promoting-your-app_/blog/blog/the-next-app-gallery-update":"https://developers.soundcloud.com/blog/blog/the-next-app-gallery-update","https://developers.soundcloud.com/blog/a-better-model-of-data-ownership_/blog/static/553cec1abb4f689ca597fbe7d124edd8/22492/dataset-semantics.png":"https://developers.soundcloud.com/blog/static/553cec1abb4f689ca597fbe7d124edd8/22492/dataset-semantics.png","https://developers.soundcloud.com/blog/front-end-javascript-bug-tracking_/blog/static/9591325255d4ef940a2fc6c20f1793fa/8939e/bugsense-report.png":"https://developers.soundcloud.com/blog/static/9591325255d4ef940a2fc6c20f1793fa/8939e/bugsense-report.png","https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith_/blog/static/1a6422e826679f9dcc889cdb99f83952/67d4f/product-engineering-diagram-4.jpg":"https://developers.soundcloud.com/blog/static/1a6422e826679f9dcc889cdb99f83952/67d4f/product-engineering-diagram-4.jpg","https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/56eb450495d9020860d124750176995b/26532/confirm-mitigated-w-warning.png":"https://developers.soundcloud.com/blog/static/56eb450495d9020860d124750176995b/26532/confirm-mitigated-w-warning.png","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2_/blog/static/5029c683c9dcd142b5276343646200ed/c70a2/image3.png":"https://developers.soundcloud.com/blog/static/5029c683c9dcd142b5276343646200ed/c70a2/image3.png","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2_/blog/static/80c61460f17ee696ff909c16ef038f4a/8d0ff/image2.png":"https://developers.soundcloud.com/blog/static/80c61460f17ee696ff909c16ef038f4a/8d0ff/image2.png","https://developers.soundcloud.com/blog/dagger-reflect_/blog/static/487afaffa2f2da376dad0cae945959e5/05a72/annotation-42-secs.png":"https://developers.soundcloud.com/blog/static/487afaffa2f2da376dad0cae945959e5/05a72/annotation-42-secs.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/12ad0764bf4bbe223d41b436ddfba418/4b160/cycle_time.png":"https://developers.soundcloud.com/blog/static/12ad0764bf4bbe223d41b436ddfba418/4b160/cycle_time.png","https://developers.soundcloud.com/blog/pennapps-recap_/blog/static/806cfc30f521eb9c01e9562ca8bcd587/df2c7/instagramaphone.jpg":"https://developers.soundcloud.com/blog/static/806cfc30f521eb9c01e9562ca8bcd587/df2c7/instagramaphone.jpg","https://developers.soundcloud.com/blog/soundcloud-at-hackto_/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/df2c7/hackto.jpg":"https://developers.soundcloud.com/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/df2c7/hackto.jpg","https://developers.soundcloud.com/blog/dark-mode-observer-pattern_/blog/static/502e61b8f647e521bd358d44e2668cf5/3bb78/uml.png":"https://developers.soundcloud.com/blog/static/502e61b8f647e521bd358d44e2668cf5/3bb78/uml.png","https://developers.soundcloud.com/blog/stream-and-download_/blog/docs/api":"https://developers.soundcloud.com/blog/docs/api","https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2_/blog/static/55086764b356e07e99a979d16552e9f4/b9fb9/method_plot.png":"https://developers.soundcloud.com/blog/static/55086764b356e07e99a979d16552e9f4/b9fb9/method_plot.png","https://developers.soundcloud.com/blog/soundcloud-launches-the-html5-audio-improvement-initiative_/blog/static/ac26210c0063863e1b7e411ba9c2cd0c/4c799/areweplayingyet.jpg":"https://developers.soundcloud.com/blog/static/ac26210c0063863e1b7e411ba9c2cd0c/4c799/areweplayingyet.jpg","https://developers.soundcloud.com/blog/introducing-the-cloudseeder-devkit_/blog/static/b8afee81a2778887287217fac298be28/c5a17/cloudseeder_main.png":"https://developers.soundcloud.com/blog/static/b8afee81a2778887287217fac298be28/c5a17/cloudseeder_main.png","https://developers.soundcloud.com/blog/soundclouds-data-science-process_mailto:christoph@soundcloud.com":"mailto:christoph@soundcloud.com","https://developers.soundcloud.com/blog/soundcloud-launches-the-html5-audio-improvement-initiative_/blog/static/45a70551b98044234e736cc9106dd3f7/4c799/are-we-playing-yet.jpg":"https://developers.soundcloud.com/blog/static/45a70551b98044234e736cc9106dd3f7/4c799/are-we-playing-yet.jpg","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2_/blog/static/70603488e2cd0a1203e737d7a5ddd23e/1b142/image1.png":"https://developers.soundcloud.com/blog/static/70603488e2cd0a1203e737d7a5ddd23e/1b142/image1.png","https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/1af3dd922e401466c29156a301ae649f/e11df/pairing-illustrations-2.png":"https://developers.soundcloud.com/blog/static/1af3dd922e401466c29156a301ae649f/e11df/pairing-illustrations-2.png","https://developers.soundcloud.com/blog/quality-mobile-trains_/blog/static/3e706dce4a12259168f3785b55a52c0b/b5cbf/release-calendar.png":"https://developers.soundcloud.com/blog/static/3e706dce4a12259168f3785b55a52c0b/b5cbf/release-calendar.png","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses_/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/a6404/image3.png":"https://developers.soundcloud.com/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/a6404/image3.png","https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses_/blog/static/7d8143c091a260f7e2d789924aa10c89/774fc/image1.png":"https://developers.soundcloud.com/blog/static/7d8143c091a260f7e2d789924aa10c89/774fc/image1.png","https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud_/blog/static/a2ecbeb647062fed5ab2e252546b74b3/40872/promdash_event_processor.png":"https://developers.soundcloud.com/blog/static/a2ecbeb647062fed5ab2e252546b74b3/40872/promdash_event_processor.png","https://developers.soundcloud.com/blog/stream-and-download_/blog/docs/custom-player":"https://developers.soundcloud.com/blog/docs/custom-player","https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud_/blog/static/d16372095651eb4c86d6556e9a4ebf14/1c938/prometheus_bazooka_cpu_top3.png":"https://developers.soundcloud.com/blog/static/d16372095651eb4c86d6556e9a4ebf14/1c938/prometheus_bazooka_cpu_top3.png","https://developers.soundcloud.com/blog/music-hack-day-barcelona-2012_/blog/static/0d4a8f3fce7fd6236daa5c36a39f4d7e/48a11/reactable.jpg":"https://developers.soundcloud.com/blog/static/0d4a8f3fce7fd6236daa5c36a39f4d7e/48a11/reactable.jpg","https://developers.soundcloud.com/blog/story-hack-recap_/blog/static/fc5db5fe313e9740c6968941f213570a/c7805/shbtweet2.png":"https://developers.soundcloud.com/blog/static/fc5db5fe313e9740c6968941f213570a/c7805/shbtweet2.png","https://developers.soundcloud.com/blog/introducing-the-android-sharing-kit_/blog/static/0e63600ee724b585ba9430793db4d27f/c7805/soundcloud_rd3.png":"https://developers.soundcloud.com/blog/static/0e63600ee724b585ba9430793db4d27f/c7805/soundcloud_rd3.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/12305/one_engineer_two_tasks_schedule.png":"https://developers.soundcloud.com/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/12305/one_engineer_two_tasks_schedule.png","https://developers.soundcloud.com/blog/roshi-a-crdt-system-for-timestamped-events_/blog/static/38fd90dc777269b8e41fb7a44abd73f3/6cdf8/fan-in-on-read.png":"https://developers.soundcloud.com/blog/static/38fd90dc777269b8e41fb7a44abd73f3/6cdf8/fan-in-on-read.png","https://developers.soundcloud.com/blog/rethinking-the-backend-code-challenge_#fn-1":"https://developers.soundcloud.com/blog/rethinking-the-backend-code-challenge#fn-1","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/0ca86d617846e9b6982889164343f3b5/0b460/multitasking_propagation.png":"https://developers.soundcloud.com/blog/static/0ca86d617846e9b6982889164343f3b5/0b460/multitasking_propagation.png","https://developers.soundcloud.com/blog/pennapps-recap_/blog/static/e405663ada13f8054ac2646ede66561a/df2c7/astoria.jpg":"https://developers.soundcloud.com/blog/static/e405663ada13f8054ac2646ede66561a/df2c7/astoria.jpg","https://developers.soundcloud.com/blog/contest-soundcloud-and-acapela-group_/blog/static/9056956503086f1ecf1160e8ad4c7227/91578/purity-headphones.jpg":"https://developers.soundcloud.com/blog/static/9056956503086f1ecf1160e8ad4c7227/91578/purity-headphones.jpg","https://developers.soundcloud.com/blog/tuist-project-generation_/blog/static/3bfe07ea07ca9ad4d4f8ab25cd2447ae/6164f/tuist-generate.png":"https://developers.soundcloud.com/blog/static/3bfe07ea07ca9ad4d4f8ab25cd2447ae/6164f/tuist-generate.png","https://developers.soundcloud.com/blog/lets-git-it-on_mailto:lee@soundcloud.com":"mailto:lee@soundcloud.com","https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces_/blog/static/0f57e386c97d73671a034e0ab0f2b9ad/fe994/6-zipkin-span-annotations-k8s-enhanced.png":"https://developers.soundcloud.com/blog/static/0f57e386c97d73671a034e0ab0f2b9ad/fe994/6-zipkin-span-annotations-k8s-enhanced.png","https://developers.soundcloud.com/blog/introducing-javascript-sdk-3-0-0_/blog/docs/api/sdks#recording":"https://developers.soundcloud.com/blog/docs/api/sdks#recording","https://developers.soundcloud.com/blog/omniauth-soundcloud_/blog/static/6f3da632ced4a793ddcee874c3eda1a0/538d2/omniauth.png":"https://developers.soundcloud.com/blog/static/6f3da632ced4a793ddcee874c3eda1a0/538d2/omniauth.png","https://developers.soundcloud.com/blog/custom-players_/blog/docs/api/guide#playing":"https://developers.soundcloud.com/blog/docs/api/guide#playing","https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture_/blog/static/0d6cb4d2bc96d07a757427300c43775a/1f853/trackscreen.jpg":"https://developers.soundcloud.com/blog/static/0d6cb4d2bc96d07a757427300c43775a/1f853/trackscreen.jpg","https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf_/blog/static/3ccd7308176bea53890a8e52b046ff09/48a11/professor-hannes.jpg":"https://developers.soundcloud.com/blog/static/3ccd7308176bea53890a8e52b046ff09/48a11/professor-hannes.jpg","https://developers.soundcloud.com/blog/managing-unplanned-and-support-tasks_/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/6c314/request_process.png":"https://developers.soundcloud.com/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/6c314/request_process.png","https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud_/blog/static/17b23d599c14549fa785e6603e0f4344/fe994/indexing_pipeline.png":"https://developers.soundcloud.com/blog/static/17b23d599c14549fa785e6603e0f4344/fe994/indexing_pipeline.png","https://developers.soundcloud.com/blog/introducing-javascript-sdk-3-0-0_/blog/docs/api/sdks#uploading":"https://developers.soundcloud.com/blog/docs/api/sdks#uploading","https://developers.soundcloud.com/blog/buzzwords-contest_/blog/docs/api/contest-terms":"https://developers.soundcloud.com/blog/docs/api/contest-terms","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_assets/posts/mysql-stats-ol":"https://developers.soundcloud.com/blog/assets/posts/mysql-stats-ol","https://developers.soundcloud.com/blog/tuist-project-generation_/blog/static/3ef42090d8683220360c3c37c2bae663/0a9c2/search.png":"https://developers.soundcloud.com/blog/static/3ef42090d8683220360c3c37c2bae663/0a9c2/search.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/a043f1ce1cca7c3accfd1acce356c867/4b160/lead_time.png":"https://developers.soundcloud.com/blog/static/a043f1ce1cca7c3accfd1acce356c867/4b160/lead_time.png","https://developers.soundcloud.com/blog/building-the-next-soundcloud_/blog/assets/posts/Selection_006.png":"https://developers.soundcloud.com/blog/assets/posts/Selection_006.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/7588d21a9431e8685dab8c4030a439f2/c6f47/u_shaped_flow_cell.png":"https://developers.soundcloud.com/blog/static/7588d21a9431e8685dab8c4030a439f2/c6f47/u_shaped_flow_cell.png","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_/blog/static/db26cd209c79194cff637894ff4bbc53/54e54/e7.png":"https://developers.soundcloud.com/blog/static/db26cd209c79194cff637894ff4bbc53/54e54/e7.png","https://developers.soundcloud.com/blog/sharing-to-facebook-twitter-etc_/blog/docs/api/me-connections":"https://developers.soundcloud.com/blog/docs/api/me-connections","https://developers.soundcloud.com/blog/soundcloud-is-playing-the-oboe_/blog/static/c6d1a929204d97718690da3a644d8452/cc651/oboe_branching.png":"https://developers.soundcloud.com/blog/static/c6d1a929204d97718690da3a644d8452/cc651/oboe_branching.png","https://developers.soundcloud.com/blog/soundclouds-data-science-process_mailto:josh@soundcloud.com":"mailto:josh@soundcloud.com","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_/blog/static/a493ebb0d86ca96b889cb2a345706cee/54e54/e9.png":"https://developers.soundcloud.com/blog/static/a493ebb0d86ca96b889cb2a345706cee/54e54/e9.png","https://developers.soundcloud.com/blog/managing-unplanned-and-support-tasks_/blog/static/379b53659c14f82127c31d4fc648625c/f6afc/planning_simpler_version.png":"https://developers.soundcloud.com/blog/static/379b53659c14f82127c31d4fc648625c/f6afc/planning_simpler_version.png","https://developers.soundcloud.com/blog/sharing-sounds_/blog/docs/api/guide#authentication":"https://developers.soundcloud.com/blog/docs/api/guide#authentication","https://developers.soundcloud.com/blog/introducing-the-cloudseeder-devkit_/blog/static/315aa8eedac07b15f8d8b8145399d2c0/a5a7c/cloudseeder_headline.png":"https://developers.soundcloud.com/blog/static/315aa8eedac07b15f8d8b8145399d2c0/a5a7c/cloudseeder_headline.png","https://developers.soundcloud.com/blog/how-to-make-a-soundcloud-powered-toy_/blog/static/0751508718ebb654039047dfd12bc02c/48a11/toybox.jpg":"https://developers.soundcloud.com/blog/static/0751508718ebb654039047dfd12bc02c/48a11/toybox.jpg","https://developers.soundcloud.com/blog/introducing-the-ios-sharing-kit_/blog/blog/introducing-the-android-sharing-kit":"https://developers.soundcloud.com/blog/blog/introducing-the-android-sharing-kit","https://developers.soundcloud.com/blog/web-scale-statistics-failing-with-mongodb_/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/eef7a/IO-doing-it-wrong.png":"https://developers.soundcloud.com/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/eef7a/IO-doing-it-wrong.png","https://developers.soundcloud.com/blog/hands-off-deployment-with-canary_/blog/static/cfcb22261ad68e86a1464a577e9cb957/f5ca1/pipeline-automatic-canary.png":"https://developers.soundcloud.com/blog/static/cfcb22261ad68e86a1464a577e9cb957/f5ca1/pipeline-automatic-canary.png","https://developers.soundcloud.com/blog/breaking-loose-from-third-party-lock-in-with-custom-refactoring-tools_/blog/static/01b8f840504e9c517d2ac908a65d39c6/1589a/specta-vs-xctest-method-names.png":"https://developers.soundcloud.com/blog/static/01b8f840504e9c517d2ac908a65d39c6/1589a/specta-vs-xctest-method-names.png","https://developers.soundcloud.com/blog/experiment-02-destroying-soundcloud-instagram_/blog/static/1b03927c03fc6c6558164d1b0bad3897/8939e/destroyed.png":"https://developers.soundcloud.com/blog/static/1b03927c03fc6c6558164d1b0bad3897/8939e/destroyed.png","https://developers.soundcloud.com/blog/sharing-to-facebook-twitter-etc_/blog/docs/api/tracks/#social-sharing":"https://developers.soundcloud.com/blog/docs/api/tracks/#social-sharing","https://developers.soundcloud.com/blog/getting-a-team-back-on-track_/blog/static/d151cac99d8b4f51d1e43e9726691bcd/7ac7b/back-on-track-system.png":"https://developers.soundcloud.com/blog/static/d151cac99d8b4f51d1e43e9726691bcd/7ac7b/back-on-track-system.png","https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud_/blog/static/ef09ec4a064d6973f1ad877baff77f7e/2f950/indexing_after.png":"https://developers.soundcloud.com/blog/static/ef09ec4a064d6973f1ad877baff77f7e/2f950/indexing_after.png","https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/686af2fc0c46de5ce22a0bf509175526/e11df/pairing-illustrations-3.png":"https://developers.soundcloud.com/blog/static/686af2fc0c46de5ce22a0bf509175526/e11df/pairing-illustrations-3.png","https://developers.soundcloud.com/blog/keeping-counts-in-sync_/blog/static/582e02631c980b94411d5cf92fe39825/302a3/counts_cassandra.png":"https://developers.soundcloud.com/blog/static/582e02631c980b94411d5cf92fe39825/302a3/counts_cassandra.png","https://developers.soundcloud.com/blog/marbleo.us_/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/8939e/original3-1.png":"https://developers.soundcloud.com/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/8939e/original3-1.png","https://developers.soundcloud.com/blog/quality-mobile-trains_/blog/static/975510f5992ad5dd42726e017b5e1b32/2d15a/outdated-pr.png":"https://developers.soundcloud.com/blog/static/975510f5992ad5dd42726e017b5e1b32/2d15a/outdated-pr.png","https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces_/blog/static/ef773003a9241036a26a9c57fb301aff/6e3c3/5-improved-service-names.png":"https://developers.soundcloud.com/blog/static/ef773003a9241036a26a9c57fb301aff/6e3c3/5-improved-service-names.png","https://developers.soundcloud.com/blog/node-js-knockout-august-28th-29th_/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/48a11/late_night_hackingz.jpg":"https://developers.soundcloud.com/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/48a11/late_night_hackingz.jpg","https://developers.soundcloud.com/blog/music-hack-day-toronto_/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/48a11/toronto.jpg":"https://developers.soundcloud.com/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/48a11/toronto.jpg","https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud_#f1":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f1","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_/blog/static/f77332c890943a3818b91ff2bf690bab/54e54/e8.png":"https://developers.soundcloud.com/blog/static/f77332c890943a3818b91ff2bf690bab/54e54/e8.png","https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith_/blog/static/35484a6b037a3e0c87ce0a91acfaf724/67d4f/product-engineering-diagram-2.jpg":"https://developers.soundcloud.com/blog/static/35484a6b037a3e0c87ce0a91acfaf724/67d4f/product-engineering-diagram-2.jpg","https://developers.soundcloud.com/blog/music-hack-day-barcelona-2012_/blog/static/853e72964762d6586a7b3020769ba5f8/48a11/end.jpg":"https://developers.soundcloud.com/blog/static/853e72964762d6586a7b3020769ba5f8/48a11/end.jpg","https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud_#f2":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f2","https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud_#f3":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f3","https://developers.soundcloud.com/blog/building-the-next-soundcloud_/blog/static/625e95ddaf0c1936b44c4c0d32018589/ae69b/notification.png":"https://developers.soundcloud.com/blog/static/625e95ddaf0c1936b44c4c0d32018589/ae69b/notification.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/c031a6e6e484c9c502afa42b5758b239/b5f89/code_inventory_total.png":"https://developers.soundcloud.com/blog/static/c031a6e6e484c9c502afa42b5758b239/b5f89/code_inventory_total.png","https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud_#f4":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f4","https://developers.soundcloud.com/blog/how-soundcloud-uses-haproxy-with-kubernetes-for-user-facing-traffic_/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/570aa/cdn-haproxy-k8s.png":"https://developers.soundcloud.com/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/570aa/cdn-haproxy-k8s.png","https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud_#f5":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud#f5","https://developers.soundcloud.com/blog/custom-players_/blog/docs/html5-widget":"https://developers.soundcloud.com/blog/docs/html5-widget","https://developers.soundcloud.com/blog/stretch-opportunities-for-engineers_#fnref-1":"https://developers.soundcloud.com/blog/stretch-opportunities-for-engineers#fnref-1","https://developers.soundcloud.com/blog/buzzwords-contest_mailto:e@soundcloud.com":"mailto:e@soundcloud.com","https://developers.soundcloud.com/blog/getting-a-team-back-on-track_/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/8179c/back-on-track-paint.jpg":"https://developers.soundcloud.com/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/8179c/back-on-track-paint.jpg","https://developers.soundcloud.com/blog/dagger-reflect_/blog/static/32781ec968f6aaa35ce71ae8b96d0246/2b173/without-reflect.png":"https://developers.soundcloud.com/blog/static/32781ec968f6aaa35ce71ae8b96d0246/2b173/without-reflect.png","https://developers.soundcloud.com/blog/periskop-exception-monitoring-service_/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/a987b/periskop_ui.png":"https://developers.soundcloud.com/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/a987b/periskop_ui.png","https://developers.soundcloud.com/blog/stratus-2-beta_mailto:lee@soundcloud.com":"mailto:lee@soundcloud.com","https://developers.soundcloud.com/blog/dagger-reflect_#fn-1":"https://developers.soundcloud.com/blog/dagger-reflect#fn-1","https://developers.soundcloud.com/blog/dagger-reflect_#fn-2":"https://developers.soundcloud.com/blog/dagger-reflect#fn-2","https://developers.soundcloud.com/blog/dagger-reflect_#fn-3":"https://developers.soundcloud.com/blog/dagger-reflect#fn-3","https://developers.soundcloud.com/blog/dagger-reflect_#fn-4":"https://developers.soundcloud.com/blog/dagger-reflect#fn-4","https://developers.soundcloud.com/blog/periskop-exception-monitoring-service_/blog/static/9c5bfa834e6000084deb32d75236402a/c2c5c/periskop_logo.png":"https://developers.soundcloud.com/blog/static/9c5bfa834e6000084deb32d75236402a/c2c5c/periskop_logo.png","https://developers.soundcloud.com/blog/story-hack-recap_/blog/static/992fd35bf993a2574229d3d02c0fdc0d/c7805/shbtweet3.png":"https://developers.soundcloud.com/blog/static/992fd35bf993a2574229d3d02c0fdc0d/c7805/shbtweet3.png","https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces_#f1":"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces#f1","https://developers.soundcloud.com/blog/automatic-stubbing-of-network-requests-to-de-flakify-automation-testing_/blog/static/eeafeb4fdbe62b6686721e1ebf068086/f570d/dob-network-stubbing-start.png":"https://developers.soundcloud.com/blog/static/eeafeb4fdbe62b6686721e1ebf068086/f570d/dob-network-stubbing-start.png","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_/blog/static/6f3af3d0fe190ec925393aeb5f0fa3c1/54e54/e5.png":"https://developers.soundcloud.com/blog/static/6f3af3d0fe190ec925393aeb5f0fa3c1/54e54/e5.png","https://developers.soundcloud.com/blog/introducing-javascript-sdk-3-0-0_/blog/docs/api/guide":"https://developers.soundcloud.com/blog/docs/api/guide","https://developers.soundcloud.com/blog/music-hack-day-barcelona-2012_/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/48a11/venue.jpg":"https://developers.soundcloud.com/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/48a11/venue.jpg","https://developers.soundcloud.com/blog/managing-unplanned-and-support-tasks_/blog/static/864b39d8ea729317de2b128c1f9d0ba3/34e8a/managing_unplanned_support_tasks_hours_spent_chart.png":"https://developers.soundcloud.com/blog/static/864b39d8ea729317de2b128c1f9d0ba3/34e8a/managing_unplanned_support_tasks_hours_spent_chart.png","https://developers.soundcloud.com/blog/smashing-pumpkins-use-premiere-1-5-beta-to-debut-oceania_next.soundcloud.com":"https://developers.soundcloud.com/blog/next.soundcloud.com","https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/de58b17e8e6a61d895298deefbfbd4d6/e11df/pairing-illustrations-1.png":"https://developers.soundcloud.com/blog/static/de58b17e8e6a61d895298deefbfbd4d6/e11df/pairing-illustrations-1.png","https://developers.soundcloud.com/blog/the-next-app-gallery-update_mailto:api@soundcloud.com":"mailto:api@soundcloud.com","https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf_mailto:lee@soundcloud.com":"mailto:lee@soundcloud.com","https://developers.soundcloud.com/blog/remote-device-sign-in_/blog/static/38fbf30a70c481bb27226a36390f8ce5/e11df/pairing-illustrations-5.png":"https://developers.soundcloud.com/blog/static/38fbf30a70c481bb27226a36390f8ce5/e11df/pairing-illustrations-5.png","https://developers.soundcloud.com/blog/pennapps-recap_/blog/static/f4dcd6a46d940501cc67ab04694d0b03/df2c7/livetale.jpg":"https://developers.soundcloud.com/blog/static/f4dcd6a46d940501cc67ab04694d0b03/df2c7/livetale.jpg","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_posts/pdkp_summary_dashboard.png":"https://developers.soundcloud.com/blog/posts/pdkp_summary_dashboard.png","https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture_/blog/static/1ea986f39dad63df30336c9283c35bda/1f853/branching.jpg":"https://developers.soundcloud.com/blog/static/1ea986f39dad63df30336c9283c35bda/1f853/branching.jpg","https://developers.soundcloud.com/blog/introducing-the-large-hadron-migrator-3_/blog/static/e8a883f8e52683da109209f5341d150c/48a11/958035425_abb70e79b1.jpg":"https://developers.soundcloud.com/blog/static/e8a883f8e52683da109209f5341d150c/48a11/958035425_abb70e79b1.jpg","https://developers.soundcloud.com/blog/defining-a-role-with-a-retrospective-activity_/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/c3ac2/ios-platform-lead-role.jpg":"https://developers.soundcloud.com/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/c3ac2/ios-platform-lead-role.jpg","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/54e54/e1.png":"https://developers.soundcloud.com/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/54e54/e1.png","https://developers.soundcloud.com/blog/javascript-sdk_/blog/static/6c7832499ba160d91a482087ca6c54f3/96300/record-example.png":"https://developers.soundcloud.com/blog/static/6c7832499ba160d91a482087ca6c54f3/96300/record-example.png","https://developers.soundcloud.com/blog/html5-widget-api_/blog/static/e0f4c43c1c010b26b98e338381deec51/249e6/html5-api.png":"https://developers.soundcloud.com/blog/static/e0f4c43c1c010b26b98e338381deec51/249e6/html5-api.png","https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture_/blog/static/5c33e0ea39caa8b298ce951793d378d5/54e54/e4.png":"https://developers.soundcloud.com/blog/static/5c33e0ea39caa8b298ce951793d378d5/54e54/e4.png","https://developers.soundcloud.com/blog/soundclouds-data-science-process_/blog/static/bd6dc01f8d572a606882bc87996bfe14/d19c0/ds_process_example.png":"https://developers.soundcloud.com/blog/static/bd6dc01f8d572a606882bc87996bfe14/d19c0/ds_process_example.png","https://developers.soundcloud.com/blog/sharing-to-facebook-twitter-etc_/blog/docs/api/playlists#social-sharing":"https://developers.soundcloud.com/blog/docs/api/playlists#social-sharing","https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith_/blog/static/ebb4b534084c91b368f7641a794fd7cb/67d4f/product-engineering-diagram-1.jpg":"https://developers.soundcloud.com/blog/static/ebb4b534084c91b368f7641a794fd7cb/67d4f/product-engineering-diagram-1.jpg","https://developers.soundcloud.com/blog/periskop-exception-monitoring-service_mailto:periskop-maintainers@soundcloud.com":"mailto:periskop-maintainers@soundcloud.com","https://developers.soundcloud.com/blog/introducing-the-cloudseeder-devkit_/blog/static/f714bfe686c46edd22b8be909f62f905/c5a17/cloudseeder_select.png":"https://developers.soundcloud.com/blog/static/f714bfe686c46edd22b8be909f62f905/c5a17/cloudseeder_select.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/e73797046b8aa406329cb906069e466b/d9f6f/code_inventory_visualized.png":"https://developers.soundcloud.com/blog/static/e73797046b8aa406329cb906069e466b/d9f6f/code_inventory_visualized.png","https://developers.soundcloud.com/blog/quality-mobile-trains_/blog/static/5686bfe2d61df3b995d97dfddfa7b051/aa1b0/slack-message.png":"https://developers.soundcloud.com/blog/static/5686bfe2d61df3b995d97dfddfa7b051/aa1b0/slack-message.png","https://developers.soundcloud.com/blog/tenacious-d-s-fenix-rizes-with-soundcloud_/blog/static/abc0fb4d58b738f63ae37a9d59deff25/2cf63/fenix.png":"https://developers.soundcloud.com/blog/static/abc0fb4d58b738f63ae37a9d59deff25/2cf63/fenix.png","https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime_/blog/static/35c55e88dd9e42b3a19ade9557142471/4b160/products_in_wip.png":"https://developers.soundcloud.com/blog/static/35c55e88dd9e42b3a19ade9557142471/4b160/products_in_wip.png","https://developers.soundcloud.com/blog/roshi-a-crdt-system-for-timestamped-events_/blog/static/94700c78a46380cc5a7e80e582757b89/6cdf8/fan-out-on-write.png":"https://developers.soundcloud.com/blog/static/94700c78a46380cc5a7e80e582757b89/6cdf8/fan-out-on-write.png","https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf_/blog/static/1297efc7957969977f4d573057196bc5/48a11/whsprs-demo.jpg":"https://developers.soundcloud.com/blog/static/1297efc7957969977f4d573057196bc5/48a11/whsprs-demo.jpg","https://developers.soundcloud.com/blog/how-to-make-a-soundcloud-powered-toy_/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/48a11/wehack.jpg":"https://developers.soundcloud.com/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/48a11/wehack.jpg","https://developers.soundcloud.com/blog/sponsoring-cocoapods_/blog/static/c2a2b9555b3a32361e0c47d898c26c87/e14eb/logos-small.png":"https://developers.soundcloud.com/blog/static/c2a2b9555b3a32361e0c47d898c26c87/e14eb/logos-small.png","https://developers.soundcloud.com/blog/story-hack-recap_/blog/static/2f758e7aa3dba16714272b363425b8f9/df2c7/storyhack.jpg":"https://developers.soundcloud.com/blog/static/2f758e7aa3dba16714272b363425b8f9/df2c7/storyhack.jpg","https://developers.soundcloud.com/blog/soundclouds-data-science-process_mailto:demir@soundcloud.com":"mailto:demir@soundcloud.com","https://developers.soundcloud.com/blog/buzzwords-contest_/blog/static/c205b7d9d328c0738c46f04b092375b8/635b1/mag.png":"https://developers.soundcloud.com/blog/static/c205b7d9d328c0738c46f04b092375b8/635b1/mag.png","https://developers.soundcloud.com/blog/stream-and-download_/blog/docs/api/guide#playing":"https://developers.soundcloud.com/blog/docs/api/guide#playing","https://developers.soundcloud.com/blog/stream-and-download_/blog/docs/html5-widget":"https://developers.soundcloud.com/blog/docs/html5-widget","https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud_/blog/static/73e66afa598fa581f386392d5d026075/d5c82/search_latency.png":"https://developers.soundcloud.com/blog/static/73e66afa598fa581f386392d5d026075/d5c82/search_latency.png"},"extra111_proxyServerAndStatMap":{"http://us-032.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-037.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-002.herokuapp.com/":{"failCount":0,"successCount":3,"resultList":[200,200,200]},"http://us-007.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-028.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[404,200]},"http://us-52.herokuapp.com/":{"failCount":0,"successCount":4,"resultList":[200,200,200,200]},"http://us-011.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]},"http://us-025.herokuapp.com/":{"failCount":1,"successCount":2,"resultList":[200,200,null]},"http://us-020.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-54.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[404]},"http://europe69.herokuapp.com/":{"failCount":0,"successCount":3,"resultList":[200,200,200]},"http://us-004.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://europe-57.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[404]},"http://europe64.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[null]},"http://europe-22.herokuapp.com/":{"failCount":1,"successCount":2,"resultList":[200,200,404]},"http://us-016.herokuapp.com/":{"failCount":1,"successCount":4,"resultList":[200,404,200,200,200]},"http://europe-24.herokuapp.com/":{"failCount":0,"successCount":3,"resultList":[200,200,200]},"http://us-55.herokuapp.com/":{"failCount":0,"successCount":3,"resultList":[200,200,200]},"http://europe61.herokuapp.com/":{"failCount":2,"successCount":1,"resultList":[200,404,null]},"http://us-030.herokuapp.com/":{"failCount":1,"successCount":3,"resultList":[200,200,404,200]},"http://us-009.herokuapp.com/":{"failCount":0,"successCount":5,"resultList":[200,200,200,200,200]},"http://us-026.herokuapp.com/":{"failCount":1,"successCount":5,"resultList":[200,200,200,200,200,null]},"http://us-001.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://europe-25.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-031.herokuapp.com/":{"failCount":0,"successCount":3,"resultList":[200,200,200]},"http://europe62.herokuapp.com/":{"failCount":0,"successCount":3,"resultList":[200,200,200]},"http://us-014.herokuapp.com/":{"failCount":0,"successCount":4,"resultList":[200,200,200,200]},"http://us-027.herokuapp.com/":{"failCount":0,"successCount":4,"resultList":[200,200,200,200]},"http://europe-56.herokuapp.com/":{"failCount":1,"successCount":2,"resultList":[200,200,404]},"http://us-53.herokuapp.com/":{"failCount":1,"successCount":6,"resultList":[404,200,200,200,200,200,200]},"http://europe68.herokuapp.com/":{"failCount":0,"successCount":3,"resultList":[200,200,200]},"http://europe63.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[404]},"http://us-015.herokuapp.com/":{"failCount":1,"successCount":2,"resultList":[200,200,null]},"http://europe-60.herokuapp.com/":{"failCount":1,"successCount":0,"resultList":[404]},"http://us-024.herokuapp.com/":{"failCount":1,"successCount":4,"resultList":[200,200,200,200,404]},"http://europe70.herokuapp.com/":{"failCount":0,"successCount":3,"resultList":[200,200,200]},"http://us-038.herokuapp.com/":{"failCount":1,"successCount":2,"resultList":[404,200,200]},"http://europe-23.herokuapp.com/":{"failCount":1,"successCount":5,"resultList":[200,200,200,200,200,null]},"http://us-017.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://europe21.herokuapp.com/":{"failCount":1,"successCount":3,"resultList":[200,200,200,null]},"http://us-033.herokuapp.com/":{"failCount":1,"successCount":4,"resultList":[200,200,404,200,200]},"http://us-003.herokuapp.com/":{"failCount":1,"successCount":2,"resultList":[200,200,null]},"http://us-008.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]},"http://us-029.herokuapp.com/":{"failCount":2,"successCount":1,"resultList":[200,null,null]},"http://us-012.herokuapp.com/":{"failCount":1,"successCount":5,"resultList":[200,200,200,200,200,null]},"http://us-018.herokuapp.com/":{"failCount":2,"successCount":1,"resultList":[404,200,null]},"http://europe65.herokuapp.com/":{"failCount":0,"successCount":4,"resultList":[200,200,200,200]},"http://us-021.herokuapp.com/":{"failCount":1,"successCount":5,"resultList":[200,200,200,200,200,null]},"http://us-005.herokuapp.com/":{"failCount":0,"successCount":3,"resultList":[200,200,200]},"http://us-034.herokuapp.com/":{"failCount":0,"successCount":5,"resultList":[200,200,200,200,200]},"http://europe-58.herokuapp.com/":{"failCount":0,"successCount":2,"resultList":[200,200]},"http://us-035.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,404]},"http://europe66.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,404]},"http://us-022.herokuapp.com/":{"failCount":2,"successCount":0,"resultList":[404,null]},"http://us-006.herokuapp.com/":{"failCount":2,"successCount":1,"resultList":[200,404,null]},"http://us-036.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-019.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[404,200]},"http://us-010.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[404,200]},"http://europe67.herokuapp.com/":{"failCount":1,"successCount":1,"resultList":[200,null]},"http://us-51.herokuapp.com/":{"failCount":0,"successCount":4,"resultList":[200,200,200,200]},"http://us-040.herokuapp.com/":{"failCount":1,"successCount":2,"resultList":[200,200,404]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24119721339192_raw.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":91,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:37","host":"us-038*","referer":"https://developers.soundcloud.com/blog/smashing-pumpkins-use-premiere-1-5-beta-to-debut-oceania","linkMd5ListStr":"d64d6ee96585661311bf713f2d9785ea,d64d6ee96585661311bf713f2d9785ea","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/59a9eaf274f54dee6ae50e1ee9894ef2/54e54/e1.png","sourceStatusCode":200,"destWidth":580,"destHeight":30,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn45@2020_1/2020/08/25/00-49-37-157_c93d9435c88d45ae.webp","sourceBytes":2017,"destBytes":3344,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":973,"convertSpendMs":4,"createdTime":"2020-08-25 08:49:37","host":"europe21*","referer":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","linkMd5ListStr":"617d6d78a6d4ea6c18a0ca90fa588e57,617d6d78a6d4ea6c18a0ca90fa588e57","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"2 KB","destSize":"3.3 KB","compressRate":"165.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/43f261f9f2ab08ca0da36ec14bd626a4/6c314/request_process.png","sourceStatusCode":200,"destWidth":544,"destHeight":167,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn72@2020_4/2020/08/25/00-49-37-151_33cb495219527a46.webp","sourceBytes":6509,"destBytes":11460,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":998,"convertSpendMs":5,"createdTime":"2020-08-25 08:49:37","host":"europe63*","referer":"https://developers.soundcloud.com/blog/managing-unplanned-and-support-tasks","linkMd5ListStr":"ab6b8f60b8531d732d1420a3c4a8c8cc,ab6b8f60b8531d732d1420a3c4a8c8cc","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.4 KB","destSize":"11.2 KB","compressRate":"176.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0d6cb4d2bc96d07a757427300c43775a/a296c/trackscreen.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn65@2020_2/2020/08/25/00-49-37-245_441dcdf3a03fec12.webp","sourceBytes":8416,"destBytes":5906,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1096,"convertSpendMs":14,"createdTime":"2020-08-25 08:49:37","host":"europe68*","referer":"https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture","linkMd5ListStr":"67a5a2e60f7bb11708bee110bec4ba4a,67a5a2e60f7bb11708bee110bec4ba4a","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.2 KB","destSize":"5.8 KB","compressRate":"70.2%"},{"code":1,"isDone":false,"source":"http://oauth.net/images/oauth-2-sm.png","sourceStatusCode":200,"destWidth":124,"destHeight":123,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn2@2020_1/2020/08/25/00-49-37-389_612e86863fc14120.webp","sourceBytes":13391,"destBytes":5198,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":920,"convertSpendMs":6,"createdTime":"2020-08-25 08:49:37","host":"us-013*","referer":"https://developers.soundcloud.com/blog/sharing-sounds","linkMd5ListStr":"64bb3b1d574d8ffd7416368292865e77,64bb3b1d574d8ffd7416368292865e77","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"13.1 KB","destSize":"5.1 KB","compressRate":"38.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/561d0e6c1e3cb8af10b5fa9b61d34944/8939e/original3-1.png","sourceStatusCode":200,"destWidth":505,"destHeight":379,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn9@2020_4/2020/08/25/00-49-37-182_2fb9318516e541e5.webp","sourceBytes":24390,"destBytes":10638,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1093,"convertSpendMs":11,"createdTime":"2020-08-25 08:49:37","host":"europe64*","referer":"https://developers.soundcloud.com/blog/marbleo.us","linkMd5ListStr":"4a05e8fd6978c0c26c70489b4245773f,4a05e8fd6978c0c26c70489b4245773f","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"23.8 KB","destSize":"10.4 KB","compressRate":"43.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/9f2bb119f1570b22f3d0f703746adc51/a296c/banner.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":418,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn55@2020_4/2020/08/25/00-49-37-163_e078dc9f25bf9803.webp","sourceBytes":18325,"destBytes":21332,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1120,"convertSpendMs":14,"createdTime":"2020-08-25 08:49:37","host":"europe-25*","referer":"https://developers.soundcloud.com/blog/dark-mode-observer-pattern","linkMd5ListStr":"e8916382f7641a2823b21fd1cca4773a,e8916382f7641a2823b21fd1cca4773a","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"17.9 KB","destSize":"20.8 KB","compressRate":"116.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/eeafeb4fdbe62b6686721e1ebf068086/8ff1e/dob-network-stubbing-start.png","sourceStatusCode":200,"destWidth":800,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn86@2020_6/2020/08/25/00-49-37-178_b1b824e0fec29ab2.webp","sourceBytes":18698,"destBytes":16818,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1164,"convertSpendMs":20,"createdTime":"2020-08-25 08:49:37","host":"europe-22*","referer":"https://developers.soundcloud.com/blog/automatic-stubbing-of-network-requests-to-de-flakify-automation-testing","linkMd5ListStr":"1aaf1ca40160c5116972179b4e1bb305,1aaf1ca40160c5116972179b4e1bb305","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"18.3 KB","destSize":"16.4 KB","compressRate":"89.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/b0c15442b3e61d6b97a050f20b2689a1/8ff1e/github-comment.png","sourceStatusCode":200,"destWidth":800,"destHeight":266,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn91@2020_3/2020/08/25/00-49-37-209_19018e61ae3dc55a.webp","sourceBytes":13990,"destBytes":14880,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1188,"convertSpendMs":8,"createdTime":"2020-08-25 08:49:37","host":"europe67*","referer":"https://developers.soundcloud.com/blog/quality-mobile-trains","linkMd5ListStr":"655377572ca618cedb5c80aefa47a904,655377572ca618cedb5c80aefa47a904","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"13.7 KB","destSize":"14.5 KB","compressRate":"106.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0cf3edd86f936113ae3447faaf202966/2cf63/competition.png","sourceStatusCode":200,"destWidth":550,"destHeight":317,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn90@2020_5/2020/08/25/00-49-37-185_3e8eea38fb2f57a0.webp","sourceBytes":44279,"destBytes":28346,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1214,"convertSpendMs":10,"createdTime":"2020-08-25 08:49:37","host":"europe-60*","referer":"https://developers.soundcloud.com/blog/competition-app","linkMd5ListStr":"b733a1edefe5ee8fd8cd6bb8a58e817d,b733a1edefe5ee8fd8cd6bb8a58e817d","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43.2 KB","destSize":"27.7 KB","compressRate":"64%"},{"code":1,"isDone":false,"source":"http://farm8.staticflickr.com/7164/6449320395_c39bd50b92_d.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":332,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn54@2020_2/2020/08/25/00-49-37-444_251bb8124dce40c1.webp","sourceBytes":34912,"destBytes":14404,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1049,"convertSpendMs":9,"createdTime":"2020-08-25 08:49:37","host":"us-029*","referer":"https://developers.soundcloud.com/blog/music-hack-day-london-2011","linkMd5ListStr":"79f3b3462e4f06843f8b0b6c4fe8b454,79f3b3462e4f06843f8b0b6c4fe8b454","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"34.1 KB","destSize":"14.1 KB","compressRate":"41.3%"},{"code":1,"isDone":false,"source":"https://backstage.soundcloud.com/wp-content/uploads/2012/03/retrospective_big-505x377.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":806,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:37","host":"us-029*","referer":"https://developers.soundcloud.com/blog/how-we-do-retrospectives","linkMd5ListStr":"02a36ba61b526be9e01abde68cfc481d,02a36ba61b526be9e01abde68cfc481d","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://farm1.static.flickr.com/40/85477841_b3f1452719_z_d.jpg","sourceStatusCode":200,"destWidth":640,"destHeight":422,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn18@2020_4/2020/08/25/00-49-37-442_c8df2f4a33b7fcb0.webp","sourceBytes":152117,"destBytes":64494,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1121,"convertSpendMs":20,"createdTime":"2020-08-25 08:49:37","host":"us-029*","referer":"https://developers.soundcloud.com/blog/velocity-conference-2011-europe","linkMd5ListStr":"2005f19320d0eefb8b44b98b5648e4ec,2005f19320d0eefb8b44b98b5648e4ec","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"148.6 KB","destSize":"63 KB","compressRate":"42.4%"},{"code":1,"isDone":false,"source":"http://farm7.static.flickr.com/6098/6315685375_04f9b28079_z.jpg","sourceStatusCode":200,"destWidth":640,"destHeight":425,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn62@2020_2/2020/08/25/00-49-37-483_e3ce2fd1270d2229.webp","sourceBytes":89870,"destBytes":45660,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1107,"convertSpendMs":29,"createdTime":"2020-08-25 08:49:37","host":"us-005*","referer":"https://developers.soundcloud.com/blog/music-hack-day-boston-2011","linkMd5ListStr":"a489b9ea33afa90e83f88ed56c7c84d1,a489b9ea33afa90e83f88ed56c7c84d1","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"87.8 KB","destSize":"44.6 KB","compressRate":"50.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/32c3986a57ccc05df110971382a6512a/2cf63/stratus2-beta.png","sourceStatusCode":200,"destWidth":550,"destHeight":376,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn45@2020_4/2020/08/25/00-49-37-182_2e90e8ad6e40e901.webp","sourceBytes":17655,"destBytes":13466,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1307,"convertSpendMs":9,"createdTime":"2020-08-25 08:49:37","host":"europe64*","referer":"https://developers.soundcloud.com/blog/stratus-2-beta","linkMd5ListStr":"837aabdfb380892539f5756be934664e,837aabdfb380892539f5756be934664e","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"17.2 KB","destSize":"13.2 KB","compressRate":"76.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/bb110ebe55e84aad2c7f8a59340e75ee/bubble.svg","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn13@2020_4/2020/08/25/00-49-37-599_5e0d4a66d45afc3d.svg","sourceBytes":456,"destBytes":456,"feedId":10291,"totalSpendMs":1138,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:37","host":"us-51*","referer":"https://developers.soundcloud.com/blog/keeping-counts-in-sync","linkMd5ListStr":"15e0b5215de1cee87672a5788e8bc0b1,15e0b5215de1cee87672a5788e8bc0b1","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"456 B","destSize":"456 B","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/5d0dcb8ac21a9ae439c45efd433b2870/a5ed1/waveform_rendering_cpu.png","sourceStatusCode":200,"destWidth":620,"destHeight":423,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn43@2020_3/2020/08/25/00-49-37-193_4690647b36b4ec80.webp","sourceBytes":32297,"destBytes":28404,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1405,"convertSpendMs":13,"createdTime":"2020-08-25 08:49:37","host":"europe70*","referer":"https://developers.soundcloud.com/blog/ios-waveform-rendering","linkMd5ListStr":"8e813ef74b6373575f09190520cbac28,8e813ef74b6373575f09190520cbac28","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"31.5 KB","destSize":"27.7 KB","compressRate":"87.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/4c740be23bd4eeba13011264809c5994/ae69b/playing.png","sourceStatusCode":200,"destWidth":113,"destHeight":113,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn5@2020_4/2020/08/25/00-49-37-642_7a8fe105a73b37ff.webp","sourceBytes":1737,"destBytes":3420,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1229,"convertSpendMs":5,"createdTime":"2020-08-25 08:49:37","host":"us-001*","referer":"https://developers.soundcloud.com/blog/building-the-next-soundcloud","linkMd5ListStr":"e6bf24ccfd2d4d421302716717b1cfec,e6bf24ccfd2d4d421302716717b1cfec","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.7 KB","destSize":"3.3 KB","compressRate":"196.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/917e9d55a63002b2f03ea66ef19b70d8/48a11/pennapps.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":375,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn97@2020_4/2020/08/25/00-49-37-633_ddf59dbbe7ef7dad.webp","sourceBytes":13885,"destBytes":14914,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1226,"convertSpendMs":9,"createdTime":"2020-08-25 08:49:37","host":"us-025*","referer":"https://developers.soundcloud.com/blog/pennapps-recap","linkMd5ListStr":"b27715d5d2a8093929774bbb15a3b2c6,b27715d5d2a8093929774bbb15a3b2c6","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"13.6 KB","destSize":"14.6 KB","compressRate":"107.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/cbfbd52b0009558a2ef89e02d1aad58b/f570f/heartbleed.png","sourceStatusCode":200,"destWidth":341,"destHeight":413,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn33@2020_4/2020/08/25/00-49-37-652_b994b91a1b6d69db.webp","sourceBytes":3454,"destBytes":7598,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1237,"convertSpendMs":8,"createdTime":"2020-08-25 08:49:37","host":"us-55*","referer":"https://developers.soundcloud.com/blog/heartbleed","linkMd5ListStr":"3f7b77d5ab0c5c6bf947ff7a32fab64e,3f7b77d5ab0c5c6bf947ff7a32fab64e","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.4 KB","destSize":"7.4 KB","compressRate":"220%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/553cec1abb4f689ca597fbe7d124edd8/22492/dataset-semantics.png","sourceStatusCode":200,"destWidth":540,"destHeight":241,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn70@2020_6/2020/08/25/00-49-37-645_384e6ffa1a1846f0.webp","sourceBytes":7120,"destBytes":14982,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1248,"convertSpendMs":8,"createdTime":"2020-08-25 08:49:37","host":"us-55*","referer":"https://developers.soundcloud.com/blog/a-better-model-of-data-ownership","linkMd5ListStr":"81ac367778605dafa205f894368fee2d,81ac367778605dafa205f894368fee2d","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7 KB","destSize":"14.6 KB","compressRate":"210.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/42ad0c25d706a6ab9bba1c74244ebf5d/249e6/waveraid.png","sourceStatusCode":200,"destWidth":520,"destHeight":342,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn29@2020_2/2020/08/25/00-49-37-268_0df2a43177b2cc80.webp","sourceBytes":56735,"destBytes":37190,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1423,"convertSpendMs":11,"createdTime":"2020-08-25 08:49:37","host":"europe68*","referer":"https://developers.soundcloud.com/blog/wave-raid","linkMd5ListStr":"dbdef8361976c739b05fe4b0b6f36467,dbdef8361976c739b05fe4b0b6f36467","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"55.4 KB","destSize":"36.3 KB","compressRate":"65.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/9e68a73a9b66c964410db209cf4ee787/a296c/soundcloud_stats_screenshot.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":408,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn22@2020_1/2020/08/25/00-49-37-649_a662495e3f4d48a0.webp","sourceBytes":20906,"destBytes":19408,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1272,"convertSpendMs":17,"createdTime":"2020-08-25 08:49:37","host":"us-017*","referer":"https://developers.soundcloud.com/blog/real-time-counts-with-stitch","linkMd5ListStr":"95f32efbd2ba084266d03a2e8d0bb67c,95f32efbd2ba084266d03a2e8d0bb67c","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"20.4 KB","destSize":"19 KB","compressRate":"92.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/6c7832499ba160d91a482087ca6c54f3/96300/record-example.png","sourceStatusCode":200,"destWidth":519,"destHeight":131,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn60@2020_4/2020/08/25/00-49-37-641_0090f9e908078b19.webp","sourceBytes":6563,"destBytes":8100,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1243,"convertSpendMs":10,"createdTime":"2020-08-25 08:49:37","host":"us-024*","referer":"https://developers.soundcloud.com/blog/javascript-sdk","linkMd5ListStr":"8b9eea25fd3ee1fa7956b603676601f8,8b9eea25fd3ee1fa7956b603676601f8","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.4 KB","destSize":"7.9 KB","compressRate":"123.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/5029c683c9dcd142b5276343646200ed/8ff1e/image3.png","sourceStatusCode":200,"destWidth":800,"destHeight":456,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn50@2020_3/2020/08/25/00-49-37-637_07dc701f6525d285.webp","sourceBytes":9731,"destBytes":31630,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1263,"convertSpendMs":31,"createdTime":"2020-08-25 08:49:37","host":"us-51*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2","linkMd5ListStr":"2a094ed2b890cb88dd022b4f84947b7c,2a094ed2b890cb88dd022b4f84947b7c","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"9.5 KB","destSize":"30.9 KB","compressRate":"325%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/6ce7cbc21f85a59ae3ab7712a969b0c3/microservice_graph.svg","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn74@2020_3/2020/08/25/00-49-37-643_cc75cd744155aaba.svg","sourceBytes":19968,"destBytes":19968,"feedId":10291,"totalSpendMs":1230,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:37","host":"us-033*","referer":"https://developers.soundcloud.com/blog/inside-a-soundcloud-microservice","linkMd5ListStr":"345279736b0b6d64e3b17757d12d615d,345279736b0b6d64e3b17757d12d615d","githubUser":"myreaderx21","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"19.5 KB","destSize":"19.5 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/bd6dc01f8d572a606882bc87996bfe14/d19c0/ds_process_example.png","sourceStatusCode":200,"destWidth":500,"destHeight":352,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn93@2020_6/2020/08/25/00-49-37-665_8bc486d10e00ddec.webp","sourceBytes":4623,"destBytes":14904,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1277,"convertSpendMs":18,"createdTime":"2020-08-25 08:49:37","host":"us-037*","referer":"https://developers.soundcloud.com/blog/soundclouds-data-science-process","linkMd5ListStr":"cf758bfefb0e4362070df577ccd6ac19,cf758bfefb0e4362070df577ccd6ac19","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"4.5 KB","destSize":"14.6 KB","compressRate":"322.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/17b23d599c14549fa785e6603e0f4344/fe994/indexing_pipeline.png","sourceStatusCode":200,"destWidth":593,"destHeight":680,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn64@2020_5/2020/08/25/00-49-37-696_a4873881372b41f2.webp","sourceBytes":12538,"destBytes":34246,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1298,"convertSpendMs":19,"createdTime":"2020-08-25 08:49:37","host":"us-012*","referer":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud","linkMd5ListStr":"b48d9296f462bc043ccc5738e0ea3485,b48d9296f462bc043ccc5738e0ea3485","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.2 KB","destSize":"33.4 KB","compressRate":"273.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/2f758e7aa3dba16714272b363425b8f9/df2c7/storyhack.jpg","sourceStatusCode":200,"destWidth":450,"destHeight":450,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn87@2020_1/2020/08/25/00-49-37-715_4022cb46be3cee60.webp","sourceBytes":18230,"destBytes":22532,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1288,"convertSpendMs":19,"createdTime":"2020-08-25 08:49:37","host":"us-004*","referer":"https://developers.soundcloud.com/blog/story-hack-recap","linkMd5ListStr":"35e86c48165c154a7a06561e317253f9,35e86c48165c154a7a06561e317253f9","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"17.8 KB","destSize":"22 KB","compressRate":"123.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/8ba927893bc96a3cddf08e9bbe54c8f2/48a11/toronto.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":247,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn1@2020_5/2020/08/25/00-49-37-667_d343b8ea63b061df.webp","sourceBytes":8639,"destBytes":11906,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1273,"convertSpendMs":13,"createdTime":"2020-08-25 08:49:37","host":"us-033*","referer":"https://developers.soundcloud.com/blog/music-hack-day-toronto","linkMd5ListStr":"503c93fee35923263b057332fcef1561,503c93fee35923263b057332fcef1561","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.4 KB","destSize":"11.6 KB","compressRate":"137.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/6ad4784882b3758430eea84a3c25486b/prometheus_architecture.svg","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn84@2020_4/2020/08/25/00-49-37-671_b9f090eee9ffe3f9.svg","sourceBytes":26266,"destBytes":26266,"feedId":10291,"totalSpendMs":1298,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:37","host":"us-016*","referer":"https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud","linkMd5ListStr":"f97e1f94d709bd0c92f56241478cd401,f97e1f94d709bd0c92f56241478cd401","githubUser":"myreaderx21","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"25.7 KB","destSize":"25.7 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/c2a2b9555b3a32361e0c47d898c26c87/e14eb/logos-small.png","sourceStatusCode":200,"destWidth":278,"destHeight":130,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn51@2020_3/2020/08/25/00-49-37-700_483cd99d9b633c8a.webp","sourceBytes":3252,"destBytes":5294,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1345,"convertSpendMs":26,"createdTime":"2020-08-25 08:49:37","host":"us-036*","referer":"https://developers.soundcloud.com/blog/sponsoring-cocoapods","linkMd5ListStr":"357e63de037c09a5678a197bd61f26ca,357e63de037c09a5678a197bd61f26ca","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.2 KB","destSize":"5.2 KB","compressRate":"162.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/8ab74287b4c087ff584c878847bb6439/48a11/hackers.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":375,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn67@2020_4/2020/08/25/00-49-37-189_165f4e02805fa248.webp","sourceBytes":27346,"destBytes":35546,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1600,"convertSpendMs":12,"createdTime":"2020-08-25 08:49:37","host":"europe68*","referer":"https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf","linkMd5ListStr":"15f673584ea6f54247384e89ce11b72c,15f673584ea6f54247384e89ce11b72c","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"26.7 KB","destSize":"34.7 KB","compressRate":"130%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/695b2812efc27f2a4da8c7a84aa7ac21/e49a9/jupiter_earth.png","sourceStatusCode":200,"destWidth":640,"destHeight":480,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn80@2020_5/2020/08/25/00-49-37-768_36012f33265ab9bb.webp","sourceBytes":58887,"destBytes":16664,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1382,"convertSpendMs":18,"createdTime":"2020-08-25 08:49:37","host":"us-028*","referer":"https://developers.soundcloud.com/blog/tuist-project-generation","linkMd5ListStr":"b1b7ea6f021159bbe86db6b0da568bf3,b1b7ea6f021159bbe86db6b0da568bf3","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"57.5 KB","destSize":"16.3 KB","compressRate":"28.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/45a70551b98044234e736cc9106dd3f7/4c799/are-we-playing-yet.jpg","sourceStatusCode":200,"destWidth":379,"destHeight":278,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn9@2020_5/2020/08/25/00-49-37-749_1d21e8854f165b29.webp","sourceBytes":10104,"destBytes":12768,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1014,"convertSpendMs":6,"createdTime":"2020-08-25 08:49:37","host":"europe64*","referer":"https://developers.soundcloud.com/blog/soundcloud-launches-the-html5-audio-improvement-initiative","linkMd5ListStr":"8287c953457e19277b175ad6423b25ad,8287c953457e19277b175ad6423b25ad","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"9.9 KB","destSize":"12.5 KB","compressRate":"126.4%"},{"code":1,"isDone":false,"source":"https://upload.wikimedia.org/wikipedia/commons/4/4a/Animation_of_the_Naive_Mark_and_Sweep_Garbage_Collector_Algorithm.gif","sourceStatusCode":200,"destWidth":420,"destHeight":321,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn57@2020_4/2020/08/25/00-49-37-767_a9ea7d365c2f9428.webp","sourceBytes":147344,"destBytes":85754,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1542,"convertSpendMs":151,"createdTime":"2020-08-25 08:49:37","host":"us-017*","referer":"https://developers.soundcloud.com/blog/garbage-collection-in-redux-applications","linkMd5ListStr":"52715b91b32b85b6f9843f907f39b609,52715b91b32b85b6f9843f907f39b609","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"143.9 KB","destSize":"83.7 KB","compressRate":"58.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/c6f5381bbfbad6246acf19130fa69aec/8ff1e/artem_engineering_town_hall.png","sourceStatusCode":200,"destWidth":800,"destHeight":447,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn25@2020_5/2020/08/25/00-49-37-947_bc03cfc755b45670.webp","sourceBytes":75166,"destBytes":24408,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1538,"convertSpendMs":139,"createdTime":"2020-08-25 08:49:37","host":"us-005*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666,db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx23","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"73.4 KB","destSize":"23.8 KB","compressRate":"32.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/1b03927c03fc6c6558164d1b0bad3897/8939e/destroyed.png","sourceStatusCode":200,"destWidth":505,"destHeight":379,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn81@2020_3/2020/08/25/00-49-37-866_8d1852442313f12b.webp","sourceBytes":23955,"destBytes":16200,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1538,"convertSpendMs":74,"createdTime":"2020-08-25 08:49:37","host":"us-009*","referer":"https://developers.soundcloud.com/blog/experiment-02-destroying-soundcloud-instagram","linkMd5ListStr":"9fdc4321c8110441beb066136d226f81,9fdc4321c8110441beb066136d226f81","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"23.4 KB","destSize":"15.8 KB","compressRate":"67.6%"},{"code":1,"isDone":false,"source":"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/timedcomment2.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":262,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"europe64*","referer":"https://developers.soundcloud.com/blog/rich-media-using-timed-comments","linkMd5ListStr":"a6004534db173619f1f08181f03ef8ad,a6004534db173619f1f08181f03ef8ad","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/68ddbda0aacdf5ed4b8dc29f35f7da6a/8ff1e/droidcon-sf-speaker-image.png","sourceStatusCode":200,"destWidth":800,"destHeight":419,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn77@2020_1/2020/08/25/00-49-38-068_d410104545cbb6cc.webp","sourceBytes":109577,"destBytes":59216,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1716,"convertSpendMs":99,"createdTime":"2020-08-25 08:49:37","host":"us-021*","referer":"https://developers.soundcloud.com/blog/dagger-reflect","linkMd5ListStr":"e7843e3c8d7edf648d14eda3b1179958,e7843e3c8d7edf648d14eda3b1179958","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"107 KB","destSize":"57.8 KB","compressRate":"54%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/search-infra1.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":104,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"us-025*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca,a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131769094098_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":597,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"europe-25*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18,4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"http://farm4.staticflickr.com/3309/3527478421_c414163966.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":375,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn18@2020_4/2020/08/25/00-49-38-429_4a08e6f2d8199488.webp","sourceBytes":45594,"destBytes":21318,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1159,"convertSpendMs":18,"createdTime":"2020-08-25 08:49:38","host":"us-033*","referer":"https://developers.soundcloud.com/blog/lets-go-backstage-welcome-to-the-soundcloud-development-blog","linkMd5ListStr":"ca3a045c5a0779a56e19168840bdc0ef,ca3a045c5a0779a56e19168840bdc0ef","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"44.5 KB","destSize":"20.8 KB","compressRate":"46.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/abc0fb4d58b738f63ae37a9d59deff25/2cf63/fenix.png","sourceStatusCode":200,"destWidth":550,"destHeight":400,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn14@2020_5/2020/08/25/00-49-38-580_391a653ed3d1e1b2.webp","sourceBytes":68328,"destBytes":20374,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1143,"convertSpendMs":11,"createdTime":"2020-08-25 08:49:38","host":"us-53*","referer":"https://developers.soundcloud.com/blog/tenacious-d-s-fenix-rizes-with-soundcloud","linkMd5ListStr":"e54bb8a516d9110ebfd156ddf5fc0626,e54bb8a516d9110ebfd156ddf5fc0626","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"66.7 KB","destSize":"19.9 KB","compressRate":"29.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/26291617b09e9b7665fb652c80924386/02744/cloudseeder.png","sourceStatusCode":200,"destWidth":560,"destHeight":372,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn41@2020_2/2020/08/25/00-49-38-528_4d5af186b6679960.webp","sourceBytes":6717,"destBytes":12870,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":976,"convertSpendMs":12,"createdTime":"2020-08-25 08:49:38","host":"us-51*","referer":"https://developers.soundcloud.com/blog/introducing-the-cloudseeder-devkit","linkMd5ListStr":"b3608559289da9cd03cfefee1a744b37,b3608559289da9cd03cfefee1a744b37","githubUser":"myreaderx23","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.6 KB","destSize":"12.6 KB","compressRate":"191.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/27134d3f37ae0be10d5b2522f4f96095/8ff1e/specta-vs-xctest.png","sourceStatusCode":200,"destWidth":800,"destHeight":493,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn38@2020_5/2020/08/25/00-49-38-341_3f5fe2b0ecf9dce6.webp","sourceBytes":41988,"destBytes":31890,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1234,"convertSpendMs":16,"createdTime":"2020-08-25 08:49:38","host":"europe62*","referer":"https://developers.soundcloud.com/blog/breaking-loose-from-third-party-lock-in-with-custom-refactoring-tools","linkMd5ListStr":"393197fc917d015bdfd2ffa5e014d1f4,393197fc917d015bdfd2ffa5e014d1f4","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"41 KB","destSize":"31.1 KB","compressRate":"76%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/d6dcc23daced4d6498c1619edd6e8036/135ae/no-spam.png","sourceStatusCode":200,"destWidth":300,"destHeight":300,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn58@2020_4/2020/08/25/00-49-38-432_0f0df79b6758b11c.webp","sourceBytes":7949,"destBytes":13992,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1114,"convertSpendMs":12,"createdTime":"2020-08-25 08:49:38","host":"europe70*","referer":"https://developers.soundcloud.com/blog/say-hello-to-sketchy-the-spam-fighter","linkMd5ListStr":"0f1105e6627ad57621f0807bef866e63,0f1105e6627ad57621f0807bef866e63","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.8 KB","destSize":"13.7 KB","compressRate":"176%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/9cbc68dfac58d901f12708b3843f7601/8939e/google-analytics-report.png","sourceStatusCode":200,"destWidth":505,"destHeight":200,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn90@2020_5/2020/08/25/00-49-38-600_0ab6b8e36480255a.webp","sourceBytes":10503,"destBytes":8956,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":967,"convertSpendMs":5,"createdTime":"2020-08-25 08:49:38","host":"europe66*","referer":"https://developers.soundcloud.com/blog/front-end-javascript-bug-tracking","linkMd5ListStr":"faf31d858376c6584d716294eeb6cc11,faf31d858376c6584d716294eeb6cc11","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"10.3 KB","destSize":"8.7 KB","compressRate":"85.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/19234e7e3b35bc10753e8bfd33a724b4/ef3f5/build_times_min14.png","sourceStatusCode":200,"destWidth":671,"destHeight":266,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn29@2020_4/2020/08/25/00-49-38-718_c3e731b42e56b98f.webp","sourceBytes":2371,"destBytes":9778,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1139,"convertSpendMs":14,"createdTime":"2020-08-25 08:49:38","host":"us-005*","referer":"https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2","linkMd5ListStr":"489725aa8909e81e9deac29a1b50c82b,489725aa8909e81e9deac29a1b50c82b","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"2.3 KB","destSize":"9.5 KB","compressRate":"412.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/1e36bb105d9a2786ae2026815a271763/e2288/radical-candor.jpg","sourceStatusCode":200,"destWidth":640,"destHeight":703,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn34@2020_2/2020/08/25/00-49-38-253_b49d72e489cab77e.webp","sourceBytes":19284,"destBytes":21610,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1337,"convertSpendMs":16,"createdTime":"2020-08-25 08:49:38","host":"europe21*","referer":"https://developers.soundcloud.com/blog/radical-candor-an-experience-report","linkMd5ListStr":"ee2a8acede8ba9fdc374f89c5d30736e,ee2a8acede8ba9fdc374f89c5d30736e","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"18.8 KB","destSize":"21.1 KB","compressRate":"112.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/b051382f9344df09700c36a57750a801/8ff1e/pipeline-original.png","sourceStatusCode":200,"destWidth":800,"destHeight":569,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn45@2020_3/2020/08/25/00-49-38-668_1843398e2cbd871c.webp","sourceBytes":9002,"destBytes":14200,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1051,"convertSpendMs":23,"createdTime":"2020-08-25 08:49:38","host":"us-031*","referer":"https://developers.soundcloud.com/blog/hands-off-deployment-with-canary","linkMd5ListStr":"e23324783fc57afcc03c24d0a2f624db,e23324783fc57afcc03c24d0a2f624db","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.8 KB","destSize":"13.9 KB","compressRate":"157.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/6f3da632ced4a793ddcee874c3eda1a0/538d2/omniauth.png","sourceStatusCode":200,"destWidth":522,"destHeight":149,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn30@2020_4/2020/08/25/00-49-38-763_880077ac577c42d3.webp","sourceBytes":4482,"destBytes":8362,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":890,"convertSpendMs":27,"createdTime":"2020-08-25 08:49:38","host":"us-033*","referer":"https://developers.soundcloud.com/blog/omniauth-soundcloud","linkMd5ListStr":"4235d0322e3223ceff490d5925389c07,4235d0322e3223ceff490d5925389c07","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"4.4 KB","destSize":"8.2 KB","compressRate":"186.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0e63600ee724b585ba9430793db4d27f/c7805/soundcloud_rd3.png","sourceStatusCode":200,"destWidth":400,"destHeight":240,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn73@2020_3/2020/08/25/00-49-38-769_a177b50ceb1713e7.webp","sourceBytes":12624,"destBytes":10408,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":883,"convertSpendMs":7,"createdTime":"2020-08-25 08:49:38","host":"us-024*","referer":"https://developers.soundcloud.com/blog/introducing-the-android-sharing-kit","linkMd5ListStr":"ac3bc732414f0a55c1817f5e2c37e352,ac3bc732414f0a55c1817f5e2c37e352","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.3 KB","destSize":"10.2 KB","compressRate":"82.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/adb2c9d218b9f84f430ab1cc403fdfc6/df2c7/hackto.jpg","sourceStatusCode":200,"destWidth":450,"destHeight":450,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn53@2020_6/2020/08/25/00-49-38-722_3997713436a82152.webp","sourceBytes":24862,"destBytes":30050,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1005,"convertSpendMs":14,"createdTime":"2020-08-25 08:49:38","host":"us-003*","referer":"https://developers.soundcloud.com/blog/soundcloud-at-hackto","linkMd5ListStr":"47c2af3b8c0b1e75e9b9663f72901b83,47c2af3b8c0b1e75e9b9663f72901b83","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"24.3 KB","destSize":"29.3 KB","compressRate":"120.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/94700c78a46380cc5a7e80e582757b89/6cdf8/fan-out-on-write.png","sourceStatusCode":200,"destWidth":404,"destHeight":204,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn25@2020_4/2020/08/25/00-49-38-789_c03192d52c8125dc.webp","sourceBytes":3224,"destBytes":9940,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1215,"convertSpendMs":34,"createdTime":"2020-08-25 08:49:38","host":"us-014*","referer":"https://developers.soundcloud.com/blog/roshi-a-crdt-system-for-timestamped-events","linkMd5ListStr":"f473b97b5fe7249e67bfa42febf86c01,f473b97b5fe7249e67bfa42febf86c01","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.1 KB","destSize":"9.7 KB","compressRate":"308.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/8d5ebb59a8a6d9f3dc083e3a76aca8a9/eef7a/IO-doing-it-wrong.png","sourceStatusCode":200,"destWidth":631,"destHeight":455,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn93@2020_4/2020/08/25/00-49-38-629_3ebaaf89bf164a29.webp","sourceBytes":52177,"destBytes":18956,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1122,"convertSpendMs":12,"createdTime":"2020-08-25 08:49:38","host":"europe-56*","referer":"https://developers.soundcloud.com/blog/web-scale-statistics-failing-with-mongodb","linkMd5ListStr":"5ebbebd692f2496d8bb2766357435740,5ebbebd692f2496d8bb2766357435740","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"51 KB","destSize":"18.5 KB","compressRate":"36.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/acad98c939f74b77be82c164bfe3ab9d/bf224/1-dependency-graph.png","sourceStatusCode":200,"destWidth":791,"destHeight":370,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn69@2020_1/2020/08/25/00-49-38-779_0e4f40c78768cf74.webp","sourceBytes":42534,"destBytes":35432,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1050,"convertSpendMs":24,"createdTime":"2020-08-25 08:49:38","host":"us-033*","referer":"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces","linkMd5ListStr":"f81a65c15e531e43f8a25732890970aa,f81a65c15e531e43f8a25732890970aa","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"41.5 KB","destSize":"34.6 KB","compressRate":"83.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/9c5bfa834e6000084deb32d75236402a/8ff1e/periskop_logo.png","sourceStatusCode":200,"destWidth":800,"destHeight":120,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn26@2020_4/2020/08/25/00-49-38-857_7e94ad4990086e1b.webp","sourceBytes":4659,"destBytes":9982,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":896,"convertSpendMs":21,"createdTime":"2020-08-25 08:49:38","host":"us-52*","referer":"https://developers.soundcloud.com/blog/periskop-exception-monitoring-service","linkMd5ListStr":"e085cd07fe339b684f0b334a598e1bfd,e085cd07fe339b684f0b334a598e1bfd","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"4.5 KB","destSize":"9.7 KB","compressRate":"214.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/b2ffc13bcb87da9f48c6c4edc51cb26e/a296c/ios-platform-lead-role.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":969,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn21@2020_4/2020/08/25/00-49-38-638_1bde94b7c0e5da37.webp","sourceBytes":94603,"destBytes":119924,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1296,"convertSpendMs":42,"createdTime":"2020-08-25 08:49:38","host":"us-024*","referer":"https://developers.soundcloud.com/blog/defining-a-role-with-a-retrospective-activity","linkMd5ListStr":"ded1cd08d129daebc82e226570d5bab8,ded1cd08d129daebc82e226570d5bab8","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"92.4 KB","destSize":"117.1 KB","compressRate":"126.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/ed0e09eb7428b54f9bc16d49eda40ad8/48a11/bghack.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":334,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn14@2020_3/2020/08/25/00-49-38-808_f71cb5a8762def5f.webp","sourceBytes":20249,"destBytes":26638,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":970,"convertSpendMs":11,"createdTime":"2020-08-25 08:49:38","host":"us-003*","referer":"https://developers.soundcloud.com/blog/berlin-geekettes-hackathon-roundup","linkMd5ListStr":"bffd0786bb86e91b1a565ded47ffa5b8,bffd0786bb86e91b1a565ded47ffa5b8","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"19.8 KB","destSize":"26 KB","compressRate":"131.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/6834021f21553f7ea0a8a88ab6794bda/a296c/personalized_recommendations.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":459,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn75@2020_4/2020/08/25/00-49-37-770_1d834f25d243d8d3.webp","sourceBytes":36797,"destBytes":41876,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":2446,"convertSpendMs":22,"createdTime":"2020-08-25 08:49:37","host":"us-040*","referer":"https://developers.soundcloud.com/blog/introducing_suggested_tracks","linkMd5ListStr":"15235b40d9de61b46288c326f2c5a1d3,15235b40d9de61b46288c326f2c5a1d3","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"35.9 KB","destSize":"40.9 KB","compressRate":"113.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/cc0584fca1e9478e0e3f9ed685442eb8/48a11/wehack.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":500,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn17@2020_5/2020/08/25/00-49-38-612_03e2a8c8cefb6358.webp","sourceBytes":22541,"destBytes":26640,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1155,"convertSpendMs":22,"createdTime":"2020-08-25 08:49:38","host":"europe70*","referer":"https://developers.soundcloud.com/blog/how-to-make-a-soundcloud-powered-toy","linkMd5ListStr":"df25e408855776f8d3eed1735ada9d86,df25e408855776f8d3eed1735ada9d86","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"22 KB","destSize":"26 KB","compressRate":"118.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/bd853f55bc860bb07babfcec150f122d/8ff1e/player_arch.png","sourceStatusCode":200,"destWidth":800,"destHeight":215,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn98@2020_3/2020/08/25/00-49-38-834_6878bc3d9a83b2d8.webp","sourceBytes":13061,"destBytes":26616,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1000,"convertSpendMs":23,"createdTime":"2020-08-25 08:49:38","host":"us-037*","referer":"https://developers.soundcloud.com/blog/soundcloud-is-playing-the-oboe","linkMd5ListStr":"9f6d17fdcbfb0db6422e7549b392ad30,9f6d17fdcbfb0db6422e7549b392ad30","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.8 KB","destSize":"26 KB","compressRate":"203.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-tiny.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":349,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:39","host":"us-028*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630,f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/5e0db8179b7cc2b056f00227038fd312/ref.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn50@2020_4/2020/08/25/00-49-38-998_924027af6c21307f.webp","sourceBytes":117,"destBytes":114,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":830,"convertSpendMs":2,"createdTime":"2020-08-25 08:49:38","host":"us-51*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c,a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"117 B","destSize":"114 B","compressRate":"97.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/5b1831d72dc2c2b0299a8d3b3445a0f3/135ae/barcelona-ruby-conference-sept-MMXIII.png","sourceStatusCode":200,"destWidth":300,"destHeight":300,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn39@2020_4/2020/08/25/00-49-38-729_357ba22d988d4a83.webp","sourceBytes":13612,"destBytes":22146,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1102,"convertSpendMs":8,"createdTime":"2020-08-25 08:49:38","host":"europe64*","referer":"https://developers.soundcloud.com/blog/win-a-trip-to-the-barcelona-ruby-conference","linkMd5ListStr":"55295123821f40e618d03e08c381b819,55295123821f40e618d03e08c381b819","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"13.3 KB","destSize":"21.6 KB","compressRate":"162.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/2ae12e06542276a6c2d0a3c1d07c9a05/a296c/back-on-track-paint.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn65@2020_3/2020/08/25/00-49-38-928_b563abceaf9d6b94.webp","sourceBytes":27213,"destBytes":30436,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1104,"convertSpendMs":46,"createdTime":"2020-08-25 08:49:38","host":"us-52*","referer":"https://developers.soundcloud.com/blog/getting-a-team-back-on-track","linkMd5ListStr":"58efd0c426cab9f547e717054f187f59,58efd0c426cab9f547e717054f187f59","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"26.6 KB","destSize":"29.7 KB","compressRate":"111.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0a1fb7b19fc40cf238d9b5ea58eb19ec/8ff1e/creating-readable-spark-jobs-function-pipeline.png","sourceStatusCode":200,"destWidth":800,"destHeight":398,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn85@2020_4/2020/08/25/00-49-38-584_8ff8f1bbacbb3954.webp","sourceBytes":35871,"destBytes":39586,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1287,"convertSpendMs":14,"createdTime":"2020-08-25 08:49:38","host":"europe-24*","referer":"https://developers.soundcloud.com/blog/creating-readable-spark-jobs","linkMd5ListStr":"4c7f961445a7d3da14be7437048a8db2,4c7f961445a7d3da14be7437048a8db2","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"35 KB","destSize":"38.7 KB","compressRate":"110.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/ae2bcdb351bb2faf3bb3c8b376bffbb4/48a11/late_night_hackingz.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":310,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn33@2020_1/2020/08/25/00-49-38-874_91406d2233329368.webp","sourceBytes":13777,"destBytes":16080,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1001,"convertSpendMs":10,"createdTime":"2020-08-25 08:49:38","host":"us-024*","referer":"https://developers.soundcloud.com/blog/node-js-knockout-august-28th-29th","linkMd5ListStr":"8cfe8b9ba812d40f17fab5acd931ff97,8cfe8b9ba812d40f17fab5acd931ff97","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"13.5 KB","destSize":"15.7 KB","compressRate":"116.7%"},{"code":1,"isDone":false,"source":"http://dl.dropbox.com/u/12477597/Permanent/DesktopSharing/mac-sharing-small.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":138,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:39","host":"us-024*","referer":"https://developers.soundcloud.com/blog/desktop-sharing-kits","linkMd5ListStr":"a6e37251568015a3d74d9dafa4811dfa,a6e37251568015a3d74d9dafa4811dfa","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/69ee5739e44097bf42f4e5fbb107cfc2/91578/isport-headphones.jpg","sourceStatusCode":200,"destWidth":229,"destHeight":223,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn1@2020_3/2020/08/25/00-49-39-035_bc13a85d16cbf792.webp","sourceBytes":5267,"destBytes":6042,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1104,"convertSpendMs":15,"createdTime":"2020-08-25 08:49:38","host":"us-028*","referer":"https://developers.soundcloud.com/blog/contest-soundcloud-and-acapela-group","linkMd5ListStr":"edf53c47b004b074d6799824414530ff,edf53c47b004b074d6799824414530ff","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.1 KB","destSize":"5.9 KB","compressRate":"114.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/360a07bb16fbdc974215f53bb3cbd201/03fde/oauth-2-logo.png","sourceStatusCode":200,"destWidth":124,"destHeight":123,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn78@2020_3/2020/08/25/00-49-39-057_2e82ae6c2f7abc5a.webp","sourceBytes":5456,"destBytes":5452,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1151,"convertSpendMs":5,"createdTime":"2020-08-25 08:49:38","host":"us-015*","referer":"https://developers.soundcloud.com/blog/we-love-oauth-2","linkMd5ListStr":"66c588af0e7568182e2630435ccfe00d,66c588af0e7568182e2630435ccfe00d","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.3 KB","destSize":"5.3 KB","compressRate":"99.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/eb13cfd093ee1597a3acd0c7672fc8de/sc-xbox-password-entry.gif","sourceStatusCode":200,"destWidth":800,"destHeight":450,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn98@2020_5/2020/08/25/00-49-39-035_ebd26b8b11b7229e.webp","sourceBytes":244573,"destBytes":74776,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":2730,"convertSpendMs":1100,"createdTime":"2020-08-25 08:49:37","host":"us-55*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b,0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"238.8 KB","destSize":"73 KB","compressRate":"30.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/e0f4c43c1c010b26b98e338381deec51/249e6/html5-api.png","sourceStatusCode":200,"destWidth":520,"destHeight":166,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn67@2020_5/2020/08/25/00-49-39-301_147c7fc9418c1c13.webp","sourceBytes":12169,"destBytes":9016,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":917,"convertSpendMs":8,"createdTime":"2020-08-25 08:49:39","host":"us-010*","referer":"https://developers.soundcloud.com/blog/html5-widget-api","linkMd5ListStr":"135be9f48e10eca6259aac5fa67126da,135be9f48e10eca6259aac5fa67126da","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"11.9 KB","destSize":"8.8 KB","compressRate":"74.1%"},{"code":1,"isDone":false,"source":"https://img.skitch.com/20110722-qf2wmir75es6ag338k2xdkpksg.png","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn5@2020_3/2020/08/25/00-49-39-187_6b7b77e6f7dcab50.jpg","sourceBytes":52870,"destBytes":52870,"feedId":10291,"totalSpendMs":1406,"convertSpendMs":4,"createdTime":"2020-08-25 08:49:38","host":"us-019*","referer":"https://developers.soundcloud.com/blog/building-the-soundcloud-mobile-site-using-backbone.js","linkMd5ListStr":"b88be870659c0391f1ec17a620f8046d,b88be870659c0391f1ec17a620f8046d","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"51.6 KB","destSize":"51.6 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/148913331dae75abf2c0bfba78673908/undesirable_scenarios.svg","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn82@2020_3/2020/08/25/00-49-39-104_58edae415fb70534.svg","sourceBytes":92460,"destBytes":92460,"feedId":10291,"totalSpendMs":1443,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:38","host":"us-007*","referer":"https://developers.soundcloud.com/blog/how-not-to-build-datasets-and-consume-data-at-your-company","linkMd5ListStr":"7e1fac7ae2cbdcaac924e69f75c25d60,7e1fac7ae2cbdcaac924e69f75c25d60","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"90.3 KB","destSize":"90.3 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/8f009accc900f96648f1252ab248035a/8ff1e/image2.png","sourceStatusCode":200,"destWidth":800,"destHeight":291,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn61@2020_5/2020/08/25/00-49-39-225_232b54a6c4d38f51.webp","sourceBytes":10325,"destBytes":24406,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1169,"convertSpendMs":35,"createdTime":"2020-08-25 08:49:38","host":"us-019*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses","linkMd5ListStr":"85a241edadbd6592e8ed62c076621a0a,85a241edadbd6592e8ed62c076621a0a","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"10.1 KB","destSize":"23.8 KB","compressRate":"236.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/4a3d759a8b8db7b67c1f9fd4931419e9/a296c/suggestedStations.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":371,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn54@2020_4/2020/08/25/00-49-39-375_784e614a7de44075.webp","sourceBytes":12447,"destBytes":10916,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1212,"convertSpendMs":13,"createdTime":"2020-08-25 08:49:38","host":"us-034*","referer":"https://developers.soundcloud.com/blog/building_radio_stations_at_soundcloud","linkMd5ListStr":"90c67514dc81caf3deb52636f48e90e0,90c67514dc81caf3deb52636f48e90e0","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.2 KB","destSize":"10.7 KB","compressRate":"87.7%"},{"code":1,"isDone":false,"source":"http://farm4.static.flickr.com/3093/2844971993_17f2ddf2a8_z.jpg","sourceStatusCode":200,"destWidth":639,"destHeight":395,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn21@2020_1/2020/08/25/00-49-38-831_57ef335b361b09fa.webp","sourceBytes":125076,"destBytes":79358,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1692,"convertSpendMs":18,"createdTime":"2020-08-25 08:49:38","host":"europe62*","referer":"https://developers.soundcloud.com/blog/introducing-the-large-hadron-migrator-3","linkMd5ListStr":"e84dc40486af1771d74c7ce37e8a6a2c,e84dc40486af1771d74c7ce37e8a6a2c","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"122.1 KB","destSize":"77.5 KB","compressRate":"63.4%"},{"code":1,"isDone":false,"source":"https://backstage.soundcloud.com/wp-content/uploads/2011/12/Retrospective-505x377.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":196,"convertSpendMs":0,"createdTime":"2020-08-25 08:49:40","host":"europe67*","referer":"https://developers.soundcloud.com/blog/stop-hacker-time","linkMd5ListStr":"07deb1e57e3b99f2e3445ccdf5b3bc29,07deb1e57e3b99f2e3445ccdf5b3bc29","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/e5327b0c4755d511915d1650fcebe88b/a296c/kotlinconf.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":450,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn71@2020_3/2020/08/25/00-49-39-420_76a66df06e4f0c89.webp","sourceBytes":21705,"destBytes":22518,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1259,"convertSpendMs":16,"createdTime":"2020-08-25 08:49:39","host":"us-006*","referer":"https://developers.soundcloud.com/blog/power-of-types-for-errors","linkMd5ListStr":"b4480d630156dd2a3f8a1c928fe9fd82,b4480d630156dd2a3f8a1c928fe9fd82","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"21.2 KB","destSize":"22 KB","compressRate":"103.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/8036afa4de908d212e78fd25f6bbbadf/8ff1e/ios-example-app.png","sourceStatusCode":200,"destWidth":800,"destHeight":445,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn81@2020_5/2020/08/25/00-49-39-640_938629977fd8d987.webp","sourceBytes":44017,"destBytes":25244,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1062,"convertSpendMs":25,"createdTime":"2020-08-25 08:49:39","host":"us-54*","referer":"https://developers.soundcloud.com/blog/leveraging-frameworks-to-speed-up-our-development-on-ios-part-1","linkMd5ListStr":"fefeab11e72cdfdba249848f6ee099ad,fefeab11e72cdfdba249848f6ee099ad","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43 KB","destSize":"24.7 KB","compressRate":"57.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/6cb36141e8e4bfe91edaa69597db5b6a/8ff1e/cdn-haproxy-k8s.png","sourceStatusCode":200,"destWidth":800,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn93@2020_6/2020/08/25/00-49-39-672_74a19b9a5247f6b8.webp","sourceBytes":37543,"destBytes":36554,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1032,"convertSpendMs":18,"createdTime":"2020-08-25 08:49:39","host":"us-51*","referer":"https://developers.soundcloud.com/blog/how-soundcloud-uses-haproxy-with-kubernetes-for-user-facing-traffic","linkMd5ListStr":"30c03fe964ebed44d678320e9a3bbe09,30c03fe964ebed44d678320e9a3bbe09","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"36.7 KB","destSize":"35.7 KB","compressRate":"97.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/ebb4b534084c91b368f7641a794fd7cb/67d4f/product-engineering-diagram-1.jpg","sourceStatusCode":200,"destWidth":700,"destHeight":261,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn98@2020_4/2020/08/25/00-49-39-787_600f8f968ae79053.webp","sourceBytes":10976,"destBytes":9594,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":881,"convertSpendMs":9,"createdTime":"2020-08-25 08:49:39","host":"us-040*","referer":"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith","linkMd5ListStr":"fac53914c7e6fee9d4560f99a93a3063,fac53914c7e6fee9d4560f99a93a3063","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"10.7 KB","destSize":"9.4 KB","compressRate":"87.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0d96b8d3f9cbe32c84eadd64c8812429/48a11/venue.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":332,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn89@2020_3/2020/08/25/00-49-39-823_fb8ff4b915c733f4.webp","sourceBytes":21191,"destBytes":26626,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1027,"convertSpendMs":56,"createdTime":"2020-08-25 08:49:39","host":"us-52*","referer":"https://developers.soundcloud.com/blog/music-hack-day-barcelona-2012","linkMd5ListStr":"8cfff08585641cac6e3abd4ef46417c4,8cfff08585641cac6e3abd4ef46417c4","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"20.7 KB","destSize":"26 KB","compressRate":"125.6%"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131758138488_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":95,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:40","host":"us-038*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/38fd90dc777269b8e41fb7a44abd73f3/6cdf8/fan-in-on-read.png","sourceStatusCode":200,"destWidth":404,"destHeight":202,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn96@2020_6/2020/08/25/00-51-40-327_6db578dfa2b31528.webp","sourceBytes":3621,"destBytes":8852,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1017,"convertSpendMs":7,"createdTime":"2020-08-25 08:51:40","host":"europe-56*","referer":"https://developers.soundcloud.com/blog/roshi-a-crdt-system-for-timestamped-events","linkMd5ListStr":"f473b97b5fe7249e67bfa42febf86c01","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.5 KB","destSize":"8.6 KB","compressRate":"244.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-small.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":338,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:40","host":"us-018*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/c205b7d9d328c0738c46f04b092375b8/635b1/mag.png","sourceStatusCode":200,"destWidth":420,"destHeight":180,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn52@2020_6/2020/08/25/00-51-40-332_ce7bbdbc7ae6c965.webp","sourceBytes":355,"destBytes":1074,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1142,"convertSpendMs":4,"createdTime":"2020-08-25 08:51:40","host":"europe61*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"355 B","destSize":"1 KB","compressRate":"302.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/679c7f38401cb7471c9614369c03c6e6/54e54/e6.png","sourceStatusCode":200,"destWidth":580,"destHeight":467,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn55@2020_6/2020/08/25/00-51-40-371_976309458fe2b95e.webp","sourceBytes":7692,"destBytes":13188,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1138,"convertSpendMs":13,"createdTime":"2020-08-25 08:51:40","host":"europe69*","referer":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","linkMd5ListStr":"617d6d78a6d4ea6c18a0ca90fa588e57","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.5 KB","destSize":"12.9 KB","compressRate":"171.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/5f083ab7c0db99633e5ab91acc120e20/54e54/waveform_rendering_clip.png","sourceStatusCode":200,"destWidth":580,"destHeight":420,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn31@2020_3/2020/08/25/00-51-40-335_0349cacda6b49344.webp","sourceBytes":11452,"destBytes":15202,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1237,"convertSpendMs":8,"createdTime":"2020-08-25 08:51:40","host":"europe-56*","referer":"https://developers.soundcloud.com/blog/ios-waveform-rendering","linkMd5ListStr":"8e813ef74b6373575f09190520cbac28","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"11.2 KB","destSize":"14.8 KB","compressRate":"132.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/298e897fb464f06b1d46b431500d0140/8ff1e/image5.png","sourceStatusCode":200,"destWidth":800,"destHeight":174,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn89@2020_3/2020/08/25/00-51-40-303_b1715cd77c5dc61e.webp","sourceBytes":9259,"destBytes":12018,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1265,"convertSpendMs":6,"createdTime":"2020-08-25 08:51:40","host":"europe68*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses","linkMd5ListStr":"85a241edadbd6592e8ed62c076621a0a","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"9 KB","destSize":"11.7 KB","compressRate":"129.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/76cb8e39479ca79c859eeccb79c9d418/8ff1e/image4.png","sourceStatusCode":200,"destWidth":800,"destHeight":183,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn27@2020_3/2020/08/25/00-51-40-373_2b57a3fd127df466.webp","sourceBytes":6368,"destBytes":8546,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1249,"convertSpendMs":8,"createdTime":"2020-08-25 08:51:40","host":"europe69*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2","linkMd5ListStr":"2a094ed2b890cb88dd022b4f84947b7c","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.2 KB","destSize":"8.3 KB","compressRate":"134.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/80c61460f17ee696ff909c16ef038f4a/8ff1e/image2.png","sourceStatusCode":200,"destWidth":800,"destHeight":181,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn7@2020_2/2020/08/25/00-51-40-709_02d9235eda88299a.webp","sourceBytes":6713,"destBytes":7410,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1114,"convertSpendMs":8,"createdTime":"2020-08-25 08:51:40","host":"us-010*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2","linkMd5ListStr":"2a094ed2b890cb88dd022b4f84947b7c","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.6 KB","destSize":"7.2 KB","compressRate":"110.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/f2f6d71e2b425162e229c3ffeb0c72a3/gears.svg","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn79@2020_3/2020/08/25/00-51-40-653_3354efc17f15d9f8.svg","sourceBytes":2084,"destBytes":2084,"feedId":10291,"totalSpendMs":1145,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:40","host":"us-017*","referer":"https://developers.soundcloud.com/blog/keeping-counts-in-sync","linkMd5ListStr":"15e0b5215de1cee87672a5788e8bc0b1","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"2 KB","destSize":"2 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/SearchTimings-505x378.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":89,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"europe-56*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/2b48b1043f93447ab678bfb17fcda9ab/sound.svg","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn39@2020_5/2020/08/25/00-51-40-716_c76a669ecf38d2f6.svg","sourceBytes":429,"destBytes":429,"feedId":10291,"totalSpendMs":1142,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:40","host":"us-52*","referer":"https://developers.soundcloud.com/blog/keeping-counts-in-sync","linkMd5ListStr":"15e0b5215de1cee87672a5788e8bc0b1","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"429 B","destSize":"429 B","compressRate":"100%"},{"code":1,"isDone":false,"source":"http://farm8.staticflickr.com/7165/6449374135_33dcc56139_d.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":332,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn15@2020_4/2020/08/25/00-51-40-593_cc03daa9463d3ec8.webp","sourceBytes":69457,"destBytes":39222,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1188,"convertSpendMs":12,"createdTime":"2020-08-25 08:51:40","host":"us-030*","referer":"https://developers.soundcloud.com/blog/music-hack-day-london-2011","linkMd5ListStr":"79f3b3462e4f06843f8b0b6c4fe8b454","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"67.8 KB","destSize":"38.3 KB","compressRate":"56.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/ce8c549d406a1307b3f1ff9d041cba64/top-3.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn48@2020_2/2020/08/25/00-51-40-709_bd7069bfa299f418.webp","sourceBytes":136,"destBytes":154,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1176,"convertSpendMs":2,"createdTime":"2020-08-25 08:51:40","host":"us-018*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"136 B","destSize":"154 B","compressRate":"113.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/b13e9e064cfa2cd5f3f20547dc627a2d/8ff1e/ci-pipeline.png","sourceStatusCode":200,"destWidth":800,"destHeight":162,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn67@2020_4/2020/08/25/00-51-40-691_7089da2b43259564.webp","sourceBytes":9717,"destBytes":12660,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1198,"convertSpendMs":9,"createdTime":"2020-08-25 08:51:40","host":"us-002*","referer":"https://developers.soundcloud.com/blog/quality-mobile-trains","linkMd5ListStr":"655377572ca618cedb5c80aefa47a904","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"9.5 KB","destSize":"12.4 KB","compressRate":"130.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/4339503b67abd7892be39a5ffe110d4a/54e54/e3.png","sourceStatusCode":200,"destWidth":580,"destHeight":182,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn27@2020_6/2020/08/25/00-51-40-775_6dec13d91b489066.webp","sourceBytes":2171,"destBytes":4156,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1210,"convertSpendMs":14,"createdTime":"2020-08-25 08:51:40","host":"us-014*","referer":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","linkMd5ListStr":"617d6d78a6d4ea6c18a0ca90fa588e57","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"2.1 KB","destSize":"4.1 KB","compressRate":"191.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/96849b6e142dda28942baa092aceabf5/22492/dataset-semantics-fixed.png","sourceStatusCode":200,"destWidth":540,"destHeight":241,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn85@2020_2/2020/08/25/00-51-40-736_6fd7a713caf26290.webp","sourceBytes":7722,"destBytes":16894,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1218,"convertSpendMs":8,"createdTime":"2020-08-25 08:51:40","host":"us-005*","referer":"https://developers.soundcloud.com/blog/a-better-model-of-data-ownership","linkMd5ListStr":"81ac367778605dafa205f894368fee2d","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.5 KB","destSize":"16.5 KB","compressRate":"218.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/b6d66454c23a905f52ebc848fcfefd0f/8ff1e/4-divergent-service-names.png","sourceStatusCode":200,"destWidth":800,"destHeight":255,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn56@2020_5/2020/08/25/00-51-40-787_cee225c2501639c0.webp","sourceBytes":10197,"destBytes":10122,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1276,"convertSpendMs":10,"createdTime":"2020-08-25 08:51:40","host":"us-038*","referer":"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces","linkMd5ListStr":"f81a65c15e531e43f8a25732890970aa","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"10 KB","destSize":"9.9 KB","compressRate":"99.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/315aa8eedac07b15f8d8b8145399d2c0/a5a7c/cloudseeder_headline.png","sourceStatusCode":200,"destWidth":514,"destHeight":385,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn77@2020_2/2020/08/25/00-51-40-777_9762769d154d4982.webp","sourceBytes":21155,"destBytes":17344,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1270,"convertSpendMs":9,"createdTime":"2020-08-25 08:51:40","host":"us-016*","referer":"https://developers.soundcloud.com/blog/introducing-the-cloudseeder-devkit","linkMd5ListStr":"b3608559289da9cd03cfefee1a744b37","githubUser":"myreaderx23","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"20.7 KB","destSize":"16.9 KB","compressRate":"82%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/6b1b03d22f6affac3672abd8d8fcb3b7/top-10.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn47@2020_2/2020/08/25/00-51-40-378_2e600faf6e652916.webp","sourceBytes":138,"destBytes":142,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1471,"convertSpendMs":3,"createdTime":"2020-08-25 08:51:40","host":"europe-23*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"138 B","destSize":"142 B","compressRate":"102.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/806cfc30f521eb9c01e9562ca8bcd587/df2c7/instagramaphone.jpg","sourceStatusCode":200,"destWidth":450,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn99@2020_6/2020/08/25/00-51-40-790_0d27acc8cc27a372.webp","sourceBytes":21551,"destBytes":25070,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1332,"convertSpendMs":21,"createdTime":"2020-08-25 08:51:40","host":"us-034*","referer":"https://developers.soundcloud.com/blog/pennapps-recap","linkMd5ListStr":"b27715d5d2a8093929774bbb15a3b2c6","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"21 KB","destSize":"24.5 KB","compressRate":"116.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/487afaffa2f2da376dad0cae945959e5/8ff1e/annotation-42-secs.png","sourceStatusCode":200,"destWidth":800,"destHeight":574,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn12@2020_6/2020/08/25/00-51-40-393_32bc80dc707dfe6f.webp","sourceBytes":35890,"destBytes":39924,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1487,"convertSpendMs":18,"createdTime":"2020-08-25 08:51:40","host":"europe-23*","referer":"https://developers.soundcloud.com/blog/dagger-reflect","linkMd5ListStr":"e7843e3c8d7edf648d14eda3b1179958","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"35 KB","destSize":"39 KB","compressRate":"111.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/3ccd7308176bea53890a8e52b046ff09/48a11/professor-hannes.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":375,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn36@2020_1/2020/08/25/00-51-40-781_b9bf586a42366f37.webp","sourceBytes":12431,"destBytes":14482,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1344,"convertSpendMs":64,"createdTime":"2020-08-25 08:51:40","host":"us-034*","referer":"https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf","linkMd5ListStr":"15f673584ea6f54247384e89ce11b72c","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.1 KB","destSize":"14.1 KB","compressRate":"116.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/56bd8881dd8a35df5789994673747f9b/67d4f/product-engineering-diagram-3.jpg","sourceStatusCode":200,"destWidth":700,"destHeight":440,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn19@2020_1/2020/08/25/00-51-40-809_44f51307a9328cf9.webp","sourceBytes":20457,"destBytes":19900,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1356,"convertSpendMs":17,"createdTime":"2020-08-25 08:51:40","host":"us-038*","referer":"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith","linkMd5ListStr":"fac53914c7e6fee9d4560f99a93a3063","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"20 KB","destSize":"19.4 KB","compressRate":"97.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/a2ecbeb647062fed5ab2e252546b74b3/8ff1e/promdash_event_processor.png","sourceStatusCode":200,"destWidth":800,"destHeight":514,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn43@2020_5/2020/08/25/00-51-40-889_51664a87f5d3a132.webp","sourceBytes":45034,"destBytes":39932,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1379,"convertSpendMs":17,"createdTime":"2020-08-25 08:51:40","host":"us-030*","referer":"https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud","linkMd5ListStr":"f97e1f94d709bd0c92f56241478cd401","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"44 KB","destSize":"39 KB","compressRate":"88.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/5938801e9e8897edc802c48ebde57744/8ff1e/prometheus_bazooka_memory_wasters.png","sourceStatusCode":200,"destWidth":800,"destHeight":400,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn12@2020_1/2020/08/25/00-51-40-862_a7417631e8b2ecea.webp","sourceBytes":21612,"destBytes":21660,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1362,"convertSpendMs":94,"createdTime":"2020-08-25 08:51:40","host":"us-52*","referer":"https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud","linkMd5ListStr":"f97e1f94d709bd0c92f56241478cd401","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"21.1 KB","destSize":"21.2 KB","compressRate":"100.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-large.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":101,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"us-030*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/avatar-medium.jpg","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":45,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:41","host":"europe61*","referer":"https://developers.soundcloud.com/blog/smooth-image-loading-by-upscaling","linkMd5ListStr":"f06f2d936ee74736092a85c8c87ad630","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/1297efc7957969977f4d573057196bc5/48a11/whsprs-demo.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":375,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn59@2020_1/2020/08/25/00-51-40-825_c21b3915d3ed0476.webp","sourceBytes":25345,"destBytes":31942,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1465,"convertSpendMs":40,"createdTime":"2020-08-25 08:51:40","host":"us-026*","referer":"https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf","linkMd5ListStr":"15f673584ea6f54247384e89ce11b72c","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"24.8 KB","destSize":"31.2 KB","compressRate":"126%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/e73797046b8aa406329cb906069e466b/8ff1e/code_inventory_visualized.png","sourceStatusCode":200,"destWidth":800,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn76@2020_5/2020/08/25/00-51-40-452_eeac489b0b412eaf.webp","sourceBytes":210887,"destBytes":62086,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1609,"convertSpendMs":23,"createdTime":"2020-08-25 08:51:40","host":"europe69*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"205.9 KB","destSize":"60.6 KB","compressRate":"29.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/de58b17e8e6a61d895298deefbfbd4d6/8ff1e/pairing-illustrations-1.png","sourceStatusCode":200,"destWidth":800,"destHeight":328,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn63@2020_3/2020/08/25/00-51-40-909_171cff27b0ed5f20.webp","sourceBytes":17453,"destBytes":18488,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1467,"convertSpendMs":75,"createdTime":"2020-08-25 08:51:40","host":"us-014*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"17 KB","destSize":"18.1 KB","compressRate":"105.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/63d2a157e4f4f9948d127e5eaa684460/8ff1e/latency_improvement.png","sourceStatusCode":200,"destWidth":800,"destHeight":544,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn52@2020_3/2020/08/25/00-51-40-886_5f1c96f0235990f1.webp","sourceBytes":45788,"destBytes":41538,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1463,"convertSpendMs":20,"createdTime":"2020-08-25 08:51:40","host":"us-006*","referer":"https://developers.soundcloud.com/blog/soundcloud-is-playing-the-oboe","linkMd5ListStr":"9f6d17fdcbfb0db6422e7549b392ad30","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"44.7 KB","destSize":"40.6 KB","compressRate":"90.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/e501cbf007aa4075fe8a7c6272b932a5/good_scenarios.svg","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn32@2020_3/2020/08/25/00-51-40-781_f489ef083ff53143.svg","sourceBytes":132450,"destBytes":132450,"feedId":10291,"totalSpendMs":1526,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:40","host":"us-002*","referer":"https://developers.soundcloud.com/blog/how-not-to-build-datasets-and-consume-data-at-your-company","linkMd5ListStr":"7e1fac7ae2cbdcaac924e69f75c25d60","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"129.3 KB","destSize":"129.3 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/cb8c4a1333877c8e197c4ee9530641c5/8ff1e/annotation-3-mins.png","sourceStatusCode":200,"destWidth":800,"destHeight":619,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn62@2020_6/2020/08/25/00-51-40-887_8df67dbce9f33f65.webp","sourceBytes":47657,"destBytes":49506,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1514,"convertSpendMs":58,"createdTime":"2020-08-25 08:51:40","host":"us-034*","referer":"https://developers.soundcloud.com/blog/dagger-reflect","linkMd5ListStr":"e7843e3c8d7edf648d14eda3b1179958","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"46.5 KB","destSize":"48.3 KB","compressRate":"103.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/8906688cbf168a58b495068d43e3a767/8ff1e/pdkp_summary_dashboard.png","sourceStatusCode":200,"destWidth":800,"destHeight":420,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn70@2020_2/2020/08/25/00-51-41-386_41a26592774c1d26.webp","sourceBytes":29172,"destBytes":31104,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1326,"convertSpendMs":15,"createdTime":"2020-08-25 08:51:40","host":"us-55*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"28.5 KB","destSize":"30.4 KB","compressRate":"106.6%"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131771379756_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":94,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:42","host":"us-016*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0de7544370839f8d8fe966b24f23dd30/8ff1e/search-project.png","sourceStatusCode":200,"destWidth":800,"destHeight":492,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn75@2020_3/2020/08/25/00-51-41-309_8e46eaba1278e443.webp","sourceBytes":24924,"destBytes":22412,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1097,"convertSpendMs":16,"createdTime":"2020-08-25 08:51:41","host":"europe21*","referer":"https://developers.soundcloud.com/blog/tuist-project-generation","linkMd5ListStr":"b1b7ea6f021159bbe86db6b0da568bf3","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"24.3 KB","destSize":"21.9 KB","compressRate":"89.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/32781ec968f6aaa35ce71ae8b96d0246/2b173/without-reflect.png","sourceStatusCode":200,"destWidth":398,"destHeight":594,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn59@2020_4/2020/08/25/00-51-41-243_ce90c0ed2a14d203.webp","sourceBytes":7719,"destBytes":12200,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1047,"convertSpendMs":28,"createdTime":"2020-08-25 08:51:41","host":"us-033*","referer":"https://developers.soundcloud.com/blog/dagger-reflect","linkMd5ListStr":"e7843e3c8d7edf648d14eda3b1179958","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.5 KB","destSize":"11.9 KB","compressRate":"158.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/35484a6b037a3e0c87ce0a91acfaf724/67d4f/product-engineering-diagram-2.jpg","sourceStatusCode":200,"destWidth":700,"destHeight":440,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn77@2020_2/2020/08/25/00-51-41-375_3974ff2581464d2b.webp","sourceBytes":17308,"destBytes":15768,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1140,"convertSpendMs":12,"createdTime":"2020-08-25 08:51:41","host":"europe70*","referer":"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith","linkMd5ListStr":"fac53914c7e6fee9d4560f99a93a3063","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16.9 KB","destSize":"15.4 KB","compressRate":"91.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/9591325255d4ef940a2fc6c20f1793fa/8939e/bugsense-report.png","sourceStatusCode":200,"destWidth":505,"destHeight":261,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn17@2020_5/2020/08/25/00-51-41-750_487a6afafaede7de.webp","sourceBytes":6063,"destBytes":7394,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":891,"convertSpendMs":10,"createdTime":"2020-08-25 08:51:41","host":"us-016*","referer":"https://developers.soundcloud.com/blog/front-end-javascript-bug-tracking","linkMd5ListStr":"faf31d858376c6584d716294eeb6cc11","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.9 KB","destSize":"7.2 KB","compressRate":"122%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/5c33e0ea39caa8b298ce951793d378d5/54e54/e4.png","sourceStatusCode":200,"destWidth":580,"destHeight":296,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn97@2020_3/2020/08/25/00-51-41-586_187d7275f1fad972.webp","sourceBytes":4568,"destBytes":7552,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1089,"convertSpendMs":7,"createdTime":"2020-08-25 08:51:41","host":"europe66*","referer":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","linkMd5ListStr":"617d6d78a6d4ea6c18a0ca90fa588e57","githubUser":"myreaderx23","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"4.5 KB","destSize":"7.4 KB","compressRate":"165.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0d3dcbb4e7fae32e898feb5bf44864a6/45483/with-reflect.png","sourceStatusCode":200,"destWidth":384,"destHeight":588,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn94@2020_4/2020/08/25/00-51-41-539_60a88e280e5ce186.webp","sourceBytes":7688,"destBytes":11530,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1133,"convertSpendMs":10,"createdTime":"2020-08-25 08:51:41","host":"europe-23*","referer":"https://developers.soundcloud.com/blog/dagger-reflect","linkMd5ListStr":"e7843e3c8d7edf648d14eda3b1179958","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.5 KB","destSize":"11.3 KB","compressRate":"150%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/cool_disco.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":90,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:42","host":"europe66*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/502e61b8f647e521bd358d44e2668cf5/3bb78/uml.png","sourceStatusCode":200,"destWidth":491,"destHeight":211,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn30@2020_4/2020/08/25/00-51-41-627_1aa1133197a665b7.webp","sourceBytes":3529,"destBytes":9006,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1133,"convertSpendMs":10,"createdTime":"2020-08-25 08:51:41","host":"europe-22*","referer":"https://developers.soundcloud.com/blog/dark-mode-observer-pattern","linkMd5ListStr":"e8916382f7641a2823b21fd1cca4773a","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.4 KB","destSize":"8.8 KB","compressRate":"255.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/c5f5aa4717c62570e3f546578d9e3a88/a296c/contract.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn10@2020_1/2020/08/25/00-51-41-844_411c18c2629a2d38.webp","sourceBytes":17336,"destBytes":17116,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1059,"convertSpendMs":17,"createdTime":"2020-08-25 08:51:41","host":"us-032*","referer":"https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture","linkMd5ListStr":"67a5a2e60f7bb11708bee110bec4ba4a","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16.9 KB","destSize":"16.7 KB","compressRate":"98.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/98f12e069c62b0789db0caa8b12b97ff/135ae/waveform_rendering_blurred.png","sourceStatusCode":200,"destWidth":300,"destHeight":340,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn61@2020_3/2020/08/25/00-51-41-941_3163f3301590e77a.webp","sourceBytes":768,"destBytes":6100,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":903,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:41","host":"us-026*","referer":"https://developers.soundcloud.com/blog/ios-waveform-rendering","linkMd5ListStr":"8e813ef74b6373575f09190520cbac28","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"768 B","destSize":"6 KB","compressRate":"794.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/9a00f5fc9731c187ee5477b79a60f7da/top-9.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn74@2020_1/2020/08/25/00-51-41-964_286dc77c117f6c6d.webp","sourceBytes":135,"destBytes":154,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":871,"convertSpendMs":2,"createdTime":"2020-08-25 08:51:41","host":"us-012*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"135 B","destSize":"154 B","compressRate":"114.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/9056956503086f1ecf1160e8ad4c7227/91578/purity-headphones.jpg","sourceStatusCode":200,"destWidth":229,"destHeight":229,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn70@2020_1/2020/08/25/00-51-41-924_9b233467d626f37c.webp","sourceBytes":3584,"destBytes":3918,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":910,"convertSpendMs":5,"createdTime":"2020-08-25 08:51:41","host":"us-016*","referer":"https://developers.soundcloud.com/blog/contest-soundcloud-and-acapela-group","linkMd5ListStr":"edf53c47b004b074d6799824414530ff","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.5 KB","destSize":"3.8 KB","compressRate":"109.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0e15abc6ffdc2c555cd20df1ec4c69f2/925b5/feature-flag.png","sourceStatusCode":200,"destWidth":465,"destHeight":326,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn36@2020_3/2020/08/25/00-51-41-864_802ecfd683b26a0d.webp","sourceBytes":16430,"destBytes":18314,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1039,"convertSpendMs":9,"createdTime":"2020-08-25 08:51:41","host":"us-032*","referer":"https://developers.soundcloud.com/blog/quality-mobile-trains","linkMd5ListStr":"655377572ca618cedb5c80aefa47a904","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16 KB","destSize":"17.9 KB","compressRate":"111.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/8545ccc3db8d8061df4a11f433587c2b/top-8.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn54@2020_4/2020/08/25/00-51-41-899_aa81581cffde0ac5.webp","sourceBytes":136,"destBytes":150,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":959,"convertSpendMs":4,"createdTime":"2020-08-25 08:51:41","host":"us-034*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"136 B","destSize":"150 B","compressRate":"110.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/864b39d8ea729317de2b128c1f9d0ba3/34e8a/managing_unplanned_support_tasks_hours_spent_chart.png","sourceStatusCode":200,"destWidth":600,"destHeight":371,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn39@2020_1/2020/08/25/00-51-41-952_28e01bf0d3befefc.webp","sourceBytes":4035,"destBytes":10378,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1022,"convertSpendMs":62,"createdTime":"2020-08-25 08:51:41","host":"us-027*","referer":"https://developers.soundcloud.com/blog/managing-unplanned-and-support-tasks","linkMd5ListStr":"ab6b8f60b8531d732d1420a3c4a8c8cc","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.9 KB","destSize":"10.1 KB","compressRate":"257.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/7d8143c091a260f7e2d789924aa10c89/8ff1e/image1.png","sourceStatusCode":200,"destWidth":800,"destHeight":390,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn21@2020_5/2020/08/25/00-51-41-925_7f423c9755f48bc7.webp","sourceBytes":28085,"destBytes":31200,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1103,"convertSpendMs":36,"createdTime":"2020-08-25 08:51:41","host":"us-009*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses","linkMd5ListStr":"85a241edadbd6592e8ed62c076621a0a","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"27.4 KB","destSize":"30.5 KB","compressRate":"111.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/992fd35bf993a2574229d3d02c0fdc0d/c7805/shbtweet3.png","sourceStatusCode":200,"destWidth":400,"destHeight":164,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn25@2020_5/2020/08/25/00-51-41-839_2900537a1dcb8328.webp","sourceBytes":12581,"destBytes":12208,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1099,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:41","host":"us-003*","referer":"https://developers.soundcloud.com/blog/story-hack-recap","linkMd5ListStr":"35e86c48165c154a7a06561e317253f9","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.3 KB","destSize":"11.9 KB","compressRate":"97%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/ef773003a9241036a26a9c57fb301aff/8ff1e/5-improved-service-names.png","sourceStatusCode":200,"destWidth":800,"destHeight":147,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn44@2020_2/2020/08/25/00-51-41-995_38d560ad8988e9be.webp","sourceBytes":10109,"destBytes":10702,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1007,"convertSpendMs":72,"createdTime":"2020-08-25 08:51:41","host":"us-021*","referer":"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces","linkMd5ListStr":"f81a65c15e531e43f8a25732890970aa","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"9.9 KB","destSize":"10.5 KB","compressRate":"105.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/ba8c16495806d8ea168036311e941d56/ef3f5/build_times_min21.png","sourceStatusCode":200,"destWidth":671,"destHeight":266,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn58@2020_3/2020/08/25/00-51-41-914_f0a0ae30e081d46c.webp","sourceBytes":2379,"destBytes":9332,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1002,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:41","host":"us-030*","referer":"https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2","linkMd5ListStr":"489725aa8909e81e9deac29a1b50c82b","githubUser":"myreaderx21","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"2.3 KB","destSize":"9.1 KB","compressRate":"392.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/3fb52692a62f8b4268450e8a9320ca5f/8ff1e/2-zipkin-trace-overview.png","sourceStatusCode":200,"destWidth":800,"destHeight":265,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn5@2020_6/2020/08/25/00-51-41-991_c794357f2a3ae54d.webp","sourceBytes":11274,"destBytes":14388,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1230,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:41","host":"us-040*","referer":"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces","linkMd5ListStr":"f81a65c15e531e43f8a25732890970aa","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"11 KB","destSize":"14.1 KB","compressRate":"127.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/627ca2cefc8e46c624bf881c0041f3f2/6b190/android_share_logo.png","sourceStatusCode":200,"destWidth":128,"destHeight":128,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn13@2020_2/2020/08/25/00-51-42-029_2f40b1fce0ff3ed2.webp","sourceBytes":968,"destBytes":1538,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1223,"convertSpendMs":21,"createdTime":"2020-08-25 08:51:41","host":"us-024*","referer":"https://developers.soundcloud.com/blog/introducing-the-android-sharing-kit","linkMd5ListStr":"ac3bc732414f0a55c1817f5e2c37e352","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"968 B","destSize":"1.5 KB","compressRate":"158.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0f5bb2a4ad6e67e9e5844995acc4daaa/a296c/bridge.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn6@2020_1/2020/08/25/00-51-42-127_d0310eab7c1afce8.webp","sourceBytes":13094,"destBytes":13178,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":891,"convertSpendMs":16,"createdTime":"2020-08-25 08:51:41","host":"us-012*","referer":"https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture","linkMd5ListStr":"67a5a2e60f7bb11708bee110bec4ba4a","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.8 KB","destSize":"12.9 KB","compressRate":"100.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/d0bd698936a521b8e3e1f5e3087dd37f/60eaf/dataset-encapsulation.png","sourceStatusCode":200,"destWidth":517,"destHeight":315,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn93@2020_4/2020/08/25/00-51-42-080_d0ff9e553d16a9f3.webp","sourceBytes":5139,"destBytes":14980,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1002,"convertSpendMs":12,"createdTime":"2020-08-25 08:51:41","host":"us-019*","referer":"https://developers.soundcloud.com/blog/a-better-model-of-data-ownership","linkMd5ListStr":"81ac367778605dafa205f894368fee2d","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5 KB","destSize":"14.6 KB","compressRate":"291.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/89046fde0dff8d7fb8593feec03e0863/8ff1e/back-on-track-max.png","sourceStatusCode":200,"destWidth":800,"destHeight":124,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn77@2020_1/2020/08/25/00-51-42-245_d76814c76d84a84b.webp","sourceBytes":5783,"destBytes":10616,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1187,"convertSpendMs":13,"createdTime":"2020-08-25 08:51:41","host":"us-007*","referer":"https://developers.soundcloud.com/blog/getting-a-team-back-on-track","linkMd5ListStr":"58efd0c426cab9f547e717054f187f59","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.6 KB","destSize":"10.4 KB","compressRate":"183.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/114e4dc8230cc7c7d2fddbaec478bbf5/8ff1e/periskop_ui.png","sourceStatusCode":200,"destWidth":800,"destHeight":394,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn90@2020_1/2020/08/25/00-51-42-299_e7034bdf0b2741ff.webp","sourceBytes":7348,"destBytes":9812,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1173,"convertSpendMs":120,"createdTime":"2020-08-25 08:51:41","host":"us-021*","referer":"https://developers.soundcloud.com/blog/periskop-exception-monitoring-service","linkMd5ListStr":"e085cd07fe339b684f0b334a598e1bfd","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.2 KB","destSize":"9.6 KB","compressRate":"133.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/4b4afa2ba8edef2b8a25de084981fd7b/135ae/iphone-sharing.png","sourceStatusCode":200,"destWidth":300,"destHeight":450,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn86@2020_5/2020/08/25/00-51-42-243_a7822afab02b9d5c.webp","sourceBytes":14557,"destBytes":16624,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1280,"convertSpendMs":30,"createdTime":"2020-08-25 08:51:41","host":"us-024*","referer":"https://developers.soundcloud.com/blog/sharing-sounds","linkMd5ListStr":"64bb3b1d574d8ffd7416368292865e77","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"14.2 KB","destSize":"16.2 KB","compressRate":"114.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/4a306802f50ee060998f06283978e5ce/b1c25/dataset-encapsulation-fixed.png","sourceStatusCode":200,"destWidth":605,"destHeight":315,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn97@2020_3/2020/08/25/00-51-42-300_22204eb910385ba9.webp","sourceBytes":8260,"destBytes":18660,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1201,"convertSpendMs":10,"createdTime":"2020-08-25 08:51:41","host":"us-016*","referer":"https://developers.soundcloud.com/blog/a-better-model-of-data-ownership","linkMd5ListStr":"81ac367778605dafa205f894368fee2d","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.1 KB","destSize":"18.2 KB","compressRate":"225.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/55086764b356e07e99a979d16552e9f4/8ff1e/method_plot.png","sourceStatusCode":200,"destWidth":800,"destHeight":481,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn47@2020_1/2020/08/25/00-51-42-205_dfdf182db53ade18.webp","sourceBytes":34958,"destBytes":53812,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1479,"convertSpendMs":21,"createdTime":"2020-08-25 08:51:41","host":"us-015*","referer":"https://developers.soundcloud.com/blog/congratulations-you-have-a-lot-of-code-remedying-androids-method-limit-part-2","linkMd5ListStr":"489725aa8909e81e9deac29a1b50c82b","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"34.1 KB","destSize":"52.6 KB","compressRate":"153.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/7c78f554adcf65b3c43aa5f7de99538a/8ff1e/indexing_before.png","sourceStatusCode":200,"destWidth":800,"destHeight":380,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn2@2020_5/2020/08/25/00-51-42-356_6d89dc4f639ba516.webp","sourceBytes":17457,"destBytes":22862,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1363,"convertSpendMs":92,"createdTime":"2020-08-25 08:51:41","host":"us-014*","referer":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud","linkMd5ListStr":"b48d9296f462bc043ccc5738e0ea3485","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"17 KB","destSize":"22.3 KB","compressRate":"131%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/a493ebb0d86ca96b889cb2a345706cee/54e54/e9.png","sourceStatusCode":200,"destWidth":580,"destHeight":790,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn36@2020_5/2020/08/25/00-51-42-301_cecf15fb6d1a07af.webp","sourceBytes":11976,"destBytes":21286,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":3131,"convertSpendMs":14,"createdTime":"2020-08-25 08:51:40","host":"europe65*","referer":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","linkMd5ListStr":"617d6d78a6d4ea6c18a0ca90fa588e57","githubUser":"myreaderx21","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"11.7 KB","destSize":"20.8 KB","compressRate":"177.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/13f2004388594fcc16116f97e5302987/8ff1e/pairing-illustrations-0.png","sourceStatusCode":200,"destWidth":800,"destHeight":328,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn23@2020_3/2020/08/25/00-51-42-563_9914b2a6849ffc11.webp","sourceBytes":6060,"destBytes":7154,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":864,"convertSpendMs":9,"createdTime":"2020-08-25 08:51:42","host":"us-53*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.9 KB","destSize":"7 KB","compressRate":"118.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/1ea986f39dad63df30336c9283c35bda/a296c/branching.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn9@2020_3/2020/08/25/00-51-42-400_d4f864a8279ac8ad.webp","sourceBytes":19123,"destBytes":18874,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1371,"convertSpendMs":28,"createdTime":"2020-08-25 08:51:41","host":"us-009*","referer":"https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture","linkMd5ListStr":"67a5a2e60f7bb11708bee110bec4ba4a","githubUser":"myreaderx23","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"18.7 KB","destSize":"18.4 KB","compressRate":"98.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/56eb450495d9020860d124750176995b/26532/confirm-mitigated-w-warning.png","sourceStatusCode":200,"destWidth":506,"destHeight":585,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn72@2020_3/2020/08/25/00-51-42-335_c87ea1d79846f3de.webp","sourceBytes":15454,"destBytes":27314,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":3241,"convertSpendMs":13,"createdTime":"2020-08-25 08:51:40","host":"europe65*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"15.1 KB","destSize":"26.7 KB","compressRate":"176.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/895d086e871a111fa120219d5d80655f/tools.svg","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn39@2020_4/2020/08/25/00-51-42-769_9399e41668830282.svg","sourceBytes":1792,"destBytes":1792,"feedId":10291,"totalSpendMs":882,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:42","host":"us-53*","referer":"https://developers.soundcloud.com/blog/keeping-counts-in-sync","linkMd5ListStr":"15e0b5215de1cee87672a5788e8bc0b1","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.8 KB","destSize":"1.8 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"http://farm8.staticflickr.com/7167/6449370055_e981750e37_d.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":332,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn31@2020_6/2020/08/25/00-51-42-752_7af34333328f20e0.webp","sourceBytes":66557,"destBytes":35134,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1129,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:42","host":"us-53*","referer":"https://developers.soundcloud.com/blog/music-hack-day-london-2011","linkMd5ListStr":"79f3b3462e4f06843f8b0b6c4fe8b454","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"65 KB","destSize":"34.3 KB","compressRate":"52.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0751508718ebb654039047dfd12bc02c/48a11/toybox.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":500,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn43@2020_3/2020/08/25/00-51-42-847_459be9c7cdbd0457.webp","sourceBytes":26468,"destBytes":32094,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1007,"convertSpendMs":20,"createdTime":"2020-08-25 08:51:42","host":"us-53*","referer":"https://developers.soundcloud.com/blog/how-to-make-a-soundcloud-powered-toy","linkMd5ListStr":"df25e408855776f8d3eed1735ada9d86","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"25.8 KB","destSize":"31.3 KB","compressRate":"121.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/2ebccf21cf56cba42df5d0c35274453d/top-2.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn65@2020_1/2020/08/25/00-51-42-044_faeeb88f7b8de5e2.webp","sourceBytes":135,"destBytes":146,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1901,"convertSpendMs":19,"createdTime":"2020-08-25 08:51:41","host":"us-021*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"135 B","destSize":"146 B","compressRate":"108.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/4ffdf00e28a16c6f91cf7b6bff99bf4a/54e54/e2.png","sourceStatusCode":200,"destWidth":580,"destHeight":30,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn54@2020_6/2020/08/25/00-51-42-967_eb1e349f26efcb4c.webp","sourceBytes":1411,"destBytes":2354,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":887,"convertSpendMs":4,"createdTime":"2020-08-25 08:51:42","host":"us-028*","referer":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","linkMd5ListStr":"617d6d78a6d4ea6c18a0ca90fa588e57","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.4 KB","destSize":"2.3 KB","compressRate":"166.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/9d66726967ac1ac4ac9244c609b0d002/26532/confirm-mitigated.png","sourceStatusCode":200,"destWidth":506,"destHeight":509,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn35@2020_4/2020/08/25/00-51-42-804_0542dac4f245c246.webp","sourceBytes":11332,"destBytes":19086,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1056,"convertSpendMs":10,"createdTime":"2020-08-25 08:51:42","host":"us-53*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"11.1 KB","destSize":"18.6 KB","compressRate":"168.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/6f3af3d0fe190ec925393aeb5f0fa3c1/54e54/e5.png","sourceStatusCode":200,"destWidth":580,"destHeight":353,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn57@2020_4/2020/08/25/00-51-43-007_cca1397978b1ee7f.webp","sourceBytes":5218,"destBytes":8862,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":892,"convertSpendMs":16,"createdTime":"2020-08-25 08:51:42","host":"us-031*","referer":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","linkMd5ListStr":"617d6d78a6d4ea6c18a0ca90fa588e57","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.1 KB","destSize":"8.7 KB","compressRate":"169.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/2623543bfa5746756f3fd0e5f1345b8e/ae69b/repost.png","sourceStatusCode":200,"destWidth":113,"destHeight":113,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx33/cdn90@2020_1/2020/08/25/00-51-42-861_2df026fe69af4498.webp","sourceBytes":1906,"destBytes":3624,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1045,"convertSpendMs":4,"createdTime":"2020-08-25 08:51:42","host":"europe65*","referer":"https://developers.soundcloud.com/blog/building-the-next-soundcloud","linkMd5ListStr":"e6bf24ccfd2d4d421302716717b1cfec","githubUser":"myreaderx33","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.9 KB","destSize":"3.5 KB","compressRate":"190.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/c2c3d7ad79a9249aa3e68e90dfb478dc/135ae/waveform_rendering_sharp.png","sourceStatusCode":200,"destWidth":300,"destHeight":340,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn5@2020_6/2020/08/25/00-51-42-975_5d49a0a501475e8e.webp","sourceBytes":656,"destBytes":5960,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":964,"convertSpendMs":5,"createdTime":"2020-08-25 08:51:42","host":"europe-24*","referer":"https://developers.soundcloud.com/blog/ios-waveform-rendering","linkMd5ListStr":"8e813ef74b6373575f09190520cbac28","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"656 B","destSize":"5.8 KB","compressRate":"908.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/ea8c73f9856fe0af532ed2e8d841c2f4/26532/confirm-naive.png","sourceStatusCode":200,"destWidth":506,"destHeight":372,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn81@2020_1/2020/08/25/00-51-42-959_c4e74aca3a78a8c0.webp","sourceBytes":5159,"destBytes":9026,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1058,"convertSpendMs":7,"createdTime":"2020-08-25 08:51:42","host":"europe-58*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5 KB","destSize":"8.8 KB","compressRate":"175%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/996aa0c3405802366ce3d8b0b66b6e47/d19c0/cloudbrowser.png","sourceStatusCode":200,"destWidth":500,"destHeight":273,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn74@2020_4/2020/08/25/00-51-43-026_931f9c0b7792fa7a.webp","sourceBytes":17832,"destBytes":14738,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":960,"convertSpendMs":12,"createdTime":"2020-08-25 08:51:42","host":"us-040*","referer":"https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf","linkMd5ListStr":"15f673584ea6f54247384e89ce11b72c","githubUser":"myreaderx21","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"17.4 KB","destSize":"14.4 KB","compressRate":"82.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/2bf414b0fa6ca0acc8e9a247935e0c3d/building_datasets.svg","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn15@2020_3/2020/08/25/00-51-42-602_e79853673ec48372.svg","sourceBytes":302746,"destBytes":302746,"feedId":10291,"totalSpendMs":1530,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:42","host":"us-024*","referer":"https://developers.soundcloud.com/blog/how-not-to-build-datasets-and-consume-data-at-your-company","linkMd5ListStr":"7e1fac7ae2cbdcaac924e69f75c25d60","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"295.7 KB","destSize":"295.7 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/1af3dd922e401466c29156a301ae649f/8ff1e/pairing-illustrations-2.png","sourceStatusCode":200,"destWidth":800,"destHeight":328,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn50@2020_3/2020/08/25/00-51-43-086_83b2c5502232633a.webp","sourceBytes":19802,"destBytes":21546,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1082,"convertSpendMs":99,"createdTime":"2020-08-25 08:51:42","host":"us-026*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"19.3 KB","destSize":"21 KB","compressRate":"108.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/6adc22b6d275182f0745fe733a9b3d36/8939e/airbrake-report-cont.png","sourceStatusCode":200,"destWidth":505,"destHeight":181,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn65@2020_1/2020/08/25/00-51-43-156_2c7fa33af3697c7c.webp","sourceBytes":17249,"destBytes":6272,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1019,"convertSpendMs":6,"createdTime":"2020-08-25 08:51:42","host":"us-035*","referer":"https://developers.soundcloud.com/blog/front-end-javascript-bug-tracking","linkMd5ListStr":"faf31d858376c6584d716294eeb6cc11","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16.8 KB","destSize":"6.1 KB","compressRate":"36.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/74397e83677fe39912ec67eaa63c47df/8ff1e/pairing-illustrations-4.png","sourceStatusCode":200,"destWidth":800,"destHeight":328,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn70@2020_6/2020/08/25/00-51-43-108_7506695b9c64869e.webp","sourceBytes":23248,"destBytes":22818,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1011,"convertSpendMs":22,"createdTime":"2020-08-25 08:51:42","host":"us-037*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"22.7 KB","destSize":"22.3 KB","compressRate":"98.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/853e72964762d6586a7b3020769ba5f8/48a11/end.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":375,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn62@2020_1/2020/08/25/00-51-43-049_7160e87d3f9a59dc.webp","sourceBytes":14682,"destBytes":17546,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":970,"convertSpendMs":32,"createdTime":"2020-08-25 08:51:42","host":"us-033*","referer":"https://developers.soundcloud.com/blog/music-hack-day-barcelona-2012","linkMd5ListStr":"8cfff08585641cac6e3abd4ef46417c4","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"14.3 KB","destSize":"17.1 KB","compressRate":"119.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/ac26210c0063863e1b7e411ba9c2cd0c/4c799/areweplayingyet.jpg","sourceStatusCode":200,"destWidth":379,"destHeight":264,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn93@2020_2/2020/08/25/00-51-42-881_6897c1cc506a8b6c.webp","sourceBytes":12211,"destBytes":15182,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1145,"convertSpendMs":7,"createdTime":"2020-08-25 08:51:42","host":"europe68*","referer":"https://developers.soundcloud.com/blog/soundcloud-launches-the-html5-audio-improvement-initiative","linkMd5ListStr":"8287c953457e19277b175ad6423b25ad","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"11.9 KB","destSize":"14.8 KB","compressRate":"124.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/f714bfe686c46edd22b8be909f62f905/c5a17/cloudseeder_select.png","sourceStatusCode":200,"destWidth":512,"destHeight":384,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn2@2020_2/2020/08/25/00-51-42-963_f30dcdccdd556a55.webp","sourceBytes":34184,"destBytes":26640,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1124,"convertSpendMs":17,"createdTime":"2020-08-25 08:51:42","host":"europe-22*","referer":"https://developers.soundcloud.com/blog/introducing-the-cloudseeder-devkit","linkMd5ListStr":"b3608559289da9cd03cfefee1a744b37","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"33.4 KB","destSize":"26 KB","compressRate":"77.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/e410f309650f3a2fbf30fb6f1a5fc543/c7805/shbtweet1.png","sourceStatusCode":200,"destWidth":400,"destHeight":143,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn13@2020_3/2020/08/25/00-51-43-220_bc6604b627784da0.webp","sourceBytes":8926,"destBytes":8510,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":900,"convertSpendMs":7,"createdTime":"2020-08-25 08:51:43","host":"us-003*","referer":"https://developers.soundcloud.com/blog/story-hack-recap","linkMd5ListStr":"35e86c48165c154a7a06561e317253f9","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.7 KB","destSize":"8.3 KB","compressRate":"95.3%"},{"code":1,"isDone":false,"source":"https://img.skitch.com/20110722-1r2ynrxuyeqbm47rbmgh6bwce5.png","sourceStatusCode":200,"destWidth":0,"destHeight":0,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn28@2020_2/2020/08/25/00-51-42-971_e2a8c0fc69d50de0.jpg","sourceBytes":52870,"destBytes":52870,"feedId":10291,"totalSpendMs":1506,"convertSpendMs":2,"createdTime":"2020-08-25 08:51:42","host":"us-53*","referer":"https://developers.soundcloud.com/blog/building-the-soundcloud-mobile-site-using-backbone.js","linkMd5ListStr":"b88be870659c0391f1ec17a620f8046d","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"51.6 KB","destSize":"51.6 KB","compressRate":"100%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/3d521bf844e75ef5465b82c3980c3d08/48a11/lee-johannes-hacking.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":334,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn97@2020_2/2020/08/25/00-51-42-999_958cccfc2f9f5877.webp","sourceBytes":19601,"destBytes":25936,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1219,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:42","host":"europe70*","referer":"https://developers.soundcloud.com/blog/soundcloud-at-music-hack-day-sf","linkMd5ListStr":"15f673584ea6f54247384e89ce11b72c","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"19.1 KB","destSize":"25.3 KB","compressRate":"132.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/245a03d81fec8969a61e4ca6d88ce189/b13b6/periskop_design.png","sourceStatusCode":200,"destWidth":721,"destHeight":322,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn77@2020_3/2020/08/25/00-51-43-203_b9f950d5e2dd95f5.webp","sourceBytes":6109,"destBytes":21414,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1137,"convertSpendMs":126,"createdTime":"2020-08-25 08:51:42","host":"us-52*","referer":"https://developers.soundcloud.com/blog/periskop-exception-monitoring-service","linkMd5ListStr":"e085cd07fe339b684f0b334a598e1bfd","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6 KB","destSize":"20.9 KB","compressRate":"350.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/cfcb22261ad68e86a1464a577e9cb957/8ff1e/pipeline-automatic-canary.png","sourceStatusCode":200,"destWidth":800,"destHeight":450,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn9@2020_5/2020/08/25/00-51-43-201_26a52ee5dc6501d3.webp","sourceBytes":9588,"destBytes":15966,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1015,"convertSpendMs":12,"createdTime":"2020-08-25 08:51:43","host":"us-001*","referer":"https://developers.soundcloud.com/blog/hands-off-deployment-with-canary","linkMd5ListStr":"e23324783fc57afcc03c24d0a2f624db","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"9.4 KB","destSize":"15.6 KB","compressRate":"166.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/1a6422e826679f9dcc889cdb99f83952/67d4f/product-engineering-diagram-4.jpg","sourceStatusCode":200,"destWidth":700,"destHeight":439,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn22@2020_2/2020/08/25/00-51-43-317_821440c53dcb271e.webp","sourceBytes":19886,"destBytes":19136,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":949,"convertSpendMs":16,"createdTime":"2020-08-25 08:51:43","host":"us-007*","referer":"https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-1-dealing-with-the-monolith","linkMd5ListStr":"fac53914c7e6fee9d4560f99a93a3063","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"19.4 KB","destSize":"18.7 KB","compressRate":"96.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/posts/Selection_006-505x231.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":341,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:43","host":"us-006*","referer":"https://developers.soundcloud.com/blog/building-the-next-soundcloud","linkMd5ListStr":"e6bf24ccfd2d4d421302716717b1cfec","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/379b53659c14f82127c31d4fc648625c/f6afc/planning_simpler_version.png","sourceStatusCode":200,"destWidth":752,"destHeight":349,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn25@2020_1/2020/08/25/00-51-43-440_7642665659be2810.webp","sourceBytes":16589,"destBytes":23876,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1025,"convertSpendMs":19,"createdTime":"2020-08-25 08:51:43","host":"us-009*","referer":"https://developers.soundcloud.com/blog/managing-unplanned-and-support-tasks","linkMd5ListStr":"ab6b8f60b8531d732d1420a3c4a8c8cc","githubUser":"myreaderx23","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"16.2 KB","destSize":"23.3 KB","compressRate":"143.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0d4a8f3fce7fd6236daa5c36a39f4d7e/48a11/reactable.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":332,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn29@2020_1/2020/08/25/00-51-43-360_4ea8b5550dc3911c.webp","sourceBytes":18912,"destBytes":22562,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1109,"convertSpendMs":13,"createdTime":"2020-08-25 08:51:43","host":"us-012*","referer":"https://developers.soundcloud.com/blog/music-hack-day-barcelona-2012","linkMd5ListStr":"8cfff08585641cac6e3abd4ef46417c4","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"18.5 KB","destSize":"22 KB","compressRate":"119.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/d55f08cc89ab80f46068e977d4213585/0901c/counts_stitch.png","sourceStatusCode":200,"destWidth":776,"destHeight":608,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn18@2020_1/2020/08/25/00-51-43-411_70af058947cf6c32.webp","sourceBytes":14570,"destBytes":30516,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1132,"convertSpendMs":68,"createdTime":"2020-08-25 08:51:43","host":"us-005*","referer":"https://developers.soundcloud.com/blog/keeping-counts-in-sync","linkMd5ListStr":"15e0b5215de1cee87672a5788e8bc0b1","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"14.2 KB","destSize":"29.8 KB","compressRate":"209.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/f7e32a09adbca3768ba99a9b91e38d50/top-4.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn45@2020_1/2020/08/25/00-51-43-561_653caee56fc4732a.webp","sourceBytes":134,"destBytes":150,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":886,"convertSpendMs":3,"createdTime":"2020-08-25 08:51:43","host":"us-024*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"134 B","destSize":"150 B","compressRate":"111.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/625e95ddaf0c1936b44c4c0d32018589/ae69b/notification.png","sourceStatusCode":200,"destWidth":113,"destHeight":113,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn42@2020_6/2020/08/25/00-51-43-622_39764ef810b0ecfa.webp","sourceBytes":1772,"destBytes":3326,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":939,"convertSpendMs":41,"createdTime":"2020-08-25 08:51:43","host":"us-021*","referer":"https://developers.soundcloud.com/blog/building-the-next-soundcloud","linkMd5ListStr":"e6bf24ccfd2d4d421302716717b1cfec","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.7 KB","destSize":"3.2 KB","compressRate":"187.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/582e02631c980b94411d5cf92fe39825/302a3/counts_cassandra.png","sourceStatusCode":200,"destWidth":401,"destHeight":359,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn33@2020_5/2020/08/25/00-51-43-606_7cfa4d598ec92d4f.webp","sourceBytes":5915,"destBytes":15494,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1010,"convertSpendMs":90,"createdTime":"2020-08-25 08:51:43","host":"us-014*","referer":"https://developers.soundcloud.com/blog/keeping-counts-in-sync","linkMd5ListStr":"15e0b5215de1cee87672a5788e8bc0b1","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.8 KB","destSize":"15.1 KB","compressRate":"261.9%"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24132127653036_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":71,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:44","host":"us-035*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/1cf2891ffed889a6c92890b9fb0d87e4/top-6.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn37@2020_4/2020/08/25/00-51-43-686_571f03f5b1f38456.webp","sourceBytes":137,"destBytes":150,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":907,"convertSpendMs":2,"createdTime":"2020-08-25 08:51:43","host":"us-017*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"137 B","destSize":"150 B","compressRate":"109.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/35c55e88dd9e42b3a19ade9557142471/8ff1e/products_in_wip.png","sourceStatusCode":200,"destWidth":800,"destHeight":233,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn49@2020_6/2020/08/25/00-51-43-750_4853ddbace9a3abf.webp","sourceBytes":8757,"destBytes":9336,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1030,"convertSpendMs":39,"createdTime":"2020-08-25 08:51:43","host":"us-026*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.6 KB","destSize":"9.1 KB","compressRate":"106.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0f2e7215e4132593d5394400b04f1c38/26532/confirm-exploit.png","sourceStatusCode":200,"destWidth":506,"destHeight":372,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx14/cdn57@2020_3/2020/08/25/00-51-43-829_fd7d52ac9cf9fb1d.webp","sourceBytes":5751,"destBytes":10448,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":905,"convertSpendMs":8,"createdTime":"2020-08-25 08:51:43","host":"us-031*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx14","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.6 KB","destSize":"10.2 KB","compressRate":"181.7%"},{"code":1,"isDone":false,"source":"http://img.svbtle.com/inline_leemartin_24131748089754_raw.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":60,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:44","host":"us-033*","referer":"https://developers.soundcloud.com/blog/waveforms-let-s-talk-about-them","linkMd5ListStr":"4b5f66442890e7eaea847ce0dd601b18","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/9759dc7ed4f11651d3ee281112c50844/top-1.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn79@2020_6/2020/08/25/00-51-43-798_67b028b82783d561.webp","sourceBytes":133,"destBytes":158,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":938,"convertSpendMs":1,"createdTime":"2020-08-25 08:51:43","host":"europe21*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"133 B","destSize":"158 B","compressRate":"118.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/e405663ada13f8054ac2646ede66561a/df2c7/astoria.jpg","sourceStatusCode":200,"destWidth":450,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn62@2020_2/2020/08/25/00-51-43-937_561845c0b0d468f7.webp","sourceBytes":27874,"destBytes":33340,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":976,"convertSpendMs":19,"createdTime":"2020-08-25 08:51:43","host":"us-033*","referer":"https://developers.soundcloud.com/blog/pennapps-recap","linkMd5ListStr":"b27715d5d2a8093929774bbb15a3b2c6","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"27.2 KB","destSize":"32.6 KB","compressRate":"119.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/b766f1ac96e814c9391fd28fa8872d63/8ff1e/two_engineers_two_tasks.png","sourceStatusCode":200,"destWidth":800,"destHeight":215,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn84@2020_5/2020/08/25/00-51-43-879_a29b8e8e15a36265.webp","sourceBytes":8554,"destBytes":11590,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1085,"convertSpendMs":7,"createdTime":"2020-08-25 08:51:43","host":"europe-24*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.4 KB","destSize":"11.3 KB","compressRate":"135.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/ef09ec4a064d6973f1ad877baff77f7e/8ff1e/indexing_after.png","sourceStatusCode":200,"destWidth":800,"destHeight":348,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn100@2020_4/2020/08/25/00-51-44-126_9d5e2b07dd661589.webp","sourceBytes":7260,"destBytes":9676,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":868,"convertSpendMs":12,"createdTime":"2020-08-25 08:51:43","host":"us-012*","referer":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud","linkMd5ListStr":"b48d9296f462bc043ccc5738e0ea3485","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.1 KB","destSize":"9.4 KB","compressRate":"133.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/12d0c29bd0abf362e4d3b65c8abca4dc/8ff1e/image5.png","sourceStatusCode":200,"destWidth":800,"destHeight":199,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn19@2020_6/2020/08/25/00-51-44-193_f16ddd47f1b8594c.webp","sourceBytes":13014,"destBytes":12196,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":884,"convertSpendMs":9,"createdTime":"2020-08-25 08:51:44","host":"us-033*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2","linkMd5ListStr":"2a094ed2b890cb88dd022b4f84947b7c","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"12.7 KB","destSize":"11.9 KB","compressRate":"93.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/3ef42090d8683220360c3c37c2bae663/8ff1e/search.png","sourceStatusCode":200,"destWidth":800,"destHeight":303,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn68@2020_6/2020/08/25/00-51-43-792_cb90027559d3e472.webp","sourceBytes":15815,"destBytes":20970,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1253,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:43","host":"europe-58*","referer":"https://developers.soundcloud.com/blog/tuist-project-generation","linkMd5ListStr":"b1b7ea6f021159bbe86db6b0da568bf3","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"15.4 KB","destSize":"20.5 KB","compressRate":"132.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/7005b183f66e437e591eb82937666301/top-5.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn16@2020_3/2020/08/25/00-51-44-219_bd25a75332ff82af.webp","sourceBytes":132,"destBytes":154,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":892,"convertSpendMs":1,"createdTime":"2020-08-25 08:51:44","host":"us-029*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"132 B","destSize":"154 B","compressRate":"116.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/d0fe34af665f765511fb9fe8dc7a49cf/8ff1e/image3.png","sourceStatusCode":200,"destWidth":800,"destHeight":179,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn91@2020_1/2020/08/25/00-51-44-179_2492faff053cb4be.webp","sourceBytes":13956,"destBytes":12308,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":965,"convertSpendMs":43,"createdTime":"2020-08-25 08:51:44","host":"us-005*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses","linkMd5ListStr":"85a241edadbd6592e8ed62c076621a0a","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"13.6 KB","destSize":"12 KB","compressRate":"88.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/244c11997e85fd73d949a0252e476a7f/8ff1e/tuist-helpers.png","sourceStatusCode":200,"destWidth":800,"destHeight":572,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn76@2020_2/2020/08/25/00-51-43-854_9777ef2598e8de94.webp","sourceBytes":43109,"destBytes":65786,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1264,"convertSpendMs":25,"createdTime":"2020-08-25 08:51:43","host":"europe68*","referer":"https://developers.soundcloud.com/blog/tuist-project-generation","linkMd5ListStr":"b1b7ea6f021159bbe86db6b0da568bf3","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"42.1 KB","destSize":"64.2 KB","compressRate":"152.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/975510f5992ad5dd42726e017b5e1b32/8ff1e/outdated-pr.png","sourceStatusCode":200,"destWidth":800,"destHeight":143,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn39@2020_2/2020/08/25/00-51-44-145_7a73d812faa9d89a.webp","sourceBytes":6912,"destBytes":8820,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":939,"convertSpendMs":6,"createdTime":"2020-08-25 08:51:44","host":"europe67*","referer":"https://developers.soundcloud.com/blog/quality-mobile-trains","linkMd5ListStr":"655377572ca618cedb5c80aefa47a904","githubUser":"myreaderx23","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.8 KB","destSize":"8.6 KB","compressRate":"127.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/d16372095651eb4c86d6556e9a4ebf14/8ff1e/prometheus_bazooka_cpu_top3.png","sourceStatusCode":200,"destWidth":800,"destHeight":522,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn3@2020_5/2020/08/25/00-51-44-196_baffd473ec2ce6f0.webp","sourceBytes":24180,"destBytes":24288,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1008,"convertSpendMs":14,"createdTime":"2020-08-25 08:51:44","host":"us-015*","referer":"https://developers.soundcloud.com/blog/prometheus-monitoring-at-soundcloud","linkMd5ListStr":"f97e1f94d709bd0c92f56241478cd401","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"23.6 KB","destSize":"23.7 KB","compressRate":"100.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/db26cd209c79194cff637894ff4bbc53/54e54/e7.png","sourceStatusCode":200,"destWidth":580,"destHeight":505,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn12@2020_3/2020/08/25/00-51-44-244_e5127e5dc8b281dd.webp","sourceBytes":8915,"destBytes":16228,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1000,"convertSpendMs":10,"createdTime":"2020-08-25 08:51:44","host":"us-025*","referer":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","linkMd5ListStr":"617d6d78a6d4ea6c18a0ca90fa588e57","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.7 KB","destSize":"15.8 KB","compressRate":"182%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/assets/SuggesterTimings-505x378.png","sourceStatusCode":404,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn0@2020_1/404.jpg","sourceBytes":0,"destBytes":0,"feedId":10291,"totalSpendMs":76,"convertSpendMs":0,"createdTime":"2020-08-25 08:51:45","host":"europe-22*","referer":"https://developers.soundcloud.com/blog/architecture-behind-our-new-search-and-explore-experience","linkMd5ListStr":"a1f960286d7cd6e29448487562ca7cca","extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[404],"sourceSize":"0","destSize":"0"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/a78b43f8beffe810a9bf35527f8eb21d/8ff1e/image4.png","sourceStatusCode":200,"destWidth":800,"destHeight":308,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn95@2020_6/2020/08/25/00-51-44-252_153e83c3f1f0cae7.webp","sourceBytes":17449,"destBytes":20008,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1078,"convertSpendMs":26,"createdTime":"2020-08-25 08:51:44","host":"us-008*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses","linkMd5ListStr":"85a241edadbd6592e8ed62c076621a0a","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"17 KB","destSize":"19.5 KB","compressRate":"114.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/f77332c890943a3818b91ff2bf690bab/54e54/e8.png","sourceStatusCode":200,"destWidth":580,"destHeight":752,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn32@2020_3/2020/08/25/00-51-44-294_eb475160e70a4d7e.webp","sourceBytes":12137,"destBytes":21454,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":941,"convertSpendMs":19,"createdTime":"2020-08-25 08:51:44","host":"us-55*","referer":"https://developers.soundcloud.com/blog/evolution-of-soundclouds-architecture","linkMd5ListStr":"617d6d78a6d4ea6c18a0ca90fa588e57","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"11.9 KB","destSize":"21 KB","compressRate":"176.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/a043f1ce1cca7c3accfd1acce356c867/8ff1e/lead_time.png","sourceStatusCode":200,"destWidth":800,"destHeight":212,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx18/cdn23@2020_4/2020/08/25/00-51-44-293_876ae8481b53a415.webp","sourceBytes":9081,"destBytes":9776,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":989,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:44","host":"us-036*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx18","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"8.9 KB","destSize":"9.5 KB","compressRate":"107.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/c6d1a929204d97718690da3a644d8452/cc651/oboe_branching.png","sourceStatusCode":200,"destWidth":668,"destHeight":261,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn51@2020_1/2020/08/25/00-51-44-322_f740f423f75fbec3.webp","sourceBytes":7959,"destBytes":15606,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":931,"convertSpendMs":15,"createdTime":"2020-08-25 08:51:44","host":"us-001*","referer":"https://developers.soundcloud.com/blog/soundcloud-is-playing-the-oboe","linkMd5ListStr":"9f6d17fdcbfb0db6422e7549b392ad30","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.8 KB","destSize":"15.2 KB","compressRate":"196.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0f57e386c97d73671a034e0ab0f2b9ad/fe994/6-zipkin-span-annotations-k8s-enhanced.png","sourceStatusCode":200,"destWidth":593,"destHeight":454,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn43@2020_5/2020/08/25/00-51-44-116_3cb2933fa6aaaf1d.webp","sourceBytes":10404,"destBytes":17128,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1103,"convertSpendMs":10,"createdTime":"2020-08-25 08:51:44","host":"europe70*","referer":"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces","linkMd5ListStr":"f81a65c15e531e43f8a25732890970aa","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"10.2 KB","destSize":"16.7 KB","compressRate":"164.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/e84b60c281b7908661ad607382572430/48a11/bghack2.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":625,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn36@2020_2/2020/08/25/00-51-44-118_00eb232b8d03112d.webp","sourceBytes":40926,"destBytes":50934,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1290,"convertSpendMs":19,"createdTime":"2020-08-25 08:51:44","host":"europe62*","referer":"https://developers.soundcloud.com/blog/berlin-geekettes-hackathon-roundup","linkMd5ListStr":"bffd0786bb86e91b1a565ded47ffa5b8","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"40 KB","destSize":"49.7 KB","compressRate":"124.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/d15f81a1f16e5ac189ee6c73559cd9d2/8ff1e/3-zipkin-span-transformation.png","sourceStatusCode":200,"destWidth":800,"destHeight":605,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn47@2020_3/2020/08/25/00-51-44-161_b35ede955a3698db.webp","sourceBytes":44142,"destBytes":41942,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1390,"convertSpendMs":18,"createdTime":"2020-08-25 08:51:44","host":"europe-23*","referer":"https://developers.soundcloud.com/blog/using-kubernetes-pod-metadata-to-improve-zipkin-traces","linkMd5ListStr":"f81a65c15e531e43f8a25732890970aa","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"43.1 KB","destSize":"41 KB","compressRate":"95%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/602eee3352663d0b66444926a0aca01a/8ff1e/ios-playground.png","sourceStatusCode":200,"destWidth":800,"destHeight":339,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn61@2020_3/2020/08/25/00-51-44-708_85deda808f5d1edf.webp","sourceBytes":25887,"destBytes":25778,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1052,"convertSpendMs":15,"createdTime":"2020-08-25 08:51:44","host":"us-51*","referer":"https://developers.soundcloud.com/blog/leveraging-frameworks-to-speed-up-our-development-on-ios-part-1","linkMd5ListStr":"fefeab11e72cdfdba249848f6ee099ad","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"25.3 KB","destSize":"25.2 KB","compressRate":"99.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/686af2fc0c46de5ce22a0bf509175526/8ff1e/pairing-illustrations-3.png","sourceStatusCode":200,"destWidth":800,"destHeight":328,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn65@2020_6/2020/08/25/00-51-44-410_4ea340f8b32a53fc.webp","sourceBytes":14897,"destBytes":15332,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1228,"convertSpendMs":9,"createdTime":"2020-08-25 08:51:44","host":"europe62*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"14.5 KB","destSize":"15 KB","compressRate":"102.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/39e8c349e19c63ba7707287e28c46895/8ff1e/back-on-track-kpi.png","sourceStatusCode":200,"destWidth":800,"destHeight":481,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx31/cdn69@2020_2/2020/08/25/00-51-44-452_25ba7d56d596d6e3.webp","sourceBytes":15146,"destBytes":21482,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1250,"convertSpendMs":14,"createdTime":"2020-08-25 08:51:44","host":"europe-24*","referer":"https://developers.soundcloud.com/blog/getting-a-team-back-on-track","linkMd5ListStr":"58efd0c426cab9f547e717054f187f59","githubUser":"myreaderx31","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"14.8 KB","destSize":"21 KB","compressRate":"141.8%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/49e8022a8f73567d4a3dc2659c4ff0f8/548e0/stitch_diagram.jpg","sourceStatusCode":200,"destWidth":649,"destHeight":578,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx/cdn92@2020_4/2020/08/25/00-51-44-845_ae9f598c3206243d.webp","sourceBytes":21603,"destBytes":26872,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":964,"convertSpendMs":17,"createdTime":"2020-08-25 08:51:44","host":"us-031*","referer":"https://developers.soundcloud.com/blog/real-time-counts-with-stitch","linkMd5ListStr":"95f32efbd2ba084266d03a2e8d0bb67c","githubUser":"myreaderx","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"21.1 KB","destSize":"26.2 KB","compressRate":"124.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/38fbf30a70c481bb27226a36390f8ce5/8ff1e/pairing-illustrations-5.png","sourceStatusCode":200,"destWidth":800,"destHeight":328,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn87@2020_2/2020/08/25/00-51-44-872_6dcaf0ba65958b60.webp","sourceBytes":28664,"destBytes":28158,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1096,"convertSpendMs":21,"createdTime":"2020-08-25 08:51:44","host":"us-020*","referer":"https://developers.soundcloud.com/blog/remote-device-sign-in","linkMd5ListStr":"0e056153e93f7607efe3888e96205d0b","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"28 KB","destSize":"27.5 KB","compressRate":"98.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/e4dbf7cc6a9142f179b26e4f6f1a06ee/8ff1e/one_engineer_two_tasks_schedule.png","sourceStatusCode":200,"destWidth":800,"destHeight":130,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx8/cdn3@2020_5/2020/08/25/00-51-44-977_d840467bb754b4cb.webp","sourceBytes":5142,"destBytes":7694,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":939,"convertSpendMs":16,"createdTime":"2020-08-25 08:51:44","host":"us-009*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx8","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5 KB","destSize":"7.5 KB","compressRate":"149.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/88b6c0f9d785d4c8807a4d4305c561f5/8ff1e/new-file-xcode.png","sourceStatusCode":200,"destWidth":800,"destHeight":533,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx2/cdn78@2020_1/2020/08/25/00-51-44-842_9d7a8a00ad44a9ef.webp","sourceBytes":30697,"destBytes":44078,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1203,"convertSpendMs":68,"createdTime":"2020-08-25 08:51:44","host":"us-004*","referer":"https://developers.soundcloud.com/blog/tuist-project-generation","linkMd5ListStr":"b1b7ea6f021159bbe86db6b0da568bf3","githubUser":"myreaderx2","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"30 KB","destSize":"43 KB","compressRate":"143.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0cc85866837a1b7cfdaedc06ac43776f/a296c/viper.jpg","sourceStatusCode":200,"destWidth":800,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx10/cdn7@2020_6/2020/08/25/00-51-45-017_161393d472657c98.webp","sourceBytes":18518,"destBytes":14360,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1031,"convertSpendMs":66,"createdTime":"2020-08-25 08:51:44","host":"us-021*","referer":"https://developers.soundcloud.com/blog/how-we-develop-new-features-using-offsites-and-clean-architecture","linkMd5ListStr":"67a5a2e60f7bb11708bee110bec4ba4a","githubUser":"myreaderx10","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"18.1 KB","destSize":"14 KB","compressRate":"77.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/4f182e4d6e605f9894f241f2813e6bb2/8ff1e/pipeline-manual-canary.png","sourceStatusCode":200,"destWidth":800,"destHeight":432,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn95@2020_1/2020/08/25/00-51-45-093_eed90e26cadb4fd2.webp","sourceBytes":7844,"destBytes":13544,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1200,"convertSpendMs":12,"createdTime":"2020-08-25 08:51:44","host":"us-51*","referer":"https://developers.soundcloud.com/blog/hands-off-deployment-with-canary","linkMd5ListStr":"e23324783fc57afcc03c24d0a2f624db","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"7.7 KB","destSize":"13.2 KB","compressRate":"172.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/b8afee81a2778887287217fac298be28/c5a17/cloudseeder_main.png","sourceStatusCode":200,"destWidth":512,"destHeight":384,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn19@2020_5/2020/08/25/00-51-44-973_600c18ece2f1779d.webp","sourceBytes":35363,"destBytes":28328,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1103,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:44","host":"europe21*","referer":"https://developers.soundcloud.com/blog/introducing-the-cloudseeder-devkit","linkMd5ListStr":"b3608559289da9cd03cfefee1a744b37","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"34.5 KB","destSize":"27.7 KB","compressRate":"80.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/f4dcd6a46d940501cc67ab04694d0b03/df2c7/livetale.jpg","sourceStatusCode":200,"destWidth":450,"destHeight":600,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx21/cdn88@2020_2/2020/08/25/00-51-45-213_0c12f884e6196d6d.webp","sourceBytes":27361,"destBytes":33648,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":976,"convertSpendMs":16,"createdTime":"2020-08-25 08:51:45","host":"us-002*","referer":"https://developers.soundcloud.com/blog/pennapps-recap","linkMd5ListStr":"b27715d5d2a8093929774bbb15a3b2c6","githubUser":"myreaderx21","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"26.7 KB","destSize":"32.9 KB","compressRate":"123%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/12ad0764bf4bbe223d41b436ddfba418/8ff1e/cycle_time.png","sourceStatusCode":200,"destWidth":800,"destHeight":210,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn65@2020_5/2020/08/25/00-51-45-303_19a47166d933f6d1.webp","sourceBytes":11125,"destBytes":9728,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":861,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:45","host":"us-55*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"10.9 KB","destSize":"9.5 KB","compressRate":"87.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/38c24f5d0a997a90e334c014ae8479e5/8939e/airbrake-report.png","sourceStatusCode":200,"destWidth":505,"destHeight":169,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn12@2020_2/2020/08/25/00-51-45-353_1d57d87e7c94be10.webp","sourceBytes":15156,"destBytes":5564,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":877,"convertSpendMs":11,"createdTime":"2020-08-25 08:51:45","host":"us-034*","referer":"https://developers.soundcloud.com/blog/front-end-javascript-bug-tracking","linkMd5ListStr":"faf31d858376c6584d716294eeb6cc11","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"14.8 KB","destSize":"5.4 KB","compressRate":"36.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/3e706dce4a12259168f3785b55a52c0b/8ff1e/release-calendar.png","sourceStatusCode":200,"destWidth":800,"destHeight":387,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx5oss/cdn35@2020_3/2020/08/25/00-51-45-265_a8e0a8d73ea4877d.webp","sourceBytes":23031,"destBytes":28412,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1026,"convertSpendMs":13,"createdTime":"2020-08-25 08:51:45","host":"us-51*","referer":"https://developers.soundcloud.com/blog/quality-mobile-trains","linkMd5ListStr":"655377572ca618cedb5c80aefa47a904","githubUser":"myreaderx5oss","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"22.5 KB","destSize":"27.7 KB","compressRate":"123.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/70603488e2cd0a1203e737d7a5ddd23e/1b142/image1.png","sourceStatusCode":200,"destWidth":419,"destHeight":446,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx4/cdn28@2020_2/2020/08/25/00-51-45-317_6d23fcfcbaf04eab.webp","sourceBytes":6266,"destBytes":14422,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1026,"convertSpendMs":53,"createdTime":"2020-08-25 08:51:45","host":"us-027*","referer":"https://developers.soundcloud.com/blog/gradle-remote-build-cache-misses-part-2","linkMd5ListStr":"2a094ed2b890cb88dd022b4f84947b7c","githubUser":"myreaderx4","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.1 KB","destSize":"14.1 KB","compressRate":"230.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/0ca86d617846e9b6982889164343f3b5/8ff1e/multitasking_propagation.png","sourceStatusCode":200,"destWidth":800,"destHeight":167,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx3/cdn69@2020_5/2020/08/25/00-51-45-200_ecb05171c21ad4d5.webp","sourceBytes":15531,"destBytes":13546,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1156,"convertSpendMs":7,"createdTime":"2020-08-25 08:51:45","host":"europe-23*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx3","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"15.2 KB","destSize":"13.2 KB","compressRate":"87.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/5686bfe2d61df3b995d97dfddfa7b051/8ff1e/slack-message.png","sourceStatusCode":200,"destWidth":800,"destHeight":179,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx29/cdn77@2020_1/2020/08/25/00-51-45-436_db24d088ebc761dd.webp","sourceBytes":19217,"destBytes":20508,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":989,"convertSpendMs":8,"createdTime":"2020-08-25 08:51:45","host":"us-025*","referer":"https://developers.soundcloud.com/blog/quality-mobile-trains","linkMd5ListStr":"655377572ca618cedb5c80aefa47a904","githubUser":"myreaderx29","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"18.8 KB","destSize":"20 KB","compressRate":"106.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/2d22fc1fcea6920ee8508b5de7306304/a5ed1/waveform_rendering_mask.png","sourceStatusCode":200,"destWidth":620,"destHeight":339,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn50@2020_4/2020/08/25/00-51-45-353_aa2f6abc4674ae1b.webp","sourceBytes":3294,"destBytes":16150,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1087,"convertSpendMs":22,"createdTime":"2020-08-25 08:51:45","host":"us-027*","referer":"https://developers.soundcloud.com/blog/ios-waveform-rendering","linkMd5ListStr":"8e813ef74b6373575f09190520cbac28","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"3.2 KB","destSize":"15.8 KB","compressRate":"490.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/d151cac99d8b4f51d1e43e9726691bcd/8ff1e/back-on-track-system.png","sourceStatusCode":200,"destWidth":800,"destHeight":634,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx30/cdn23@2020_3/2020/08/25/00-51-45-414_b1e56e4b412257cb.webp","sourceBytes":62598,"destBytes":46562,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1195,"convertSpendMs":38,"createdTime":"2020-08-25 08:51:45","host":"us-004*","referer":"https://developers.soundcloud.com/blog/getting-a-team-back-on-track","linkMd5ListStr":"58efd0c426cab9f547e717054f187f59","githubUser":"myreaderx30","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"61.1 KB","destSize":"45.5 KB","compressRate":"74.4%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/73e66afa598fa581f386392d5d026075/8ff1e/search_latency.png","sourceStatusCode":200,"destWidth":800,"destHeight":505,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx16/cdn74@2020_4/2020/08/25/00-51-45-496_a746b8ca2378b473.webp","sourceBytes":51613,"destBytes":50712,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1080,"convertSpendMs":36,"createdTime":"2020-08-25 08:51:45","host":"us-009*","referer":"https://developers.soundcloud.com/blog/how-to-reindex-1-billion-documents-in-1-hour-at-soundcloud","linkMd5ListStr":"b48d9296f462bc043ccc5738e0ea3485","githubUser":"myreaderx16","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"50.4 KB","destSize":"49.5 KB","compressRate":"98.3%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/3bfe07ea07ca9ad4d4f8ab25cd2447ae/6164f/tuist-generate.png","sourceStatusCode":200,"destWidth":658,"destHeight":422,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx27/cdn43@2020_1/2020/08/25/00-51-45-115_355ff0e58b28cac1.webp","sourceBytes":5346,"destBytes":17274,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1363,"convertSpendMs":15,"createdTime":"2020-08-25 08:51:45","host":"europe-25*","referer":"https://developers.soundcloud.com/blog/tuist-project-generation","linkMd5ListStr":"b1b7ea6f021159bbe86db6b0da568bf3","githubUser":"myreaderx27","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"5.2 KB","destSize":"16.9 KB","compressRate":"323.1%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/fc5db5fe313e9740c6968941f213570a/c7805/shbtweet2.png","sourceStatusCode":200,"destWidth":400,"destHeight":133,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx24/cdn82@2020_2/2020/08/25/00-51-45-637_da255d4d448a6666.webp","sourceBytes":7000,"destBytes":9002,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":924,"convertSpendMs":5,"createdTime":"2020-08-25 08:51:45","host":"us-011*","referer":"https://developers.soundcloud.com/blog/story-hack-recap","linkMd5ListStr":"35e86c48165c154a7a06561e317253f9","githubUser":"myreaderx24","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"6.8 KB","destSize":"8.8 KB","compressRate":"128.6%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/6791562a522f2c4ee0d83a3b3e293fe5/top-7.gif","sourceStatusCode":200,"destWidth":14,"destHeight":6,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx1/cdn61@2020_5/2020/08/25/00-51-45-639_6b5aee6d2017081b.webp","sourceBytes":135,"destBytes":160,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1179,"convertSpendMs":5,"createdTime":"2020-08-25 08:51:45","host":"us-027*","referer":"https://developers.soundcloud.com/blog/buzzwords-contest","linkMd5ListStr":"a5be158aef155aa89a77ab3a286f477c","githubUser":"myreaderx1","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"135 B","destSize":"160 B","compressRate":"118.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/7588d21a9431e8685dab8c4030a439f2/8ff1e/u_shaped_flow_cell.png","sourceStatusCode":200,"destWidth":800,"destHeight":547,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx23/cdn57@2020_6/2020/08/25/00-51-45-528_a2b565631797656a.webp","sourceBytes":88464,"destBytes":65660,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1206,"convertSpendMs":27,"createdTime":"2020-08-25 08:51:45","host":"us-012*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx23","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"86.4 KB","destSize":"64.1 KB","compressRate":"74.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/01b8f840504e9c517d2ac908a65d39c6/8ff1e/specta-vs-xctest-method-names.png","sourceStatusCode":200,"destWidth":800,"destHeight":518,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx15/cdn81@2020_5/2020/08/25/00-51-45-664_bfda1be8f948fa16.webp","sourceBytes":51268,"destBytes":41464,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1136,"convertSpendMs":17,"createdTime":"2020-08-25 08:51:45","host":"us-51*","referer":"https://developers.soundcloud.com/blog/breaking-loose-from-third-party-lock-in-with-custom-refactoring-tools","linkMd5ListStr":"393197fc917d015bdfd2ffa5e014d1f4","githubUser":"myreaderx15","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"50.1 KB","destSize":"40.5 KB","compressRate":"80.9%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/c031a6e6e484c9c502afa42b5758b239/8ff1e/code_inventory_total.png","sourceStatusCode":200,"destWidth":800,"destHeight":210,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx22/cdn54@2020_4/2020/08/25/00-51-46-090_0914e0702656f4cf.webp","sourceBytes":60127,"destBytes":32904,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1164,"convertSpendMs":100,"createdTime":"2020-08-25 08:51:45","host":"us-52*","referer":"https://developers.soundcloud.com/blog/deliver-software-faster-by-managing-work-in-progress-not-by-adding-overtime","linkMd5ListStr":"db81c33aaeff94ca6ea252b6b8e18666","githubUser":"myreaderx22","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"58.7 KB","destSize":"32.1 KB","compressRate":"54.7%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/static/e8a883f8e52683da109209f5341d150c/48a11/958035425_abb70e79b1.jpg","sourceStatusCode":200,"destWidth":500,"destHeight":500,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx11/cdn30@2020_2/2020/08/25/00-51-47-886_529b2d0c61375608.webp","sourceBytes":52987,"destBytes":78148,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":1344,"convertSpendMs":80,"createdTime":"2020-08-25 08:51:47","host":"us-026*","referer":"https://developers.soundcloud.com/blog/introducing-the-large-hadron-migrator-3","linkMd5ListStr":"e84dc40486af1771d74c7ce37e8a6a2c","githubUser":"myreaderx11","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"51.7 KB","destSize":"76.3 KB","compressRate":"147.5%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/ebc02e9d0638daf49208d70e87cbdf62/sc-tuist-focus2.gif","sourceStatusCode":200,"destWidth":954,"destHeight":594,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx12/cdn100@2020_5/2020/08/25/00-51-48-507_e8a99ae82eefb9a8.webp","sourceBytes":4802805,"destBytes":826996,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":5859,"convertSpendMs":3467,"createdTime":"2020-08-25 08:51:44","host":"europe65*","referer":"https://developers.soundcloud.com/blog/tuist-project-generation","linkMd5ListStr":"b1b7ea6f021159bbe86db6b0da568bf3","githubUser":"myreaderx12","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"4.6 MB","destSize":"807.6 KB","compressRate":"17.2%"},{"code":1,"isDone":false,"source":"https://developers.soundcloud.com/blog/da59fc91a0d3e044d127ee78658f0c16/dob-sign-in-test.gif","sourceStatusCode":200,"destWidth":876,"destHeight":720,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx13/cdn86@2020_5/2020/08/25/00-51-54-099_8c328928e20b087f.webp","sourceBytes":1747820,"destBytes":2644892,"targetWebpQuality":75,"feedId":10291,"totalSpendMs":14197,"convertSpendMs":11117,"createdTime":"2020-08-25 08:51:42","host":"europe62*","referer":"https://developers.soundcloud.com/blog/automatic-stubbing-of-network-requests-to-de-flakify-automation-testing","linkMd5ListStr":"1aaf1ca40160c5116972179b4e1bb305","githubUser":"myreaderx13","githubHttpCode":201,"extra22GetBytesInfo":"1、没有Referer字段","extra23historyStatusCode":[200],"sourceSize":"1.7 MB","destSize":"2.5 MB","compressRate":"151.3%"}],"successGithubMap":{"myreaderx8":9,"myreaderx14":8,"myreaderx7":6,"myreaderx15":7,"myreaderx6":8,"myreaderx16":6,"myreaderx32":9,"myreaderx10":9,"myreaderx4":7,"myreaderx11":9,"myreaderx33":5,"myreaderx3":8,"myreaderx12":8,"myreaderx2":9,"myreaderx13":8,"myreaderx1":8,"myreaderx30":7,"myreaderx31":6,"myreaderx18":8,"myreaderx19":7,"myreaderx":8,"myreaderx25":8,"myreaderx27":5,"myreaderx21":6,"myreaderx22":9,"myreaderx23":8,"myreaderx24":7,"myreaderx5oss":9,"myreaderx29":8},"failGithubMap":{}}