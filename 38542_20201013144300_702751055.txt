{"code":1,"isDone":false,"toInsertArticleList":[{"createdTime":"2020-10-13 22:38:55","updatedTime":"2020-10-13 22:38:55","title":"Extracting Flash Memory over SPI","link":"http://18.130.251.17/?p=302","description":"<p>So I‚Äôm playing around with a device right now and I‚Äôm currently pulling out the contents of its flash memory over SPI ‚Äì so I figured I‚Äôd write a few notes about how to do just that!</p> \n<p>Here‚Äôs what I‚Äôm playing with, in case you‚Äôre curious:</p> \n<figure class=\"wp-block-image size-large\">\n <img loading=\"lazy\" width=\"1024\" height=\"768\" src=\"https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-1024x768.jpeg\" alt=\"\" class=\"wp-image-303\" srcset=\"https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-1024x768.jpeg 1024w, https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-300x225.jpeg 300w, https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-768x576.jpeg 768w, https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-1536x1152.jpeg 1536w, https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-2048x1536.jpeg 2048w, https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-1200x900.jpeg 1200w, https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-1980x1485.jpeg 1980w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" />\n <figcaption>\n   A network device undergoing memory extraction, using a Bus Pirate \n </figcaption>\n</figure> \n<span id=\"more-302\"></span> \n<h2>Introduction</h2> \n<p>So the first question is likely, how do I know which chip is the flash memory? Well in this particular case the target chip is labelled ‚Äì so it was fairly simple to determine what it was and find a datasheet for it.</p> \n<p>Here‚Äôs a close up of what I‚Äôm working on:</p> \n<figure class=\"wp-block-image size-large\">\n <img loading=\"lazy\" width=\"768\" height=\"1024\" src=\"https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-768x1024.jpeg\" alt=\"\" class=\"wp-image-304\" srcset=\"https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-768x1024.jpeg 768w, https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-225x300.jpeg 225w, https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-1152x1536.jpeg 1152w, https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-1536x2048.jpeg 1536w, https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-1200x1600.jpeg 1200w, https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-1980x2640.jpeg 1980w, https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-scaled.jpeg 1920w\" sizes=\"(max-width: 768px) 100vw, 768px\" />\n <figcaption>\n   A shot of the target board, without test-clips, showing the target chip near the centre \n </figcaption>\n</figure> \n<p>With a little zoom or some good eyes, you should be able to see that the target chip is labelled 25Q32CSIG. With some very good eyes you‚Äôll be able to see a small circle engraved in the chip which indicates pin 1.</p> \n<p>Armed with that information you should be able to find <a href=\"https://www.semiconductorstore.com/pages/asp/DownloadDirect.asp?sid=1552923955532\">a suitable datasheet </a>for the pinout. Which has the following layout:</p> \n<pre class=\"wp-block-preformatted\">CS   1 - 8  VCC<br>SO   2 - 7  Hold<br>WP   3 - 6  SCLK<br>VSS  4 - 5  SI</br></br></br></pre> \n<p>For reading this chip with SPI and a BusPirate we don‚Äôt need all of the pins, but generally we map: CS -&gt; CS, MISO -&gt; SO, GND -&gt; VSS, 3V3- &gt; VCC, CLK -&gt; SCLK, MOSI -&gt; SI. This gives us the following pins populated:</p> \n<pre class=\"wp-block-preformatted\">CS     1 - 8   3V3\nMISO   2 - 7   Empty\nEmpty  3 - 6   CLK\nGND    4 - 5   MOSI</pre> \n<p>If you connect up your target flash chip with you bus pirate, you‚Äôll end up with something like the first photograph in the article. There‚Äôs no need to power the device itself, the BusPirate will power the chip to extract data.</p> \n<p>The next thing you‚Äôll need is flashrom, with a BusPirate configuration which should look something like this:</p> \n<figure class=\"wp-block-image size-large\">\n <img loading=\"lazy\" width=\"734\" height=\"539\" src=\"https://gracefulsecurity.com/wp-content/uploads/2020/02/ReadSPI.png\" alt=\"\" class=\"wp-image-305\" srcset=\"https://gracefulsecurity.com/wp-content/uploads/2020/02/ReadSPI.png 734w, https://gracefulsecurity.com/wp-content/uploads/2020/02/ReadSPI-300x220.png 300w\" sizes=\"(max-width: 734px) 100vw, 734px\" />\n <figcaption>\n   Flashrom reading data from the chip through a BusPirate \n </figcaption>\n</figure> \n<p>You can see from the above I‚Äôve set the BusPirate device to /dev/ttyUSB0 ‚Äì your device may be named differently to mine ‚Äì especially if you have multiple serial USB devices ‚Äì so check dmesg/dev when you first plug your BusPirate in for the device name. Additionally I‚Äôve used the -r flag to specify an output filename.</p> \n<p>Wait a few minutes and you‚Äôll end up with a file called flash.bin with your memory contents!</p> \n<p>If you‚Äôd like to take a look at the contents, then binwalk is probably a useful tool to carve out pieces of data. Here‚Äôs what mine looks like:</p> \n<figure class=\"wp-block-image size-large\">\n <img loading=\"lazy\" width=\"923\" height=\"498\" src=\"https://gracefulsecurity.com/wp-content/uploads/2020/02/SPIContent.png\" alt=\"\" class=\"wp-image-306\" srcset=\"https://gracefulsecurity.com/wp-content/uploads/2020/02/SPIContent.png 923w, https://gracefulsecurity.com/wp-content/uploads/2020/02/SPIContent-300x162.png 300w, https://gracefulsecurity.com/wp-content/uploads/2020/02/SPIContent-768x414.png 768w\" sizes=\"(max-width: 923px) 100vw, 923px\" />\n <figcaption>\n   The flash memory contents displayed in binwalk \n </figcaption>\n</figure> \n<p>A little messy but it works ‚Äì you can also use the -e flag to extract the known file types, but you probably want to use -C and supply a directory name to extract to, as the default is the current working directory and it can get a little messy.</p> \n<p>That‚Äôs it! That‚Äôs a simple guide on how to extract flash memory with SPI and a BusPirate! Have fun <img src=\"https://s.w.org/images/core/emoji/13.0.0/72x72/1f642.png\" alt=\"üôÇ\" class=\"wp-smiley\" style=\"height: 1em; max-height: 1em;\" /></p>\n<p>The post <a href=\"https://gracefulsecurity.com/extracting-flash-memory-over-spi/\" target=\"_blank\">Extracting Flash Memory over SPI</a> first appeared on <a href=\"https://gracefulsecurity.com/\" target=\"_blank\">GracefulSecurity</a>.</p>","descriptionType":"html","publishedDate":"Mon, 18 Mar 2019 09:00:00 +0000","feedId":38542,"bgimg":"https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-1024x768.jpeg","linkMd5":"d18fb8f1ee42aaf7140fb4c323ca822b","bgimgJsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn70@2020_1/2020/10/13/14-42-57-595_9a4c8ff07210eb3d.webp","destWidth":1024,"destHeight":768,"sourceBytes":112848,"destBytes":67044,"author":"HollyGraceful","articleImgCdnMap":{"https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-1024x768.jpeg":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn70@2020_1/2020/10/13/14-42-57-595_9a4c8ff07210eb3d.webp","https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-768x1024.jpeg":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn82@2020_3/2020/10/13/14-42-59-468_feeaa9ebff05724f.webp","https://gracefulsecurity.com/wp-content/uploads/2020/02/ReadSPI.png":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn73@2020_6/2020/10/13/14-42-58-868_5294da3d9471b03d.webp","https://gracefulsecurity.com/wp-content/uploads/2020/02/SPIContent.png":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn77@2020_2/2020/10/13/14-42-58-862_59b4f306a351c5db.webp","https://s.w.org/images/core/emoji/13.0.0/72x72/1f642.png":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn86@2020_1/2020/10/13/14-42-59-238_48013d3a393020f8.webp"},"publishedOrCreatedDate":1602599935114}],"record":{"createdTime":"2020-10-13 22:38:55","updatedTime":"2020-10-13 22:38:55","feedId":38542,"fetchDate":"Tue, 13 Oct 2020 14:38:55 +0000","fetchMs":1077,"handleMs":8,"totalMs":246560,"newArticles":0,"totalArticles":10,"status":1,"type":0,"ip":"b64390d68f1bc7aec72a456a348bbf5a","hostName":"us-021*","requestId":"f8e02f0ad1504345bb9822c1b0594e68_38542","contentType":"application/rss+xml; charset=UTF-8","totalBytes":286080,"bgimgsTotal":1,"bgimgsGithubTotal":1,"articlesImgsTotal":5,"articlesImgsGithubTotal":5,"successGithubMap":{"myreaderx25":1,"myreaderx7":1,"myreaderx6":1,"myreaderx32":1,"myreaderx19":1},"failGithubMap":{}},"feed":{"createdTime":"2020-09-07 03:14:28","updatedTime":"2020-09-07 05:29:49","id":38542,"name":"GracefulSecurity","url":"https://www.gracefulsecurity.com/feed/","subscriber":83,"website":null,"icon":"https://gracefulsecurity.com/favicon.ico","icon_jsdelivr":"https://cdn.jsdelivr.net/gh/myreaderx63/cdn51@2020_5/2020/09/06/21-29-48-565_efa7f8a14ab972d4.png","description":"","weekly":null,"link":null},"noPictureArticleList":[],"tmpCommonImgCdnBytes":67044,"tmpBodyImgCdnBytes":219036,"tmpBgImgCdnBytes":0,"extra4":{"start":1602599933953,"total":0,"statList":[{"spend":1154,"msg":"Ëé∑ÂèñxmlÂÜÖÂÆπ"},{"spend":8,"msg":"Ëß£ÈáäÊñáÁ´†"},{"spend":0,"msg":"‰∏ä‰º†Â∞ÅÈù¢ÂõæÂà∞cdn"},{"spend":1,"msg":"‰øÆÊ≠£Â∞ÅÈù¢Âõæ‰∏ä‰º†Â§±Ë¥•ÈáçÊñ∞‰∏ä‰º†"},{"spend":2000,"msg":"Ê≠£ÊñáÈìæÊé•‰∏ä‰º†Âà∞cdn"}]},"extra5":5,"extra6":5,"extra7ImgCdnFailResultVector":[],"extra10_invalidATagHrefValue":{},"extra111_proxyServerAndStatMap":{"http://europe-56.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://europe68.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-034.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]},"http://us-022.herokuapp.com/":{"failCount":0,"successCount":1,"resultList":[200]}},"extra12ImgCdnSuccessResultVector":[{"code":1,"isDone":false,"source":"https://gracefulsecurity.com/wp-content/uploads/2020/02/6F8E75C9-A2DF-4F76-9762-E2F42B04F766-1024x768.jpeg","sourceStatusCode":200,"destWidth":1024,"destHeight":768,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx32/cdn70@2020_1/2020/10/13/14-42-57-595_9a4c8ff07210eb3d.webp","sourceBytes":112848,"destBytes":67044,"targetWebpQuality":75,"feedId":38542,"totalSpendMs":1714,"convertSpendMs":38,"createdTime":"2020-10-13 22:42:56","host":"us-005*","referer":"http://18.130.251.17/?p=302","linkMd5ListStr":"d18fb8f1ee42aaf7140fb4c323ca822b,d18fb8f1ee42aaf7140fb4c323ca822b","githubUser":"myreaderx32","githubHttpCode":201,"extra22GetBytesInfo":"1„ÄÅÊ≤°ÊúâRefererÂ≠óÊÆµ","extra23historyStatusCode":[200],"sourceSize":"110.2 KB","destSize":"65.5 KB","compressRate":"59.4%"},{"code":1,"isDone":false,"source":"https://gracefulsecurity.com/wp-content/uploads/2020/02/ReadSPI.png","sourceStatusCode":200,"destWidth":734,"destHeight":539,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx6/cdn73@2020_6/2020/10/13/14-42-58-868_5294da3d9471b03d.webp","sourceBytes":43157,"destBytes":46154,"targetWebpQuality":75,"feedId":38542,"totalSpendMs":1396,"convertSpendMs":22,"createdTime":"2020-10-13 22:42:58","host":"europe68*","referer":"http://18.130.251.17/?p=302","linkMd5ListStr":"d18fb8f1ee42aaf7140fb4c323ca822b","githubUser":"myreaderx6","githubHttpCode":201,"extra22GetBytesInfo":"1„ÄÅÊ≤°ÊúâRefererÂ≠óÊÆµ","extra23historyStatusCode":[200],"sourceSize":"42.1 KB","destSize":"45.1 KB","compressRate":"106.9%"},{"code":1,"isDone":false,"source":"https://s.w.org/images/core/emoji/13.0.0/72x72/1f642.png","sourceStatusCode":200,"destWidth":72,"destHeight":72,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx19/cdn86@2020_1/2020/10/13/14-42-59-238_48013d3a393020f8.webp","sourceBytes":620,"destBytes":1362,"targetWebpQuality":75,"feedId":38542,"totalSpendMs":936,"convertSpendMs":16,"createdTime":"2020-10-13 22:42:59","host":"us-022*","referer":"http://18.130.251.17/?p=302","linkMd5ListStr":"d18fb8f1ee42aaf7140fb4c323ca822b","githubUser":"myreaderx19","githubHttpCode":201,"extra22GetBytesInfo":"1„ÄÅÊ≤°ÊúâRefererÂ≠óÊÆµ","extra23historyStatusCode":[200],"sourceSize":"620 B","destSize":"1.3 KB","compressRate":"219.7%"},{"code":1,"isDone":false,"source":"https://gracefulsecurity.com/wp-content/uploads/2020/02/SPIContent.png","sourceStatusCode":200,"destWidth":923,"destHeight":498,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx25/cdn77@2020_2/2020/10/13/14-42-58-862_59b4f306a351c5db.webp","sourceBytes":116436,"destBytes":82334,"targetWebpQuality":75,"feedId":38542,"totalSpendMs":1561,"convertSpendMs":36,"createdTime":"2020-10-13 22:42:58","host":"europe-56*","referer":"http://18.130.251.17/?p=302","linkMd5ListStr":"d18fb8f1ee42aaf7140fb4c323ca822b","githubUser":"myreaderx25","githubHttpCode":201,"extra22GetBytesInfo":"1„ÄÅÊ≤°ÊúâRefererÂ≠óÊÆµ","extra23historyStatusCode":[200],"sourceSize":"113.7 KB","destSize":"80.4 KB","compressRate":"70.7%"},{"code":1,"isDone":false,"source":"https://gracefulsecurity.com/wp-content/uploads/2020/02/075AA2DE-F714-452D-A309-7D2030AB184B-768x1024.jpeg","sourceStatusCode":200,"destWidth":768,"destHeight":1024,"fixedGithubDest":"https://cdn.jsdelivr.net/gh/myreaderx7/cdn82@2020_3/2020/10/13/14-42-59-468_feeaa9ebff05724f.webp","sourceBytes":128648,"destBytes":89186,"targetWebpQuality":75,"feedId":38542,"totalSpendMs":1982,"convertSpendMs":56,"createdTime":"2020-10-13 22:42:58","host":"us-034*","referer":"http://18.130.251.17/?p=302","linkMd5ListStr":"d18fb8f1ee42aaf7140fb4c323ca822b","githubUser":"myreaderx7","githubHttpCode":201,"extra22GetBytesInfo":"1„ÄÅÊ≤°ÊúâRefererÂ≠óÊÆµ","extra23historyStatusCode":[200],"sourceSize":"125.6 KB","destSize":"87.1 KB","compressRate":"69.3%"}],"successGithubMap":{"myreaderx25":1,"myreaderx7":1,"myreaderx6":1,"myreaderx32":1,"myreaderx19":1},"failGithubMap":{}}